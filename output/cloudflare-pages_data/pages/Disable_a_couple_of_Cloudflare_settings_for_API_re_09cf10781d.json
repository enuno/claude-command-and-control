{
  "title": "Disable a couple of Cloudflare settings for API requests",
  "content": "resource \"cloudflare_ruleset\" \"http_config_rules_example\" {\n  zone_id     = \"<ZONE_ID>\"\n  name        = \"Config rules ruleset\"\n  description = \"Set configuration rules for incoming requests\"\n  kind        = \"zone\"\n  phase       = \"http_config_settings\"\n\nrules {\n    ref         = \"disable_obfuscation_bic\"\n    description = \"Disable email obfuscation and BIC for API requests\"\n    expression  = \"(http.request.uri.path matches \\\"^/api/\\\")\"\n    action      = \"set_config\"\n    action_parameters {\n      email_obfuscation = false\n      bic               = false\n    }\n  }\n}\nhtml\n<meta name=\"referrer\" (...) />\ntxt\n  (starts_with(http.request.uri.path, \"/hr-app/\"))\n  txt\n  hr-server.example.com\n  txt\n  hr-server.example.com\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"hr_app_overrides\",\n              \"expression\": \"starts_with(http.request.uri.path, \\\"/hr-app/\\\")\",\n              \"description\": \"Origin rule for the company HR application\",\n              \"action\": \"route\",\n              \"action_parameters\": {\n                  \"host_header\": \"hr-server.example.com\",\n                  \"origin\": {\n                      \"host\": \"hr-server.example.com\"\n                  }\n              }\n          }\n      ]\n    }'\n  json\n  {\n    \"result\": {\n      \"id\": \"<RULESET_ID>\",\n      \"name\": \"Origin Rules ruleset\",\n      \"description\": \"Zone-level ruleset that will execute origin rules.\",\n      \"kind\": \"zone\",\n      \"version\": \"2\",\n      \"rules\": [\n        {\n          \"ref\": \"hr_app_overrides\",\n          \"id\": \"<RULE_ID>\",\n          \"version\": \"1\",\n          \"action\": \"route\",\n          \"action_parameters\": {\n            \"host_header\": \"hr-server.example.com\",\n            \"origin\": {\n              \"host\": \"hr-server.example.com\"\n            }\n          },\n          \"expression\": \"starts_with(http.request.uri.path, \\\"/hr-app/\\\")\",\n          \"description\": \"Origin rule for the company HR application\",\n          \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n          \"ref\": \"<RULE_REF>\"\n        }\n      ],\n      \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n      \"phase\": \"http_request_origin\"\n    },\n    \"success\": true,\n    \"errors\": [],\n    \"messages\": []\n  }\n  txt\n  starts_with(http.request.uri.path, \"/team/calendar/\")\n  txt\n  8081\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"calendar_app_change_port\",\n              \"expression\": \"starts_with(http.request.uri.path, \\\"/team/calendar/\\\")\",\n              \"description\": \"Origin rule for the team calendar application\",\n              \"action\": \"route\",\n              \"action_parameters\": {\n                  \"origin\": {\n                      \"port\": 8081\n                  }\n              }\n          }\n      ]\n    }'\n  json\n  {\n    \"result\": {\n      \"id\": \"<RULESET_ID>\",\n      \"name\": \"Origin Rules ruleset\",\n      \"description\": \"Zone-level ruleset that will execute origin rules.\",\n      \"kind\": \"zone\",\n      \"version\": \"2\",\n      \"rules\": [\n        {\n          \"ref\": \"calendar_app_change_port\",\n          \"id\": \"<RULE_ID>\",\n          \"version\": \"1\",\n          \"action\": \"route\",\n          \"action_parameters\": {\n            \"origin\": {\n              \"port\": 8081\n            }\n          },\n          \"expression\": \"starts_with(http.request.uri.path, \\\"/team/calendar/\\\")\",\n          \"description\": \"Origin rule for the team calendar application\",\n          \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n          \"ref\": \"<RULE_REF>\"\n        }\n      ],\n      \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n      \"phase\": \"http_request_origin\"\n    },\n    \"success\": true,\n    \"errors\": [],\n    \"messages\": []\n  }\n  tf",
  "code_samples": [
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n## Additional resources\n\nFor additional guidance on using Terraform with Cloudflare, refer to the following resources:\n\n* [Terraform documentation](https://developers.cloudflare.com/terraform/)\n* [Cloudflare Provider for Terraform](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) (reference documentation)\n\n</page>\n\n<page>\n---\ntitle: Error page types · Cloudflare Rules docs\ndescription: \"The following error page types will only be shown in the\n  Cloudflare dashboard if you have customized their error pages in the past:\"\nlastUpdated: 2025-06-04T08:56:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/\n  md: https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/index.md\n---\n\n| Page type | Description | API identifier |\n| - | - | - |\n| WAF block | The page displayed when visitors are blocked by a [Web Application Firewall](https://developers.cloudflare.com/waf/) rule. This page returns a `403` status code. | `waf_block` |\n| IP/Country block | The page displayed when a request originates from a [blocked IP address or country](https://developers.cloudflare.com/waf/tools/ip-access-rules/). This page returns a `403` status code. | `ip_block` |\n| IP/Country challenge | Presents a challenge to visitors from specified IP addresses or countries. This page returns a `403` status code. For more information, refer to [IP Access rules](https://developers.cloudflare.com/waf/tools/ip-access-rules/). | `country_challenge` |\n| 500 class errors | 500 class error pages are displayed when a web server is unable to process a request. For more information, refer to [Cloudflare 5XX errors](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/). | `500_errors` |\n| 1000 class errors | 1000 class error pages are displayed when a domain’s configuration, security settings, or origin setup prevents Cloudflare from completing a request. For more information, refer to [Cloudflare 1XXX errors](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-1xxx-errors/). | `1000_errors` |\n| Managed challenge / I'm Under Attack Mode | Presents different types of challenges to a visitor depending on the nature of their request and your security settings. This page returns a `403` status code. For more information, refer to [Under Attack mode](https://developers.cloudflare.com/fundamentals/reference/under-attack-mode/). | `managed_challenge` |\n| Rate limiting block | Displayed to visitors when they have been blocked by a [rate limiting rule](https://developers.cloudflare.com/waf/rate-limiting-rules/). This page returns a `429` status code. | `ratelimit_block` |\n\nThe following error page types will only be shown in the Cloudflare dashboard if you have customized their error pages in the past:\n\n| Page type | API identifier |\n| - | - |\n| Interactive Challenge | `basic_challenge` |\n| JavaScript Challenge | `under_attack` |\n\nThese types of challenges are being discouraged in favor of managed challenges. Refer to [Challenge pages](https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/) for more information.\n\n</page>\n\n<page>\n---\ntitle: Custom error tokens · Cloudflare Rules docs\ndescription: Each custom error token provides diagnostic information or specific\n  functionality that appears on the error page. Certain error pages require a\n  page-specific custom error token.\nlastUpdated: 2025-08-11T18:12:25.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/\n  md: https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/index.md\n---\n\n## For Error Pages\n\nEach custom error token provides diagnostic information or specific functionality that appears on the error page. Certain error pages require a page-specific custom error token.\n\nTo display a custom page for each error, create a separate page per error. For example, to create an error page for both **IP/Country Block** and **Interactive Challenge**, you must design and publish two separate pages.\n\nThe following custom error tokens are required by their respective error pages:\n\n| Token | Required for |\n| - | - |\n| `::CAPTCHA_BOX::` | Interactive Challenge Country Challenge (Managed Challenge) Managed Challenge / I'm Under Attack Mode (Interstitial Page) |\n| `::IM_UNDER_ATTACK_BOX::` | Non-Interactive Challenge (JS Challenge) |\n| `::CLOUDFLARE_ERROR_500S_BOX::` | 5XX Errors |\n| `::CLOUDFLARE_ERROR_1000S_BOX::` | 1XXX Errors |\n\nEach custom error token has a default look and feel. However, you can use CSS to stylize each custom error tag using each tag's class ID. All the external resources like images, CSS, and scripts will be inlined during the process. As such, all external resources need to be available (that is, they must return `200 OK`) otherwise an error will be thrown.\n\n## For Custom Error Assets, inline responses, and Error Pages\n\nA custom error asset, inline response, or error page may also include the following error tokens, which will be replaced with their real values before sending the response to the visitor:\n\n| Token | Description |\n| - | - |\n| `::CLIENT_IP::` | The visitor's IP address. |\n| `::RAY_ID::` | A unique identifier given to every request that goes through Cloudflare. |\n| `::GEO::` | The country or region associated with the visitor's IP address. |\n\n</page>\n\n<page>\n---\ntitle: Custom Errors parameters · Cloudflare Rules docs\ndescription: \"Custom error rules define when a custom error gets triggered and\n  the content that is served to visitors. Rule parameters are the following:\"\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/reference/parameters/\n  md: https://developers.cloudflare.com/rules/custom-errors/reference/parameters/index.md\n---\n\n## Custom error rules\n\n[Custom error rules](https://developers.cloudflare.com/rules/custom-errors/#custom-error-rules) define when a custom error gets triggered and the content that is served to visitors. Rule parameters are the following:\n\n### Response type\n\nAPI name: *N/A* (handled via [`asset_name`](#asset) and [`content_type`](#response) parameters)\n\nThe content type of the inline response to send to the website visitor (JSON, HTML, Text, or XML), or **Custom error asset** if sending the content of a custom error asset.\n\nWhen using the API you must either set the `asset_name` or set both the `content_type` and `content` parameters. Refer to [JSON response / HTML response / Text response / XML response](#response).\n\n### Response code\n\nAPI name: **`status_code`** Integer Optional\n\nThe HTTP status code of the response. If provided, this value will override the current response status code.\n\nThe status code must be between `400` and `999`.\n\n### Asset\n\nAPI name: **`asset_name`** String Optional\n\nThe name of the [custom error asset](#custom-error-assets) you previously uploaded (in the dashboard, you can create an asset when creating the rule). The asset may include [error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/) that will be replaced with real values before sending the error response to the visitor.\n\nA custom error rule can only reference an asset defined in the same scope as the rule (that is, in the same zone or account).\n\nIn the dashboard, this parameter is only available when you select `Custom error asset` in **Response type**.\n\nWhen using the API, you must provide either the `asset_name` or the `content` parameter.\n\n### JSON response / HTML response / Text response / XML response\n\nAPI names: **`content`** String Optional and **`content_type`** String Required\n\nThe response body to return. It can include [error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/) that will be replaced with real values before sending the error response to the visitor.\n\nYou must provide either the `asset_name` or the `content` parameter.\n\nThe maximum content size is 10 KB.\n\nWhen using the API you must also set the `content_type` parameter, which defines the content type of the returned response. The value must be one of the following:\n\n* `text/html`\n* `text/plain`\n* `application/json`\n* `text/xml`\n\nWarning\n\nIf you create an HTML error response, make sure the `referrer` meta tag is not present in the HTML code since it will disrupt [Cloudflare challenges](https://developers.cloudflare.com/cloudflare-challenges/):",
      "language": "unknown"
    },
    {
      "code": "## Custom error assets\n\nA [custom error asset](https://developers.cloudflare.com/rules/custom-errors/#custom-error-assets) corresponds to a web resource such as an HTML web page (including any referenced images, CSS, and JavaScript code) that Cloudflare fetches and saves based on a URL you provide, to be served to visitors as an error page.\n\nCustom error assets have the following parameters:\n\n### Asset name\n\nAPI name: **`name`** String Required\n\nThe name of the custom error asset. Example value: `\"500_error_template\"`.\n\nAn asset name can contain the following characters:\n\n* Uppercase and lowercase letters (`A-Z` and `a-z`)\n* Numbers (`0-9`)\n* The underscore (`_`) character\n\nThe maximum length is 200 characters.\n\n### Description\n\nAPI name: **`description`** String Optional\n\nA string describing the custom error asset. Example value: `\"Standard 5xx error template page\"`.\n\n### Asset address\n\nAPI name: **`url`** String Required\n\nThe URL of the page you want Cloudflare to fetch and store, to be served later to visitors as error pages according to the configured [custom error rules](#custom-error-rules). Example value: `\"https://example.com/errors/500.html\"`.\n\nWhen you create or update an asset and provide a URL, Cloudflare collects any images, CSS, and JavaScript code used in the page, minifies the content, and saves it internally.\n\nThe content of the page at the specified URL may include [error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/) that will be replaced with real values before sending the error response to the visitor.\n\nWhen using the dashboard, you can later trigger another fetch to get the latest version of the page along with its resources, and store it internally.\n\nWhen using the API, if you update an asset and provide the same URL, Cloudflare will fetch the URL again, along with its resources, and store it internally.\n\nThe maximum asset size is 1.5 MB.\n\n</page>\n\n<page>\n---\ntitle: Change the HTTP Host header and DNS record · Cloudflare Rules docs\ndescription: Create an origin rule to change the HTTP `Host` header and the\n  resolved DNS record.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/examples/change-http-host-header/\n  md: https://developers.cloudflare.com/rules/origin-rules/examples/change-http-host-header/index.md\n---\n\nThe following origin rule overrides the HTTP `Host` header to `hr-server.example.com` for all requests with a URI path starting with `/hr-app/`. It also overrides the DNS record to the same hostname.\n\nThe `Host` header override only updates the header value; the DNS record override will handle the rerouting of incoming requests. For more information on these overrides, refer to [Available settings](https://developers.cloudflare.com/rules/origin-rules/features/).\n\n* Dashboard\n\n  Expression when using the Expression Builder:\n\n  | Field | Operator | Value |\n  | - | - | - |\n  | URI Path | starts with | `/hr-app/` |\n\n  Expression when using the Expression Editor:",
      "language": "unknown"
    },
    {
      "code": "Value after **Host Header** > **Rewrite to**:",
      "language": "unknown"
    },
    {
      "code": "Value after **DNS Record** > **Override to**:",
      "language": "unknown"
    },
    {
      "code": "* API\n\n  The following example sets the rules of an existing phase ruleset (`$RULESET_ID`) to a single origin rule — overriding the `Host` header of incoming requests and the resolved DNS record — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation. The response will contain the complete definition of the ruleset you updated.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n</page>\n\n<page>\n---\ntitle: Change the destination port · Cloudflare Rules docs\ndescription: Create an origin rule to change the destination port.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/examples/change-port/\n  md: https://developers.cloudflare.com/rules/origin-rules/examples/change-port/index.md\n---\n\nThe following origin rule overrides the destination port to `8081` for all requests where the URI path starts with `/team/calendar/`.\n\n* Dashboard\n\n  Text in Expression Editor:",
      "language": "unknown"
    },
    {
      "code": "Value after **Destination Port** > **Rewrite to**:",
      "language": "unknown"
    },
    {
      "code": "* API\n\n  The following example sets the rules of an existing phase ruleset (`$RULESET_ID`) to a single origin rule — overriding the port of incoming requests — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation. The response will contain the complete definition of the ruleset you updated.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n</page>\n\n<page>\n---\ntitle: Define a single origin rule using Terraform · Cloudflare Rules docs\ndescription: Create an origin rule using Terraform to override the `Host`\n  header, the resolved hostname, and the destination port of API requests.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/examples/define-single-origin-terraform/\n  md: https://developers.cloudflare.com/rules/origin-rules/examples/define-single-origin-terraform/index.md\n---\n\nNote\n\nTerraform code snippets below refer to the v4 SDK only.\n\nThe following example defines a single origin rule for a zone using Terraform. The rule overrides the `Host` header, the resolved hostname, and the destination port of API requests.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Additional resources",
      "id": "additional-resources"
    },
    {
      "level": "h2",
      "text": "For Error Pages",
      "id": "for-error-pages"
    },
    {
      "level": "h2",
      "text": "For Custom Error Assets, inline responses, and Error Pages",
      "id": "for-custom-error-assets,-inline-responses,-and-error-pages"
    },
    {
      "level": "h2",
      "text": "Custom error rules",
      "id": "custom-error-rules"
    },
    {
      "level": "h3",
      "text": "Response type",
      "id": "response-type"
    },
    {
      "level": "h3",
      "text": "Response code",
      "id": "response-code"
    },
    {
      "level": "h3",
      "text": "Asset",
      "id": "asset"
    },
    {
      "level": "h3",
      "text": "JSON response / HTML response / Text response / XML response",
      "id": "json-response-/-html-response-/-text-response-/-xml-response"
    },
    {
      "level": "h2",
      "text": "Custom error assets",
      "id": "custom-error-assets"
    },
    {
      "level": "h3",
      "text": "Asset name",
      "id": "asset-name"
    },
    {
      "level": "h3",
      "text": "Description",
      "id": "description"
    },
    {
      "level": "h3",
      "text": "Asset address",
      "id": "asset-address"
    }
  ],
  "url": "llms-txt#disable-a-couple-of-cloudflare-settings-for-api-requests",
  "links": []
}