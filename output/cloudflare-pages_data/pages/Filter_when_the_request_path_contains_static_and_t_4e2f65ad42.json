{
  "title": "Filter when the request path contains \"/static\" and the request hostname is \"example.com\":",
  "content": "\"filter\": \"{\\\"where\\\":{\\\"and\\\":[{\\\"key\\\":\\\"ClientRequestPath\\\",\\\"operator\\\":\\\"contains\\\",\\\"value\\\":\\\"/static\\\"}, {\\\"where\\\":{\\\"and\\\":[{\\\"key\\\":\\\"ClientRequestHost\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"example.com\\\"}]}}\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/logpush/edge/jobs\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"fields\": \"ClientIP,ClientRequestHost,ClientRequestMethod,ClientRequestURI,EdgeEndTimestamp,EdgeResponseBytes,EdgeResponseStatus,EdgeStartTimestamp,RayID\",\n    \"sample\": 100,\n    \"filter\": \"\",\n    \"kind\": \"instant-logs\"\n  }'\njson\n{\n  \"errors\": [],\n  \"messages\": [],\n  \"result\": {\n    \"id\": <JOB_ID>,\n    \"fields\": \"ClientIP,ClientRequestHost,ClientRequestMethod,ClientRequestURI,EdgeEndTimestamp,EdgeResponseBytes,EdgeResponseStatus,EdgeStartTimestamp,RayID\",\n    \"sample\": 100,\n    \"filter\": \"\",\n    \"destination_conf\": \"wss://logs.cloudflare.com/instant-logs/ws/sessions/<SESSION_ID>\",\n    \"kind\": \"instant-logs\"\n  },\n  \"success\": true\n}\nbash\nwebsocat wss://logs.cloudflare.com/instant-logs/ws/sessions/<SESSION_ID>\nbash\nawebsocat wss://logs.cloudflare.com/instant-logs/ws/sessions/<SESSION_ID> | agrind '* | json | sum(sampleInterval) by ClientCountry'\nbash\ncurl --globoff \"https://api.cloudflare.com/client/v4/accounts/{account_id}/logs/retrieve?start=2022-06-01T16:00:00Z&end=2022-06-01T16:05:00Z&bucket=cloudflare-logs&prefix=http_requests/example.com/{DATE}\" \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"R2-Access-Key-Id: R2_ACCESS_KEY_ID\" \\\n--header \"R2-Secret-Access-Key: R2_SECRET_ACCESS_KEY\"\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logs/rayids/index \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"R2-Access-Key-Id: <R2_ACCESS_KEY_ID>\" \\\n--header \"R2-Secret-Access-Key: <R2_SECRET_ACCESS_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data-raw '{\n  \"start\": \"2022-08-16T20:30:00Z\",\n  \"end\": \"2022-08-16T20:31:00\",\n  \"bucket\": \"cloudflare-logs\",\n  \"prefix\": \"http_requests/example.com/{DATE}\"\n}'\nbash\ncurl --globoff \"https://api.cloudflare.com/client/v4/accounts/{account_id}/logs/rayids/<RAY_ID>?bucket=cloudflare-logs&prefix=http_requests/example.com/{DATE}\" \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"R2-Access-Key-Id: <R2_ACCESS_KEY_ID>\" \\\n--header \"R2-Secret-Access-Key: <R2_SECRET_ACCESS_KEY>\"\n```\n\nI am getting an error when accessing the API\n\n* **Error**: Time range returned too many results. Try reducing the time range and try again.\n\nHTTP status code `422` will be returned if the time range between the start and end parameters is too wide. Try querying a shorter time range if you are running into this limit.\n\n* **Error**: Provided token does not have the required features enabled.\n\nContact your account representative to have the beta Logpull RayID Lookup subscription added to your account.\n\n* **Error**: Time range returned too many results. Try reducing the time range and try again.\n\nHigh volume zones can produce many log files in R2. Try reducing your start and end time range until you find a duration that works best for your log volume.\n\nHow do I know what time range to index?\n\nCurrently, there is no process to index logs as they arrive. If you have the RayID and know the time the request was made, try indexing the next 5-10 minutes of logs after the request was completed.\n\nWhat is the time delay between when an event happens and when I can query for it?\n\nLogpush delivers logs in batches as soon as possible, generally in less than one minute. After this, logs can be accessed using Logs Engine.\n\nDoes R2 have retention controls?\n\nR2 does not currently have retention controls in place. You can query back as far as when you created the Logpush job.\n\nWhich datasets is Logs Engine compatible with?\n\nThe retrieval API is compatible with all the datasets we support. The full list is available on the [Datasets](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/) section.\n\n<page>\n---\ntitle: Reference · Cloudflare Logs docs\ndescription: \"These reference resources are useful for gaining a more in-depth\n  understanding of the terminology and status codes that are part of the\n  Cloudflare Logs data. This information is especially important when\n  integrating your data with third-party tools:\"\nlastUpdated: 2025-07-24T13:05:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/logs/reference/\n  md: https://developers.cloudflare.com/logs/reference/index.md\n---\n\nThese reference resources are useful for gaining a more in-depth understanding of the terminology and status codes that are part of the Cloudflare Logs data. This information is especially important when integrating your data with third-party tools:\n\n* [Pathing status](https://developers.cloudflare.com/logs/reference/pathing-status/)\n* [Security fields](https://developers.cloudflare.com/logs/reference/security-fields/)\n* [WAF fields](https://developers.cloudflare.com/logs/reference/waf-fields/)\n* [ClientRequestSource field](https://developers.cloudflare.com/logs/reference/clientrequestsource/)\n* [Change notices](https://developers.cloudflare.com/logs/reference/change-notices/)\n\n<page>\n---\ntitle: 404 - Page Not Found · Cloudflare Magic Firewall docs\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/magic-firewall/404/\n  md: https://developers.cloudflare.com/magic-firewall/404/index.md\n---",
  "code_samples": [
    {
      "code": "Example request using cURL:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Logs Read`",
      "language": "unknown"
    },
    {
      "code": "Response:\n\nThe response will include a new field called **destination\\_conf**. The value of this field is your unique WebSocket address that will receive messages from Cloudflare's global network.",
      "language": "unknown"
    },
    {
      "code": "### 2. Connect to WebSocket\n\nUsing a CLI utility like [Websocat](https://github.com/vi/websocat), you can connect to the WebSocket and start immediately receiving logs.",
      "language": "unknown"
    },
    {
      "code": "Response:\n\nOnce connected to the websocket, you will receive messages of line-delimited JSON.\n\n### Angle Grinder\n\nNow that you have a connection to Cloudflare's websocket and are receiving logs from Cloudflare's global network, you can start slicing and dicing the logs. A handy tool for this is [Angle Grinder](https://github.com/rcoh/angle-grinder). Angle Grinder lets you apply filtering, transformations and aggregations on stdin with first class JSON support. For example, to get the number of visitors from each country you can sum the number of events by the `ClientCountry` field.",
      "language": "unknown"
    },
    {
      "code": "Response:\n\n| **ClientCountry** | **\\_sum** |\n| - | - |\n| pt | `4` |\n| fr | `3` |\n| us | `3` |\n| om | `2` |\n| ar | `1` |\n| au | `1` |\n\n## Datasets available\n\nFor the moment, `HTTP requests` is the only dataset supported. In the future, we will expand to other datasets.\n\n## Export\n\nYou can download the table of logs that appears in the dashboard, in JSON format via the **Export** button.\n\n## Limits\n\nInstant Logs has three limits set in place:\n\n* Only one active Instant Logs session per zone.\n* Maximum session time is 60 minutes.\n* If you stop listening to a socket for more than five minutes.\n\nIf either of these limits are reached, the logs stream will automatically stop.\n\n## Connect with us\n\nIf you have any feature requests or notice any bugs, share your feedback directly with us by joining the [Cloudflare Developers community on Discord](https://discord.cloudflare.com).\n\n</page>\n\n<page>\n---\ntitle: Logpull · Cloudflare Logs docs\ndescription: Cloudflare Logpull is a REST API for consuming request logs over\n  HTTP. These logs contain data related to the connecting client, the request\n  path through the Cloudflare network, and the response from the origin web\n  server. This data is useful for enriching existing logs on an origin server.\n  Logpull is available to customers on the Enterprise plan.\nlastUpdated: 2025-07-16T14:37:31.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/logs/logpull/\n  md: https://developers.cloudflare.com/logs/logpull/index.md\n---\n\nCloudflare Logpull is a REST API for consuming request logs over HTTP. These logs contain data related to the connecting client, the request path through the Cloudflare network, and the response from the origin web server. This data is useful for enriching existing logs on an origin server. Logpull is available to customers on the Enterprise plan.\n\nWarning\n\nLogpull is considered a legacy feature and we recommend using [Logpush](https://developers.cloudflare.com/logs/logpush/) or [Logs Engine](https://developers.cloudflare.com/logs/r2-log-retrieval/) instead for better performance and functionality.\n\nReview the following content to learn more about Logpull.\n\n* [Understanding the basics](https://developers.cloudflare.com/logs/logpull/understanding-the-basics/)\n* [Enabling log retention](https://developers.cloudflare.com/logs/logpull/enabling-log-retention/)\n* [Requesting logs](https://developers.cloudflare.com/logs/logpull/requesting-logs/)\n* [Additional details](https://developers.cloudflare.com/logs/logpull/additional-details/)\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | No | No | Yes |\n\n### Limitation\n\nLogpull is unavailable when the Customer Metadata Boundary (CMB) is set outside the US region. Specifically, it does not work when CMB is restricted to the EU-only setting. For more details, refer to the [Cloudflare Data Localization](https://developers.cloudflare.com/data-localization/) documentation.\n\n</page>\n\n<page>\n---\ntitle: Logpush · Cloudflare Logs docs\ndescription: Logpush delivers logs in batches as quickly as possible, with no\n  minimum batch size, potentially delivering files more than once per minute.\n  This capability enables Cloudflare to provide information almost in real time,\n  in smaller file sizes. Users can configure the batch size using the API for\n  improved control in case the log destination has specific requirements.\nlastUpdated: 2025-07-24T13:05:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/logs/logpush/\n  md: https://developers.cloudflare.com/logs/logpush/index.md\n---\n\nLogpush delivers logs in batches as quickly as possible, with no minimum batch size, potentially delivering files more than once per minute. This capability enables Cloudflare to provide information almost in real time, in smaller file sizes. Users can configure the batch size [using the API](https://developers.cloudflare.com/logs/logpush/logpush-job/api-configuration/#max-upload-parameters) for improved control in case the log destination has specific requirements.\n\nLogpush does not offer storage or search functionality for logs; its primary aim is to send logs as quickly as they arrive.\n\nCloudflare Logpush supports pushing logs to storage services, SIEMs, and log management providers via the Cloudflare dashboard or API.\n\nCloudflare aims to support additional services in the future. Interested in a particular service? Take this [survey](https://goo.gl/forms/0KpMfae63WMPjBmD2).\n\n## Limits\n\nThere is currently a max limit of **4 Logpush jobs per zone**. Trying to create a job once the limit has been reached will result in an error message: `creating a new job is not allowed: exceeded max jobs allowed`.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | No | No | Yes |\n\nNote\n\nUsers without an Enterprise plan can still access [Workers Trace Events Logpush](https://developers.cloudflare.com/workers/observability/logs/logpush/) by subscribing to the [Workers Paid](https://developers.cloudflare.com/workers/platform/pricing/) plan.\n\n</page>\n\n<page>\n---\ntitle: Logpush MCP server · Cloudflare Logs docs\nlastUpdated: 2025-10-09T17:32:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/logs/logpush-mcp-server/\n  md: https://developers.cloudflare.com/logs/logpush-mcp-server/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Logs Engine · Cloudflare Logs docs\ndescription: Logs Engine gives you the ability to store your logs in R2 and\n  query them directly.\nlastUpdated: 2025-10-01T13:53:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/logs/r2-log-retrieval/\n  md: https://developers.cloudflare.com/logs/r2-log-retrieval/index.md\n---\n\nLogs Engine gives you the ability to store your logs in R2 and query them directly.\n\nNote\n\nLogs Engine is going to be replaced by Log Explorer. For further details, consult the [Log Explorer](https://developers.cloudflare.com/log-explorer/) documentation and to request access, complete the [sign-up form](https://cloudflare.com/lp/log-explorer/).\n\n## Store logs in R2\n\n* Set up a [Logpush to R2](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/r2/) job.\n\n* Create an [R2 access key](https://developers.cloudflare.com/r2/api/tokens/) with at least R2 read permissions.\n\n* Ensure that you have Logshare read permissions.\n\n* Alternatively, create a Cloudflare API token with the following permissions:\n\n  * Account scope\n  * Logs read permissions\n\n## Query logs\n\nYou can use the API to query and download your logs by time range or [RayID](https://developers.cloudflare.com/fundamentals/reference/cloudflare-ray-id/).\n\n## Authentication\n\nThe following headers are required for all API calls:\n\n* `X-Auth-Email` - the Cloudflare account email address associated with the domain\n* `X-Auth-Key` - the Cloudflare API key\n\nAlternatively, API tokens with Logs edit permissions can also be used for authentication:\n\n* `Authorization: Bearer <API_TOKEN>`\n\n### Required headers\n\nIn addition to the required authentication headers mentioned, the following headers are required for the API to access logs stored in your R2 bucket.\n\n* `R2-access-key-id` (required) - [R2 Access Key Id](https://developers.cloudflare.com/r2/api/tokens/)\n* `R2-secret-access-key` (required) - [R2 Secret Access Key](https://developers.cloudflare.com/r2/api/tokens/)\n\n## List files\n\nList relevant R2 objects containing logs matching the provided query parameters, using the endpoint `GET /accounts/{accountId}/logs/list`.\n\n### Query parameters\n\n* `start` (required) string (TimestampRFC3339) - Start time in RFC 3339 format, for example `start=2022-06-06T16:00:00Z`.\n\n* `end` (required) string (TimestampRFC3339) - End time in RFC 3339 format, for example `end=2022-06-06T16:00:00Z`.\n\n* `bucket` (required) string (Bucket) - R2 bucket name, for example `bucket=cloudflare-logs`.\n\n* `prefix` string (Prefix) - R2 bucket prefix logs are stored under, for example `prefix=http_requests/example.com/{DATE}`.\n\n* `limit` number (Limit) - Maximum number of results to return, for example `limit=100`.\n\n## Retrieve logs by time range\n\nStream logs stored in R2 that match the provided query parameters, using the endpoint `GET /accounts/{accountId}/logs/retrieve`.\n\n### Query parameters\n\n* `start` (required) string (TimestampRFC3339) - Start time in RFC 3339 format, for example `start=2022-06-06T16:00:00Z`\n\n* `end` (required) string (TimestampRFC3339) - End time in RFC 3339 format, for example `end=2022-06-06T16:00:00Z`\n\n* `bucket` (required) string (Bucket) - R2 bucket name, for example `bucket=cloudflare-logs`\n\n* `prefix` string (Prefix) - R2 bucket prefix logs are stored under, for example `prefix=http_requests/example.com/{DATE}`\n\n### Example API request",
      "language": "unknown"
    },
    {
      "code": "Results can be piped to a file using `> logs.json`.\n\nAdditionally, if you want to receive the raw GZIP bytes without them being transparently decompressed by your client, include the header `--header \"Accept-Encoding: gzip\"`.\n\n## ​Retrieve logs by Ray ID\n\nUsing your logs stored in R2 - the Logpull RayID Lookup feature allows you to query an indexed time range for the presence of an RayID and return the matching result. This feature is available to users with the Logpull RayID Lookup beta subscription.\n\nThe ability to look up a RayID is a two-step process. First, a time range needs to be indexed before being able to request a record by the RayID.\n\nIndexes will automatically expire after seven days of no usage.\n\n### Index a time range\n\nBefore executing your query, you can specify the time range you would like to index in order to narrow down the scope of the query. In the following example, we index one minute of logs stored in the R2 bucket `\"cloudflare-logs\"` under the prefix `\"http_requests/{DATE}\"`.\n\n### Example API request",
      "language": "unknown"
    },
    {
      "code": "## Lookup a RayID\n\nAfter indexing a time range, perform a `GET` request with the RayID. If a matching result is found in the indexed time range, the record will be returned. Note that the parameters have moved from the request body and into the URL. The `-g` flag is required to avoid the `{DATE}` parameter from being misinterpreted by cURL.\n\n### Example API request",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "2. Connect to WebSocket",
      "id": "2.-connect-to-websocket"
    },
    {
      "level": "h3",
      "text": "Angle Grinder",
      "id": "angle-grinder"
    },
    {
      "level": "h2",
      "text": "Datasets available",
      "id": "datasets-available"
    },
    {
      "level": "h2",
      "text": "Export",
      "id": "export"
    },
    {
      "level": "h2",
      "text": "Limits",
      "id": "limits"
    },
    {
      "level": "h2",
      "text": "Connect with us",
      "id": "connect-with-us"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h3",
      "text": "Limitation",
      "id": "limitation"
    },
    {
      "level": "h2",
      "text": "Limits",
      "id": "limits"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Store logs in R2",
      "id": "store-logs-in-r2"
    },
    {
      "level": "h2",
      "text": "Query logs",
      "id": "query-logs"
    },
    {
      "level": "h2",
      "text": "Authentication",
      "id": "authentication"
    },
    {
      "level": "h3",
      "text": "Required headers",
      "id": "required-headers"
    },
    {
      "level": "h2",
      "text": "List files",
      "id": "list-files"
    },
    {
      "level": "h3",
      "text": "Query parameters",
      "id": "query-parameters"
    },
    {
      "level": "h2",
      "text": "Retrieve logs by time range",
      "id": "retrieve-logs-by-time-range"
    },
    {
      "level": "h3",
      "text": "Query parameters",
      "id": "query-parameters"
    },
    {
      "level": "h3",
      "text": "Example API request",
      "id": "example-api-request"
    },
    {
      "level": "h2",
      "text": "​Retrieve logs by Ray ID",
      "id": "​retrieve-logs-by-ray-id"
    },
    {
      "level": "h3",
      "text": "Index a time range",
      "id": "index-a-time-range"
    },
    {
      "level": "h3",
      "text": "Example API request",
      "id": "example-api-request"
    },
    {
      "level": "h2",
      "text": "Lookup a RayID",
      "id": "lookup-a-rayid"
    },
    {
      "level": "h3",
      "text": "Example API request",
      "id": "example-api-request"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    }
  ],
  "url": "llms-txt#filter-when-the-request-path-contains-\"/static\"-and-the-request-hostname-is-\"example.com\":",
  "links": []
}