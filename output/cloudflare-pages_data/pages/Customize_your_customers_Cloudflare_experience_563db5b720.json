{
  "title": "Customize your customers Cloudflare experience",
  "content": "## Managed features in Cloudflare for platforms\n\nCloudflare for Platforms gives you much more than just SSL certificate management. We give you built-in features to control security and performance capabilities, at scale, for each of your clients. Cloudflare's security features, such as [DDoS](https://developers.cloudflare.com/ddos-protection/), [WAF](https://developers.cloudflare.com/waf/), [Bot Management](https://developers.cloudflare.com/bots/), and [Rate Limiting](https://developers.cloudflare.com/waf/rate-limiting-rules/) are seamlessly extended to clients on your platform. Security posture can be customized within [Managed Rules](https://developers.cloudflare.com/waf/managed-rules/) for individual customers, to exempt good traffic or tighten security. On the [performance](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/) side, [Cache](https://developers.cloudflare.com/cache/), [Argo Smart Routing](https://developers.cloudflare.com/argo-smart-routing/), and HTTP/2 features like [Early Hints](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/early-hints-for-saas/) provide scalable and customizable behavior for all of your customers. Customizable cache rules lets you drive high hit rates across all of your customers.\n\nIf you need even more flexibility than our rules provide, to give individual behavior to thousands or millions of customers, [Custom Metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/) allows complete per-client flexibility. By setting tags like `WAF: On` or `Performance: Premium` for each customer, you can customize their security and performance feature set. We have built features like [WAF for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/waf-for-saas/) which interface with this metadata directly; as well as an API within our Workers serverless environment to use them within custom code.\n\n## Scalable serverless applications with Workers for Platforms\n\nIf you need more customization than even metadata can provide, or are running a service where your customers write or generate their own application code, [Workers for Platforms](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/) lets you deploy a complete serverless application for each of your customers.\n\nWe provide several key features such as the [Dispatch Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/dynamic-dispatch/), which gives you infinite flexibility in deciding which customer application to route to. For example, you can run security checks, then decode an HTTP header telling you the user's ID, and then load the appropriate serverless application for this user's request. [Outbound Workers](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/outbound-workers/) give you additional visibility and control into what Internet resources your customer's applications can access, providing a familiar security model in a distributed deployment.\n\nWe also provide features for [observability](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/observability/), [configuration](https://developers.cloudflare.com/terraform/), and many other tools needed for a production-grade platform deployment. These are detailed in other [reference architectures](https://developers.cloudflare.com/reference-architecture/) and function the same way for platform cases as for the more standard models described in those guides.\n\nLet's review three common use cases where Cloudflare for Platforms can enable providers to seamlessly extend SSL, performance, and security to their end customers.\n\n### SSL issuance at scale for your platform\n\nIn this common design, Cloudflare enables your platform to issue SSL certificates and provide performance and security features. We will not customize the features for each of your clients, but will provide common capabilities for everyone who uses the platform.\n\n1. Cloudflare secures traffic from your clients to your platform, at global scale, by validating and distributing SSL certificates.\n\n2. In this design, you will use the same L7 configuration - that is, all of the features that act on your traffic, and run after SSL, for each of your clients.\n\n3. Just set up a [Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) zone and [order a custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/create-custom-hostnames/) for each client hostname. The system will take you through an easy flow to point each client's traffic to your platform, and order their certificate.\n\n1. You can almost always use our default settings through this process, but bespoke SSL customization is also possible.\n   2. Origin traffic routing is also handled through the SSL for SaaS process. Our default configuration is secure for most needs.\n      * For highly secure use cases, you can use [Authenticated Origin Pulls](https://developers.cloudflare.com/ssl/origin-configuration/authenticated-origin-pull/), [Dedicated CDN Egress IPs](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/), or an advanced design with [Tunnels](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/).\n\n![Figure 5](https://developers.cloudflare.com/_astro/figure5.C5V4KUCx_Z1Ykmop.svg)\n\n### Feature Customization for your Platform customers\n\nHere, we are not just provisioning a certificate for each client - we are giving each of them a custom configuration. For example, your Basic tier only gets essential WAF, Advanced tier gets Bot management. You can also run common features across all customers.\n\n1. In addition to securing SSL traffic, use an additional field provided when you add each customer ([Custom Metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/)) to tag the correct feature set.\n2. Cloudflare features read the Metadata to customize for each client. [WAF features are the key security customization](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/waf-for-saas/). Provide different levels of security, or even customized WAF rulesets.\n3. [On the performance side,](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/) you can also add Argo Smart Routing, Cache, and Early Hints to level up the performance for chosen customers.\n\n![Figure 6](https://developers.cloudflare.com/_astro/figure6.CCbjP4Rl_Zo8V0X.svg)\n\n### Serverless application platform for your customers\n\nIn the most advanced design, we are customizing a full serverless application in our Workers runtime for each of your customers. Simple Workers perform similar tasks to feature customization. Advanced Workers can run your entire platform on the Cloudflare network.\n\n1. Instead of deploying customized Cloudflare capabilities, each customer has their own \"User Worker\" JavaScript serverless application containing custom code.\n2. You retain control through Dispatch Workers, which determine which code to run, and Outbound Workers, which restrict the access of customer code.\n3. Use advanced Developer Platform capabilities like D1, Workers KV, and Queues to build your entire business on Cloudflare.\n\n![Figure 7](https://developers.cloudflare.com/_astro/figure7.1flW0nWM_1ovxRU.svg)\n\nWith Cloudflare for SaaS, you will be able to easily solve the common challenges that come with a growing platform business. From SSL certificate issuance, through Security, and on to custom serverless applications, Cloudflare for SaaS lets you scale our entire platform to your customers - at the scale of millions.\n\nYou can find further details on all of the features we have discussed here in the following links:\n\n* [Cloudflare for Platforms](https://developers.cloudflare.com/cloudflare-for-platforms/)\n* [Custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/)\n* [Workers for Platforms](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/)\n\n<page>\n---\ntitle: Network-focused migration from VPN concentrators to Zero Trust Network\n  Access · Cloudflare Reference Architecture docs\ndescription: The traditional approach of installing and maintaining hardware for\n  remote access to private company networks is no longer secure or cost\n  effective. IT teams are recognizing the cost and effort to install and\n  maintain their own hardware can be offset with more modern, and more secure\n  cloud hosted services.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/network-vpn-migration/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/network-vpn-migration/index.md\n---\n\nOver the past few years, the traditional approach of installing and maintaining hardware for remote access to private company networks is no longer secure or cost effective. Due to an increase in [vulnerabilities](https://www.networkworld.com/article/2114694/new-vpn-risk-report-finds-nearly-half-of-enterprises-attacked-via-vpn-vulnerabilities.html) found in on-premises VPN products, security and IT teams are looking for solutions that don't require teams to monitor for and respond to [CVE alerts](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=vpn). These same systems also limit the user's bandwidth because they route all user Internet traffic through a single infrastructure which results in a poor user experience. IT teams are recognizing the cost and effort to install and maintain their own hardware can be offset with more modern, and more secure cloud hosted services. User expectations for application performance are exposing limitations in bandwidth constrained, self hosted VPN solutions. In summary, running your own VPN is expensive, high risk and doesn't deliver a great user experience.\n\n![Diagram showing suboptimal traffic paths for traffic to Internet resources.](https://developers.cloudflare.com/_astro/traditional-vpn.BpH8a1pr_Z1BqOUG.svg)\n\nAs such, many organizations are looking to move to a [zero trust](https://www.cloudflare.com/learning/security/glossary/what-is-zero-trust/) security posture using [Zero Trust Network Access](https://www.cloudflare.com/learning/access-management/what-is-ztna/) (ZTNA) services as part of a [Secure Access Service Edge](https://www.cloudflare.com/learning/access-management/what-is-sase/) (SASE) architecture to provide remote access to private resources. With all the critical software running as a cloud service, organizations are relieved of the duty of keeping servers and software up to date. Cloud platforms are also architected for massive scale which significantly increases available bandwidth for end users, therefore improving their experience.\n\n![Diagram showing traffic paths directly flowing to Internet resources.](https://developers.cloudflare.com/_astro/sase-remote-access.CybpgS2A_Z1KbmaL.svg)\n\nIn the old model, the VPN hardware had direct access to the networks the applications resided on and typically users had access to the entire network. New SASE methods of remote access create connectivity from the cloud platform to the networks where applications live, but expose access only to a specific application or network address. Cloudflare's recommended approach is to install software agents, similar to those on end user devices, that create secure tunnels from the cloud to private networks. However, this isn't always an easy path to take. For network administrators trying to quickly replace legacy remote access hardware, having to deploy new servers or go through lengthy change control to deploy software to existing application servers, may not be possible in acceptable time frames. Instead network administrators might be more familiar, and have more control over, creating secure tunnels from cloud SASE platforms to existing network hardware using familiar protocols such as GRE or IPsec. This might even mean using the same hardware appliances that were being used for VPN access, but simply dumbing them down to secure tunnel connectors, and switching off (or removing licenses for) any expensive and vulnerable remote access capabilities.\n\nThis design guide is for organizations in that situation, where they need a fast way to quickly replace or mitigate their use of self hosted remote access hardware and then gradually move to the recommended software agent approach where appropriate.\n\nAudience for this guide\n\nThis guide is specifically aimed at network architects or IT admins who want to use familiar protocols and leverage existing network hardware, potentially the same equipment used for current VPN services, but wish to use those devices as tunnel termination devices and move the VPN and access controls into the cloud as part of a longer term migration away from managing their own hardware.\n\n### Who is this document for and what will you learn?\n\nThis guide is written for network and security experts considering a replacement of their current VPN vendor, while preparing their organization for a zero trust or SASE architecture. It assumes familiarity with networking concepts such as IPsec tunnels, routing tables and split tunneling.\n\n* How Cloudflare can replace a traditional VPN-like implementation\n* How to get visibility into VPN network traffic\n* What you need to consider to implement a Cloudflare solution at scale\n* Steps to take to move to a recommended Zero Trust Network Access implementation\n\nThe solution this guide describes requires you have a contract with Cloudflare that includes:\n\n* Cloudflare One licenses for the amount of users you are looking to onboard\n* Cloudflare Magic WAN\n\nTo build a stronger baseline understanding of Cloudflare, we recommend the following resources:\n\n1. What is Cloudflare? | [Website](https://www.cloudflare.com/what-is-cloudflare/) (five-minute read) or [video](https://www.youtube.com/watch?v=XHvmX3FhTwU) (two minutes)\n2. Blog: [What is SASE? | Secure access service edge | Cloudflare](https://www.cloudflare.com/learning/access-management/what-is-sase/) (14-minute read)\n3. Reference architecture: [Evolving to a SASE architecture with Cloudflare](https://developers.cloudflare.com/reference-architecture/architectures/sase/) (three-hour read)\n\n## Benefits of a SASE platform\n\nTraditional VPN approaches typically provide the following types of access.\n\n* Allowing remote users access to self hosted private applications running on a corporate network\n* Routing all user Internet traffic through a single, concentrated VPN access point where security policies are applied\n\nA SASE platform replaces traditional VPN hardware by offering two key services. First, it maps user access directly to internal applications hosted on corporate networks or in the cloud, unlike hosting your own VPN service which typically provides broad access to the entire corporate network. Second, it enables filtering of Internet traffic close to the user, allowing users to securely access the Internet without routing all traffic through the corporate network, thereby improving efficiency and maintaining security.\n\n### Zero Trust Network Access (ZTNA)\n\nRemote users authenticate and connect to a cloud hosted Zero Trust Network Access (ZTNA) service, which in turn has connectivity into the networks where the private applications reside. Cloudflare's [SASE reference architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/) describes three methods for connecting Cloudflare to your existing applications and networks:\n\n1. Software connectors ([`cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/) or [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/))\n2. IPsec or GRE tunnels using [Magic WAN](https://developers.cloudflare.com/magic-wan/)\n3. Direct network connections using [Cloudflare Network Interconnect](https://developers.cloudflare.com/network-interconnect/)\n\nAll three methods have their specific advantages, however, software connectors are usually preferred when considering a modern Zero Trust implementation for three reasons.\n\n1. They deliver a network connectivity model that is flexible and easy to replicate across environments. You can move the applications and servers with little to no changes in configuration.\n2. Software daemon architecture simplifies scaling to increased traffic demands, just install more agents on more servers.\n3. Because daemons run close to your applications (as opposed to at your network edge), you can build isolated network or application segments in which to enforce policy, preventing lateral movement and getting the full benefits of the zero trust model.\n\nThis guide will initially describe the use of Magic WAN to create IPsec tunnels from Cloudflare to existing network hardware, and then recommend a migration path to move to a software agent based approach.\n\n### Secure Web Gateway (SWG)\n\nTraffic destined for the general Internet is routed via a cloud Secure Web Gateway (SWG). Policies are written that filter requests to malicious websites and allow access to SaaS applications based on user identity and device security posture.\n\nCloudflare's [SASE reference architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/) describes different methods for connecting user devices to Cloudflare, some require the installation of device agents, others require the user simply point their web browser at a URL. In this document, because most traditional VPNs require some client software on the device, we will describe a solution using the Cloudflare [device agent](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/).\n\n### Why a phased approach?\n\nIn situations where existing remote access hardware is vulnerable and there is an urgent need to replace, speed is key. Also, the team tasked with moving away from existing VPN hardware might be more familiar with networks than installing software on servers. Trying to implement a full project to replace existing hardware with a radically different model, that is, deploying software agents, may take weeks rather than days. This guide walks through quickly removing or mitigating existing VPN solutions and then proposes later steps to take full advantage of using all aspects of a SASE platform.\n\nThis approach allows network and security teams to get up-and-running quickly, while gaining experience in modern zero trust deployments to allow for remote access to internal applications. The added visibility into network traffic will also enable teams to gain insight into application usage, and plan for a successful and secure zero trust migration.\n\nThis guide will describe the following phases at a high level, if you need help with specific details related to your environment please [contact Cloudflare](https://www.cloudflare.com/products/zero-trust/plans/enterprise/).\n\n* Phase 1: Quickly replace existing traditional/vulnerable VPN hardware with cloud-based remote access while gaining insight into application traffic.\n* Phase 2: Scaling up and offloading traditional IPsec tunnels.\n* Phase 3: Improving security posture by segmenting application access and enabling clientless access.\n\n## Phase 1: Connectivity and network-based policies\n\nConsider an organization with global IT infrastructure. Specifically, three data centers deployed in Europe, USA and Asia with each their own VPN service. To get the best performance, this VPN implementation requires employees to make a conscious decision to connect to one of the VPN clusters depending on their location. In this example all user Internet traffic is routed through the VPN service, where firewalls apply a level of security protecting users from the dangers of the general Internet.\n\n![A traditional VPN deployment using VPN concentrators spread across three DCs.](https://developers.cloudflare.com/_astro/vpn-concentrators.B1KJmuAT_14Hm2W.svg)\n\nDuring this first phase, network connectivity will be created between user devices and the private networks they currently access via existing network infrastructure. This is achieved in two ways.\n\n* On employee devices install the Cloudflare [device agent](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/). This replaces the use of existing VPN client software.\n* Using existing network hardware in the data center, create IPsec tunnels to Cloudflare which are managed using Cloudflare Magic WAN service.\n\nBoth employee devices and data center networks will connect to their closest Cloudflare server. This is thanks to [Cloudflare's anycast architecture](https://www.cloudflare.com/learning/cdn/glossary/anycast-network/), and ensures the most optimal path for user traffic without any effort by employees or IT support staff. Users no longer need to make a choice to which VPN service region to connect to, as Cloudflare will always ensure they connect to the closest and most responsive service for the best access performance to their private applications.\n\n### Connecting networks to Cloudflare\n\nFigure 4 shows traffic from end user devices to Cloudflare and tunnels routing traffic to private data centers. When user traffic reaches the closest Cloudflare access point, Cloudflare will route traffic destined for private applications directly to the data centers, while processing Internet-bound traffic through Cloudflare's [Secure Web Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) (SWG). It is possible to leverage existing DNS services to resolve requests to private addresses using Cloudflare [Gateway DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/). [Magic WAN](https://developers.cloudflare.com/magic-wan/on-ramps/) is used to create IPsec tunnels between Cloudflare and data centers and is configured with static routes that determine how traffic reaches each existing network and applications.\n\n![A high level design of Cloudflare traffic routing for phase 1 of the migration.](https://developers.cloudflare.com/_astro/phase-1.ghshUb-E_k1BN0.svg)\n\nBy using existing network or security appliances to terminate IPsec tunnels, secure off-ramps can be created with limited impact on the current infrastructure. These IPsec tunnels also allow for outbound server-initiated traffic to continue flowing. However, depending on the scale of the deployment, the existing appliances might run into bandwidth limitations. It is best to consider this first phase a 'pilot' or low-scale deployment to get up and running quickly and validate user-application connectivity. The next phase will improve on the design using the insights gathered during this phase.\n\nWith such a design in place, Cloudflare will be able to filter traffic based on the identity of the requesting user. For example, users authenticated to the corporate identity provider and are members of the \"Engineering\" group will only be allowed access to the internally hosted source code repository. Furthermore, the user device may need to pass [certain posture checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/) before connecting. There are [example network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/#restrict-access-to-private-networks) in the zero trust documentation you can use as a reference. In essence, this will enable you to define network access policies using user identities instead of their associated IP address ranges. Getting rid of traditional 5-tuple ACLs will be a first step towards a zero trust model.\n\n### Device agent deployment\n\nNow that we've connected your networks to Cloudflare, we need to get traffic from employee devices to the Cloudflare network which requires the [device agent](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/). When the agent is initially installed, users are prompted to authenticate via an identity provider (IdP) configured with Cloudflare. The IdP will ensure users authenticate using an existing identity and can also import group membership information used in access policies. [Device enrollment policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/device-enrollment/) are used to ensure only the right users, authenticated with the right methods and using secure devices can connect new devices to your organization’s Cloudflare Zero Trust instance before they even get access to any applications.\n\nUse [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/) to apply different device agent configurations to different users – or the same users in different locations using [Managed networks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/managed-networks/). For companies which don't route Internet traffic via their VPN server, device profiles allow you to [configure the device agent to exclude Internet traffic](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) from the Cloudflare tunnel and connect directly to the Internet. Note that this guide does heavily recommend sending Internet bound traffic via Cloudflare where you have greater control over the security of that traffic. But you can selectively bypass Cloudflare for bandwidth heavy traffic such as video conference calls.\n\nTraffic from employees using the device agent destined for internal resources will have a source IP in the 100.96.0.0/12 IP range. This is a range from the [RFC 6598 Carrier-grade NAT space](https://datatracker.ietf.org/doc/html/rfc6598) which should be added as a route in the data center regions to allow for traffic to flow back to these users. See for more information the [Magic WAN with WARP integration](https://developers.cloudflare.com/magic-wan/zero-trust/warp/) documentation.\n\n### Deploying software connectors for DNS\n\nAlthough this phase focuses on using the Magic WAN service and IPsec tunnels for the bulk of the employee traffic, the Cloudflare software connectors play a key role in DNS resolution of internal hostnames. Getting experience with using these software connectors will also help in the next phase, so efforts to define the processes to deploy and manage them should start in this first phase.\n\nCloudflare offers two types of software connectors:\n\n* [`cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/)\n* [WARP connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/)\n\nAs discussed in the introduction, `cloudflared` is the preferred method for Zero Trust Network Access, but only supports inbound connectivity to your networks and application servers, any server initiated connection will not go via the tunnel and instead follow the server's default network path. WARP connector is designed to create tunnels that facilitate both inbound and outbound connectivity, but it doesn't currently have the same level of failover support and ease of configuration. For this guide, we will be discussing using `cloudflared` as it supports the internal DNS use case described.\n\nFor large remote access use cases, Cloudflare recommends deploying connectors to dedicated hosts. See the [System Requirements documentation](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/tunnel-availability/system-requirements/) for more deployment recommendations and server sizing. Where to deploy these servers depends on the access they need and the internal firewall rules and segmentation of the network. Some customers start with their first deployment in their DMZ, while others install it deeper in their network and evolve from there.\n\nInstalling `cloudflared` is best done in an automated manner, so we recommend deploying using a virtualization technology such as Docker or deploying as VMware guests and configuring via Ansible. Preferably, as traffic using `cloudflared` tunnels increases, such systems can scale the deployment automatically based on real-time metrics collected from the hosts. `cloudflared` instances can be monitored using the [Prometheus metrics endpoint](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/monitor-tunnels/metrics/). Prometheus is an HTTP-based monitoring and alerting system similar in functionality to SNMP, exposing metrics that can be polled from the resource to be monitored. Most monitoring systems on the market today support Prometheus as a format to collect the metrics needed for alerting and automatically scaling the deployment.\n\nFor more information about deploying `cloudflared` connectors at scale:\n\n* [Various guides to deploy and update](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/deployment-guides/) connectors in environments such as Ansible, Terraform and Kubernetes\n* High availability using [replicas](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/tunnel-availability/#cloudflared-replicas)\n* [Monitor tunnels with Grafana](https://developers.cloudflare.com/cloudflare-one/tutorials/grafana/)\n\n### DNS resolution with Resolver Policies\n\nAs you can see in Figure 4, both DNS and general network traffic will flow from the employee device to Cloudflare. By default, the device agent forwards all DNS queries to Cloudflare for inspection and filtering based on [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/). This is great, because it will allow administrators to configure [DNS policies to block potential security threats](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/common-policies/#block-security-threats) and immediately start to protect employees as they go online. This also applies to situations where Internet traffic is from the tunnel to Cloudflare, but the client still resolves hostname requests via Cloudflare DNS services.\n\nFor internal domains, however, Cloudflare will need to know how to resolve them. This is where [resolver policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/) come into play. After the DNS policies are applied to incoming DNS requests, customers can choose to forward requests for internal DNS hostnames to their internal DNS servers. For example, the domain `example.local` might be hosted on a DNS server running at 10.10.10.123. A resolver policy will make sure requests for hostnames part of that domain will be sent to that IP.\n\nA tunnel exposing a route to the internal DNS server is needed. `cloudflared` should be deployed on a host that can route DNS traffic to the 10.10.10.123 IP address. Requests for internal domains via the DNS gateway will then be redirected to this DNS server, via the tunnel.\n\n### Analytics and logging\n\nAs steps are taken in this first phase and the first users will start accessing applications, the need for proper monitoring and logging will become apparent. Having visibility into the traffic flowing through Cloudflare will help with:\n\n* Operational activities such as troubleshooting by your support staff.\n* Monitoring for potential threats by a SOC, possibly using a security information and event management ([SIEM](https://www.cloudflare.com/learning/security/what-is-siem/)) service.\n* Visibility into application traffic to see where potential security and performance improvements can be made (see also phase 2).\n\nCloudflare provides visibility at different levels, available through the dashboard or exported using [Logpush](https://developers.cloudflare.com/logs/logpush/). For traffic flowing over Magic WAN IPsec tunnels, [Network Analytics](https://developers.cloudflare.com/analytics/network-analytics/) can be found in the dashboard and through the [GraphQL API](https://developers.cloudflare.com/analytics/graphql-api/). This will show sampled statistics of the traffic and can be used for trend and traffic flow analysis.\n\nNext are more detailed [network session logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/) that collect information on all network connections/sessions going through Cloudflare's secure web gateway, including unsuccessful requests. These are followed by [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/), which contain information about triggered policies as traffic gets inspected by the gateway engine. A combination of these logs will enable full visibility into all network flows, including users' identities. Using this information, network and security teams can run their analysis on what type of traffic flows where, and use that to plan for the next steps.\n\nFinally, for real-time alerting, [Cloudflare Notifications](https://developers.cloudflare.com/notifications/get-started/) can be configured for events such as IPsec and `cloudflared` tunnel health, as well as Cloudflare infrastructure status in general.\n\n## Phase 2: Scaling up and offloading IPsec\n\nIn most environments the IPsec termination points are limited in their throughput and sooner or later this could pose a problem when scaling up to the traffic across the entire business. The final step of phase 1 will provide you with insight into application traffic flow. Although you might not have been able to completely map your application landscape, you probably will have found some applications that cause significant load on the current IPsec tunnels.\n\nFortunately, most of these applications can be migrated one-by-one to the more scalable software connector based tunnels. Any application which doesn't rely on server-initiated traffic is eligible for this type of migration. With the experience gained during the initial deployment of `cloudflared` in phase 1:\n\n1. Deploy two or more `cloudflared` instances in the relevant environment, the USA datacenter in the example below.\n2. Add [Private Networks to the tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/) to define routing and access that is scoped more specifically to the network and applications it handles traffic for. For example, expose the 10.20.56.0/24 subnet via the software connector tunnel, instead of the larger 10.20.0.0/16 exposed by the Magic WAN managed IPsec tunnel.\n3. Traffic from employees will now be routed via the software connector tunnel for the /24 subnet instead of the /16 route going over the IPsec tunnel, thereby offloading the reliance on the IPsec termination device.\n\n![An evolved architecture diagram showing software connector based tunnels offloading (or replacing) the IPsec tunnels.](https://developers.cloudflare.com/_astro/phase-2.DT29_r7n_Z1oEIUV.svg)\n\nIn some cases (such as the Asia datacenter above) this might mean that the IPsec tunnels are not needed anymore and software connectors are the sole connection into the infrastructure. In that case, the whole 10.30.0.0/16 subnet can be managed by `cloudflared` and the IPsec tunnel (and its related hardware) decommissioned. It is likely that this phase will be an ongoing effort: as more applications are mapped and traffic flows deemed eligible for software connector based tunnels, they will be migrated as needed.\n\n## Phase 3: Application-based policies\n\nThe first two phases of this guide have resulted in a design very similar to traditional VPNs leveraging VPN concentrators, where policy enforcement happens at the perimeter. Although we've done so for reasons laid out in the introduction, the promise of a zero trust architecture is to improve security posture by defining smaller application/network segments for which security policies are applied as close to the resource as possible.\n\nThis phase is about making the resources exposed behind the tunnels smaller and more isolated to prevent lateral movement within internal networks. You will be able to use the visibility gained in the previous phases to select an application (or set of applications), associated IP addresses and deploy a dedicated software connector instance. See [the documentation on how to deploy connectors and expose private networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/) and in step 3 configure the IP addresses of the application.\n\n![Example architecture of tunnels deployed per application to improve security posture by reducing lateral movement within data centers.](https://developers.cloudflare.com/_astro/phase-3.CMITQCmp_ZwM1sC.svg)\n\nBecause each software connector instance will be dedicated to the application, it can be configured as the sole entry point. Traffic to and from the network segment where the application resides can be fully blocked off, preventing any internal lateral movement. All that is required is a valid outbound route to the Internet for the software connector to create the tunnel, and for the network/application to be able to reach the server the software connector is deployed on. The access controls doesn't just manage IP routing, but also at the protocol level. So with this approach you can define access only to HTTPS on that server, which may also be running SSH and other services. But you only want to define access specifically to that application port.\n\nIn the example above, subnets X and Y are completely segmented from the rest of the data center. Traffic to the applications running in those subnets (10.10.45.1 and 10.20.56.1, respectively) can only flow through Cloudflare with the associated authentication and authorization policies applied. One to one deployment of software connectors is not always the right approach. You might have several applications running on a private network, and deploy multiple servers running `cloudflared` to handle traffic for the applications.\n\n### Clientless access\n\nIn addition to routing traffic for private IP addresses, `cloudflared` can expose internal applications via publicly resolvable hostnames. This makes it possible to connect to such applications without using any software on the device. This can be very useful for use cases where you are unable to install software on the device, such as giving application access to contractors or partners.\n\nIn the example below, `erp.example.com` is added as [Public Hostname](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/routing-to-tunnel/) to the tunnel, routing traffic to port 80 and/or 443 to a specific IP address on the internal subnet Y. Access to this resource from the Internet is then protected using [Cloudflare Access security policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) which also rely on the IdP connection you've set up for onboarding your employees.\n\n![Adding a public hostname to a tunnel for clientless access to internal applications.](https://developers.cloudflare.com/_astro/clientless-access.Cnw_KhKM_ZwM1sC.svg)\n\nNot all applications will be suitable for this type of access. Only HTTP(S) applications or [applications that can be rendered in the browser](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/) such as SSH and VNC are supported. To learn more about such a deployment and additional advanced options such cookie settings, browser isolation and using the Access token in your application for authentication, see the [self-hosted application documentation](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/).\n\nThis design guide started out with a fairly traditional VPN environment with its common features, limitations and risks. By using a combination of Cloudflare on user devices and Magic WAN towards the datacenter networks, phase one and two described a low-risk design to migrate using existing technology and knowledge. This already brought about benefits in terms of decommissioning of VPN concentrators, improved network visibility and improving performance for users to access internal resources.\n\nPhase three improved on the design by introducing identity-based network policies and smaller network segments with software connectors. This has further opened up the opportunity to offer other zero trust access models such as clientless access for web applications and browser-rendered VNC or SSH sessions.\n\nThe flexibility of the Cloudflare connectivity cloud to connect any device, application and network enables this zero trust migration to be taken step by step. Thereby reducing risk and allowing network and security teams to adapt their knowledge and architectures in the pace required by their organizations.\n\n* Magic WAN integration: [WARP on-ramp to Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/warp/)\n* Policy configuration: [Gateway Network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/)\n\n<page>\n---\ntitle: Securely deliver applications with Cloudflare · Cloudflare Reference\n  Architecture docs\ndescription: Cloudflare provides a complete suite of services around application\n  performance, security, reliability, development, and Zero Trust.\nlastUpdated: 2025-12-23T15:32:34.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/secure-application-delivery/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/secure-application-delivery/index.md\n---\n\n## Overview and the Cloudflare advantage\n\nCloudflare provides a complete suite of services around application performance, security, reliability, development, and Zero Trust. Cloudflare’s global network is approximately 50 ms away from about 95% of the Internet-connected population and consists of services that run on every server in every data center. The global scale of Cloudflare also allows for a robust threat intelligence source which is constantly fed back into Cloudflare security products to enhance the machine learning models and services even further.\n\n![Cloudflare provides application performance and security services that run on every server in every data center, ensuring the highest level of performance regardless of user location.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-1.WZGcpCJi_2tunRE.webp)\n\nOther differentiators include the fact that Cloudflare is not a point product unlike some vendors who only offer API security or zero trust services or specific performance/security services. Customers have started moving away from the point-product approach due to operational and management complexities, inefficiencies related to not being able to leverage cross-product innovation/integrations, and not being able to leverage scale of the network/resources across all services.\n\n![Cloudflare’s global platform integrates zero trust, network and application services through several product suites including Cloudflare One, Cloudflare’s Developer Platform and our compliance and privacy features.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-2.BYvDdWY__Go124.webp)\n\nAdditionally, customers do not want to be locked in to a specific cloud provider, but many performance and security vendors lock customers into their platform by focusing on and optimizing services to their own cloud and making it operationally difficult to adopt a multi-cloud strategy.\n\nCloudflare is agnostic to where the workloads run or what cloud provider is being used. Customers get the same consistent unified dashboard and operational simplicity whether workloads run in a specific cloud or on-premise. Unlike many vendors, taking advantage of cross-product innovations and integration does not depend on customers using a specific cloud for workloads.\n\nThis document demonstrates how easy it is to use Cloudflare’s collective services regardless of where workloads run. For the example in this document, an application workload will use Cloudflare DNS, CDN, WAF, and Access while also using Cloudflare Tunnel to connect securely to the Cloudflare network. It’s rare for a vendor to provide this comprehensive level of security capability in an operationally simple and consistent fashion.\n\nFor additional details and reference architectures on specific services, see our [reference architecture documents](https://developers.cloudflare.com/reference-architecture/).\n\n## Onboarding and protecting the application with Cloudflare\n\nCloud-based security and performance providers like Cloudflare work as a reverse proxy. A reverse proxy is a server that sits in front of web servers and forwards client requests to those web servers. Reverse proxies are typically implemented to help increase security, performance, and reliability.\n\nNormal traffic flow without a reverse proxy would involve a client sending a DNS lookup request, receiving the origin IP address, and communicating directly to the [origin server(s)](https://www.cloudflare.com/learning/cdn/glossary/origin-server/).\n\nWhen a reverse proxy is introduced, the client still sends a DNS lookup request to its resolver, which is the first stop in the DNS lookup. In some cases, the vendor providing the reverse proxy also provides DNS services; this is visualized in Figure 3 below. However, the client now communicates to the reverse proxy and the reverse proxy communicates to the origin server(s). This traffic flow, where all traffic passes through the reverse proxy, allows for additional application security, performance, and reliability services to be implemented easily for applications.\n\n![Cloudflare provides reverse proxy functionality between clients and origin servers, enabling greater user and application security.](https://developers.cloudflare.com/_astro/Figure_3.CznC1gz__Z1LcAPc.webp)\n\nIn this example, we have a website running on one of the major cloud providers and we want to use Cloudflare DNS, CDN, WAF, and Access. We want to start with these services for demonstration purposes; customers can expand these to include other Cloudflare services as desired. Cloudflare provides the benefit of decoupling all services from the cloud provider and if we want to change cloud providers later or protect other applications running in other clouds, the dashboard and operations all stay consistent.\n\nCustomers can easily and securely connect their web application to the Cloudflare network and leverage application performance and security services. There are several connectivity options that fit different use cases.\n\n### Connectivity options\n\n#### Public connection over the Internet\n\nIn the most basic scenario, the Cloudflare proxy will route the request traffic over the Internet to the origin. In this setup the client and origin are both endpoints directly connected to the Internet via their respective ISPs. The request is routed over the Internet from the client to Cloudflare proxy (via DNS configuration) before the proxy routes the request over the Internet to the customer's origin.\n\nThe below diagram describes the default connectivity to origins as requests flow through the Cloudflare network. When a request for the origin resolves to an IP hosted by Cloudflare, that request is then handled by the Cloudflare network and forwarded onto the origin server over the public Internet.\n\n![Cloudflare provides application performance and security services over Internet connectivity.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-4.B97I5-Ti_Z14uyoE.webp)\n\nThe origin is connected directly to the Internet and traffic is routed to the origin based on the IP address resolved by Cloudflare DNS. The DNS A record associates the domain name with the IP address of the origin server(s) or typically a load balancer the origin(s) are sitting behind.\n\nIn this model, when Cloudflare DNS receives a query for the A record, a Cloudflare anycast IP address is returned, so all traffic is routed through Cloudflare. However, unless additional precautions are taken, it’s possible for the origin to be reached directly bypassing Cloudflare if someone knows the IP address of the origin(s).\n\nAdditionally, in this model, the customer has to open firewall rules for the origin(s) or web server(s) so they can be accessible on the respective http/https ports. However, customers can choose to leverage [Dedicated CDN Egress IPs](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/), which allocates customer-specific IPs that Cloudflare will use to connect back to your origins. We recommend allowlisting traffic from only these networks to avoid direct access.\n\nIn addition to IP blocking at the origin-side firewall, we also strongly recommend additional verification of traffic via either the [\"Full (Strict)\" SSL setting](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/full-strict/) or [mTLS auth](https://developers.cloudflare.com/ssl/origin-configuration/authenticated-origin-pull/) to ensure all traffic is sourced from requests passing through the customer configured zones.\n\nCloudflare also supports [Bring Your Own IP (BYOIP)](https://developers.cloudflare.com/byoip/). When BYOIP is configured, the Cloudflare global network will announce a customer’s own IP prefixes and the prefixes can be used with the respective Cloudflare Layer 7 services. This allows customers to proxy traffic through Cloudflare and still have the customer IP address returned in the DNS resolution. This can be [beneficial](https://blog.cloudflare.com/bringing-your-own-ips-to-cloudflare-byoip/) for cases where the customer IP prefixes are already allow-listed and updating firewall rules is not desirable or present an administrative hurdle.\n\n#### Private connection over the Internet - Tunnel\n\nThe recommended option when connecting origin(s) over the Internet is to have a private tunnel/connection over the Internet for additional security.\n\nA traditional VPN setup is not optimal due to backhauling traffic to a centralized VPN gateway location which then connects back to the origin; this negatively impacts end-to-end throughput and latency. Cloudflare offers [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/) software that provides an encrypted tunnel between your origin(s) and Cloudflare’s network. Also, since Cloudflare leverages anycast on its global network, the origin(s) will, like clients, connect to the closest Cloudflare data center(s) and therefore optimize the end-to-end latency and throughput.\n\nWhen you run a tunnel, a lightweight daemon in your infrastructure, cloudflared, establishes four outbound-only connections between the origin server and the Cloudflare network. These four connections are made to four different servers spread across at least two distinct data centers providing robust resiliency. It is possible to install many cloudflared instances to increase resilience between your origin servers and the Cloudflare network.\n\nCloudflared creates an encrypted tunnel between your origin web server(s) and Cloudflare’s nearest data center(s), without the need for opening any public inbound ports. This provides for simplicity and speed of implementation as there are no security changes needed on the firewall. This solution also lowers the risk of firewall misconfigurations which could leave your company vulnerable to attacks.\n\nThe firewall and security posture is hardened by locking down all origin server ports and protocols via your firewall. Once Cloudflare Tunnel is in place and respective security applied, all requests on HTTP/S ports are dropped, including volumetric DDoS attacks. Data breach attempts, such as snooping of data in transit or brute force login attacks, are blocked entirely.\n\n![aCloudflare provides application performance and security services securely with Cloudflare Tunnel over the Internet.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-5.CMyrXFd3_25PkFt.webp)\n\nThe above diagram describes the connectivity model through Cloudflare Tunnel. This option provides you with a secure way to connect your resources to Cloudflare without a publicly routable IP address. Cloudflare Tunnel can connect HTTP web servers, SSH servers, remote desktops, and other protocols safely to Cloudflare.\n\n#### Direct connection - Cloudflare Network Interconnect (CNI)\n\nMost vendors also provide an option of directly connecting to their network. Direct connections provide security, reliability, and performance benefits over using the public Internet. These direct connections are done at peering facilities, Internet exchanges (IXs) where Internet service providers (ISPs) and Internet networks can interconnect with each other, or through vendor partners.\n\n![Cloudflare provides application performance and security services over a direct connection, Cloudflare Network Interconnect.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-6.Cgv5GAfz_Z2vsWz4.webp)\n\nThe above diagram describes origin connectivity through [Cloudflare Network Interconnect (CNI)](https://blog.cloudflare.com/cloudflare-network-interconnect/) which allows you to connect your network infrastructure directly with Cloudflare and communicate only over those direct links. CNI allows customers to interconnect branch and headquarter locations directly with Cloudflare. Customers can interconnect with Cloudflare in one of three ways: over a private network interconnect (PNI) available at [Cloudflare peering facilities](https://www.peeringdb.com/net/4224), via an IX at any of the [many global exchanges Cloudflare participates in](https://bgp.he.net/AS13335#_ix), or through one of Cloudflare’s [interconnection platform partners](https://blog.cloudflare.com/cloudflare-network-interconnect-partner-program).\n\nCloudflare’s global network allows for ease of connecting to the network regardless of where your infrastructure and employees are.\n\n## Routing to the origin\n\nRegardless of which connectivity model is used, DNS resolution is done first and provides Cloudflare the information of where to route to. Cloudflare can support configurations as an authoritative DNS provider, secondary DNS provider, or non-Cloudflare DNS (CNAME) setups for a zone. For Cloudflare performance and security services to be applied, the traffic must be routed to the Cloudflare network.\n\n### Example: Securing your application with Cloudflare Tunnel and Access\n\n#### Securing connectivity with Cloudflare Tunnel\n\nAlthough there are multiple ways to onboard an application to use Cloudflare services, a common approach is to use Cloudflare DNS as the primary authoritative DNS. The additional benefit for customers here is that Cloudflare is consistently ranked the [fastest available authoritative DNS provider globally](https://www.dnsperf.com/#!dns-providers).\n\nIn this example, we’ll connect our origin server to Cloudflare securely with Cloudflare Tunnel. You can configure DNS in the dashboard and enter the site you want to onboard. You’ll receive a pair of Cloudflare nameservers to configure at your domain registrar’s site. Once that’s completed, Cloudflare becomes the primary authoritative DNS provider.\n\nIf Cloudflare is configured for just routing over the Internet, the DNS configuration would look something like below, where the A record points to the IP address of the origin server or respective load balancer. As Cloudflare is acting as a reverse proxy, the status shows as Proxied.\" As is, Cloudflare is still acting as a reverse proxy so all the Cloudflare services such as CDN, WAF, and Access can be used.\n\n![Typical configuration for directing traffic through Cloudflare network.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-7.DSuS_Zmx_2ukxw6.webp)\n\nWe can also use Cloudflare Tunnel over the Internet to provide for more security and to prevent the need for opening any inbound firewall rules to the origin(s). In this way, instead of an A record in the DNS configuration, we will have a CNAME record pointing to the tunnel we deploy. Here we deploy a tunnel from the origin to the Cloudflare network, and the DNS will automatically be configured. A CNAME record that points to the tunnel will be created; this enforces all traffic going to the origin(s) be routed over the Cloudflare Tunnel.\n\nTo create and manage tunnels, you need to install and authenticate cloudflared on your origin server. cloudflared is what connects your server to Cloudflare’s global network.\n\nThere are two options for creating a tunnel - [via the dashboard](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/) or [via the command line](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/do-more-with-tunnels/local-management/create-local-tunnel/). It’s recommended getting started with the dashboard, since it will allow you to manage the tunnel from any machine.\n\nA remotely-managed tunnel only requires the tunnel token to run. Anyone with access to the token will be able to run the tunnel. You can get a tunnel’s token from the dashboard or via the API as shown below. The command provided in the dashboard will install and configure cloudflared to run as a service using an auth token.\n\nIn the Cloudflare dashboard, navigate to Zero Trust > Networks > Connectors. Select the \"Create a tunnel\" button, name the tunnel, and save.\n\n![Cloudflare allows for easily creating and naming a tunnel.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-8.Z4WG1c9g_Z1fUfO0.webp)\n\nNext, you’ll be presented with a screen where you select the operating system (OS) of your origin server. You will then be provided a CLI command that you can run on your origin that will automatically download and install the Cloudflare Tunnel software.\n\n![Cloudflare supports tunnel deployment/configuration for all popular operating systems.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-9.CdoD37WQ_Z25NUR1.webp)\n\nBelow, the CLI command has been run to download and install the Cloudflare Tunnel software.\n\n![Cloudflare supports easy deployment/configuration of Cloudflare Tunnel via CLI.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-10.CMYXjvNp_1jSgRs.webp)\n\nThe connector will now automatically be displayed as connected.\n\n![On successful configuration, Cloudflare displays the Connectors and status of connection to Cloudflare network.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-11.gt8WHsdP_1btyEv.webp)\n\nIn the dashboard, you can now continue with the next step which is to create the tunnel and map it to a service on the origin as shown below. In this case, all HTTPS traffic will be sent over the tunnel to the origin server.\n\n![Cloudflare Tunnel configuration allows for routing traffic to specific services running on the origin.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-12.NvahhCan_Z2gtglR.webp)\n\nYou can now see in the dashboard that the tunnel has been created and is healthy.\n\n![Cloudflare provides health status of deployed tunnels.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-13.-gtSCOhj_1w78MG.webp)\n\nFurther, if we look at the DNS configuration, we can see a DNS record was automatically created pointing to the tunnel ID. When you create a tunnel, Cloudflare generates a subdomain of `cfargotunnel.com` with the UUID of the created tunnel. Unlike publicly routable IP addresses, the subdomain will only proxy traffic for a DNS record in the same Cloudflare account. It’s not possible for another user to create a DNS record in another account or system to proxy traffic over this tunnel.\n\n![Cloudflare Tunnel automatically creates a CNAME DNS entry directing traffic to the deployed tunnel](https://developers.cloudflare.com/_astro/secure-app-dg-fig-14.7RsLkGj__Z1YayH1.webp)\n\nWe now have secure application access. Users can only access the application through the tunnel connected to the Cloudflare network. Further, since Tunnel uses outbound connections to Cloudflare and any return traffic from an outbound connection will be allowed, no inbound firewall rule is required creating less overhead and more operational simplicity.\n\nIf you were to deploy the tunnel via CLI, after the tunnel install, you would also need to authenticate [cloudflared](https://developers.cloudflare.com/cloudflare-one/glossary/?term=cloudflared) on the origin server. cloudflared is what connects the server to Cloudflare’s global network. This authentication can be done with the `cloudflared tunnel login` command as shown below.\n\n![Cloudflare provides for easily authenticating Cloudflare Tunnel with a Cloudflare account.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-15.SDbZBRZ0_Z1Bm5T8.webp)\n\nYou’ll be asked to select the zone you want to add the tunnel to as shown below.\n\n![Cloudflare can enforce tunnel-only connections to a specific zone.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-16.HaC4ddok_Zol2E9.webp)\n\nNext, you’ll authorize the tunnel for the zone.\n\n![Users must authorize the zone a tunnel connects to.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-17.Q5VBNA6l_Z20oGMU.webp)\n\nFinally, you should receive confirmation that a certificate has been installed allowing your origin to create a tunnel on the respective zone.\n\n![Cloudflare provides a confirmation on successfully installing a certificate to origin, allowing it to connect via Tunnel to the Cloudflare network.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-18.BGUm8dv9_w612l.webp)\n\n#### Securing the application with Cloudflare Access\n\nThe current setup as described prior in this document is shown below, where the origin server(s) are connected to the Cloudflare network via Tunnel. Now, we can start to consume Cloudflare services.\n\n![Cloudflare behaves as a proxy where traffic is directed and performance and security services applied.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-19.BOD18Aay_Z1VXnse.webp)\n\nCurrently the origin is only accessible via Cloudflare Tunnel. Because a public hostname is used, access to the origin is public. The application is secured behind Cloudflare and protected from DDoS and other types of attacks. For additional security, Cloudflare Access can be used to place a layer of authentication and access controls in front of the tunneled application. Access enforces an authentication step before requests to the origin can be served. Many other identity, device and network attributes can be used in the policy, allowing customers to define access beyond just authentication. For example, customers can define the network the request originates from, as well as ensuring the user device is running the latest operating system.\n\nBelow, you can see an application has been created for cftestsite3.com.\n\n![Cloudflare Access allows for creating application policies to secure application access.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-20.Uy7D6cRj_Z2juDhQ.webp)\n\nLooking at policy configuration below you can see it requires users to be part of the \"Secure Employees\" Access group.\n\n![Cloudflare allows assigning multiple Access groups to an application to enforce a set of predefined policies.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-21.Do5840XS_2fR97N.webp)\n\nIf we take a deeper look at the \"Secure Employees\" Access group, it can be seen below that members are from the company’s Okta identity provider (IdP) group called \"Employees.\" Further, the Access group is enforcing multi-factor authentication (MFA).\n\n![Cloudflare Access groups allow for simplicity in defining criteria for certain groups/individuals to access the application.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-22.BkeW7CIH_Z27byvk.webp)\n\nLooking at the \"Image and Video Gallery\" application, under \"Authentication,\" customers can also manually select identity providers users can use to connect to this application.\n\n![Cloudflare Access supports all major Identity Providers (IdPs) and users can manually select which IdPs can be used.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-23.Dh6tiJyh_24EKim.webp)\n\nWe now have secure application access to the origin(s) via Tunnel and also authentication and access policies to the application via Access. When users try to access the site, they are greeted with a Cloudflare Access page asking users to authenticate with the configured IdP; the page can be customized to customer’s liking as shown below.\n\n![Using Cloudflare Access configured with a company’s IdP, users are forced to authenticate to access the application.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-24.DLtovmiZ_aKt30.webp)\n\n### Using other Cloudflare services (CDN, WAF, Security Analytics, etc.)\n\nIn the current setup, the origin server(s) are securely connected to the Cloudflare network via Cloudflare Tunnel and Cloudflare Access via policies enforcing authentication and other security requirements.\n\nSince Cloudflare is already set up and acting as a reverse proxy for the site, traffic is being directed through Cloudflare, so all Cloudflare services can easily be leveraged including CDN, Security Analytics, WAF, API Shield, Bot Management, Page Shield for client-side security, etc.\n\nWhen a DNS lookup request is made by a client for the respective website, in this case \"cftestsite3.com,\" Cloudflare returns an anycast IP address, so all traffic is directed to the closest data center where all services will be applied before the request is forwarded over Cloudflare Tunnel to the origin server(s).\n\nCloudflare CDN leverages Cloudflare’s global anycast edge network. In addition to using anycast for network performance and resiliency, the Cloudflare CDN leverages [Argo Tiered Cache](https://developers.cloudflare.com/cache/how-to/tiered-cache/) to deliver optimized results while saving costs for customers. Customers can also enable [Argo Smart Routing](https://developers.cloudflare.com/argo-smart-routing/) to find the fastest network path to route requests to the origin server. As shown below, the Cloudflare CDN is now caching content globally and granular CDN policies to affect default behavior can be applied.\n\n![Cloudflare provides analytics for visibility into caching data and performance.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-25.NHZVy6aF_1tvEtq.webp)\n\nThere are [different caching topologies and configurations available](https://developers.cloudflare.com/reference-architecture/architectures/cdn/). Below, you can see a Cache Rule has been configured to cache requests to the domain and override the origin TTL.\n\n![Cloudflare Cache Rules allow for granular control of caching.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-26.DeIWbffl_8Xkij.webp)\n\n[Cloudflare Cache Reserve](https://developers.cloudflare.com/cache/advanced-configuration/cache-reserve/) has also been enabled by clicking the \"Enable storage sync\" button under \"Caching > Cache Reserve\" in the dashboard. Cache Reserve leverages Cloudflare’s persistent object storage, R2, to eliminate egress costs from other public cloud providers. It improves cache hit ratios by enabling customers to persistently cache data with the push of a single button.\n\n![Cloudflare provides one-click enablement of Cache Reserve which provides persistent object storage for CDN to cut down on egress fees charged by many cloud providers.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-27.B9L-Y7WG_1C2VNF.webp)\n\nAdditionally, as shown below, Cloudflare Security Analytics brings together all of Cloudflare’s detection capabilities and provides a global view and important insights for all traffic going to the respective site. As traffic is being routed through the Cloudflare network, Cloudflare has visibility into threats and insights which are exposed to customers in the dashboard, logs, and reporting.\n\n![Cloudflare Security Analytics brings together all of Cloudflare’s detection capabilities in one place.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-28.bElqNgGP_1YdsXY.webp)\n\nCloudflare WAF rules can be applied to enforce policies on traffic inline. Below a firewall policy is in place to log all traffic with a bot score of < 30 and WAF attack score < 50. A bot score of < 30 signifies all traffic that’s classified as either automated or likely automated and a WAF attack score < 50 signifies all traffic that’s classified as either malicious or likely malicious.\n\n![Cloudflare WAF allows for easy configuration of rules with visibility into how often the rule is hit.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-29.JeDDUmel_10pmlf.webp)\n\nCloudflare WAF allows for granular policies that can leverage many different request criteria including header information. Customers can take a [variety of actions](https://developers.cloudflare.com/firewall/cf-firewall-rules/actions/) including logging, blocking, and challenge.\n\n![Cloudflare allows for matching on a combination of request attributes and Cloudflare data/fields to determine if specific actions should be taken.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-30.Bt_pyY4I_Z11DGxK.webp)\n\nCustomers can use WAF to implement and use custom rules, rate limiting rules, and managed rules. A brief description of each is provided below.\n\n* WAF Custom Rules: provides ability to create custom rules based on different request attributes and header information to block any threat\n\n* WAF Rate Limiting Rules: prevents abuse, DDoS, brute force attempts, and provides for API-centric controls.\n\n* Cloudflare Managed Ruleset: provides advanced zero-day vulnerability protection\n  * Cloudflare OWASP Core Ruleset: block common web application vulnerabilities, some of which are in OWASP top 10\n  * Cloudflare Leaked Credential Check: checks exposed credential database for popular content management system (CMS) applications\n\nThe same methodology applies for all other Cloudflare Application Performance and Security products (API Shield, Bot Management, etc.): once configured to route traffic through the Cloudflare network, customers can start leveraging the Cloudflare services. Figure 31 displays Cloudflare’s Bot Analytics which categorizes the traffic based on bot score, shows the bot score distribution, and other bot analytics. All of the request data is captured inline and all enforcement based on defined policies is also done inline.\n\n![Cloudflare provides analytics and insights into bot traffic including bot score distribution.](https://developers.cloudflare.com/_astro/secure-app-dg-fig-31.B-ExrLSz_11gLb0.webp)\n\nCloudflare offers comprehensive application performance and security services. Customers can easily onboard and start using all performance and security services by routing traffic to their origin server(s) through Clooudflare’s network. Additionally, Cloudflare offers multiple connectivity options including Cloudflare Tunnel for securely connecting origin server(s) to Cloudflare’s network.\n\n<page>\n---\ntitle: Securing guest wireless networks · Cloudflare Reference Architecture docs\ndescription: This guide is designed for IT or security professionals who are\n  looking at Cloudflare to help secure their guest wireless networks.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\ntags: IPv6\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/securing-guest-wireless-networks/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/securing-guest-wireless-networks/index.md\n---\n\nMany organizations and businesses offer free wireless Internet access to their customers, clients, patients, students, and visitors. In industries like hospitality, providing guest Wi-Fi is often essential. For colleges and universities, having a reliable and secure Wi-Fi service can be a significant factor in attracting potential students and visitors.\n\nOffering free wireless Internet access brings several benefits. Businesses use guest Wi-Fi to enhance customer engagement by directing users to landing pages for marketing campaigns or offering coupons. Additionally, many guest Wi-Fi systems collect valuable user analytics, such as email addresses, browsing behavior, and even dwell time in specific locations. This data can help influence decisions like product placement in stores or drive follow-up email marketing campaigns.\n\nHowever, providing guest Wi-Fi also introduces risks. Malicious users could exploit your network for illegal activities, such as accessing prohibited content, purchasing contraband, or engaging in cybercrime. In some cases, businesses like hotels, cafes, and libraries have faced lawsuits for allegedly enabling illegal downloads through their guest Wi-Fi. These lawsuits, often filed by copyright holders, claim that businesses facilitated piracy by failing to monitor or control the content accessed or downloaded by their guests.\n\n![Figure 1: Guest networks are often directly connected to the Internet with little security.](https://developers.cloudflare.com/_astro/figure1.BV1Def0b_ZSYLX2.svg)\n\nWhile it may be unlikely that your organization could face criminal charges, your organization could become part of lengthy investigations, potentially resulting in legal expenses and reputation damage. In this guide, you will learn how Cloudflare can help minimize risk, provide visibility into guest Internet activity and [better secure your guest wireless network](https://www.cloudflare.com/zero-trust/solutions/secure-guest-wifi/).\n\n### Who is this document for and what will you learn?\n\nThis reference architecture is designed for IT or security professionals who are looking at Cloudflare to help secure their guest wireless networks. To build a stronger baseline understanding of Cloudflare, we recommend the following resources:\n\n* What is Cloudflare? | [Website](https://www.cloudflare.com/what-is-cloudflare/) (5 minute read) or [video](https://www.youtube.com/watch?v=XHvmX3FhTwU) (2 minutes)\n* Cloudflare Zero Trust | <https://www.cloudflare.com/zero-trust/>\n* SASE Architecture with Cloudflare | [/reference-architecture/architectures/sase/](https://developers.cloudflare.com/reference-architecture/architectures/sase/)\n\nThis reference architecture guide will help readers understand:\n\n1. **Cloudflare Gateway DNS**: Learn how to integrate Cloudflare Gateway DNS policies into common guest wireless deployment scenarios.\n2. **Best practices for DNS policies**: Discover effective methods for building guest wireless DNS policies to enforce your acceptable use policy and prevent malicious activities.\n3. **Enhanced visibility and security**:\n\n* Use the Cloudflare Zero Trust dashboard to access detailed logs and analytics, offering insights into DNS queries, traffic patterns, and potential security threats.\n* Enable **Logpush** to export logs to external storage solutions for long-term analysis or compliance purposes.\n* Integrate with your SIEM (Security Information and Event Management) platform to correlate Cloudflare logs with other security data, streamlining incident detection and response.\n\nCloudflare offers an enhanced, protected DNS resolver service for Zero Trust customers. This service utilizes Anycast, a routing technology that enables multiple servers or data centers to share the same IP address. When a request is sent to an Anycast IP address, routers use the Border Gateway Protocol (BGP) to direct the request to the nearest server. As a result, DNS queries are always routed to the closest Cloudflare data center based on your location. With data centers in over 330 cities, Cloudflare operates one of the [largest global networks](https://www.cloudflare.com/network/). This service can also strengthen your organization's security by enabling the creation of policies to filter DNS resolutions for potentially malicious, questionable, or inappropriate destinations. This guide explains how to enable this service and configure your environment to secure guest wireless networks, reducing risks to your organization.\n\nCloudflare [DNS locations](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) are a collection of DNS endpoints which can be mapped to physical entities such as offices, homes or data centers. [Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) identifies locations differently depending on the DNS query protocol. IPv4 traffic is identified from the source IP address from which a DNS query originated. IPv6 traffic can be identified by the unique IPv6 resolver address created in the Cloudflare dashboard. The following sections describe how to ensure DNS queries are appropriately mapped to your physical locations depending on the network environment and protocols being used. Later in this document you will learn how to use the location's IP address as an attribute which you can apply to Gateway DNS policies.\n\nThe goal is to have DNS requests from your Wi-Fi networks be sent via Cloudflare's secure DNS and secure web gateway service, where your DNS policies can filter requests and block those you deem risky. This guide walks through the different possible network architectures you might have for guest networks and gives guidance on how to implement Cloudflare to protect devices on those guest Wi-Fi networks.\n\n## Securing guest traffic sourced from a basic wireless router\n\n### Using business Internet and a static IPv4 address\n\nA common method for providing guest wireless access is to set up a completely separate network from the corporate or production network. For example, a branch office or retail store might use a single wireless router to achieve this. The router would broadcast a guest wireless Service Set IDentifier (SSID), assign IP addresses to connected devices, and provide Internet connectivity. The public static IPv4 address assigned to the router can then serve as a DNS location attribute in the Cloudflare Zero Trust dashboard. If the router's IP address is dynamically assigned by your ISP refer to the section \"Dedicated DNS resolver IPv4 and IPv6 addresses\".\n\nTo route all DNS queries through Cloudflare, update your router's DNS settings in the WAN interface to use Cloudflare's resolver IP addresses. The specific resolver IPs for Zero Trust can be found in the DNS location settings in the Cloudflare dashboard. Refer to your router's manufacturer documentation for detailed configuration steps to update the WAN interface. Typically, devices connected via Wi-Fi will use the router's IP address as their DNS server. The router forwards the DNS queries to Cloudflare on their behalf. As a result, DNS queries from the wireless devices will be sent Cloudflare and originate from the static IP address assigned to the router.\n\nFor enhanced security, prevent wireless guests from accessing other DNS services by creating a firewall rule on the router (if supported). This rule should allow access only to Cloudflare's DNS servers and block all other DNS destinations on UDP/TCP port 53. Additionally, some advanced wireless routers support content filtering. If available, enable options to block DNS over TLS (DoT) or DNS over HTTPS (DoH) to ensure endpoints cannot bypass your configured DNS security settings in Cloudflare.\n\n![Figure 2: When DNS queries are forwarded to Cloudflare, policies can be implemented to prevent access to malicious and high risk destinations. Guest-Security-Block and Guest-Content-Block refer to the specific DNS policies applied to the wireless guest devices.](https://developers.cloudflare.com/_astro/figure2.DLXV4yIx_ZSYLX2.svg)\n\n## Secure guest traffic sourced from an enterprise network\n\nSome companies go beyond using consumer or semi professional grade, all in one wireless routers and deploy guest Wi-Fi access on top of an existing enterprise networking solution. For example, the same Wi-Fi access point hardware might be broadcasting both the enterprise internal network as well as the guest network.\n\n### Segment internal and guest networks\n\nA common approach to separating internal and guest networks involves the use of distinct SSIDs. The internal corporate SSID and the guest wireless SSID can be linked to separate VLANs (Virtual Local Area Networks) or [Dot1q tags](https://en.wikipedia.org/wiki/IEEE_802.1Q), providing virtual segmentation between the networks.\n\nIn this configuration:\n\n1. A subnet is assigned to the guest wireless VLAN.\n2. The default gateway for that subnet is configured on an interface (or virtual interface) of an upstream network device such as a firewall or router.\n3. The device segments guest network traffic from internal network traffic while also acting as a secure gateway to the public Internet.\n\n### Configure DNS for the guest network\n\nSimilar to simpler setups, DNS queries from guest wireless devices should be forwarded to Cloudflare's resolver IPs. You can achieve this by:\n\n* Assigning Cloudflare DNS servers in the DHCP scope for guest devices.\n* Configuring the upstream network device to proxy DNS queries to Cloudflare.\n\nNote, you might also be providing guest devices access to some internal resources, and as such you might configure clients to use an internal DNS service. You can also set up this service to forward Internet bound DNS requests to Cloudflare.\n\nTo enhance security, configure outbound Internet firewall rules to allow DNS queries only to Cloudflare's enterprise resolver IPs on TCP/UDP port 53.\n\n### Assign a unique Public IPv4 address for guest traffic\n\nTo ensure guest traffic is sourced from a unique public IPv4 address:\n\n1. Create a Port Address Translation (PAT) policy on your firewall or edge device specifically for guest traffic.\n   * PAT (or NAT overload) allows multiple devices on the local network to access the Internet using a single public IP address.\n2. Define the source address range as the guest subnet in the firewall settings.\n3. Specify the translated source address—a public IPv4 address—to be used for all Internet-bound traffic originating from the guest network.\n\nRefer to your firewall manufacturer's documentation for detailed instructions on setting up a PAT or NAT overload rule.\n\n### Map guest traffic in Cloudflare\n\nOnce guest network traffic is assigned a unique public IPv4 address, this address can be used as an attribute in the Cloudflare dashboard to map your DNS location effectively.\n\n![Figure 3: This diagram shows how guest Wi-Fi traffic has different DNS filtering policies versus your use of our Gateway DNS service to secure corporate network traffic.](https://developers.cloudflare.com/_astro/figure3.BJGAREAk_2cL9z5.svg)\n\n## Secure guest wireless at locations with a dynamically assigned public IPv4 or IPv6 address\n\n### Dedicated DNS resolver IPv4 and IPv6 addresses\n\nIf you are unable to use a static public IP address on your edge device, Cloudflare offers dedicated IPv4 and IPv6 resolver endpoint addresses that can be assigned specifically to your organization. In this scenario, the destination address to which DNS queries are sent can serve as a method to map your physical location to a Cloudflare DNS endpoint.\n\nCloudflare provides unique IPv6 resolver endpoint addresses at no cost through the Zero Trust dashboard. However, due to the limited availability of IPv4 addresses, dedicated IPv4 DNS endpoints are only available with Cloudflare Enterprise plans.\n\nFor example, if your guest wireless router is dynamically assigned an IPv6 address and an IPv6 DNS server by your ISP, you can modify the IPv6 DNS address to match the IPv6 DNS endpoint address configured in your Cloudflare DNS Location settings.\n\n### Add DNS locations\n\nNow that we have covered various options for sending DNS queries to Cloudflare's DNS resolvers and identifying your organization's guest wireless network—either by its source IP address or a dedicated resolver address—you're ready to create new locations in Zero Trust.\n\nTo get started, navigate to **DNS Locations** in the Zero Trust dashboard. For detailed, step-by-step instructions, refer to the [**DNS Locations**](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) guide. When using IPv4 or IPv6 endpoint filtering and location matching, you can define a network and subnet mask in CIDR notation to represent your location's source IP addresses. For example:\n\n* If all your wireless networks share a public IP address within the same subnet, you can apply a policy to all locations at once using a single DNS location object.\n* To assign unique policies to specific locations, use a host address ending in /32 to represent each location individually.\n\n### Creating DNS policies\n\nTo get started, navigate to firewall policies and select DNS in the Zero Trust dashboard. For detailed, step-by-step instructions, refer to the [DNS Policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/) guide.\n\nTo keep your policies organized, we recommend using meaningful names that clearly indicate their purpose. For instance, a policy named **Guest-Security-Block** conveys:\n\n* **Guests**: Who the policy applies to.\n* **Security**: The type of content being evaluated.\n* **Block**: The action being taken.\n\nCloudflare provides a range of managed categories which you can use to filter a wide range of different types of threats. For example, adding into the DNS policy the [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) Malware will prevent a connected device from making a DNS request to any site that Cloudflare has tagged as being known as part of a malware campaign or might be hosting malware. As well as security categories, we also have [content categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories) which identify sites such as Cryptocurrency, P2P sharing sites or adult themed sites. Cloudflare also manages a list of [applications](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/), so you can filter access to public cloud storage or file sharing sites.\n\nCloudflare also allows [custom feeds](https://developers.cloudflare.com/security-center/indicator-feeds/#publicly-available-feeds) where you can either subscribe to another vendor to provide a list of sites to filter, or you can use some of the built in government based threat feeds. This allows you to be very selective about what sites you wish to filter.\n\nFor devices making requests from known DNS locations, it's also possible to add these to the policy. So you can create different policies for different guest Wi-Fi locations. This can help with situations where local laws require you to prevent access to a specific type of Internet site.\n\nPolicies can be made up of multiple rules, so a single policy can prevent access to high risk websites as well as inappropriate content.\n\n### Recommended policies\n\nCloudflare has several additional recommended DNS policies that can be found in the [Secure your Internet traffic implementation guide](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/build-dns-policies/recommended-dns-policies/). These policies are designed to enhance your organization's overall security and should also be factored in when setting up policies for your internal production web traffic.\n\n### Visibility into Guest DNS Internet Activity\n\nWith DNS traffic now routed through Cloudflare and your wireless networks secured, you can gain detailed visibility into your guests' Internet activity using logs and advanced logging tools. Every DNS request is [logged](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/) in Cloudflare and our dashboard provides a simple search interface. These logs help you understand how your policies are applied and detect trends or patterns in guest Internet usage, providing actionable insights to fine-tune your security configurations.\n\nFor advanced telemetry and seamless data management, consider enabling **Logpush** in your Cloudflare dashboard. Sending these logs to an external source, most commonly a SIEM platform, brings the following benefits:\n\n* **Centralized Analysis**: Consolidate logs from multiple Cloudflare services with other organizational data in your SIEM for comprehensive visibility.\n* **Enhanced Threat Detection**: Correlate DNS activity with other security events to detect patterns of malicious behavior more effectively.\n* **Compliance and Audit Readiness**: Store DNS logs for long-term retention to meet regulatory compliance requirements or support incident audits.\n* **Real-Time Alerts**: Leverage SIEM integration to trigger automated alerts and responses based on suspicious DNS activity.\n* **Operational Insights**: Gain a deeper understanding of guest browsing behavior to identify performance bottlenecks or optimize content filtering policies.\n\nBy leveraging logs, Logpush, and SIEM integrations, you not only enhance visibility into guest Internet activity but also strengthen your organization's overall security posture.\n\n## Going beyond DNS filtering\n\nUp to this point all methods mentioned have revolved around DNS, mainly due to the fact most traffic over guest Wi-Fi networks will utilize DNS and these configurations do not require any agents or certificates installed on devices, for this reason DNS centric protections are always the recommended starting point when it comes to securing guest Wi-Fi networks. Unfortunately there are ways to bypass DNS based security enforcement like:\n\n* Changing your dns resolver manually\n* Using IP address to reach sites (potentially saving IP to fully qualified domain name mappings via host file)\n* Using non sanctioned VPN clients\n\nFor these reasons you should also consider applying security in layers and add network centric enforcement to complement the protections provided via DNS.\n\n![Figure 4: This diagram shows how to connect guest networks to Cloudflare and the high level traffic flow to reach Internet resources.](https://developers.cloudflare.com/_astro/figure4.NuRfhipz_1pSwGM.svg)\n\nTo provide network level filtering, Cloudflare must be in the traffic path for more than just the DNS request. This is achieved by routing Internet-bound traffic over an [IPsec](https://www.cloudflare.com/learning/network-layer/what-is-ipsec/) tunnel to Cloudflare. Cloudflare's [Magic WAN](https://developers.cloudflare.com/magic-wan/) service allows third-party devices to establish IPsec or GRE tunnels to the Cloudflare network. It is also possible to just deploy our [Magic WAN Connector](https://developers.cloudflare.com/magic-wan/configuration/connector/), a pre-configured lightweight network appliance that automatically creates the tunnel back to Cloudflare and can be managed remotely. Once traffic reaches Cloudflare multiple security controls can be overlaid such as:\n\n* Cloud based network firewall ([Magic Firewall](https://developers.cloudflare.com/magic-firewall/))\n* Secure web gateway ([Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/))\n\nBelow is the high level traffic flow that correlates to the above diagram:\n\n1. Internet destined traffic will be routed to cloudflare from connected guest networks, this can be easily done with a policy based route. In most guest Wi-Fi setups devices will only be expected to generate internet bound traffic so in most cases a Policy based route referencing ANY as the destination will be sufficient. Ex Source 192.168.53.0/24 to Destination ANY next hop Cloudflare IPsec tunnel.\n2. Once traffic reaches the cloudflare edge it will first be inspected by magic firewall. Magic Firewall can be used to create network and transport layer blocks which would allow admins to restrict access to certain destination IP's or ports, a common policy could be blocking all DNS traffic not directed towards cloudflare DNS resolvers. Custom lists can be used to import existing lists customers may already have. [IDS](https://developers.cloudflare.com/magic-firewall/about/ids/) can be enabled to monitor if any guest users are attempting to launch known exploits from your Guest network. Managed threat [lists](https://developers.cloudflare.com/waf/tools/lists/managed-lists/#managed-ip-lists) allow you to use cloudflare's auto updated threat intel to block known threats like known malware repositories or botnets.\n3. Traffic is then forwarded to Cloudflare gateway. At gateway network based policies can be created using the same Content categories and Security risks mentioned earlier within DNS based policies, the benefit is when these filters are applied at the network level, even if a user bypasses DNS these policies can still be applied providing multi tiered enforcement. It would be recommended to mirror DNS based rules in accordance with your organization's acceptable use policy. Cloudflare Gateway also acts as a secure outbound proxy and as such can SNAT private address to Internet routable public addresses, by default rfc 1918 addresses will automatically be SNAT to Shared Cloudflare egress ip's. This removes the need for managing PAT directly from your edge device and also provides a layer of privacy as traffic will source from Cloudflare owned ip's when browsing Internet sites. Dedicated Egress ip's unique to your account can also be provided and egress ip selection controlled via policy.\n4. Traffic is now routed to the final Internet destination, return traffic will be routed back through Cloudflare edge and returned to the corresponding IPsec tunnel.\n\nBy following these strategies and leveraging Cloudflare Zero Trust, organizations can offer a secure, reliable, and policy-compliant wireless experience for their guests. These measures not only safeguard networks but also enhance visibility and enable proactive threat mitigation.\n\nIf you are interested in learning more about Gateway, or other aspects of the Cloudflare SASE platform, refer to our [Reference Architecture library](https://developers.cloudflare.com/reference-architecture/) or our [Developer docs](https://developers.cloudflare.com/) to get started.\n\n* [Evolving to a SASE architecture with Cloudflare](https://developers.cloudflare.com/reference-architecture/architectures/sase/)\n* [Magic WAN Connector deployment options · Cloudflare Reference Architecture docs](https://developers.cloudflare.com/reference-architecture/diagrams/sase/magic-wan-connector-deployment/)\n* [DNS policies - Cloudflare Zero Trust](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/)\n\n<page>\n---\ntitle: Streamlined WAF deployment across zones and applications · Cloudflare\n  Reference Architecture docs\ndescription: Learn how to streamline WAF deployment across different zones and applications.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/streamlined-waf-deployment-across-zones-and-applications/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/streamlined-waf-deployment-across-zones-and-applications/index.md\n---\n\nSecurity perimeters have become less defined compared to the traditional \"Castle and Moat\" deployments that were popular in the past. Within a fixed perimeter, it was relatively easier to secure multiple applications using a single Web Application Firewall (WAF) deployment inside a datacenter. Today this approach does not provide enough flexibility as applications and services expand beyond the traditional datacenter. There are several good reasons to configure networks and services in a hybrid approach and to adopt SaaS platforms, so it is valuable to update the WAF approach to cover this scenario.\n\nCloud-based WAF solutions can control the perimeter sprawl with a flexible deployment model that covers applications and services deployed on-premises, on cloud-based IaaS and PaaS environments, and in hybrid environments.\n\nAt the same time, an incorrect implementation of a cloud-based WAF can lead to security policy fragmentation and duplication, causing increased overheads both in maintenance and in monitoring. Aside from the clear economic impact that such inefficiencies bring, the lower efficiency can also degrade the security posture itself. This ultimately can lead to security incidents of varying degrees of severity depending on the scenario.\n\n### Who is this document for and what will you learn?\n\nThis Design Guide is written for security and network administrators / architects that are looking to implement a flexible, cloud-based WAF security configuration. This configuration can span across multiple applications, domains, and services - all deployed in a hybrid environment.\n\nCloudflare offers comprehensive Application Security & Performance solutions, which include a highly-configurable, cloud-based Web Application Firewall (WAF).\n\nIn this guide, you will learn:\n\n* How to implement the Cloudflare WAF and factor common rules.\n* How to easily implement common configurations across multiple applications.\n* How to deploy exceptions and specific configurations when needed.\n* What are the best practices to follow when deploying the Cloudflare WAF.\n\nMost Cloudflare customers onboard multiple Cloudflare Zones within a single Account (or Enterprise Organization). Each Cloudflare Zone is usually mapped to a second-level domain (such as `example.com`), and all its subdomains are then handled within that Cloudflare Zone (`web1.example.com`, `web2.example.com` etc.).\n\nIn this setup, Cloudflare is a DNS-based reverse proxy. Each Fully Qualified Domain Name (FQDN) is configured in its Cloudflare zone, and it points to a customer origin server. In this respect, Cloudflare does not make particular distinctions on what/where that origin server is located. It could be deployed on-premises, it could be a virtual machine running in the Cloud, or it could be a SaaS service provided by a third-party.\n\nFrequently, multiple FQDNs are pointing to the same, shared web infrastructure. This is reached using an IP address or another FQDN, for example. It is also possible that some FQDNs are pointed at dedicated origin infrastructure or to an external SaaS endpoint.\n\nIn many cases, Cloudflare customers end up managing many Cloudflare Zones (such as `example.com`,`example.org`, `myappexample.com` and so on) within a single Cloudflare Account, and many FQDNs within each zone. Frequently, many FQDNs across multiple zones are pointing at a shared web infrastructure behind the scenes.\n\nFor example, you could be in the following (or similar) scenario:\n\n* The majority of your web applications run on a newly deployed in-house Content Management System (CMS)\n* You also have some legacy web applications that are running on their custom stacks.\n* Finally, you may have dedicated infrastructure (managed by a partner) for a few applications.\n\n![Diagram showing the example scenario with multiple domains, subdomains and web applications](https://developers.cloudflare.com/_astro/diagram-1.D8xm98w0_Z1GaG4I.svg)\n\nFrom a WAF setup perspective, this scenario raises interesting requirements:\n\n* To create an easily deployable configuration that implements standard WAF rules configuration in front of most applications.\n* To have the ability to fine tune and tweak which rules are deployed in front of the legacy applications, which may be more prone to false positives than the others.\n* To include a \"catch-all\" configuration, ensuring that a Cloudflare default WAF setup is always applied to all web traffic that does not fall in the above scenarios.\n* To minimize set up time and ongoing maintenance efforts, as applications are added and removed over time.\n\nIn this Design Guide we will review how the Cloudflare WAF operates and what tools are provided to achieve all the above architectural requirements.\n\n## Cloudflare Web Application Firewall\n\nThe Cloudflare WAF operates at both the zone and the account level. There are different [WAF phases](https://developers.cloudflare.com/ruleset-engine/about/phases/) (`http_request_firewall_custom`, `http_ratelimit` and `http_request_firewall_managed`) that map to Custom Rules, Rate Limiting Rules, and Managed Rules. These phases exist both at the account and the zone level. For more information, please [refer to the following documentation](https://developers.cloudflare.com/waf/reference/phases/). It is important to note that the Account rulesets are evaluated before the zone rulesets.\n\n## Example Use Case - Implementing the Cloudflare Managed Ruleset\n\nFor the purposes of this guide, we will build on the example scenario and WAF Requirements provided above. You have a single Cloudflare Account (or Enterprise Organization) and two 2nd level domains onboarded on it.\n\nLet's imagine that there are six applications behind six FQDNs across two domains. For these applications, you want to apply a baseline WAF security posture. However, of these six applications, two will require a more special treatment:\n\n* One is implemented on a legacy application server, prone to false positives.\n* Another is implemented by a third party on their own infrastructure.\n\nLet's visualize the scenario below:\n\n![Diagram showing how the example scenario can be modelled in a Cloudflare Account with multiple zones](https://developers.cloudflare.com/_astro/diagram-2.DsX9Y3eo_Z1D7BW0.svg)\n\n### Using Account Level WAF to minimize configuration overheads\n\nWe will use the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) as an example, keeping in mind that the approach can also be used for other Cloudflare Managed Rules, Rate Limiting Rules, and Custom Rules.\n\n* For `web1.example.com`, `web2.example.com`, `web3.example.com` and `web5.example.org`: you want to apply the default WAF Managed Ruleset, already tuned by Cloudflare.\n* For `special4.example.com`: you want to apply a different subset of the default Managed Ruleset, as you already identified a couple of rules that are causing false positives on the legacy application.\n* For `special6.example.org`: you want to apply the Managed Ruleset in logging mode, as this is a newly introduced application from a third party and you need to start evaluating how to protect it.\n\nThen, you can adopt the following approach:\n\n* Deploy one instance of the Cloudflare Managed Ruleset at the Account Level. This implements the common subset of rules for the four FQDNS requiring it. This is easier to set up and maintain than replicating the same configuration four times at the Zone level.\n* For `special4.example.com` and `special6.example.org`, you will deploy two additional instances of the Managed Ruleset, with the specific tweaks required by the applications behind these particular FQDNs.\n\nIn practice, using the [Account Level WAF's Managed rulesets](https://developers.cloudflare.com/waf/account/managed-rulesets/), you can deploy the three instances of our Managed Ruleset. Each instance will have its own [Custom Filter Expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/), which will check that the HTTPS requests's hostname belongs to one of the FQDNs in a list:\n\n* For the first list (`web1.example.com`, `web2.example.com`, `web3.example.com` and `web5.example.org`), you will apply the Cloudflare Managed Ruleset in its `Default` configuration.\n* For `special4.example.com`, the same ruleset will be deployed in `Default` mode, but taking care of disabling the specific rules that cause false positives. This can be achieved with the [Rule Overrides](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/), using the Dashboard or the APIs. [Real examples are available here](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/).\n* For `special6.example.org`, you repeat the setup done for the first list, this time modifying the Managed Ruleset instance to operate in `Log` mode instead of `Default`.\n\nLet's visualize the complete configuration in the below diagram:\n\n![Diagram depicting the implemented WAF configuration at the account level](https://developers.cloudflare.com/_astro/diagram-3.DrnYaql1_ZKvfX6.svg)\n\nThis setup will provide three instances of the Managed Ruleset, calibrated for each application group.\n\nIf you have additional applications to be protected in the future, it is sufficient to include the new application FQDN to the filter expression. Generally, most will be added to the standard ruleset instance that is using the recommended Cloudflare configuration. Another common strategy is to add new applications to the `Log` mode instance, so that it can be monitored and eventually transitioned to the `Default` mode ruleset or to a more specific variation if required.\n\n## Additional Considerations\n\n### False Positives Tuning\n\nThe rulesets (and in particular the Managed Ruleset) are already finely tuned by Cloudflare to avoid false positives. They can be deployed for most applications with little to no tweaking required. This means that customers work directly with the default rulesets configurations in most cases, with the possibility to customize only when needed.\n\nIf this is your scenario, you can simplify the above setup in the following way by using [Exceptions](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/):\n\n* First, you can identify which applications (FQDNs) require a special treatment by deploying the ruleset in `Log` mode. For example, following testing you find that `special1.example.com` requires disabling a small set of Managed Rules, and `special2.example.org` disabling a similar, but different set of rules.\n* Deploy two managed Exceptions, with a filter matching on the each FQDN, and then skipping thoserules from the Managed Ruleset.\n* Finally, deploy a Default version of the Managed Ruleset, which will match on everything else, and run the Cloudflare recommended settings of the Managed Ruleset.\n\nThis approach can be simpler when there are few exceptions to the norm, and when the initial calibration confirms that the fine tuning already done by Cloudflare to minimize false positives is appropriate in your situation.\n\nCloudflare provides the ability to create [lists of hostnames](https://developers.cloudflare.com/waf/tools/lists/create-dashboard/). In this case, the Filter expression can be changed to reference such list variables.\n\nYou can then update the lists directly and re-use them across multiple rulesets. For example, use the same list for the Cloudflare Managed Rules and also for the OWASP Ruleset and Rate Limiting. Your filters [will reference the lists directly](https://developers.cloudflare.com/waf/tools/lists/use-in-expressions/), meaning a cleaner and maintainable configuration.\n\nWhen using lists, it is also much easier to adopt a \"catch all rule\" that runs last in the evaluation order. This could implement, for example, the `Default` Cloudflare Managed Ruleset when the host in the HTTPS request is not included in any of your lists. This ensures that a default WAF Managed Rules configuration is always applied, in case some of your applications are not added by mistake to the lists.\n\n### Using automations\n\nThe WAF configuration can be managed [via API calls](https://developers.cloudflare.com/api/) and [Terraform](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs). This is particularly useful when you want to scale the approach to many more zones and FQDNs, and to avoid repetitive and manual tasks in the Dashboard.\n\nFor example, a default Terraform configuration file could be created to define Rulesets and Lists and then maintained and applied as needed without needing to make changes in the Cloudflare Dashboard.\n\n### Avoid mixing setup at Account and Zone level\n\nWhen possible, Cloudflare recommends maintaining the configuration at the Account level, in particular when a Cloudflare Zone will contain multiple DNS records, each requiring custom configuration.\n\nAt the Zone level WAF, you can deploy only one instance of each ruleset (Managed Rules, OWASP Rules, etc.), and therefore handling special scenarios can be more complex or not possible at this level.\n\n### Custom Rules and Rate Limiting Rules\n\nThe approach described above for Managed Rules can be applied also to [Custom Rulesets](https://developers.cloudflare.com/waf/account/custom-rulesets/) and [Rate Limiting](https://developers.cloudflare.com/waf/account/rate-limiting-rulesets/), extending the flexibility to all the WAF security tools at your disposal.\n\nUnless your configuration is specific to a single zone, Cloudflare recommends implementing it at the Account level.\n\nFor more information, please refer to the following resources:\n\n* [Create a Rate Limiting Rule at the Account level](https://developers.cloudflare.com/waf/account/rate-limiting-rulesets/create-dashboard/)\n* [Create Custom Rulesets at the Account level](https://developers.cloudflare.com/waf/account/custom-rulesets/)\n\nIn conclusion, this design guide illustrates how you can implement flexible WAF configurations to cover multiple applications and domains. The described approach reduces the effort required to deploy, maintain, and update your WAF security configuration.\n\n<page>\n---\ntitle: Using a zero trust framework to secure SaaS applications · Cloudflare\n  Reference Architecture docs\ndescription: Learn how to eliminate the trade-off between security and\n  performance by using Cloudflare's global network.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/zero-trust-for-saas/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/zero-trust-for-saas/index.md\n---\n\nSaaS applications have become crucial in today's business landscape, particularly with the rise of hybrid workforces. As organizations adopt flexible working models, the ability of SaaS apps to provide seamless, global access is essential for maintaining productivity and fostering collaboration across distributed teams.\n\nSaaS applications significantly reduce the burden on IT teams by eliminating the need to manage the underlying infrastructure. By entrusting these responsibilities to the SaaS provider, organizations no longer need to worry about hardware and software lifecycle management or scalability challenges. Furthermore, the subscription-based model of SaaS applications lowers adoption barriers by minimizing upfront costs and ultimately offer a lower Total Cost of Ownership (TCO) compared to legacy applications.\n\nAlong with these advantages, SaaS applications introduce new challenges and security risks. Their Internet accessibility requires greater focus on the security of users and devices to prevent unauthorized access and data leaks. User provisioning (onboarding/offboarding), appropriate access controls and control/visibility into device security is essential to ensure only authorized users on trusted devices access company applications. Moreover, IT teams must monitor SaaS applications for misconfiguration and gain visibility into risky user activity. Employees might publicly share files that contain sensitive information or integrate managed SaaS applications with unauthorized third-party apps, all without the IT team's knowledge.\n\nThe ease with which users can sign up for new SaaS services, particularly free and popular ones, often leaves IT teams unaware of all the applications employees use -- a trend known as [shadow IT](https://www.cloudflare.com/en-gb/learning/access-management/what-is-shadow-it/). These unmanaged SaaS applications can be misused by employees, either intentionally or accidentally, potentially leading to data leaks due to the upload of sensitive data into applications that are not under the control of the IT team.\n\nTrying to use a [traditional castle-and-moat security model](https://www.cloudflare.com/en-gb/learning/access-management/castle-and-moat-network-security/) is unsuitable for SaaS applications, as the services and their data are no longer confined to on-premises data centers within an enterprise network. This outdated approach forces a trade-off between security and performance:\n\n* One strategy organizations adopt to enhance security involves shielding SaaS applications from the broader Internet by implementing IP allow lists and routing traffic through the organization's data center where traffic can be inspected and filtered according to security policy. However, this method negatively impacts the user experience, leading to increased latency and reduced bandwidth when routing all traffic through a single data center.\n* Conversely, if user traffic is sent directly to the Internet, bypassing a local VPN client by using split tunneling, security and visibility are compromised as enterprise network controls are bypassed (and IP allow lists are no longer feasible).\n\n![Figure 1: Two different routes to a SaaS application, one secure but low performance, the second fast but less security.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-01.exIRfP3T_1OBq2w.svg)\n\nThis is where a [SASE (Secure Access Service Edge) architecture implementing a Zero Trust framework](https://developers.cloudflare.com/reference-architecture/architectures/sase/) becomes essential. By centralizing security in a global cloud network, the trade-off between security and performance is eliminated. User traffic no longer needs to be routed through a single remote data center for security. With Cloudflare user traffic is routed into our services at the nearest data center – out of hundreds – where it will undergo the necessary security controls. These security controls are implemented in a single-pass architecture to avoid adding unnecessary latency and are applied consistently across the entire Cloudflare network.\n\n![Figure 2: SASE solutions ensure user traffic is secured and filtered close to the user.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-02.DkyQaTm1_ZYjBnI.svg)\n\nThis design guide will focus on how Cloudflare's SASE architecture can more effectively and efficiently secure user access to, and the data within SaaS applications. For a broader understanding of how Cloudflare can be used for an organization's zero trust initiatives, please read our [SASE reference architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/).\n\n### Who is this document for and what will you learn?\n\nThis guide is designed for IT and security professionals seeking to safely adopt and deploy SaaS applications within their organization while maintaining a positive user experience. It assumes familiarity with concepts such as identity providers (IdPs), user directories, single sign-on (SSO), and data loss prevention (DLP) technologies.\n\n* How to secure access to managed SaaS applications and protect their data\n* Key considerations when using cloud email solutions\n* How to get visibility of and regain control over unmanaged SaaS applications\n\nThis guide assumes you have an Enterprise contract with Cloudflare that includes:\n\n* Cloudflare Zero Trust licenses for the number of users you plan to onboard\n* Cloudflare Cloud Email security licenses for the number of users whose cloud inbox emails will be filtered\n\nFree and PayGo capabilities\n\nA lot of the capabilities described in this document [are also available in our free and Pay-as-you-go plans](https://www.cloudflare.com/en-gb/plans/zero-trust-services/).\n\nRecommended resources for a stronger understanding of Cloudflare:\n\n* What is Cloudflare? | [Website](https://www.cloudflare.com/what-is-cloudflare/) (five-minute read) or [video](https://www.youtube.com/watch?v=XHvmX3FhTwU) (two minutes)\n* Blog: [Zero Trust, SASE, and SSE: Foundational Concepts for Your Next-Generation Network](https://blog.cloudflare.com/zero-trust-sase-and-sse-foundational-concepts-for-your-next-generation-network/) (14-minute read)\n* Reference Architecture: [Evolving to a SASE Architecture with Cloudflare](https://developers.cloudflare.com/reference-architecture/architectures/sase/) (three-hour read)\n\n## Securing managed SaaS applications\n\nManaged SaaS applications are those procured and approved by IT, forming part of the official suite of tools employees use to perform their tasks. IT typically manages these applications and are responsible for:\n\n1. **Securing access:** Ensuring only authorized users and devices can access SaaS applications. This includes managing the onboarding and offboarding of users. For instance, if an employee leaves the organization, their access is automatically revoked. Typically this involves integrating the SaaS application with the company identity management solution.\n2. **Data protection:** Preventing data leaks from within the SaaS application and proactively mitigating risky behaviors by users that may result in data breaches.\n3. **Monitor configuration:** Identifying and promptly correcting misconfigurations within the SaaS application to ensure they operate securely and efficiently.\n4. **Cloud email security:** IT teams should take special care when dealing with cloud email SaaS solutions. Since email is a primary target for attacks, a specialized approach is required to protect users from phishing and other email-based threats.\n\nNote a section later in this document will cover how to gain visibility into, and control over, unmanaged applications. For example where your marketing department decides to sign up and start using a new CRM system without engaging IT or security departments.\n\n#### Using SaaS IP allow lists\n\nOne simple method for securing access to SaaS applications, is to only allow access from a specific set of IP addresses. This forces users to have to connect to, and have their traffic exit from a specific network and therefore ensure whatever access controls are in place on that network are applied to that traffic.\n\nOrganizations that already use IP allow lists to secure access to SaaS applications can easily migrate to Cloudflare using [dedicated egress IPs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/). User traffic egresses from Cloudflare to the Internet and onto the SaaS application, sourced from a set of IP addresses unique to the organization. This approach supports various ways in which users access Cloudflare before gaining access to the SaaS application:\n\n* **Hybrid employees:** Connecting to Cloudflare using our Zero Trust client, [WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/).\n* **Office-based users:** Connecting to a local network which routes Internet bound traffic to Cloudflare through GRE or IPsec [Magic WAN tunnels](https://developers.cloudflare.com/magic-wan/).\n* **Contractors and external users:** Accessing SaaS applications through a [remote browser](https://developers.cloudflare.com/learning-paths/clientless-access/alternative-onramps/clientless-rbi/) hosted in a Cloudflare data center.\n\nOrganizations add the new dedicated egress IPs to the existing SaaS IP allow lists for the Cloudflare sourced traffic to be allowed into the SaaS application. This way, organizations can maintain legacy connectivity methods in parallel with Cloudflare and migrate users gradually. Once all users are migrated to access with Cloudflare, the SaaS IP allow lists can be updated by removing the IPs corresponding to legacy infrastructure.\n\nThere are several advantages to using Cloudflare's dedicated egress IPs when compared with using IPs from on-prem infrastructure:\n\n* [Dedicated egress IPs can be geolocated](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/#ip-geolocation) to one or more Cloudflare data centers in a geography of your choosing, instead of being restricted to the geographic locations of your existing Internet breakout data centers.\n* Users will always connect to Cloudflare [through the closest Cloudflare Data Center and Cloudflare will optimize the path towards the SaaS application](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/#egress-location).\n* Dedicated egress IPs are assigned to user traffic using policies that follow zero trust principles. [Egress policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/) can be defined that will only assign a dedicated egress IP to a user if they belong to the correct IdP group and/or pass [device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/) checks. Otherwise, traffic will be sourced from Cloudflare's public IP range, which may not be part of the SaaS IP allowlist, preventing access to the SaaS application while still allowing Internet usage.\n* Dedicated egress IPs imply that traffic needs to flow through Cloudflare before reaching the SaaS application. This makes it easy to add secure web gateway policies to protect data in the SaaS applications once users have authenticated.\n\n![Figure 3: Enforce only traffic that has been secured by Cloudflare is accepted by the SaaS application.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-03.DmqMPB93_Z1rprsk.svg)\n\n#### Using Cloudflare as an identity proxy\n\nWith Cloudflare, [Zero Trust Network Access (ZTNA)](https://www.cloudflare.com/en-gb/learning/access-management/what-is-ztna/) can be applied to managed SaaS applications. In this scenario, Cloudflare acts as the [Single Sign-On (SSO)](https://www.cloudflare.com/en-gb/learning/access-management/what-is-sso/) service for an application, proxying user authentication requests to the organization's existing identity providers (IdPs). This allows for additional restrictions to be layered on before granting access, such as requiring [multi-factor authentication](https://www.cloudflare.com/en-gb/learning/access-management/what-is-multi-factor-authentication/), implementing [device posture checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/), or [evaluating the country](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors) the request is coming from.\n\n![Figure 4: Cloudflare can act as an identity proxy, providing a consistent authentication experience for all SaaS applications.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-04.ayHv4mW0_mprtP.svg)\n\nMost organizations initially use Cloudflare's [ZTNA service](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) for self-hosted applications. Extending it to SaaS applications simplifies IT management in several ways, as both self-hosted and SaaS apps will:\n\n* Use the same access policies\n* Leverage the same IdP and device posture integrations\n* Consistently audit access requests\n\nIT teams will also benefit from a consistent and automated process for onboarding and offboarding users from applications. Since all access policies leverage authentication from existing IdPs, changes in a user's status will automatically affect the outcome of access requests for both self hosted applications as well as SaaS.\n\nConsider a scenario where a user moves to a different group or team within an organization. As soon as the user group information is updated on the IdP, Cloudflare's ZTNA policies will dynamically enforce these changes, ensuring that the user's access to the SaaS applications is immediately adjusted based on their new role. This also helps in SaaS applications' license optimization. For example, if an employee is transferred from the sales team, which uses Salesforce, to a team that does not require access to Salesforce, the ZTNA policies will revoke their access to the application. This automated process helps in reclaiming the license that was previously assigned to the user, ensuring that only those who actually need the application have access to it.\n\nFinally, SaaS applications are accessible over the Internet, allowing any device to access them if a user authenticates successfully. However, with Cloudflare's ZTNA service, IT teams can ensure that only managed devices access a SaaS application by enforcing device posture checks, in addition to identity checks. A common use case is [verifying the presence of an IT-deployed device certificate](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/#configure-the-client-certificate-check) before granting application access.\n\n#### Deployment guidelines\n\nFor SaaS applications that do not support SSO or organizations that are already implementing IP allow lists to secure access to SaaS applications, implementing dedicated egress IPs is the most straightforward approach to enhance access security to SaaS applications, without impacting the user experience.\n\nOrganizations that would like to simplify their onboarding/offboarding of users to applications and standardize ZTNA policies should consider implementing Cloudflare's ZTNA solution for both self-hosted and SaaS applications. In such scenarios, it might still be relevant to consider dedicated egress IPs for a subset of critical SaaS applications. As egress policies operate at the network and transport layers, their enforcement is almost real-time. [For example](https://developers.cloudflare.com/cloudflare-one/tutorials/m365-dedicated-egress-ips/#_top), consider an egress policy for a specific SaaS application that accounts for posture status from an external endpoint management solution. If a device becomes compromised and its posture status becomes non-compliant, the egress policy will no longer match. This results in the user of that device losing access to the SaaS application, as traffic will no longer be sourced from the dedicated egress IP.\n\nFinally, organizations that have already integrated all their SaaS applications with an IdP for SSO can still consider adding IP allow lists with dedicated egress IPs for a subset of applications for the same reason as detailed before.\n\n### Data protection for managed SaaS applications\n\nWhile extending ZTNA principles to managed SaaS applications ensures that only the right users and devices can access these applications, it is crucial to address the risk of authorized users leaking data once they have access.\n\n![Figure 5: Cloudflare can also protect data that's downloaded or uploaded to managed SaaS applications.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-05.SnFY_pU3_1zbYtu.svg)\n\nTo mitigate these risks, controls should be implemented for both data in transit and data at rest.\n\nAs mentioned before, all traffic can be forced through Cloudflare using the device agent, Magic WAN (MWAN) tunnels, or the remote browser. This allows [secure web gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) policies to manage and protect data as it is uploaded or downloaded from SaaS applications. Common use cases include:\n\n* Restricting the ability to download [all](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/#block-google-drive-downloads) or a [subset of files](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/#block-file-types) from managed SaaS applications to specific groups of users within the organization.\n* Using [Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/#_top) profiles to limit the download of data containing sensitive information from managed SaaS applications.\n\nFor more information about securing data in transit, refer to our [reference architecture center](https://developers.cloudflare.com/reference-architecture/diagrams/security/securing-data-in-transit/).\n\nCloudflare's [Cloud Access Security Broker (CASB)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/) integrates with [popular SaaS applications](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/) through APIs. Once integrated, Cloudflare continuously scans these applications for security risks. This enables IT teams to detect incidents of authorized users oversharing data, such as sharing a file publicly on the Internet. For Google Workspace, Microsoft 365, Box, and Dropbox, the API CASB can also utilize DLP profiles to detect the sharing of sensitive data. For more information about securing data at rest, refer to our [reference architecture center](https://developers.cloudflare.com/reference-architecture/diagrams/security/securing-data-at-rest/).\n\nIn addition to the previous measures, IT teams should also consider introducing [User Entity and Behavior Analytics (UEBA)](https://www.cloudflare.com/en-gb/learning/security/what-is-ueba/) controls. Cloudflare can assign a [risk score](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/) to users when detecting activities and behaviors that could introduce risks to the organization. These risk behaviors include scenarios where users trigger an unusually high number of DLP policy matches. By implementing these measures, organizations can significantly reduce the risk of data leaks from managed SaaS applications, even by authorized users.\n\n![Figure 6: Cloudflare can secure data traveling over its network, as well as using SaaS application APIs to examine data stored at rest.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-06.ClpGGJtH_16ppNX.svg)\n\n### Monitor configuration\n\nWhile this design guide has primarily focused on SaaS application users so far, it is important to note that a significant number of SaaS data leaks today are not caused by user behavior but rather by misconfigurations made by IT teams. When these misconfigurations go unchecked, they expose both the SaaS application and the organization to serious security risks.\n\nYou can mitigate these risks using Cloudflare's CASB. The API CASB continuously scans for and identifies misconfigurations, enabling swift remediation. It can detect issues such as exposed credentials, keys that need rotation, users with disabled two-factor authentication (2FA), unauthorized third-party apps with access to the SaaS application, among others.\n\n### Cloud email security\n\nPhishing attacks and campaigns to spread malware to take over devices and access company data usually focus on email as the channel for attack. The vast majority of companies today have migrated their email from on-premises servers to cloud hosted services. While the built-in security of solutions such as Microsoft 365 and Google Workspace are good, they are unable to keep up with the constant evolution of attack methods. Many organizations therefore deploy advanced email security solutions integrated with existing email platforms.\n\nAs described already, implementing ZTNA to secure your email platform offers numerous benefits. One key advantage is ensuring that email access is restricted to trusted, managed devices, even when using a cloud-based email service. This typically involves using Cloudflare to verify the presence of a [client certificate](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/) and confirm that there are no risks detected by an external endpoint management solution, such as [Crowdstrike](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/crowdstrike/) or [SentinelOne](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/).\n\nOrganizations with stringent requirements about email communications for compliance or regulatory reasons, operational control or accountability, or to reduce the potential for data leaks can block access to email tenants other than the organization's own. This can be achieved by using [Cloudflare Gateway SaaS tenant controls](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tenant-control/). Cloudflare injects custom HTTP headers into the traffic flow, informing Microsoft 365 and Google Workspace of the specific tenant users are allowed to authenticate into and blocking any access attempts to any other tenant.\n\n![Figure 7: Cloudflare can enforce access to only specific cloud email tenants.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-07.Dp1tEZPu_1leJiw.svg)\n\n#### Filtering inbound emails\n\nWhile SaaS email solutions offer native security capabilities, their popularity makes them high-value targets for attackers who seek to exploit vulnerabilities and limitations in their inbound filtering capabilities. To mitigate this risk, IT teams should consider supplementing the native capabilities of cloud email solutions with specialized solutions for inbound email filtering.\n\n[Cloudflare's Email security](https://www.cloudflare.com/en-gb/zero-trust/products/email-security/) scans for malicious content or attachments in emails and proactively monitors the Internet for attacker infrastructure and attack delivery mechanisms. It identifies programmatically-created and impersonation domains used to host malicious content as part of planned attacks. This data also helps protect against business and vendor email compromises ([BEC](https://www.cloudflare.com/en-gb/learning/email-security/business-email-compromise-bec/)/[VEC](https://www.cloudflare.com/en-gb/learning/email-security/what-is-vendor-email-compromise/)), which are notoriously difficult to detect due to their lack of payloads and resemblance to legitimate email traffic and a gap for legacy email security platforms.\n\nIntegrating Cloudflare into the existing email infrastructure is both flexible and straightforward, with deployment options available in [inline](https://developers.cloudflare.com/email-security/deployment/inline/) and [API](https://developers.cloudflare.com/email-security/deployment/api/) modes.\n\nIn an inline deployment, Cloudflare's Email security will evaluate email messages before they reach a user's inboxes (by pointing the email domain MX record to Cloudflare). This allows Cloudflare to [quarantine messages](https://developers.cloudflare.com/email-security/email-configuration/admin-quarantine/) so they never reach the user's inbox or [tag messages with email headers](https://developers.cloudflare.com/email-security/reference/dispositions-and-attributes/#header-structure) to inform the email provider how emails should be handled (for example, [by redirecting bulk emails directly to the spam folder](https://developers.cloudflare.com/email-security/deployment/inline/setup/office-365-area1-mx/use-cases/one-junk-admin-quarantine/)). Cloudflare can also [modify the subject and body of email messages](https://developers.cloudflare.com/email-security/email-configuration/email-policies/text-addons/) to inform a user to be more cautious about a suspicious email and [rewrite links within emails and even isolate those links behind a remote browser](https://developers.cloudflare.com/email-security/email-configuration/email-policies/link-actions/).\n\nIn an API deployment, Cloudflare's Email security will see the email messages only after they have reached the users' inboxes by setting up Journaling/BCC rules in the email provider or through API scan. Then, through integrations with the email provider, Cloudflare can [retract phishing emails](https://developers.cloudflare.com/email-security/email-configuration/retract-settings/) from users' inboxes. Unlike the inline mode, this deployment method does not support quarantining emails or modifying the email messages. However, it is an easy way to add protection in complex email infrastructures with no changes to the existing mail flow operations.\n\nThese modes can be used concurrently to enhance email security. The inline mode ensures that Cloudflare's Email security scans and filters emails before they reach users' inboxes. For emails that initially pass through without being flagged as threats, Cloudflare [periodically re-evaluates them](https://developers.cloudflare.com/email-security/email-configuration/retract-settings/office365-retraction/#post-delivery-retractions-for-new-threats). If these emails are later identified as part of a phishing campaign, they are automatically retracted with the API. This proactive approach protects organizations against deferred phishing attacks, where attackers send emails with seemingly benign links that are weaponized after delivery to bypass initial detection.\n\n![Figure 8: Cloudflare can protect email services either inline or by API.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-08.CeM49-0Z_Zu3cr8.svg)\n\n#### Ensuring availability\n\nCloudflare also helps ensure the availability of cloud email services. It auto-scales TCP connections and SMTP traffic to handle message spikes, protecting the organization from email DoS attacks. The service automatically pools and queues messages for extended periods and throttles delivery post-spike according to the downstream email service's capacity. This pooling and queuing capability is beneficial during cloud email service outages.\n\n#### Filtering outbound emails with outbound data loss prevention\n\nOrganizations using Microsoft 365 can enhance protection against sensitive information leaks through email by integrating a Cloudflare add-in into their environment. This integration enables IT administrators to establish [outbound Data Loss Prevention (DLP) policies](https://developers.cloudflare.com/cloudflare-one/email-security/outbound-dlp/) that leverage the same DLP profiles used with the Secure Web Gateway (SWG) and API Cloud Access Security Broker (CASB).\n\nMoreover, organizations that utilize [Microsoft Purview Sensitivity Labels](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/integration-profiles/) for classifying and safeguarding sensitive documents can incorporate these labels into Cloudflare's DLP profiles. This capability allows the creation of targeted policies, such as blocking emails containing Microsoft Office documents marked as 'Highly Confidential' in Microsoft Outlook from being sent to external recipients. These DLP profiles can also be applied across SWG and API CASB.\n\n## Regain control over unmanaged SaaS applications\n\nUnmanaged SaaS applications are those used by employees without IT's approval or knowledge, commonly referred to as [shadow IT](https://www.cloudflare.com/en-gb/learning/access-management/what-is-shadow-it/). This growing challenge is driven by the proliferation of free or low-cost SaaS applications. While these apps can boost employee satisfaction and productivity, they also pose significant risks, such as:\n\n* **Data breaches:** Employees can upload sensitive data to these applications without any security controls. And without Single Sign-On (SSO) or strong password protocols, the risk of data loss or theft is significantly higher.\n* **Compliance violations:** In regulated industries, the use of unauthorized SaaS tools can lead to non-compliance with legal and industry standards, potentially resulting in fines, legal action, and reputational damage.\n* **Increased costs:** IT typically can often secure favorable pricing by managing SaaS subscription across the business. However, when employees independently purchase subscriptions with personal credit cards, it can lead to unchecked shadow IT spending and higher overall costs for the organization.\n\nTo mitigate these risks, the first step is to discover which SaaS applications employees are using. When all traffic from employee devices is routed through Cloudflare, [reports are generated](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) showing the usage of common SaaS applications.\n\n![Figure 9: When all user traffic bound for the Internet goes through Cloudflare, it allows IT to monitor for unapproved SaaS applications.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-09.DHrIIpJM_ZaRR5Q.svg)\n\nWith this information, IT teams can analyze and decide how to handle each unmanaged SaaS application:\n\n* **Allow the application:** If the application presents no risk to the organization, it is deemed acceptable for employee use, and no further action is required.\n* **Allow the application with data protection controls:** If the application is acceptable but poses a data leak risk, appropriate data protection measures should be implemented.\n* **Adopt the application as a managed SaaS application:** If the application is beneficial for the organization, it should be brought under IT management.\n* **Block the application:** If the application is deemed unacceptable, it should be blocked using Cloudflare Gateway DNS and/or HTTP policies.\n\n### Data protection for unmanaged SaaS applications\n\nData protection for unmanaged SaaS applications is similar to that for managed SaaS applications, but the focus shifts from mitigating the downloading of data to preventing the uploading of sensitive information. Policies can be configured using Cloudflare Gateway to address these risks. Common use cases include:\n\n* Restricting the ability to [upload certain file types](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/common-policies/#block-file-types) to SaaS applications, limiting this capability to specific groups of users within the organization.\n* Using Data Loss Prevention (DLP) profiles to block the upload of data containing sensitive information.\n\nIn addition to these measures, [remote browser isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/#_top) can be considered for unmanaged SaaS applications. This approach allows users to access certain unmanaged SaaS applications while [restricting their actions within those applications](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#policy-settings) to prevent misuse.\n\n![Figure 10: DLP policies can be combined with browser isolation, to protect company data.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-10.zOip4DKU_1yOzzw.svg)\n\n### Adopting a new SaaS application\n\nMany SaaS applications offer a free version as part of their business model to encourage users to integrate them into their work. This helps demonstrate the application's usefulness and facilitates its adoption at the corporate level ([Cloudflare follows this model as well](https://www.cloudflare.com/en-gb/plans/zero-trust-services/)). When a previously unmanaged SaaS application is officially adopted by the organization, IT teams take over its management to ensure proper support and adherence to best practices. This involves aligning the new SaaS application with all the aspects discussed in the Securing Managed SaaS Applications section.\n\nAfter fully adopting the new SaaS application, access to the consumer version may be restricted. If the corporate SaaS version has a unique domain, access to other tenant domains or the consumer domain can be blocked using Cloudflare DNS and/or HTTP policies. Some SaaS solutions offer [native tenant control](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tenant-control/) through HTTP headers, which can be enforced by injecting these headers for data in transit using Cloudflare Gateway HTTP policies.\n\nThis design guide described how organizations can enhance their SaaS application security by implementing a Zero Trust framework within a SASE architecture. With Cloudflare, organizations gain access to a comprehensive solution that addresses the challenges posed by both managed and unmanaged SaaS applications. By using techniques like ZTNA, dedicated egress IPs, CASB, and robust email security measures, organizations can ensure secure access, protect sensitive data, and gain control over shadow IT, all while maintaining a positive user experience. These techniques and when to apply them are summarized in the diagram below:\n\n![Figure 11: Techniques for enforcing a zero trust approach in SaaS applications.](https://developers.cloudflare.com/_astro/zero-trust-saas-image-11.qEiUE-gW_Z26gO0P.svg)\n\n* [SASE reference architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/)\n* [Using Cloudflare SASE with Microsoft](https://developers.cloudflare.com/reference-architecture/architectures/cloudflare-sase-with-microsoft/)\n\n<page>\n---\ntitle: Building zero trust architecture into your startup · Cloudflare Reference\n  Architecture docs\ndescription: Cloudflare Zero Trust is a simple, (sometimes free!) way for\n  startups to develop a comprehensive Zero Trust strategy. This guide explains\n  how to use Cloudflare to establish the foundation for a Zero Trust\n  architecture.\nlastUpdated: 2025-10-30T19:21:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/design-guides/zero-trust-for-startups/\n  md: https://developers.cloudflare.com/reference-architecture/design-guides/zero-trust-for-startups/index.md\n---\n\nMost of Cloudflare's documentation (and, generally, documentation by most vendors in the space) is written with the assumption that adopting Zero Trust products will require shifting away from something. In scenarios in which nothing is built, or there is no tool that fulfills the goals which your team is trying to accomplish, this can sometimes be confusing and alienating. New startups are especially underserved; as you focus all your energy on getting your business off the ground, it can be time consuming or confusing to read documentation that is angled towards enterprises undergoing network transformation.\n\nThis guide explains how to use Cloudflare to establish the foundation for a Zero Trust architecture early in the establishment of your security, networking, and development operations practices — with the goal of creating a sustainable, scalable business built on Zero Trust security principles.\n\nThe common principles for building a 'business' have fundamentally changed. Twenty years ago, this may have looked like getting office space (or a garage), buying some hardware infrastructure, servers, and user machines on which to begin building. As building continues, you add hardware-stacked firewalls and security appliances to create a corporate perimeter and protect the things that primarily exist in one place. There's lots of good written content on the evolution of networking and security practices so we won't belabor the point here; the important detail is to recognize how the 'new' model matters for your startup as you build.\n\nChances are good that today most of your infrastructure will exist in a public cloud provider. Most of your code will be pushed and reviewed via common repository management tools, most of your developers will write code on MacOS or Linux machines, and will probably rely heavily on a form of containerization for local development. Within this model, Zero Trust security principles are just as relevant — albeit much easier to achieve — when your business grows into multiple complex functions, departments, and an expanding set of assets and data.\n\nUsing Cloudflare Zero Trust is a simple, (sometimes free!) way for startups to develop a comprehensive Zero Trust strategy that will grow organically with your business.\n\n## Who is this document for and what will you learn?\n\nCloudflare has lots of existing content related to migration and implementation of our Zero Trust product set. This document speaks directly to technical founders and founding engineers of young startup organizations who are looking to develop the framework for a modern corporate network, with modern security controls, from their first line of code.\n\nIn this document we'll explore:\n\n* Getting started with practical Zero Trust remote access (ZTNA) capabilities\n* Establishing sources of truth for identity, device posture, and learning how to use them\n* Network building, both traditional and mesh\n* Building Zero Trust into internal tooling\n* Reviewing threats on the Internet\n* TLS decryption and its relevance for your goals\n* Exploring Zero Trust for your SaaS tools\n* Navigating contractor and customer access\n* Building with Infrastructure as Code\n\nA few things explicitly not covered in this document:\n\n* Introduction to basic Zero Trust terminology and concepts\n* Recommendations for or against specific third-party vendor usage (while other vendors are mentioned in this document, it's purely illustrative and should not be taken as a formal recommendation from Cloudflare)\n* Details on why you should explore adopting a Zero Trust security methodology (we have lots of good resources detailing that in the links below)\n* Microsegmentation and autonomous Zero Trust concepts (these may be covered in future updates)\n* Passwordless authentication (this is a cool and emerging space, and we'll provide some recommendations here in the future)\n\nTo build a stronger baseline understanding of Cloudflare, we recommend the following resources:\n\n* What is Cloudflare? | [Website](https://www.cloudflare.com/what-is-cloudflare/) (five-minute read) or [video](https://www.youtube.com/watch?v=XHvmX3FhTwU) (two minutes)\n* Blog: [Zero Trust, SASE, and SSE: foundational concepts for your next-generation network](https://blog.cloudflare.com/zero-trust-sase-and-sse-foundational-concepts-for-your-next-generation-network/) (14-minute read)\n* Reference architecture: [Evolving to a SASE architecture with Cloudflare](https://developers.cloudflare.com/reference-architecture/architectures/sase/) (three-hour read)\n\n## Getting started — Foundational decisions\n\nBefore thinking about your remote access or security goals, it's important to take stock of your current assets. Think about the answers to the following questions:\n\n* What already exists and is in need of a sustainable model for security?\n* If you have begun building infrastructure in a public cloud provider, how many distinct virtual private clouds (VPCs) have you already established, and how do they communicate with each other? More importantly, how and why do your users access those environments?\n* Is it all through the console and browser-based management or terminal tools?\n* Have you set up public IP access for some services over HTTPS or SSH?\n* Are there resources that may allow access from the Internet that are intended to be entirely private?\n* Have you established a traditional VPN to allow remote access to the environment, and how is it gated?\n\nNext, build a map of your physical and virtual private infrastructure (essentially, anything that contains company data). For many startups, this may just be implemented via a single cloud provider. Note all the resources in that environment that are accessed, either by human users, other infrastructure, or public or private APIs — then document the purpose of each service that sees regular traffic. As you do so, try to answer the following questions:\n\n* Is this an internal web-based tool built to monitor your build pipeline?\n* Is it a self-hosted analytics tool like Grafana, or a supporting metrics server like Prometheus?\n* How are users reaching that service — via a public IP, a private IP, or a local path?\n* Are users able to reach the service from other cloud environments or VPCs? If so, how are they connected?\n\nOnce you've developed a comprehensive list of your existing resources, this will serve as an asset inventory for your development of a Zero Trust architecture. If you don't know what you need to protect, it'll be difficult to protect it, no matter how many security tools you have.\n\n![A snapshot of the foundational decisions to make when establishing a zero trust architecture](https://developers.cloudflare.com/_astro/zero-trust-design-guide-getting-started-foundational-decisions.BjoDdDt1_Z1Aci1z.svg)\n\nA valuable third step may be to begin stack-ranking these services by risk level in the event of a breach, to later determine the specificity of your security policy. For example, your internal tool to alert on build status may be a level 3, but your production database for customer information would be a level 1. A level 3 application may be able to be accessed by a user on their own device, assuming they can meet your identity control requirements, but a level 1 application may require access from a corporate device and the use of a specific kind of multi-factor authentication (MFA).\n\nIf you've already grown to the point that documenting your asset inventory is very difficult or time-consuming for your business, you can use tools like our [Private Network Discovery](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/#private-network-origins) capability to build a sense of what your users access in your network space.\n\n### Common goals and outcomes\n\nMany startups that use Cloudflare are encouraged to adopt a Zero Trust security posture by external sources: investors, partners, vendors, risk analysts, or compliance officers. Even if this is a project or evaluation that is driven by outside parties, you can still establish common goals to ensure it drives a measurable, desirable impact.\n\nSome common goals we hear from customers:\n\n* Make internal tooling easy for our users to access securely\n* Build security into the development pipeline\n* Adopt increased security without sacrificing user and work experience\n* Define and execute a bring your own device (BYOD) strategy\n* Simplify management of networks and application access\n* Protect data in SaaS applications and on the corporate network\n* Ensure auditability (“a quick view of what's happening, who's doing it, and if it's okay”)\n* Demonstrate security best practices to our customers and end-users\n\nIt's also possible that your goals may be simpler or more tactical than this; for instance, adopt a modern remote access tool, securely connect my internal networks, or only allow corporate devices to connect to my Gitlab Enterprise tenant. Whatever your goal, the most important element in goal-setting will be to establish what you need now and balance it against what you may need or expect to need in the near or mid-term future. If you intend to grow significantly, expect to sign customers with demanding security reviews, or be prepared to apply for a new compliance certification, such as SOC II or PCI. In order to accomplish this, it is crucial to start with a Zero Trust vendor, which can help layer on additional security tooling and capabilities without exponentially increasing complexity or cost.\n\nGoal-setting is also an important exercise for prioritization. If you know that your primary goal is to *identify and put identity-aware security in front of all our internal services*, but that in the next six months you intend to *restrict BYOD usage to level 3 applications*, your first goal will need to strategically support the execution of the second. Understanding the stack-rank of priorities over the next few months (knowing things change quickly in your startup!) can save you the time spent in re-architecture discussions, or unraveling technical or commercial decisions with vendors that fit your needs in the short term, but not the mid-term.\n\nIdentity is at the core of every Zero Trust strategy. Ultimately, most customer goals revolve around using a central source of identity to authenticate, validate, and log all actions taken by a user, spanning both 'owned' (hosted, private network) applications and SaaS applications. Identity (through an SSO provider, for example) can then be used to layer additional security controls like multi-factor authentication, or phishing-resistant authentication.\n\nOne of the most important things you can do early is to coach users to become accustomed to using multi-factor authentication. Phishing-resistant MFA options like physical keys, local authenticators, and biometric authentication have been credited by Cloudflare as a major factor in [stopping the attempted breach](https://blog.cloudflare.com/2022-07-sms-phishing-attacks) that affected Twilio and other SaaS companies in 2022.\n\nIn the context of getting started with Zero Trust, the type of identity provider that you decide to use (Google Workspace and Microsoft Entra Identity being the most common) is less important than your implementation strategy. As long as you have a directory that is secure, allows for phishing-resistant authentication methods, and is designated as your source of truth, you have the necessary components to integrate with a Zero Trust vendor like Cloudflare and deliver continuous interrogation of that identity-as-security posture for all of your corporate tools.\n\nMany directory services also provide single sign-on (SSO) solutions for integrating directly with SaaS applications. While this is a simple and logical choice, many enterprise applications make SSO integration a challenge, and onboarding a critical mass of SaaS applications to any one directory service can drive vendor lock-in. As your organization continues to grow, your identity strategy will inevitably change and mature, and it's important to maintain flexibility to address unexpected challenges, like some of the vendor breaches that we saw in 2023.\n\nAlong with the challenges related to flexibility, many SSO providers have yet to fully integrate device posture concepts into their 'source of truth' model. Some vendors like Okta offer machine certification as part of an authentication event, but it's limited to Okta's FastPass product and doesn't include signals from other sources or vendors to better determine what constitutes a corporate device.\n\n#### Third-party access\n\nFinally, you will not always own the identities that are used to access your systems. You may hire external auditors who need to use their own company identities to authenticate. You may decide to allow contractors to use their existing GitHub identities to access private GitHub repositories. There may be times where you simply need to provide access to someone with just an email address to access a low risk resource, such as showing customers a preview of a new product interface. So your Zero Trust solution needs to allow identities beyond your central directory to also gain access.\n\n#### Where does Cloudflare fit in?\n\nLater in this document, we'll describe using Cloudflare Zero Trust to protect your internal applications, and how to use Cloudflare as your SSO in front of your SaaS applications to deliver a simple, unified security posture everywhere.\n\nCloudflare *matters* in this case because once you've determined a source of truth for your identity provider, you need tooling to perform continuous authentication against your user population. This tooling is difficult to build and maintain, as evidenced by a number of well-known technology companies who retired their internally-built Zero Trust proxy and switched to Cloudflare in 2023, citing management complexity and an inability to add new security functionality.\n\nCloudflare can simplify your architecture by becoming the singular enforcement point for your identity against your private applications, your networks, your developer services, and your SaaS applications. Cloudflare is one of the only vendors to be able to provide Zero Trust authentication concepts as a web proxy (layer 7 services), as a VPN replacement (layer 3/4 services), and as a secure web gateway.\n\n![The various ways employees, contractors, vendors, or customers may verify their identity to access your company's resources](https://developers.cloudflare.com/_astro/zero-trust-design-guide-getting-started-foundational-decisions-identity.OTP3iPEW_ixsmT.svg)\n\nAs your business grows and you begin to operationalize the distribution of endpoints to your user population, device posture is a key component of a strong Zero Trust strategy. Once you've validated your users' identity posture, there are other actions you can take to further reduce the risk of a data breach. Consider this: even if your user is valid and has an active identity session, their device could theoretically be infected, and attackers could benefit from (or *hijack*) their valid identity session.\n\nCompanies use device posture to prove that a connection is coming from a trusted device. Let's look at the theory behind device posture before listing some common strategies and approaches to getting started. In this example, you have sensitive data located somewhere in AWS. This data is critical to the operation of your business. It is (rightly) protected behind identity-aware authentication, so you feel confident that it can only be accessed by users with the proper identity posture. Your users are all remote, and connect to AWS from Macbooks that are pre-configured with your endpoint detection and response (EDR) software of choice. Users on their Macbooks, configured with enterprise EDR software, have a lower risk of potential breaches than when they use their personal laptops to access company data. But how do you prove that your users with valid identity posture *only* access your sensitive data from the devices that contain a lower risk of breach?\n\nAs your security organization grows and you begin to implement data loss prevention (DLP) strategies and tools, this becomes doubly important. If your users can theoretically access sensitive data without applying a burden of proof to the device used for access, users may be able to (intentionally or inadvertently) circumvent your security tooling and create the risk of exfiltration, or at a minimum, blind spots for your visibility and auditability.\n\nCommon device posture strategies usually rely on a combination of an endpoint management tool (like JAMF, Intune, etc.), a corporate certificate, and security tooling like EDR software that might sit on the device. Some of this tooling can fingerprint your devices in a way that can be externally validated where supported. In order to achieve Zero Trust access controls with device posture validation, an endpoint agent from the Zero Trust vendor typically needs to be deployed on the devices. Then, it is used to 'independently' verify a claim from a third party vendor before applying that device state to be used in a policy. When evaluating vendors, it is important to evaluate their ability to poll for state relatively frequently, so that they are adhering to the Zero Trust policy philosophy for “continuous evaluation” of state.\n\n#### Where does Cloudflare fit in?\n\nAs you begin to use third-party vendors for Zero Trust security outcomes, those vendors need to ingest first-party signals to help you make the best security decisions. In this case, Cloudflare becomes your point of policy enforcement for device posture — in addition to identity posture. The Cloudflare device agent will evaluate your device ownership or health metrics, and use them in conjunction with policies about user identity to ensure access to sensitive resources both has proper identity verification and is coming from a compliant device with the acceptable level of security control.\n\n![Cloudflare's device posture enforcement in action](https://developers.cloudflare.com/_astro/zero-trust-design-guide-getting-started-foundational-decisions-device-posture.BpvZA4DM_Zw3tmS.svg)\n\n## Traditional and mesh network building\n\nIn the 'old world' model (also known as a castle and moat security architecture), your infrastructure would probably be homogeneous and protected by a firewall. To access network resources, users not in the office (or other third parties, vendors, etc.) would need to connect to the network via a VPN and firewall, or use another available network route via a public IP address. Because most infrastructure now lives in the cloud, and most startups begin remote-first, almost none of the traditional networking concepts will be explicitly relevant as you design the initial phases of your 'corporate network'.\n\nIn this more traditional networking model, your infrastructure will probably be structured in several of the following ways:\n\n* It will exist in one or multiple VPCs (which may or not be connected by cloud provider transit gateways)\n* The addressing of your services will probably be managed by your cloud provider\n* You will use internal DNS from a cloud provider like AWS' Route53 DNS (most businesses still rely on internal DNS to some extent, no matter how cloud-native they may be)\n* There may always be a reason to maintain some concept of a privately networked space, as long as you maintain your own infrastructure\n* It's possible that all users won't have a need to understand or navigate using your internal DNS infrastructure (but technical users and services likely will)\n\n*As you begin establishing patterns in the infrastructure that you build, it's likely that you'll collate around a single, primary cloud provider. The main concepts relevant for this document will focus on users connecting to your network to access internal resources and services, and the way that your internal services communicate with the Internet broadly. Management of cloud infrastructure permissions and policies, as well as recognition of the ways in which your internal services can communicate with one another is equally relevant to a comprehensive Zero Trust strategy, but will be discussed in depth in future updates to this document.*\n\n### Connecting users to networks\n\nThis will probably be one of the most common Zero Trust use cases for a majority of startups. You may be asking yourself, How can I get my user access to my internal network or application without managing VPN hardware or exposing my business to risk? As you navigate the best way to connect your users to your private networks and services — while still adhering to Zero Trust principles — there are two important things to consider:\n\n1. **Limiting exposure** — A Zero Trust philosophy encourages organizations to limit the amount of ways in which networks or services can be accessed. Having public IP addresses or ingress paths into your network can introduce unwanted risk. This is typically accomplished by using outbound-only proxies that connect to Zero Trust vendors to only proxy authenticated traffic into your network, and do not require any public IP access of any kind.\n2. **Limiting lateral movement** — One of the best ways to reduce the radius of a potential data breach is to practice least-privilege access for all resources. Least-privilege access is a core tenet of a Zero Trust architecture, in which users only receive the level of access they need for their role, rather than getting carte blanche access to the entire corporate network. The most analogous concept as it relates to Zero Trust frameworks is that of 'microtunnels' — a recommended approach in which each application or service that needs to be accessed receives its own distinct 'route'. Similar to microtunnels, least-privilege access enables you to build a practice in which only explicit services and users have access to specific resources, helping position future security organizations very favorably.\n\nDefining a clear strategy for infrastructure creation and management — along with a predictable internal IP and DNS record structure — will be invaluable for accessing and protecting your assets as your organization continues to grow. A little later in the document, we'll expand on the ways you can use automated workflows to create infrastructure that can instantly integrates with your chosen Zero Trust security provider. It will be significantly easier to layer security policies over your access control models if you have a continued, clear sense of what infrastructure exists and how it is currently addressed.\n\n#### Where does Cloudflare fit in?\n\nCloudflare Zero Trust can make private networking concepts extensible to your end users with a combination of endpoint software and cloud networking connectors. In this case, you can use Cloudflare as an 'overlay' network to extend secure access to your internal network for end users without exposing public IPs, allowing ingress from your cloud environments, or introducing any sort of additional risk that usually comes with remote access.\n\nWith this 'overlay' network, a small piece of software sits in your network and provides both 'network' tunnels (to give users administrative access to services on your internal network, replacing traditional exposed-bastion concepts) and 'application' tunnels (micro-tunnels that will only allow an authenticated user to explicitly reach the singular service defined in the tunnel).\n\n![Cloudflare providing network and application tunnels to access both company and Internet resources](https://developers.cloudflare.com/_astro/zero-trust-design-guide-traditional-and-mesh-network-building-connecting-users-to-networks.DbAc3MuA_1T4qSQ.svg)\n\nThis makes it significantly easier to manage user access to multiple, distinct private networking environments without forcing the user to change their profile, switch settings, or constantly disconnect or reconnect from one or multiple clients. It also gives you the capability to easily expose a single private application or service to specific audiences while adhering to Zero Trust principles.\n\n## Connecting networks to networks\n\nFor most startups, networking is not at the top of their list of things to change. Typically, businesses follow the path of least resistance, which typically involves managing connected VPCs in AWS or GCP, and maybe setting up a few external connections to physical locations. Most businesses, however, find that their growth results in an increasingly complex network topology — a process that tends to happen very quickly.\n\nWhen simplifying the corporate network, some common extensions may include customer networks, partners, multi-cloud, acquisitions, disaster-recovery planning, and more. As your security organization matures, there will be more and more reasons to spread infrastructure across multiple VPCs (even within the same cloud environment). And, as security groups for those VPCs become increasingly complex, you will find that you are managing multiple internal networks with distinct policies and sometimes distinct operations.\n\nAs these network extensions become more relevant for your business, it's worthwhile to review which connectivity options make the most sense, and explore strategies to build a functionally complex, fundamentally secure network.\n\n### Traditional connectivity\n\nThe traditional methods of network connectivity still have significant value both in physical and in cloud environments, but using them efficiently while maintaining an effective security perimeter can be a challenge. When businesses only had physical connectivity requirements, like branch offices or supplemental data centers, the framework was much more simple. You'd use either edge devices like routers or firewalls to terminate physical connectivity, or a dedicated head-end device to build VPN (“virtual”) network connectivity between the sites. Essentially, you would be connecting two 'networks' together by providing a new route to a new network or subnet for all the machines on your initial site.\n\nIn addition to creating WAN connectivity, the end goal of bridging multiple sites is management simplicity. Having a unified network means that it is easier to support network functions like edge routing, gateways, and addressing via DHCP. However, this can also result in overly-broad policy management, and it can be difficult to manage the security implications of increasingly growing networks with increasingly complex edge cases and unique scenarios.\n\nFor modern startups, the problems may not be the exact ones described above, but you will likely still have to solve for growing network complexity. The best way to navigate this is to *plan effectively*. If you begin building your corporate network with security and scalability in mind, you will be able to easily solve increasing complexity as your security and IT organizations grow.\n\n### Mesh connectivity\n\nWhile traditional networking concepts primarily focus on connecting networks to one another, mesh or peer-to-peer networking concepts connect networks to assets or independent endpoints (e.g. end-user devices, like laptops and cell phones, or IoT devices, like smart lights and security cameras).\n\nIn a traditional network, you may have a VPN tunnel that creates a site-to-site connection between the IP spaces of 10.0.0.0/8 and 192.168.0.0/24, giving all devices within either network a gateway to communicate locally with devices on either network. Conversely, in a mesh networking model, you may only want certain IP spaces to communicate with each other — for instance, enabling 10.2.3.4 to communicate with the device that has the IP address 192.168.0.50.\n\nIf you only operate with 'micro-tunnels' (e.g. discrete X can only reach discrete Y), you massively reduce your opportunities for lateral movement. For example, using a mesh networking model means that IP address 10.2.3.4 would not be able to reach sensitive data on a different 192.168.0.0/24 address (although it might be able to within a traditional network model). However, this increased security posture also results in increased complexity. Not only do you (usually) need to manage agents on each relevant endpoint in a mesh network, but you then need to be prepared to build and manage discrete policies for each asset and connectivity path.\n\nIn some analyst circles, the mesh connectivity space is beginning to be referred to as 'Secure Networking', and while we appreciate the opportunity for differentiation, Cloudflare believes that there are methods for making both traditional and mesh networking effectively secure.\n\n### Where does Cloudflare fit in?\n\nIf both operating models sound complicated and imperfect, it's because they are. Because of this, Cloudflare believes that a blend of the two is typically the right approach for businesses of all sizes.\n\nIf your organization is experimenting with mesh connectivity, Cloudflare can help support discrete connectivity models while layering in unique identity concepts and supporting your security and scalability needs as you construct a networking framework to support your future growth.\n\nThe Cloudflare products that are typically most relevant for startups are a combination of our WARP client (via `cloudflared`) and Cloudflare Tunnel (via WARP Connector). This allows you to manage remote access, mesh connectivity, and traditional networking connectivity from a single dashboard. On a more granular level, this means you can configure device posture information, identity information, client certificates, and common L4 indicators (like port, IP, and source/destination protocols) from a single point of policy enforcement — enabling you to build robust security policies for both human and autonomous network interaction.\n\n![Cloudflare connecting multiple cloud providers, public, and private networks](https://developers.cloudflare.com/_astro/zero-trust-design-guide-traditional-and-mesh-network-building-connecting-networks-to-networks.Du7unmEQ_2khOQE.svg)\n\nThis blend of networking models is designed to support a wide range of use cases, whether you are trying to provide remote access to your corporate network, extend your corporate network to encompass cloud environments on on-premises equipment, or continue building out a model for mesh connectivity between critical infrastructure without introducing additional risk or overhead.\n\n## Building Zero Trust into internal tooling\n\nAmong almost all the startups (and mature companies) that Cloudflare has worked with, security for internal tooling continues to be a ubiquitous challenge. You may build tools that you need to accomplish tasks specific to your business, or you may choose to self-host or use open source software — which can also be consumed as popular SaaS applications for services, monitoring, or other functions.\n\nThe principles outlined in previous sections address methods of managing remote access to these resources and deal primarily with authentication. In summary, achieving a Zero Trust model in practice requires you to ensure that access to each internal service is controlled by a continuous identity authentication proxy, ideally one that is physically separated from your network perimeter, has clear auditability, and offers the capability to quickly revoke user access as needed.\n\nHowever, one of the biggest challenges businesses face as they begin to implement a Zero Trust model is not authentication, but authorization. Getting the user to the front door of your application in a Zero Trust model is (relatively) easy, but managing their credentials for both authentication and authorization, ensuring that the two match, and simultaneously maintaining a positive, non-invasive user experience can be very difficult.\n\nIn an ideal world, we believe that authentication and authorization should be handled by the same service. This would mean that while deliberating how to secure your internal applications — whether to build OAUTH capabilities into them directly or to integrate directly with the primary SSO that you use for your SaaS applications — you would also consider how your authentication methods may conflict or become duplicative with your identity validation methods. There are two primary ways to use these concepts to set yourself up for scalable success with authentication and authorization.\n\n### Consuming Zero Trust vendor tokens\n\n'Vendor tokens' is a concept that does not exist for every Zero Trust or SSE vendor. This is due to Cloudflare's relatively unique approach; because we're the world's largest provider of authoritative DNS, we provide DNS for the 'external' path to your internal applications, then create tokens for user access.\n\nThese tokens are based on the information Cloudflare receives from your identity provider after a successful authentication event, which matches against custom policies for that application. Each token contains all of the content that would be signed in a user's authentication event with their IdP: their name, username, email, group membership, and whatever other values are present. It also gets a unique tag to indicate its relevance to a specific application.\n\nOnce the *Cloudflare* token has been created, it is passed to your internal applications to validate their requests and authorize access to your internal tooling. This takes minimal additional work per-application, and can be built into application creation workflows where you would otherwise need a complete OAUTH integration or SSO integration.\n\nBy using Cloudflare tokens, your users will have a seamless experience both *authenticating* through your established Zero Trust proxy and getting *authorized* directly into your application with the same information.\n\n![How Cloudflare consumes tokens to validate requests and authorize access to internal tools](https://developers.cloudflare.com/_astro/zero-trust-design-guide-building-zero-trust-into-internal-tooling-consuming-tokens.D9KBiyO0_vFzmk.svg)\n\n### Your Zero Trust vendor as an SSO\n\nSome Zero Trust vendors provide the capability to operate as an SSO provider, integrating directly with your applications (like open-source or self-hosted solutions) which come with a pre-built SSO connector. In this flow, your SSO controls your authorization to the application, and your Zero Trust vendor calls out to your identity provider to make authentication decisions, without needing to manage multiple primary directories.\n\nFor Cloudflare users, this offers a number of advantages: it helps streamline authentication (AuthN) and authorization (AuthZ), reduces your reliance on a specific SSO vendor, and allows you to use multiple simultaneous authentication providers. Most importantly, it enables you to easily adopt or switch to a new identity provider.Businesses may not use the same identity provider at 25-50 users that they use at 300-500+, and there is always significant friction in the hard cutover required to move from one SSO integration to another. This transition can be especially difficult considering the time and frustration present in some applications' SSO integrations. Using Cloudflare as an SSO provider can help alleviate that friction by aggregating all of your identity, device posture, and risk integrations within a single policy enforcement point — thereby helping you streamline your AuthZ/AuthN and put additional security controls in front of your self-hosted applications.\n\n### Where does Cloudflare fit in?\n\nWe recommend using our Cloudflare Access product for remote access to your internal services (by way of our Cloudflare Tunnel software in your network). With Cloudflare Access, you can [consume the JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/) created by Cloudflare Access or use [Access for SaaS](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/) to act as a SAML or OAUTH proxy for your private, self-hosted applications (which have SSO integrations pre-built into them).\n\nIn a lot of cases, you may even use both products for application access. For example, if you're self-hosting [Sentry](https://sentry.io/) — which is not currently available on the public Internet — follow these steps:\n\n1. Set up a public hostname with Cloudflare Access (which your users would navigate to Sentry on).\n2. Install a Cloudflare Tunnel with an associated **Published application** to point to your local Sentry service.\n3. Integrate Sentry with Access for SaaS as the SSO provider.\n\nNow, users reaching the application from outside your network will already carry the Cloudflare JWT, and will be seamlessly authenticated into your application.\n\n![Building zero trust into internal tooling and SSO](https://developers.cloudflare.com/_astro/zero-trust-design-guide-building-zero-trust-into-internal-tooling-sso.3OqU4GE9_ZGXtOx.svg)\n\n## Remote access for contractors, vendors, and customers\n\nEstablished and accepted patterns for corporate user remote access don't always extend to heterogeneous sets of users, which usually include contractors, third-party vendors, and even customers. All these user groups can have valid reasons for engaging with your private resources. It's possible you may hire development or maintenance contractors that need access to some parts of your network or applications, but providing them complete network access would introduce unnecessary risk.\n\nIt's also possible that you may provide hosted or managed services to your customers that they would then deploy within their own networks. In that case, you may need to connect with those services to appropriately manage them. Or, subsequently, you may host private resources for customers within your own environment and need to give them secure access to only access their relevant tenant.\n\n### Establishing scope\n\nWhenever you determine a need for third-party user access to your environment, you should first determine three attributes:\n\n* What they need to access\n* What level of authentication is required for that access\n* How long this access will be relevant\n\n### Web access for third parties\n\nAfter determining the scope, you should determine the least-privilege access model appropriate for the user group. This may mean integrating with a secondary identity provider (maybe the customer or vendor's IdP) to use in authentication events, or using a temporary authentication method like a one-time PIN to authenticate against their email address only.\n\nSome businesses also add vendor and contractor users to *their* identity provider to streamline authentication and to control methods (like the use of MFA and other authentication factors). At a minimum, we recommend working with a Zero Trust security provider who supports multiple, simultaneous methods for authentication, and can apply them via specific policies or applications.\n\nThis allows you to keep all of your existing methods of secure remote access consistent. Your external user cohort will use the same paths into your network and will be subject to all of your security controls. Meanwhile, you will receive detailed logging and audit trails to dictate exactly what users had access to, how frequently they accessed them, and what kind of actions they took within your network. Assigning least-privilege controls can also easily establish an access model while ensuring that users aren't able to perform any lateral actions or access resources within your network unnecessarily.\n\n### Administrative or network third-party access\n\nIf this access can't be established over a web browser and needs network-level controls, your external users may need to deploy the endpoint agent used for your Zero Trust deployment. For example, contractor groups often have multiple endpoint agents connected to a single user machine, which can introduce network routing complexity — or even conflicts, if some of these private networks overlap across different businesses.\n\nTo ensure a simple, manageable process for ensuring third-party access, consider the following:\n\n1. **Can your Zero Trust vendor support multiple profiles for endpoint agent deployment?** Contractor users should have tightly-scoped routing controls to ensure limited access to your network and limited risks of conflict with other agents on the device.\n2. **Is third-party access materially different from corporate user access?** If not, you can streamline your administrative management activities by building functional identities and integrations for third parties. New policies may not necessarily need to be created, as long as everything can be audited and differentiated.\n\n### Access to customer environments (and vice versa)\n\nIn some cases, corporate users need secure (persistent or temporary) access to customer environments, or customers may need similar secure access to unique, hosted environments within your network. This process may include hosting software tenants for customers, running maintenance on customer-hosted software, or providing connectors for product functionality that ties into customers' internal networks.\n\nFor these use cases, the traditional recommended model has been a networking configuration like site-to-site VPNs and similar options. These can be scoped appropriately, but often result in overly broad connectivity between your corporate network and your customer network, and can introduce risk or overly-broad access capability.\n\nIn a Zero Trust security framework, this kind of access should be explicitly scoped in a least-privilege model. This can be accomplished by setting up identity-aware or service-aware site-to-site connectivity, or by using unidirectional connector models to provide secure access in either direction, which can be scoped to specific actions.\n\n### Where does Cloudflare fit in?\n\nCloudflare can help provide scoped secure access for both web and network connectivity to your third-party users in a Zero Trust framework.\n\n* **Cloudflare Access can integrate and use [multiple identity providers simultaneously](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/).** This can be scoped to a single application and a singular policy, and can have granular capabilities to 'force' some user access to authenticate in specific ways. There are also many third-party specific workflows — like [purpose justification](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/require-purpose-justification/) — that can ensure that user access is both easy for third parties, and documented and controllable for administrators.\n* **Cloudflare Zero Trust can be deployed with flexible endpoint agent parameters and [logical groupings](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/) for contractor and third-party users.** If you have external users with internal access needs, they can be both tightly-scoped and limit potential conflict with other external systems.\n* **[Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/) can act as a unidirectional access model to provide corporate users access to scoped customer resources.** It is lightweight, easy to deploy, and can even be built into your deployment packages and deployed alongside the services you manage in customer environments.\n* **Cloudflare WARP Connector can help you build secure, extensible networks relevant for each of your client controls.** This is particularly helpful when bidirectional (site-to-site) traffic flows are a necessity for the way that you engage with your customers, interact with their applications, or address other management concerns. WARP Connector has all of the same inline security policy application and auditability controls as the rest of your deployment, so you can maintain a Zero Trust security posture while achieving customer connectivity.\n\n![How Cloudflare provides remote access for contractors, vendors, and customers](https://developers.cloudflare.com/_astro/zero-trust-design-guide-remote-access-for-contractors-vendors-and-customers.V8gJYmrW_1pQMX2.svg)\n\n## Protecting against Internet threats (or, *is secure web gateway a part of Zero Trust?*)\n\nTraditionally, the concept of Zero Trust access has been explicitly relegated to user or machine access to internal or privileged resources. On a functional level, this requires replacing network extension, reducing over-permissioning, and minimizing lateral movement and threat vectors typically delivered from VPN remote access connectivity. But for many businesses, their VPN didn't only proxy their private network traffic. It also managed their Internet traffic and allowed them to maintain a unified view of threats — typically, either through a module to send DNS queries to a cloud provider, or by simply backhauling all user traffic to the corporate network to be sent through the corporate firewalls.\n\nThe security and complexity challenges introduced by this castle-and-moat model has forced many vendors to address the two primary functions a VPN serves. Now, it is common to hear secure web gateways (SWG) and Zero Trust access (ZTNA) discussed in the same sentence or as part of the same product.\n\nAlthough this shift was driven by vendors and analysts, rather than security researchers, it has seemed to improve security manageability for customers while simplifying the buying and deployment process for startups. Namely, deploying a single agent to handle both your corporate and Internet traffic is a significant improvement over using multiple device agents to handle all sorts of security tooling.\n\n### Long Live The New Perimeter\n\nIn the old world, your perimeter was denoted by your public egress IP address, and indicated that you were subject to a series of security controls before your traffic went out to the Internet. Maybe it was a firewall, IPS, IDS, or something else. For that reason, businesses began requiring a specific source IP for traffic before it could be 'trusted'; this was used with vendors, third parties, and SaaS applications. Traffic originating from the corporate network (with your corporate source IPs) was one of the biggest indicators of 'trust'. It's no longer that simple.\n\nToday, it's likely that your business has no central 'perimeter' at all. It likely started in the cloud, ships out user endpoints either raw or with some pre-configured security control, and runs everything remotely and asynchronously. This model is highly impactful for your productivity and ability to scale. However, as your security organization grows and matures, there will be an inherent benefit to setting a baseline security 'posture' that will denote the new perimeter.\n\n#### A perimeter-less model\n\nIn a world in which your Zero Trust provider and your SSO should be able to protect most of your private applications, networks, services, and SaaS applications, users should be more empowered than ever to work from anywhere — and your asynchronous, highly-effective style of work shouldn't need to be interrupted if you follow best practices. In other words, **your definition of a 'secure' endpoint becomes your new corporate perimeter.**\n\nA defined secure endpoint, with clear measurability is significantly better for security posture because, unlike a source IP address, it's both highly targeted and continually validated. In the old world, this would mean egressing through a firewall and being subject to security controls. In the new world, this typically means verifying encryption, interrogating posture on the device, and determining whether or not the traffic coming from the machine was inspected by a secure web gateway. It could even still include source IP address as a method of validation, but never as the primary control.\n\nAs you think about how you want to manage the usage of BYOD (and how you want to ensure your corporate data is being accessed securely), you just have to make a determination about what constitutes your secure endpoint strategy. Then, consider how you should interrogate requests to sensitive resources to ensure that they are compliant with this strategy. For instance, think about the steps users will need to take in order to access Workday (or another PII-heavy system). Before granting access, you may want to send their traffic through your secure web gateway and apply data loss prevention policies. Now ask yourself, what other steps do you need to take in order to enforce these requirements?\n\nWithin this discussion, we are thinking about Internet security (e.g. secure web gateways, DNS filtering, traffic proxying, and so on) as a set of advanced security signals from which you can apply more accurate, granular Zero Trust policies for your sensitive resources. It's also a good practice to get started withDNS filtering as soon as possible, since deploying software and proxying traffic from your endpoints will only become a more complex process as your business and security needs grow. As you start to think about other advanced security controls, like HTTP filtering and data loss prevention, we recommend reading [Getting Started with TLS Decryption](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/build-http-policies/tls-inspection/) to get a sense of the decisions to be made before decrypting traffic.\n\n### Where does Cloudflare fit in?\n\nIn addition to providing Zero Trust security capabilities for internal applications, network remote access, and SaaS applications, Cloudflare also provides the following functionality:\n\n* DNS filtering\n* An L4 firewall\n* A secure web gateway (SWG) — complete with application-awareness, TLS decryption, data loss prevention, CASB functionality, browser isolation, and the ability to adopt a dedicated egress IP structure directly from the Cloudflare network\n\nAll of our SWG functionality is controlled via policy that factors in user identity, device posture, and user risk, and is delivered from the same endpoint agent as your Zero Trust controls — using the same policy engines and policy enforcement opportunities.\n\nCloudflare allows you to functionally build a new perimeter by identifying, applying policies to, and securing the outbound traffic on your managed endpoint devices. You can achieve the same unified security control as the old castle-and-moat perimeter, while applying independent, granular security evaluation (but without backhauling any user traffic). Then, you can use that security evaluation to apply even stronger controls from your Zero Trust-protected applications, helping you distinguish between low, medium, and high risk users, make determinations about how to handle BYOD traffic, and more.\n\n![How Cloudflare protects against Internet threats](https://developers.cloudflare.com/_astro/zero-trust-design-guide-protecting-against-internet-threats.C7veiXE5_2w2P11.svg)\n\n## Adopting and securing SaaS applications\n\nThe concept of SaaS security means a lot of things to a lot of people. For that reason, it's a somewhat controversial topic, especially as it relates to Zero Trust. SaaS services saw huge user population booms during the first wave of COVID, due in large part to a significant increase in remote work. Almost overnight, it was easier and more practical for users to connect to services that existed outside of corporate infrastructure than it was to connect to internal services.\n\nSome make the argument that SaaS applications are either 1) inherently secure when you've integrated SSO, or 2) are the functional responsibility of the SaaS provider to secure. While these arguments address the way in which your SaaS investment is accessed and secured, they do not contextualize why companies use SaaS — which is typically for storing corporate information. The proliferation of 'places your sensitive data may live' will be an increasingly important factor in your SaaS security decisions.\n\nThe above statements all imply that you know what SaaS tooling your users engage with, but often that is not the case. First, we'll address 'sanctioned' SaaS adoption, and then we will discuss concepts related to 'unsanctioned' SaaS (also known as shadow IT).\n\n### Sanctioned SaaS applications\n\nDetermining your required security posture is an important first step for your end users before you build any sort of security policy. So, if you have applications which contain significant amounts of corporate data or other data subject to compliance laws or other regulations, it may make sense to restrict those exclusively to devices that fit your aforementioned 'perimeter'.\n\nThe best way to accomplish this is to find an aggregator of your signal (like Cloudflare's Access for SaaS) that can ensure all of the individual pieces of your security policy are continuously being applied for user access. Can you accomplish all of this with a traditional SSO vendor? Maybe. Okta's FastPass, for example, makes a determination of machine identity by validating a certificate that is installed on local devices, then determining the source IP address of the request. In most cases, however, FastPass would not be able to tell you more about the security inspection events present in that user's traffic, or anything else about the health of the end-user device. To this point, it is worth noting that your SSO provider is only as useful as the amount of data it can consume to make a policy decision.\n\nIf you decide that only machine certificates or only another measure of signal is appropriate for denoting a corporate device, this is totally appropriate at any stage of a business's security maturity — in fact, many businesses have yet to adopt device posture of any kind.\n\nAnother way to manage your sanctioned SaaS applications is to integrate with your Zero Trust vendor via API. Then, you can scan them for misconfiguration or the presence of unexpected sensitive data. This process is independent of traditional Zero Trust access controls, but is offered by most Zero Trust vendors and can surface ongoing necessary configuration changes for all of your SaaS tools in a single view.\n\nBy evaluating the presence of sensitive data in SaaS applications that you manage, you can start to develop a sense of policy priority. Put another way, it may change the way that you think about what should be able to be accessed via BYOD vs. what should require authorized access from a managed endpoint. Or, conversely, how can you quantify the risk for BYOD access such that your users can be effectively conditioned?\n\n### Unsanctioned SaaS applications (Shadow IT)\n\nThe security model significantly changes when you move from SaaS applications you do control (i.e. can integrate with SSO and other third-party tools) to applications you don't control. SaaS apps that fall into this category are often classified as 'unsanctioned' applications — sometimes, because they are managed by a secondary vendor that doesn't support SSO, or because they are services which haven't been explicitly approved by your IT organization for use. These unsanctioned apps are called shadow IT.\n\nHow do these apps proliferate within your environment? The logic is simple, especially with a startup. Users like to move quickly and may gravitate toward the most convenient method of getting their work across the finish line. Sometimes that can mean using tools that haven't been vetted or approved for use (or for potentially storing sensitive data).\n\nShadow IT is typically addressed as part of a general Internet security program, which sometimes falls within the same consideration set (or the same vendors) as a Zero Trust deployment. De-risking unsanctioned SaaS applications is almost always centered around visibility. The most important thing you can do — without having things like SSO or your CASB tool integrated with an application — is understand the breadth of shadow IT usage.\n\nDocumenting unsanctioned applications usually requires using a forward-proxy tool like a DNS filter, secure web gateway, or some email-specific tooling. These tools can provide insights into which users have engaged with unsanctioned SaaS apps, and potentially even how they engaged with them (did they upload/download files, how much bandwidth have they transferred, etc.).\n\nBy implementing policies and strategies to document SaaS usage, you can start to form a better understanding of how your sensitive data is stored, moved, or manipulated within SaaS tools. Some businesses limit the use of SaaS to explicitly-approved corporate tools, while others are more lenient. There's no wrong approach, but building an early framework for how to capture usage information can help you work backwards in the event that it becomes a pressing matter for your organization.\n\nThis framework can also give your IT organization direction on which tools to consider procurement cycles for. For example, if a critical mass of users already engages with a tool, it can sometimes make sense to get Enterprise capabilities for that tool to reduce the risk of shadow IT or allow your team to implement increased security features, sometimes without dramatically changing cost.\n\n### Where does Cloudflare fit in?\n\nCloudflare can help set a foundation for visibility and management of your [shadow IT](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) environment and subsequent discoveries. User traffic to the Internet can be audited and organized from the WARP client and our [Secure Web Gateway (SWG)](https://developers.cloudflare.com/cloudflare-one/traffic-policies/), and can you understand where your sensitive data moves outside of your corporate-accepted SaaS tenants.\n\nThis can then be an opportunity to further expand your Zero Trust strategy by ensuring those newly-discovered tools are either explicitly blocked or explicitly allowed, setting specific data security controls on them, or integrating them with your Zero Trust vendor (using something like [Access for SaaS](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/aws-sso-saas/) to apply security policies).\n\n## Long-term management with APIs and Infrastructure as Code (IaC)\n\nMany startups we speak to are ultimately concerned with the headcount and expertise required to manage security tooling that appears complex or overprovisioned for their use cases. Much of what they already do for development is managed through orchestration tools, Infrastructure as Code, and directly via API — but they often want to achieve a state of DevSecOps, where all Zero Trust (and other security tooling) projects can be built, managed, and maintained as code.\n\nWhile this is somewhat of an emerging concept for traditional security tooling, it should still be a critical consideration as you evaluate potential vendors. Keep in mind that although concepts like Terraform are supported by a number of Zero Trust vendors, these vendors may not support (or publish) provider or API endpoints for every concept in the product, which can lead to duplication or division in management efforts.\n\nIf your goal as an organization is to manage your networking and security stacks as code, it is important to start that framework early in your Zero Trust journey. While there may be challenges to navigate, getting a head start on network development will pay dividends as your business and security needs become inevitably more complex and difficult to manage.\n\nAs you continue to evaluate vendor partners for Zero Trust or general security initiatives, we recommend that you ensure that they have well-documented and complete API endpoints for their entire product portfolio and management controls — as well as documentation for orchestration and Infrastructure as Code tools (like Terraform).\n\n### Where does Cloudflare fit in?\n\nCloudflare is very passionate about Zero Trust security in the context of DevSecOps. We build API-first as a primary ethos for all our products, and make all relevant API endpoints available to customers on the first day of feature availability, along with our extensive [documentation](https://developers.cloudflare.com/api/).\n\nSeparately, many of our customers manage their Cloudflare Zero Trust deployment without ever touching our dashboard; instead, they use Terraform or similar tools for their entire management plane. If this is the case for you, we have a comprehensive and complete [Terraform provider](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) to enable you to accomplish Zero Trust as Code.\n\nIn conclusion, making a few deliberate choices today about how your company approaches the basics of security and authentication will benefit your startup for years to come. The decisions you make now lay the foundation for a modern security infrastructure that will scale smoothly as your business grows. However you move forward, a few well-informed moves will ensure that your startup is built on sustainable, scalable Zero Trust security principles.\n\nIf you would like to discuss your Zero Trust requirements in greater detail and connect with one of our architects, visit <https://www.cloudflare.com/cloudflare-one/> and request a consultation.\n\n<page>\n---\ntitle: Artificial Intelligence (AI) · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/ai/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/ai/index.md\n---\n\n* [AI Vibe Coding Platform](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-vibe-coding-platform/)\n* [Automatic captioning for video uploads](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-video-caption/)\n* [Composable AI architecture](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-composable/)\n* [Content-based asset creation](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-asset-creation/)\n* [Ingesting BigQuery Data into Workers AI](https://developers.cloudflare.com/reference-architecture/diagrams/ai/bigquery-workers-ai/)\n* [Multi-vendor AI observability and control](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-multivendor-observability-control/)\n* [Retrieval Augmented Generation (RAG)](https://developers.cloudflare.com/reference-architecture/diagrams/ai/ai-rag/)\n\n<page>\n---\ntitle: Bots · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/bots/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/bots/index.md\n---\n\n* [Bot management](https://developers.cloudflare.com/reference-architecture/diagrams/bots/bot-management/)\n\n<page>\n---\ntitle: Content Delivery · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/content-delivery/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/content-delivery/index.md\n---\n\n* [Optimizing image delivery with Cloudflare image resizing and R2](https://developers.cloudflare.com/reference-architecture/diagrams/content-delivery/optimizing-image-delivery-with-cloudflare-image-resizing-and-r2/)\n\n<page>\n---\ntitle: Internet of Things (IoT) · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/iot/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/iot/index.md\n---\n\n* [Optimizing and securing connected transportation systems](https://developers.cloudflare.com/reference-architecture/diagrams/iot/optimizing-and-securing-connected-transportation-systems/)\n\n<page>\n---\ntitle: Network · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/network/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/network/index.md\n---\n\n* [Bring your own IP space to Cloudflare](https://developers.cloudflare.com/reference-architecture/diagrams/network/bring-your-own-ip-space-to-cloudflare/)\n* [Optimizing device roaming experience with geolocated IPs](https://developers.cloudflare.com/reference-architecture/diagrams/network/optimizing-roaming-experience-with-geolocated-ips/)\n* [Protect data center networks](https://developers.cloudflare.com/reference-architecture/diagrams/network/protect-data-center-networks/)\n* [Protect hybrid cloud networks with Cloudflare Magic Transit](https://developers.cloudflare.com/reference-architecture/diagrams/network/protect-hybrid-cloud-networks-with-cloudflare-magic-transit/)\n* [Protect ISP and telecommunications networks from DDoS attacks](https://developers.cloudflare.com/reference-architecture/diagrams/network/protecting-sp-networks-from-ddos/)\n* [Protect public networks with Cloudflare](https://developers.cloudflare.com/reference-architecture/diagrams/network/protect-public-networks-with-cloudflare/)\n\n<page>\n---\ntitle: Security · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/security/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/security/index.md\n---\n\n* [FIPS 140 level 3 compliance with Cloudflare Application Services](https://developers.cloudflare.com/reference-architecture/diagrams/security/fips-140-3/)\n* [Securing data at rest](https://developers.cloudflare.com/reference-architecture/diagrams/security/securing-data-at-rest/)\n* [Securing data in transit](https://developers.cloudflare.com/reference-architecture/diagrams/security/securing-data-in-transit/)\n* [Securing data in use](https://developers.cloudflare.com/reference-architecture/diagrams/security/securing-data-in-use/)\n\n<page>\n---\ntitle: Secure Access Service Edge (SASE) · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/sase/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/sase/index.md\n---\n\n* [Access to private apps without having to deploy client agents](https://developers.cloudflare.com/reference-architecture/diagrams/sase/sase-clientless-access-private-dns/)\n* [Deploy self-hosted VoIP services for hybrid users](https://developers.cloudflare.com/reference-architecture/diagrams/sase/deploying-self-hosted-voip-services-for-hybrid-users/)\n* [DNS filtering solution for Internet service providers](https://developers.cloudflare.com/reference-architecture/diagrams/sase/gateway-dns-for-isp/)\n* [Extend ZTNA with external authorization and serverless computing](https://developers.cloudflare.com/reference-architecture/diagrams/sase/augment-access-with-serverless/)\n* [Magic WAN Connector deployment options](https://developers.cloudflare.com/reference-architecture/diagrams/sase/magic-wan-connector-deployment/)\n* [Protective DNS for governments](https://developers.cloudflare.com/reference-architecture/diagrams/sase/gateway-for-protective-dns/)\n* [Secure access to SaaS applications with SASE](https://developers.cloudflare.com/reference-architecture/diagrams/sase/secure-access-to-saas-applications-with-sase/)\n* [Zero Trust and Virtual Desktop Infrastructure](https://developers.cloudflare.com/reference-architecture/diagrams/sase/zero-trust-and-virtual-desktop-infrastructure/)\n\n<page>\n---\ntitle: Serverless · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/serverless/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/serverless/index.md\n---\n\n* [A/B-testing using Workers](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/a-b-testing-using-workers/)\n* [Fullstack applications](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/fullstack-application/)\n* [Programmable Platforms](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/programmable-platforms/)\n* [Serverless ETL pipelines](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/serverless-etl/)\n* [Serverless global APIs](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/serverless-global-apis/)\n* [Serverless image content management](https://developers.cloudflare.com/reference-architecture/diagrams/serverless/serverless-image-content-management/)\n\n<page>\n---\ntitle: Storage · Cloudflare Reference Architecture docs\nlastUpdated: 2024-12-12T12:06:35.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/diagrams/storage/\n  md: https://developers.cloudflare.com/reference-architecture/diagrams/storage/index.md\n---\n\n* [Control and data plane architectural pattern for Durable Objects](https://developers.cloudflare.com/reference-architecture/diagrams/storage/durable-object-control-data-plane-pattern/)\n* [Egress-free object storage in multi-cloud setups](https://developers.cloudflare.com/reference-architecture/diagrams/storage/egress-free-storage-multi-cloud/)\n* [Event notifications for storage](https://developers.cloudflare.com/reference-architecture/diagrams/storage/event-notifications-for-storage/)\n* [On-demand Object Storage Data Migration](https://developers.cloudflare.com/reference-architecture/diagrams/storage/on-demand-object-storage-migration/)\n* [Storing user generated content](https://developers.cloudflare.com/reference-architecture/diagrams/storage/storing-user-generated-content/)\n\n<page>\n---\ntitle: Application Security · Cloudflare Reference Architecture docs\ndescription: Application security implementation guides walk you through the\n  steps to secure your public applications, devices and APIs with Cloudflare.\nlastUpdated: 2025-01-31T09:20:50.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/implementation-guides/application-security/\n  md: https://developers.cloudflare.com/reference-architecture/implementation-guides/application-security/index.md\n---\n\nApplication security implementation guides walk you through the steps to secure your public applications, devices and APIs with Cloudflare.\n\n## Application Security\n\n* [Use mTLS with Cloudflare protected resources](https://developers.cloudflare.com/learning-paths/mtls/concepts/)\n\n<page>\n---\ntitle: Registrant contact updates · Cloudflare Registrar docs\ndescription: It is important that you keep your contact details accurate and\n  up-to-date. ICANN rules state that if you do not have updated contact\n  information, your domain name registration may be suspended or even cancelled.\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/domain-contact-updates/\n  md: https://developers.cloudflare.com/registrar/account-options/domain-contact-updates/index.md\n---\n\nIt is important that you keep your contact details accurate and up-to-date. [ICANN rules state](https://www.icann.org/resources/pages/registrant-contact-information-wdrp-2017-08-31-en) that if you do not have updated contact information, your domain name registration may be suspended or even cancelled.\n\nThe contact information you can update includes:\n\n* First name\n* Last name\n* Email\n* Organization\n* Phone\n* Address including City, State/Province, Postal code & Country\n\nTo update your registrant contacts:\n\n1. In the Cloudflare dashboard, go to the **Manage domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find **Default contact** and select **Edit**.\n\n3. Update the relevant information, and select **Save**.\n\n4. Find the domain where you want to update your contact information, and select **Manage**.\n\n5. Select the **Contacts** tab, and edit the contact information.\n\nIf you change any of the following fields, Cloudflare Registrar will require a Change of Registrant approval before the changes are finalized:\n\n* First name\n* Last name\n* Organization\n* Email address\n\nIf you update any of the fields mentioned above, Cloudflare Registrar will send an approval email to the current registrant's email address. The approval email contains a link to a web page where the requested change may be viewed and approved or rejected. If the pending change is not approved or rejected within seven days, the request will automatically be canceled.\n\nIf you do not update these fields, your contact information is updated immediately and no further action is required.\n\nAfter selecting the link in the approval email Cloudflare sends you, you have the option to accept or reject the contact changes. If you select the **Accept** button, your domain will be transfer-locked for 60 days.\n\nIf you do not want your domain to be locked, be sure to select the **Do not apply 60 day transfer lock** checkbox *before* selecting the **Accept** button. This applies to all supported TLDs, including `.uk`.\n\n## Changing email contact\n\nIf the registrant contact update also includes a change to the email address, Cloudflare sends a second approval email to the new (requested) email address. Both the old (original) email address and the new one have to approve the change for the change to be successfully completed.\n\nOnly the current registrant may opt out of the transfer lock, however. The approval page for the new registrant will not include the option to opt out.\n\n## 60-day transfer lock\n\nAfter the changes for the registrant contact are approved, the domain will be placed on a transfer lock for 60 days. This happens when you approve changes to the registrant contacts without checking the box to prevent the transfer lock.\n\nThis transfer lock prevents the transfer of the domain to another registrar, and the transfer to another Cloudflare account. It does not prevent additional updates to the domain name.\n\nIf the registrant contact is updated again while the domain is in the 60-day lock period, the lock expiration will be further extended to 60 days from the most recent update.\n\n<page>\n---\ntitle: Zero Trust · Cloudflare Reference Architecture docs\ndescription: Zero Trust implementation guides walk you through the steps to\n  deploy a Zero Trust solution with Cloudflare.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/reference-architecture/implementation-guides/zero-trust/\n  md: https://developers.cloudflare.com/reference-architecture/implementation-guides/zero-trust/index.md\n---\n\nZero Trust implementation guides walk you through the steps to deploy a Zero Trust solution with Cloudflare.\n\n* [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/concepts/)\n* [Replace your VPN](https://developers.cloudflare.com/learning-paths/replace-vpn/concepts/)\n* [Deploy Zero Trust Web Access](https://developers.cloudflare.com/learning-paths/clientless-access/concepts/)\n* [Secure Microsoft 365 email with Email security](https://developers.cloudflare.com/learning-paths/secure-o365-email/concepts/)\n\n<page>\n---\ntitle: Domain management · Cloudflare Registrar docs\ndescription: When your domain is registered with Cloudflare, you can review your\n  domain status in Overview.\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/domain-management/\n  md: https://developers.cloudflare.com/registrar/account-options/domain-management/index.md\n---\n\nWhen your domain is registered with Cloudflare, you can review your domain status in **Overview**.\n\n1. In the Cloudflare dashboard, go to the **Manage domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. From **Overview**, scroll down to **Domain Registration** to review the current expiration date.\n\n3. Select **Manage domain** to review the Auto-Renew status for your domain.\n\n## Billing information\n\nDomain registrations will not appear in the **Active Subscriptions** section of the dashboard, as Registrar is not subscription based. To check information related to your domain billing:\n\n1. In the Cloudflare dashboard, go to the **Manage Domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to check and select **Manage**.\n\n3. Refer to **Registration** for information regarding your domain fees. From here, you can also opt to [renew or extend](https://developers.cloudflare.com/registrar/account-options/renew-domains/) your domain registration.\n\n## Edit WHOIS records\n\nCloudflare redacts WHOIS information from your domain by default. However, we do store the authentic WHOIS record for your domain. You may edit the WHOIS contact data for any domain. To do that:\n\n1. In the Cloudflare dashboard, go to the **Manage Domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to edit and select **Manage** > **Contacts**.\n\n3. Select **Edit** in any of the contacts you previously set up. This allows you to update the contact information for the selected domain only. It will not update the contact information for other domains within the account.\n\nRefer to [Registrant contact updates](https://developers.cloudflare.com/registrar/account-options/domain-contact-updates/) for more information.\n\n## Edit Default Contact information\n\nThe first time you transfer or register a new domain, a Cloudflare Registrar creates a Default Contact with information that can be used for future transfers and registrations. The contact data may be updated at any time in the dashboard. Updating the Default Contact data will not update the contact information for any domains already in the account. This Default Contact data is only used to prepopulate contact information for new registrations and transfers.\n\nIt is important that you keep this information accurate and up-to-date. Refer to [Registrant contact updates](https://developers.cloudflare.com/registrar/account-options/domain-contact-updates/) for important information about this topic, and to learn how to update this information.\n\n## Delete a domain registration\n\nDomains using Cloudflare Registrar will be deleted automatically after expiration if they have not been renewed. The exact timing varies, refer to [What happens when a domain expires?](https://developers.cloudflare.com/registrar/faq/#what-happens-when-a-domain-expires) for more details.\n\nDeletion is irreversible\n\nDeleting a domain registration from Cloudflare Registrar starts an irreversible process. At the end of that process, the domain will be available for anyone to purchase at any domain registrar. This means you should only delete your registration if you are comfortable losing it. If you intend to keep the domain but use another registrar, refer to [Transfer domain from Cloudflare to another registrar](https://developers.cloudflare.com/registrar/account-options/transfer-out-from-cloudflare/).\n\nThere may be instances where users may wish to delete a domain prior to expiration. In most cases a domain may be deleted prior to expiration by following these steps:\n\n1. In the Cloudflare dashboard, go to the **Manage Domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Under the **Configuration** tab on the Manage page you will find a **Delete** button.\n\n3. If the domain is deletable the button will be active. The button will be disabled if your domain cannot be deleted and you should refer to the Registrar [FAQ](https://developers.cloudflare.com/registrar/faq/#why-am-i-unable-to-delete-my-registrar-domain).\n\n4. Once you click the Delete button, you will be presented with a confirmation window. If you proceed, an email will be sent to all users with the Super Admin role in the account. The email contains a deletion authorization token that must be entered into the window which appears to confirm and complete the deletion.\n\nOnce all steps are completed, the domain will then be scheduled for deletion. To understand more about the timelines and potential reasons why a domain cannot be deleted, refer to the Registrar [FAQ](https://developers.cloudflare.com/registrar/faq/#domain-deletions).\n\n<page>\n---\ntitle: iCloud Custom Email Domains · Cloudflare Registrar docs\ndescription: With iCloud Custom Email Domain, you can now purchase a custom\n  domain right from iCloud Settings through Cloudflare and have it automatically\n  set up with your iCloud Mail account. It's great if you want to create a\n  custom email domain for you or your family, such as @examplefamily.com.\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/icloud-domains/\n  md: https://developers.cloudflare.com/registrar/account-options/icloud-domains/index.md\n---\n\nWith [iCloud Custom Email Domain](https://support.apple.com/kb/HT212514), you can now purchase a custom domain right from iCloud Settings through Cloudflare and have it automatically set up with your iCloud Mail account. It's great if you want to create a custom email domain for you or your family, such as @examplefamily.com.\n\nYou will need an active iCloud+ subscription to add a custom email domain.\n\n## Purchase custom email domain\n\nIf you want to buy a custom email domain, go to your [iCloud](https://www.icloud.com/settings/) settings and scroll down to **Custom Email Domain**.\n\n## Log in to Cloudflare\n\nOnce you have bought a custom email domain, you can manage your domain and other options through the [Cloudflare Dashboard](https://dash.cloudflare.com/login).\n\n### Signing in with Apple\n\nIf you had signed up with Apple, signing into Cloudflare is as easy as clicking the “Sign in with Apple” button.\n\n### Signing in with Cloudflare\n\nIf you had signed up with Cloudflare, signing into Cloudflare can be done with your email and password.\n\n## Billing information\n\n### Supported payment methods\n\nFor domain registration, Cloudflare supports the following payment methods:\n\n* Credit Card\n* PayPal\n* Apple Pay (available if you have a wallet with a valid payment method and are using an iOS device or Safari on macOS)\n\nFor domain renewals, Apple Pay does not currently support recurring payments. You can either add another payment method (Credit Card or PayPal) for automatic renewals or log into [your account](#log-in-to-cloudflare) near the renewal date and use Apple Pay.\n\n### Local currency price estimates\n\nUsers may see a price estimate in both U.S. Dollars and a local currency. This is only an estimate based on the current exchange rate.\n\nThe final payment will be charged in US dollars.\n\nIf you are not receiving emails intended for your new email address, review your DNS records in the Cloudflare dashboard:\n\n1. Log into the [Cloudflare dashboard](#log-in-to-cloudflare).\n2. Go to **DNS**.\n3. Your domain should have records similar to the following:\n\n![Your iCloud custom email domain should have a specific set of records created by default.](https://developers.cloudflare.com/_astro/icloud-custom-domain-dns-example.DXfRAhRV_Zk6ejy.webp)\n\nIf your domain has records similar to those listed above and you are still experiencing problems with your new email address, contact [Apple Support](https://support.apple.com/).\n\nIf you try to visit your new domain, your browser will show an error or empty page.\n\nThat's because there's more to setting up a website than purchasing a domain name (which you just did) and setting up email records (which we just did for you).\n\nIf you want your domain to be a fully functioning website, you will need to:\n\n1. **Build your website**: Either using [Cloudflare Pages](https://developers.cloudflare.com/pages/), a website builder, or files hosted on a server.\n2. **Update your Cloudflare DNS**: To direct visitors looking for your domain name to the actual content on your website ([detailed guide](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-zone-apex/)).\n\nAfter you buy a domain through iCloud, Cloudflare Registrar automatically enables a landing page for it. This temporary page informs your visitors that you still do not have a website. This feature is only available to new domain registrations, when you buy a domain through an Apple device.\n\n### Disable Landing Page\n\nIf you do not want to have Landing Page enabled:\n\n1. In the Cloudflare dashboard, go to the **Manage domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to disable Landing Page for, and select **Manage** > **Configuration**.\n\n3. Scroll to Landing Page and select **Disable**.\n\nYou now have Landing Page disabled. The page can also be re-enabled through the same process.\n\nCustomers must disable the landing page before they can add DNS records to point to a new website.\n\n<page>\n---\ntitle: Move a Cloudflare Registrar domain registration between accounts ·\n  Cloudflare Registrar docs\ndescription: Cloudflare supports the move (transfer) of domain registrations\n  between Cloudflare accounts when the source and target account both confirm\n  the move. The move will result in the loss of all configurations and settings\n  for the domain in the source account.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/inter-account-transfer/\n  md: https://developers.cloudflare.com/registrar/account-options/inter-account-transfer/index.md\n---\n\nCloudflare supports the move (transfer) of domain registrations between Cloudflare accounts when the source and target account both confirm the move. The move will result in the loss of all configurations and settings for the domain in the source account.\n\nThis process only applies to domains which are registered with Cloudflare Registrar. For domains with other registrars, refer to [Move a domain between Cloudflare accounts](https://developers.cloudflare.com/fundamentals/manage-domains/move-domain/).\n\nBefore proceeding, please be aware of the following:\n\n* WHOIS contact information will be moved as is.\n* No other configuration will be moved.\n* After successful move, the registration will be transfer-locked for 30 days.\n* The target account will become responsible for domain renewals going forward.\n\n## 1. Prepare for the move\n\nBefore you request the move, you will need to do the following:\n\n* Obtain the [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the new account.\n* Add the domain as a website to the new account and select a plan.\n* [Disable DNSSEC](https://developers.cloudflare.com/dns/dnssec/#disable-dnssec) for the domain and ensure it is set up and ready in the new dashboard account you intend to move it to.\n\nThe following pre-conditions must be met before the domain can be moved:\n\n* The domain must be added to the new account as a website and a plan must be selected.\n* The domain must not be administratively locked, such as being locked due to a dispute or court order.\n* The domain must not have any of the following registry statuses: `pendingDelete`, `redemptionPeriod`, or `pendingTransfer`.\n* The registrant email address must be verified.\n* A pending Change of Registrant request cannot be present. If there is a pending request, it should be completed before initiating the move request.\n* DNSSEC must be turned off. It can be re-enabled on the new zone once the move completes.\n* If the current zone is locked, the lock must be released.\n\n## 2. Submit the move request\n\nYou can now submit the move request under the **Configuration** tab of the **Manage Domain** page. Begin the submission process by selecting the **Start** button and follow the instructions.\n\n**Important**: Review the pre-conditions described above. If those conditions have not been met, the domain move will not be completed.\n\nOnce the move request has been submitted, the gaining account will receive an email notifying them of the request and will provide instructions for how to approve the request.\n\nThe gaining account must log into their account and go to **Manage Domains** (under Domain Registration). A message will appear at the top of the page stating that there are domains requiring action to be taken.\n\nSelect **View Actions** to display the domains with a pending move along and choose to accept or reject the request. Action must be taken within five days of the request.\n\nIf no action is taken within the five days, the request will be automatically canceled.\n\n<page>\n---\ntitle: Renew domains with Cloudflare Registrar · Cloudflare Registrar docs\ndescription: Cloudflare Registrar enrolls your domain to auto-renew by default.\n  Unlike other registrars, your domain will only renew at the list price set by\n  the registry. When a domain has the auto-renew setting turned on, Cloudflare\n  will attempt to automatically renew the domain prior to expiration.\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/renew-domains/\n  md: https://developers.cloudflare.com/registrar/account-options/renew-domains/index.md\n---\n\n## Automatic renewal of domain\n\nCloudflare Registrar enrolls your domain to auto-renew by default. Unlike other registrars, your domain will only renew at the list price set by the registry. When a domain has the auto-renew setting turned on, Cloudflare will attempt to automatically renew the domain prior to expiration.\n\nThere is no guarantee that the renewal will succeed. Renewals may fail for various reasons, including billing failures and registry downtime. While Cloudflare will make several attempts to renew, it is strongly recommended you frequently review your account to ensure your domains have been renewed.\n\nIf you decide you no longer need the domain, [disable auto-renew for your domain](#set-up-automatic-renewals). Once disabled, your domain will not renew upon expiration.\n\nThe first auto-renew attempt will occur approximately 30 days prior to expiration. If you wish to disable auto-renew, do so at least 30 days prior to the expiration date.\n\nYou can continue to keep your domain registered with Cloudflare for the time remaining until the expiration date. If you decide you want to keep the domain, enable auto-renew at any time prior to expiration.\n\n## Set up automatic renewals\n\nIf you want your domains to renew automatically, keep the default settings for your domain (**Auto Renew** should be set to **On**). To find this setting:\n\n1. In the Cloudflare dashboard, go to the **Manage domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to automatically renew, and make sure the **Auto-renew** toggle is enabled.\n\nCloudflare attempts to renew these domains automatically 30 days before their expiration date. Several more attempts are made if the first attempt fails. The last attempt to renew is made on the day before expiration. You can also [manually renew](#renew-a-domain-manually) a domain at any time.\n\nIf multiple domains are auto-renewed on the same date, only one charge will be made to the primary payment method.\n\nIf the renewal fails, you will receive an email notification and Cloudflare will try to renew the domain three additional times. If these attempts fail, you must manually renew your domain.\n\nIf you want to delete your domain from Cloudflare, **disable** Auto-Renew first.\n\n## Renew a domain manually\n\nYou can renew a domain at any time. To renew a domain registered with Cloudflare:\n\n1. In the Cloudflare dashboard, go to the **Manage domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to renew and select **Manage**.\n\n3. In **Registration** select **Renew/Extend Domain**.\n\n4. In the **Renew for** drop-down menu, choose a number of years to renew your domain (up to 10 years).\n\n5. Select **Renew** and then **Purchase**.\n\nOnce Cloudflare validates your payment, the status of your domain changes to **Renewal Pending**. After the renewal is finished, the status changes back to **Active**.\n\n## Renewal notifications\n\nOnce a domain is registered, Registrar sends the following expiration notices to the Super Admin of the domain:\n\n* A monthly email listing all domains set to renew automatically within the next 45 days.\n* A monthly email listing all domains expiring in the next 60-90 days.\n\nIn addition to the Super Admin, the following expiration notices are sent to the WHOIS Registrant contact associated with the domain:\n\n* A weekly email listing all domains expiring within the next month.\n* A daily email listing all domains expiring in seven days.\n* An email one day after a domain expires.\n* An email 20 days after the expiration date.\n\nIf you do not renew your domain before the expiration date, your domain will enter a Redemption Grace Period (RGP) for 30 days. These domains are not deleted and you can restore them to your account, but restoration may require an additional fee. You cannot transfer domains during the RGP.\n\nAll renewals are final and Cloudflare will not issue refunds.\n\nWhen renewing a domain, additional years are always added to the current expiration date regardless of when the renewal takes place.\n\n<page>\n---\ntitle: Transfer domain from Cloudflare to another registrar · Cloudflare\n  Registrar docs\ndescription: \"Cloudflare Registrar makes it easy to transfer your domain to\n  another registrar. Be aware that ICANN rules prohibit a domain from being\n  transferred if:\"\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/transfer-out-from-cloudflare/\n  md: https://developers.cloudflare.com/registrar/account-options/transfer-out-from-cloudflare/index.md\n---\n\nCloudflare Registrar makes it easy to transfer your domain to another registrar. Be aware that ICANN rules prohibit a domain from being transferred if:\n\n* The domain has been transferred within the last 60 days;\n* The domain was registered within the last 60 days;\n* If the WHOIS registrant information has been modified in the last 60 days (even if redacted).\n\nFollow the instructions below to transfer your domain out from Cloudflare.\n\nAnyone with super-admin and admin permissions for a zone can also manage your domains. This means these users can also unlock domains or obtain authorization codes to transfer domains to other registrars. Be careful who you give these account roles to.\n\n## 1. Unlock your domain at Cloudflare\n\n1. In the Cloudflare dashboard, go to the **Manage Domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain you want to transfer, and select **Manage**.\n\n3. Select **Configuration** > **Unlock**.\n\n4. Select **Confirm and Unlock** to confirm that you want to unlock your domain.\n\n5. Copy the auth code (also referred to as authentication code and authorization code) generated by Cloudflare, and use at your new registrar.\n\nIf you lose your authentication code, you can get a new one by:\n\n* Selecting the **Regenerate** button;\n* Locking the domain and repeating steps 1-6.\n\n## 2. Transfer to a new registrar\n\n1. Go to your new registrar.\n2. You will be asked for the authorization code from Cloudflare (it might be called EPP in some systems). Input the code created for you from the Cloudflare dashboard.\n3. Your new registrar will send the transfer request to the registry for your domain. The registry will then send it to Cloudflare. After Cloudflare receives the message, you can manually approve the transfer to initiate it immediately.\n4. You will need to confirm the approval. You can also reject it at this stage. If you reject it, Cloudflare will reapply the registrar lock.\n5. If you do not manually approve the transfer, the transfer will auto-approve on the fifth day after receiving the request. In either case, when your transfer out completes Cloudflare will remove the domain from your account and you will not be charged for future renewals.\n\n<page>\n---\ntitle: WHOIS redaction · Cloudflare Registrar docs\ndescription: Cloudflare Registrar provides personal data redaction on WHOIS\n  information, if permitted by the registry.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/account-options/whois-redaction/\n  md: https://developers.cloudflare.com/registrar/account-options/whois-redaction/index.md\n---\n\nCloudflare Registrar provides personal data redaction on WHOIS information, if permitted by the registry.\n\nWHOIS is a standard for publishing the contact and nameserver information for all registered domains. Each registrar maintains their own WHOIS service. Anyone can query the registrar’s WHOIS service to reveal the data behind a given domain.\n\nHowever, broadcasting the registrant contact information via the WHOIS service can cause spam mail to be delivered to your personal addresses. Cloudflare Registrar offers personal data redaction on WHOIS for free, that meets current ICANN guidelines.\n\nCloudflare’s WHOIS service can be found at <https://rdap.cloudflare.com/>. Select **WHOIS** as the search type.\n\n## What is WHOIS redaction?\n\nWHOIS redaction removes most contact information categorized as personal data (such as registrant name, email address, postal address) from the published WHOIS record for a domain. These fields will read `Data Redacted`. The nameserver, domain lock information, and date records for a domain are still available publicly. The following fields will continue to show in WHOIS, due to ICANN policy:\n\n* Registrant state/province\n* Registrant country\n\nCloudflare still maintains the authoritative, unredacted, record of your WHOIS data. You can modify this information at any time. Refer to [Registrant contact updates](https://developers.cloudflare.com/registrar/account-options/domain-contact-updates) for more information.\n\nRDAP (Registration Data Access Protocol) is a new standard for querying domain contact and nameserver information for all registered domains. This new protocol offers some advantages over WHOIS, including standardized data access, support for internationalization, and secure access controls. RDAP is intended to eventually replace WHOIS. However, Cloudflare currently provides both WHOIS and RDAP search capability.\n\nCloudflare’s RDAP service can be found at <https://rdap.cloudflare.com/>. Select **RDAP** as the search type.\n\n## How can third parties reach registrants?\n\nAs part of the ICANN guidelines, registrars must have a method for third parties to reach the registrant without revealing their identity. Cloudflare has a form available where third parties can [submit a message for a given domain on Cloudflare Registrar](https://www.cloudflare.com/abuse/form). Cloudflare will forward the message to the registrant email on file for that domain.\n\n<page>\n---\ntitle: Domain Name System Security Extensions (DNSSEC) · Cloudflare Registrar docs\ndescription: The domain name system (DNS) translates domain names into numeric\n  Internet addresses. However, DNS is a fundamentally insecure protocol. It does\n  not guarantee where DNS records come from and accepts any requests given to\n  it.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/get-started/enable-dnssec/\n  md: https://developers.cloudflare.com/registrar/get-started/enable-dnssec/index.md\n---\n\nThe domain name system (DNS) translates domain names into numeric Internet addresses. However, DNS is a fundamentally insecure protocol. It does not guarantee where DNS records come from and accepts any requests given to it.\n\n[DNSSEC](https://developers.cloudflare.com/dns/dnssec/) creates a secure layer to the domain name system by adding cryptographic signatures to DNS records. By doing so, your request can check the signature to verify that the record you need comes from the authoritative nameserver and was not altered along the way.\n\n## Enable or disable DNSSEC\n\nCloudflare Registrar offers one-click DNSSEC activation for free to all customers:\n\n1. In Cloudflare dashboard, go to the **Manage Domains** page.\n\n[Go to **Manage domains**](https://dash.cloudflare.com/?to=/:account/registrar/domains)\n\n2. Find the domain that you want to activate DNSSEC and select **Manage**.\n\n3. Select **Configuration** > **Enable DNSSEC**. If DNSSEC was previously activated, select **Disable DNSSEC** to disable it.\n\nCloudflare publishes delegation signer (DS) records in the form of [CDS and CDNSKEY records](https://www.cloudflare.com/dns/dnssec/how-dnssec-works/) for a domain delegated to Cloudflare. Cloudflare Registrar scans those records at regular intervals, gathers those details and sends them to your domain's registry.\n\nThis process can take one to two days after you first enable DNSSEC.\n\nIf your domain is not on Cloudflare Registrar, you can enable DNSSEC in [**DNS**](https://developers.cloudflare.com/dns/dnssec/) on the Cloudflare dashboard.\n\nWhen DNSSEC has been successfully applied to your domain, Cloudflare shows you a confirmed status. Go to [**DNS** > **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) in the Cloudflare dashboard, and scroll down to **DNSSEC**.\n\nYou can also confirm this by reviewing the [WHOIS information](https://lookup.icann.org/) for your domain. Domains with DNSSEC will read `signedDelegation` in the DNSSEC field.\n\n<page>\n---\ntitle: Register a new domain · Cloudflare Registrar docs\ndescription: The registration process may take up to 30 seconds to complete.\n  Once the registration is complete, the browser will navigate to the domain\n  management page where you may update the contacts, change the auto-renew\n  settings, and add additional years to the term. You will also receive a\n  confirmation email regarding your new domain registration.\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/get-started/register-domain/\n  md: https://developers.cloudflare.com/registrar/get-started/register-domain/index.md\n---\n\n## Prerequisites and restrictions\n\n* Cloudflare Registrar is only available for customers that use Cloudflare as their authoritative DNS provider (also known as a [full setup](https://developers.cloudflare.com/dns/zone-setups/)).\n* Cloudflare Registrar does not currently support internationalized domain names (IDNs), also known as Unicode.\n* You must have a [verified account email address](https://developers.cloudflare.com/fundamentals/user-profiles/verify-email-address/), to transfer or register domains.\n\n## How to register a new domain\n\nIf you are registering a `.us` domain, refer to the [Additional requirements for .US domains](https://developers.cloudflare.com/registrar/top-level-domains/us-domains/) before proceeding.\n\n1. In the Cloudflare dashboard, go to the **Register domains** page.\n\n[Go to **Register domains**](https://dash.cloudflare.com/?to=/:account/registrar/register)\n\n2. In the search box, enter the domain name you wish to register, and select **Search**. You may also enter one or more keywords. The search results will contain a list of suggested domains. If the domain you entered does not appear in the list, this means it is not available for registration.\n\nCloudflare Registrar currently does not support internationalized domain names (IDNs), also known as unicode. For that reason, you cannot search for words with special characters, such as `à`, `ü`, `ç`, among others.\n\n1. Select **Purchase** on the domain you wish to register. In rare instances, a domain that is not available for registration may appear in the search results. After selecting **Purchase**, a definitive availability check will be performed to confirm that the domain is actually available for registration.\n\n2. Select the term (number of years) you wish to register the domain from the **Payment option** drop-down menu. Most top-level domains (TLDs) can be registered for a maximum of ten years. Some TLDs may have different term limits and these will be reflected in the drop-down options.\n\nThe expiration date and price will update automatically based on the term selected. The **Renew On** date is the date that the system will attempt to auto-renew the domain. All registrations have Auto-renew turned on by default. However, you may [disable this option](https://developers.cloudflare.com/registrar/account-options/renew-domains/) at any time.\n\n3. Enter the contact details for the domain. These details will be used to create all of the required contacts (Registrant, Admin, Technical, and Billing), and may be updated after registration is completed. Refer to [Contact requirements](#contact-requirements) to learn the specific requirements for each contact field.\n\nIf you have previously registered or transferred a domain name, the form will be filled in advance with the information from your default contact. If not, you will need to fill out the form.\n\nIt is important that you provide complete and accurate contact information. If you do not follow this recommendation, the domain registration may be suspended and/or canceled.\n\n1. In **Payment**, select which type of payment you want to use. If you already have a billing profile, Cloudflare uses this information to automatically fill the form. If there is no billing profile, you need to enter your payment information.\n\n2. Review the terms and conditions, including the Domain Registration Agreement, Self-serve Subscription Agreement, and the Privacy Policy.\n\n3. Select **Complete purchase** to continue. By selecting **Complete purchase**, you acknowledge that you are accepting the terms of the agreements.\n\nThe registration process may take up to 30 seconds to complete. Once the registration is complete, the browser will navigate to the domain management page where you may update the contacts, change the auto-renew settings, and add additional years to the term. You will also receive a confirmation email regarding your new domain registration.\n\n## Contact requirements\n\nAt this time, you can only use ASCII characters for contact data. If the default contact has non-ASCII characters, you will need to update the domain contact details before proceeding. Cloudflare recommends that you update your default contact information to include ASCII characters only.\n\n| Field | Required? | Restrictions |\n| - | - | - |\n| First Name | Yes | Minimum of two letters. |\n| Last Name | Yes | Minimum of two letters. |\n| Email | Yes | Must be a properly formatted email address. |\n| Organization | No | Optional for most TLDs. In some cases, the Organization field may be populated by default with data from First and Last names. |\n| Phone number | Yes | Must select a valid country code from the drop-down options. Only numbers will be accepted in the phone number field. |\n| Ext | No | Only numbers may be entered. |\n| Address 1 | Yes | May not be all numeric. |\n| Address 2 | No | - |\n| City | Yes | - |\n| State | Yes | - |\n| Country | Yes | You must select one from the drop-down options. |\n| Postal Code | Yes | Must be a properly formatted postal code. |\n\nWhen you register a domain with Cloudflare, your personal information is redacted when permitted by the registry. Refer to [WHOIS redaction](https://developers.cloudflare.com/registrar/account-options/whois-redaction/) for more information.\n\nTo improve the security of your domain, enable [Domain Name System Security Extensions](https://developers.cloudflare.com/registrar/get-started/enable-dnssec/) to create a secure layer with a cryptographic signature.\n\n<page>\n---\ntitle: Transfer your domain to Cloudflare · Cloudflare Registrar docs\ndescription: This page contains generic instructions on how to transfer your\n  domain to Cloudflare.\nlastUpdated: 2025-10-09T15:47:46.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/\n  md: https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/index.md\n---\n\nTransferring your domain to Cloudflare tells your registry that a different registrar can now set those authoritative records for you. The relationship is based on trust. Registries only trust one registrar at any given time to make changes on your behalf.\n\nTransferring a domain to a new registrar informs the registry that they should instead trust that new registrar to modify information. The process requires some action steps at your new and previous registrar. Each registrar handles transfers a bit differently, but in general, they follow a pattern based on rules set by ICANN, the organization responsible for regulating domain registration.\n\nMost domain transfers add one additional year to your current registration term. After the transfer, your domain registration will be set to auto-renew by default.\n\nThis page contains generic instructions on how to transfer your domain to Cloudflare from most registrars.\n\nAll domains using Cloudflare Registrar must use Cloudflare for authoritative DNS on a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/)[1](#user-content-fn-1). This means [onboarding your domain](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/) by [updating your nameservers](https://developers.cloudflare.com/dns/nameservers/update-nameservers/) to your assigned Cloudflare nameservers. You cannot change to another DNS provider's nameservers while using Cloudflare Registrar.\n\n1. Meaning Cloudflare is your primary, authoritative DNS provider. [↩](#user-content-fnref-1)\n\n## Before transferring a domain to Cloudflare\n\n* Create [a Cloudflare account](https://developers.cloudflare.com/fundamentals/account/create-account/).\n* [Add the domain](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/) you are transferring to your Cloudflare account.\n* [Review your DNS records](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#review-dns-records) in the Cloudflare dashboard.\n* If needed, plan for [DNSSEC disablement](#disable-dnssec).\n* [Change your DNS nameservers](https://developers.cloudflare.com/dns/zone-setups/full-setup/) to Cloudflare.\n* If initiating multiple transfers, notify your financial institution to prevent them from flagging these charges as fraudulent.\n* Renew your domain if it is within 15 days of expiration.\n* Do not make any changes to the Registrant contact information. Updating the Registrant contact may result in your current registrar locking the domain for 60 days.\n* Make sure your account has a valid credit card on file.\n* If you are transferring a `.us` domain, refer to the [Additional requirements for .US domains](https://developers.cloudflare.com/registrar/top-level-domains/us-domains/) before proceeding.\n\nIf you are onboarding an existing domain to Cloudflare, make sure DNSSEC **is disabled** at your registrar. Otherwise, your domain will experience connectivity errors when you change your nameservers.\n\n1. Take note of the TTL value for the DS record at your current registrar.\n\n2. Remove DS records at your current registrar.\n\nProvider-specific instructions\n\nThis is not an exhaustive list of how to update DS records in other providers, but the following links may be helpful:\n\n* [DNSimple](https://support.dnsimple.com/articles/cloudflare-ds-record/)\n   * [Domaindiscount24](https://support.domaindiscount24.com/hc/articles/4409759478161)\n   * [DreamHost](https://help.dreamhost.com/hc/en-us/articles/219539467)\n   * [Dynadot](https://www.dynadot.com/help/question/set-DNSSEC)\n   * [Enom](https://support.enom.com/support/solutions/articles/201000065386)\n   * [Gandi](https://docs.gandi.net/en/domain_names/advanced_users/dnssec.html)\n   * [GoDaddy](https://www.godaddy.com/en-ph/help/add-a-ds-record-23865)\n   * [Hostinger](https://www.hostinger.com/support/3667267-how-to-use-dnssec-records-at-hostinger/)\n   * [Hover](https://support.hover.com/support/solutions/articles/201000064716)\n   * [InMotion Hosting](https://www.inmotionhosting.com/support/edu/cpanel/enable-dnssec-cloudflare/)\n   * [INWX](https://kb.inwx.com/en-us/3-nameserver/131)\n   * [Joker.com](https://joker.com/faq/books/jokercom-faq-en/page/dnssec)\n   * [Name.com](https://www.name.com/support/articles/205439058-managing-dnssec)\n   * [Namecheap](https://www.namecheap.com/support/knowledgebase/article.aspx/9722/2232/managing-dnssec-for-domains-pointed-to-custom-dns/)\n   * [NameISP](https://support.nameisp.com/knowledgebase/dns)\n   * [Namesilo](https://www.namesilo.com/support/v2/articles/domain-manager/ds-records)\n   * [OVH](https://help.ovhcloud.com/csm/en-dns-secure-domain-dnssec?id=kb_article_view\\&sysparm_article=KB0051637)\n   * [Squarespace](https://support.squarespace.com/hc/articles/4404183898125-Nameservers-and-DNSSEC-for-Squarespace-managed-domains#toc-dnssec)\n   * [Registro.br](https://registro.br/tecnologia/dnssec/?secao=tutoriais-dns)\n   * [Porkbun](https://kb.porkbun.com/article/93-how-to-install-dnssec) (do not fill out **keyData**)\n   * [TransIP](https://www.transip.eu/knowledgebase/150-secure-domains-custom-nameservers-dnssec/)\n\n3. Wait at least the time corresponding to the DS record TTL. It is usually 24 hours, but refer to the value you got in step 1.\n\n4. Follow the steps to [transfer your domain](https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/#set-up-a-domain-transfer) to Cloudflare Registrar.\n\n5. [Enable DNSSEC](https://developers.cloudflare.com/dns/dnssec/#1-activate-dnssec-in-cloudflare) at Cloudflare. This will automatically add your DS to the zone parent via Cloudflare Registrar.\n\nWhy you have to disable DNSSEC\n\nWhen your domain has [DNSSEC enabled](https://www.cloudflare.com/learning/dns/dns-security/#what-is-dnssec), your DNS provider digitally signs all your DNS records. This action prevents anyone else from issuing false DNS records on your behalf and redirecting traffic intended for your domain.\n\nHowever, having a single set of signed records also prevents Cloudflare from issuing new DNS records on your behalf (which is part of using Cloudflare for your authoritative nameservers). So if you change your nameservers without disabling DNSSEC, DNSSEC will prevent Cloudflare's DNS records from resolving properly.\n\nTo transfer your domain, it must meet the following requirements:\n\n* ICANN rules prohibit a domain from being transferred if it has been registered or previously transferred within the last 60 days or if the WHOIS Registrant contact information was modified in the last 60 days (even if redacted).\n\n* Your account at your current registrar must be active. If your domain has expired, you may be able to transfer the domain. If the domain is in the `RedemptionPeriod` you will likely need to restore the domain first before the transfer can proceed.\n\nThe transfer of an expired domain may result in an additional year NOT being added during the transfer.\n\n* Your domain cannot be an internationalized domain name (IDNs) as Cloudflare does not currently support them. These domains are also known as unicode.\n\n* Domains that have a status of `serverHold`, `serverTransferProhibited`, `pendingDelete`, `pendingTransfer`, or `RedemptionPeriod` may not be transferred.\n\n* Domains that have a status of `clientTransferProhibited` (Transfer Lock) will not show as available for transfer. You will have to unlock the domain at your current registrar before being able to proceed.\n\nIf your domain is listed as available for transfer in the Cloudflare dashboard, these restrictions have already been checked.\n\n## Set up a domain transfer\n\nTo begin, complete the following steps in your current registrar to transfer your domain to Cloudflare. Below, you will find links for detailed transfer instructions from some of the most popular registrars:\n\n* [Enom](https://support.enom.com/support/solutions/articles/201000065324-preparing-your-domain-for-transfer)\n* [GoDaddy](https://www.godaddy.com/help/transfer-my-domain-away-from-godaddy-3560)\n* [Ionos by 1&1](https://www.ionos.com/help/domains/domain-transfers/#acc4514)\n* [Namecheap](https://www.namecheap.com/support/knowledgebase/article.aspx/258/84/what-should-i-do-to-transfer-a-domain-from-namecheap/)\n* [Network Solutions](https://www.networksolutions.com/help/article/transfer-out-of-network-solutions)\n* [Squarespace](https://support.squarespace.com/hc/articles/205812338-Transferring-a-domain-away-from-Squarespace)\n\n### 1. Log in to your registrar account\n\nLog in to the registrar account where the domain is currently registered.\n\n### 2. Unlock the domain\n\nRegistrars include a lightweight safeguard to prevent unauthorized users from starting domain transfers. This is known as registrar lock, but you might also see it referred to as domain lock. In WHOIS, it may appear as `clientTransferProhibited`. When enabled, the lock prevents any other registrar from attempting to initiate a transfer.\n\nOnly the registrant can enable or disable this lock, typically through the administration interface of the registrar. To proceed with a transfer, remove this lock if it is enabled.\n\n### 3. Remove WHOIS privacy\n\nIn most cases, domains may be transferred even if WHOIS privacy services have been enabled. However, some registrars may prohibit the transfer if the WHOIS privacy service has been enabled.\n\n### 4. Request an authorization code\n\nYour new registrar needs to confirm with your old registrar that the transfer flow is authorized. To do that, your old registrar will provide an authorization code to you.\n\nThis code is often referred to as an authorization code, auth code, authinfo code, or transfer code. You will need to input that code to complete your transfer to Cloudflare. Cloudflare will use it to confirm the transfer is authentic.\n\n### 5. Initiate your transfer to Cloudflare\n\nFrom your Cloudflare Account Home, go to the **Transfer Domains** page.\n\n[Go to **Transfer domains**](https://dash.cloudflare.com/?to=/:account/registrar/transfer)\n\nCloudflare Registrar will display the zones available for transfer.\n\nYou will be presented with the price for each transfer. When you transfer a domain, you are required by ICANN to pay to extend its registration by one year from the expiration date. You can remove domains from your transfer by selecting **x**.\n\nIf you do not have a payment method on file, add one at this step before proceeding.\n\nYou will not be billed at this step. Cloudflare will only bill your card when you input the auth code and confirm the contact information at the conclusion of your transfer request.\n\nIn some cases, premium (non-standard priced) domains may not be detected immediately. Pricing will be confirmed with the registry before submission, and you will have the opportunity to review and approve any price adjustments.\n\nIn most cases, transferring a domain adds one additional year to its registration term. However, the following exceptions apply:\n\n* Transferring a `.uk` domain does not extend its registration by an additional year.\n* If the transfer is completed within 45 days of the domain's expiration, the extra year may not be added. This is determined by the domain's Registry.\n* If the domain already has more than nine years remaining, a full year may not be added. This is also subject to Registry policy.\n\nSites can be unavailable to transfer for a few reasons, including:\n\n* You did not [add your domain](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/) to your Cloudflare.\n* The site was registered in the last 60 days.\n* Cloudflare does not yet support the TLD.\n* The domain has a status that does not allow for a transfer.\n* You failed to follow the steps highlighted above in [creating an account with your domain](https://developers.cloudflare.com/fundamentals/account/create-account/) and [changing your DNS nameservers to Cloudflare](https://developers.cloudflare.com/dns/zone-setups/full-setup/).\n\nIf you have an [unverified account email address](https://developers.cloudflare.com/fundamentals/user-profiles/verify-email-address/), you will not be able to transfer or register domains. Verify your account email address before proceeding.\n\n### 6. Input your authorization code\n\nIn the next page, input the authorization code for each domain you are transferring. You also need to unlock each domain so that Cloudflare can process your request. For more information, refer to the instructions provided by your [current registrar on how to transfer your domain](https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/#set-up-a-domain-transfer).\n\n### 7. Confirm or input your contact information\n\nIn the final stage of the transfer process, input the contact information for your registration. Cloudflare Registrar redacts this information by default but is required to collect the authentic contact information for this registration. It is important that you provide accurate WHOIS contact information. You may be required to verify the contact information. Failure to provide accurate information and/or failure to verify the information may result in suspension or deletion of your domain.\n\nYou can always [modify the contact information](https://developers.cloudflare.com/registrar/account-options/domain-contact-updates/) later, if needed.\n\nAfter entering the contact information, agree to the domain registration terms of service by selecting **Confirm transfer**.\n\n### 8. Approve the transfer\n\nOnce you have requested your transfer, Cloudflare will begin processing it, and send a Form of Authorization (FOA) email to the registrant, if the information is available in the public WHOIS database. The FOA is what authorizes the domain transfer.\n\nAfter this step, your previous registrar will also email you to confirm your request to transfer. Most registrars will include a link to confirm the transfer request. If you select that link, you can accelerate the transfer operation. If you do not act on the email, the registrar can wait up to five days to process the transfer to Cloudflare. You may also be able to approve the transfer from within your current registrar dashboard.\n\nRegistrants transferring a `.us` domain will always receive a FOA email.\n\n## Bulk domain transfers\n\nThe process for transferring domains in bulk to Cloudflare is the same process as transferring a single domain. Even if you transfer multiple domains in bulk, you will be charged for each domain as bulk billing is not yet available.\n\nYou can check the status of your transfer in **Account Home** > **Overview** > **Domain Registration** for your domain. Below, you can find a list of the possible transfer statuses.\n\n* **Transfer in progress**: Your request has been submitted by Cloudflare to your previous registrar. Cloudflare is now waiting on them to confirm they have received the request. If this status persists for more than a day (24 hours), ensure that the domain has been unlocked at your current registrar and any WHOIS privacy services have been removed.\n\n* **Pending approval**: Your current registrar has received the transfer request. They can now wait up to five days to release the domain. If you want to move faster, you can manually approve the transfer for immediate release in the dashboard of most registrars.\n\n* **Transfer rejected**: your transfer has been rejected. This can occur if you canceled the request at your current registrar instead of approving it. If you still wish to transfer, you can select **Retry** and initiate a new transfer request.\n\nAs mentioned in [Review DNS records in Cloudflare](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#review-dns-records), when moving your domain to Cloudflare Registrar, you might need to configure your DNS records to correctly point traffic to your web host. Cloudflare automatically scans for common records and adds them to your account's DNS page, but the scan is not guaranteed to find all existing DNS records.\n\nRefer to your web host's documentation to learn what type of records you need to configure and where they should point, to avoid downtime.\n\nFor example, Netlify asks customers that host websites with them to add a `CNAME` record pointing `<YOUR-DOMAIN>` to `apex-loadbalancer.netlify.com`, and another `CNAME` record pointing `www` to `<YOUR-DOMAIN>.netlify.app`, depending on which one is the primary domain.\n\n![An example of DNS management in Cloudflare's DNS dashboard](https://developers.cloudflare.com/_astro/dns-management.0LI9Ggoq_2X8BL.webp)\n\nYou may also want to [enable DNSSEC](https://developers.cloudflare.com/dns/dnssec/#1-activate-dnssec-in-cloudflare).\n\n<page>\n---\ntitle: Learn how to manage a .UK domain with Cloudflare. · Cloudflare Registrar docs\ndescription: \"Cloudflare currently supports the transfer of .uk, co.uk, org.uk,\n  and me.uk domains. To transfer a .uk domain to Cloudflare from another\n  registrar follow these steps:\"\nlastUpdated: 2025-09-15T15:28:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/top-level-domains/uk-domains/\n  md: https://developers.cloudflare.com/registrar/top-level-domains/uk-domains/index.md\n---\n\n## How to transfer a .UK domain to Cloudflare\n\nCloudflare currently supports the transfer of `.uk`, `co.uk`, `org.uk`, and `me.uk` domains. To transfer a `.uk` domain to Cloudflare from another registrar follow these steps:\n\n1. In the Cloudflare dashboard, go to the **Transfer domains** page.\n\n[Go to **Transfer domains**](https://dash.cloudflare.com/?to=/:account/registrar/transfer)\n\nCloudflare will show you a list of domains that are eligible for transfer (see below for restrictions). If you do not see your domain, [add the domain you want to transfer](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/) to your Cloudflare account before you try to transfer your `.uk` domain. 2. Select the domains you wish to transfer. 3. Proceed to checkout. Note that there is no fee to transfer a `.uk` domain and an additional year is NOT added during the transfer process. 4. After checkout, request your current registrar to update the [IPS tag](https://en.wikipedia.org/wiki/Internet_Provider_Security) to `CLOUDFLARE`. If the transfer is not completed within 24 hours, ask your registrar again to update the IPS tag. The transfer will be automatically canceled if not completed within 30 days. 5. Cloudflare will receive a notice once your registrar updates the IPS tag. After that, we will finish transferring your domain.\n\nIf you request your current registrar to update the IPS tag before completing the checkout process, the transfer request will be automatically rejected. You must complete the checkout process before requesting the IPS tag update.\n\nFor security reasons, domains transferred to Cloudflare Registrar are locked for 60 days before they can be transferred out to another Registrar.\n\n## Transfer a .UK domain to another registrar\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login) and select your account.\n2. Go to **Domain Registration** > **Manage Domains**.\n3. Find the domain you want to transfer, and select **Manage**.\n4. Select **Configuration** > **Unlock**.\n5. Enter the IPS tag of the registrar you wish to transfer to.\n\nYour new registrar is responsible for accepting the transfer. Cloudflare has no visibility into why a transfer might not be accepted by the new registrar.\n\nIf you do not know the IPS tag, contact your new registrar for instructions. Your new registrar may require you to follow some additional steps before starting the transfer process.\n\n<page>\n---\ntitle: Learn how to manage a .US domain with Cloudflare. · Cloudflare Registrar docs\ndescription: \"If you want to register a .us domain, you must have a genuine\n  connection to the United States as described in the usTLD Nexus Policy. When\n  registering a domain name, registrants must identify the category under which\n  they qualify for the usTLD Nexus Requirement:\"\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/registrar/top-level-domains/us-domains/\n  md: https://developers.cloudflare.com/registrar/top-level-domains/us-domains/index.md\n---\n\n## Registration requirements for .US domains\n\nIf you want to register a `.us` domain, you must have a genuine connection to the United States as described in the [usTLD Nexus Policy](https://www.about.us/policies). When registering a domain name, registrants must identify the category under which they qualify for the usTLD Nexus Requirement:\n\n**C11**: A natural person who is a United States Citizen; or\n\n**C12**: A natural person who is a permanent resident of the United States of America, or any of its possessions or territories.\n\n**C21**: A U.S.-based organization or company formed within one of the fifty (50) U.S. states, the District of Columbia, or any of the United States possessions or territories, or organized or otherwise constituted under the laws of a state of the United States of America, the District of Columbia or any of its possessions or territories or a U.S. federal, state, or local government entity or a political subdivision thereof.\n\n**C31**: A foreign entity or organization that has a bona fide presence in the United States of America or any of its possessions or territories who regularly engages in lawful activities, sales of goods or services or other business, commercial or non-commercial, including not-for-profit relations in the United States; or\n\n**C32**: A foreign entity that has an office or other facility in the United States.\n\nThe nexus category information will be supplied to the .US registry. Failure to provide accurate information and/or to respond to requests for information may result in the suspension or cancellation of the domain registration.\n\n### Application purpose\n\nIn addition to nexus information, registrants must also identify their intended use of the domain name. The possible options are:\n\n* Personal use\n* For-profit business\n* Non-profit business or organization\n* Government\n* Education\n\n### .US WHOIS requirements\n\nThe .US registry requires that domain contact data is displayed in the public WHOIS database. Redaction and/or use of WHOIS privacy services is prohibited. This is a registry policy that all registrars must comply with.\n\n### .US domain transfers\n\nTransferring a `.us` domain works in a similar way to other domains, but always requires approval via the Form of Authorization (FOA) email. You must select the approve link within five days for the transfer to proceed. If you do not respond, the transfer request will be cancelled.\n\nRefer to [Transfer your domain to Cloudflare](https://developers.cloudflare.com/registrar/get-started/transfer-domain-to-cloudflare/) for more information.\n\n<page>\n---\ntitle: Configure a Cloud Connector rule via API · Cloudflare Rules docs\ndescription: You can configure Cloud Connector rules using the Cloudflare API.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/cloud-connector/create-api/\n  md: https://developers.cloudflare.com/rules/cloud-connector/create-api/index.md\n---\n\nYou can configure Cloud Connector rules using the [Cloudflare API](https://developers.cloudflare.com/fundamentals/api/).\n\n## Required permissions\n\nThe [API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) used in API requests to manage Cloud Connector rules must have at least the following permission:\n\n* *Zone* > *Cloud Connector* > *Write*\n\nA token with this permission is only valid for the Cloud Connector endpoints described in this page. You cannot use it to interact with the `http_cloud_connector` phase via [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\nTo obtain the complete endpoint, append the Cloud Connector endpoints listed below to the Cloudflare API base URL:\n\nThe `{zone_id}` argument is the [zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) (a hexadecimal string). You can find this value in the Cloudflare dashboard.\n\nThe following table summarizes the available operations.\n\n| Operation | Verb + Endpoint |\n| - | - |\n| List Cloud Connector rules | `GET /zones/{zone_id}/cloud_connector/rules` |\n| Create/update/delete Cloud Connector rules | `PUT /zones/{zone_id}/cloud_connector/rules` |\n\n### List of Cloud Connector rules\n\nThe following example returns a list of existing Cloud Connector rules:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Cloud Connector Read`\n* `Cloud Connector Write`\n\n### Create/update/delete Cloud Connector rules\n\nTo create a new rule and keep all existing rules, you must include them all in your request body. Omitting an existing rule in the request body will delete the corresponding Cloud Connector rule.\n\nThe following example request will replace all existing Cloud Connector rules with a single rule:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Cloud Connector Write`\n\nThe required body parameters for each rule are: `expression`, `provider`, and `parameters.host`.\n\nThe `provider` value must be one of the following: `cloudflare_r2`, `aws_s3`, `azure_storage`, and `gcp_storage`.\n\n<page>\n---\ntitle: Configure a Cloud Connector rule in the dashboard · Cloudflare Rules docs\ndescription: \"To configure a Cloud Connector rule in the dashboard:\"\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/cloud-connector/create-dashboard/\n  md: https://developers.cloudflare.com/rules/cloud-connector/create-dashboard/index.md\n---\n\nTo configure a Cloud Connector rule in the dashboard:\n\n1. In the Cloudflare dashboard, go to the **Cloud Connector** page.\n\n[Go to **Cloud Connector**](https://dash.cloudflare.com/?to=/:account/:zone/rules/cloud-connector)\n\n2. Select your [cloud provider](https://developers.cloudflare.com/rules/cloud-connector/providers/) (Cloudflare R2 or an external provider).\n\n3. If you selected Cloudflare R2 in the previous step, select your bucket and your custom domain, and select **Next**.\\\n   If you selected a different storage provider, enter the bucket URL and select **Next**.\n\nThe bucket URL must follow a [specific format](https://developers.cloudflare.com/rules/cloud-connector/providers/) according to your provider.\n\n4. Enter a descriptive name for the rule in **Cloud Connector name**.\n\n5. Under **If**, select **Custom filter expression** and [enter an expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/) to define the traffic that will be redirected to the bucket. For example:\n\n* To route all requests matching `http*://example.com/images/*` (HTTPS and HTTP requests) you could enter the following expression:\\\n     `http.request.full_uri wildcard \"http*://example.com/images/*\"`\n   * To route all requests matching `http*://images.example.com/*` (HTTPS and HTTP requests) you could enter the following expression:\\\n     `http.request.full_uri wildcard \"http*://images.example.com/*\"`\n\nAlternatively, select **All incoming requests** to redirect all incoming traffic for your zone to the storage bucket you selected.\n\n6. To save and deploy your rule, select **Deploy**. If you are not ready to deploy the rule, select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\n<page>\n---\ntitle: Configure Cloud Connector rules using Terraform · Cloudflare Rules docs\ndescription: You can create Cloud Connector rules using the Terraform Cloudflare provider.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/cloud-connector/create-terraform/\n  md: https://developers.cloudflare.com/rules/cloud-connector/create-terraform/index.md\n---\n\nYou can create Cloud Connector rules using the [Terraform Cloudflare provider](https://registry.terraform.io/providers/cloudflare/cloudflare/latest).\n\nTo get started with Terraform for Cloudflare configuration, refer to [Terraform: Get started](https://developers.cloudflare.com/terraform/installing/).\n\n## Required permissions\n\nThe [API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) used by Terraform must have at least the following permission:\n\n* *Zone* > *Cloud Connector* > *Write*\n\n## Example configuration\n\nTerraform code snippets below refer to the v4 SDK only.\n\nThe following example Terraform configuration creates Cloud Connector rules for various [supported providers](https://developers.cloudflare.com/rules/cloud-connector/providers/) to route traffic between them based on URI paths:\n\nRefer to the [Terraform Cloudflare provider documentation](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) for more information on the `cloudflare_cloud_connector_rules` resource.\n\n<page>\n---\ntitle: Cloud Connector examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/cloud-connector/examples/\n  md: https://developers.cloudflare.com/rules/cloud-connector/examples/index.md\n---\n\n[Route /images to an S3 Bucket using Terraform](https://developers.cloudflare.com/rules/cloud-connector/examples/route-images-to-aws-s3-using-terraform/)\n\n[Route requests with a URI path starting with `/images` to a specific AWS S3 bucket with Cloud Connector using Terraform.](https://developers.cloudflare.com/rules/cloud-connector/examples/route-images-to-aws-s3-using-terraform/)\n\n[Route /images to an S3 Bucket](https://developers.cloudflare.com/rules/cloud-connector/examples/route-images-to-s3/)\n\n[Route requests with a URI path starting with `/images` to a specific AWS S3 bucket using Cloud Connector.](https://developers.cloudflare.com/rules/cloud-connector/examples/route-images-to-s3/)\n\n[Send EU visitors to a Google Cloud Storage bucket](https://developers.cloudflare.com/rules/cloud-connector/examples/send-eu-visitors-to-gcs/)\n\n[Route all traffic from EU visitors to a Google Cloud Storage bucket using Cloud Connector.](https://developers.cloudflare.com/rules/cloud-connector/examples/send-eu-visitors-to-gcs/)\n\n[Serve /static-assets from Azure Blob Storage](https://developers.cloudflare.com/rules/cloud-connector/examples/serve-static-assets-from-azure/)\n\n[Route requests with a URI path starting with `/static-assets` to an Azure Blob Storage container using Cloud Connector.](https://developers.cloudflare.com/rules/cloud-connector/examples/serve-static-assets-from-azure/)\n\n<page>\n---\ntitle: Supported cloud providers in Cloud Connector · Cloudflare Rules docs\ndescription: \"Cloud Connector currently supports the following cloud providers\n  and services:\"\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/cloud-connector/providers/\n  md: https://developers.cloudflare.com/rules/cloud-connector/providers/index.md\n---\n\nCloud Connector currently supports the following cloud providers and services:\n\n* Cloudflare R2\n* Amazon Web Services - S3\n* Google Cloud Platform - Cloud Storage\n* Microsoft Azure - Blob Storage\n\nThe Cloudflare R2 bucket must be public and [exposed using a custom domain](https://developers.cloudflare.com/r2/buckets/public-buckets/). Buckets exposed using an `r2.dev` subdomain are not supported.\n\nAdditionally, the custom domain must be defined in the same zone where you are configuring the Cloud Connector rule.\n\n## Amazon Web Services - S3\n\nThe hostname of your S3 bucket URL must have one of the following formats (where `*` is a wildcard character):\n\n* `*s3.amazonaws.com`\n* `*s3.<REGION>.amazonaws.com`\n* `*s3-website.<REGION>.amazonaws.com`\n* `*s3-website-<REGION>.amazonaws.com`\n\nCloud Connector supports both subdomain and URI path-style URLs:\n\n* **Subdomain-style URLs**: Set the hostname to `<BUCKET_NAME>.s3.amazonaws.com`. In this case, your files are accessible directly under the root of the bucket. For example, `https://example.com/index.html` will map to `https://<BUCKET_NAME>.s3.amazonaws.com/index.html`. When using **Full (Strict)** SSL/TLS mode, the `<BUCKET_NAME>` cannot include dots (use dashes instead). Refer to [SSL connections to AWS S3 endpoints](#ssl-connections-to-aws-s3-endpoints) for details.\n* **URI path-style URLs**: Set the hostname to `s3.amazonaws.com`. Here, your bucket name must be part of the URI path in your requests. For example, if your bucket name is `<BUCKET_NAME>`, files will be available on paths like `https://example.com/<BUCKET_NAME>/index.html`, and your Cloud Connector rule should filter traffic based on the URI path starting with `/<BUCKET_NAME>`.\n\n### SSL connections to AWS S3 endpoints\n\nThe SSL setting applied to requests between Cloud Connector and AWS S3 depends on the type of S3 endpoint you use:\n\n* **HTTPS-supported endpoints**: For hostnames like `*s3.<REGION>.amazonaws.com` and `*s3.amazonaws.com`, Cloudflare will connect to AWS S3 over HTTPS if you set your zone's SSL/TLS mode to **Full** or **Full (Strict)**. When using **Full (Strict)**, the bucket name cannot include dots (use dashes instead).\n* **Non-HTTPS endpoints**: For website-style hostnames such as `*s3-website.<REGION>.amazonaws.com` or `*s3-website-<REGION>.amazonaws.com`, which do not support HTTPS, Cloudflare will default to **Flexible SSL**.\n\n### Get the bucket URL\n\n1. Go to the [Amazon S3 console](https://console.aws.amazon.com/s3/) and select **Buckets** in the navigation pane.\n2. Select the bucket name.\n3. Go to the **Properties** tab.\n4. Select the **Static Website Hosting** card. The **Endpoint** field shows your bucket URL.\n\nFor more information, refer to the [Amazon S3 documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/EnableWebsiteHosting.html).\n\nOnce you configure Cloud Connector with your storage provider's public bucket, you may wish that only Cloudflare can access the objects in that bucket. To achieve this, check your provider's documentation on how to create a policy that only allows incoming requests from [Cloudflare IP addresses](https://www.cloudflare.com/ips/).\n\n## Google Cloud Platform - Cloud Storage\n\nThe hostname of your Cloud Storage bucket URL must be the following (where `*` is a wildcard character):\n\n* `*storage.googleapis.com`\n* `*storage.cloud.google.com`\n\nCloud Connector supports both subdomain and URI path-style URLs:\n\n* **Subdomain-style URLs**: Set the hostname to `<BUCKET_NAME>.storage.googleapis.com`. In this case, your files are accessible directly under the root of the bucket. For example, `https://example.com/index.html` will map to `https://<BUCKET_NAME>.storage.googleapis.com/index.html`.\n* **URI path-style URLs**: Set the hostname to `storage.googleapis.com`. Here, your bucket name must be part of the URI path in your requests. For example, if your bucket name is `<BUCKET_NAME>`, files will be available on paths like `https://example.com/<BUCKET_NAME>/index.html`, and your Cloud Connector rule should filter traffic based on the URI path starting with `/<BUCKET_NAME>`.\n\n### Get the bucket URL\n\n1. Go to the [Google Cloud console](https://console.cloud.google.com/storage/browser) and select **Buckets**.\n\n2. Select the bucket name.\n\n3. For one of the files already in the bucket, select the link icon in the **Public** column to copy the file's public URL to the clipboard. The file URL will have the following format:\n\n`https://storage.googleapis.com/<BUCKET_NAME>/<OBJECT_NAME>`\n\nTo obtain the subdomain bucket URL, refactor the file URL to `<BUCKET_NAME>.storage.googleapis.com` format.\\\n   To obtain the URI path bucket URL, remove `https://` and `/<BUCKET_NAME>/<OBJECT_NAME>` from the file URL.\n\nIf the files in your bucket are not publicly accessible, you must change the bucket permissions. For details, refer to the [Google Cloud Storage documentation](https://cloud.google.com/storage/docs/access-control/making-data-public#buckets).\n\nOnce you configure Cloud Connector with your storage provider's public bucket, you may wish that only Cloudflare can access the objects in that bucket. To achieve this, check your provider's documentation on how to create a policy that only allows incoming requests from [Cloudflare IP addresses](https://www.cloudflare.com/ips/).\n\n## Microsoft Azure - Blob Storage\n\nThe hostname of your Blob Storage bucket URL must have one of the following formats:\n\n* `<BUCKET_NAME>.blob.core.windows.net`\n* `<BUCKET_NAME>.web.core.windows.net`\n\nFor Azure Blog Storage, Cloud Connector supports only subdomain URLs like `<BUCKET_NAME>.blob.core.windows.net`. This means that your files will be accessible directly under the root of the bucket. For example, `https://example.com/index.html` will map to `https://<BUCKET_NAME>.blob.core.windows.net/index.html`.\n\n### Get the bucket URL\n\n1. Go to the [Azure portal](https://portal.azure.com/) and select your storage account.\n2. In the menu pane, under **Settings**, select **Endpoints**.\n3. Get your bucket URL from the **Blob service** endpoint or the **Static website** endpoint.\n\nIf the blob container is not configured for public access, you must change the container settings. For details, refer to the [Azure Storage documentation](https://learn.microsoft.com/en-us/azure/storage/blobs/anonymous-read-access-configure?tabs=portal).\n\nOnce you configure Cloud Connector with your storage provider's public bucket, you may wish that only Cloudflare can access the objects in that bucket. To achieve this, check your provider's documentation on how to create a policy that only allows incoming requests from [Cloudflare IP addresses](https://www.cloudflare.com/ips/).\n\n<page>\n---\ntitle: Create a configuration rule via API · Cloudflare Rules docs\ndescription: Use the Rulesets API to create configuration rules via API.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/configuration-rules/create-api/\n  md: https://developers.cloudflare.com/rules/configuration-rules/create-api/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to create configuration rules via API.\n\n## Basic rule settings\n\nWhen creating a configuration rule via API, make sure you:\n\n* Set the rule action to `set_config`.\n* Define the parameters in the `action_parameters` field according to the [settings](https://developers.cloudflare.com/rules/configuration-rules/settings/) you wish to override for matching requests.\n* Deploy the rule to the `http_config_settings` phase at the zone level.\n\nFollow this workflow to create a configuration rule for a given zone via API:\n\n1. Use the [List zone rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to check if there is already a ruleset for the `http_config_settings` phase at the zone level.\n\n2. If the phase ruleset does not exist, create it using the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation. In the new ruleset properties, set the following values:\n\n* **kind**: `zone`\n   * **phase**: `http_config_settings`\n\n3. Use the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation to add a configuration rule to the list of ruleset rules. Alternatively, include the rule in the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) request mentioned in the previous step.\n\nMake sure your API token has the [required permissions](#required-api-token-permissions) to perform the API operations.\n\nExample: Add a rule that enables Email Obfuscation and Browser Integrity Check\n\nThe following example sets the rules of an existing phase ruleset (`{ruleset_id}`) to a single configuration rule — enabling Email Obfuscation and Browser Integrity Check for the contacts page — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nExample: Add a rule that turns on Under Attack mode for the admin area\n\nThe following example sets the rules of an existing phase ruleset (`{ruleset_id}`) to a single configuration rule — turning on Under Attack mode for the administration area — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n## Required API token permissions\n\nThe API token used in API requests to manage configuration rules must have at least the following permission:\n\n* *Zone* > *Config Rules* > *Edit*\n\n<page>\n---\ntitle: Create a configuration rule in the dashboard · Cloudflare Rules docs\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/\n  md: https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/index.md\n---\n\n1. In the Cloudflare dashboard, go to the Rules **Overview** page.\n\n[Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/rules/overview)\n\n2. Select **Create rule** > **Configuration Rule**.\n\n3. (Optional) Select one of the rule templates that address common use cases. Then, review and adjust the proposed rule configuration.\n\n4. Enter a descriptive name for the rule in **Rule name**.\n\n5. Under **When incoming requests match**, select if you wish to apply the rule to all incoming requests or only to requests that match a custom filter expression.\n\n6. (Optional) To define a custom expression, use the Expression Builder (specifying one or more values for **Field**, **Operator**, and **Value**) or manually enter an expression using the Expression Editor. For more information, refer to [Edit expressions in the dashboard](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n7. Under **Then the settings are**, add the [configuration settings](https://developers.cloudflare.com/rules/configuration-rules/settings/) you wish to change for requests matching the rule expression.\n\n8. To save and deploy your rule, select **Deploy**. If you are not ready to deploy your rule, select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\n<page>\n---\ntitle: Configuration Rules examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/configuration-rules/examples/\n  md: https://developers.cloudflare.com/rules/configuration-rules/examples/index.md\n---\n\n[Define a single configuration rule using Terraform](https://developers.cloudflare.com/rules/configuration-rules/examples/define-single-configuration-terraform/)\n\n[Create a configuration rule using Terraform to turn off Email Obfuscation and Browser Integrity Check for API requests in a given zone.](https://developers.cloudflare.com/rules/configuration-rules/examples/define-single-configuration-terraform/)\n\n<page>\n---\ntitle: Configuration Rules settings · Cloudflare Rules docs\ndescription: You can change the configuration settings described below in a\n  configuration rule.\nlastUpdated: 2025-10-20T10:08:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/configuration-rules/settings/\n  md: https://developers.cloudflare.com/rules/configuration-rules/settings/index.md\n---\n\nYou can change the configuration settings described below in a configuration rule.\n\n## Automatic HTTPS Rewrites\n\n[Automatic HTTPS Rewrites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/automatic-https-rewrites/) prevents end users from seeing `Mixed content` errors by rewriting URLs from `http` to `https` for resources or links on your website that can be served with HTTPS.\n\nUse this setting to turn on or off Automatic HTTPS Rewrites for matching requests.\n\nAPI configuration property name: `\"automatic_https_rewrites\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n## Browser Integrity Check\n\n[Browser Integrity Check](https://developers.cloudflare.com/waf/tools/browser-integrity-check/) blocks access to pages based on specific HTTP headers commonly abused by spammers.\n\nUse this setting to turn on or off Browser Integrity Check for matching requests.\n\nAPI configuration property name: `\"bic\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n## Disable Real User Monitoring (RUM)\n\n[Cloudflare Web Analytics](https://developers.cloudflare.com/web-analytics/), also known as Real User Monitoring (RUM), is Cloudflare's free, privacy-first analytics for your website.\n\nUse this setting to turn off Web Analytics for matching requests.\n\nConfiguration rules have precedence over any Web Analytics rules. If a Web Analytics rule turns on analytics measurements for an incoming request and the same request matches a configuration rule turning off Web Analytics, the configuration rule will win.\n\nAPI configuration property name: `\"disable_rum\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[Cloudflare Zaraz](https://developers.cloudflare.com/zaraz/) gives you complete control over third-party tools and services for your website, and allows you to offload them to the Cloudflare global network.\n\nUse this setting to turn off Zaraz for matching requests.\n\nAPI configuration property name: `\"disable_zaraz\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n## Hotlink Protection\n\n[Hotlink Protection](https://developers.cloudflare.com/waf/tools/scrape-shield/hotlink-protection/) prevents your images from being used by other sites, potentially reducing the bandwidth consumed by your origin server.\n\nUse this setting to turn on or off Hotlink Protection for matching requests.\n\nAPI configuration property name: `\"hotlink_protection\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[Email Obfuscation](https://developers.cloudflare.com/waf/tools/scrape-shield/email-address-obfuscation/) helps in spam prevention by hiding email addresses appearing in your pages from email harvesters and other bots, while remaining visible to your site visitors.\n\nUse this setting to turn on or off Email Obfuscation for matching requests.\n\nAPI configuration property name: `\"email_obfuscation\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[Cloudflare Fonts](https://developers.cloudflare.com/speed/optimization/content/fonts/) rewrites Google Fonts to be delivered from a website's own origin, eliminating the need to rely on third-party font providers.\n\nUse this setting to turn on or off Cloudflare Fonts for matching requests.\n\nAPI configuration property name: `\"fonts\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\nMirage was deprecated on September 15, 2025.\n\n[Mirage](https://developers.cloudflare.com/speed/optimization/images/mirage/) accelerates image delivery for your visitors based on their device.\n\nUse this setting to turn on or off Mirage for matching requests.\n\nAPI configuration property name: `\"mirage\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n## Opportunistic Encryption\n\n[Opportunistic Encryption](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/opportunistic-encryption/) allows browsers to access HTTP URIs over an encrypted TLS channel.\n\nUse this setting to turn on or off Opportunistic Encryption for matching requests.\n\nAPI configuration property name: `\"opportunistic_encryption\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[Cloudflare Polish](https://developers.cloudflare.com/images/polish/) is a one-click image optimization product that automatically optimizes images in your site.\n\nUse this setting to configure Polish for matching requests:\n\n* Off\n* Lossless\n* Lossy\n* WebP\n\nRefer to [Compression options](https://developers.cloudflare.com/images/polish/compression/#compression-options) for more information on these values.\n\nAPI configuration property name: `\"polish\"` (string).\n\nAPI values: `\"off\"`, `\"lossless\"`, `\"lossy\"`, `\"webp\"`.\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[Rocket Loader](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/) prioritizes your website's content (such as text, images, and fonts) by deferring the loading of all your JavaScript code until after rendering.\n\nUse this setting to turn on or off Rocket Loader for matching requests.\n\nAPI configuration property name: `\"rocket_loader\"` (boolean).\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\nWhen enabled, [Under Attack mode](https://developers.cloudflare.com/fundamentals/reference/under-attack-mode/) performs additional security checks to help mitigate layer 7 DDoS attacks. Validated users access your website and suspicious traffic is blocked.\n\nUse this setting to turn on or off Under Attack mode for matching requests.\n\nAPI configuration property name: `\"security_level\"` (string).\n\nAPI values: `\"off\"`, `\"essentially_off\"`, `\"under_attack\"`.\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n[SSL/TLS encryption modes](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/) control the scheme (`http://` or `https://`) that Cloudflare uses to connect to your origin web server and how SSL certificates presented by your origin will be validated.\n\nUse this setting to configure the SSL/TLS encryption mode for matching requests:\n\n* Off\n* Flexible\n* Full\n* Strict\n* Origin Pull\n\nRefer to [Available encryption modes](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/#available-encryption-modes) for more information on these values.\n\nAPI configuration property name: `\"ssl\"` (string).\n\nAPI values: `\"off\"`, `\"flexible\"`, `\"full\"`, `\"strict\"`, `\"origin_pull\"`.\n\nRefer to [Create a configuration rule via API](https://developers.cloudflare.com/rules/configuration-rules/create-api/#example-requests) for complete API examples.\n\n<page>\n---\ntitle: Common API calls for Custom Errors · Cloudflare Rules docs\ndescription: The following sections provide examples of common API calls for\n  managing custom error assets and Error Pages at the zone level.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/api-calls/\n  md: https://developers.cloudflare.com/rules/custom-errors/api-calls/index.md\n---\n\nThe following sections provide examples of common API calls for managing custom error assets and Error Pages at the zone level.\n\nTo perform the same operations at the account level, use the corresponding account-level API endpoints.\n\n### Create a custom error asset\n\nThe following `POST` request creates a new custom error asset in a zone based on the provided URL:\n\nTo create an asset at the account level, use the account-level endpoint:\n\n### List custom error assets\n\nThe following `GET` request retrieves a list of custom error assets configured in the zone:\n\nTo retrieve a list of assets at the account level, use the account-level endpoint:\n\n### Update a custom error asset\n\nThe following `PUT` request updates the URL of an existing custom error asset at the zone level named `500_error_template`:\n\nYou can update the asset description and URL. You cannot update the asset name after creation.\n\nIf you provide the same URL when updating an asset, Cloudflare will fetch the URL again, along with its resources.\n\nTo update an asset at the account level, use the account-level endpoint:\n\n### Get a custom error asset\n\nThe following `GET` request retrieves the details of an existing custom error asset at the zone level named `500_error_template`:\n\nTo retrieve an asset at the account level, use the account-level endpoint:\n\n### Delete a custom error asset\n\nThe following `DELETE` request deletes an existing custom error asset at the zone level named `500_error_template`:\n\nIf the request is successful, the response will have a `204` HTTP status code.\n\nTo delete an asset at the account level, use the account-level endpoint:\n\nThis example obtains the current configuration for the `Rate limiting block` error page (with ID `ratelimit_block`).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Custom Pages Write`\n* `Custom Pages Read`\n* `Zone Settings Write`\n* `Zone Settings Read`\n\nThe response indicates that the page is currently set to the Cloudflare default page (`\"state\": \"default\"`).\n\nFor a list of error page identifiers, refer to [Error page types](https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/).\n\n### Update error page\n\nThis example defines a custom error page for `Rate limiting block` errors (with ID `ratelimit_block`) based on the provided URL.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Custom Pages Write`\n* `Zone Settings Write`\n\nTo set the error page back to the default page, use `\"state\": \"default\"` in the request body.\n\nFor a list of error page identifiers, refer to [Error page types](https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/).\n\n* [Custom Error Pages API reference](https://developers.cloudflare.com/api/resources/custom_pages/)\n\n<page>\n---\ntitle: Create custom error rules · Cloudflare Rules docs\ndescription: To review existing custom error assets, go to Rules > Settings >\n  Custom Error Assets tab.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/create-rules/\n  md: https://developers.cloudflare.com/rules/custom-errors/create-rules/index.md\n---\n\n### Create a custom error rule\n\n1. In the Cloudflare dashboard, go to the Rules **Overview** page.\n\n[Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/rules/overview)\n\n2. Select **Create rule** > **Custom Error Rule**.\n\n3. Enter a descriptive name for the rule in **Rule name**.\n\n4. Under **If incoming requests match**, select one of the following options:\n\n* **Custom filter expression**: The rule will only apply to traffic matching a custom expression. Define the [rule expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/) to configure which requests should be rewritten. Use either the Expression Builder or the Expression Editor to define the custom expression. For more information, refer to [Edit expressions in the dashboard](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n* **All incoming requests**: The rule will apply to all responses with a `400` status code or above, except for block and challenge actions issued by Cloudflare’s security products.\n\n5. In **Deliver a custom error response**, select the response type (either *Custom error asset* or one of the available inline responses).\n\nIf you select *Custom error asset*, select an existing custom error asset in **Asset**, or select **Create new asset** to [create a new custom error asset](#create-a-custom-error-asset-dashboard).\n\nIf you select *JSON response*, *HTML response*, *Text response*, or *XML response*, enter the custom error response you want to send to web site visitors in **JSON response**, **HTML response**, **Text response**, or **XML response**, respectively. The response can include [error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/) that Cloudflare will replace with real values before sending the response to the visitor. The maximum response size is 10 KB.\n\n6. (Optional) In **Response code**, enter the HTTP status code of the response (an integer value between `400` and `999`). If provided, this value will override the current response status code.\n\n7. (Optional) Under **Place at**, define where to place the rule in the rules list: first rule in the list, last rule in the list, or in a custom position (after a given rule).\n\n8. To save and deploy your rule, select **Deploy**. If you are not ready to deploy your rule, select **Save as Draft**.\n\n### Create a custom error asset\n\n1. In the **Create Custom Error Asset** sidebar, enter a name for the asset in **Asset name**.\n2. (Optional) Enter a description for the asset in **Description**.\n3. In **URL**, enter the URL of the page you want to fetch and store in Cloudflare's global network. Cloudflare will fetch all the page resources and store a minified version of the page you can use in one or more custom error rules.\n4. Select **Save**.\n\nTo review existing custom error assets, go to **Rules** > **Settings** > **Custom Error Assets** tab.\n\nTo configure a custom error rule via API:\n\n1. (Optional) [Create a custom error asset](#create-a-custom-error-asset-api) based on a URL you provide.\n2. [Create a custom error rule](#create-a-custom-error-rule-api) in the `http_custom_errors` phase, using the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\n### Create a custom error asset\n\nThe following `POST` request creates new a custom error asset in a zone based on the provided URL:\n\n### Create a custom error rule\n\nWhen creating a custom error rule via API, make sure you:\n\n* Set the rule action to `serve_error`.\n* Define the [rule parameters](https://developers.cloudflare.com/rules/custom-errors/reference/parameters/#custom-error-rules) in the `action_parameters` field according to response type.\n* Deploy the rule to the `http_custom_errors` phase.\n\nThe first rule in the `http_custom_errors` phase ruleset that matches will be applied. No other rules in the ruleset will be matched or applied. Additionally, custom error rules defined at the zone level will have priority over rules defined at the account level.\n\n#### General procedure\n\nFollow this workflow to create a custom error rule for a given zone via API:\n\n1. Use the [List zone rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to check if there is already a ruleset for the `http_custom_errors` phase at the zone level.\n\n2. If the phase ruleset does not exist, create it using the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, which allows you to create a ruleset if it does not exist and update all the rules in the ruleset. Create the ruleset in the `http_custom_errors` phase.\n\nIf the phase ruleset already exists, use the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation to replace all the rules in the ruleset, or the [Add a rule to a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/add-rule/) operation to add a rule to the existing rules in the ruleset.\n\nTo create a custom error rule at the account level, use the corresponding account-level API endpoints.\n\nThis example configures a custom error rule returning a [previously created custom error asset](#create-a-custom-error-asset-api) named `500_error_template` for responses with a `500` HTTP status code.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nThis `PUT` request, corresponding to the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, replaces any existing rules in the `http_custom_errors` phase entry point ruleset.\n\n### Required API token permissions\n\nThe API token used in API requests to manage Custom Error Rules and Custom Error Assets must have at least the following permission:\n\n* *Custom Error Rules* > *Edit*\n\n<page>\n---\ntitle: Edit Error Pages · Cloudflare Rules docs\ndescription: \"You can define custom Error Pages for the following errors and challenges:\"\nlastUpdated: 2025-12-12T12:36:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/edit-error-pages/\n  md: https://developers.cloudflare.com/rules/custom-errors/edit-error-pages/index.md\n---\n\nYou can define custom [Error Pages](https://developers.cloudflare.com/rules/custom-errors/#error-pages) for the following errors and challenges:\n\n* WAF block\n* IP/Country block\n* IP/Country challenge\n* 500 class errors\n* 1000 class errors\n* Managed challenge / I'm Under Attack Mode\n* Rate limiting block\n\nOlder error page types\n\nYou can only customize the error pages for the following error page types if you have customized their error pages in the past:\n\n* Interactive Challenge\n* JavaScript Challenge\n\nThese types of challenges are being discouraged in favor of managed challenges.\n\nFor more information on the different types of Error Pages, refer to [Error page types](https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/).\n\nTo return custom error responses for requests that match specific conditions, use [Custom Error Rules](https://developers.cloudflare.com/rules/custom-errors/#custom-error-rules) instead.\n\n## 1. Design your custom error page\n\nBefore defining a custom error page in your Cloudflare account, you will need to design and code that page. It can be hosted on your own web server or using a Cloudflare product like [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\nWhen designing your custom error page, you can include page-specific [custom error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/). Each custom error token provides diagnostic information that appears on the error page.\n\nTo display a custom page for each error, create a separate page per error. For example, to create a custom error page for both **IP/Country Block** and **WAF block**, you must design and publish two separate pages.\n\n* Your custom error page should include a page-specific custom error token if applicable and cannot exceed 1.5 MB (1,500,000 bytes). Also, it must include HTML `<head>` and `</head>` tags.\n* Make sure that the `referrer` meta tag is not present in your custom error page's HTML code since it will disrupt [Cloudflare challenges](https://developers.cloudflare.com/cloudflare-challenges/): `<meta name=\"referrer\" (...) />`\n\nYou can use the following template to start building your error page:\n\nExample error page for 5XX errors\n\nThe following HTML code is an example error page for 5XX errors without styling:\n\n## 2. Update an error page in the dashboard\n\nYou can define an error page at the zone level or for your entire account. Zone-level error pages have priority over account-level error pages.\n\nTo edit a zone-level custom error page:\n\n1. In the Cloudflare dashboard, go to the **Error Pages** page.\n\n[Go to **Error Pages**](https://dash.cloudflare.com/?to=/:account/:zone/error-pages)\n\n2. Identify your desired custom error page type.\n\n3. (Optional) To preview the current error page (default or custom), select the link in the **Show** column.\n\n4. To edit the error page, select the three dots > **Edit** next to the page type you previously identified.\n\n5. To use Cloudflare's default page, select **Cloudflare default page.** To provide a custom error page, select **Custom page** and enter the URL of the custom error page you created.\n\n6. Select **Confirm**.\n\nTo update an account-level custom error page:\n\n1. In the Cloudflare dashboard, go to the **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **Error Pages** and identify your desired custom error page type.\n\n3. (Optional) To preview the current error page (default or custom), select the link in the **Show** column.\n\n4. To edit the error page, select the three dots > **Edit** next to the page type you previously identified.\n\n5. To use Cloudflare's default page, select **Cloudflare default page.** To provide a custom error page, select **Custom page** and enter the URL of the custom error page you created.\n\n6. Select **Confirm**.\n\n## Fetch custom error page again\n\nAfter successfully setting the content of the custom error page in **Error Pages**, you can remove the page from your origin server.\n\nIf in the future, you need to update your custom error page, you must fetch the page again, even if the page URL remains unchanged. In this case, next to the page type you want to update, select the three dots > **Fetch custom page again**.\n\n<page>\n---\ntitle: Example custom error rules · Cloudflare Rules docs\ndescription: \"The provided examples use the following fields in their rule expressions:\"\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/example-rules/\n  md: https://developers.cloudflare.com/rules/custom-errors/example-rules/index.md\n---\n\nThe provided examples use the following fields in their rule expressions:\n\n* [`http.response.code`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.code/) (Response Status Code): Represents the HTTP status code returned to the client, either set by a Cloudflare product or returned by the origin server. Use this field to customize the response for error codes returned by the origin server or by a Cloudflare product such as a Worker.\n\n* [`cf.response.1xxx_code`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.response.1xxx_code/): Contains the specific error code for Cloudflare-generated errors. This field will only work for Cloudflare-generated errors such as [52X](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/) and [1XXX](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-1xxx-errors/).\n\n### Custom JSON response for all 5XX errors\n\nThis example configures a custom JSON error response for all 5XX errors (`500`-`599`) in a zone. The HTTP status code of the custom error response will be set to `530`.\n\n**Custom error rule configuration:**\n\n* **Name**: `Custom JSON response for all 5XX errors`\n\n* **If incoming requests match** > **Custom filter expression**:\n\n| Field | Operator | Value | Logic |\n    | - | - | - | - |\n    | Response Status Code | greater than or equal to | `500` | And |\n    | Response Status Code | less than or equal to | `599` | |\n\nIf using the Expression Editor:\\\n    `(http.response.code ge 500 and http.response.code le 599)`\n\n* **Response type**: *JSON response*\n\n* **Response code**: `530`\n\n* **JSON response**: `{\"message\": \"A server error occurred.\"}`\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nThis `PUT` request, corresponding to the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, replaces any existing rules in the `http_custom_errors` phase entry point ruleset.\n\n### Custom HTML response with updated status code\n\nThis example configures a custom HTML error response for responses with a `500` HTTP status code, and redefines the response status code to `503`.\n\n**Custom error rule configuration:**\n\n* **Name**: `Custom HTML response for 500 errors`\n\n* **If incoming requests match** > **Custom filter expression**:\n\n| Field | Operator | Value |\n    | - | - | - |\n    | Response Status Code | equal to | `500` |\n\nIf using the Expression Editor:\\\n    `(http.response.code eq 500)`\n\n* **Response type**: *HTML response*\n\n* **Response code**: `503`\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nThis `PUT` request, corresponding to the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, replaces any existing rules in the `http_custom_errors` phase entry point ruleset.\n\n### Custom HTML response for Cloudflare 1020 errors\n\nThis example configures a custom HTML error response for [Cloudflare error 1020](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-1xxx-errors/error-1020/) (Access Denied).\n\n**Custom error rule configuration:**\n\n* **Name**: `Custom HTML response for 1020 errors`\n\n* **If incoming requests match** > **Custom filter expression**\n\nUse the Expression Editor:\\\n    `(cf.response.1xxx_code eq 1020)`\n\n* **Response type**: *HTML response*\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nThis `PUT` request, corresponding to the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, replaces any existing rules in the `http_custom_errors` phase entry point ruleset.\n\n### Custom error asset created from a URL\n\nThis example configures a custom error rule returning a previously created custom error asset named `500_error_template` for responses with a `500` HTTP status code.\n\n**Custom error rule configuration:**\n\n* **Name**: `Serve asset for HTTP 500 errors`\n\n* **If incoming requests match** > **Custom filter expression**:\n\n| Field | Operator | Value |\n    | - | - | - |\n    | Response Status Code | equal to | `500` |\n\nIf using the Expression Editor:\\\n    `(http.response.code eq 500)`\n\n* **Response type**: *Custom error asset*\n\n* **Asset**: `500_error_template`\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n  * `Config Settings Write`\n  * `Dynamic URL Redirects Write`\n  * `Cache Settings Write`\n  * `Custom Errors Write`\n  * `Origin Write`\n  * `Managed headers Write`\n  * `Zone Transform Rules Write`\n  * `Mass URL Redirects Write`\n  * `Magic Firewall Write`\n  * `L4 DDoS Managed Ruleset Write`\n  * `HTTP DDoS Managed Ruleset Write`\n  * `Sanitize Write`\n  * `Transform Rules Write`\n  * `Select Configuration Write`\n  * `Bot Management Write`\n  * `Zone WAF Write`\n  * `Account WAF Write`\n  * `Account Rulesets Write`\n  * `Logs Write`\n  * `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nThis `PUT` request, corresponding to the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation, replaces any existing rules in the `http_custom_errors` phase entry point ruleset.\n\n<page>\n---\ntitle: Reference · Cloudflare Rules docs\ndescription: This section contains reference information for Custom Errors.\nlastUpdated: 2025-04-24T16:34:07.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/reference/\n  md: https://developers.cloudflare.com/rules/custom-errors/reference/index.md\n---\n\nThis section contains reference information for Custom Errors.\n\n* [Custom Errors parameters](https://developers.cloudflare.com/rules/custom-errors/reference/parameters/)\n* [Error tokens](https://developers.cloudflare.com/rules/custom-errors/reference/error-tokens/)\n* [Error page types](https://developers.cloudflare.com/rules/custom-errors/reference/error-page-types/)\n\n<page>\n---\ntitle: Troubleshoot Error Pages issues · Cloudflare Rules docs\ndescription: If Cloudflare cannot load your site or you have blocked the United\n  States (US) via IP Access rules or WAF custom rules, publishing and previewing\n  a custom error page might not work.\nlastUpdated: 2025-06-16T10:40:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/custom-errors/troubleshooting/\n  md: https://developers.cloudflare.com/rules/custom-errors/troubleshooting/index.md\n---\n\n## Cannot preview error page\n\nIf Cloudflare cannot load your site or you have blocked the United States (US) via [IP Access rules](https://developers.cloudflare.com/waf/tools/ip-access-rules/) or WAF custom rules, publishing and previewing a custom error page might not work.\n\nA common error might look like the following: `Error fetching page: Fetch failed, https://example.com/ipcountryblock.html returned 403 (Code: 1202)`.\n\nMake sure that no WAF rule is blocking or challenging Custom Errors product when it is fetching the content of your custom error page.\n\n## Error pages for blocked requests\n\nIf you block countries or IP addresses with an [IP Access rule](https://developers.cloudflare.com/waf/tools/ip-access-rules/), affected visitors will get a `1005` error and your **IP/Country Block** custom page.\n\nIf you block countries or IP addresses with a [WAF custom rule](https://developers.cloudflare.com/waf/custom-rules/) and you do not configure a [custom error rule](https://developers.cloudflare.com/rules/custom-errors/create-rules/#create-a-custom-error-rule-dashboard) or a [WAF custom response](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/#configure-a-custom-response-for-blocked-requests) for blocked requests, affected visitors will get your **WAF Block** page.\n\nIf you block requests due to a [rate limiting rule](https://developers.cloudflare.com/waf/rate-limiting-rules/) and you do not configure a [custom error rule](https://developers.cloudflare.com/rules/custom-errors/create-rules/#create-a-custom-error-rule-dashboard) or a [WAF custom response](https://developers.cloudflare.com/waf/rate-limiting-rules/create-zone-dashboard/#configure-a-custom-response-for-blocked-requests) for blocked requests, affected visitors will get your **429 Errors** page displaying a Cloudflare `1015` error.\n\nIf you block countries or IP addresses with a firewall rule (now deprecated), affected visitors will get your **1000 Class Errors** page.\n\nYou cannot customize the following 1XXX errors via Error Pages:\n\n* `1001` - Unable to resolve\n* `1003` - Bad Host header\n* `1018` - Unable to resolve because of ownership lookup failure\n* `1023` - Unable to resolve because of feature lookup failure\n\n## Custom error page size\n\nYour custom error page cannot be blank and the combined size of all page assets cannot exceed 1.5 MB (1,500,000 characters). To avoid exceeding the custom error page limit, preview your page to check its size before publishing.\n\n## General troubleshooting advice\n\nIf you encounter errors while attempting to preview or publish your custom error page, use an [HTML validator](https://validator.w3.org/) to ensure that your code resolves properly.\n\n* [HTTP Status Codes](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/)\n* [Challenges](https://developers.cloudflare.com/cloudflare-challenges/)\n\n<page>\n---\ntitle: URL normalization examples · Cloudflare Rules docs\ndescription: Examples of the impact of different URL normalization settings in\n  the URLs of incoming requests.\nlastUpdated: 2024-11-08T10:05:02.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/normalization/examples/\n  md: https://developers.cloudflare.com/rules/normalization/examples/index.md\n---\n\nThe following table shows how different [URL normalization settings](https://developers.cloudflare.com/rules/normalization/settings/) affect request URLs before they pass to other Cloudflare features and to the origin server:\n\n| Incoming URL | Normalization type | Normalize incoming URLs | Normalize URLs to origin | URL at Cloudflare's network | URL passed to origin server |\n| - | - | - | - | - | - |\n| `www.example.com/hello` | (any) | *Off* | *Off* | `www.example.com/hello` | `www.example.com/hello` |\n| `www.example.com/hello` | (any) | *On* | *Off* | `www.example.com/hello` | `www.example.com/hello` |\n| `www.example.com/hello` | (any) | *On* | *On* | `www.example.com/hello` | `www.example.com/hello` |\n| `example.com/%68ello` | (any) | *Off* | *Off* | `example.com/%68ello` | `example.com/%68ello` |\n| `example.com/%68ello` | (any) | *On* | *Off* | `example.com/hello` | `example.com/%68ello` |\n| `example.com/%68ello` | (any) | *On* | *On* | `example.com/hello` | `example.com/hello` |\n| `example.com/%68ello//pa\\th` | *RFC-3986* | *Off* | *Off* | `example.com/%68ello//pa\\th` | `example.com/%68ello//pa\\th` |\n| `example.com/%68ello//pa\\th` | *RFC-3986* | *On* | *Off* | `example.com/hello//pa%5Cth` | `example.com/%68ello//pa\\th` |\n| `example.com/%68ello//pa\\th` | *RFC-3986* | *On* | *On* | `example.com/hello//pa%5Cth` | `example.com/hello//pa%5Cth` |\n| `example.com/%68ello//pa\\th` | *Cloudflare* | *Off* | *Off* | `example.com/%68ello//pa\\th` | `example.com/%68ello//pa\\th` |\n| `example.com/%68ello//pa\\th` | *Cloudflare* | *On* | *Off* | `example.com/hello/pa/th` | `example.com/%68ello//pa\\th` |\n| `example.com/%68ello//pa\\th` | *Cloudflare* | *On* | *On* | `example.com/hello/pa/th` | `example.com/hello/pa/th` |\n| `example.com/hello//../path` | *RFC-3986* | *On* | *On* | `example.com/hello/path` | `example.com/hello/path` |\n| `example.com/hello//../path` | *Cloudflare* | *On* | *On* | `example.com/path` | `example.com/path` |\n| `example.com/hello/\\../path` | *RFC-3986* | *On* | *On* | `example.com/hello/%5C../path` | `example.com/hello/%5C../path` |\n| `example.com/hello/\\../path` | *Cloudflare* | *On* | *On* | `example.com/path` | `example.com/path` |\n\n<page>\n---\ntitle: How URL normalization works · Cloudflare Rules docs\ndescription: URL normalization modifies separators, encoded elements, and\n  literal bytes in incoming URLs so that they conform to a consistent formatting\n  standard.\nlastUpdated: 2025-09-08T13:42:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/normalization/how-it-works/\n  md: https://developers.cloudflare.com/rules/normalization/how-it-works/index.md\n---\n\nURL normalization modifies separators, encoded elements, and literal bytes in incoming URLs so that they conform to a consistent formatting standard.\n\nFor example, consider a WAF custom rule that blocks requests whose URLs match `www.example.com/hello`. The rule would not block a request containing an encoded element — `www.example.com/%68ello`. Normalizing incoming URLs on the Cloudflare global network helps simplify rules expressions containing URLs.\n\nThe two available types of URL normalization are:\n\n* [RFC 3986 normalization](#rfc-3986-normalization)\n* [Cloudflare normalization](#cloudflare-normalization)\n\nThe location where URL normalization will occur depends on the [configured settings](https://developers.cloudflare.com/rules/normalization/settings/).\n\nFor examples of the different settings and their impact on request URLs, refer to the [URL normalization examples](https://developers.cloudflare.com/rules/normalization/examples/).\n\n## RFC 3986 normalization\n\nThe URL normalization performed according to [RFC 3986](https://www.ietf.org/rfc/rfc3986.txt) is as follows:\n\n* The following unreserved characters are [percent decoded](https://tools.ietf.org/html/rfc3986#section-2.1):\n\n* Alphabetical characters: `a`-`z`, `A`-`Z` (decoded from `%41`-`%5A` and `%61`-`%7A`)\n  * Digit characters: `0`-`9` (decoded from `%30`-`%39`)\n  * hyphen `-` (`%2D`), period `.` (`%2E`), underscore `_` (`%5F`), and tilde `~` (`%7E`)\n\n* These reserved characters are not encoded or decoded: `: / ? # [ ] @ ! $ & ' ( ) * + , ; =`\n\n* Other characters, for example literal byte values, are percent encoded.\n\n* Percent encoded representations are converted to upper case.\n\n* URL paths are normalized according to the [Remove Dot Segments](https://tools.ietf.org/html/rfc3986#section-5.2.4) protocol.\n\n## Cloudflare normalization\n\nWhen using the Cloudflare URL normalization, some extra normalization techniques will be applied to URLs of incoming requests, in the following order:\n\n1. Normalize back slashes (`\\`) into forward slashes (`/`).\n2. Merge successive forward slashes (for example, `//` will be normalized to `/`).\n3. Perform [RFC 3986 normalization](#rfc-3986-normalization) of the resulting URL.\n\n<page>\n---\ntitle: Configure URL normalization in the dashboard · Cloudflare Rules docs\ndescription: How to configure URL normalization in the Cloudflare dashboard.\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/normalization/manage/\n  md: https://developers.cloudflare.com/rules/normalization/manage/index.md\n---\n\n1. In the Cloudflare dashboard, go to the Rules **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/rules/settings)\n\n2. Go to the **URL Normalization** tab.\n\n3. Configure the [available URL normalization settings](https://developers.cloudflare.com/rules/normalization/settings/).\n\n![Available URL normalization settings in the Cloudflare dashboard](https://developers.cloudflare.com/_astro/url-normalization-settings.CiswBm53_SktBM.webp)\n\n<page>\n---\ntitle: URL normalization settings · Cloudflare Rules docs\ndescription: \"The Cloudflare dashboard provides the following settings to manage\n  URL normalization:\"\nlastUpdated: 2025-09-08T13:42:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/normalization/settings/\n  md: https://developers.cloudflare.com/rules/normalization/settings/index.md\n---\n\nThe Cloudflare dashboard provides the following settings to manage URL normalization:\n\n## Normalization type\n\nDefault value: *RFC-3986*\n\nSelects the type of normalization to perform:\n\n* *RFC-3986* – Applies URL normalization strictly according to [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).\n* *Cloudflare* – In addition to what is defined in RFC 3986, applies [extra URL normalization techniques](https://developers.cloudflare.com/rules/normalization/how-it-works/#cloudflare-normalization).\n\n## Normalize incoming URLs\n\nConfigures the URLs of all incoming traffic to Cloudflare:\n\n* When enabled, all incoming URLs are normalized before they pass to subsequent Cloudflare features that can receive a URL as input, such as Page Rules, WAF custom rules, Workers, and Access.\n* When disabled, incoming URLs are not normalized before passing to subsequent Cloudflare features.\n\n## Normalize URLs to origin\n\nConfigures URLs sent to the origin:\n\n* When enabled, requests sent to the origin are normalized.\n* When disabled, requests sent to the origin are not modified.\n\nYou can only view and enable this option when **Normalize incoming URLs** is enabled.\n\nFor examples of how these settings affect URL normalization, refer to the [URL normalization examples](https://developers.cloudflare.com/rules/normalization/examples/).\n\n<page>\n---\ntitle: Create an origin rule via API · Cloudflare Rules docs\ndescription: Use the Rulesets API to create origin rules via API.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/create-api/\n  md: https://developers.cloudflare.com/rules/origin-rules/create-api/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to create origin rules via API.\n\n## Basic rule settings\n\nWhen creating an origin rule via API, make sure you:\n\n* Set the rule action to `route`.\n* Define the [parameters](https://developers.cloudflare.com/rules/origin-rules/parameters/) in the `action_parameters` field according to the type of origin override.\n* Deploy the rule to the `http_request_origin` phase at the zone level.\n\nFollow this workflow to create an origin rule for a given zone via API:\n\n1. Use the [List zone rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to check if there is already a ruleset for the `http_request_origin` phase at the zone level.\n\n2. If the phase ruleset does not exist, create it using the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation. In the new ruleset properties, set the following values:\n\n* **kind**: `zone`\n   * **phase**: `http_request_origin`\n\n3. Use the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation to add an origin rule to the list of ruleset rules. Alternatively, include the rule in the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) request mentioned in the previous step.\n\nMake sure your API token has the [required permissions](#required-api-token-permissions) to perform the API operations.\n\nExample: Add a rule that overrides the `Host` header of incoming requests and the resolved DNS record\n\nThe following example sets the rules of an existing phase ruleset (`$RULESET_ID`) to a single origin rule — overriding the `Host` header of incoming requests and the resolved DNS record — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation. The response will contain the complete definition of the ruleset you updated.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nExample: Add a rule that overrides the port of incoming requests\n\nThe following example sets the rules of an existing phase ruleset (`$RULESET_ID`) to a single origin rule — overriding the port of incoming requests — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation. The response will contain the complete definition of the ruleset you updated.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nExample: Add a rule that overrides the SNI value of incoming requests\n\nThe following example sets the rules of an existing phase ruleset (`$RULESET_ID`) to a single origin rule — overriding the SNI value of incoming requests addressed at `admin.example.com` — using the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nUse the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n## Required API token permissions\n\nThe API token used in API requests to manage origin rules must have at least the following permission:\n\n* *Zone* > *Origin Rules* > *Edit*\n\n<page>\n---\ntitle: Create an origin rule in the dashboard · Cloudflare Rules docs\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/create-dashboard/\n  md: https://developers.cloudflare.com/rules/origin-rules/create-dashboard/index.md\n---\n\n1. In the Cloudflare dashboard, go to the Rules **Overview** page.\n\n[Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/rules/overview)\n\n2. Select **Create rule** > **Origin Rule**.\n\n3. (Optional) Select one of the rule templates that address common use cases. Then, review and adjust the proposed rule configuration.\n\n4. Enter a descriptive name for the rule in **Rule name**.\n\n5. Under **When incoming requests match**, define the [rule expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n6. Under **Set origin parameters**, define the [origin rule settings](https://developers.cloudflare.com/rules/origin-rules/features/) you wish to change for requests matching the rule expression.\n\n7. To save and deploy your rule, select **Deploy**. If you are not ready to deploy your rule, select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\n<page>\n---\ntitle: Origin Rules examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/examples/\n  md: https://developers.cloudflare.com/rules/origin-rules/examples/index.md\n---\n\n[Change the HTTP Host header and DNS record](https://developers.cloudflare.com/rules/origin-rules/examples/change-http-host-header/)\n\n[Create an origin rule to change the HTTP `Host` header and the resolved DNS record.](https://developers.cloudflare.com/rules/origin-rules/examples/change-http-host-header/)\n\n[Change the destination port](https://developers.cloudflare.com/rules/origin-rules/examples/change-port/)\n\n[Create an origin rule to change the destination port.](https://developers.cloudflare.com/rules/origin-rules/examples/change-port/)\n\n[Define a single origin rule using Terraform](https://developers.cloudflare.com/rules/origin-rules/examples/define-single-origin-terraform/)\n\n[Create an origin rule using Terraform to override the `Host` header, the resolved hostname, and the destination port of API requests.](https://developers.cloudflare.com/rules/origin-rules/examples/define-single-origin-terraform/)\n\n<page>\n---\ntitle: Origin Rules FAQ · Cloudflare Rules docs\ndescription: Below you will find answers to the most commonly asked questions\n  regarding Origin Rules.\nlastUpdated: 2025-09-11T15:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/faq/\n  md: https://developers.cloudflare.com/rules/origin-rules/faq/index.md\n---\n\nBelow you will find answers to the most commonly asked questions regarding Origin Rules.\n\n## What happens if I use both an origin rule and a page rule to perform a Host header/DNS record override?\n\nIn this situation the origin rule parameters will override the [page rule](https://developers.cloudflare.com/rules/page-rules/) parameters.\n\nConsider the following example scenarios:\n\n* A page rule defines a Host header override, but not a resolve override (or DNS record override). An origin rule defines a DNS record override, but not a Host header override. The resulting request will have the `Host` header defined by the page rule and the origin hostname defined by the origin rule.\n* A page rule defines a Host header override, and an origin rule also defines a Host header override. The resulting request will have the `Host` header defined by the origin rule.\n\n## Will Cloudflare automatically migrate my Page Rules with Host header and DNS record overrides to origin rules?\n\nYes. Refer to the [Page Rules migration guide](https://developers.cloudflare.com/rules/reference/page-rules-migration/) for any updates on the migration process.\n\n## What happens if more than one origin rule matches the current request?\n\nIf two or more origin rules match a request, the configuration of those rules is merged. While merging two configurations, the settings of later rules will override the settings defined in previous rules, updating or adding configuration properties. The final configuration applied by Cloudflare will be this merged version.\n\nFor example, if you configure the following two [origin rules](https://developers.cloudflare.com/rules/origin-rules/) and both rules match, Cloudflare will use the destination port set by the first rule, and the DNS hostname override and `Host` header value set by the second rule.\n\n| Parameter | Value |\n| - | - |\n| Set `Host` header | `example.com` |\n| Set destination port | `8081` |\n\n| Parameter | Value |\n| - | - |\n| Set `Host` header | `example.net` |\n| Set DNS hostname | `example.net` |\n\nJSON example for API users\n\nWhen [using the API](https://developers.cloudflare.com/rules/origin-rules/create-api/), you configure origin rule parameters in an `action_parameters` object.\n\nThe merged configuration to apply would be the following:\n\n| Parameter | Value |\n| - | - |\n| Set `Host` header | `example.net` |\n| Set destination port | `8081` |\n| Set DNS hostname | `example.net` |\n\nIf you also configured a destination port in rule #2, that value would override the `8081` destination port defined in rule #1.\n\n<page>\n---\ntitle: Origin Rules settings · Cloudflare Rules docs\ndescription: The following sections describe the available settings in Origin Rules.\nlastUpdated: 2025-09-11T15:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/features/\n  md: https://developers.cloudflare.com/rules/origin-rules/features/index.md\n---\n\nThe following sections describe the available settings in Origin Rules.\n\nAllows you to rewrite the HTTP `Host` header of incoming requests.\n\nA common use case for this functionality is when your content is hosted on a third-party server that only accepts `Host` headers with their own server names. In this situation, you must update the `Host` HTTP header in incoming requests from `Host: example.com` to `Host: thirdpartyserver.example.net`.\n\n* In most situations, when you rewrite the HTTP `Host` header you also need to configure a [DNS record override](#dns-record). The `Host` header override only updates the header value; the DNS record override will handle the rerouting of the request.\n\n* An origin rule performing a `Host` header override will also update the Server Name Indication (SNI) value of the original request to the same value. To set an SNI value different from the `Host` header value, add an [SNI override](#server-name-indication-sni) in the same origin rule or create a separate origin rule for this purpose.\n\n* If you have configured load balancing through Cloudflare and you wish to override the HTTP `Host` header per origin or for a given monitor, refer to [Override HTTP Host headers](https://developers.cloudflare.com/load-balancing/additional-options/override-http-host-headers/) in the Load Balancing documentation for more information.\n\n## Server Name Indication (SNI)\n\nAllows you to override the Server Name Indication (SNI) [1](#user-content-fn-1) value of a request. For more information, refer to [What is SNI (Server Name Indication)?](https://www.cloudflare.com/learning/ssl/what-is-sni/) in the Learning Center.\n\n* The new SNI value must be a valid hostname on the same Cloudflare account (possibly on a different zone).\n* Currently, you can only use a static value when overriding SNI.\n* An SNI override will take precedence over [SNI rewrites of custom origins](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/#sni-rewrites) when using Cloudflare for SaaS.\n\nAllows you to override the resolved hostname of incoming requests. This functionality is also known as resolve override.\n\nA common use case is when you are serving an application from the URI (for example, `mydomain.com/app`). In this case, the `app` may be hosted on a different server or by a third party. A DNS record override allows you to redirect requests to this endpoint to the server for that third-party application.\n\n* You must specify a valid hostname in a DNS record override that is a hostname on the same Cloudflare account (possibly on a different zone). You can [configure a DNS record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records#create-dns-records) (a `CNAME`, `A`, or `AAAA` record) with a hostname pointing to a third-party hostname/IP address, either proxied by Cloudflare or not.\n\n* In most situations, when you configure a DNS record override you also need to configure a [`Host` header override](#host-header). The DNS record override handles the rerouting of the request; the `Host` header override updates the `Host` HTTP header value in the request. Defining a `Host` header override will also update the Server Name Indication (SNI) value of the original request to the same value. To set an SNI value different from the `Host` header value, add an [SNI override](#server-name-indication-sni) in the same origin rule or create a separate origin rule for this purpose.\n\nThe following example DNS records configure a `resolve.example.com` hostname pointing to an external hostname and IP address using a `CNAME` record and an `A` record, respectively:\n\n**Example `CNAME` record**\n\n* **Type:** *CNAME*\n* **Name:** `resolve.example.com`\n* **Target:** `domain.s3.amazonaws.com`\n* **TTL:** `Auto`\n* **Proxy status:** *Proxied* (orange cloud icon)\n\n**Example `A` record**\n\n* **Type:** *A*\n* **Name:** `resolve.example.com`\n* **IPv4 address:** `203.0.113.1`\n* **TTL:** `Auto`\n* **Proxy status:** *Proxied* (orange cloud icon)\n\nAllows you to override the destination port of a request.\n\nWhen you configure a destination port override, you can redirect incoming requests to a different port. For example, you could override the destination port for requests received for `mydomain.com` so that they are served by the application running on port 9000 (`mydomain.com:9000`).\n\nThe destination port must be between 1 and 65,535.\n\n1. SNI allows a server to host multiple TLS Certificates for multiple websites using a single IP address. SNI adds the website hostname in the TLS handshake to inform the server which website to present when using shared IPs. [↩](#user-content-fnref-1)\n\n<page>\n---\ntitle: Origin Rules API parameter reference · Cloudflare Rules docs\ndescription: \"Create different overrides by including different action\n  parameters in the action_parameters field:\"\nlastUpdated: 2025-09-11T15:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/parameters/\n  md: https://developers.cloudflare.com/rules/origin-rules/parameters/index.md\n---\n\nCreate [different overrides](https://developers.cloudflare.com/rules/origin-rules/features/) by including different action parameters in the `action_parameters` field:\n\n| Override type | What to include |\n| - | - |\n| Host header override | [`host_header` parameter](#host-header-override-parameters) |\n| SNI override | [`sni` object](#sni-override-parameters) |\n| DNS record override / Destination port override | [`origin` object](#dns-record-override-and-destination-port-override-parameters) |\n\nThe same origin rule can have different types of overrides. Refer to [Configuring several overrides in the same rule](#configuring-several-overrides-in-the-same-rule) for a syntax example.\n\n## Host header override parameters\n\nThe full syntax of the `action_parameters` field for overriding the HTTP `Host` header is the following:\n\n## SNI override parameters\n\nThe full syntax of the `action_parameters` field for overriding the SNI value of incoming requests is the following:\n\n## DNS record override and destination port override parameters\n\nThe full syntax of the `action_parameters` field for overriding both the hostname and the destination port of incoming requests is the following:\n\nIf you are only overriding the hostname or the port, omit the `port` or `host` parameter, respectively.\n\n## Configuring several overrides in the same rule\n\nThe same origin rule can have different types of overrides. For example, a single origin rule can perform an HTTP `Host` header override and a destination port override. The syntax of such a rule would be the following:\n\n<page>\n---\ntitle: Origin Rules tutorials · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/origin-rules/tutorials/\n  md: https://developers.cloudflare.com/rules/origin-rules/tutorials/index.md\n---\n\n| Name | Last Updated | Difficulty |\n| - | - | - |\n| [Point to R2 bucket with a custom domain](https://developers.cloudflare.com/rules/origin-rules/tutorials/point-to-r2-bucket-with-custom-domain/) | 9 months ago | Beginner |\n| [Point to Pages with a custom domain](https://developers.cloudflare.com/rules/origin-rules/tutorials/point-to-pages-with-custom-domain/) | 9 months ago | Beginner |\n| [Change URI path and Host header](https://developers.cloudflare.com/rules/origin-rules/tutorials/change-uri-path-and-host-header/) | 10 months ago | Beginner |\n\n<page>\n---\ntitle: How to · Cloudflare Rules docs\ndescription: Use the following resources to accomplish specific goals in Page Rules.\nlastUpdated: 2025-08-20T20:59:04.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/rules/page-rules/how-to/\n  md: https://developers.cloudflare.com/rules/page-rules/how-to/index.md\n---\n\nUse the following resources to accomplish specific goals in Page Rules.\n\n* [URL forwarding with Page Rules](https://developers.cloudflare.com/rules/page-rules/how-to/url-forwarding/)\n\nConsider alternative [Rules](https://developers.cloudflare.com/rules/) options due to their enhanced configurability. Refer to the [migration guide](https://developers.cloudflare.com/rules/reference/page-rules-migration/) for details.\n\nFor more flexibility and customization, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n<page>\n---\ntitle: Manage Page Rules · Cloudflare Rules docs\ndescription: You can manage Page Rules in the Cloudflare dashboard or via API.\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/page-rules/manage/\n  md: https://developers.cloudflare.com/rules/page-rules/manage/index.md\n---\n\nYou can manage Page Rules in the Cloudflare dashboard or via API.\n\nConsider alternative [Rules](https://developers.cloudflare.com/rules/) options due to their enhanced configurability. Refer to the [migration guide](https://developers.cloudflare.com/rules/reference/page-rules-migration/) for details.\n\nFor more flexibility and customization, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n## Create a page rule\n\nTo create a page rule in the dashboard:\n\n1. In the Cloudflare dashboard, go to the **Page Rules** page.\n\n[Go to **Page Rules**](https://dash.cloudflare.com/?to=/:account/:zone/rules/page-rules)\n\n2. Select **Create Page Rule**.\n\n3. For **URL**, enter the URL or URL pattern that should match the rule ([more details about wildcard matching](https://developers.cloudflare.com/rules/page-rules/reference/wildcard-matching/)).\n\n4. For **Pick a Setting**, select a [Cloudflare setting](https://developers.cloudflare.com/rules/page-rules/reference/settings/) to adjust. If desired, select **Add a Setting** to adjust multiple Cloudflare settings with the same rule.\n\n5. In the **Order** dropdown, specify the desired order: *First, Last* or *Custom*.\n\n6. To save and deploy your rule, select **Save and Deploy Page Rule**. If you are not ready to deploy your rule, select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\nFor ideas about what rules you can create, refer to [recommended rules](https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/).\n\nTo create a page rule using the API, send a [`POST` request](https://developers.cloudflare.com/api/resources/page_rules/methods/create/).\n\nYou may also want to review the documentation on [wildcard matching](https://developers.cloudflare.com/rules/page-rules/reference/wildcard-matching/), [available settings](https://developers.cloudflare.com/rules/page-rules/reference/settings/), and [recommended rules](https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/).\n\n* Page Rules require a [proxied DNS record](https://developers.cloudflare.com/dns/proxy-status/) to work. Page Rules will not apply to subdomains that do not exist in DNS or are not being directed to Cloudflare.\n\n* Cloudflare does not support non-ASCII characters — such as punycode/unicode domain — in Page Rules. Instead, you could URL-encode the string using [Punycode converter](https://www.punycoder.com/).\n\nTo edit a page rule in the dashboard:\n\n1. In the Cloudflare dashboard, go to the **Page Rules** page.\n\n[Go to **Page Rules**](https://dash.cloudflare.com/?to=/:account/:zone/rules/page-rules)\n\n2. For a specific rule:\n\n* To enable or disable the rule, select the on/off toggle.\n     * To modify the URL pattern, settings, and order, select **Edit** (wrench icon). Then, enter the information you want to change.\n\nTo update one or more fields using the API, send a [`PATCH` request](https://developers.cloudflare.com/api/resources/page_rules/methods/edit/).\n\nTo entirely replace the configuration of a page rule, send a [`PUT` request](https://developers.cloudflare.com/api/resources/page_rules/methods/update/).\n\n## Delete a page rule\n\nTo delete a page rule in the dashboard:\n\n1. In the Cloudflare dashboard, go to the **Page Rules** page.\n\n[Go to **Page Rules**](https://dash.cloudflare.com/?to=/:account/:zone/rules/page-rules)\n\n2. For a specific rule, select **X**. Then, select **Delete**.\n\nTo delete a page rule using the API, send a [`DELETE` request](https://developers.cloudflare.com/api/resources/page_rules/methods/delete/).\n\n<page>\n---\ntitle: Reference · Cloudflare Rules docs\nlastUpdated: 2025-08-20T20:59:04.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/rules/page-rules/reference/\n  md: https://developers.cloudflare.com/rules/page-rules/reference/index.md\n---\n\n* [Additional reference for Page Rules](https://developers.cloudflare.com/rules/page-rules/reference/additional-reference/)\n* [Recommended page rules](https://developers.cloudflare.com/rules/page-rules/reference/recommended-rules/)\n* [Page Rules settings](https://developers.cloudflare.com/rules/page-rules/reference/settings/)\n* [Wildcard matching in Page Rules](https://developers.cloudflare.com/rules/page-rules/reference/wildcard-matching/)\n\nConsider alternative [Rules](https://developers.cloudflare.com/rules/) options due to their enhanced configurability. Refer to the [migration guide](https://developers.cloudflare.com/rules/reference/page-rules-migration/) for details.\n\nFor more flexibility and customization, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n<page>\n---\ntitle: Troubleshooting · Cloudflare Rules docs\ndescription: Use the following resources to help you troubleshoot issues with Page Rules.\nlastUpdated: 2025-08-20T20:59:04.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/rules/page-rules/troubleshooting/\n  md: https://developers.cloudflare.com/rules/page-rules/troubleshooting/index.md\n---\n\nUse the following resources to help you troubleshoot issues with Page Rules.\n\n* [Troubleshoot Page Rules - Billing and subscription](https://developers.cloudflare.com/rules/page-rules/troubleshooting/billing-and-subscription/)\n* [Troubleshoot Page Rules - General](https://developers.cloudflare.com/rules/page-rules/troubleshooting/general/)\n\nConsider alternative [Rules](https://developers.cloudflare.com/rules/) options due to their enhanced configurability. Refer to the [migration guide](https://developers.cloudflare.com/rules/reference/page-rules-migration/) for details.\n\nFor more flexibility and customization, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n<page>\n---\ntitle: Deprecation notice for Edge Side Code · Cloudflare Rules docs\ndescription: Edge Side Code (ESC) is now deprecated. All configurations\n  currently done via ESC are currently being removed. If you are still using\n  ESC, you will need to configure other Cloudflare products to replace your\n  current ESC configuration before this date.\nlastUpdated: 2025-09-08T13:42:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/reference/esc-deprecation/\n  md: https://developers.cloudflare.com/rules/reference/esc-deprecation/index.md\n---\n\n**Edge Side Code (ESC) is now deprecated.** All configurations currently done via ESC are currently being removed. If you are still using ESC, you will need to configure other Cloudflare products to replace your current ESC configuration before this date.\n\nEdge Side Code was a customization option used by several Enterprise customers that allowed for more configurability of Cloudflare's global network features. This code could alter the behavior of Cloudflare's CDN, enabling logic for specific customer use cases. Currently, a few customers have ESC in place to perform special operations such as advanced header manipulation, host header switching.\n\n## Will this deprecation affect my account?\n\nIf your account is still using ESC, you will need to complete your migration to other Cloudflare products.\n\n## Which Cloudflare products should I use instead?\n\nThe following table contains recommendations for different use cases of ESC:\n\n| Use case | Description | Alternative |\n| - | - | - |\n| Redirect to URL | Navigate visitors to a different URL without sending the request to the origin server. | Use [Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/) or [Bulk Redirects](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/). |\n| Rewrite SNI | Override the hostname used for TLS SNI when connecting to the origin server. | Use [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/features/#server-name-indication-sni) to override the Server Name Indication (SNI) value of a request. Cloudflare for SaaS customers can perform SNI rewrites via [custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/#sni-rewrites). |\n| Resolve override | Override the resolved hostname used to reach the origin server. | Use [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/features/#dns-record) to override the resolved hostname of incoming requests. |\n| Rewrite URI | Request a different URL from the origin server while displaying the original request URL in the visitor's browser. | Use [Transform Rules](https://developers.cloudflare.com/rules/transform/url-rewrite/) to rewrite URLs. |\n| Set/clear request headers | Set (or clear) HTTP headers sent to the origin server. | Use [Transform Rules](https://developers.cloudflare.com/rules/transform/request-header-modification/) to modify request headers. |\n| Feature exceptions | Exclude specific requests from one or more Cloudflare security products. | Use [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/settings/). |\n| Send custom error response | Abort the current request, returning a specific response body and/or HTTP status code to the client. | Use [Custom Error Responses](https://developers.cloudflare.com/rules/custom-errors/) to define custom responses for errors returned by an origin server or by a Cloudflare product (including Workers). |\n| Set/add/remove response headers | Update, add, or remove headers from the response returned by the origin server. | Use [Transform Rules](https://developers.cloudflare.com/rules/transform/response-header-modification/) to modify response headers. |\n| Status redirect | After receiving a response from the origin, conditionally send a redirect back to the client if the origin response code matches a key in the supplied table. | Use [Cloudflare Workers](https://developers.cloudflare.com/workers/). Refer to the [Modify response](https://developers.cloudflare.com/workers/examples/modify-response/) example for a similar use case. |\n| Add cookies to response | Set cookies in the response sent to the client. | Use [Transform Rules](https://developers.cloudflare.com/rules/transform/response-header-modification/) to modify response headers (which includes setting cookies). |\n\nFor more complex use cases, consider using [Cloudflare Workers](https://developers.cloudflare.com/workers/).\n\n## Can I disable ESC right now to understand the deprecation impact?\n\nYes, you can [disable ESC via API](#disabling-esc-via-api). The API allows you to:\n\n* Understand the impact of disabling ESC on your account or zone.\n* Test your alternative configuration with other Cloudflare products (and with ESC disabled) before the sunset date.\n\n## What kind of tests can I run?\n\nThe [available API operations](#api-operations) allow you to do the following:\n\n* **Disable ESC for individual requests:** Any test requests containing a cookie with a specific secret will be processed with ESC disabled.\n* **Disable/enable ESC for a specific zone:** After disabling ESC for a zone, all incoming requests for the zone will have all ESC configurations disabled.\n* **Disable/enable ESC for an entire account**: After disabling ESC for an account, all incoming requests for any zone in the account will have all ESC configurations disabled.\n\n## What is the recommended testing strategy?\n\nCloudflare recommends that you start doing tests using individual HTTP requests, to make sure the triggered rules and the response you get match your expectations.\n\nStart by [configuring a secret](#create-esc-secret-for-a-zone) and including it in a request cookie to disable ESC for specific requests.\n\nIf these tests are successful, [disable ESC for the entire zone](#disable-esc-for-a-zone). Perform some additional tests to make sure that your configuration with ESC disabled performs as intended. If you detect any issues, [re-enable ESC for the zone](#re-enable-esc-for-a-zone).\n\nIf you wish, you can also [disable ESC for an entire account](#disable-esc-for-an-account). This will affect all incoming requests for all zones in your account.\n\n## Disabling ESC via API\n\nThe available API operations allow you to disable ESC for an account/zone and re-enable ESC in a few seconds and in self-service mode.\n\nYou can also configure a secret to perform per-request tests without changing the ESC status (disabled or enabled) for account or zone. Use this feature to check if the appropriate rules are being triggered and if the request/response matches your expectations.\n\nTo disable/enable ESC for individual requests, do the following:\n\n1. Create a secret (up to 100 characters) using the [Create ESC secret for a zone](#create-esc-secret-for-a-zone) or [Create ESC secret for an account](#create-esc-secret-for-an-account) operation.\n\n2. Include the secret in your test requests using a cookie named `disable_esc`. This will only disable ESC for these test requests addressed at your zone or account, according to the endpoint scope you used in the previous step (zone or account). The following example HTTP request header defines a cookie for disabling ESC for the current request:\n\n`Cookie: disable_esc=<SECRET>`\n\nTo change the ESC status for a zone, use the following operations:\n\n* [Disable ESC for a zone](#disable-esc-for-a-zone)\n* [Re-enable ESC for a zone](#re-enable-esc-for-a-zone)\n\nTo change the ESC status for an account, use the following operations:\n\n* [Disable ESC for an account](#disable-esc-for-an-account)\n* [Re-enable ESC for an account](#re-enable-esc-for-an-account)\n\n| Name | HTTP verb | Endpoint |\n| - | - | - |\n| Get ESC secret or status for a zone | GET | `/zones/{zone_id}/disable_esc` |\n| Create ESC secret for a zone | POST | `/zones/{zone_id}/disable_esc` |\n| Disable ESC for a zone | POST | `/zones/{zone_id}/disable_esc` |\n| Re-enable ESC for a zone | DELETE | `/zones/{zone_id}/disable_esc` |\n| Get ESC secret or status for an account | GET | `/accounts/{account_id}/disable_esc` |\n| Create ESC secret for an account | POST | `/accounts/{account_id}/disable_esc` |\n| Disable ESC for an account | POST | `/accounts/{account_id}/disable_esc` |\n| Re-enable ESC for an account | DELETE | `/accounts/{account_id}/disable_esc` |\n\nTo invoke an API operation, append the operation endpoint to the Cloudflare API base URL:\n\n#### Get ESC status for a zone\n\nThis example obtains the current status of the **Disable ESC** setting for the specified zone. The same endpoint will return the currently configured ESC secret for the zone, if configured.\n\nThe following example response states that ESC is disabled for the entire `$ZONE_ID` zone:\n\nThe following example response includes the previously configured secret for the zone using the [Create ESC secret for a zone](#create-esc-secret-for-a-zone) operation:\n\n#### Create ESC secret for a zone\n\nThis `POST` request example configures an ESC secret for disabling ESC in specific requests for the `$ZONE_ID` zone, setting the secret to `MySecretString321#`.\n\nThe maximum secret length is 100 characters.\n\nTo use the secret, include a cookie named `disable_esc` with the secret value in any requests for which you want to have ESC disabled:\n\nThis will only disable ESC for the request that includes the cookie.\n\n#### Disable ESC for a zone\n\nThis `POST` request example disables ESC for all incoming requests of `$ZONE_ID` zone.\n\n#### Re-enable ESC for a zone\n\nThis example re-enables ESC for the `$ZONE_ID` zone.\n\n#### Get ESC status for an account\n\nThis example obtains the current status of **Disable ESC** setting for the specified account. The same endpoint will return the currently configured ESC secret for the account, if configured.\n\nThe following example response states that ESC is disabled for the entire `$ACCOUNT_ID` account:\n\nThe following example response includes the previously configured secret for the account using the [Create ESC secret for an account](#create-esc-secret-for-an-account) operation:\n\n#### Create ESC secret for an account\n\nThis example configures an ESC secret for disabling ESC in specific requests for the `$ACCOUNT_ID` account, setting the secret to `MySecretString321#`.\n\nThe maximum secret length is 100 characters.\n\nTo use the secret, include a cookie named `disable_esc` with the secret value in any requests for which you want to have ESC disabled:\n\nThis will only disable ESC for the request that includes the cookie.\n\n#### Disable ESC for an account\n\nThis `POST` request example disables ESC for all incoming requests of `$ACCOUNT_ID` account.\n\n#### Re-enable ESC for an account\n\nThis example re-enables ESC for the `$ACCOUNT_ID` account.\n\nSome configurations currently done using ESC will not be directly available in any other Cloudflare product. In this rare situation, Cloudflare will discontinue the custom behavior currently obtained through ESC and work with you to help you understand alternative solutions for your use cases.\n\n<page>\n---\ntitle: Rules language · Cloudflare Rules docs\nlastUpdated: 2024-09-06T15:21:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/reference/link-rule-language/\n  md: https://developers.cloudflare.com/rules/reference/link-rule-language/index.md\n---\n\n<page>\n---\ntitle: Page Rules migration guide · Cloudflare Rules docs\ndescription: Cloudflare is continuously improving its platform to deliver more\n  powerful and scalable tools for managing your configurations. To help you take\n  full advantage of these improvements, we recommend using modern Rules features\n  for new implementations. These products address the limitations of Page Rules\n  while providing greater flexibility, scalability, and ease of use.\nlastUpdated: 2025-12-05T14:20:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/reference/page-rules-migration/\n  md: https://developers.cloudflare.com/rules/reference/page-rules-migration/index.md\n---\n\nCloudflare is continuously improving its platform to deliver more powerful and scalable tools for managing your configurations. To help you take full advantage of these improvements, we recommend using [modern Rules features](https://developers.cloudflare.com/rules/) for new implementations. These products address the limitations of Page Rules while providing greater flexibility, scalability, and ease of use.\n\nFor a quick start, explore the one-click templates available in the Cloudflare dashboard in **Rules** > **Overview**. These templates simplify common configurations like redirects, rewrites and header modifications, making setup faster and easier.\n\n## Page Rules migration\n\nTo make the transition seamless, Cloudflare will handle the migration of your existing Page Rules automatically. This process is planned for late 2025 or beyond, with no action required on your part. You will receive advance notification before any changes are made.\n\nIf you wish to explore the benefits of modern Rules features sooner, you can begin adopting them today. Doing so allows you to:\n\n* Take advantage of modern features and capabilities sooner.\n* Customize and refine your rules to match your evolving needs.\n\nTo assist with this process, we provide you with a comprehensive mapping between Page Rules settings and modern Rules products in this guide.\n\nCloudflare Page Rules has several fundamental limitations, such as triggering solely based on URL patterns and being limited to 125 rules per zone for performance reasons. These rules are also complex to debug when multiple page rules apply to the same incoming request.\n\nIn 2022, we announced in our blog post [The future of Page Rules](https://blog.cloudflare.com/future-of-page-rules) that Page Rules would be replaced with a suite of dedicated products, each built to be best-of-breed and put more power into the hands of our users. The new Rules products — [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/), [Compression Rules](https://developers.cloudflare.com/rules/compression-rules/), [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/), [Redirects](https://developers.cloudflare.com/rules/url-forwarding/), and [Transform Rules](https://developers.cloudflare.com/rules/transform/) — are now generally available (GA) and have already been adopted by tens of thousands of Cloudflare customers.\n\nImprovements in modern Rules features include:\n\n* **New engine**: New Rules features are powered by the [Ruleset Engine](https://developers.cloudflare.com/ruleset-engine/), which offers versatile configuration with a robust language that supports many HTTP request and response fields.\n* **Improved scalability**: Thanks to the improved scalability, Cloudflare plans now have increased quotas.\n* **Easier troubleshooting**: Rule execution is more predictable, since each rule operates independently, simplifying troubleshooting. Additionally, [Cloudflare Trace](https://developers.cloudflare.com/rules/trace-request/) helps understand rule interactions.\n* **Improved consistency**: New Rules features also ensure consistency, with common fields and capabilities shared across products, offering a seamless experience and predictable Terraform configurations.\n\nThe evaluation and execution order of Rules features is different from Page Rules:\n\n* **Rule matching logic**: Page Rules apply the first matching rule (first match wins). In contrast, modern Rules are stackable, meaning multiple matching rules can combine and apply to the same request (last match wins). For example, if multiple cache rules match the same URL, the features in those rules will all apply in order.\n* **Action separation**: A Page Rule may include multiple actions for different products that are applied in a sequence selected by the customer within the Page Rule itself. Modern Rules features are evaluated [in a fixed sequence](https://developers.cloudflare.com/rules/origin-rules/#execution-order), with customers defining the rule order within a product [phase](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/).\n* **Precedence**: Modern Rules features take precedence over Page Rules. For instance, if both define caching settings for the same path, Cache Rules will override Page Rules.\n* **Caching behavior**: In Cache Rules, selecting **Eligible for cache** automatically enables **Cache Everything** by default. To maintain the exact behavior of Page Rules, you may need to [adjust your configuration](https://developers.cloudflare.com/cache/how-to/cache-rules/page-rules-migration/).\n* **Interactions with Workers**: Requests handled by Workers will suppress Page Rules actions, but they will not suppress actions from modern Rules features.\n\n## Convert Page Rules URLs to filter expressions\n\nModern Rules use filter expressions instead of URL patterns. These expressions, built with the Rules language, allow greater precision by leveraging [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/), [functions](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/), and [operators](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/).\n\nThe following example demonstrates the use of the [`http.request.full_uri`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.full_uri/) field and the `wildcard` operator for [wildcard matching](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching):\n\nA **Page Rules URL** like:\n\n`example.com/*/downloads/*.txt`\n\nbecomes a **filter expression** such as:\n\n`http.request.full_uri wildcard \"http*://example.com/*/downloads/*.txt*\"`\n\n[Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) and [URL Rewrite Rules](https://developers.cloudflare.com/rules/transform/url-rewrite/create-dashboard/) also offer a simplified view called **Wildcard pattern**, allowing you to specify URL patterns (`http*://example.com/*/downloads/*.txt*`) without specifying the full filter expression (`http.request.full_uri wildcard \"http*://example.com/*/downloads/*.txt*\"`).\n\n### Important considerations\n\n* **Protocol scheme**: Page Rules URL matching does not include the URI scheme (for example, `http://` or `https://`) unless explicitly included in the rule. Filter expressions using `http.request.full_uri` field, however, require matching the full URI, including the protocol scheme. To make your filter expression scheme-agnostic, use `http*://` as a wildcard for both `http://` and `https://`.\n* **Query strings**: Page Rules ignore query strings unless they are part of the rule URL. Filter expressions include the query string automatically, as part of the `http.request.full_uri` field. To ensure query strings do not affect your matching, append a `*` wildcard at the end of your filter expression, such as `.txt*`.\n\n## Feature correspondence table\n\nTo help you map existing Page Rules to modern Rules products, this table outlines how Page Rules settings translate to modern Rules and provides examples for common configurations.\n\nAlso, to streamline common configurations, the Cloudflare dashboard now includes dozens of one-click templates, available in **Rules** > **Overview**. These templates enable you to deploy commonly used features — such as redirects, rewrites, and header modifications — instantly, with pre-filled filter expressions and actions. Explore these templates in the dashboard for a faster setup.\n\n| Page Rules setting | New implementation uses... | Migration/Replacement instructions |\n| - | - | - |\n| Always Use HTTPS | Redirect Rules (Single Redirects) | [Migrate Always Use HTTPS](#migrate-always-use-https) |\n| Browser Cache TTL | Cache Rules | [Migrate Browser Cache TTL](#migrate-browser-cache-ttl) |\n| Browser Integrity Check | Configuration Rules | [Migrate Browser Integrity Check](#migrate-browser-integrity-check) |\n| Bypass Cache on Cookie | Cache Rules | [Migrate Bypass Cache on Cookie](#migrate-bypass-cache-on-cookie) |\n| Cache By Device Type | Cache Rules | [Migrate Cache By Device Type](#migrate-cache-by-device-type) |\n| Cache Deception Armor | Cache Rules | [Migrate Cache Deception Armor](#migrate-cache-deception-armor) |\n| Cache Level | Cache Rules | [Migrate Cache Level](#migrate-cache-level-cache-everything) |\n| Cache on Cookie | Cache Rules | [Migrate Cache on Cookie](#migrate-cache-on-cookie) |\n| Cache TTL by status code | Cache Rules | [Migrate Cache TTL by status code](#migrate-cache-ttl-by-status-code) |\n| Custom Cache Key | Cache Rules | [Migrate Custom Cache Key](#migrate-custom-cache-key) |\n| Disable Apps | Configuration Rules | [Migrate Disable Apps](#migrate-disable-apps) |\n| Disable Performance | N/A (deprecated) | [Replace Disable Performance](#replace-disable-performance) |\n| Disable Railgun | N/A (deprecated) | N/A |\n| Disable Security | N/A (deprecated) | [Replace Disable Security](#replace-disable-security) |\n| Disable Zaraz | Configuration Rules | [Migrate Disable Zaraz](#migrate-disable-zaraz) |\n| Edge Cache TTL | Cache Rules | [Migrate Edge Cache TTL](#migrate-edge-cache-ttl) |\n| Email Obfuscation | Configuration Rules | [Migrate Email Obfuscation](#migrate-email-obfuscation) |\n| Forwarding URL | Redirect Rules (Single Redirects) | [Migrate Forwarding URL](#migrate-forwarding-url) |\n| Host Header Override | Origin Rules | [Migrate Host Header Override](#migrate-host-header-override) |\n| IP Geolocation Header | Transform Rules (Managed Transforms) | [Migrate IP Geolocation Header](#migrate-ip-geolocation-header) |\n| Mirage (deprecated) | Configuration Rules | [Migrate Mirage](#migrate-mirage) |\n| Opportunistic Encryption | Configuration Rules | [Migrate Opportunistic Encryption](#migrate-opportunistic-encryption) |\n| Origin Cache Control | Cache Rules | [Migrate Origin Cache Control](#migrate-origin-cache-control) |\n| Origin Error Page Pass-thru | Cache Rules | [Migrate Origin Error Page Pass-thru](#migrate-origin-error-page-pass-thru) |\n| Polish | Configuration Rules | [Migrate Polish](#migrate-polish) |\n| Query String Sort | Cache Rules | [Migrate Query String Sort](#migrate-query-string-sort) |\n| Resolve Override | Origin Rules | [Migrate Resolve Override](#migrate-resolve-override) |\n| Respect Strong ETags | Cache Rules | [Migrate Respect Strong ETags](#migrate-respect-strong-etags) |\n| Response Buffering | N/A (deprecated) | N/A |\n| Rocket Loader | Configuration Rules | [Migrate Rocket Loader](#migrate-rocket-loader) |\n| Security Level | Configuration Rules | [Migrate Security Level](#migrate-security-level) |\n| True Client IP Header | Transform Rules (Managed Transforms) | [Migrate True Client IP Header](#migrate-true-client-ip-header) |\n| SSL | Configuration Rules | [Migrate SSL](#migrate-ssl) |\n| Web Application Firewall | N/A (deprecated) | N/A |\n\n### Migrate Always Use HTTPS\n\nYou configured a Page Rule to perform an automatic redirect from HTTP to HTTPS for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL** `*example.com/*`\n  * **Setting**: *Always Use HTTPS*\n\n1. [Create a single redirect](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) to always redirect HTTP requests to HTTPS. You can select the **Redirect from HTTP to HTTPS** rule template or enter the following rule configuration:\n\n* **If incoming requests match**: Wildcard pattern\n       * **Request URL**: `http://*`\n\n* **Target URL**: `https://${1}`\n       * **Status code**: *301*\n       * **Preserve query string**: Enabled\n\n2. Turn off your existing Page Rule and validate the behavior of the redirect you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a single redirect |\n  | - | - |\n  | ![Example Page Rule with 'Always Use HTTPS' setting](https://developers.cloudflare.com/_astro/pr-always-use-https.CUl_pNfb_ZgNVzQ.webp) | ![Single redirect matching the 'Always Use HTTPS' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-always-use-https-new.BOryxIv0_Z1PXopK.webp) |\n\n### Migrate Automatic HTTPS Rewrites\n\nYou configured a Page Rule turning on Automatic HTTPS Rewrites for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Automatic HTTPS Rewrites*\n  * **Value**: On\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to always rewrite HTTP links to HTTPS for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n\n* **Setting**: Automatic HTTPS Rewrites\n       * **Value**: On\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Automatic HTTPS Rewrites' setting](https://developers.cloudflare.com/_astro/pr-automatic-https-rewrites.CLJyVtYV_16kmu8.webp) | ![Configuration rule matching the 'Automatic HTTPS Rewrites' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-automatic-https-rewrites-new.Bkd1FpXw_Z1ystiY.webp) |\n\n### Migrate Browser Cache TTL\n\nYou configured a Page Rule adjusting browser cache TTL to one day for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Browser Cache TTL*\n  * **Enter Browser Cache TTL**: *a day*\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to adjust browser cache TTL for caching resources in the browser to one day for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Browser TTL**: Override origin and use this TTL\n       * **Input time-to-live (TTL)**: *1 day*\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Browser Cache TTL' setting](https://developers.cloudflare.com/_astro/pr-browser-cache-ttl.BsUhcEXO_1F769k.webp) | ![Cache rule matching the 'Browser Cache TTL' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-browser-cache-ttl-new.CFYgSIfM_Z4vWT2.webp) |\n\n### Migrate Browser Integrity Check\n\nYou configured a Page Rule turning on Browser Integrity Check for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Browser Integrity Check*\n  * **Value**: On\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn on Browser Integrity Check for protecting against bots and threats for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n\n* **Setting**: Browser Integrity Check\n       * **Value**: On\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Browser Integrity Check' setting](https://developers.cloudflare.com/_astro/pr-browser-integrity-check.0TsdxTXD_1JWmeD.webp) | ![Configuration rule matching the 'Browser Integrity Check' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-browser-integrity-check-new.DABehTnG_1IIURY.webp) |\n\n### Migrate Bypass Cache on Cookie\n\nYou configured a Page Rule turning on Bypass Cache on Cookie for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Bypass Cache on Cookie*\n  * **Enter value**: `test_cookie`\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to bypass cache for requests containing cookie `test_cookie` for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\" AND Cookie contains \"test-cookie\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\" and http.cookie contains \"test-cookie\")`\n\n* **Then**:\n       * **Cache eligibility**: Bypass cache\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Bypass Cache on Cookie' setting](https://developers.cloudflare.com/_astro/pr-bypass-cache-on-cookie.h4Mq0pkO_21nXKe.webp) | ![Cache rule matching the 'Bypass Cache on Cookie' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-bypass-cache-on-cookie-new.BeJb7-Bu_2pBuYI.webp) |\n\n### Migrate Cache By Device Type\n\nYou configured a Page Rule turning on Cache By Device Type for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Cache By Device Type*\n  * **Value**: On\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to cache content based on user agent or device type for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Cache key\n         * **Cache by device type**: On\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Cache By Device Type' setting](https://developers.cloudflare.com/_astro/pr-cache-by-device-type.D_TlBAdc_Z1tXrQI.webp) | ![Cache rule matching the 'Cache By Device Type' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-cache-by-device-type-new.j6a5kEn__ZNQIPx.webp) |\n\n### Migrate Cache Deception Armor\n\nYou configured a Page Rule turning on Cache Deception Armor for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: Cache Deception Armor\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to protect against cache deception attacks for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Cache key\n         * **Cache deception armor**: On\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Cache Deception Armor' setting](https://developers.cloudflare.com/_astro/pr-cache-deception-armor.CAh-wrs4_Z1y7Xtq.webp) | ![Cache rule matching the 'Cache Deception Armor' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-cache-deception-armor-new.BT9l5EUw_Z21H50k.webp) |\n\n### Migrate Cache Level (Cache Everything)\n\nYou configured a Page Rule turning on caching of all assets for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Cache Level*\n  * **Select Cache Level**: *Cache Everything*\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to adjust cache level for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then**:\n       * **Cache eligibility**: Eligible for cache\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Cache Level' set to 'Cache Everything'](https://developers.cloudflare.com/_astro/pr-cache-level-everything.DdVHSP6R_10sQCU.webp) | ![Cache rule matching the 'Cache Level: Cache Everything' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-cache-level-everything-new.CWHQUlgp_2ejSU5.webp) |\n\n### Migrate Cache on Cookie\n\nYou configured a Page Rule turning on caching for responses that contained cookie `test-cookie` for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Cache on Cookie*\n  * **Enter value**: `test-cookie`\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to cache responses containing cookie `test_cookie` for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\" AND Cookie contains \"test-cookie\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\" and http.cookie contains \"test-cookie\")`\n\n* **Then**:\n       * **Cache eligibility**: Eligible for cache\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Cache on Cookie' setting](https://developers.cloudflare.com/_astro/pr-cache-on-cookie.ByvIqgIj_Z1sNNc8.webp) | ![Cache rule matching the 'Cache on Cookie' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-cache-on-cookie-new.PWLmyHmb_Z1tlA4i.webp) |\n\n### Migrate Cache TTL by status code\n\nYou configured a Page Rule turning on caching of every response with status code between `200` and `599` for one day, for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Cache TTL by status code*\n  * **Status code or enter range**: `200-599`\n  * **Select option**: *a day*\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to cache responses with status code between `200` and `599` for one day for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n\n* Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n\n* **Setting**: Edge TTL\n\n* Use cache-control header if present, use default Cloudflare caching behavior if not\n\n* **Status code TTL**:\n\n* **Scope**: *Range*\n             * **From**: *200*\n             * **To**: *599*\n             * **Duration**: *1 day*\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with the 'Cache TTL by status code' setting](https://developers.cloudflare.com/_astro/pr-cache-ttl-by-status-code.BEFPIQlk_Z1AMyjN.webp) | ![Cache rule matching the 'Cache TTL by status code' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-cache-ttl-by-status-code-new.D7fRKD4K_1XqnnT.webp) |\n\n### Migrate Custom Cache Key\n\nYou configured a Page Rule setting a custom cache key for all query string parameters, for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Custom Cache Key*\n    * **Query String**: All query string parameters\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to set a custom cache key for all query string parameters, for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Cache key\n         * **Query string**: All query string parameters\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with the 'Custom Cache Key' setting](https://developers.cloudflare.com/_astro/pr-custom-cache-key.B4mIYhPL_Z1mAxa6.webp) | ![Cache rule matching the 'Custom Cache Key' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-custom-cache-key-new.Cgx92M0b_ZzTcjR.webp) |\n\n### Migrate Disable Apps\n\nYou configured a Page Rule turning off Cloudflare Apps (deprecated) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Disable Apps*\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to disable Cloudflare Apps (deprecated) for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Disable Apps\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Disable Apps' setting](https://developers.cloudflare.com/_astro/pr-disable-apps.DtWuKgu3_Z1dKx7E.webp) | ![Configuration rule matching the 'Disable Apps' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-disable-apps-new.D0ZGFzGR_Zrxgvi.webp) |\n\n### Replace Disable Performance\n\nThe **Disable Performance** setting is deprecated. Any Page Rules with this setting will not be migrated.\n\nThis Page Rules setting turned off Mirage (deprecated), Polish, and Rocket Loader. You can still turn on or off relevant Cloudflare features one by one using Configuration Rules.\n\nYou configured a Page Rule with **Disable Performance** (deprecated) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Disable Performance*\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to disable Mirage, Polish, and Rocket Loader for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n\n* **Mirage**: Off\n       * **Polish**: *Off*\n       * **Rocket Loader**: Off\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Disable Performance' setting](https://developers.cloudflare.com/_astro/pr-disable-performance.Q-fOmuUU_60ytE.webp) | ![Configuration rule partially matching the 'Disable Performance' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-disable-performance-new.DL9beJ7__ZdPHK.webp) |\n\n### Replace Disable Security\n\nThe **Disable Security** setting is deprecated. Any Page Rules with this setting will not be migrated.\n\nThis Page Rules setting turns off Email Obfuscation, Rate Limiting (previous version), Scrape Shield, URL (Zone) Lockdown, and WAF managed rules (previous version). You can still turn on or off relevant Cloudflare features one by one using Configuration Rules and WAF custom rules.\n\nYou configured a Page Rule with **Disable Security** (deprecated) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Disable Security*\n\nThis setting turned off a subset of Cloudflare security features: Email Obfuscation, Rate Limiting (previous version), Scrape Shield, URL (Zone) Lockdown, and WAF managed rules (previous version).\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off one or more security features:\n\n* Email Obfuscation (part of [Cloudflare Scrape Shield](https://developers.cloudflare.com/waf/tools/scrape-shield/))\n     * Hotlink Protection (part of Cloudflare Scrape Shield)\n\n2. If required, [create a WAF exception](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/define-dashboard/) to skip one or more rules of WAF managed rulesets for requests coming from IP addresses in an allowlist.\n\n3. Turn off your existing Page Rule and validate the behavior of the rules you created.\n\n4. If your tests succeed, delete the existing Page Rule.\n\nIf you are still using [WAF managed rules (previous version)](https://developers.cloudflare.com/waf/reference/legacy/old-waf-managed-rules/) or [Rate Limiting (previous version)](https://developers.cloudflare.com/waf/reference/legacy/old-rate-limiting/), consider upgrading to the new versions of these products. It is not possible to turn off these older products using modern Rules features.\n\n### Migrate Disable Zaraz\n\nYou configured a Page Rule turning off [Zaraz](https://developers.cloudflare.com/zaraz/) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Disable Zaraz*\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Zaraz for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Disable Zaraz\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Disable Zaraz' setting](https://developers.cloudflare.com/_astro/pr-disable-zaraz.BO7qA0TE_ZnsgKi.webp) | ![Configuration rule matching the 'Disable Zaraz' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-disable-zaraz-new.Cc92OsIN_Z6Ica7.webp) |\n\n### Migrate Edge Cache TTL\n\nYou configured a Page Rule adjusting Edge Cache TTL for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Edge Cache TTL*\n  * **Enter Edge Cache TTL**: *a day*\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to adjust edge cache TTL for caching resources on Cloudflare edge to one day, for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n\n* **Setting**: Edge TTL\n\n* Ignore cache-control header and use this TTL\n         * **Input time-to-live (TTL)**: *1 day*\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with the 'Edge Cache TTL' setting](https://developers.cloudflare.com/_astro/pr-edge-cache-ttl.DdpuJjjM_Z1WW60v.webp) | ![Cache rule matching the 'Edge Cache TTL' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-edge-cache-ttl-new.CASDurRT_2oX2AI.webp) |\n\n### Migrate Email Obfuscation\n\nYou configured a Page Rule turning off [Email Obfuscation](https://developers.cloudflare.com/waf/tools/scrape-shield/email-address-obfuscation/) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Email Obfuscation*\n  * **Value**: Off\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Email Obfuscation for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Email Obfuscation\n         * **Value**: Off\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Email Obfuscation' setting](https://developers.cloudflare.com/_astro/pr-email-obfuscation.B5bsi7dl_2nDP9z.webp) | ![Configuration rule matching the 'Email Obfuscation > Off' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-email-obfuscation-new.CV0JNmIj_Z12WwPn.webp) |\n\n### Migrate Forwarding URL\n\n**Example #1: Redirect `www` to root domain**\n\nYou configured a Page Rule permanently redirecting `www.example.com` to `example.com` on all URI paths:\n\n* **URL**: `www.example.com/*`\n  * **Setting**: *Forwarding URL*\n  * **Select Status code**: *301 - Permanent Redirect*\n  * **Destination URL**: `https://example.com/$1`\n\n1. [Create a single redirect](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) to permanently redirect requests from `https://www.example.com` to `https://example.com`. You can select the **Redirect from WWW to Root** rule template or enter the following rule configuration:\n\n* **If incoming requests match**: Wildcard pattern\n       * **Request URL**: `https://www.example.com/*`\n\n* **Target URL**: `https://example.com/${1}`\n       * **Status code**: *301*\n       * **Preserve query string**: Enabled\n\n2. Turn off your existing Page Rule and validate the behavior of the redirect you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\nNotes about the rule equivalence\n\nThe provided example using Single Redirects is not an exact match for the previously existing Page Rule in the same example.\n\nThe exact equivalent would need to match both HTTP and HTTPS incoming requests, which you could achieve using a wildcard pattern like the following (notice the extra `*` after `http`):\n\n* **Request URL**: `http*://www.example.com/*`\n\nThis would require you to also change the **Target URL** to use the second wildcard capture group instead of the first one (corresponding to the text captured by second `*` in the wildcard pattern above):\n\n* **Target URL**: `https://example.com/${2}`\n\n| Page Rules configuration | Migrate to a single redirect |\n  | - | - |\n  | ![Example Page Rule #1 with 'Forwarding URL' setting](https://developers.cloudflare.com/_astro/pr-forwarding-url.DyV2zs8N_Z7hQWe.webp) | ![Single redirect matching the 'Forwarding URL' setting of the example Page Rule #1](https://developers.cloudflare.com/_astro/pr-forwarding-url-new.FfZIMpof_1up4Y2.webp) |\n\n**Example #2: Redirect all pages under old path to new path**\n\nYou configured a Page Rule permanently redirecting `example.com/old-path` to `example.com/new-path`:\n\n* **URL**: `example.com/old-path/*`\n  * **Setting**: *Forwarding URL*\n  * **Select Status code**: *301 - Permanent Redirect*\n  * **Destination URL**: `https://example.com/new-path/$1`\n\n1. [Create a single redirect](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) to permanently redirect requests for `example.com/old-path` to `example.com/new-path`:\n\n* **If incoming requests match**: Wildcard pattern\n       * **Request URL**: `https://example.com/old-path/*`\n\n* **Target URL**: `https://example.com/new-path/${1}`\n       * **Status code**: *301*\n       * **Preserve query string**: Enabled\n\n2. Turn off your existing Page Rule and validate the behavior of the redirect you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\nNotes about the rule equivalence\n\nThe provided example using Single Redirects is not an exact match for the previously existing Page Rule in the same example.\n\nThe exact equivalent would need to match both HTTP and HTTPS incoming requests, which you could achieve using a wildcard pattern like the following (notice the extra `*` after `http`):\n\n* **Request URL**: `http*://example.com/old-path/*`\n\nThis would require you to also change the **Target URL** to use the second wildcard capture group instead of the first one (corresponding to the text captured by second `*` in the wildcard pattern above):\n\n* **Target URL**: `https://example.com/new-path/${2}`\n\n| Page Rules configuration | Migrate to a single redirect |\n  | - | - |\n  | ![Example Page Rule #2 with 'Forwarding URL' setting](https://developers.cloudflare.com/_astro/pr-forwarding-url-2.CNt6YZ_U_ZubTyR.webp) | ![Single redirect matching the 'Forwarding URL' setting of the example Page Rule #2](https://developers.cloudflare.com/_astro/pr-forwarding-url-2-new.CP3zl46U_Z1dDz5U.webp) |\n\n### Migrate Host Header Override\n\nYou configured a Page Rule changing the `Host` HTTP header to `example.saas-provider.com`, for all requests addressed at any subdomain of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Host Header Override*\n  * **Enter value**: `example.saas-provider.com`\n\n1. [Create an origin rule](https://developers.cloudflare.com/rules/origin-rules/create-dashboard/) changing the `Host` header to `example.saas-provider.com` for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then**:\n       * **Set origin parameters**:\n         * **Host Header** > **Rewrite to**: `example.saas-provider.com`\n\n2. Turn off your existing Page Rule and validate the behavior of the origin rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to an origin rule |\n  | - | - |\n  | ![Example Page Rule with 'Host Header Override' setting](https://developers.cloudflare.com/_astro/pr-host-header-override.BXq8XNIs_ZxEPQ9.webp) | ![Origin rule matching the 'Host Header Override' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-host-header-override-new.DUASGBHN_1FgVbV.webp) |\n\n### Migrate IP Geolocation Header\n\nYou configured a Page Rule adding a `CF-IPCountry` HTTP header, for all requests addressed at any subdomain of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *IP Geolocation Header*\n  * **Value**: On\n\n1. [Turn on the **Add visitor location headers** Managed Transform](https://developers.cloudflare.com/rules/transform/managed-transforms/configure/) — a Transform Rules feature — to add the `CF-IPCountry` and other location headers to all requests.\n  2. Turn off your existing Page Rule and validate the behavior of the Managed Transform.\n  3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a Managed Transform |\n  | - | - |\n  | ![Example Page Rule with 'IP Geolocation Header' setting](https://developers.cloudflare.com/_astro/pr-ip-geolocation-header._es904nB_2lU1sj.webp) | ![The 'Add visitor location headers' Managed Transform matching the 'IP Geolocation Header' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-ip-geolocation-header-new.D3CE9V7z_HdV93.webp) |\n\n### Migrate Mirage (deprecated)\n\nYou configured a Page Rule turning off Mirage (deprecated) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Mirage*\n  * **Value**: Off\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Mirage for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Mirage\n         * **Value**: Off\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Mirage' setting](https://developers.cloudflare.com/_astro/pr-mirage.pHLFHQcL_Z1pN423.webp) | ![Configuration rule matching the 'Mirage > Off' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-mirage-new.BZKE-odE_Z173H4m.webp) |\n\n### Migrate Opportunistic Encryption\n\nYou configured a Page Rule turning off Opportunistic Encryption for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Opportunistic Encryption*\n  * **Value**: Off\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Opportunistic Encryption for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Opportunistic Encryption\n         * **Value**: Off\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Opportunistic Encryption' setting](https://developers.cloudflare.com/_astro/pr-opportunistic-encryption.BcbwaI0m_yewVK.webp) | ![Configuration rule matching the 'Opportunistic Encryption > Off' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-opportunistic-encryption-new.LwpNCqst_fUfYN.webp) |\n\n### Migrate Origin Cache Control\n\nYou configured a Page Rule turning off Origin Cache Control for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: Origin Cache Control\n  * **Value**: Off\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to determine edge cache behavior for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Origin Cache Control\n         * **Enable Origin Cache Control**: Off\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Origin Cache Control' setting](https://developers.cloudflare.com/_astro/pr-origin-cache-control.DCUWJE-U_ZyIMHF.webp) | ![Cache rule matching the 'Origin Cache Control' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-origin-cache-control-new.DqpXz-FD_Z1MqoB7.webp) |\n\n### Migrate Origin Error Page Pass-thru\n\nYou configured a Page Rule turning on Origin Error Page Pass-thru for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Origin Error Page Pass-thru*\n  * **Value**: On\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to determine edge cache behavior for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Origin error page pass-thru\n         * **Use Origin error page pass-thru**: On\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Origin Error Page Pass-thru' setting](https://developers.cloudflare.com/_astro/pr-origin-error-page-pass-thru.CaO5dguv_1PhVzz.webp) | ![Cache rule matching the 'Origin Error Page Pass-thru > On' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-origin-error-page-pass-thru-new.CEumhpfw_ZPudFP.webp) |\n\nYou configured a Page Rule turning off [Polish](https://developers.cloudflare.com/images/polish/) for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: Polish\n  * **Value**: Off\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Polish for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Polish\n         * **Select value**: *Off*\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Polish' setting](https://developers.cloudflare.com/_astro/pr-polish.BMjezHuI_Z148pI0.webp) | ![Configuration rule matching the 'Polish > Off' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-polish-new.BPVnKGv2_1Xo8d2.webp) |\n\n### Migrate Query String Sort\n\nYou configured a Page Rule turning on Query String Sort for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Query String Sort*\n  * **Value**: On\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to sort query string parameters for caching purposes, for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Cache key\n         * **Sort query string**: On\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Query String Sort' setting](https://developers.cloudflare.com/_astro/pr-query-string-sort.C01G9KtA_1coNfp.webp) | ![Cache rule matching the 'Query String Sort > On' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-query-string-sort-new.DhEB-zV8_1Yj0V4.webp) |\n\n### Migrate Resolve Override\n\nYou configured a Page Rule changing the origin to `example.saas-provider.com`, for all requests addressed at any subdomain of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Resolve Override*\n  * **Enter value**: `example.saas-provider.com`\n\n1. [Create an origin rule](https://developers.cloudflare.com/rules/origin-rules/create-dashboard/) overriding the origin to `example.saas-provider.com` for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then**:\n       * **DNS Record** > **Override to**: `example.saas-provider.com`\n\n2. Turn off your existing Page Rule and validate the behavior of the origin rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to an origin rule |\n  | - | - |\n  | ![Example Page Rule with 'Resolve Override' setting](https://developers.cloudflare.com/_astro/pr-resolve-override.B4LoxPLL_1MfH2O.webp) | ![Origin rule matching the 'Resolve Override' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-resolve-override-new.CqsoTaU3_Z2x2PsM.webp) |\n\n### Migrate Respect Strong ETags\n\nYou configured a Page Rule turning on byte-for-byte equivalency checks for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Respect Strong ETags*\n  * **Value**: On\n\n1. [Create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/) to respect strong ETags for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Cache eligibility**: Eligible for cache\n       * **Setting**: Respect strong ETags\n         * **Use strong ETag headers**: On\n\nThe default behavior of Cache Rules is different from Page Rules. Refer to [Key differences](#key-differences) for more information.\n\n2. Turn off your existing Page Rule and validate the behavior of the cache rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a cache rule |\n  | - | - |\n  | ![Example Page Rule with 'Respect Strong ETags' setting](https://developers.cloudflare.com/_astro/pr-respect-strong-etags.CUOv_EvP_1Gynxg.webp) | ![Cache rule matching the 'Respect Strong ETags > On' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-respect-strong-etags-new.BnNZFkL6_2wK2y8.webp) |\n\n### Migrate Rocket Loader\n\nYou configured a Page Rule turning off Rocket Loader for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Rocket Loader*\n  * **Value**: Off\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to turn off Rocket Loader for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: Rocket Loader\n         * **Value**: Off\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Rocket Loader' setting](https://developers.cloudflare.com/_astro/pr-rocket-loader.DOfWWA3Z_Z1VrtJp.webp) | ![Configuration rule matching the 'Rocket Loader > Off' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-rocket-loader-new.CPlD3EdY_SNzWs.webp) |\n\n### Migrate Security Level\n\nYou configured a Page Rule setting Security Level to *I'm Under Attack* for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *Security Level*\n  * **Select Security Level**: *I'm Under Attack*\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to set Security Level to *I'm Under Attack*, for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n\n* **Setting**: I'm Under Attack\n       * **Value**: On\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'Security Level' setting](https://developers.cloudflare.com/_astro/pr-security-level.YzQR-68G_wL4dy.webp) | ![Configuration rule matching the \"Security Level > I'm Under Attack\" setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-security-level-new.DP1C5HJ8_Zy55TV.webp) |\n\n### Migrate True Client IP Header\n\nYou configured a Page Rule adding a `True-Client-IP` HTTP header for all requests addressed at any subdomain of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *True Client IP Header*\n  * **Value**: On\n\n1. [Turn on the **Add \"True-Client-IP\" header** Managed Transform](https://developers.cloudflare.com/rules/transform/managed-transforms/configure/) — a Transform Rules feature — to add the `True-Client-IP` header to all requests.\n  2. Turn off your existing Page Rule and validate the behavior of the Managed Transform.\n  3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a Managed Transform |\n  | - | - |\n  | ![Example Page Rule with 'True Client IP Header' setting](https://developers.cloudflare.com/_astro/pr-true-client-ip-header.h51QIhp7_Z1foMhl.webp) | ![The 'Add \"True-Client-IP\" header' Managed Transform matching the 'True Client IP Header' setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-true-client-ip-header-new.DKFw6CYO_QgNqw.webp) |\n\nYou configured a Page Rule setting SSL to *Strict* for all subdomains of `example.com` and the `example.com` domain itself:\n\n* **URL**: `*example.com/*`\n  * **Setting**: *SSL*\n  * **Select SSL/TLS encryption mode**: *Strict*\n\n1. [Create a configuration rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/) to set SSL to *Strict*, for any hostname containing `example.com`:\n\n* **When incoming requests match**: Custom filter expression\n\n* Using the Expression Builder:\\\n         `Hostname contains \"example.com\"`\n       * Using the Expression Editor:\\\n         `(http.host contains \"example.com\")`\n\n* **Then the settings are**:\n       * **Setting**: SSL\n         * **Select SSL/TLS encryption mode**: *Strict*\n\n2. Turn off your existing Page Rule and validate the behavior of the configuration rule you created.\n\n3. If your tests succeed, delete the existing Page Rule.\n\n| Page Rules configuration | Migrate to a configuration rule |\n  | - | - |\n  | ![Example Page Rule with 'SSL' setting](https://developers.cloudflare.com/_astro/pr-ssl.pGEGjIS-_injL4.webp) | ![Configuration rule matching the \"SSL\" setting of the example Page Rule](https://developers.cloudflare.com/_astro/pr-ssl-new.DjFLYHwZ_Z1yCkLw.webp) |\n\n## Settings that will not be migrated\n\nThe following Page Rules settings will not be migrated to other types of rules:\n\n* **Disable Performance** (this setting is deprecated)\n* **Disable Railgun** (this setting is deprecated, since Railgun is no longer available)\n* **Disable Security** (this setting is deprecated)\n* **Response Buffering** (this setting is deprecated)\n* **Web Application Firewall** (this setting is deprecated, since the previous version of WAF managed rules is deprecated)\n\nAll other Page Rules settings will be migrated during 2025.\n\nIf you have feedback to share, refer to our [Community thread](https://community.cloudflare.com/t/important-page-rules-deprecation/656021).\n\n<page>\n---\ntitle: Rules troubleshooting · Cloudflare Rules docs\ndescription: Review common troubleshooting scenarios for Rules features.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/reference/troubleshooting/\n  md: https://developers.cloudflare.com/rules/reference/troubleshooting/index.md\n---\n\n## Interaction between redirects and other Cloudflare products\n\nYour redirects may interfere with Cloudflare products and features such as challenges. Consider excluding the [`/cdn-cgi/*` URI path](https://developers.cloudflare.com/fundamentals/reference/cdn-cgi-endpoint/) in your rule expression to avoid issues. Alternatively, you may exclude only a sub-path such as `/cdn-cgi/challenge-platform/*` to avoid issues with specific features (in this example, [Cloudflare challenges](#interaction-between-cloudflare-challenges-and-rules-features)).\n\nYou may also want to exclude the `/.well-known/*` URL path used by several validation services. Refer to [Interaction between redirects and verification procedures like HTTP DCV](#interaction-between-redirects-and-verification-procedures-like-http-dcv) for more information.\n\n## Interaction between Cloudflare challenges and Rules features\n\nIf you are issuing a [challenge](https://developers.cloudflare.com/cloudflare-challenges/) for a given URI path that has one or more Rules features enabled, you should exclude URI paths starting with `/cdn-cgi/challenge-platform/` in your rule expressions to avoid challenge loops.\n\nFor example, define a compound expression for your rule using the `and` operator and the [`starts_with()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#starts_with) function:\n\n## Interaction between redirects and verification procedures like HTTP DCV\n\nPaths used in validation procedures such as custom hostname verification (Cloudflare for SaaS), [Pages domain validation](https://developers.cloudflare.com/pages/configuration/debugging-pages/), or [HTTP domain control validation (DCV)](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/http/) may be affected by redirects.\n\nConsider excluding the `/.well-known/*` URI path from your rule to avoid issues.\n\n## Content-Length header removed from response\n\nCloudflare may remove the `Content-Length` header from responses delivered to website visitors. If the visitor must receive the `Content-Length` header, configure the origin server to include a `cache-control: no-transform` HTTP header in the response.\n\n## This rule may not apply to your traffic\n\nIf your rule expression is matching a hostname for which you have neither created a DNS record nor enabled proxying traffic through Cloudflare, you will get a pop-up window with a couple of options:\n\n* **If no DNS record exists for the hostname**: Whether to proceed with the rule creation or to create a new proxied DNS record for that hostname.\n* **If there is a DNS record for the hostname, but traffic is not being proxied**: Whether to proceed with the rule creation or to enable proxying for the existing DNS record.\n\nIf you choose to create a new DNS record, the new record will have a `rules` tag and the following associated comment:\n\n## URL rewrites affect other Rules features executed later\n\nIf you rewrite a URI path using a [URL rewrite](https://developers.cloudflare.com/rules/transform/url-rewrite/), this may affect other Rules features executed later — such as [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/) — if they include the URI path in their filter expression.\n\nConsider the following origin rule configuration:\n\n* Rule expression: `http.host == \"example.com\" and starts_with(http.request.uri.path, \"/downloads/\")`\n* **Host header** > **Rewrite to**: `assets.example.com`\n\nIf you configure a new URL rewrite with the following configuration:\n\n* Rule expression: `http.host == \"example.com\" and starts_with(http.request.uri.path, \"/downloads/\")`\n* **Path** > **Rewrite to** > **Dynamic**: `regex_replace(http.request.uri.path, \"^/downloads/\", \"/\")`\n\nThe origin rule will no longer match `/downloads/*` paths, since URL rewrites run before Origin Rules and the URI path will be rewritten from `\"/downloads/\"` to `\"/\"`.\n\nTo prevent this situation, use raw fields in your rule expression. Raw fields are immutable during the entire request evaluation workflow, and they are not affected by the actions of previously matched rules.\n\nIn the current example, you could use the `raw.http.request.uri.path` field in both rules:\n\n* Rule expression: `http.host == \"example.com\" and starts_with(raw.http.request.uri.path, \"/downloads/\")`\n* **Path** > **Rewrite to** > **Dynamic**: `regex_replace(raw.http.request.uri.path, \"^/downloads/\", \"/\")`\n\n* Rule expression: `http.host == \"example.com\" and starts_with(raw.http.request.uri.path, \"/downloads/\")`\n* **Host header** > **Rewrite to**: `assets.example.com`\n\nThis way, the two rules will work as intended. Additionally, this allows you to use the same expression in the two rules, even when the first rule is updating the URI path value.\n\nFor a list of raw fields, refer to the [Fields reference](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/?field-category=Raw+fields).\n\n<page>\n---\ntitle: Create a compression rule via API · Cloudflare Rules docs\ndescription: Use the Rulesets API to create a compression rule via API.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/compression-rules/create-api/\n  md: https://developers.cloudflare.com/rules/compression-rules/create-api/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to create a compression rule via API.\n\n## Basic rule settings\n\nWhen creating a compression rule via API, make sure you:\n\n* Set the rule action to `compress_response`.\n* Define the parameters in the `action_parameters` field according to the [settings](https://developers.cloudflare.com/rules/compression-rules/settings/#api-configuration-settings) you wish to override for matching requests.\n* Deploy the rule to the `http_response_compression` phase at the zone level.\n\nFollow this workflow to create a compression rule for a given zone via API:\n\n1. Use the [List zone rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to check if there is already a ruleset for the `http_response_compression` phase at the zone level.\n\n2. If the phase ruleset does not exist, create it using the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation. In the new ruleset properties, set the following values:\n\n* **kind**: `zone`\n   * **phase**: `http_response_compression`\n\n3. Use the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation to add a compression rule to the list of ruleset rules. Alternatively, include the rule in the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) request mentioned in the previous step.\n\nFor example API requests, refer to the [Examples gallery](https://developers.cloudflare.com/rules/compression-rules/examples/).\n\n<page>\n---\ntitle: Create a compression rule in the dashboard · Cloudflare Rules docs\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/compression-rules/create-dashboard/\n  md: https://developers.cloudflare.com/rules/compression-rules/create-dashboard/index.md\n---\n\n1. In the Cloudflare dashboard, go to the Rules **Overview** page.\n\n[Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/rules/overview)\n\n2. Select **Create rule** > **Compression Rule**.\n\n3. (Optional) Select one of the rule templates that address common use cases. Then, review and adjust the proposed rule configuration.\n\n4. Enter a descriptive name for the rule in **Rule name**.\n\n5. Under **When incoming requests match**, select if you wish to apply the rule to [default content types](https://developers.cloudflare.com/speed/optimization/content/compression/#compression-between-cloudflare-and-website-visitors) (content types that Cloudflare compresses by default), or to requests that match a custom filter expression.\n\n6. (Optional) To define a custom expression, use the Expression Builder (specifying one or more values for **Field**, **Operator**, and **Value**) or manually enter an expression using the Expression Editor. For more information, refer to [Edit rule expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n7. Under **Compression options**, set the [compression options](https://developers.cloudflare.com/rules/compression-rules/settings/#dashboard-configuration-settings).\n\n8. To save and deploy your rule, select **Deploy**. If you are not ready to deploy your rule, select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\n<page>\n---\ntitle: Compression Rules examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/compression-rules/examples/\n  md: https://developers.cloudflare.com/rules/compression-rules/examples/index.md\n---\n\n[Disable Brotli compression](https://developers.cloudflare.com/rules/compression-rules/examples/disable-all-brotli/)\n\n[Create a compression rule to turn off Brotli compression for all incoming requests of a given zone.](https://developers.cloudflare.com/rules/compression-rules/examples/disable-all-brotli/)\n\n[Disable compression for AVIF images](https://developers.cloudflare.com/rules/compression-rules/examples/disable-compression-avif/)\n\n[Create a compression rule to turn off compression for AVIF images, based on either the content type or the file extension specified in the request.](https://developers.cloudflare.com/rules/compression-rules/examples/disable-compression-avif/)\n\n[Enable Zstandard compression for default content types](https://developers.cloudflare.com/rules/compression-rules/examples/enable-zstandard/)\n\n[Create a compression rule to turn on Zstandard compression for response content types where Cloudflare applies compression by default.](https://developers.cloudflare.com/rules/compression-rules/examples/enable-zstandard/)\n\n[Use Gzip compression for CSV files](https://developers.cloudflare.com/rules/compression-rules/examples/gzip-for-csv/)\n\n[Create a compression rule to set Gzip compression as the preferred compression method for CSV files.](https://developers.cloudflare.com/rules/compression-rules/examples/gzip-for-csv/)\n\n[Use only Brotli compression for a specific path](https://developers.cloudflare.com/rules/compression-rules/examples/only-brotli-url-path/)\n\n[Create a compression rule to set Brotli as the only supported compression algorithm for a specific URI path.](https://developers.cloudflare.com/rules/compression-rules/examples/only-brotli-url-path/)\n\n<page>\n---\ntitle: Compression Rules settings · Cloudflare Rules docs\ndescription: Compression Rules support the configuration settings covered in the\n  following sections.\nlastUpdated: 2025-09-11T15:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/compression-rules/settings/\n  md: https://developers.cloudflare.com/rules/compression-rules/settings/index.md\n---\n\nCompression Rules support the configuration settings covered in the following sections.\n\n## Dashboard configuration settings\n\n### Enable Zstandard (Zstd) compression Beta\n\nSets Zstandard as the preferred compression algorithm. If it is not supported, will automatically fall back to Brotli, Gzip, or uncompressed data.\n\n### Enable Brotli and Gzip compression\n\nEnables Cloudflare's default compression setting. Brotli is the preferred compression algorithm. It will automatically fall back to Gzip or to uncompressed data.\n\n### Disable compression\n\nDisables compression for matching requests. Also disables Cloudflare's [default compression behavior](https://developers.cloudflare.com/speed/optimization/content/compression/).\n\nDefines a custom order for compression algorithms.\n\nAllowed values are the following:\n\n* **Gzip**: Use the Gzip compression algorithm, if supported by the website visitor.\n* **Brotli**: Use the Brotli compression algorithm, if supported by the website visitor.\n* **Zstandard**: Use the Zstandard (Zstd) compression algorithm, if supported by the website visitor.\n* **Auto**: Compress the response according to the algorithms supported by the website visitor (if any). Cloudflare will define the order of preference for the compression algorithms, which may change in the future. Has the same behavior of the **Enable compression** option.\n* **Default**: Use Cloudflare's [default compression behavior](https://developers.cloudflare.com/speed/optimization/content/compression/), which depends on the response content type.\n\nIf you specify only *Gzip*, *Brotli*, or *Zstandard* and no algorithm matches, the response will have no compression. To configure a fallback compression mechanism, add *Auto* to the list.\n\nThe compression applied by the *Default* option takes into account any configured compression rules that match incoming requests.\n\n## API configuration settings\n\nThe configuration object supported by the `compress_response` action has the following format:\n\nThe `algorithms` list must contain at least one item.\n\nThe supported algorithm values are:\n\n* `gzip`: Use the Gzip compression algorithm, if supported by the website visitor.\n* `brotli`: Use the Brotli compression algorithm, if supported by the website visitor.\n* `zstd`: Use the Zstandard compression algorithm, if supported by the website visitor.\n* `none`: Do not use any compression algorithm.\n* `auto`: Compress the response according to the algorithms supported by the website visitor (if any). Cloudflare will define the order of preference for the compression algorithms, which may change in the future.\n* `default`: Use Cloudflare's [default compression behavior](https://developers.cloudflare.com/speed/optimization/content/compression/#compression-between-cloudflare-and-website-visitors), which depends on the response content type.\n\nIf you include `none`, `default`, or `auto` in the list, it must be the last value in the list.\n\nWhen you specify only the `gzip`, `brotli`, or `zstd` algorithms, if no algorithm matches then the response will have no compression. To configure a fallback compression mechanism, add `auto` to the list.\n\nFor API examples, refer to the [Examples gallery](https://developers.cloudflare.com/rules/compression-rules/examples/).\n\n<page>\n---\ntitle: Cloudflare Trace changelog · Cloudflare Rules docs\ndescription: Subscribe to RSS\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/trace-request/changelog/\n  md: https://developers.cloudflare.com/rules/trace-request/changelog/index.md\n---\n\n[Subscribe to RSS](https://developers.cloudflare.com/rules/trace-request/changelog/index.xml)\n\n**Cloudflare Trace now supports Workers**\n\nStarting today, customers can use Cloudflare Trace to confirm if a request to a specific URL within their zone is routed through a [Workers script](https://developers.cloudflare.com/workers/).\n\n**Cloudflare Trace now supports BYOIP zones**\n\nCustomers can now use Cloudflare Trace to trace HTTP/S requests through their [BYOIP](https://developers.cloudflare.com/byoip/) zones.\n\n**Cloudflare Trace now supports grey-clouded hostnames**\n\nEven if the hostname is [not proxied by Cloudflare](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records), Cloudflare Trace will now return all the configurations that Cloudflare would have applied to the request.\n\n<page>\n---\ntitle: How to - Cloudflare Trace (beta) · Cloudflare Rules docs\ndescription: Learn how to use Cloudflare Trace in the dashboard and with the API.\nlastUpdated: 2025-09-08T13:42:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/trace-request/how-to/\n  md: https://developers.cloudflare.com/rules/trace-request/how-to/index.md\n---\n\n## Use Trace in the dashboard\n\n### 1. Configure one or more Cloudflare products\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com), and select your account.\n2. Set configuration settings at the account level, or select a domain and configure settings for one or more Cloudflare products.\n\n1. In the Cloudflare dashboard, go to the **Trace** page.\n\n[Go to **Trace**](https://dash.cloudflare.com/?to=/:account/trace)\n\n2. Enter a URL to trace. The URL must include a hostname that belongs to your account.\n\n3. Select an HTTP method. If you select *POST*, *PUT*, or *PATCH*, you should enter a value in **Request Body**.\n\n4. (Optional) Define any custom request properties to simulate the conditions of a specific HTTP/S request. You can customize the following request properties:\n\n* **Protocol** (HTTP protocol version)\n   * **User Agent and Request Headers**\n   * **Cookies**\n   * **Geolocation** (request source [country](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.country/), [region](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.region/), and [city](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.city/))\n   * [**Bot Score**](https://developers.cloudflare.com/bots/concepts/bot-score/)\n   * **Request Body** (for `POST`, `PUT`, and `PATCH` requests)\n   * **Skip Challenge** (skips a Cloudflare-issued [challenge](https://developers.cloudflare.com/cloudflare-challenges/), if any, allowing the trace to continue)\n\n5. Select **Send Trace**.\n\n### 3. Assess results\n\nThe **Trace results** page shows all evaluated and executed configurations from different Cloudflare products, in evaluation order. Any inactive rules are not evaluated.\n\n1. Analyze the different [steps](#steps-in-trace-results) with evaluated and executed configurations for the current trace. Trace results include matches for all active rules and configurations, whether configured at the account level or for a specific domain or subdomain.\n\nTo show all configurations, including the ones that did not match the request, select *All configurations* in the **Results shown** dropdown.\n\n2. (Optional) Update your Cloudflare configuration (at the account or at the domain/subdomain level) and create a new trace to check the impact of your changes.\n\n### 4. (Optional) Save the trace configuration\n\nTo run a trace later with the same configuration:\n\n1. Copy the JSON shown in the dashboard with the current trace configuration.\n2. When creating a new trace, paste it in the JSON box to define all the settings of the new trace.\n\nUse the [Request Trace](https://developers.cloudflare.com/api/resources/request_tracers/subresources/traces/methods/create/) operation to perform a trace using the Cloudflare API.\n\n## Steps in trace results\n\n* Execution of one or more rules of Cloudflare products built on the [Ruleset Engine](https://developers.cloudflare.com/ruleset-engine/). Refer to the Ruleset Engine's [Phases list](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) for a list of such products.\n* [Page Rules](https://developers.cloudflare.com/rules/page-rules/): Execution of one or more rules.\n* [Workers](https://developers.cloudflare.com/workers/): Execution of one or more scripts.\n\n<page>\n---\ntitle: Cloudflare Trace limitations · Cloudflare Rules docs\ndescription: \"Trace currently does not support:\"\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/trace-request/limitations/\n  md: https://developers.cloudflare.com/rules/trace-request/limitations/index.md\n---\n\nTrace currently does not support:\n\n* Hostnames using [Data Localization Suite](https://developers.cloudflare.com/data-localization/)\n* [Spectrum](https://developers.cloudflare.com/spectrum/) applications\n\nAdditionally, the following products will not appear in trace results:\n\n* [Firewall rules (deprecated)](https://developers.cloudflare.com/firewall/)\n* [Load Balancing](https://developers.cloudflare.com/load-balancing/) and [Load Balancer Custom Rules](https://developers.cloudflare.com/load-balancing/additional-options/load-balancing-rules/)\n* [IP Access rules](https://developers.cloudflare.com/waf/tools/ip-access-rules/)\n* [Rate limiting rules (previous version)](https://developers.cloudflare.com/waf/reference/legacy/old-rate-limiting/)\n* [WAF managed rules (previous version)](https://developers.cloudflare.com/waf/reference/legacy/old-waf-managed-rules/)\n* [Page Shield policies](https://developers.cloudflare.com/page-shield/policies/)\n\n<page>\n---\ntitle: Configure Snippets via API · Cloudflare Rules docs\ndescription: You can create Snippets using the Cloudflare API.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/create-api/\n  md: https://developers.cloudflare.com/rules/snippets/create-api/index.md\n---\n\nYou can create Snippets using the [Cloudflare API](https://developers.cloudflare.com/fundamentals/api/).\n\n## Required permissions\n\nThe [API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) used in API requests to manage Snippets must have at least the following permission:\n\n* *Zone* > *Snippets* > *Edit*\n\nA token with this permission is only valid for the Snippets endpoints described in this page. You cannot use it to interact with the `http_request_snippets` phase via [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\nTo obtain the complete endpoint, append the Snippets endpoints listed below to the Cloudflare API base URL:\n\nThe `{zone_id}` argument is the [zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) (a hexadecimal string). You can find this value in the Cloudflare dashboard.\n\nThe following table summarizes the available operations.\n\n| Operation | Verb + Endpoint |\n| - | - |\n| List all code snippets | `GET /zones/{zone_id}/snippets` |\n| Create/update code snippet | `PUT /zones/{zone_id}/snippets/{snippet_name}` |\n| Get code snippet details | `GET /zones/{zone_id}/snippets/{snippet_name}` |\n| Get code snippet content | `GET /zones/{zone_id}/snippets/{snippet_name}/content` |\n| Delete code snippet | `DELETE /zones/{zone_id}/snippets/{snippet_name}` |\n| List snippet rules | `GET /zones/{zone_id}/snippets/snippet_rules` |\n| Create/update/delete snippet rules | `PUT /zones/{zone_id}/snippets/snippet_rules` |\n| Delete all snippet rules | `DELETE /zones/{zone_id}/snippets/snippet_rules` |\n\n### Create/update code snippet\n\nTo create or update a Snippet, use the following `PUT` request. The snippet is named `$SNIPPET_NAME` and the body contains the JavaScript code.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\nThe name of a snippet can only contain the characters `a-z`, `0-9`, and `_` (underscore). The name must be unique in the context of the zone. You cannot change the snippet name after creating the snippet.\n\nThe required body parameters are:\n\n* `files`: The file with your JavaScript code.\n* `metadata`: Object containing `main_module`, which must match the filename of the uploaded file.\n\nTo make this example work, save your JavaScript code in a file named `example.js`, and then execute `curl` command with a `PUT` request from the folder where `example.js` is located.\n\nTo deploy a new snippet you must [create a snippet rule](#createupdatedelete-snippet-rules). The expression of the snippet rule defines when the snippet code will run.\n\n### Create/update/delete snippet rules\n\nWhen using this endpoint to create a new rule and keep existing rules, you must include all rules in the request body. Omitting an existing rule will delete the corresponding rule.\n\nOnce you have created a code snippet, you can link it to rules. This is done via the following `PUT` request to the `snippet_rules` endpoint.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n<page>\n---\ntitle: Create a snippet in the dashboard · Cloudflare Rules docs\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/create-dashboard/\n  md: https://developers.cloudflare.com/rules/snippets/create-dashboard/index.md\n---\n\n1. In the Cloudflare dashboard, go to the **Snippets** page.\n\n[Go to **Snippets**](https://dash.cloudflare.com/?to=/:account/:zone/rules/snippets)\n\n2. (Optional) If you have not created any snippets yet, select one of the snippet templates that addresses a common use case. Then, review and adjust the proposed snippet code.\n\nTo start from scratch, select **Create Snippet**.\n\n3. In **Snippet name**, enter a descriptive name for the snippet. You cannot change the name after creating the snippet.\n\n4. Enter the snippet's JavaScript code in the code editor. You can test how your snippet will handle incoming requests using the **HTTP** and **Preview** tabs.\n\n5. Select **Snippet rule** to configure when the snippet will run.\n\n6. Under **Run this Snippet if incoming requests match**, select if you wish to run the snippet only for requests that match a custom filter expression or for all incoming requests.\n\n7. (Optional) To define a custom expression, use the Expression Builder (specifying one or more values for **Field**, **Operator**, and **Value**) or manually enter an expression using the Expression Editor. For more information, refer to [Edit expressions in the dashboard](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n9. To deploy your snippet, select **Deploy**. If you are not ready to deploy your snippet, open the dropdown next to **Deploy** and select **Save as Draft**.\n\nIf you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\n<page>\n---\ntitle: Configure Snippets using Terraform · Cloudflare Rules docs\ndescription: You can create Snippets using the Terraform Cloudflare provider.\nlastUpdated: 2025-04-03T17:29:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/create-terraform/\n  md: https://developers.cloudflare.com/rules/snippets/create-terraform/index.md\n---\n\nYou can create Snippets using the [Terraform Cloudflare provider](https://registry.terraform.io/providers/cloudflare/cloudflare/latest).\n\nTo get started with Terraform for Cloudflare configuration, refer to [Terraform: Get started](https://developers.cloudflare.com/terraform/installing/).\n\n## Example configuration\n\nTerraform code snippets below refer to the v4 SDK only.\n\nThe following example Terraform configuration creates a snippet and an associated snippet rule that defines when the snippet code will run. The snippet code is loaded from the `file1.js` file in your machine.\n\nThe name of a snippet can only contain the characters `a-z`, `0-9`, and `_` (underscore). The name must be unique in the context of the zone. You cannot change the snippet name after creating the snippet.\n\nAll `snippet_name` values in the `cloudflare_snippet_rules` resource must match the names of existing snippets.\n\nRefer to the [Terraform Cloudflare provider documentation](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) for more information on the `cloudflare_snippet` and `cloudflare_snippet_rules` resources.\n\n<page>\n---\ntitle: Troubleshoot Snippets · Cloudflare Rules docs\ndescription: This error occurs when a Snippet attempts to call fetch(request)\n  more than once.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/errors/\n  md: https://developers.cloudflare.com/rules/snippets/errors/index.md\n---\n\n## Error 1201: Snippet tried to continue to origin multiple times\n\nThis error occurs when a Snippet attempts to call `fetch(request)` more than once.\n\nEnsure that your Snippet code only calls `fetch(request)` once. This method is used to send the modified request to the origin server, and it should be called only once per Snippet to avoid conflicts.\n\n## Error 1202: Snippets exceeded subrequests limit\n\nThis error occurs when the number of subrequests exceeds [the limit](https://developers.cloudflare.com/rules/snippets/#availability) for your Cloudflare plan.\n\nReview your Snippet to ensure your code is within the subrequest [limits](https://developers.cloudflare.com/rules/snippets/#availability) for your plan. Each subrequest counts against your limit, including any redirects within a subrequest chain.\n\n## Snippets cannot be renamed\n\nThe name you define when creating a Snippet will be used as the Snippet ID and cannot be edited afterwards.\n\nTo change the name of your Snippet, create a new Snippet and delete the old one.\n\n<page>\n---\ntitle: Snippets examples · Cloudflare Rules docs\ndescription: Refer to the following examples to get started creating your snippet code.\nlastUpdated: 2025-11-18T12:40:09.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/examples/\n  md: https://developers.cloudflare.com/rules/snippets/examples/index.md\n---\n\nRefer to the following examples to get started creating your snippet code.\n\nRefer to [How Snippets work](https://developers.cloudflare.com/rules/snippets/how-it-works/) and [Create a snippet in the dashboard](https://developers.cloudflare.com/rules/snippets/create-dashboard/) for overall guidance.\n\n[A/B testing with same-URL direct access](https://developers.cloudflare.com/rules/snippets/examples/ab-testing-same-url/)\n\n[Set up an A/B test by controlling what response is served based on cookies.](https://developers.cloudflare.com/rules/snippets/examples/ab-testing-same-url/)\n\n[Append dates to cookies to use with A/B testing](https://developers.cloudflare.com/rules/snippets/examples/append-dates-to-cookies/)\n\n[Dynamically set a cookie expiration and test group.](https://developers.cloudflare.com/rules/snippets/examples/append-dates-to-cookies/)\n\n[Auth with headers](https://developers.cloudflare.com/rules/snippets/examples/auth-with-headers/)\n\n[Allow or deny a request based on a known pre-shared key in a header. This is not meant to replace the WebCrypto API.](https://developers.cloudflare.com/rules/snippets/examples/auth-with-headers/)\n\n[Send Bot Management information to origin](https://developers.cloudflare.com/rules/snippets/examples/bot-data-to-origin/)\n\n[Send Bots information to your origin. Refer to Bot Managenent variables for a full list of available fields.](https://developers.cloudflare.com/rules/snippets/examples/bot-data-to-origin/)\n\n[Send suspect bots to a honeypot](https://developers.cloudflare.com/rules/snippets/examples/bots-to-honeypot/)\n\n[Use the bot score field to send bots to a honeypot.](https://developers.cloudflare.com/rules/snippets/examples/bots-to-honeypot/)\n\n[Bulk redirect based on a map object](https://developers.cloudflare.com/rules/snippets/examples/bulk-redirect-map/)\n\n[Redirect requests to certain URLs based on a mapped object to the request's URL.](https://developers.cloudflare.com/rules/snippets/examples/bulk-redirect-map/)\n\n[Country code redirect](https://developers.cloudflare.com/rules/snippets/examples/country-code-redirect/)\n\n[Redirect a response based on the country code in the header of a visitor.](https://developers.cloudflare.com/rules/snippets/examples/country-code-redirect/)\n\n[Custom cache](https://developers.cloudflare.com/rules/snippets/examples/custom-cache/)\n\n[Store, retrieve, and remove assets from cache programmatically. Use this template to optimize performance and implement custom caching strategies.](https://developers.cloudflare.com/rules/snippets/examples/custom-cache/)\n\n[Debugging logs](https://developers.cloudflare.com/rules/snippets/examples/debugging-logs/)\n\n[Send debugging information in an errored response to a logging service.](https://developers.cloudflare.com/rules/snippets/examples/debugging-logs/)\n\n[Define CORS headers](https://developers.cloudflare.com/rules/snippets/examples/define-cors-headers/)\n\n[Adjust Cross-Origin Resource Sharing (CORS) headers and handle preflight requests.](https://developers.cloudflare.com/rules/snippets/examples/define-cors-headers/)\n\n[Follow redirects from the origin](https://developers.cloudflare.com/rules/snippets/examples/follow-redirects/)\n\n[Modify the fetch request to follow redirects from the origin, ensuring the client receives the final response.](https://developers.cloudflare.com/rules/snippets/examples/follow-redirects/)\n\n[Add HEX timestamp to a request header](https://developers.cloudflare.com/rules/snippets/examples/hex-timestamp/)\n\n[Add a custom header to requests sent to the origin server with the current timestamp in hexadecimal format for debugging, tracking, or custom routing purposes.](https://developers.cloudflare.com/rules/snippets/examples/hex-timestamp/)\n\n[Validate JSON web tokens (JWT)](https://developers.cloudflare.com/rules/snippets/examples/jwt-validation/)\n\n[Extract the JWT token from a header, decode it, and implement validation checks to verify it.](https://developers.cloudflare.com/rules/snippets/examples/jwt-validation/)\n\n[Maintenance page](https://developers.cloudflare.com/rules/snippets/examples/maintenance/)\n\n[Serve a custom maintenance page instead of fetching content from the origin server or cache. Ideal for downtime notifications, planned maintenance, or emergency messages.](https://developers.cloudflare.com/rules/snippets/examples/maintenance/)\n\n[Override a Set-Cookie header with a certain value](https://developers.cloudflare.com/rules/snippets/examples/override-set-cookies-value/)\n\n[Get a specific `Set-Cookie` header and update it with a certain value.](https://developers.cloudflare.com/rules/snippets/examples/override-set-cookies-value/)\n\n[Redirect 403 Forbidden to a different page](https://developers.cloudflare.com/rules/snippets/examples/redirect-forbidden-status/)\n\n[If origin responded with `403 Forbidden` error code, redirect to different page.](https://developers.cloudflare.com/rules/snippets/examples/redirect-forbidden-status/)\n\n[Redirect from one domain to another](https://developers.cloudflare.com/rules/snippets/examples/redirect-replaced-domain/)\n\n[Redirect all requests from one domain to another domain.](https://developers.cloudflare.com/rules/snippets/examples/redirect-replaced-domain/)\n\n[Remove fields from API response](https://developers.cloudflare.com/rules/snippets/examples/remove-fields-api-response/)\n\n[If origin responds with `JSON`, parse the response and delete fields to return a modified response.](https://developers.cloudflare.com/rules/snippets/examples/remove-fields-api-response/)\n\n[Remove query strings before sending request to origin](https://developers.cloudflare.com/rules/snippets/examples/remove-query-strings/)\n\n[Remove certain query strings from a request before passing to the origin.](https://developers.cloudflare.com/rules/snippets/examples/remove-query-strings/)\n\n[Remove response headers](https://developers.cloudflare.com/rules/snippets/examples/remove-response-headers/)\n\n[Remove from response all headers that start with a certain name.](https://developers.cloudflare.com/rules/snippets/examples/remove-response-headers/)\n\n[Return information about the incoming request](https://developers.cloudflare.com/rules/snippets/examples/return-incoming-request-properties/)\n\n[Respond with information about the incoming request provided by Cloudflare’s global network.](https://developers.cloudflare.com/rules/snippets/examples/return-incoming-request-properties/)\n\n[Change origin and modify paths](https://developers.cloudflare.com/rules/snippets/examples/route-and-rewrite/)\n\n[Route requests to a different origin, prepend a directory to the URL path, and remove specific segments.](https://developers.cloudflare.com/rules/snippets/examples/route-and-rewrite/)\n\n[Rewrite links on HTML pages](https://developers.cloudflare.com/rules/snippets/examples/rewrite-site-links/)\n\n[Dynamically rewrite links in HTML responses. This is useful for site migrations and branding updates.](https://developers.cloudflare.com/rules/snippets/examples/rewrite-site-links/)\n\n[Set security headers](https://developers.cloudflare.com/rules/snippets/examples/security-headers/)\n\n[Set common security headers such as X-XSS-Protection, X-Frame-Options, and X-Content-Type-Options.](https://developers.cloudflare.com/rules/snippets/examples/security-headers/)\n\n[Send timestamp to origin as a custom header](https://developers.cloudflare.com/rules/snippets/examples/send-timestamp-to-origin/)\n\n[Convert timestamp to hexadecimal format and send it as a custom header to the origin.](https://developers.cloudflare.com/rules/snippets/examples/send-timestamp-to-origin/)\n\n[Route to a different origin based on origin response](https://developers.cloudflare.com/rules/snippets/examples/serve-different-origin/)\n\n[If response to the original request is not `200 OK` or a redirect, send to another origin.](https://developers.cloudflare.com/rules/snippets/examples/serve-different-origin/)\n\n[Sign requests](https://developers.cloudflare.com/rules/snippets/examples/signing-requests/)\n\n[Verify a signed request using the HMAC and SHA-256 algorithms or return a 403.](https://developers.cloudflare.com/rules/snippets/examples/signing-requests/)\n\n[Slow down suspicious requests](https://developers.cloudflare.com/rules/snippets/examples/slow-suspicious-requests/)\n\n[Define a delay to be used when incoming requests match a rule you consider suspicious based on the bot score.](https://developers.cloudflare.com/rules/snippets/examples/slow-suspicious-requests/)\n\n<page>\n---\ntitle: How Snippets work · Cloudflare Rules docs\ndescription: \"Cloudflare Snippets are executed based on rules defined within\n  your zone. Here is how the process works:\"\nlastUpdated: 2025-11-18T12:40:09.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/how-it-works/\n  md: https://developers.cloudflare.com/rules/snippets/how-it-works/index.md\n---\n\nCloudflare Snippets are executed based on rules defined within your zone. Here is how the process works:\n\n![Diagram of the snippets execution workflow](https://developers.cloudflare.com/_astro/snippets-execution.Cb6ZLHBP_SD5eq.webp)\n\n## 1. Evaluate snippet rules\n\nFor each incoming request, Cloudflare evaluates the expression of every snippet rule defined in the zone. The evaluation checks for a match based on various request properties (such as bot score, WAF attack score, country of origin, and cookies).\n\n## 2. Build Snippets table\n\nFor every snippet rule in a zone that matches an incoming request, Cloudflare adds the corresponding unique snippet ID to a Snippets table.\n\n## 3. Execute snippets code\n\nOnce all the rules have been evaluated and the full table has been compiled, the Snippets Internal Worker Service starts processing all the information in the table.\n\nThis Worker receives all the snippet IDs stored in the table that are to be sequentially executed. Each snippet receives the modified request from the previous snippet and applies new modifications to it.\n\n## 4. Continue with the request execution workflow\n\nAfter executing the final snippet IDs, the resulting modified request is passed back to the request execution workflow. Refer to [Execution order](https://developers.cloudflare.com/rules/snippets/#execution-order) for more information on the Rules features evaluated before and after Cloudflare Snippets.\n\n<page>\n---\ntitle: When to use Snippets vs Workers · Cloudflare Rules docs\ndescription: This guide helps you determine when to use Snippets or Workers on\n  Cloudflare's global network.\nlastUpdated: 2025-10-09T15:47:46.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/snippets/when-to-use/\n  md: https://developers.cloudflare.com/rules/snippets/when-to-use/index.md\n---\n\nThis guide helps you determine when to use Snippets or Workers on Cloudflare's global network. It provides best practices, comparisons, and real-world use cases to help you choose the right product for your workload.\n\n## What are Snippets?\n\nCloudflare Snippets provide a fast, declarative way to modify HTTP requests and responses at the edge — without requiring a full-stack compute platform. Snippets extend [Cloudflare Rules](https://developers.cloudflare.com/rules/) by allowing you to write JavaScript-based logic that modifies requests before they reach an origin and responses after they return from upstream.\n\nSnippets enable you to:\n\n* Modify headers, validate JWTs, and implement complex rewrites or redirects.\n* Retry failed requests to different origins and apply custom caching strategies.\n* Execute multiple Snippets sequentially, with each Snippet modifying the request or response before handing it off to the next.\n\nSnippets are included at no additional cost in [all paid plans](https://developers.cloudflare.com/rules/snippets/#availability), making them the preferred solution for lightweight edge logic.\n\nBy contrast, [Cloudflare Workers](https://developers.cloudflare.com/workers/) provide a full-stack compute platform designed for applications requiring state, compute, and integrations with Cloudflare’s [Developer Platform](https://developers.cloudflare.com/learning-paths/workers/devplat/intro-to-devplat/). Workers operate on a [usage-based pricing model](https://developers.cloudflare.com/workers/platform/pricing/) and include a free tier.\n\n## Choosing the right product\n\nSnippets are ideal for fast, cost-free request and response modifications at the edge. They extend [Cloudflare Rules](https://developers.cloudflare.com/rules/) without requiring additional infrastructure or external solutions.\n\n### When to use Snippets\n\n* Ultra-fast traffic modifications applied directly on Cloudflare's network.\n* Extend Cloudflare Rules beyond built-in actions for greater control.\n* Simplify CDN migrations by replacing VCL, EdgeWorkers, or on-premise logic.\n* Modify headers, cache responses, and perform redirects.\n* Integrate edge logic into development workflows using JavaScript.\n\n### What Snippets are not designed for\n\n* Persistent state management (for example, session storage or databases).\n\n* Compute-intensive tasks (for example, image transformations or [AI inference](https://developers.cloudflare.com/workers-ai/)).\n\n* Deep integrations with [Developer Platform](https://developers.cloudflare.com/learning-paths/workers/devplat/intro-to-devplat/) services like [Durable Objects](https://developers.cloudflare.com/durable-objects/) or [D1](https://developers.cloudflare.com/d1/).\n\n* Use cases requiring advanced runtime features, such as:\n\n* [Environment variables](https://developers.cloudflare.com/workers/configuration/environment-variables/)\n  * [Observability](https://developers.cloudflare.com/workers/observability/logs/)\n  * [Bindings](https://developers.cloudflare.com/workers/runtime-apis/bindings/)\n  * [Cron triggers](https://developers.cloudflare.com/workers/configuration/cron-triggers/)\n  * High [compute limits](https://developers.cloudflare.com/rules/snippets/#limits)\n\n* Ultra-fast, edge-optimized execution, powered by [Ruleset Engine](https://developers.cloudflare.com/ruleset-engine/) and [Workers runtime](https://developers.cloudflare.com/workers/runtime-apis/).\n\n* Included at no additional cost on [all paid plans](https://developers.cloudflare.com/rules/snippets/#availability).\n\n* Granular request matching using dozens of request attributes, such as [URI](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.full_uri/), [user-agent](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.user_agent/), and [cookies](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.cookies/).\n\n* Sequential execution – multiple Snippets [can run](https://developers.cloudflare.com/rules/snippets/how-it-works/) on the same request, applying modifications step by step.\n\n* Native integration with [Cloudflare Rules](https://developers.cloudflare.com/rules/) – Snippets inherit request modifications from other products running in earlier [request phases](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/#request-phases).\n\n* JavaScript and Web APIs support, including:\n\n* [Fetch API](https://developers.cloudflare.com/workers/runtime-apis/fetch/)\n  * [Cache API](https://developers.cloudflare.com/workers/runtime-apis/cache/)\n\n* Essential [Workers runtime](https://developers.cloudflare.com/workers/runtime-apis/) features, such as:\n\n* [`request.cf` object](https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties)\n  * [`HTMLRewriter`](https://developers.cloudflare.com/workers/runtime-apis/html-rewriter/)\n\n* Automated deployment and versioning via [Terraform](https://developers.cloudflare.com/rules/snippets/create-terraform/).\n\n## Snippets vs Workers: Feature comparison\n\n| Feature | Snippets | Workers |\n| - | - | - |\n| Execute scripts based on request attributes (for example, headers, geolocation, and cookies) | ✅ | ❌ |\n| Execute code on a specific URL route | ✅ | ✅ |\n| Modify HTTP requests/responses or serve a [different response](https://developers.cloudflare.com/rules/snippets/examples/maintenance/) | ✅ | ✅ |\n| [Add](https://developers.cloudflare.com/rules/snippets/examples/hex-timestamp/), [remove](https://developers.cloudflare.com/rules/snippets/examples/remove-response-headers/), or [rewrite](https://developers.cloudflare.com/rules/snippets/examples/override-set-cookies-value/) headers dynamically | ✅ | ✅ |\n| [Cache](https://developers.cloudflare.com/rules/snippets/examples/custom-cache/) assets at the edge | ✅ | ✅ |\n| Route traffic dynamically between [origin servers](https://developers.cloudflare.com/rules/snippets/examples/serve-different-origin/) | ✅ | ✅ |\n| [Authenticate](https://developers.cloudflare.com/rules/snippets/examples/auth-with-headers/) requests, [pre-sign](https://developers.cloudflare.com/cache/interaction-cloudflare-products/waf-snippets/) URLs, run [A/B testing](https://developers.cloudflare.com/rules/snippets/examples/ab-testing-same-url/) | ✅ | ✅ |\n| Define logic using [JavaScript and Web APIs](https://developers.cloudflare.com/workers/languages/javascript/) | ✅ | ✅ |\n| Perform compute-heavy tasks (for example, [AI](https://developers.cloudflare.com/workers-ai/), [image transformations](https://developers.cloudflare.com/images/transform-images/transform-via-workers/)) | ❌ | ✅ |\n| Store persistent data (for example, [KV](https://developers.cloudflare.com/kv/), [Durable Objects](https://developers.cloudflare.com/durable-objects/), and [D1](https://developers.cloudflare.com/d1/)) | ❌ | ✅ |\n| Build [APIs](https://developers.cloudflare.com/d1/tutorials/build-a-comments-api/) and [full-stack applications](https://developers.cloudflare.com/pages/framework-guides/deploy-an-astro-site/#video-tutorial) | ❌ | ✅ |\n| Use TypeScript, Python, Rust, or other programming [languages](https://developers.cloudflare.com/workers/languages/) | ❌ | ✅ |\n| Support non-HTTP [protocols](https://developers.cloudflare.com/workers/reference/protocols/) | ❌ | ✅ |\n| Analyze execution [logs](https://developers.cloudflare.com/workers/observability/logs/workers-logs/) and track performance metrics | ❌ | ✅ |\n| Deploy via [command-line interface (CLI)](https://developers.cloudflare.com/workers/wrangler/) | ❌ | ✅ |\n| Roll out gradually, roll back to previous [versions](https://developers.cloudflare.com/workers/configuration/versions-and-deployments/) | ❌ | ✅ |\n| Optimize execution with [Smart Placement](https://developers.cloudflare.com/workers/configuration/smart-placement/) | ❌ | ✅ |\n\n## Code examples: Common Snippets templates\n\nBelow are practical use cases demonstrating Snippets in action. You can find more templates to get started in the [Examples](https://developers.cloudflare.com/rules/snippets/examples/) section.\n\n### Modify HTTP headers\n\nModifies request and response headers dynamically.\n\n### Serve a custom maintenance page\n\nRoutes traffic to a maintenance page when your origin is undergoing a planned maintenance.\n\nPerforms programmatic caching at the edge to reduce origin load.\n\n### Redirect based on country code\n\nRedirects visitors based on their geographic location.\n\n### Redirect 403 Forbidden to a different page\n\nIf the origin responded with `403 Forbidden` error code, redirects visitor to a different page.\n\n### Retry to another origin\n\nIf the response to the original request is not `200 OK` or a redirect, sends to another origin.\n\n### Remove fields from API response\n\nIf the origin responds with JSON, deletes sensitive fields before returning a response to the visitor.\n\nAdjusts [Cross-Origin Resource Sharing (CORS)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS) headers and handles preflight requests.\n\n### Rewrite links on HTML pages\n\nReplaces outdated links without having to make changes on your origin.\n\n### Slow down requests\n\nDefines a delay to be used when incoming requests match your rule. Useful for suspicious requests.\n\n## Using Snippets and Workers together\n\nWhile Snippets and Workers have distinct capabilities, they can work together to handle complex traffic workflows.\n\nTo avoid conflicts, Snippets and Workers should operate on separate request paths rather than running on the same URL. Have them fetch their respective URLs as a subrequest within their logic, ensuring smooth execution and caching behavior.\n\n### Example 1: Passing data between Snippets and Workers\n\nSnippets can modify incoming requests before they reach a Worker, and Workers can read these modifications, perform additional transformations, and pass them downstream.\n\n#### Snippet: Add a custom header\n\n#### Worker: Read a header and add it to the response\n\n**Result:** The Snippet sets `X-Hex-Timestamp`, which the Worker reads and forwards to the origin.\n\n### Example 2: Caching Worker responses using Snippets\n\nA Worker performs compute-heavy processing (for example, image transformation), while a Snippet serves cached results to avoid unnecessary Worker execution. This can be helpful in situations when running Workers [before cache](https://developers.cloudflare.com/cache/interaction-cloudflare-products/workers/) is not desirable.\n\n#### Worker: Transform and cache responses\n\n#### Snippet: Serve cached responses or forward to Worker\n\n**Result:** The transformed response (`X-Cached-In-Workers: true`) is served from cache, avoiding redundant Worker execution (`X-Retrieved-From-Workers` is not present). When cache expires, the Snippet fetches a fresh version.\n\n## Migration between Snippets and Workers\n\nSnippets and Workers share the same [Workers runtime](https://developers.cloudflare.com/workers/runtime-apis/), meaning JavaScript code that does not rely on bindings, persistent storage, or advanced execution features can be migrated seamlessly between them.\n\n### When to migrate workloads to Snippets\n\nYou should consider migrating a Worker to Snippets if it:\n\n* Only modifies headers, redirects, caching rules, or origin routing.\n* Does not require bindings, persistent storage, or external integrations.\n* Is a lightweight JavaScript function with simple logic.\n* Needs to run an unlimited number of times for free on a Pro, Business, or Enterprise plan.\n\nMigrating to Snippets allows you to:\n\n* Leverage advanced request matching via the [Ruleset Engine](https://developers.cloudflare.com/ruleset-engine/).\n* Eliminate usage-based billing — Snippets are [included at no cost](https://developers.cloudflare.com/rules/snippets/#availability) on all paid plans.\n* Simplify management by integrating traffic modifications directly into Cloudflare Rules.\n\n### When to migrate workloads to Workers\n\nYou should migrate from Snippets to Workers if your logic:\n\n* Exceeds execution time, memory, or other [limits](https://developers.cloudflare.com/rules/snippets/#limits).\n\n* Requires persistent state management, such as:\n\n* [Key-Value (KV) storage](https://developers.cloudflare.com/kv/)\n  * [SQL databases (D1)](https://developers.cloudflare.com/d1/)\n  * [Durable Objects](https://developers.cloudflare.com/durable-objects/)\n\n* Performs compute-intensive operations, including:\n\n* [AI inference](https://developers.cloudflare.com/workers-ai/)\n  * [Vector search](https://developers.cloudflare.com/vectorize/)\n  * [Image transformations](https://developers.cloudflare.com/images/transform-images/transform-via-workers/)\n\n* Interacts with Cloudflare's [Developer Platform](https://developers.cloudflare.com/learning-paths/workers/devplat/intro-to-devplat/).\n\n* Requires [unit testing](https://developers.cloudflare.com/workers/testing/).\n\n* Needs deployment automation via CLI ([Wrangler](https://developers.cloudflare.com/workers/wrangler/)).\n\nIf your Snippet reaches the limits of execution time, memory, or functionality, transitioning to Workers ensures your logic can scale without restrictions.\n\nCloudflare Snippets provide a production-ready solution for fast, declarative edge traffic logic, bridging the gap between [Cloudflare Rules](https://developers.cloudflare.com/rules/) and [Developer Platform](https://developers.cloudflare.com/learning-paths/workers/devplat/intro-to-devplat/).\n\nSnippets and Workers solve different problems:\n\n* Use Snippets for fast, lightweight traffic modifications at the edge, including header rewrites, caching, redirects, origin routing, custom responses, A/B testing and authentication.\n* Workers are built for advanced compute, persistent state, and full-stack applications.\n\n<page>\n---\ntitle: Managed Transforms · Cloudflare Rules docs\ndescription: \"Managed Transforms allow you to perform common adjustments to HTTP\n  request and response headers with the click of a button. The available\n  adjustments include:\"\nlastUpdated: 2025-02-04T15:44:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/managed-transforms/\n  md: https://developers.cloudflare.com/rules/transform/managed-transforms/index.md\n---\n\nManaged Transforms allow you to perform common adjustments to HTTP request and response headers with the click of a button. The available adjustments include:\n\n* Add bot protection request headers.\n* Remove or add headers related to the visitor's IP address.\n* Add request header when the WAF detects leaked credentials.\n* Add security-related response headers.\n* Remove \"X-Powered-By\" response headers.\n\nFor a complete list, refer to [Available Managed Transforms](https://developers.cloudflare.com/rules/transform/managed-transforms/reference/).\n\nWhen you enable a Managed Transform, Cloudflare internally deploys one or more Transform Rules to handle the common configuration you selected. These generated rules will not count against the [maximum number of Transform Rules](https://developers.cloudflare.com/rules/transform/#availability) available in your Cloudflare plan.\n\nEnabled Managed Transforms will apply to all inbound requests for the zone.\n\nThe generated internal Transform Rules will not appear in the Transform Rules list in the Cloudflare dashboard.\n\nFor dashboard, API, and Terraform instructions, refer to [Configure Managed Transforms](https://developers.cloudflare.com/rules/transform/managed-transforms/configure/).\n\n<page>\n---\ntitle: Transform Rules examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/examples/\n  md: https://developers.cloudflare.com/rules/transform/examples/index.md\n---\n\n[Add a wildcard CORS response header](https://developers.cloudflare.com/rules/transform/examples/add-cors-header/)\n\n[Create a CORS response header transform rule to add an `Access-Control-Allow-Origin` HTTP header to the response with wildcard as static value. (`cookiename=value`).](https://developers.cloudflare.com/rules/transform/examples/add-cors-header/)\n\n[Add a request header with the current bot score](https://developers.cloudflare.com/rules/transform/examples/add-request-header-bot-score/)\n\n[Create a request header transform rule to add a `X-Bot-Score` HTTP header to the request with the current bot score.](https://developers.cloudflare.com/rules/transform/examples/add-request-header-bot-score/)\n\n[Add request header with a static value](https://developers.cloudflare.com/rules/transform/examples/add-request-header-static-value/)\n\n[Create a request header transform rule to add an `X-Source` HTTP header to the request with a static value (`Cloudflare`).](https://developers.cloudflare.com/rules/transform/examples/add-request-header-static-value/)\n\n[Add a request header for subrequests from other zones](https://developers.cloudflare.com/rules/transform/examples/add-request-header-subrequest-other-zone/)\n\n[Create a request header transform rule to add an HTTP header when the Workers subrequest comes from a different zone.](https://developers.cloudflare.com/rules/transform/examples/add-request-header-subrequest-other-zone/)\n\n[Add a response header with a static value](https://developers.cloudflare.com/rules/transform/examples/add-response-header-static-value/)\n\n[Create a response header transform rule to add a `set-cookie` HTTP header to the response with a static value (`cookiename=value`).](https://developers.cloudflare.com/rules/transform/examples/add-response-header-static-value/)\n\n[Normalize encoded slashes in URL path](https://developers.cloudflare.com/rules/transform/examples/normalize-encoded-slash/)\n\n[Create a URL rewrite rule (part of Transform Rules) to normalize encoded forward slashes (`%2F`) in the request path to standard slashes (`/`).](https://developers.cloudflare.com/rules/transform/examples/normalize-encoded-slash/)\n\n[Remove a request header](https://developers.cloudflare.com/rules/transform/examples/remove-request-header/)\n\n[Create a request header transform rule (part of Transform Rules) to remove the `cf-connecting-ip` HTTP header from the request.](https://developers.cloudflare.com/rules/transform/examples/remove-request-header/)\n\n[Remove a response header](https://developers.cloudflare.com/rules/transform/examples/remove-response-header/)\n\n[Create a response header transform rule (part of Transform Rules) to remove the `cf-connecting-ip` HTTP header from the response.](https://developers.cloudflare.com/rules/transform/examples/remove-response-header/)\n\n[Rewrite blog archive URLs](https://developers.cloudflare.com/rules/transform/examples/rewrite-archive-urls-new-format/)\n\n[Create a transform rule to rewrite the URL format `/posts/<YYYY>-<MM>-<DD>-<TITLE>` to the new format `/posts/<YYYY>/<MM>/<DD>/<TITLE>`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-archive-urls-new-format/)\n\n[Rewrite path of moved section of a website](https://developers.cloudflare.com/rules/transform/examples/rewrite-moved-section/)\n\n[Create a URL rewrite rule (part of Transform Rules) to rewrite everything under `/blog/<PATH>` to `/marketing/<PATH>`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-moved-section/)\n\n[Rewrite path of archived blog posts](https://developers.cloudflare.com/rules/transform/examples/rewrite-path-archived-posts/)\n\n[Create a URL rewrite rule (part of Transform Rules) to rewrite any requests for `/news/2012/...` URI paths to `/archive/news/2012/...`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-path-archived-posts/)\n\n[Rewrite path for object storage bucket](https://developers.cloudflare.com/rules/transform/examples/rewrite-path-object-storage/)\n\n[Create a URL rewrite rule (part of Transform Rules) to rewrite any requests for `/files/...` URI paths to `/...`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-path-object-storage/)\n\n[Rewrite image paths with several URL segments](https://developers.cloudflare.com/rules/transform/examples/rewrite-several-url-different-url/)\n\n[Create a URL rewrite rule (part of Transform Rules) to rewrite any requests for `/images/<FOLDER1>/<FOLDER2>/<FILENAME>` to `/img/<FILENAME>`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-several-url-different-url/)\n\n[Rewrite URL query string](https://developers.cloudflare.com/rules/transform/examples/rewrite-url-string-visitors/)\n\n[Create a transform rule to rewrite the request path from `/blog` to `/blog?sort-by=date`.](https://developers.cloudflare.com/rules/transform/examples/rewrite-url-string-visitors/)\n\n[Rewrite page path for visitors in specific countries](https://developers.cloudflare.com/rules/transform/examples/rewrite-welcome-for-countries/)\n\n[Create two URL rewrite rules (part of Transform Rules) to rewrite the path of the welcome page for visitors in specific countries.](https://developers.cloudflare.com/rules/transform/examples/rewrite-welcome-for-countries/)\n\n[Set a response header with the current bot score](https://developers.cloudflare.com/rules/transform/examples/set-response-header-bot-score/)\n\n[Create a response header transform rule (part of Transform Rules) to set an `X-Bot-Score` HTTP header in the response with the current bot score.](https://developers.cloudflare.com/rules/transform/examples/set-response-header-bot-score/)\n\n[Set response header with a static value](https://developers.cloudflare.com/rules/transform/examples/set-response-header-static-value/)\n\n[Create a response header transform rule (part of Transform Rules) to set an `X-Bot-Score` HTTP header in the response to a static value (`Cloudflare`).](https://developers.cloudflare.com/rules/transform/examples/set-response-header-static-value/)\n\n<page>\n---\ntitle: Request Header Transform Rules · Cloudflare Rules docs\ndescription: Learn how to modify HTTP request headers with Cloudflare's rules.\nlastUpdated: 2025-12-12T17:17:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/request-header-modification/\n  md: https://developers.cloudflare.com/rules/transform/request-header-modification/index.md\n---\n\nUse Request Header Transform Rules to manipulate the headers of HTTP requests sent to your origin server.\n\nTo modify HTTP headers in the **response** sent to website visitors, refer to [Response Header Transform Rules](https://developers.cloudflare.com/rules/transform/response-header-modification/).\n\nThrough Request Header Transform Rules you can:\n\n* Set the value of an HTTP request header to a literal string value, overwriting its previous value or adding a new header to the request.\n* Set the value of an HTTP request header according to an expression, overwriting its previous value or adding a new header to the request.\n* Remove an HTTP header from the request.\n\nYou can create a request header transform rule [in the dashboard](https://developers.cloudflare.com/rules/transform/request-header-modification/create-dashboard/), [via API](https://developers.cloudflare.com/rules/transform/request-header-modification/create-api/), or [using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/transform-rules/#create-a-request-header-transform-rule).\n\nFor more complex request header modifications, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n* You cannot modify or remove HTTP request headers whose name starts with `x-cf-` or `cf-` except for the `cf-connecting-ip` HTTP request header, which you can remove.\n\n* Due to protocol compliance reasons, modifying or removing request headers with [forbidden header names](https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name) (such as `Accept-Encoding`) is generally not allowed in Request Header Transform Rules.\n\n* You cannot modify the value of any header commonly used to identify the website visitor's IP address or initial protocol, such as `x-forwarded-for`, `true-client-ip`, `x-real-ip`, or `x-forwarded-proto`. Additionally, you cannot remove the `x-forwarded-for` and `x-forwarded-proto` headers.\n\n* You cannot set or modify the value of `cookie` HTTP request headers, but you can remove these headers. Configuring a rule that removes the `cookie` HTTP request header will remove all `cookie` headers in matching requests.\n\n* If you modify the value of an existing HTTP request header using an expression that evaluates to an empty string (`\"\"`) or an undefined value, the HTTP request header is **removed**.\n\n* The HTTP request header removal operation will remove all request headers with the provided name.\n\n* Currently, there is a limited number of HTTP request headers that you cannot modify. Cloudflare may remove restrictions for some of these HTTP request headers when presented with valid use cases. [Create a post in the community](https://community.cloudflare.com) for consideration.\n\n* To use [claims inside a JSON Web Token (JWT)](https://developers.cloudflare.com/api-shield/security/jwt-validation/transform-rules/), you must first set up a token validation configuration in API Shield.\n\n* Request header transform rules run in order, and later rules can overwrite changes done by previous rules.\n\n* The values of request and response fields are immutable within each [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/), such as the `http_request_late_transform` phase where request header transform rules are defined. This means that later request header transform rules will not match based on changes done by previous request header transform rules. Refer to [Field values during rule evaluation](https://developers.cloudflare.com/ruleset-engine/about/rules/#field-values-during-rule-evaluation) for more information.\n\nThe execution order of Rules features is the following:\n\n* [Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/)\n* [URL Rewrite Rules](https://developers.cloudflare.com/rules/transform/url-rewrite/)\n* [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/)\n* [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/)\n* [Bulk Redirects](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)\n* [Managed Transforms](https://developers.cloudflare.com/rules/transform/managed-transforms/)\n* [Request Header Transform Rules](https://developers.cloudflare.com/rules/transform/request-header-modification/)\n* [Cache Rules](https://developers.cloudflare.com/cache/how-to/cache-rules/)\n* [Snippets](https://developers.cloudflare.com/rules/snippets/)\n* [Cloud Connector](https://developers.cloudflare.com/rules/cloud-connector/)\n\nThe different types of rules listed above will take precedence over [Page Rules](https://developers.cloudflare.com/rules/page-rules/). This means that Page Rules will be overridden if there is a match for both Page Rules and the Rules products listed above.\n\nGenerally speaking, for [non-terminating actions](https://developers.cloudflare.com/ruleset-engine/rules-language/actions/) the last change made by rules in the same [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) will win (later rules can overwrite changes done by previous rules). However, for terminating actions (*Block*, *Redirect*, or one of the challenge actions), rule evaluation will stop and the action will be executed immediately.\n\nFor example, if multiple rules with the *Redirect* action match, Cloudflare will always use the URL redirect of the first rule that matches. Also, if you configure URL redirects using different Cloudflare products (Single Redirects and Bulk Redirects), the product executed first will apply, if there is a rule match (in this case, Single Redirects).\n\nRefer to the [Phases list](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) for the product execution order.\n\nUsing Cloudflare challenges along with Rules features may cause challenge loops. Refer to [Rules troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/) for more information.\n\nWhen troubleshooting Request Header Transform Rules, use [Cloudflare Trace](https://developers.cloudflare.com/rules/trace-request/) to determine if a rule is triggering for a specific URL.\n\n<page>\n---\ntitle: Response Header Transform Rules · Cloudflare Rules docs\ndescription: Use Response Header Transform Rules to manipulate the headers of\n  HTTP responses sent to website visitors.\nlastUpdated: 2025-12-12T17:17:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/response-header-modification/\n  md: https://developers.cloudflare.com/rules/transform/response-header-modification/index.md\n---\n\nUse Response Header Transform Rules to manipulate the headers of HTTP responses sent to website visitors.\n\nTo modify HTTP headers in the **request** sent to your origin server, refer to [Request Header Transform Rules](https://developers.cloudflare.com/rules/transform/request-header-modification/).\n\nThrough Response Header Transform Rules you can:\n\n* Set the value of an HTTP response header to a literal string value, overwriting its previous value or adding a new header to the response if it does not exist.\n* Set the value of an HTTP response header according to an expression, overwriting its previous value or adding a new header to the response if it does not exist.\n* Add a new HTTP response header with a literal string value without removing any existing headers with the same name.\n* Add a new HTTP response header according to an expression without removing any existing headers with the same name.\n* Remove an HTTP header from the response.\n\nYou can create a response header transform rule [in the dashboard](https://developers.cloudflare.com/rules/transform/response-header-modification/create-dashboard/), [via API](https://developers.cloudflare.com/rules/transform/response-header-modification/create-api/), or [using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/transform-rules/#create-a-response-header-transform-rule).\n\nFor more complex response header modifications, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n* The response header values are calculated using the field values from the corresponding HTTP request. For example, the value of `ip.src.country` will be the country of the website visitor, not the origin where the response was sent from.\n\n* You cannot add, modify, or remove HTTP response headers whose name starts with `cf-` or `x-cf-`.\n\n* You cannot modify the value of certain headers such as `server`, `eh-cache-tag`, or `eh-cdn-cache-control`.\n\n* Currently you cannot reference [IP lists](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists) in expressions of Response Header Transform Rules.\n\n* The HTTP response header removal operation will remove all response headers with the provided name.\n\n* If you change the value of an existing HTTP response header using an expression that evaluates to an empty string (`\"\"`) or an undefined value, the HTTP response header is **removed**.\n\n* Currently, there is a limited number of HTTP response headers that you cannot change. Cloudflare may remove restrictions for some of these HTTP response headers when presented with valid use cases. [Create a post in the community](https://community.cloudflare.com) for consideration.\n\n* Response header transform rules will also apply to default Cloudflare error pages and [Custom Errors](https://developers.cloudflare.com/rules/custom-errors/).\n\n* Modifying `cache-control`, `CDN-Cache-Control`, or `Cloudflare-CDN-Cache-Control` headers will not change the way Cloudflare caches an object. Instead, you should create a [Cache Rule](https://developers.cloudflare.com/cache/how-to/cache-rules/).\n\n* To add a `set-cookie` header to the response, make sure you use one of the *Add static*/*Add dynamic* operations instead of *Set static*/*Set dynamic*. Using one of the *Set* operations will remove any `set-cookie` headers already in the response, including those added by other Cloudflare products such as Bot Management.\n\n* Response header transform rules run in order, and later rules can overwrite changes done by previous rules.\n\n* The values of request and response fields are immutable within each [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/), such as the `http_response_headers_transform` phase where response header transform rules are defined. This means that later response header transform rules will not match based on changes done by previous response header transform rules. Refer to [Field values during rule evaluation](https://developers.cloudflare.com/ruleset-engine/about/rules/#field-values-during-rule-evaluation) for more information.\n\nWhen troubleshooting Response Header Transform Rules, use [Cloudflare Trace](https://developers.cloudflare.com/rules/trace-request/) to determine if a rule is triggering for a specific URL.\n\n<page>\n---\ntitle: Troubleshoot Transform Rules · Cloudflare Rules docs\ndescription: When troubleshooting a rule configuration, review the Transform\n  Rules evaluation section to understand how and when your Transform Rule is\n  evaluated for each request.\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/troubleshooting/\n  md: https://developers.cloudflare.com/rules/transform/troubleshooting/index.md\n---\n\nWhen troubleshooting a rule configuration, review the [Transform Rules evaluation](https://developers.cloudflare.com/rules/transform/#transform-rules-evaluation) section to understand how and when your Transform Rule is evaluated for each request.\n\nFor more information on runtime errors related to Transform Rules configuration, refer to [Troubleshooting Cloudflare 1XXX errors](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-1xxx-errors/).\n\n## Why do I not see my request header modifications?\n\nTransform Rules performing request header modifications affect the HTTP headers sent by Cloudflare's network to your origin server. You will not find these headers in your browser request or response data, which can make it difficult to tell if the rule is working as intended.\n\nTo check if a request header transform rule is taking effect, you can check the logs on your origin server or use [Cloudflare Trace](https://developers.cloudflare.com/rules/trace-request/) to check that the rule is matching traffic correctly. Since [Cloudflare Logpush](https://developers.cloudflare.com/logs/logpush/) only logs original HTTP request/response headers, Logpush logs will not include any header transformations done via Transform Rules.\n\nTo add HTTP headers that website visitors will receive in their browsers, you must [modify the response headers](https://developers.cloudflare.com/rules/transform/response-header-modification/) instead.\n\n<page>\n---\ntitle: URL Rewrite Rules · Cloudflare Rules docs\ndescription: \"You can manipulate the URL of a request through different\n  operations, namely rewrites and redirects:\"\nlastUpdated: 2025-12-12T17:17:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/transform/url-rewrite/\n  md: https://developers.cloudflare.com/rules/transform/url-rewrite/index.md\n---\n\nYou can manipulate the URL of a request through different operations, namely rewrites and redirects:\n\n* **URL rewrite**: A server-side operation that converts a source URL into a target URL. It occurs before a web server has fully processed a request. A rewrite is not visible to website visitors, since the URL displayed in the browser does not change. Configure URL Rewrite Rules to perform rewrites on the Cloudflare global network without reaching your web server.\n\n* **URL redirect**: A client-side operation that converts a source URL into a target URL. It occurs after the web server has loaded the initial URL. In this case, a website visitor can notice the URL changing when the redirect occurs. Refer to [Redirects](https://developers.cloudflare.com/rules/url-forwarding/) to learn more about configuring redirects.\n\nUse a URL rewrite rule to return the content of a URL while displaying a different URL in the browser. You can rewrite the URI path, the query string, or both.\n\nYou cannot rewrite the hostname using a URL rewrite rule. To rewrite the hostname, use an [origin rule](https://developers.cloudflare.com/rules/origin-rules/features/#dns-record).\n\nFor more complex rewrite logic, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n## Static and dynamic rewrites\n\nURL Rewrite Rules can perform static or dynamic rewrites:\n\n* **Static rewrite**: Replaces a given part of a request URL (path or query string) with a static string.\n* **Dynamic rewrite**: Supports more advanced scenarios where you use a rewrite expression to define the resulting path or query string.\n\nCreate URL Rewrite Rules [in the dashboard](https://developers.cloudflare.com/rules/transform/url-rewrite/create-dashboard/), [via Cloudflare API](https://developers.cloudflare.com/rules/transform/url-rewrite/create-api/), or [using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/transform-rules/#create-a-url-rewrite-rule).\n\n## Serve images from custom paths\n\nWhen using Cloudflare Images, you can use URL Rewrite Rules to serve images from a custom path. For more information, refer to [Serve images from custom domains](https://developers.cloudflare.com/images/manage-images/serve-images/serve-from-custom-domains/).\n\nWhen troubleshooting URL Rewrite Rules, use [Cloudflare Trace](https://developers.cloudflare.com/rules/trace-request/) to determine if a rule is triggering for a specific URL.\n\n* URL rewrite rules run in order, and later rules can overwrite changes done by previous rules.\n\n* The values of request and response fields are immutable within each [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/), such as the `http_request_transform` phase where URL rewrite rules are defined. This means that later URL rewrite rules will not match based on changes done by previous URL rewrite rules. Refer to [Field values during rule evaluation](https://developers.cloudflare.com/ruleset-engine/about/rules/#field-values-during-rule-evaluation) for more information.\n\n<page>\n---\ntitle: Bulk Redirects · Cloudflare Rules docs\ndescription: Bulk Redirects allow you to define a large number of URL redirects\n  at the account level. These redirects navigate the user from a source URL to a\n  target URL using a given HTTP status code. URL redirection is also known as\n  URL forwarding.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/\n  md: https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/index.md\n---\n\nBulk Redirects allow you to define a large number of URL redirects at the account level. These redirects navigate the user from a source URL to a target URL using a given HTTP status code. URL redirection is also known as URL forwarding.\n\nUnlike dynamic URL redirects created in [Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/), Bulk Redirects are essentially static — they do not support string replacement operations or regular expressions. However, you can configure URL redirect parameters that affect their URL matching behavior and their runtime behavior.\n\nFor more complex and customized redirect logic, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n* [Availability](https://developers.cloudflare.com/rules/url-forwarding/#availability): Information on the Bulk Redirects quotas and features per Cloudflare plan.\n* [Execution order](https://developers.cloudflare.com/rules/url-forwarding/#execution-order): Execution order of the different Rules products.\n* [Trace a request](https://developers.cloudflare.com/rules/trace-request/): Use Cloudflare Trace to determine if a bulk redirect rule is triggering for a specific URL.\n\n<page>\n---\ntitle: Redirect examples · Cloudflare Rules docs\nlastUpdated: 2025-11-11T11:19:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/index.md\n---\n\n[Redirect admin area requests to HTTPS](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-admin-https/)\n\n[Create a redirect rule to redirect requests for the administration area of `store.example.com` to HTTPS, keeping the original path and query string.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-admin-https/)\n\n[Redirect requests from one domain to another](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-another-domain/)\n\n[Create a redirect rule to redirect all requests to a different domain, maintaining all functionality, except for the discontinued HTTP service (port 80).](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-another-domain/)\n\n[Perform mobile redirects](https://developers.cloudflare.com/rules/url-forwarding/examples/perform-mobile-redirects/)\n\n[Create a redirect rule to redirect visitors using mobile devices to a different hostname.](https://developers.cloudflare.com/rules/url-forwarding/examples/perform-mobile-redirects/)\n\n[Redirect requests from one country to a domain](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-country/)\n\n[Create a redirect rule to redirect all website visitors from the United Kingdom to a different domain, maintaining the current functionality in the same paths.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-country/)\n\n[Redirect requests for a domain to a new domain](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-domain-root/)\n\n[Create a redirect rule to redirect all URLs for a domain to point to the root of a new domain, including any subdomains of the old domain.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-domain-root/)\n\n[Redirect requests to a different hostname](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-hostname/)\n\n[Create a redirect rule to redirect all requests for `smallshop.example.com` to a different hostname using HTTPS, keeping the original path and query string.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-hostname/)\n\n[Redirect local visitors to specific subdomains](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-country-subdomains/)\n\n[Create a redirect rule to redirect United Kingdom and France visitors from the `example.com` website's root path (`/`) to their localized subdomains `https://gb.example.com` and `https://fr.example.com`, respectively.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-country-subdomains/)\n\n[Redirect visitors to a new page URL](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-new-url/)\n\n[Create a redirect rule to redirect visitors from `/contact-us/` to the page's new path `/contacts/`.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-new-url/)\n\n[Redirect from root to WWW](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-root-to-www/)\n\n[Create a redirect rule to forward HTTPS requests from the root (also known as the “apex” or “naked” domain) to the WWW subdomain.](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-root-to-www/)\n\n[Redirect from WWW to root](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-www-to-root/)\n\n[Create a redirect rule to forward HTTPS requests from the WWW subdomain to the root (also known as the “apex” or “naked” domain).](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-www-to-root/)\n\n[Remove locale from URL path](https://developers.cloudflare.com/rules/url-forwarding/examples/remove-locale-url/)\n\n[Create a redirect rule to redirect visitors from an old URL format with locale information to a new URL format.](https://developers.cloudflare.com/rules/url-forwarding/examples/remove-locale-url/)\n\n<page>\n---\ntitle: Single Redirects · Cloudflare Rules docs\ndescription: Single Redirects allow you to create static or dynamic URL\n  redirects. A simple interface with wildcard support makes it easy to define\n  source and target URL patterns without needing complex functions or regular\n  expressions, efficiently handling thousands of URLs with a single rule.\n  Dynamic URL redirects also support advanced features such as string\n  replacement operations and regular expressions (depending on your Cloudflare\n  plan).\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/\n  md: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/index.md\n---\n\nSingle Redirects allow you to create static or dynamic URL redirects. A simple interface with [wildcard support](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) makes it easy to define source and target URL patterns without needing complex functions or regular expressions, efficiently handling thousands of URLs with a single rule. Dynamic URL redirects also support advanced features such as string replacement operations and [regular expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#string-values-and-regular-expressions) (depending on your Cloudflare plan).\n\nFor more complex and customized redirect logic, consider using [Snippets](https://developers.cloudflare.com/rules/snippets/).\n\n* [Availability](https://developers.cloudflare.com/rules/url-forwarding/#availability): Information on the Single Redirects quotas and features per Cloudflare plan.\n* [Execution order](https://developers.cloudflare.com/rules/url-forwarding/#execution-order): Execution order of the different Rules products.\n* [Trace a request](https://developers.cloudflare.com/rules/trace-request/): Use Cloudflare Trace to determine if a redirect rule is triggering for a specific URL.\n\n<page>\n---\ntitle: Phases · Cloudflare Ruleset Engine docs\ndescription: A phase defines a stage in the life of a request where you can\n  execute rulesets. Phases are defined by Cloudflare and cannot be modified.\nlastUpdated: 2025-11-27T11:05:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/about/phases/\n  md: https://developers.cloudflare.com/ruleset-engine/about/phases/index.md\n---\n\nA phase defines a stage in the life of a request where you can execute [rulesets](https://developers.cloudflare.com/ruleset-engine/about/rulesets/). Phases are defined by Cloudflare and cannot be modified.\n\nPhases exist at two levels:\n\n* At the [account](https://developers.cloudflare.com/fundamentals/concepts/accounts-and-zones/#accounts) level\n* At the [zone](https://developers.cloudflare.com/fundamentals/concepts/accounts-and-zones/#zones) level\n\nFor the same phase, rules defined at the account level are evaluated before the rules defined at the zone level.\n\nEach phase has at most one [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) at the account and zone level.\n\nCurrently, phases at the account level are only available in Enterprise plans.\n\nThe following diagram outlines the request handling process where requests go through the available phases:\n\n![Diagram showing the request handling process. The user request goes through several request phases until it eventually reaches the origin server (the request can also be blocked). The origin returns a response, which goes through several response phases until it reaches the user.](https://developers.cloudflare.com/_astro/rulesets-phases.D4jji4ui_14HM7e.webp)\n\nCloudflare products are specific to one or more phases, and they add support for different features. Check the documentation for each Cloudflare product for details on the applicable phases.\n\nRefer to [Phases list](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) for a list of phases and their corresponding Cloudflare products.\n\n<page>\n---\ntitle: Rules · Cloudflare Ruleset Engine docs\ndescription: A rule defines a filter and an action to perform on the incoming\n  requests that match the filter.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/about/rules/\n  md: https://developers.cloudflare.com/ruleset-engine/about/rules/index.md\n---\n\nA rule defines a filter and an action to perform on the incoming requests that match the filter.\n\n* The rule [expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/), also called filter expression, defines the scope of the rule.\n* The rule [action](https://developers.cloudflare.com/ruleset-engine/rules-language/actions/) defines what happens when there is a match for the expression.\n\nRule expressions are defined using the [Rules language](https://developers.cloudflare.com/ruleset-engine/rules-language/).\n\nFor example, consider the following ruleset with four rules (R1, R2, R3, and R4). For a given incoming request, the expression of the first two rules matches the request properties. Therefore, the action for these rules runs (*Execute* and *Log*, respectively). The action of the first rule executes a managed ruleset, which means that every rule in the managed ruleset is evaluated. The action of the second rule logs an event associated with the current phase. There is no match for the expressions of rules 3 and 4, so their actions do not run. Since no rule blocks the request, it proceeds to the next phase.\n\n![Example of a rule execution scenario. Defines a ruleset with four rules, where the first rule executes a managed ruleset.](https://developers.cloudflare.com/_astro/rulesets-rules-example.BDy4co6D_1cLx8s.webp)\n\nRules can have additional features through specific Cloudflare products. You may have more fields available for rule expressions, perform different actions, or configure additional behavior in a given phase.\n\nWhen evaluating a rule, Cloudflare compares the values of request/response properties or derived values (obtained through [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/)) to those defined in the rule's filter expression.\n\nIf the entire expression evaluates to `true`, there is a rule match and Cloudflare triggers the [action](https://developers.cloudflare.com/ruleset-engine/rules-language/actions/) configured in the rule. If the expression evaluates to `false`, the rule does not match and its configured action is not applied.\n\nGenerally speaking, for [non-terminating actions](https://developers.cloudflare.com/ruleset-engine/rules-language/actions/) the last change made by rules in the same [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) will win (later rules can overwrite changes done by previous rules). However, for terminating actions (*Block*, *Redirect*, or one of the challenge actions), rule evaluation will stop and the action will be executed immediately.\n\nFor example, if multiple rules with the *Redirect* action match, Cloudflare will always use the URL redirect of the first rule that matches. Also, if you configure URL redirects using different Cloudflare products (Single Redirects and Bulk Redirects), the product executed first will apply, if there is a rule match (in this case, Single Redirects).\n\nRefer to the [Phases list](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) for the product execution order.\n\nWhen you use `true` as the rule filter expression, this means \"apply the rule to every incoming request\" at the current [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) level, which can be zone or account.\n\n* A rule filter expression must evaluate to a boolean value (either `true` or `false`).\n* Rules of specific Cloudflare products, such as [Transform Rules](https://developers.cloudflare.com/rules/transform/), may include other expressions used to specify dynamic values. These expressions do not have to evaluate to a boolean value.\n\n### Field values during rule evaluation\n\nWhile evaluating rules for a given request/response, the values of all request and response [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/) are immutable within each phase. However, field values may change between phases.\n\n* If a [URL rewrite rule](https://developers.cloudflare.com/rules/transform/url-rewrite/) #1 updates the URI path or the query string of a request, URL rewrite rule #2 will not take these earlier changes into consideration.\n* If a [request header transform rule](https://developers.cloudflare.com/rules/transform/request-header-modification/) #1 sets the value of an HTTP request header, request header transform rule #2 will not be able to read or evaluate this new value.\n* If a URL rewrite rule updates the URI path or query string of a request, the `http.request.uri`, `http.request.uri.*`, and `http.request.full_uri` fields will have a different value in phases after the `http_request_transform` phase (where URL Rewrite Rules are executed).\n\nIf you want to use the original field values in rules evaluated later, you can use raw fields (for example, `raw.http.request.uri.path`) in their expressions. These special fields are immutable during the entire request evaluation workflow. For a list of raw fields, refer to the [Fields reference](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/?field-category=Raw+fields).\n\n<page>\n---\ntitle: Rulesets · Cloudflare Ruleset Engine docs\ndescription: A ruleset is an ordered set of rules that you can apply to traffic\n  on the Cloudflare global network. Rulesets belong to a phase and can only\n  execute in the same phase. To deploy a ruleset to a phase, add a rule that\n  executes the ruleset to the phase entry point ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/about/rulesets/\n  md: https://developers.cloudflare.com/ruleset-engine/about/rulesets/index.md\n---\n\nA ruleset is an ordered set of [rules](https://developers.cloudflare.com/ruleset-engine/about/rules/) that you can apply to traffic on the Cloudflare global network. Rulesets belong to a phase and can only execute in the same phase. To deploy a ruleset to a phase, add a rule that executes the ruleset to the [phase entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset).\n\nRulesets are versioned. Each ruleset modification creates a new version of the ruleset. You can have several versions of a ruleset in use at the same time. When you deploy a ruleset — that is, when you create a rule that executes the ruleset — the most recent version of the ruleset is selected by default.\n\nThere are several types of rulesets:\n\n* Phases have their entry point rulesets.\n* Cloudflare provides managed rulesets you can deploy.\n* You can create and manage your own custom rulesets.\n\nSpecific Cloudflare products may provide other types of rulesets.\n\n## Entry point ruleset\n\nAn entry point ruleset contains a list of ordered [rules](https://developers.cloudflare.com/ruleset-engine/about/rules/) that run in a [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) at the account or zone level. This ruleset is an entry point for all rules executed in a phase. Some of these rules may run other rulesets.\n\nEach phase has at most one entry point ruleset at the account level and at the zone level.\n\nThe `kind` field of a phase entry point ruleset has one of the following values:\n\n* `root` for a phase entry point ruleset at the account level\n* `zone` for a phase entry point ruleset at the zone level\n\nManaged rulesets are preconfigured rulesets provided by Cloudflare that you can deploy to a phase. Only Cloudflare can modify these rulesets.\n\nThe rules in a managed ruleset have a default action and status. However, you can define **overrides** that change these defaults.\n\nThere are several Cloudflare products that provide you with managed rulesets. Check each product’s documentation for details on the available managed rulesets.\n\nFor more information on deploying managed rulesets and defining overrides, refer to [Work with managed rulesets](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/).\n\nCurrently, custom rulesets are only supported by the Cloudflare WAF.\n\nUse custom rulesets to define your own sets of rules. After creating a custom ruleset, deploy it to a phase by creating a rule that executes the ruleset.\n\nFor more information on creating and deploying custom rulesets, refer to [Work with custom rulesets](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/).\n\n<page>\n---\ntitle: Add rules to phase entry point rulesets · Cloudflare Ruleset Engine docs\ndescription: A phase entry point ruleset contains an ordered list of rules that\n  run in that phase. A rule in an entry point ruleset can execute a different\n  ruleset. You can have entry point rulesets for each phase at the account level\n  and at the zone level.\nlastUpdated: 2025-11-27T11:05:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/basic-operations/add-rule-phase-rulesets/\n  md: https://developers.cloudflare.com/ruleset-engine/basic-operations/add-rule-phase-rulesets/index.md\n---\n\nA [phase entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) contains an ordered list of rules that run in that phase. A rule in an entry point ruleset can execute a different ruleset. You can have entry point rulesets for each phase at the account level and at the zone level.\n\nTo add one or more rules to a phase entry point ruleset, use one of the [ruleset update operations](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) of the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/). When you add a rule to an entry point ruleset, the entry point ruleset is created automatically if it does not exist. This API method requires that you include in the request all rules you want to keep in the ruleset, or else they will be removed.\n\nIf you are adding a single rule to a ruleset, consider using one of the [rule creation operations](https://developers.cloudflare.com/ruleset-engine/rulesets-api/add-rule/) instead. In this case, the request only includes the definition of the new rule.\n\nCreating an entry point ruleset\n\nInstead of relying on the automatic creation of an entry point ruleset, you can also create this ruleset explicitly using one of the [ruleset creation operations](https://developers.cloudflare.com/ruleset-engine/rulesets-api/create/).\n\n## Example: Set the rules of a phase entry point ruleset at the zone level\n\nThe following example sets the rules of a phase entry point ruleset at the zone level for the `http_request_firewall_managed` phase using the [Update a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/update/) operation.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\n## Example: Add a single rule to a phase entry point ruleset at the zone level\n\nThe following example adds a single rule to a phase entry point ruleset (with ID `$RULESET_ID`) at the zone level using the [Create a zone ruleset rule](https://developers.cloudflare.com/api/resources/rulesets/subresources/rules/methods/create/) operation.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\n<page>\n---\ntitle: Deploy rulesets · Cloudflare Ruleset Engine docs\ndescription: 'Use the Rulesets API to deploy a ruleset. To deploy a ruleset, add\n  a rule with \"action\": \"execute\" to a phase entry point ruleset, specifying the\n  ruleset ID to execute as an action parameter. Use a separate rule for each\n  ruleset you want to deploy.'\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/\n  md: https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to deploy a ruleset. To deploy a ruleset, add a rule with `\"action\": \"execute\"` to a [phase entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset), specifying the ruleset ID to execute as an action parameter. Use a separate rule for each ruleset you want to deploy.\n\nA rule that executes a ruleset consists of:\n\n* The ID of the ruleset you want to execute, included in `action_parameters.id`.\n* An expression.\n* The `execute` action.\n\nThe rules in the ruleset execute when a request satisfies the expression.\n\nTo apply a rule to every request in a phase at the zone level, set the rule expression to `true`.\n\nThe following example deploys the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) (with ID efb7b8c949ac4650a09736fc376e9aee ) to the `http_request_firewall_managed` phase of a given zone (`$ZONE_ID`) by adding a rule that executes the managed ruleset.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nThis API request replaces any existing rules in the `http_request_firewall_managed` phase entry point ruleset with a single rule.\n\nFor more examples of deploying rulesets, refer to the following pages:\n\n* [Deploy a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset/)\n* [Managed ruleset override examples](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/).\n* [Deploy a custom ruleset](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset/)\n\nRefer to [Work with managed rulesets](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/) and [Work with custom rulesets](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/) for more information.\n\nFor more information on the available API endpoints for editing and deploying rulesets, refer to [Update or deploy a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/).\n\n<page>\n---\ntitle: View rulesets · Cloudflare Ruleset Engine docs\ndescription: \"This page includes examples of the following API operations:\"\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/basic-operations/view-rulesets/\n  md: https://developers.cloudflare.com/ruleset-engine/basic-operations/view-rulesets/index.md\n---\n\nThis page includes examples of the following API operations:\n\n* [View available rulesets](#view-available-rulesets)\n* [Get an entry point ruleset](#get-an-entry-point-ruleset)\n* [View the rules included in a ruleset](#view-the-rules-included-in-a-ruleset)\n\n## View available rulesets\n\nYou can list the available rulesets for a zone or account.\n\nFor a list of API endpoints refer to [List and view rulesets](https://developers.cloudflare.com/ruleset-engine/rulesets-api/view/).\n\n### Example: View available rulesets at the zone level\n\nThe response to the [GET request](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) obtaining the list of rulesets at the zone level will include the following rulesets:\n\n* Managed rulesets you can deploy, indicated by `\"kind\": \"managed\"`.\n* Zone-level phase entry point rulesets, if configured, indicated by `\"kind\": \"zone\"`.\n* Custom rulesets, if configured, indicated by `\"kind\": \"custom\"`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Response Compression Read`\n* `Config Settings Write`\n* `Config Settings Read`\n* `Dynamic URL Redirects Write`\n* `Dynamic URL Redirects Read`\n* `Cache Settings Write`\n* `Cache Settings Read`\n* `Custom Errors Write`\n* `Custom Errors Read`\n* `Origin Write`\n* `Origin Read`\n* `Managed headers Write`\n* `Managed headers Read`\n* `Zone Transform Rules Write`\n* `Zone Transform Rules Read`\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `HTTP DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Read`\n* `Sanitize Write`\n* `Sanitize Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Bot Management Write`\n* `Bot Management Read`\n* `Zone WAF Write`\n* `Zone WAF Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n* `Logs Write`\n* `Logs Read`\n\n### Example: View available rulesets at the account level\n\nThe response to the [GET request](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) obtaining the list of rulesets at the account level will include the following rulesets:\n\n* Managed rulesets you can deploy, indicated by `\"kind\": \"managed\"`.\n* Account-level phase entry point rulesets, if configured, indicated by `\"kind\": \"root\"`.\n* Custom rulesets, if configured, indicated by `\"kind\": \"custom\"`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n\n## Get an entry point ruleset\n\nYou can get the definition of the [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) of a given [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) at the zone or account level.\n\nIf the entry point ruleset exists, the API will return a `200 OK` HTTP status code, along with the ruleset definition.\n\nIf the entry point ruleset does not exist, the API will return a `404 Not Found` HTTP status code.\n\n### Example: Get an entry point ruleset at the zone level\n\nThe following [GET request](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/get/) obtains the definition of the entry point ruleset for the `http_request_firewall_managed` phase at the zone level. In this case, the entry point ruleset exists and contains one rule.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Response Compression Read`\n* `Config Settings Write`\n* `Config Settings Read`\n* `Dynamic URL Redirects Write`\n* `Dynamic URL Redirects Read`\n* `Cache Settings Write`\n* `Cache Settings Read`\n* `Custom Errors Write`\n* `Custom Errors Read`\n* `Origin Write`\n* `Origin Read`\n* `Managed headers Write`\n* `Managed headers Read`\n* `Zone Transform Rules Write`\n* `Zone Transform Rules Read`\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `HTTP DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Read`\n* `Sanitize Write`\n* `Sanitize Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Bot Management Write`\n* `Bot Management Read`\n* `Zone WAF Write`\n* `Zone WAF Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n* `Logs Write`\n* `Logs Read`\n\n### Example: Get an entry point ruleset at the account level\n\nThe following [GET request](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/get/) obtains the definition of the entry point ruleset for the `http_request_firewall_managed` phase at the account level.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n\n## View the rules included in a ruleset\n\nYou can view all versions of phase entry point rulesets (at the account and zone levels) and custom rulesets, but you can only view the most recent version of managed rulesets.\n\n### Example: View rules in a phase entry point ruleset at the zone level\n\nThe following [GET request](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/subresources/versions/methods/get/) lists the rules in version `2` of the `http_request_firewall_managed` phase entry point ruleset at the zone level.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Response Compression Read`\n* `Config Settings Write`\n* `Config Settings Read`\n* `Dynamic URL Redirects Write`\n* `Dynamic URL Redirects Read`\n* `Cache Settings Write`\n* `Cache Settings Read`\n* `Custom Errors Write`\n* `Custom Errors Read`\n* `Origin Write`\n* `Origin Read`\n* `Managed headers Write`\n* `Managed headers Read`\n* `Zone Transform Rules Write`\n* `Zone Transform Rules Read`\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `HTTP DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Read`\n* `Sanitize Write`\n* `Sanitize Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Bot Management Write`\n* `Bot Management Read`\n* `Zone WAF Write`\n* `Zone WAF Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n* `Logs Write`\n* `Logs Read`\n\n### Example: View rules in a managed ruleset\n\nThe following [GET request](https://developers.cloudflare.com/api/resources/rulesets/subresources/versions/methods/get/) lists the rules in version `2` of a managed ruleset (the most recent version of that ruleset).\n\nEach rule in a managed ruleset can have associated tags or categories, listed in the `categories` field.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Mass URL Redirects Read`\n* `Magic Firewall Write`\n* `Magic Firewall Read`\n* `L4 DDoS Managed Ruleset Write`\n* `L4 DDoS Managed Ruleset Read`\n* `Transform Rules Write`\n* `Transform Rules Read`\n* `Select Configuration Write`\n* `Select Configuration Read`\n* `Account WAF Write`\n* `Account WAF Read`\n* `Account Rulesets Read`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Read`\n\nFor more information on the available API methods for viewing rulesets, refer to [List and view rulesets](https://developers.cloudflare.com/ruleset-engine/rulesets-api/view/).\n\n<page>\n---\ntitle: Add rules to a custom ruleset · Cloudflare Ruleset Engine docs\ndescription: To add rules to an existing custom ruleset, use the Update an\n  account or zone ruleset operation and pass the rules in an array. Each rule\n  has an expression and an action.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/add-rules-ruleset/\n  md: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/add-rules-ruleset/index.md\n---\n\nTo add rules to an existing custom ruleset, use the [Update an account or zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation and pass the rules in an array. Each rule has an expression and an action.\n\nChoose the appropriate API method\n\nThe [Update an account or zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation replaces all the rules in the ruleset with the rules in the request. Use this API operation when you need to add or update several rules at once. This operation updates the ruleset version number only once.\n\nDepending on the update you want to perform, consider using one of the following API operations instead:\n\n* Add a single rule to an existing custom ruleset: Use the [Create an account or zone ruleset rule](https://developers.cloudflare.com/api/resources/rulesets/subresources/rules/methods/create/) operation. Refer to [Add a rule to a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/add-rule/) for an example.\n* Update a single rule in a custom ruleset: Use the [Update an account or zone ruleset rule](https://developers.cloudflare.com/api/resources/rulesets/subresources/rules/methods/edit/) operation. Refer to [Update a rule in a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule/) for an example.\n\nIf you are using Terraform, refer to [WAF custom rules configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/waf-custom-rules/#create-and-deploy-a-custom-ruleset) for examples of creating and deploying custom rulesets.\n\nIf you are using the Cloudflare dashboard, refer to [Work with custom rulesets in the dashboard](https://developers.cloudflare.com/waf/account/custom-rulesets/create-dashboard/).\n\nThe following request adds two rules to a custom ruleset at the account level with ID `$RULESET_ID`. These will be the only two rules in the ruleset.\n\nThe response will include the rule ID of the new rules in the `id` field.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n\nTo update one or more rules in a custom ruleset, use the [Update an account or zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation. Include the ID of the rules you want to modify in the rules array and add the fields you wish to update. The request replaces the entire ruleset with a new version. Therefore, you must include the ID of all the rules you wish to keep.\n\nThe following `PUT` request edits one rule in a custom ruleset at the account level and updates the execution order of the rules.\n\nThe response will include the modified custom ruleset. Note that the updated rule and ruleset version number increment.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n\nThe request above completely replaces the list of rules in the ruleset. If you omit an existing rule from the `rules` array, it will not appear in the new version of the ruleset.\n\n<page>\n---\ntitle: Create a custom ruleset · Cloudflare Ruleset Engine docs\ndescription: \"Use the Create an account or zone ruleset operation to create a\n  custom ruleset, making sure that you:\"\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/create-custom-ruleset/\n  md: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/create-custom-ruleset/index.md\n---\n\nUse the [Create an account or zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation to create a custom ruleset, making sure that you:\n\n* Set the `kind` field to `custom`.\n* Specify the name of the [phase](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) where you want to create the custom ruleset in the `phase` field.\n\nYou can also specify the list of rules to include in the custom ruleset in the `rules` array. To add rules after creating the custom ruleset, refer to [Add rules to a custom ruleset](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/add-rules-ruleset/).\n\nIf you are using Terraform, refer to [WAF custom rules configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/waf-custom-rules/#create-and-deploy-a-custom-ruleset) for examples of creating and deploying custom rulesets.\n\nIf you are using the Cloudflare dashboard, refer to [Work with custom rulesets in the dashboard](https://developers.cloudflare.com/waf/account/custom-rulesets/create-dashboard/).\n\nCurrently, zone-level custom rulesets are only available in the [`http_request_firewall_custom`](https://developers.cloudflare.com/waf/custom-rules/custom-rulesets/#deploy-a-custom-ruleset-via-api) phase.\n\n## Example A - Custom ruleset at the account level\n\nThe following request creates a new custom ruleset at the account level. The response will include the ID of the new custom ruleset in the `id` field.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n\nYou can include a list of rules in the custom ruleset creation request. If you have not added any rules, refer to [Add rules to a custom ruleset](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/add-rules-ruleset/) for more information.\n\n## Example B - Custom ruleset at the zone level\n\nThe following request creates a new custom ruleset at the zone level. The response will include the ID of the new custom ruleset in the `id` field.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nYou can include a list of rules in the custom ruleset creation request. If you have not added any rules, refer to [Add rules to a custom ruleset](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/add-rules-ruleset/) for more information.\n\nCurrently, zone-level custom rulesets are only available in the [`http_request_firewall_custom`](https://developers.cloudflare.com/waf/custom-rules/custom-rulesets/#deploy-a-custom-ruleset-via-api) phase.\n\n<page>\n---\ntitle: Deploy a custom ruleset · Cloudflare Ruleset Engine docs\ndescription: Learn how to deploy a custom ruleset to your Cloudflare account.\nlastUpdated: 2025-11-27T11:05:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset/\n  md: https://developers.cloudflare.com/ruleset-engine/custom-rulesets/deploy-custom-ruleset/index.md\n---\n\nTo deploy a custom ruleset, add a rule with `execute` action to the list of rules of a phase [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) at the account or zone level. The expression of the new rule will define when the custom ruleset will run.\n\nYou can only deploy custom rulesets in an entry point ruleset with the same scope. For example, a custom ruleset defined at the account level can only be deployed at the account level.\n\nIf you are using Terraform, refer to [WAF custom rules configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/waf-custom-rules/#create-and-deploy-a-custom-ruleset) for examples of creating and deploying custom rulesets.\n\nIf you are using the Cloudflare dashboard, refer to [Work with custom rulesets in the dashboard](https://developers.cloudflare.com/waf/account/custom-rulesets/create-dashboard/).\n\nCurrently, zone-level custom rulesets are only available in the [`http_request_firewall_custom`](https://developers.cloudflare.com/waf/custom-rules/custom-rulesets/#deploy-a-custom-ruleset-via-api) phase.\n\n1. Obtain the name of the [phase](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) where you want to deploy the custom ruleset.\n2. [Create a custom ruleset](https://developers.cloudflare.com/ruleset-engine/custom-rulesets/create-custom-ruleset/) and keep the ID of the new custom ruleset.\n3. [Fetch the rules already present in the phase entry point ruleset](https://developers.cloudflare.com/ruleset-engine/basic-operations/view-rulesets/#view-the-rules-included-in-a-ruleset). You must include in the `PUT` request all existing rules you want to keep.\n\n## Example A - Account-level deployment\n\nThe following `PUT` request adds a rule that executes a custom ruleset when the zone name matches `example.com`.\n\nIn the `PUT` request, you must include the IDs of all existing rules you want to keep. The response will include all the rules in the phase entry point ruleset after the update.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n\nWhen deploying the custom ruleset at the account level, you must use parentheses to enclose any custom conditions and end your expression with `and cf.zone.plan eq \"ENT\"` like in the example above, or else the API operation will fail.\n\n## Example B - Zone-level deployment\n\nThe following `PUT` request adds a rule to a zone-level entry point ruleset that executes a custom ruleset with ID `\"<CUSTOM_RULESET_ID>\"` for requests targeting the `/login` URI path.\n\nYou must include in the `PUT` request the IDs of all existing rules you want to keep. The response will include all the rules in the phase entry point ruleset after the update.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\nCurrently, zone-level custom rulesets are only available in the [`http_request_firewall_custom`](https://developers.cloudflare.com/waf/custom-rules/custom-rulesets/#deploy-a-custom-ruleset-via-api) phase.\n\n<page>\n---\ntitle: Deploy a managed ruleset · Cloudflare Ruleset Engine docs\ndescription: You can deploy a managed ruleset at the zone level or at the\n  account level. To deploy a managed ruleset to a phase, use the Rulesets API.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/deploy-managed-ruleset/index.md\n---\n\nYou can deploy a managed ruleset at the zone level or at the account level. To deploy a managed ruleset to a phase, use the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\nIf you are using Terraform, refer to [WAF Managed Rules configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/waf-managed-rulesets/) for more information.\n\nIf you are using the Cloudflare dashboard, refer to the following pages:\n\n* [Deploy a WAF managed ruleset in the dashboard (zone)](https://developers.cloudflare.com/waf/managed-rules/deploy-zone-dashboard/)\n* [Deploy a WAF managed ruleset in the dashboard (account)](https://developers.cloudflare.com/waf/account/managed-rulesets/deploy-dashboard/)\n\n## Deploy a managed ruleset to a phase at the zone level\n\nUse the following workflow to deploy a managed ruleset to a phase at the zone level.\n\n1. Get your [zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/).\n2. Invoke the [List account rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to obtain the available managed rulesets. Managed rulesets exist at the account level, but you can deploy them to a zone. Find the ruleset ID of the managed ruleset you want to deploy.\n3. Identify the [phase](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) where you want to deploy the managed ruleset. Ensure that the managed ruleset belongs to the same phase where you want to deploy it.\n4. Add a rule to the zone-level phase [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) that executes the managed ruleset. Refer to the following example for details on this step.\n\nThe following example deploys the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) to the `http_request_firewall_managed` phase of a given zone (`$ZONE_ID`) by creating a rule that executes the managed ruleset.\n\n1. Invoke the [Get a zone entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/get/) operation to obtain the definition of the entry point ruleset for the `http_request_firewall_managed` phase. You will need the [zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) for this task.\n\n2. If the entry point ruleset already exists (that is, if you received a `200 OK` status code and the ruleset definition), take note of the ruleset ID in the response. Then, invoke the [Create a zone ruleset rule](https://developers.cloudflare.com/api/resources/rulesets/subresources/rules/methods/create/) operation to add an `execute` rule to the existing ruleset deploying the Cloudflare Managed Ruleset (with ID `efb7b8c949ac4650a09736fc376e9aee`). By default, the rule will be added at the end of the list of rules already in the ruleset.\n\n3. If the entry point ruleset does not exist (that is, if you received a `404 Not Found` status code in step 1), create it using the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation. Include a single rule in the `rules` array that executes the Cloudflare Managed Ruleset (with ID `efb7b8c949ac4650a09736fc376e9aee`) for all incoming requests in the zone.\n\nIn this example, the managed ruleset executes the behavior configured by Cloudflare. To customize the behavior of managed rulesets, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/).\n\n## Deploy a managed ruleset to a phase at the account level\n\nUse the following workflow to deploy a managed ruleset to a phase at the account level.\n\n1. Get your [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/).\n2. Invoke the [List account rulesets](https://developers.cloudflare.com/api/resources/rulesets/methods/list/) operation to obtain the available managed rulesets. Find the ruleset ID of the managed ruleset you want to deploy.\n3. Identify the [phase](https://developers.cloudflare.com/ruleset-engine/reference/phases-list/) where you want to deploy the managed ruleset. Ensure that the managed ruleset belongs to the same phase where you want to deploy it.\n4. Add a rule to the account-level phase [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset) that executes the managed ruleset. Use parentheses to enclose any custom conditions in the rule expression and end your expression with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan. Refer to the following example for details on this step.\n\nThe following example deploys the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) to the `http_request_firewall_managed` phase of a given account (`$ACCOUNT_ID`) by creating a rule that executes the managed ruleset. The rules in the managed ruleset are executed when the zone name matches one of `example.com` or `anotherexample.com`.\n\n1. Invoke the [Get an account entry point ruleset](https://developers.cloudflare.com/api/resources/rulesets/subresources/phases/methods/get/) operation to obtain the definition of the entry point ruleset for the `http_request_firewall_managed` phase. You will need the [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) for this task.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Account WAF Write`\n   * `Account WAF Read`\n   * `Account Rulesets Read`\n   * `Account Rulesets Write`\n\n2. If the entry point ruleset already exists (that is, if you received a `200 OK` status code and the ruleset definition), take note of the ruleset ID in the response. Then, invoke the [Create an account ruleset rule](https://developers.cloudflare.com/api/resources/rulesets/subresources/rules/methods/create/) operation to add an `execute` rule to the existing ruleset deploying the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) (with ID `efb7b8c949ac4650a09736fc376e9aee`). By default, the rule will be added at the end of the list of rules already in the ruleset.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Account WAF Write`\n   * `Account Rulesets Write`\n\nManaged rulesets deployed at the account level will only apply to incoming traffic of zones on an Enterprise plan. The expression of your `execute` rule must end with `and cf.zone.plan eq \"ENT\"` or else the API operation will fail.\n\n3. If the entry point ruleset does not exist (that is, if you received a `404 Not Found` status code in step 1), create it using the [Create an account ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation. Include a single rule in the `rules` array that executes the Cloudflare Managed Ruleset (with ID `efb7b8c949ac4650a09736fc376e9aee`) for all incoming requests where the zone name matches one of `example.com` or `anotherexample.com`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Account WAF Write`\n   * `Account Rulesets Write`\n\nIn this example, the managed ruleset executes the behavior configured by Cloudflare. To learn how to customize the behavior of managed rulesets, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/).\n\n<page>\n---\ntitle: Create an exception · Cloudflare Ruleset Engine docs\ndescription: Use exceptions to skip the execution of a managed ruleset of some of its rules.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/create-exception/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/create-exception/index.md\n---\n\nUse [exceptions](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/) to skip the execution of a managed ruleset of some of its rules.\n\nThe exception configuration includes an [expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/) that defines the skip conditions, and the rules or managed rulesets to skip under those conditions.\n\nIf you are using Terraform, refer to [Configure exceptions](https://developers.cloudflare.com/terraform/additional-configurations/waf-managed-rulesets/#configure-exceptions) in the Terraform documentation.\n\nIf you are using the Cloudflare dashboard, refer to [Add an exception in the dashboard](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/define-dashboard/).\n\nCurrently, only the [Cloudflare Web Application Firewall (WAF)](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/) supports managed rules exceptions.\n\n## Types of exceptions\n\nAn exception can have one of the following behaviors (from highest to lowest priority):\n\n* [Skip all remaining rules in the entry point ruleset](#skip-all-remaining-rules)\n* [Skip one or more managed rulesets](#skip-one-or-more-managed-rulesets)\n* [Skip one or more rules of managed rulesets](#skip-one-or-more-rules-of-managed-rulesets)\n\nYou define exceptions in a given context — zone level or account level — and they apply only to that context. For example, if you define an exception that skips all remaining rules at the account level, the rules defined in the entry point ruleset at the zone level will still be evaluated.\n\nIf there is a match for the expressions of several exceptions, Cloudflare will consider the exception with the highest priority.\n\nExceptions only apply to rules executing a managed ruleset listed after them. If you add an exception at the end of the list of rules of an entry point ruleset, nothing will be skipped.\n\nAdditional requirement for account-level exceptions\n\nRules in entry point rulesets at the account level only apply to Enterprise zones. This also includes exceptions (or skip rules). When adding an exception at the account level, you must use parentheses to enclose any custom conditions in the rule expression and end the expression with `and cf.zone.plan eq \"ENT\"`, or else the API operation will fail.\n\n### Skip all remaining rules\n\nTo skip all the remaining rules in the [entry point ruleset](https://developers.cloudflare.com/ruleset-engine/about/rulesets/#entry-point-ruleset), create a rule with `skip` action and include `\"ruleset\": \"current\"` in the `action_parameters` object.\n\nExample of rule definition:\n\nSkipping all remaining rules only affects the rules in the current context (account or zone). For example, adding a rule with `skip` action to the account-level phase entry point ruleset has no impact on the rules defined in the zone-level phase entry point ruleset — these zone-level rules will still be evaluated.\n\nFor a full example, refer to the [WAF documentation](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/define-api/#skip-all-remaining-rules).\n\n### Skip one or more managed rulesets\n\nTo skip one or more managed rulesets, create a rule with `skip` action containing a `rulesets` field in the `action_parameters` object. The `rulesets` field must contain a list of managed ruleset IDs you want to skip.\n\nExample of rule definition:\n\nFor a full example, refer to the [WAF documentation](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/define-api/#skip-the-cloudflare-managed-ruleset).\n\n### Skip one or more rules of managed rulesets\n\nTo skip one or more rules of managed rulesets, create a rule with `skip` action containing a `rules` object in the `action_parameters` object. The `rules` object must contain one or more managed ruleset IDs as keys, and a list of rules to skip in those managed rulesets as the value of each key.\n\nExample of a rule definition that skips rules `A` and `B` of managed ruleset `1`, and rule `X` of managed ruleset `2`:\n\nThe rules in the `rules` object must belong to the specified managed rulesets, otherwise you will get an error.\n\nFor a full example, refer to the [WAF documentation](https://developers.cloudflare.com/waf/managed-rules/waf-exceptions/define-api/#skip-one-or-more-rules-of-waf-managed-rulesets).\n\n* Exceptions have priority over [overrides](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/).\n* If you define an exception that skips all remaining rules, the expressions of those rules are not evaluated.\n* If you define an exception that skips a rule of a managed ruleset, the expression of the rule that executes the managed ruleset is evaluated and the managed ruleset rules are executed except for that specific rule, which is bypassed.\n\n<page>\n---\ntitle: Managed ruleset override examples · Cloudflare Ruleset Engine docs\ndescription: \"The examples in the topics below use overrides to customize the\n  behavior of managed rulesets:\"\nlastUpdated: 2024-09-06T15:21:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/index.md\n---\n\nThe examples in the topics below use overrides to customize the behavior of managed rulesets:\n\n* [Set WordPress rules to Block](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-wordpress-block/)\n* [Enable only Joomla rules](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-joomla-only/)\n* [Enable only selected rules](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/enable-selected-rules/)\n* [Deploy a managed ruleset with ruleset, tag, and rule overrides](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ruleset-tag-rule/)\n* [Adjust the sensitivity of an HTTP DDoS rule to Low](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ddos-rule-sensitivity/)\n* [Adjust an L3/4 DDoS rule](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-api/#configure-an-override-for-the-network-layer-ddos-attack-protection-managed-ruleset)\n\nFor more information on overriding managed rulesets, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/).\n\n<page>\n---\ntitle: Override a managed ruleset · Cloudflare Ruleset Engine docs\ndescription: To customize the behavior of a managed ruleset via API, override\n  the ruleset at deployment. When you override a ruleset you specify changes to\n  be executed on top of the default configuration. These changes take precedence\n  over the ruleset's default behavior.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/index.md\n---\n\nTo customize the behavior of a managed ruleset via API, override the ruleset at deployment. When you override a ruleset you specify changes to be executed on top of the default configuration. These changes take precedence over the ruleset's default behavior.\n\nFor example, to test a managed ruleset before enforcing it, consider executing the ruleset with all rules set to `log` instead of their default actions. To do this, override the configured behavior of the managed ruleset at the ruleset level, so that each rule uses the `log` action.\n\nIf you are using Terraform, refer to the following pages:\n\n* [WAF Managed Rules configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/waf-managed-rulesets/#configure-overrides)\n* [DDoS managed rulesets configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/ddos-managed-rulesets/)\n\nTo define overrides in the Cloudflare dashboard, refer to the following resources:\n\n* [Configure a WAF managed ruleset in the dashboard](https://developers.cloudflare.com/waf/managed-rules/deploy-zone-dashboard/#configure-a-managed-ruleset)\n* [Configure HTTP DDoS Attack Protection in the dashboard](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-dashboard/)\n* [Configure Network-layer DDoS Attack Protection in the dashboard](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-dashboard/)\n\n## Work with overrides\n\nYou can override a ruleset at three levels:\n\n* **Ruleset overrides** apply to all rules in the executed ruleset.\n* **Tag overrides** apply to all rules with a specific tag. For example, use a tag override to customize the Cloudflare Managed Ruleset so all rules with the `wordpress` tag are set to *Block*. If multiple tags have overrides and if a given rule has more than one of these tags, the tag overrides order determines the behavior. For rules tagged with multiple overridden tags, the last tag's overrides apply.\n* **Rule overrides** apply to specific rules in a managed ruleset, referenced by their Rule ID.\n\nSpecific overrides take precedence over more general ones, and rule overrides take precedence over tag overrides, which take precedence over ruleset overrides.\n\nRuleset overrides and tag overrides apply to both existing and **future** rules in the managed ruleset. If you want to override existing rules only, you must use rule overrides.\n\nTo apply an override for a managed ruleset:\n\n1. Use one of the [update ruleset operations](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) to update your phase entry point ruleset.\n2. Specify the `overrides` in the `action_parameters` of the rule that executes your managed ruleset.\n\nYou can override the following rule properties:\n\n* `\"action\"`\n* `\"enabled\"`\n\nSome managed rulesets may have additional override requirements, or they may allow you to override other rule properties. Check each Cloudflare product’s documentation for details.\n\nIt is **not recommended** that you enable all the rules in a managed ruleset at the account level using an override, since this change could affect all the zones in your account. Some rules are disabled by default, since they could eventually affect legitimate traffic, and should not be enabled across zones without previous consideration.\n\n### Rule override example\n\nThe following `PUT` request adds a rule that executes a managed ruleset in the `http_request_firewall_managed` phase at the zone level, and defines a rule override to enable rule `<RULE_ID>` and set its action to `log`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`\n\n### Ruleset override example\n\nThe following `PUT` request adds a rule that executes a managed ruleset in the `http_request_firewall_managed` phase at the account level, and defines a ruleset override that sets the action to `log` for all (enabled) rules.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n\nFor additional examples of configuring overrides via API, refer to [Override examples](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/).\n\n<page>\n---\ntitle: Phases list · Cloudflare Ruleset Engine docs\ndescription: The following tables list the phases of Cloudflare products powered\n  by the Ruleset Engine, in the order those phases are executed. Some products\n  such as the Cloudflare Web Application Firewall have more than one associated\n  phase.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/reference/phases-list/\n  md: https://developers.cloudflare.com/ruleset-engine/reference/phases-list/index.md\n---\n\nThe following tables list the [phases](https://developers.cloudflare.com/ruleset-engine/about/phases/) of Cloudflare products powered by the Ruleset Engine, in the order those phases are executed. Some products such as the Cloudflare Web Application Firewall have more than one associated phase.\n\n[Network-layer](https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/) phases apply to packets received on the Cloudflare global network.\n\n| Phase name | Used in product/feature |\n| - | - |\n| `ddos_l4` | [Network-layer DDoS Attack Protection](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-api/) |\n| `magic_transit` | [Magic Firewall](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/) |\n| `magic_transit_managed` | [Magic Firewall managed rulesets](https://developers.cloudflare.com/magic-firewall/how-to/enable-managed-rulesets/) |\n| `magic_transit_ratelimit` | [Magic Firewall rate limiting rules](https://developers.cloudflare.com/magic-firewall/how-to/create-rate-limiting-rules/) |\n| `magic_transit_ids_managed` | [Magic Firewall Intrusion Detection System (IDS)](https://developers.cloudflare.com/magic-firewall/about/ids/) |\n\n[Application-layer](https://www.cloudflare.com/learning/ddos/what-is-layer-7/) phases apply to requests received on the Cloudflare global network.\n\nThe phases execute in the order they appear in the table.\n\n| Phase name | Used in product/feature |\n| - | - |\n| `http_request_sanitize` | [URL normalization](https://developers.cloudflare.com/rules/normalization/) |\n| `http_request_dynamic_redirect` | [Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/) |\n| `http_request_transform` | [URL Rewrite Rules](https://developers.cloudflare.com/rules/transform/url-rewrite/) |\n| *N/A* (internal phase) | [Waiting Room Rules](https://developers.cloudflare.com/waiting-room/additional-options/waiting-room-rules/) |\n| `http_request_api_gateway_early`\\* | [API Shield](https://developers.cloudflare.com/api-shield/) |\n| `http_config_settings` | [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/) |\n| `http_request_origin` | [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/) |\n| `ddos_l7`\\* | [HTTP DDoS Attack Protection](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/) |\n| `http_request_firewall_custom` | [Custom rules (Web Application Firewall)](https://developers.cloudflare.com/waf/custom-rules/) |\n| `http_ratelimit` | [Rate limiting rules (WAF)](https://developers.cloudflare.com/waf/rate-limiting-rules/) |\n| `http_request_api_gateway_late` | [API Shield](https://developers.cloudflare.com/api-shield/) |\n| `http_request_firewall_managed` | [WAF Managed Rules](https://developers.cloudflare.com/waf/managed-rules/) |\n| `http_request_sbfm` | [Super Bot Fight Mode](https://developers.cloudflare.com/bots/get-started/super-bot-fight-mode/) |\n| *N/A* (internal phase) | [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) |\n| `http_request_redirect` | [Bulk Redirects](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/) |\n| *N/A* (internal phase) | [Managed Transforms](https://developers.cloudflare.com/rules/transform/managed-transforms/) |\n| `http_request_late_transform` | [Request Header Transform Rules](https://developers.cloudflare.com/rules/transform/request-header-modification/) |\n| `http_request_cache_settings` | [Cache Rules](https://developers.cloudflare.com/cache/how-to/cache-rules/) |\n| `http_request_snippets` | [Snippets](https://developers.cloudflare.com/rules/snippets/) |\n| `http_request_cloud_connector` | [Cloud Connector](https://developers.cloudflare.com/rules/cloud-connector/) |\n\n\\* *This phase is for configuration purposes only — the corresponding rules will not be executed at this stage in the request handling process.*\n\nChange notice for Super Bot Fight Mode rulesets\n\nUpdating Super Bot Fight Mode rules via the Rulesets API is no longer supported and may cause unexpected behavior if you do so.\n\nThe phases execute in the order they appear in the table.\n\n| Phase name | Used in product/feature |\n| - | - |\n| `http_custom_errors` | [Custom Errors](https://developers.cloudflare.com/rules/custom-errors/) |\n| *N/A* (internal phase) | [Managed Transforms](https://developers.cloudflare.com/rules/transform/managed-transforms/) |\n| `http_response_headers_transform` | [Response Header Transform Rules](https://developers.cloudflare.com/rules/transform/response-header-modification/) |\n| `http_ratelimit` | [Rate limiting rules](https://developers.cloudflare.com/waf/rate-limiting-rules/) (when they use response information) |\n| `http_response_compression` | [Compression Rules](https://developers.cloudflare.com/rules/compression-rules/) |\n| `http_response_firewall_managed` | [Cloudflare Sensitive Data Detection](https://developers.cloudflare.com/waf/managed-rules/) (Data Loss Prevention) |\n| `http_log_custom_fields` | [Logpush custom fields](https://developers.cloudflare.com/logs/logpush/logpush-job/custom-fields/) |\n\n<page>\n---\ntitle: Actions reference · Cloudflare Ruleset Engine docs\ndescription: Learn about actions supported by the Rules language, including\n  Block, Skip, and Log.\nlastUpdated: 2025-11-27T11:05:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/actions/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/actions/index.md\n---\n\nThe action of a rule tells Cloudflare how to handle matches for the rule [expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/).\n\nThe table below lists the actions available in the Rules language.\n\nSome actions like *Block*, called terminating actions, will stop the evaluation of the remaining rules. The *Skip* action will skip the evaluation of *some* rules when there is a match, but the exact behavior will depend on the rule configuration.\n\nThe available actions depend on the [phase](https://developers.cloudflare.com/ruleset-engine/about/phases/) where you are configuring the rule. Refer to each product’s documentation for details on the phase(s) supported by that product.\n\n| Action | Description | Terminating action? |\n| - | - | - |\n| **Interactive Challenge** API value: `challenge` | Useful for ensuring that the visitor accessing the site is human, not automated.The client that made the request must pass an interactive challenge.If successful, Cloudflare accepts the matched request; otherwise, it is blocked. | Yes |\n| **JS Challenge** API value: `js_challenge` | Useful for ensuring that bots and spam cannot access the requested resource; browsers, however, are free to satisfy the challenge automatically.The client that made the request must pass a Cloudflare JavaScript Challenge before proceeding.If successful, Cloudflare accepts the matched request; otherwise, it is blocked. | Yes |\n| **Managed Challenge (Recommended)** API value: `managed_challenge` | Helps reduce the lifetimes of human time spent solving CAPTCHAs across the Internet.Depending on the characteristics of a request, Cloudflare will dynamically choose the appropriate type of challenge from the following actions based on specific criteria:- Show a non-interactive challenge page (similar to the current JS Challenge).\n- Show a custom interactive challenge (such as click a button). | Yes |\n| **Block** API value: `block` | Matching requests are denied access to the site.Depending on the Cloudflare product performing the block action, the HTTP status code can be [`403`](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/4xx-client-error/error-403/#cloudflare-specific-information) (most security features) or [`429`](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/4xx-client-error/error-429/#website-end-users) (for example, rate limiting rules).Customers on paid plans can customize the HTML error page displayed to website visitors due to the block action. Refer to [Error Pages](https://developers.cloudflare.com/rules/custom-errors/#error-pages) for more information.Customers in Pro plans and above can customize the response (HTML, JSON, XML, or plain text) and the response status code for each [custom rule](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/#configure-a-custom-response-for-blocked-requests) or [rate limiting rule](https://developers.cloudflare.com/waf/rate-limiting-rules/create-zone-dashboard/#configure-a-custom-response-for-blocked-requests) that triggers a block action. | Yes |\n| **Skip** API value: `skip` | Allows user to dynamically skip one or more security features or products for a request.Depending on the rule configuration, matching requests will skip the evaluation of one or more security features or products:- Skip all remaining rules in the current ruleset\n- Skip all remaining rules in the current phase (zone-level only option)\n- Skip rulesets\n- Skip rules of a ruleset\n- Skip phases\n- Skip specific security products that are not based on the Ruleset EngineThe available skip options depend on the phase where you configure the rule. Refer to each product’s documentation for details.If you configure a rule with the *Skip* action at the account level it will only affect rules/phases configured at the account level, not at the zone level. To skip rules/phases at the zone level you must configure a rule with the *Skip* action at the zone level. | No (but some rules may be skipped) |\n| **Log** API value: `log` | Records matching requests in the Cloudflare Logs.Only available on Enterprise plans.Recommended for validating rules before committing to a more severe action. | No |\n| **Execute** API value: `execute` | Executes the rules in the ruleset specified in the rule configuration. You can specify a managed ruleset or a custom ruleset to execute.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. | No |\n| **Rewrite** API value: `rewrite` | Rewrites the request (or response) by adjusting the URI path, query string, and/or HTTP request/response headers, according to the rule configuration.Only available in:- [Transform Rules](https://developers.cloudflare.com/rules/transform/), in phases `http_request_transform`, `http_request_late_transform`, and `http_response_headers_transform`. In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, create a Transform Rule.\n- WAF custom rules checking for [exposed credentials](https://developers.cloudflare.com/waf/managed-rules/check-for-exposed-credentials/), in the `http_request_firewall_custom` phase at the account level. In the Cloudflare dashboard, this action is called *Exposed-Credential-Check Header*. | No |\n| **Redirect** API value: `redirect` | Navigates the user from a source URL to a target URL, according to the rule configuration, by replying with an HTTP redirect.Only available for [Single Redirects](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/) and [Bulk Redirects](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/).In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, create a redirect rule or a bulk redirect rule. | Yes |\n| **Route** API value: `route` | Adjusts the `Host` header, Server Name Indication (SNI), resolved hostname, and/or resolved destination port of incoming requests.Only available for [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/), in the `http_request_origin` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, create an origin rule. | No |\n| **Set Configuration** API value: `set_config` | Changes the configuration settings of one or more Cloudflare products.Only available for [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/), in the `http_config_settings` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, [create a Configuration Rule](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/). | No |\n| **Compress Response** API value: `compress_response` | Defines compression settings for delivering responses to website visitors.Only available for [Compression Rules](https://developers.cloudflare.com/rules/compression-rules/), in the `http_response_compression` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, [create a compression rule](https://developers.cloudflare.com/rules/compression-rules/create-dashboard/). | No |\n| **Set Cache Settings** API value: `set_cache_settings` | Cache Rules allows you to customize cache settings on Cloudflare.Only available for [Cache Rules](https://developers.cloudflare.com/cache/how-to/cache-rules/), in the `http_request_cache_settings` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, [create a cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/create-dashboard/). | No |\n| **Serve Error** API value: `serve_error` | Serves error content to the website visitor, according to the custom error rule configuration.Only available for [Custom Error Rules](https://developers.cloudflare.com/rules/custom-errors/#custom-error-rules), in the `http_custom_errors` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, [create a custom error rule](https://developers.cloudflare.com/rules/custom-errors/create-rules/#create-a-custom-error-rule-dashboard). | Yes |\n| **Log custom field** API value: `log_custom_field` | Configures custom fields for Logpush jobs in a zone.Only available for [custom fields](https://developers.cloudflare.com/logs/logpush/logpush-job/custom-fields/), in the `http_log_custom_fields` phase.In the Cloudflare dashboard, this action is not listed in action selection dropdowns. To use this action, [configure custom log fields](https://developers.cloudflare.com/logs/logpush/logpush-job/custom-fields/#enable-custom-fields-via-dashboard) for Logpush jobs. | Yes |\n\nCloudflare Firewall Rules, now deprecated, supports a different set of actions, including the *Allow* and *Bypass* actions. Refer to [Firewall rules actions](https://developers.cloudflare.com/firewall/cf-firewall-rules/actions/) for more information.\n\n<page>\n---\ntitle: Rule expressions · Cloudflare Ruleset Engine docs\ndescription: \"The Rules language supports two kinds of expressions: simple and compound.\"\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/index.md\n---\n\nThe Rules language supports two kinds of expressions: simple and compound.\n\n## Simple expressions\n\n**Simple expressions** compare a value from an HTTP request to a value defined in the expression. For example, this simple expression matches Microsoft Exchange Autodiscover requests:\n\nSimple expressions have the following syntax:\n\n* [Fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/) specify properties associated with an HTTP request.\n\n* [Comparison operators](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators) define how values must relate to actual request data for an expression to return `true`.\n\n* [Values](https://developers.cloudflare.com/ruleset-engine/rules-language/values/) represent the data associated with fields. When evaluating a rule, Cloudflare compares these values with the actual data obtained from the request.\n\n## Compound expressions\n\n**Compound expressions** use [logical operators](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#logical-operators) such as `and` to combine two or more expressions into a single expression.\n\nFor example, this expression uses the `and` operator to target requests to `www.example.com` that are not on ports 80 or 443:\n\nCompound expressions have the following general syntax:\n\nCompound expressions allow you to generate sophisticated, highly targeted rules.\n\n## Maximum rule expression length\n\nThe maximum length of a rule expression is 4,096 characters.\n\nThis limit applies whether you use the visual [Expression Builder](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-builder) to define your expression, or write the expression manually in the [Expression Editor](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-editor).\n\n## Additional features\n\nYou can also use the following Rules language features in your expressions:\n\n* [Grouping symbols](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#grouping-symbols) allow you to explicitly group expressions that should be evaluated together.\n\n* [Functions](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/) allow you to manipulate and validate values in expressions.\n\n<page>\n---\ntitle: Fields reference · Cloudflare Ruleset Engine docs\ndescription: \"The Cloudflare Rules language supports different types of fields such as:\"\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/fields/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/fields/index.md\n---\n\nThe Cloudflare Rules language supports different types of fields such as:\n\n* Request fields that represent the basic properties of incoming requests, including specific fields for accessing request headers, URI components, and the request body.\n* Dynamic fields that represent computed or derived values, typically related to threat intelligence about an HTTP request.\n* Response fields that represent the basic properties of the received response.\n* Raw fields that preserve the original request values for later evaluations.\n\nRefer to the [Fields reference](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/) for the list of available fields.\n\n## Differences from Wireshark display fields\n\nMost fields supported by the Cloudflare Rules language use the same naming conventions as [Wireshark display fields](https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html). However, there are some subtle differences between Cloudflare and Wireshark:\n\n* Wireshark supports [CIDR (Classless Inter-Domain Routing) notation](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing) for expressing IP address ranges in equality comparisons (`ip.src == 1.2.3.0/24`, for example). Cloudflare does not.\n\nTo evaluate a range of addresses using CIDR notation, use the [`in`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators) comparison operator as in this example: `ip.src in {1.2.3.0/24 4.5.6.0/24}`.\n\n* In Wireshark, `ssl` is a protocol field containing hundreds of other fields of various types that are available for comparison in multiple ways. However, in the Rules language [`ssl`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ssl/) is a single Boolean field that indicates whether the connection from the client to Cloudflare is encrypted.\n\n* The Cloudflare Rules language does not support the `slice` operator.\n\n<page>\n---\ntitle: Functions reference · Cloudflare Ruleset Engine docs\ndescription: \"The Cloudflare Rules language provides functions for manipulating\n  and validating values in an expression:\"\nlastUpdated: 2025-12-22T11:16:27.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/functions/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/functions/index.md\n---\n\nThe Cloudflare Rules language provides functions for manipulating and validating values in an expression:\n\n* [Transformation functions](#transformation-functions) manipulate values extracted from an HTTP request.\n* The [HMAC validation function](#hmac-validation) tests the validity of an HMAC token. Use it to write expressions that target requests based on the presence of a valid HMAC token.\n\n## Transformation functions\n\nThe Rules language supports several functions that transform values extracted from HTTP requests. A common use case for transformation functions is the conversion of a string of characters to uppercase or lowercase, since by default, string evaluation is case-sensitive.\n\nFor example, the `lower()` function converts all uppercase characters in a string to lowercase.\n\nIn the expression below, the `lower()` function transforms `http.host` values to lowercase so that they match the target value `\"www.cloudflare.com\"`:\n\nTransformation functions that do not take arrays as an argument type require the `[*]` index notation. Refer to [Arrays](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#arrays) for more information.\n\nThe Rules language supports these transformation functions:\n\n`any(Array<Boolean>)`: Boolean\n\nReturns `true` when the comparison operator in the argument returns `true` for *any* of the values in the argument array. Returns `false` otherwise.\n\n`all(Array<Boolean>)`: Boolean\n\nReturns `true` when the comparison operator in the argument returns `true` for *all* values in the argument array. Returns `false` otherwise.\n\n`cidr(address IP address, ipv4_network_bits Integer, ipv6_network_bits Integer)`: IP address\n\nReturns the network address corresponding to an IP address (IPv4 or IPv6), given the provided IPv4 and IPv6 network bits (which determine the corresponding netmasks).\n\nThe `address` parameter must be a field, that is, it cannot be a literal String.\n\nThe `ipv4_network_bits` value must be between 1 and 32, and the `ipv6_network_bits` value must be between 1 and 128.\n\n* If `ip.src` is `113.10.0.2`, `cidr(ip.src, 24, 24)` will return `113.10.0.0`.\n* If `ip.src` is `2001:0000:130F:0000:0000:09C0:876A:130B`, `cidr(ip.src, 24, 24)` will return `2001:0000:0000:0000:0000:0000:0000:0000`.\n\nYou can only use the `cidr()` function in [custom rules](https://developers.cloudflare.com/waf/custom-rules/) and [rate limiting rules](https://developers.cloudflare.com/waf/rate-limiting-rules/).\n\n`cidr6(address IP address, ipv6_network_bits Integer)`: IP address\n\nReturns the IPv6 network address corresponding to an IPv6 address, given the provided network bits (which determine the netmask). If you provide an IPv4 address in the first parameter, it will be returned unchanged.\n\nThe `address` parameter must be a field, that is, it cannot be a literal String.\n\nThe `ipv6_network_bits` value must be between 1 and 128.\n\nThis function is equivalent to: `cidr(<address>, 32, <ipv6_network_bits>)`.\n\n* If `ip.src` is `2001:0000:130F:0000:0000:09C0:876A:130B`, `cidr6(ip.src, 24)` will return `2001:0000:0000:0000:0000:0000:0000:0000`.\n* If `ip.src` is `113.10.0.2`, `cidr6(ip.src, 24)` will return `113.10.0.2` (unchanged).\n\nYou can only use the `cidr6()` function in [custom rules](https://developers.cloudflare.com/waf/custom-rules/) and [rate limiting rules](https://developers.cloudflare.com/waf/rate-limiting-rules/).\n\n`concat(String | Bytes | Array)`: String | Array\n\nTakes a comma-separated list of values. Concatenates the argument values into a single String or array.\n\nThe return type depends on the type of input arguments. For example, if you concatenate arrays, the function will return an array.\n\nFor example, `concat(\"String1\", \" \", \"String\", \"2\")` will return `\"String1 String2\"`.\n\n`decode_base64(source String)`: String\n\nDecodes a Base64-encoded String specified in `source`.\n\n`source` must be a field, that is, it cannot be a literal String.\n\nFor example, with the following HTTP request header: `client_id: MTIzYWJj`, `(any(decode_base64(http.request.headers[\"client_id\"][*])[*] eq \"123abc\"))` would return `true`.\n\nYou can only use the `decode_base64()` function in [Transform Rules](https://developers.cloudflare.com/rules/transform/), [custom rules](https://developers.cloudflare.com/waf/custom-rules/), and [rate limiting rules](https://developers.cloudflare.com/waf/rate-limiting-rules/).\n\n`ends_with(source String, substring String)`: Boolean\n\nReturns `true` when the source ends with a given substring. Returns `false` otherwise. The source cannot be a literal value (like `\"foo\"`).\n\nFor example, if `http.request.uri.path` is `\"/welcome.html\"`, then `ends_with(http.request.uri.path, \".html\")` will return `true`.\n\n`join(items Array<String>, separator String)`: String\n\nReturns a string which is the concatenation of the strings in `items` with the `separator` between each item.\n\nIf any of the arguments is nil, the returned value will be nil.\\\nIf the `items` array is empty, the returned value will be an empty string.\\\nIf the `items` array contains a single item, then no concatenation occurs and the (single) item will be returned as is.\n\nThis function does the opposite of the [`split()`](#split) function.",
  "code_samples": [
    {
      "code": "https://api.cloudflare.com/client/v4",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/cloud_connector/rules\" \\\n  --request GET \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"id\": \"<RULE_1_ID>\",\n      \"provider\": \"aws_s3\",\n      \"expression\": \"http.request.uri.path wildcard \\\"/images/*\\\"\",\n      \"description\": \"Connect to S3 bucket containing images\",\n      \"enabled\": true,\n      \"parameters\": {\n        \"host\": \"examplebucketwithimages.s3.north-eu.amazonaws.com\"\n      }\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/cloud_connector/rules\" \\\n  --request PUT \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '[\n    {\n        \"expression\": \"http.request.uri.path wildcard \\\"/images/*\\\"\",\n        \"provider\": \"cloudflare_r2\",\n        \"description\": \"Connect to R2 bucket containing images\",\n        \"parameters\": {\n            \"host\": \"mybucketcustomdomain.example.com\"\n        }\n    }\n  ]'",
      "language": "bash"
    },
    {
      "code": "resource \"cloudflare_cloud_connector_rules\" \"cloud_connector_rules\" {\n  zone_id = \"<ZONE_ID>\"\n\n\n  rules {\n    description = \"Route /data to GCP bucket\"\n    enabled     = true\n    expression  = \"(http.request.uri.path wildcard \\\"*/data/*\\\")\"\n    provider    = \"gcp_storage\"\n    parameters {\n      host = \"mystorage.storage.googleapis.com\"\n    }\n  }\n\n\n  rules {\n    description = \"Route /resources to AWS bucket\"\n    enabled     = true\n    expression  = \"(http.request.uri.path wildcard \\\"*/resources/*\\\")\"\n    provider    = \"aws_s3\"\n    parameters {\n      host = \"mystorage.s3.ams.amazonaws.com\"\n    }\n  }\n\n\n  rules {\n    description = \"Route /files to Azure bucket\"\n    enabled     = true\n    expression  = \"(http.request.uri.path wildcard \\\"*/files/*\\\")\"\n    provider    = \"azure_storage\"\n    parameters {\n      host = \"mystorage.blob.core.windows.net\"\n    }\n  }\n\n\n  rules {\n    description = \"Route /images to R2 bucket\"\n    enabled     = true\n    expression  = \"(http.request.uri.path wildcard \\\"*/images/*\\\")\"\n    provider    = \"cloudflare_r2\"\n    parameters {\n      host = \"mybucketcustomdomain.example.com\"\n    }\n  }\n}",
      "language": "tf"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"enable_email_obfuscation_bic\",\n            \"expression\": \"starts_with(http.request.uri.path, \\\"/contact-us/\\\")\",\n            \"description\": \"Obfuscates email addresses and enables BIC in contacts page\",\n            \"action\": \"set_config\",\n            \"action_parameters\": {\n                \"email_obfuscation\": true,\n                \"bic\": true\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"enable_under_attack_in_admin\",\n            \"expression\": \"http.host eq \\\"admin.example.com\\\"\",\n            \"description\": \"Turn on Under Attack mode for admin area\",\n            \"action\": \"set_config\",\n            \"action_parameters\": {\n                \"security_level\": \"under_attack\"\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "\"action_parameters\": {\n  \"automatic_https_rewrites\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"bic\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"disable_rum\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"disable_zaraz\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n    \"hotlink_protection\": false\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"email_obfuscation\": false\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"fonts\": false\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"mirage\": false\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"opportunistic_encryption\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"polish\": \"webp\"\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"rocket_loader\": true\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"security_level\": \"under_attack\"\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"ssl\": \"flexible\"\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n--json '{\n  \"name\": \"500_error_template\",\n  \"description\": \"Standard 5xx error template page\",\n  \"url\": \"https://example.com/errors/500_template.html\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"name\": \"500_error_template\",\n    \"description\": \"Standard 5xx error template page\",\n    \"url\": \"https://example.com/errors/500_template.html\",\n    \"last_updated\": \"2025-02-10T11:36:07.810215Z\",\n    \"size_bytes\": 2048\n  },\n  \"success\": true\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/custom_pages/assets",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"name\": \"500_error_template\",\n      \"description\": \"Standard 5xx error template page\",\n      \"url\": \"https://example.com/errors/500_template.html\",\n      \"last_updated\": \"2025-02-10T11:36:07.810215Z\",\n      \"size_bytes\": 2048\n    }\n    // ...\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": [],\n  \"result_info\": {\n    \"count\": 2,\n    \"page\": 1,\n    \"per_page\": 20,\n    \"total_count\": 2,\n    \"total_pages\": 1\n  }\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4/accounts/$ZONE_ID/custom_pages/assets",
      "language": "txt"
    },
    {
      "code": "curl --request PUT \\\n\"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets/500_error_template\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n--json '{\n  \"description\": \"Standard 5xx error template page\",\n  \"url\": \"https://example.com/errors/500_new_template.html\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"name\": \"500_error_template\",\n    \"description\": \"Standard 5xx error template page\",\n    \"url\": \"https://example.com/errors/500_new_template.html\",\n    \"last_updated\": \"2025-02-10T13:13:07.810215Z\",\n    \"size_bytes\": 3145\n  },\n  \"success\": true\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4/accounts/{account_id}/custom_pages/assets/{asset_name}",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets/500_error_template\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"name\": \"500_error_template\",\n    \"description\": \"Standard 5xx error template page\",\n    \"url\": \"https://example.com/errors/500_new_template.html\",\n    \"last_updated\": \"2025-02-10T13:13:07.810215Z\",\n    \"size_bytes\": 3145\n  },\n  \"success\": true\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/custom_pages/assets/$ASSET_NAME",
      "language": "txt"
    },
    {
      "code": "curl --request DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets/500_error_template\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/custom_pages/assets/$ASSET_NAME",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_IDENTIFIER/custom_pages/ratelimit_block\" \\\n  --request GET \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"ratelimit_block\",\n    \"description\": \"Rate limit Block\",\n    \"required_tokens\": [],\n    \"preview_target\": \"block:rate-limit\",\n    \"created_on\": \"2025-06-03T08:33:17.091587Z\",\n    \"modified_on\": \"2025-06-03T08:33:17.091587Z\",\n    \"url\": null,\n    \"state\": \"default\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_IDENTIFIER/custom_pages/ratelimit_block\" \\\n  --request PUT \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"state\": \"customized\",\n    \"url\": \"https://example.com/rate_limiting_block_error_page.html\"\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"ratelimit_block\",\n    \"description\": \"Rate limit Block\",\n    \"required_tokens\": [],\n    \"preview_target\": \"block:rate-limit\",\n    \"created_on\": \"2025-06-03T08:33:17.091587Z\",\n    \"modified_on\": \"2025-06-03T08:35:32.639114Z\",\n    \"url\": \"https://example.com/rate_limiting_block_error_page.html\",\n    \"state\": \"customized\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_pages/assets\" \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--json '{\n  \"name\": \"500_error_template\",\n  \"description\": \"Standard 5xx error template page\",\n  \"url\": \"https://example.com/errors/500_template.html\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"name\": \"500_error_template\",\n    \"description\": \"Standard 5xx error template page\",\n    \"url\": \"https://example.com/errors/500_template.html\",\n    \"last_updated\": \"2025-02-10T11:36:07.810215Z\",\n    \"size_bytes\": 2048\n  },\n  \"success\": true\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_custom_errors/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"serve_500_template\",\n            \"action\": \"serve_error\",\n            \"action_parameters\": {\n                \"asset_name\": \"500_error_template\",\n                \"content_type\": \"text/html\"\n            },\n            \"expression\": \"http.response.code eq 500\",\n            \"enabled\": true\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "<html>\n  <head></head>\n  <body>\n    ::[REPLACE WITH CUSTOM ERROR TOKEN NAME]::\n  </body>\n</html>",
      "language": "html"
    },
    {
      "code": "<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>5XX Level Errors page</title>\n  </head>\n  <body>\n    <h1>5XX Level Errors</h1>\n    <h2>::CLOUDFLARE_ERROR_500S_BOX::</h2>\n  </body>\n</html>",
      "language": "html"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_custom_errors/entrypoint\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"json_response_for_5xx_errors\",\n              \"action\": \"serve_error\",\n              \"action_parameters\": {\n                  \"content\": \"{\\\"message\\\": \\\"A server error occurred.\\\"}\",\n                  \"content_type\": \"application/json\",\n                  \"status_code\": 530\n              },\n              \"expression\": \"http.response.code ge 500 and http.response.code lt 600\",\n              \"enabled\": true\n          }\n      ]\n    }'",
      "language": "bash"
    },
    {
      "code": "<!DOCTYPE html><html><head><meta charset=\"utf-8\"><title>Application unavailable</title></head><body><h1>Application temporarily unavailable</h1><p>Please try again later.</p></body></html>",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_custom_errors/entrypoint\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"html_response_500_to_503\",\n              \"action\": \"serve_error\",\n              \"action_parameters\": {\n                  \"content\": \"<!DOCTYPE html><html><head><meta charset=\\\"utf-8\\\"><title>Application unavailable</title></head><body><h1>Application temporarily unavailable</h1><p>Please try again later.</p></body></html>\",\n                  \"content_type\": \"text/html\",\n                  \"status_code\": 503\n              },\n              \"expression\": \"http.response.code eq 500\",\n              \"enabled\": true\n          }\n      ]\n    }'",
      "language": "bash"
    },
    {
      "code": "<!DOCTYPE html><html><head><meta charset=\"utf-8\"><title>Access denied</title></head><body><h1>You do not have access to this page</h1><p>Contact us if you think this is an error.</p></body></html>",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_custom_errors/entrypoint\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"html_response_cf_1020\",\n              \"action\": \"serve_error\",\n              \"action_parameters\": {\n                  \"content\": \"<!DOCTYPE html><html><head><meta charset=\\\"utf-8\\\"><title>Access denied</title></head><body><h1>You do not have access to this page</h1><p>Contact us if you think this is an error.</p></body></html>\",\n                  \"content_type\": \"text/html\"\n              },\n              \"expression\": \"cf.response.1xxx_code eq 1020\",\n              \"enabled\": true\n          }\n      ]\n    }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_custom_errors/entrypoint\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"rules\": [\n          {\n              \"ref\": \"serve_error_500_asset\",\n              \"action\": \"serve_error\",\n              \"action_parameters\": {\n                  \"asset_name\": \"500_error_template\",\n                  \"content_type\": \"text/html\"\n              },\n              \"expression\": \"http.response.code eq 500\",\n              \"enabled\": true\n          }\n      ]\n    }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"hr_app_overrides\",\n            \"expression\": \"starts_with(http.request.uri.path, \\\"/hr-app/\\\")\",\n            \"description\": \"Origin rule for the company HR application\",\n            \"action\": \"route\",\n            \"action_parameters\": {\n                \"host_header\": \"hr-server.example.com\",\n                \"origin\": {\n                    \"host\": \"hr-server.example.com\"\n                }\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Origin Rules ruleset\",\n    \"description\": \"Zone-level ruleset that will execute origin rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"ref\": \"hr_app_overrides\",\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"route\",\n        \"action_parameters\": {\n          \"host_header\": \"hr-server.example.com\",\n          \"origin\": {\n            \"host\": \"hr-server.example.com\"\n          }\n        },\n        \"expression\": \"starts_with(http.request.uri.path, \\\"/hr-app/\\\")\",\n        \"description\": \"Origin rule for the company HR application\",\n        \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n        \"ref\": \"<RULE_REF>\"\n      }\n    ],\n    \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n    \"phase\": \"http_request_origin\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"calendar_app_change_port\",\n            \"expression\": \"starts_with(http.request.uri.path, \\\"/team/calendar/\\\")\",\n            \"description\": \"Origin rule for the team calendar application\",\n            \"action\": \"route\",\n            \"action_parameters\": {\n                \"origin\": {\n                    \"port\": 8081\n                }\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Origin Rules ruleset\",\n    \"description\": \"Zone-level ruleset that will execute origin rules.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"ref\": \"calendar_app_change_port\",\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"route\",\n        \"action_parameters\": {\n          \"origin\": {\n            \"port\": 8081\n          }\n        },\n        \"expression\": \"starts_with(http.request.uri.path, \\\"/team/calendar/\\\")\",\n        \"description\": \"Origin rule for the team calendar application\",\n        \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n        \"ref\": \"<RULE_REF>\"\n      }\n    ],\n    \"last_updated\": \"2022-06-03T14:42:04.219025Z\",\n    \"phase\": \"http_request_origin\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"ref\": \"override_sni_for_admin\",\n            \"expression\": \"http.host eq \\\"admin.example.com\\\"\",\n            \"description\": \"SNI Override for the admin area\",\n            \"action\": \"route\",\n            \"action_parameters\": {\n                \"sni\": {\n                    \"value\": \"sni.example.com\"\n                }\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"rules\": [\n    {\n      \"expression\": \"http.request.uri.query contains \\\"/eu/\\\"\",\n      \"description\": \"Origin rule #1\",\n      \"action\": \"route\",\n      \"action_parameters\": {\n        \"host_header\": \"example.com\",\n        \"origin\": {\n          \"port\": 8081\n        }\n      }\n    },\n    {\n      \"expression\": \"http.request.uri.query contains \\\"/eu/\\\"\",\n      \"description\": \"Origin rule #2\",\n      \"action\": \"route\",\n      \"action_parameters\": {\n        \"host_header\": \"example.net\",\n        \"origin\": {\n          \"host\": \"example.net\"\n        }\n      }\n    }\n  ]\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"host_header\": \"<HOST_HEADER_VALUE>\"\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"sni\": {\n    \"value\": \"<SNI_VALUE>\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"origin\": {\n    \"host\": \"<HOSTNAME>\",\n    \"port\": <PORT>\n  }\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"host_header\": \"<HOST_HEADER_VALUE>\",\n  \"origin\": {\n    \"port\": <PORT>\n  }\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\"",
      "language": "bash"
    },
    {
      "code": "{ \"always\": true }",
      "language": "json"
    },
    {
      "code": "{ \"with_secret\": \"<SECRET>\" }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n--json '{ \"with_secret\": \"MySecretString321#\" }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://example.com/company_app\" \\\n--header \"Cookie: disable_esc=MySecretString321#\"",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n--json '{ \"always\": true }'",
      "language": "bash"
    },
    {
      "code": "curl --request DELETE \\\n\"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\"",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\"",
      "language": "bash"
    },
    {
      "code": "{ \"always\": true }",
      "language": "json"
    },
    {
      "code": "{ \"with_secret\": \"<SECRET>\" }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n--json '{ \"with_secret\": \"MySecretString321#\" }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://example.com/company_app\" \\\n--header \"Cookie: disable_esc=MySecretString321#\"",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n--json '{ \"always\": true }'",
      "language": "bash"
    },
    {
      "code": "curl --request DELETE \\\n\"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/disable_esc\" \\\n--header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n--header \"X-Auth-Email: $CLOUDFLARE_EMAIL\"",
      "language": "bash"
    },
    {
      "code": "<OTHER_RULE_CONDITIONS> and not starts_with(http.request.uri, \"/cdn-cgi/challenge-platform/\")",
      "language": "txt"
    },
    {
      "code": "Created during Cloudflare Rules deployment process for <RULE_NAME>",
      "language": "txt"
    },
    {
      "code": "\"action_parameters\": {\n  \"algorithms\": [\n    { \"name\": \"<VALUE1>\" },\n    { \"name\": \"<VALUE2>\" },\n    // ...\n  ]\n}",
      "language": "json"
    },
    {
      "code": "https://api.cloudflare.com/client/v4",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/snippets/$SNIPPET_NAME\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --form \"files=@example.js\" \\\n  --form \"metadata={\\\"main_module\\\": \\\"example.js\\\"}\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"errors\": [],\n  \"messages\": [],\n  \"success\": true,\n  \"result\": {\n    \"created_on\": \"2023-07-24-00:00:00\",\n    \"modified_on\": \"2023-07-24-00:00:00\",\n    \"snippet_name\": \"snippet_name_01\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/snippets/snippet_rules\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"description\": \"Trigger snippet on specific cookie\",\n            \"enabled\": true,\n            \"expression\": \"http.cookie eq \\\"a=b\\\"\",\n            \"snippet_name\": \"snippet_name_01\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "resource \"cloudflare_snippet\" \"my_snippet\" {\n  zone_id  = \"<ZONE_ID>\"\n  name = \"my_test_snippet_1\"\n  main_module = \"file1.js\"\n  files {\n    name = \"file1.js\"\n    content = file(\"file1.js\")\n  }\n}\n\n\nresource \"cloudflare_snippet_rules\" \"cookie_snippet_rule\" {\n  zone_id  = \"<ZONE_ID>\"\n  rules {\n    enabled = true\n    expression = \"http.cookie eq \\\"a=b\\\"\"\n    description = \"Trigger snippet on specific cookie\"\n    snippet_name = \"my_test_snippet_1\"\n  }\n  depends_on = [cloudflare_snippet.my_snippet]\n}",
      "language": "tf"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Get the current timestamp\n    const timestamp = Date.now();\n\n\n    // Convert the timestamp to hexadecimal format\n    const hexTimestamp = timestamp.toString(16);\n\n\n    // Clone the request and add the custom header with HEX timestamp\n    const modifiedRequest = new Request(request, {\n      headers: new Headers(request.headers),\n    });\n    modifiedRequest.headers.set(\"X-Hex-Timestamp\", hexTimestamp);\n\n\n    // Pass the modified request to the origin\n    const response = await fetch(modifiedRequest);\n\n\n    // Clone the response so that it's no longer immutable\n    const newResponse = new Response(response.body, response);\n\n\n    // Add a custom header with a value to the response\n    newResponse.headers.append(\n      \"x-snippets-hello\",\n      \"Hello from Cloudflare Snippets\",\n    );\n\n\n    // Delete headers from the response\n    newResponse.headers.delete(\"x-header-to-delete\");\n    newResponse.headers.delete(\"x-header2-to-delete\");\n\n\n    // Adjust the value for an existing header in the response\n    newResponse.headers.set(\"x-header-to-change\", \"NewValue\");\n\n\n    // Serve modified response to the visitor\n    return newResponse;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    return new Response(\n      `\n            <!DOCTYPE html>\n            <html lang=\"en\">\n            <head>\n                <meta charset=\"UTF-8\">\n                <title>We'll Be Right Back!</title>\n                <style> body { font-family: Arial, sans-serif; text-align: center; padding: 20px; } </style>\n            </head>\n            <body>\n                <h1>We'll Be Right Back!</h1>\n                <p>Our site is undergoing maintenance. Check back soon!</p>\n            </body>\n            </html>\n        `,\n      { status: 503, headers: { \"Content-Type\": \"text/html\" } },\n    );\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "const CACHE_DURATION = 30 * 24 * 60 * 60; // 30 days\n\n\nexport default {\n  async fetch(request) {\n    const cache = caches.default;\n    const cacheKey = new Request(request.url, { method: \"GET\" });\n\n\n    let response = await cache.match(cacheKey);\n    if (!response) {\n      response = await fetch(request);\n      response = new Response(response.body, response);\n      response.headers.set(\"Cache-Control\", `s-maxage=${CACHE_DURATION}`);\n      await cache.put(cacheKey, response.clone());\n    }\n    return response;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    const country = request.cf.country;\n    const redirectMap = {\n      US: \"https://example.com/us\",\n      EU: \"https://example.com/eu\",\n    };\n    if (redirectMap[country])\n      return Response.redirect(redirectMap[country], 301);\n    return fetch(request);\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Send original request to the origin\n    const response = await fetch(request);\n    // Check if origin responded with 403 status code\n    if (response.status == 403) {\n      // If so, redirect to this URL\n      const destinationURL = \"https://example.com\";\n      // With this status code\n      const statusCode = 301;\n      // Serve redirect\n      return Response.redirect(destinationURL, statusCode);\n    }\n    // Otherwise, serve origin's response\n    else {\n      return response;\n    }\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Send original request to the origin\n    const response = await fetch(request);\n\n\n    // If response is not 200 OK or a redirect, send to another origin\n    if (!response.ok && !response.redirected) {\n      // First, clone the original request to construct a new request\n      const newRequest = new Request(request);\n      // Add a header to identify a re-routed request at the new origin\n      newRequest.headers.set(\"X-Rerouted\", \"1\");\n      // Clone the original URL\n      const url = new URL(request.url);\n      // Send request to a different origin / hostname\n      url.hostname = \"example.com\";\n      // Serve response to the new request from the origin\n      return await fetch(url, newRequest);\n    }\n\n\n    // If response is 200 OK or a redirect, serve it\n    return response;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Send original request to the origin\n    const response = await fetch(request);\n    // Check if origin responded with JSON\n    try {\n      // Parse API response as JSON\n      var api_response = response.json();\n      // Specify the fields you want to delete. For example, to delete \"botManagement\" array from parsed JSON:\n      delete api_response.botManagement;\n      // Serve modified API response\n      return Response.json(api_response);\n    } catch (err) {\n      // On failure, serve unmodified origin's response\n      return response;\n    }\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "// Define CORS headers\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\", // Replace * with your allowed origin(s)\n  \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\", // Adjust allowed methods as needed\n  \"Access-Control-Allow-Headers\": \"Content-Type, Authorization\", // Adjust allowed headers as needed\n  \"Access-Control-Max-Age\": \"86400\", // Adjust max age (in seconds) as needed\n};\n\n\nexport default {\n  async fetch(request) {\n    // Make a copy of the request to modify its headers\n    const modifiedRequest = new Request(request);\n\n\n    // Handle preflight requests (OPTIONS)\n    if (request.method === \"OPTIONS\") {\n      return new Response(null, {\n        headers: {\n          ...corsHeaders,\n        },\n        status: 200, // Respond with OK status for preflight requests\n      });\n    }\n\n\n    // Pass the modified request through to the origin\n    const response = await fetch(modifiedRequest);\n\n\n    // Make a copy of the response to modify its headers\n    const modifiedResponse = new Response(response.body, response);\n\n\n    // Set CORS headers on the response\n    Object.keys(corsHeaders).forEach((header) => {\n      modifiedResponse.headers.set(header, corsHeaders[header]);\n    });\n\n\n    return modifiedResponse;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Define the old hostname here.\n    const OLD_URL = \"oldsite.com\";\n    // Then add your new hostname that should replace the old one.\n    const NEW_URL = \"newsite.com\";\n\n\n    class AttributeRewriter {\n      constructor(attributeName) {\n        this.attributeName = attributeName;\n      }\n      element(element) {\n        const attribute = element.getAttribute(this.attributeName);\n        if (attribute) {\n          element.setAttribute(\n            this.attributeName,\n            attribute.replace(OLD_URL, NEW_URL),\n          );\n        }\n      }\n    }\n\n\n    const rewriter = new HTMLRewriter()\n      .on(\"a\", new AttributeRewriter(\"href\"))\n      .on(\"img\", new AttributeRewriter(\"src\"));\n\n\n    const res = await fetch(request);\n    const contentType = res.headers.get(\"Content-Type\");\n\n\n    // If the response is HTML, it can be transformed with\n    // HTMLRewriter -- otherwise, it should pass through\n    if (contentType.startsWith(\"text/html\")) {\n      return rewriter.transform(res);\n    } else {\n      return res;\n    }\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Define delay\n    const delay_in_seconds = 5;\n    // Introduce a delay\n    await new Promise((resolve) =>\n      setTimeout(resolve, delay_in_seconds * 1000),\n    ); // Set delay in milliseconds\n\n\n    // Pass the request to the origin\n    const response = await fetch(request);\n    return response;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    // Get the current timestamp\n    const timestamp = Date.now();\n    const hexTimestamp = timestamp.toString(16);\n\n\n    // Clone request and add a custom header\n    const modifiedRequest = new Request(request, {\n      headers: new Headers(request.headers),\n    });\n    modifiedRequest.headers.set(\"X-Hex-Timestamp\", hexTimestamp);\n\n\n    console.log(`X-Hex-Timestamp: ${hexTimestamp}`);\n\n\n    // Pass modified request to origin\n    return fetch(modifiedRequest);\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    const response = await fetch(\"https://{snippets_url}\", request); // Ensure {snippets_url} points to the endpoint modified by Snippets\n    const newResponse = new Response(response.body, response);\n\n\n    let hexTimestamp = request.headers.get(\"X-Hex-Timestamp\") || \"null\";\n    console.log(hexTimestamp);\n\n\n    newResponse.headers.set(\"X-Hex-Timestamp\", hexTimestamp);\n    return newResponse;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    const url = new URL(request.url);\n    url.hostname = \"origin.example.com\"; // Ensure this hostname points to the origin where the resource is hosted\n\n\n    const newRequest = new Request(url, request);\n    const customKey = `https://${url.hostname}${url.pathname}`; // This custom cache key should be the same in both Worker and Snippet configuration for cache to work\n\n\n    // Fetch and modify response\n    const response = await fetch(newRequest);\n    const newResponse = new Response(response.body, response);\n\n\n    // Cache the transformed response\n    const cache = caches.default;\n    const cachedResponse = newResponse.clone();\n    cachedResponse.headers.set(\"X-Cached-In-Workers\", \"true\");\n    await cache.put(customKey, cachedResponse);\n\n\n    newResponse.headers.set(\"X-Retrieved-From-Workers\", \"true\");\n    return newResponse;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "export default {\n  async fetch(request) {\n    const url = new URL(request.url);\n    url.hostname = \"origin.example.com\"; // Ensure this hostname points to the origin where the resource is hosted\n    const cacheKey = `https://${url.hostname}${url.pathname}`; // This custom cache key should be the same in both Worker and Snippet configuration for cache to work\n\n\n    // Access cache\n    const cache = caches.default;\n    let response = await cache.match(cacheKey);\n\n\n    if (!response) {\n      console.log(`Cache miss for: ${cacheKey}. Fetching from Worker...`);\n      url.hostname = \"worker.example.com\"; // Ensure this hostname points to the Workers route\n      response = await fetch(new Request(url, request));\n\n\n      // Cache the response for future use\n      response = new Response(response.body, response);\n      response.headers.set(\"Cache-Control\", `s-maxage=3600`);\n      response.headers.set(\"x-snippets-cache\", \"stored\");\n    } else {\n      console.log(`Cache hit for: ${cacheKey}`);\n      response = new Response(response.body, response);\n      response.headers.set(\"x-snippets-cache\", \"hit\");\n    }\n\n\n    return response;\n  },\n};",
      "language": "javascript"
    },
    {
      "code": "flowchart LR\naccTitle: Header modifications diagram\naccDescr: Header transform rules can change the headers sent to your origin server (request header modifications) or sent your your website visitors (response header modifications).\n\nA[Visitor]\nB((Cloudflare))\nC[(Origin server)]\n\nA -.-> B == \"Includes request<br> header modifications\" ==> C\nC -.-> B -. \"Includes response<br> header modifications\" .-> A\n\nstyle A stroke-width: 2px\nstyle B stroke: orange,fill: orange,color: black\nlinkStyle 0,2,3 stroke-width: 1px\nlinkStyle 1 stroke-width: 3px",
      "language": "mermaid"
    },
    {
      "code": "flowchart LR\naccTitle: Header modifications diagram\naccDescr: Header transform rules can change the headers sent to your origin server (request header modifications) or sent your your website visitors (response header modifications).\n\nA[Visitor]\nB((Cloudflare))\nC[(Origin server)]\n\nA -.-> B -. \"Includes request<br> header modifications\" .-> C\nC -.-> B == \"Includes response<br> header modifications\" ==> A\n\nstyle A stroke-width: 2px\nstyle B stroke: orange,fill: orange,color: black\nlinkStyle 0,1,2 stroke-width: 1px\nlinkStyle 3 stroke-width: 3px",
      "language": "mermaid"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID_1>\"\n            },\n            \"expression\": \"true\"\n        },\n        {\n            \"action\": \"execute\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID_2>\"\n            },\n            \"expression\": \"true\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Default\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID_1>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID_1>\"\n        },\n        \"last_updated\": \"2021-06-17T15:42:37.917815Z\"\n      },\n      {\n        \"id\": \"<RULE_ID_2>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID_2>\"\n        },\n        \"last_updated\": \"2021-06-17T15:42:37.917815Z\"\n      }\n    ],\n    \"last_updated\": \"2021-06-17T15:42:37.917815Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID/rules\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"action\": \"execute\",\n    \"action_parameters\": {\n        \"id\": \"<MANAGED_RULESET_ID>\"\n    },\n    \"expression\": \"true\"\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Zone-level phase entry point ruleset\",\n    \"description\": \"\",\n    \"kind\": \"root\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"<EXISTING_RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<ANOTHER_MANAGED_RULESET_ID>\"\n        },\n        \"last_updated\": \"2021-03-17T15:42:37.917815Z\"\n      },\n      {\n        \"id\": \"<NEW_RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\"\n        },\n        \"last_updated\": \"2021-06-30T15:42:37.917815Z\"\n      }\n    ],\n    \"last_updated\": \"2021-06-30T15:42:37.917815Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"action_parameters\": {\n                \"id\": \"efb7b8c949ac4650a09736fc376e9aee\"\n            },\n            \"expression\": \"true\",\n            \"description\": \"Execute Cloudflare Managed Ruleset on my zone ruleset\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<ZONE_PHASE_RULESET_ID>\",\n    \"name\": \"Zone-level Ruleset 1\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"latest\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"efb7b8c949ac4650a09736fc376e9aee\",\n          \"version\": \"3\"\n        },\n        \"expression\": \"true\",\n        \"description\": \"Execute Cloudflare Managed Ruleset on my zone ruleset\",\n        \"last_updated\": \"2021-03-18T18:08:14.003361Z\",\n        \"ref\": \"<RULE_REF>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-18T18:08:14.003361Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"id\": \"<ZONE_PHASE_RULESET_ID>\",\n      \"name\": \"Zone-level Ruleset 1\",\n      \"description\": \"Ruleset for http_request_firewall_managed phase at the zone level\",\n      \"kind\": \"zone\",\n      \"version\": \"2\",\n      \"last_updated\": \"2021-03-12T14:11:59.754817Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    },\n18 collapsed lines\n    {\n      \"id\": \"<CLOUDFLARE_MANAGED_RULESET_ID>\",\n      \"name\": \"Cloudflare Managed Ruleset\",\n      \"description\": \"Created by the Cloudflare security team, this ruleset is designed to provide fast and effective protection for all your applications. It is frequently updated to cover new vulnerabilities and reduce false positives\",\n      \"kind\": \"managed\",\n      \"version\": \"2\",\n      \"last_updated\": \"2021-03-18T14:42:40.972022Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    },\n    {\n      \"id\": \"<CLOUDFLARE_OWASP_CORE_RULESET_ID>\",\n      \"name\": \"Cloudflare OWASP Core Ruleset\",\n      \"description\": \"Cloudflare's implementation of the Open Web Application Security Project (OWASP) ModSecurity Core Rule Set. We routinely monitor for updates from OWASP based on the latest version available from the official code repository\",\n      \"kind\": \"managed\",\n      \"version\": \"3\",\n      \"last_updated\": \"2021-03-18T14:42:42.993211Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"id\": \"<CUSTOM_RULESET_ID>\",\n      \"name\": \"Custom Ruleset 1\",\n      \"description\": \"My custom ruleset\",\n      \"kind\": \"custom\",\n      \"version\": \"10\",\n      \"last_updated\": \"2020-11-23T11:36:24.192361Z\",\n      \"phase\": \"http_request_firewall_custom\"\n    },\n27 collapsed lines\n    {\n      \"id\": \"<ACCOUNT_PHASE_RULESET_ID>\",\n      \"name\": \"Account-level ruleset for http_request_firewall_managed phase\",\n      \"description\": \"Account-level ruleset for executing one or more Managed Rulesets\",\n      \"kind\": \"root\",\n      \"version\": \"2\",\n      \"last_updated\": \"2021-03-12T14:06:41.323932Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    },\n    {\n      \"id\": \"<CLOUDFLARE_MANAGED_RULESET_ID>\",\n      \"name\": \"Cloudflare Managed Ruleset\",\n      \"description\": \"Created by the Cloudflare security team, this ruleset is designed to provide fast and effective protection for all your applications. It is frequently updated to cover new vulnerabilities and reduce false positives\",\n      \"kind\": \"managed\",\n      \"version\": \"5\",\n      \"last_updated\": \"2021-03-18T14:42:40.972022Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    },\n    {\n      \"id\": \"<CLOUDFLARE_OWASP_CORE_RULESET_ID>\",\n      \"name\": \"Cloudflare OWASP Core Ruleset\",\n      \"description\": \"Cloudflare's implementation of the Open Web Application Security Project (OWASP) ModSecurity Core Rule Set. We routinely monitor for updates from OWASP based on the latest version available from the official code repository\",\n      \"kind\": \"managed\",\n      \"version\": \"3\",\n      \"last_updated\": \"2021-03-18T14:42:42.993211Z\",\n      \"phase\": \"http_request_firewall_managed\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Zone-level phase entry point ruleset\",\n    \"description\": \"This ruleset executes a managed ruleset.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n7 collapsed lines\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\"\n        },\n        \"last_updated\": \"2021-03-17T15:42:37.917815Z\"\n      }\n    ],\n    \"last_updated\": \"2021-03-17T15:42:37.917815Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint/versions/2\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<RULESET_ID>\",\n    \"name\": \"Zone-level phase entry point ruleset\",\n    \"description\": \"This ruleset executes a managed ruleset.\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"expression\": \"true\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\"\n        },\n        \"last_updated\": \"2021-03-17T15:42:37.917815Z\"\n      }\n    ],\n    \"last_updated\": \"2021-03-17T15:42:37.917815Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/$MANAGED_RULESET_ID/versions/2\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<MANAGED_RULESET_ID>\",\n    \"name\": \"Cloudflare Managed Ruleset\",\n    \"description\": \"Created by the Cloudflare security team, this ruleset is designed to provide fast and effective protection for all your applications. It is frequently updated to cover new vulnerabilities and reduce false positives\",\n    \"kind\": \"managed\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_1_ID>\",\n        \"version\": \"1\",\n        \"action\": \"log\",\n        \"categories\": [\n          \"cve-2014-5265\",\n          \"cve-2014-5266\",\n          \"cve-2014-5267\",\n          \"dos\",\n          \"drupal\",\n          \"wordpress\"\n        ],\n        \"description\": \"Drupal, Wordpress - DoS - XMLRPC - CVE:CVE-2014-5265, CVE:CVE-2014-5266, CVE:CVE-2014-5267\",\n        \"last_updated\": \"2021-03-18T14:42:40.972022Z\",\n        \"ref\": \"<RULE_1_REF>\",\n        \"enabled\": true\n      },\n11 collapsed lines\n      {\n        \"id\": \"<RULE_2_ID>\",\n        \"version\": \"1\",\n        \"action\": \"block\",\n        \"categories\": [\"broken-access-control\", \"cve-2018-12895\", \"wordpress\"],\n        \"description\": \"Wordpress - Broken Access Control - CVE:CVE-2018-12895\",\n        \"last_updated\": \"2021-03-18T14:42:40.972022Z\",\n        \"ref\": \"<RULE_2_REF>\",\n        \"enabled\": true\n      }\n      // (...)\n    ],\n    \"last_updated\": \"2021-03-18T14:42:40.972022Z\",\n    \"phase\": \"http_request_firewall_managed\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"expression\": \"(ip.src.country in {\\\"GB\\\" \\\"FR\\\"} and cf.bot_management.score < 20 and not cf.bot_management.verified_bot)\",\n            \"action\": \"challenge\",\n            \"description\": \"challenge GB and FR based on bot score\"\n        },\n        {\n            \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n            \"action\": \"challenge\",\n            \"description\": \"challenge not /api\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<CUSTOM_RULESET_ID>\",\n    \"name\": \"Custom Ruleset 1\",\n    \"kind\": \"custom\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"id\": \"<CUSTOM_RULE_ID_1>\",\n        \"version\": \"1\",\n        \"action\": \"challenge\",\n        \"expression\": \"(ip.src.country in {\\\"GB\\\" \\\"FR\\\"} and cf.bot_management.score < 20 and not cf.bot_management.verified_bot)\",\n        \"description\": \"challenge GB and FR based on bot score\",\n        \"last_updated\": \"2021-03-18T18:25:08.122758Z\",\n        \"ref\": \"<CUSTOM_RULE_REF_1>\",\n        \"enabled\": true\n      },\n      {\n        \"id\": \"<CUSTOM_RULE_ID_2>\",\n        \"version\": \"1\",\n        \"action\": \"challenge\",\n        \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"description\": \"challenge not /api\",\n        \"last_updated\": \"2021-03-18T18:25:08.122758Z\",\n        \"ref\": \"<CUSTOM_RULE_REF_2>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-18T18:25:08.122758Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"id\": \"<CUSTOM_RULE_ID_2>\",\n            \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n            \"action\": \"js_challenge\",\n            \"description\": \"js_challenge when not /api\"\n        },\n        {\n            \"id\": \"<CUSTOM_RULE_ID_1>\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<CUSTOM_RULESET_ID>\",\n    \"name\": \"Custom Ruleset 1\",\n    \"kind\": \"custom\",\n    \"version\": \"3\",\n    \"rules\": [\n      {\n        \"id\": \"<CUSTOM_RULE_ID_2>\",\n        \"version\": \"2\",\n        \"action\": \"js_challenge\",\n        \"expression\": \"not http.request.uri.path matches \\\"^/api/.*$\\\"\",\n        \"description\": \"js_challenge when not /api\",\n        \"last_updated\": \"2021-03-18T18:30:08.122758Z\",\n        \"ref\": \"<CUSTOM_RULE_ID_2>\",\n        \"enabled\": true\n      },\n      {\n        \"id\": \"<CUSTOM_RULE_ID_1>\",\n        \"version\": \"1\",\n        \"action\": \"challenge\",\n        \"expression\": \"(ip.src.country in {\\\"GB\\\" \\\"FR\\\"} and cf.bot_management.score < 20 and not cf.bot_management.verified_bot)\",\n        \"description\": \"challenge GB and FR based on bot score\",\n        \"last_updated\": \"2021-03-18T18:25:08.122758Z\",\n        \"ref\": \"<CUSTOM_RULE_ID_1>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-18T18:30:08.122758Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"My First Custom Ruleset (account)\",\n    \"kind\": \"custom\",\n    \"phase\": \"http_request_firewall_custom\"\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"f82ccda3d21f4a02825d3fe45b5e1c10\",\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"My First Custom Ruleset (account)\",\n    \"kind\": \"custom\",\n    \"version\": \"1\",\n    \"last_updated\": \"2025-08-09T10:27:30.636197Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"My First Custom Ruleset (zone)\",\n    \"kind\": \"custom\",\n    \"phase\": \"http_request_firewall_custom\"\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"f82ccda3d21f4a02825d3fe45b5e1c10\",\n    \"name\": \"Custom Ruleset 1\",\n    \"description\": \"My First Custom Ruleset (zone)\",\n    \"kind\": \"custom\",\n    \"version\": \"1\",\n    \"last_updated\": \"2025-08-09T10:27:30.636197Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_custom/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"description\": \"Execute custom ruleset\",\n            \"expression\": \"(cf.zone.name == \\\"example.com\\\") and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<CUSTOM_RULESET_ID>\"\n            }\n        },\n        {\n            \"id\": \"<EXISTING_PHASE_RULE_ID_1>\"\n        },\n        {\n            \"id\": \"<EXISTING_PHASE_RULE_ID_2>\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<ACCOUNT_PHASE_RULESET_ID>\",\n    \"name\": \"http_request_firewall_custom phase entry point ruleset for my account\",\n    \"description\": \"Execute several rulesets\",\n    \"kind\": \"root\",\n    \"version\": \"3\",\n    \"rules\": [\n      {\n        \"id\": \"<PHASE_RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"description\": \"Execute custom ruleset\",\n        \"action_parameters\": {\n          \"id\": \"<CUSTOM_RULESET_ID>\",\n          \"version\": \"latest\"\n        },\n        \"expression\": \"(cf.zone.name == \\\"example.com\\\") and cf.zone.plan eq \\\"ENT\\\"\",\n        \"last_updated\": \"2021-03-18T18:35:14.135697Z\",\n        \"ref\": \"<PHASE_RULE_REF>\",\n        \"enabled\": true\n      },\n      {\n        \"id\": \"<EXISTING_PHASE_RULE_ID_1>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"<EXECUTED_RULESET_ID_1>\",\n          \"version\": \"latest\"\n        },\n        \"expression\": \"(cf.zone.name eq \\\"example.com\\\") and cf.zone.plan eq \\\"ENT\\\"\",\n        \"last_updated\": \"2021-03-16T15:51:49.180378Z\",\n        \"ref\": \"<EXISTING_PHASE_RULE_REF_1>\",\n        \"enabled\": true\n      },\n      {\n        \"id\": \"<EXISTING_PHASE_RULE_ID_2>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"<EXECUTED_RULESET_ID_2>\",\n          \"version\": \"latest\"\n        },\n        \"expression\": \"(cf.zone.name eq \\\"example.com\\\") and cf.zone.plan eq \\\"ENT\\\"\",\n        \"last_updated\": \"2021-03-16T15:50:29.861157Z\",\n        \"ref\": \"<EXISTING_PHASE_RULE_REF_2>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-03-18T18:35:14.135697Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_custom/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"description\": \"Execute custom ruleset (zone)\",\n            \"expression\": \"(http.request.uri.path eq \\\"/login\\\")\",\n            \"action_parameters\": {\n                \"id\": \"<CUSTOM_RULESET_ID>\"\n            }\n        },\n        {\n            \"id\": \"<EXISTING_PHASE_RULE_ID_1>\"\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<ZONE_PHASE_RULESET_ID>\",\n    \"name\": \"http_request_firewall_custom phase entry point ruleset for my zone\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"3\",\n    \"rules\": [\n      {\n        \"id\": \"<PHASE_RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"description\": \"Execute custom ruleset (zone)\",\n        \"action_parameters\": {\n          \"id\": \"<CUSTOM_RULESET_ID>\",\n          \"version\": \"latest\"\n        },\n        \"expression\": \"(http.request.uri.path eq \\\"/login\\\")\",\n        \"last_updated\": \"2025-08-18T18:35:14.135697Z\",\n        \"ref\": \"<PHASE_RULE_REF>\",\n        \"enabled\": true\n      },\n      {\n        \"id\": \"<EXISTING_PHASE_RULE_ID_1>\",\n        \"version\": \"1\",\n        \"action\": \"managed_challenge\",\n        \"expression\": \"(cf.waf.score lt 20 and http.request.uri.path wildcard \\\"/admin/*\\\")\",\n        \"last_updated\": \"2025-08-16T15:51:49.180378Z\",\n        \"ref\": \"<EXISTING_PHASE_RULE_REF_1>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2025-08-18T18:35:14.135697Z\",\n    \"phase\": \"http_request_firewall_custom\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n     --request GET \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n     \"result\": {\n       \"description\": \"Zone-level phase entry point\",\n       \"id\": \"<RULESET_ID>\",\n       \"kind\": \"zone\",\n       \"last_updated\": \"2024-03-16T15:40:08.202335Z\",\n       \"name\": \"zone\",\n       \"phase\": \"http_request_firewall_managed\",\n       \"rules\": [\n         // ...\n       ],\n       \"source\": \"firewall_managed\",\n       \"version\": \"10\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID/rules\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"action\": \"execute\",\n       \"action_parameters\": {\n           \"id\": \"efb7b8c949ac4650a09736fc376e9aee\"\n       },\n       \"expression\": \"true\",\n       \"description\": \"Execute the Cloudflare Managed Ruleset\"\n     }'",
      "language": "bash"
    },
    {
      "code": "{\n     \"result\": {\n       \"id\": \"<RULESET_ID>\",\n       \"name\": \"Zone-level phase entry point\",\n       \"description\": \"\",\n       \"kind\": \"zone\",\n       \"version\": \"11\",\n       \"rules\": [\n         // ... any existing rules\n         {\n           \"id\": \"<RULE_ID>\",\n           \"version\": \"1\",\n           \"action\": \"execute\",\n           \"action_parameters\": {\n             \"id\": \"efb7b8c949ac4650a09736fc376e9aee\",\n             \"version\": \"latest\"\n           },\n           \"expression\": \"true\",\n           \"description\": \"Execute the Cloudflare Managed Ruleset\",\n           \"last_updated\": \"2024-03-18T18:08:14.003361Z\",\n           \"ref\": \"<RULE_REF>\",\n           \"enabled\": true\n         }\n       ],\n       \"last_updated\": \"2024-03-18T18:08:14.003361Z\",\n       \"phase\": \"http_request_firewall_managed\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"name\": \"My ruleset\",\n       \"description\": \"Entry point ruleset for WAF managed rulesets\",\n       \"kind\": \"zone\",\n       \"phase\": \"http_request_firewall_managed\",\n       \"rules\": [\n           {\n               \"action\": \"execute\",\n               \"action_parameters\": {\n                   \"id\": \"efb7b8c949ac4650a09736fc376e9aee\"\n               },\n               \"expression\": \"true\",\n               \"description\": \"Execute the Cloudflare Managed Ruleset\"\n           }\n       ]\n     }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n     --request GET \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"",
      "language": "bash"
    },
    {
      "code": "{\n     \"result\": {\n       \"description\": \"Account-level phase entry point\",\n       \"id\": \"<RULESET_ID>\",\n       \"kind\": \"root\",\n       \"last_updated\": \"2024-03-16T15:40:08.202335Z\",\n       \"name\": \"root\",\n       \"phase\": \"http_request_firewall_managed\",\n       \"rules\": [\n         // ...\n       ],\n       \"source\": \"firewall_managed\",\n       \"version\": \"10\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/$RULESET_ID/rules\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"action\": \"execute\",\n       \"action_parameters\": {\n           \"id\": \"efb7b8c949ac4650a09736fc376e9aee\"\n       },\n       \"expression\": \"(cf.zone.name in {\\\"example.com\\\" \\\"anotherexample.com\\\"}) and cf.zone.plan eq \\\"ENT\\\"\",\n       \"description\": \"Execute the Cloudflare Managed Ruleset\"\n     }'",
      "language": "bash"
    },
    {
      "code": "{\n     \"result\": {\n       \"id\": \"<RULESET_ID>\",\n       \"name\": \"Account-level phase entry point\",\n       \"description\": \"\",\n       \"kind\": \"root\",\n       \"version\": \"11\",\n       \"rules\": [\n         // ... any existing rules\n         {\n           \"id\": \"<RULE_ID>\",\n           \"version\": \"1\",\n           \"action\": \"execute\",\n           \"action_parameters\": {\n             \"id\": \"efb7b8c949ac4650a09736fc376e9aee\",\n             \"version\": \"latest\"\n           },\n           \"expression\": \"(cf.zone.name in {\\\"example.com\\\" \\\"anotherexample.com\\\"}) and cf.zone.plan eq \\\"ENT\\\"\",\n           \"description\": \"Execute the Cloudflare Managed Ruleset\",\n           \"last_updated\": \"2024-03-18T18:30:08.122758Z\",\n           \"ref\": \"<RULE_REF>\",\n           \"enabled\": true\n         }\n       ],\n       \"last_updated\": \"2024-03-18T18:30:08.122758Z\",\n       \"phase\": \"http_request_firewall_managed\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"name\": \"My ruleset\",\n       \"description\": \"Entry point ruleset for WAF managed rulesets\",\n       \"kind\": \"root\",\n       \"phase\": \"http_request_firewall_managed\",\n       \"rules\": [\n           {\n               \"action\": \"execute\",\n               \"action_parameters\": {\n                   \"id\": \"efb7b8c949ac4650a09736fc376e9aee\"\n               },\n               \"expression\": \"(cf.zone.name in {\\\"example.com\\\" \\\"anotherexample.com\\\"}) and cf.zone.plan eq \\\"ENT\\\"\",\n               \"description\": \"Execute the Cloudflare Managed Ruleset\"\n           }\n       ]\n     }'",
      "language": "bash"
    },
    {
      "code": "{\n  \"expression\": \"<RULE_EXPRESSION>\",\n  \"action\": \"skip\",\n  \"action_parameters\": {\n    \"ruleset\": \"current\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"expression\": \"<RULE_EXPRESSION>\",\n  \"action\": \"skip\",\n  \"action_parameters\": {\n    \"rulesets\": [\"<MANAGED_RULESET_1_ID>\", \"<MANAGED_RULESET_2_ID>\"]\n  }\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"expression\": \"<RULE_EXPRESSION>\",\n  \"action\": \"skip\",\n  \"action_parameters\": {\n    \"rules\": {\n      \"<MANAGED_RULESET_1_ID>\": [\"<RULE_A_ID>\", \"<RULE_B_ID>\"],\n      \"<MANAGED_RULESET_2_ID>\": [\"<RULE_X_ID>\"]\n    }\n  }\n}",
      "language": "json"
    },
    {
      "code": "\"action_parameters\": {\n  \"id\": \"<RULESET_ID>\",\n  \"overrides\": {\n    // ruleset overrides\n    \"property-to-modify\": \"value\",\n    \"property-to-modify\": \"value\",\n    // tag overrides\n    \"categories\": [\n      {\n        \"category\": \"<TAG_NAME>\",\n        \"property-to-modify\": \"value\",\n        \"property-to-modify\": \"value\"\n      }\n    ],\n    // rule overrides\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"property-to-modify\": \"value\",\n        \"property-to-modify\": \"value\"\n      }\n    ]\n  }\n}",
      "language": "json"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"description\": \"Deploy managed ruleset, enabling a specific rule with log action\",\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"enabled\": true,\n                            \"action\": \"log\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"description\": \"Deploy managed ruleset for example.com, overriding the rules action to log\",\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"(cf.zone.name eq \\\"example.com\\\") and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"action\": \"log\"\n                }\n            }\n        }\n    ]\n  }'",
      "language": "bash"
    },
    {
      "code": "http.request.uri.path matches \"/autodiscover\\.(xml|src)$\"",
      "language": "txt"
    },
    {
      "code": "<field> <comparison_operator> <value>",
      "language": "txt"
    },
    {
      "code": "http.host eq \"www.example.com\" and not cf.edge.server_port in {80 443}",
      "language": "txt"
    },
    {
      "code": "<expression> <logical_operator> <expression>",
      "language": "txt"
    },
    {
      "code": "lower(http.host) == \"www.cloudflare.com\"",
      "language": "sql"
    },
    {
      "code": "any(url_decode(http.request.body.form.values[*])[*] contains \"an xss attack\")",
      "language": "txt"
    },
    {
      "code": "all(http.request.headers[\"content-type\"][*] == \"application/json\")",
      "language": "plaintext"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Managed features in Cloudflare for platforms",
      "id": "managed-features-in-cloudflare-for-platforms"
    },
    {
      "level": "h2",
      "text": "Scalable serverless applications with Workers for Platforms",
      "id": "scalable-serverless-applications-with-workers-for-platforms"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "SSL issuance at scale for your platform",
      "id": "ssl-issuance-at-scale-for-your-platform"
    },
    {
      "level": "h3",
      "text": "Feature Customization for your Platform customers",
      "id": "feature-customization-for-your-platform-customers"
    },
    {
      "level": "h3",
      "text": "Serverless application platform for your customers",
      "id": "serverless-application-platform-for-your-customers"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Introduction",
      "id": "introduction"
    },
    {
      "level": "h3",
      "text": "Who is this document for and what will you learn?",
      "id": "who-is-this-document-for-and-what-will-you-learn?"
    },
    {
      "level": "h2",
      "text": "Benefits of a SASE platform",
      "id": "benefits-of-a-sase-platform"
    },
    {
      "level": "h3",
      "text": "Zero Trust Network Access (ZTNA)",
      "id": "zero-trust-network-access-(ztna)"
    },
    {
      "level": "h3",
      "text": "Secure Web Gateway (SWG)",
      "id": "secure-web-gateway-(swg)"
    },
    {
      "level": "h3",
      "text": "Why a phased approach?",
      "id": "why-a-phased-approach?"
    },
    {
      "level": "h2",
      "text": "Phase 1: Connectivity and network-based policies",
      "id": "phase-1:-connectivity-and-network-based-policies"
    },
    {
      "level": "h3",
      "text": "Connecting networks to Cloudflare",
      "id": "connecting-networks-to-cloudflare"
    },
    {
      "level": "h3",
      "text": "Device agent deployment",
      "id": "device-agent-deployment"
    },
    {
      "level": "h3",
      "text": "Deploying software connectors for DNS",
      "id": "deploying-software-connectors-for-dns"
    },
    {
      "level": "h3",
      "text": "DNS resolution with Resolver Policies",
      "id": "dns-resolution-with-resolver-policies"
    },
    {
      "level": "h3",
      "text": "Analytics and logging",
      "id": "analytics-and-logging"
    },
    {
      "level": "h2",
      "text": "Phase 2: Scaling up and offloading IPsec",
      "id": "phase-2:-scaling-up-and-offloading-ipsec"
    },
    {
      "level": "h2",
      "text": "Phase 3: Application-based policies",
      "id": "phase-3:-application-based-policies"
    },
    {
      "level": "h3",
      "text": "Clientless access",
      "id": "clientless-access"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h3",
      "text": "Further reading",
      "id": "further-reading"
    },
    {
      "level": "h2",
      "text": "Overview and the Cloudflare advantage",
      "id": "overview-and-the-cloudflare-advantage"
    },
    {
      "level": "h2",
      "text": "Onboarding and protecting the application with Cloudflare",
      "id": "onboarding-and-protecting-the-application-with-cloudflare"
    },
    {
      "level": "h3",
      "text": "Connectivity options",
      "id": "connectivity-options"
    },
    {
      "level": "h2",
      "text": "Routing to the origin",
      "id": "routing-to-the-origin"
    },
    {
      "level": "h3",
      "text": "Example: Securing your application with Cloudflare Tunnel and Access",
      "id": "example:-securing-your-application-with-cloudflare-tunnel-and-access"
    },
    {
      "level": "h3",
      "text": "Using other Cloudflare services (CDN, WAF, Security Analytics, etc.)",
      "id": "using-other-cloudflare-services-(cdn,-waf,-security-analytics,-etc.)"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Introduction",
      "id": "introduction"
    },
    {
      "level": "h3",
      "text": "Who is this document for and what will you learn?",
      "id": "who-is-this-document-for-and-what-will-you-learn?"
    },
    {
      "level": "h3",
      "text": "Gateway DNS",
      "id": "gateway-dns"
    },
    {
      "level": "h3",
      "text": "DNS locations",
      "id": "dns-locations"
    },
    {
      "level": "h2",
      "text": "Securing guest traffic sourced from a basic wireless router",
      "id": "securing-guest-traffic-sourced-from-a-basic-wireless-router"
    },
    {
      "level": "h3",
      "text": "Using business Internet and a static IPv4 address",
      "id": "using-business-internet-and-a-static-ipv4-address"
    },
    {
      "level": "h2",
      "text": "Secure guest traffic sourced from an enterprise network",
      "id": "secure-guest-traffic-sourced-from-an-enterprise-network"
    },
    {
      "level": "h3",
      "text": "Segment internal and guest networks",
      "id": "segment-internal-and-guest-networks"
    },
    {
      "level": "h3",
      "text": "Configure DNS for the guest network",
      "id": "configure-dns-for-the-guest-network"
    },
    {
      "level": "h3",
      "text": "Assign a unique Public IPv4 address for guest traffic",
      "id": "assign-a-unique-public-ipv4-address-for-guest-traffic"
    },
    {
      "level": "h3",
      "text": "Map guest traffic in Cloudflare",
      "id": "map-guest-traffic-in-cloudflare"
    },
    {
      "level": "h2",
      "text": "Secure guest wireless at locations with a dynamically assigned public IPv4 or IPv6 address",
      "id": "secure-guest-wireless-at-locations-with-a-dynamically-assigned-public-ipv4-or-ipv6-address"
    },
    {
      "level": "h3",
      "text": "Dedicated DNS resolver IPv4 and IPv6 addresses",
      "id": "dedicated-dns-resolver-ipv4-and-ipv6-addresses"
    },
    {
      "level": "h3",
      "text": "Add DNS locations",
      "id": "add-dns-locations"
    },
    {
      "level": "h3",
      "text": "Creating DNS policies",
      "id": "creating-dns-policies"
    },
    {
      "level": "h3",
      "text": "Recommended policies",
      "id": "recommended-policies"
    },
    {
      "level": "h3",
      "text": "Visibility into Guest DNS Internet Activity",
      "id": "visibility-into-guest-dns-internet-activity"
    },
    {
      "level": "h2",
      "text": "Going beyond DNS filtering",
      "id": "going-beyond-dns-filtering"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Related Resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Introduction",
      "id": "introduction"
    },
    {
      "level": "h3",
      "text": "Who is this document for and what will you learn?",
      "id": "who-is-this-document-for-and-what-will-you-learn?"
    },
    {
      "level": "h2",
      "text": "Example Scenario",
      "id": "example-scenario"
    },
    {
      "level": "h3",
      "text": "WAF Requirements",
      "id": "waf-requirements"
    },
    {
      "level": "h2",
      "text": "Cloudflare Web Application Firewall",
      "id": "cloudflare-web-application-firewall"
    },
    {
      "level": "h2",
      "text": "Example Use Case - Implementing the Cloudflare Managed Ruleset",
      "id": "example-use-case---implementing-the-cloudflare-managed-ruleset"
    },
    {
      "level": "h3",
      "text": "Using Account Level WAF to minimize configuration overheads",
      "id": "using-account-level-waf-to-minimize-configuration-overheads"
    },
    {
      "level": "h2",
      "text": "Additional Considerations",
      "id": "additional-considerations"
    },
    {
      "level": "h3",
      "text": "False Positives Tuning",
      "id": "false-positives-tuning"
    },
    {
      "level": "h3",
      "text": "Using Lists",
      "id": "using-lists"
    },
    {
      "level": "h3",
      "text": "Using automations",
      "id": "using-automations"
    },
    {
      "level": "h3",
      "text": "Avoid mixing setup at Account and Zone level",
      "id": "avoid-mixing-setup-at-account-and-zone-level"
    },
    {
      "level": "h3",
      "text": "Custom Rules and Rate Limiting Rules",
      "id": "custom-rules-and-rate-limiting-rules"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Introduction",
      "id": "introduction"
    },
    {
      "level": "h3",
      "text": "Who is this document for and what will you learn?",
      "id": "who-is-this-document-for-and-what-will-you-learn?"
    },
    {
      "level": "h2",
      "text": "Securing managed SaaS applications",
      "id": "securing-managed-saas-applications"
    },
    {
      "level": "h3",
      "text": "Securing access",
      "id": "securing-access"
    },
    {
      "level": "h3",
      "text": "Data protection for managed SaaS applications",
      "id": "data-protection-for-managed-saas-applications"
    },
    {
      "level": "h3",
      "text": "Monitor configuration",
      "id": "monitor-configuration"
    },
    {
      "level": "h3",
      "text": "Cloud email security",
      "id": "cloud-email-security"
    },
    {
      "level": "h2",
      "text": "Regain control over unmanaged SaaS applications",
      "id": "regain-control-over-unmanaged-saas-applications"
    },
    {
      "level": "h3",
      "text": "Data protection for unmanaged SaaS applications",
      "id": "data-protection-for-unmanaged-saas-applications"
    },
    {
      "level": "h3",
      "text": "Adopting a new SaaS application",
      "id": "adopting-a-new-saas-application"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Introduction",
      "id": "introduction"
    },
    {
      "level": "h2",
      "text": "Who is this document for and what will you learn?",
      "id": "who-is-this-document-for-and-what-will-you-learn?"
    },
    {
      "level": "h2",
      "text": "Getting started — Foundational decisions",
      "id": "getting-started-—-foundational-decisions"
    },
    {
      "level": "h3",
      "text": "Asset inventory",
      "id": "asset-inventory"
    },
    {
      "level": "h3",
      "text": "Common goals and outcomes",
      "id": "common-goals-and-outcomes"
    },
    {
      "level": "h3",
      "text": "Identity",
      "id": "identity"
    },
    {
      "level": "h3",
      "text": "Device posture",
      "id": "device-posture"
    },
    {
      "level": "h2",
      "text": "Traditional and mesh network building",
      "id": "traditional-and-mesh-network-building"
    },
    {
      "level": "h3",
      "text": "Connecting users to networks",
      "id": "connecting-users-to-networks"
    },
    {
      "level": "h2",
      "text": "Connecting networks to networks",
      "id": "connecting-networks-to-networks"
    },
    {
      "level": "h3",
      "text": "Traditional connectivity",
      "id": "traditional-connectivity"
    },
    {
      "level": "h3",
      "text": "Mesh connectivity",
      "id": "mesh-connectivity"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Building Zero Trust into internal tooling",
      "id": "building-zero-trust-into-internal-tooling"
    },
    {
      "level": "h3",
      "text": "Consuming Zero Trust vendor tokens",
      "id": "consuming-zero-trust-vendor-tokens"
    },
    {
      "level": "h3",
      "text": "Your Zero Trust vendor as an SSO",
      "id": "your-zero-trust-vendor-as-an-sso"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Remote access for contractors, vendors, and customers",
      "id": "remote-access-for-contractors,-vendors,-and-customers"
    },
    {
      "level": "h3",
      "text": "Establishing scope",
      "id": "establishing-scope"
    },
    {
      "level": "h3",
      "text": "Web access for third parties",
      "id": "web-access-for-third-parties"
    },
    {
      "level": "h3",
      "text": "Administrative or network third-party access",
      "id": "administrative-or-network-third-party-access"
    },
    {
      "level": "h3",
      "text": "Access to customer environments (and vice versa)",
      "id": "access-to-customer-environments-(and-vice-versa)"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Protecting against Internet threats (or, *is secure web gateway a part of Zero Trust?*)",
      "id": "protecting-against-internet-threats-(or,-*is-secure-web-gateway-a-part-of-zero-trust?*)"
    },
    {
      "level": "h3",
      "text": "Long Live The New Perimeter",
      "id": "long-live-the-new-perimeter"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Adopting and securing SaaS applications",
      "id": "adopting-and-securing-saas-applications"
    },
    {
      "level": "h3",
      "text": "Sanctioned SaaS applications",
      "id": "sanctioned-saas-applications"
    },
    {
      "level": "h3",
      "text": "Unsanctioned SaaS applications (Shadow IT)",
      "id": "unsanctioned-saas-applications-(shadow-it)"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Long-term management with APIs and Infrastructure as Code (IaC)",
      "id": "long-term-management-with-apis-and-infrastructure-as-code-(iac)"
    },
    {
      "level": "h3",
      "text": "Where does Cloudflare fit in?",
      "id": "where-does-cloudflare-fit-in?"
    },
    {
      "level": "h2",
      "text": "Summary",
      "id": "summary"
    },
    {
      "level": "h2",
      "text": "Application Security",
      "id": "application-security"
    },
    {
      "level": "h2",
      "text": "Changing email contact",
      "id": "changing-email-contact"
    },
    {
      "level": "h2",
      "text": "60-day transfer lock",
      "id": "60-day-transfer-lock"
    },
    {
      "level": "h2",
      "text": "Zero Trust",
      "id": "zero-trust"
    },
    {
      "level": "h2",
      "text": "Domain status",
      "id": "domain-status"
    },
    {
      "level": "h2",
      "text": "Billing information",
      "id": "billing-information"
    },
    {
      "level": "h2",
      "text": "Edit WHOIS records",
      "id": "edit-whois-records"
    },
    {
      "level": "h2",
      "text": "Edit Default Contact information",
      "id": "edit-default-contact-information"
    },
    {
      "level": "h2",
      "text": "Delete a domain registration",
      "id": "delete-a-domain-registration"
    },
    {
      "level": "h2",
      "text": "Purchase custom email domain",
      "id": "purchase-custom-email-domain"
    },
    {
      "level": "h2",
      "text": "Log in to Cloudflare",
      "id": "log-in-to-cloudflare"
    },
    {
      "level": "h3",
      "text": "Signing in with Apple",
      "id": "signing-in-with-apple"
    },
    {
      "level": "h3",
      "text": "Signing in with Cloudflare",
      "id": "signing-in-with-cloudflare"
    },
    {
      "level": "h2",
      "text": "Billing information",
      "id": "billing-information"
    },
    {
      "level": "h3",
      "text": "Supported payment methods",
      "id": "supported-payment-methods"
    },
    {
      "level": "h3",
      "text": "Local currency price estimates",
      "id": "local-currency-price-estimates"
    },
    {
      "level": "h2",
      "text": "Email issues",
      "id": "email-issues"
    },
    {
      "level": "h3",
      "text": "Email issues",
      "id": "email-issues"
    },
    {
      "level": "h2",
      "text": "Domain website",
      "id": "domain-website"
    },
    {
      "level": "h2",
      "text": "Landing Page",
      "id": "landing-page"
    },
    {
      "level": "h3",
      "text": "Disable Landing Page",
      "id": "disable-landing-page"
    },
    {
      "level": "h2",
      "text": "1. Prepare for the move",
      "id": "1.-prepare-for-the-move"
    },
    {
      "level": "h2",
      "text": "2. Submit the move request",
      "id": "2.-submit-the-move-request"
    },
    {
      "level": "h2",
      "text": "Automatic renewal of domain",
      "id": "automatic-renewal-of-domain"
    },
    {
      "level": "h2",
      "text": "Set up automatic renewals",
      "id": "set-up-automatic-renewals"
    },
    {
      "level": "h2",
      "text": "Renew a domain manually",
      "id": "renew-a-domain-manually"
    },
    {
      "level": "h2",
      "text": "Renewal notifications",
      "id": "renewal-notifications"
    },
    {
      "level": "h2",
      "text": "1. Unlock your domain at Cloudflare",
      "id": "1.-unlock-your-domain-at-cloudflare"
    },
    {
      "level": "h2",
      "text": "2. Transfer to a new registrar",
      "id": "2.-transfer-to-a-new-registrar"
    },
    {
      "level": "h2",
      "text": "What is WHOIS redaction?",
      "id": "what-is-whois-redaction?"
    },
    {
      "level": "h2",
      "text": "What is RDAP?",
      "id": "what-is-rdap?"
    },
    {
      "level": "h2",
      "text": "How can third parties reach registrants?",
      "id": "how-can-third-parties-reach-registrants?"
    },
    {
      "level": "h2",
      "text": "Enable or disable DNSSEC",
      "id": "enable-or-disable-dnssec"
    },
    {
      "level": "h2",
      "text": "Confirming DNSSEC",
      "id": "confirming-dnssec"
    },
    {
      "level": "h2",
      "text": "Prerequisites and restrictions",
      "id": "prerequisites-and-restrictions"
    },
    {
      "level": "h2",
      "text": "How to register a new domain",
      "id": "how-to-register-a-new-domain"
    },
    {
      "level": "h2",
      "text": "Contact requirements",
      "id": "contact-requirements"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Before transferring a domain to Cloudflare",
      "id": "before-transferring-a-domain-to-cloudflare"
    },
    {
      "level": "h3",
      "text": "Disable DNSSEC",
      "id": "disable-dnssec"
    },
    {
      "level": "h2",
      "text": "Restrictions",
      "id": "restrictions"
    },
    {
      "level": "h2",
      "text": "Set up a domain transfer",
      "id": "set-up-a-domain-transfer"
    },
    {
      "level": "h3",
      "text": "1. Log in to your registrar account",
      "id": "1.-log-in-to-your-registrar-account"
    },
    {
      "level": "h3",
      "text": "2. Unlock the domain",
      "id": "2.-unlock-the-domain"
    },
    {
      "level": "h3",
      "text": "3. Remove WHOIS privacy",
      "id": "3.-remove-whois-privacy"
    },
    {
      "level": "h3",
      "text": "4. Request an authorization code",
      "id": "4.-request-an-authorization-code"
    },
    {
      "level": "h3",
      "text": "5. Initiate your transfer to Cloudflare",
      "id": "5.-initiate-your-transfer-to-cloudflare"
    },
    {
      "level": "h3",
      "text": "6. Input your authorization code",
      "id": "6.-input-your-authorization-code"
    },
    {
      "level": "h3",
      "text": "7. Confirm or input your contact information",
      "id": "7.-confirm-or-input-your-contact-information"
    },
    {
      "level": "h3",
      "text": "8. Approve the transfer",
      "id": "8.-approve-the-transfer"
    },
    {
      "level": "h2",
      "text": "Bulk domain transfers",
      "id": "bulk-domain-transfers"
    },
    {
      "level": "h2",
      "text": "Transfer statuses",
      "id": "transfer-statuses"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "How to transfer a .UK domain to Cloudflare",
      "id": "how-to-transfer-a-.uk-domain-to-cloudflare"
    },
    {
      "level": "h2",
      "text": "Transfer a .UK domain to another registrar",
      "id": "transfer-a-.uk-domain-to-another-registrar"
    },
    {
      "level": "h2",
      "text": "Registration requirements for .US domains",
      "id": "registration-requirements-for-.us-domains"
    },
    {
      "level": "h3",
      "text": "Application purpose",
      "id": "application-purpose"
    },
    {
      "level": "h3",
      "text": ".US WHOIS requirements",
      "id": ".us-whois-requirements"
    },
    {
      "level": "h3",
      "text": ".US domain transfers",
      "id": ".us-domain-transfers"
    },
    {
      "level": "h2",
      "text": "Required permissions",
      "id": "required-permissions"
    },
    {
      "level": "h2",
      "text": "Endpoints",
      "id": "endpoints"
    },
    {
      "level": "h2",
      "text": "Example API calls",
      "id": "example-api-calls"
    },
    {
      "level": "h3",
      "text": "List of Cloud Connector rules",
      "id": "list-of-cloud-connector-rules"
    },
    {
      "level": "h3",
      "text": "Create/update/delete Cloud Connector rules",
      "id": "create/update/delete-cloud-connector-rules"
    },
    {
      "level": "h2",
      "text": "Required permissions",
      "id": "required-permissions"
    },
    {
      "level": "h2",
      "text": "Example configuration",
      "id": "example-configuration"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "Cloudflare R2",
      "id": "cloudflare-r2"
    },
    {
      "level": "h2",
      "text": "Amazon Web Services - S3",
      "id": "amazon-web-services---s3"
    },
    {
      "level": "h3",
      "text": "SSL connections to AWS S3 endpoints",
      "id": "ssl-connections-to-aws-s3-endpoints"
    },
    {
      "level": "h3",
      "text": "Get the bucket URL",
      "id": "get-the-bucket-url"
    },
    {
      "level": "h2",
      "text": "Google Cloud Platform - Cloud Storage",
      "id": "google-cloud-platform---cloud-storage"
    },
    {
      "level": "h3",
      "text": "Get the bucket URL",
      "id": "get-the-bucket-url"
    },
    {
      "level": "h2",
      "text": "Microsoft Azure - Blob Storage",
      "id": "microsoft-azure---blob-storage"
    },
    {
      "level": "h3",
      "text": "Get the bucket URL",
      "id": "get-the-bucket-url"
    },
    {
      "level": "h2",
      "text": "Basic rule settings",
      "id": "basic-rule-settings"
    },
    {
      "level": "h2",
      "text": "Procedure",
      "id": "procedure"
    },
    {
      "level": "h2",
      "text": "Example requests",
      "id": "example-requests"
    },
    {
      "level": "h2",
      "text": "Required API token permissions",
      "id": "required-api-token-permissions"
    },
    {
      "level": "h2",
      "text": "Automatic HTTPS Rewrites",
      "id": "automatic-https-rewrites"
    },
    {
      "level": "h2",
      "text": "Browser Integrity Check",
      "id": "browser-integrity-check"
    },
    {
      "level": "h2",
      "text": "Disable Real User Monitoring (RUM)",
      "id": "disable-real-user-monitoring-(rum)"
    },
    {
      "level": "h2",
      "text": "Disable Zaraz",
      "id": "disable-zaraz"
    },
    {
      "level": "h2",
      "text": "Hotlink Protection",
      "id": "hotlink-protection"
    },
    {
      "level": "h2",
      "text": "Email Obfuscation",
      "id": "email-obfuscation"
    },
    {
      "level": "h2",
      "text": "Fonts",
      "id": "fonts"
    },
    {
      "level": "h2",
      "text": "Mirage",
      "id": "mirage"
    },
    {
      "level": "h2",
      "text": "Opportunistic Encryption",
      "id": "opportunistic-encryption"
    },
    {
      "level": "h2",
      "text": "Polish",
      "id": "polish"
    },
    {
      "level": "h2",
      "text": "Rocket Loader",
      "id": "rocket-loader"
    },
    {
      "level": "h2",
      "text": "I'm Under Attack",
      "id": "i'm-under-attack"
    },
    {
      "level": "h2",
      "text": "SSL",
      "id": "ssl"
    },
    {
      "level": "h3",
      "text": "Create a custom error asset",
      "id": "create-a-custom-error-asset"
    },
    {
      "level": "h3",
      "text": "List custom error assets",
      "id": "list-custom-error-assets"
    },
    {
      "level": "h3",
      "text": "Update a custom error asset",
      "id": "update-a-custom-error-asset"
    },
    {
      "level": "h3",
      "text": "Get a custom error asset",
      "id": "get-a-custom-error-asset"
    },
    {
      "level": "h3",
      "text": "Delete a custom error asset",
      "id": "delete-a-custom-error-asset"
    },
    {
      "level": "h3",
      "text": "Get error page",
      "id": "get-error-page"
    },
    {
      "level": "h3",
      "text": "Update error page",
      "id": "update-error-page"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "In the dashboard",
      "id": "in-the-dashboard"
    },
    {
      "level": "h3",
      "text": "Create a custom error rule",
      "id": "create-a-custom-error-rule"
    },
    {
      "level": "h3",
      "text": "Create a custom error asset",
      "id": "create-a-custom-error-asset"
    },
    {
      "level": "h2",
      "text": "Via API",
      "id": "via-api"
    },
    {
      "level": "h3",
      "text": "Create a custom error asset",
      "id": "create-a-custom-error-asset"
    },
    {
      "level": "h3",
      "text": "Create a custom error rule",
      "id": "create-a-custom-error-rule"
    },
    {
      "level": "h3",
      "text": "Required API token permissions",
      "id": "required-api-token-permissions"
    },
    {
      "level": "h2",
      "text": "1. Design your custom error page",
      "id": "1.-design-your-custom-error-page"
    },
    {
      "level": "h2",
      "text": "2. Update an error page in the dashboard",
      "id": "2.-update-an-error-page-in-the-dashboard"
    },
    {
      "level": "h2",
      "text": "Fetch custom error page again",
      "id": "fetch-custom-error-page-again"
    },
    {
      "level": "h3",
      "text": "Custom JSON response for all 5XX errors",
      "id": "custom-json-response-for-all-5xx-errors"
    },
    {
      "level": "h3",
      "text": "Custom HTML response with updated status code",
      "id": "custom-html-response-with-updated-status-code"
    },
    {
      "level": "h3",
      "text": "Custom HTML response for Cloudflare 1020 errors",
      "id": "custom-html-response-for-cloudflare-1020-errors"
    },
    {
      "level": "h3",
      "text": "Custom error asset created from a URL",
      "id": "custom-error-asset-created-from-a-url"
    },
    {
      "level": "h2",
      "text": "Cannot preview error page",
      "id": "cannot-preview-error-page"
    },
    {
      "level": "h2",
      "text": "Error pages for blocked requests",
      "id": "error-pages-for-blocked-requests"
    },
    {
      "level": "h2",
      "text": "1XXX errors",
      "id": "1xxx-errors"
    },
    {
      "level": "h2",
      "text": "Custom error page size",
      "id": "custom-error-page-size"
    },
    {
      "level": "h2",
      "text": "General troubleshooting advice",
      "id": "general-troubleshooting-advice"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "RFC 3986 normalization",
      "id": "rfc-3986-normalization"
    },
    {
      "level": "h2",
      "text": "Cloudflare normalization",
      "id": "cloudflare-normalization"
    },
    {
      "level": "h2",
      "text": "Normalization type",
      "id": "normalization-type"
    },
    {
      "level": "h2",
      "text": "Normalize incoming URLs",
      "id": "normalize-incoming-urls"
    },
    {
      "level": "h2",
      "text": "Normalize URLs to origin",
      "id": "normalize-urls-to-origin"
    },
    {
      "level": "h2",
      "text": "Basic rule settings",
      "id": "basic-rule-settings"
    },
    {
      "level": "h2",
      "text": "Procedure",
      "id": "procedure"
    },
    {
      "level": "h2",
      "text": "Example requests",
      "id": "example-requests"
    },
    {
      "level": "h2",
      "text": "Required API token permissions",
      "id": "required-api-token-permissions"
    },
    {
      "level": "h2",
      "text": "What happens if I use both an origin rule and a page rule to perform a Host header/DNS record override?",
      "id": "what-happens-if-i-use-both-an-origin-rule-and-a-page-rule-to-perform-a-host-header/dns-record-override?"
    },
    {
      "level": "h2",
      "text": "Will Cloudflare automatically migrate my Page Rules with Host header and DNS record overrides to origin rules?",
      "id": "will-cloudflare-automatically-migrate-my-page-rules-with-host-header-and-dns-record-overrides-to-origin-rules?"
    },
    {
      "level": "h2",
      "text": "What happens if more than one origin rule matches the current request?",
      "id": "what-happens-if-more-than-one-origin-rule-matches-the-current-request?"
    },
    {
      "level": "h2",
      "text": "Host header",
      "id": "host-header"
    },
    {
      "level": "h2",
      "text": "Server Name Indication (SNI)",
      "id": "server-name-indication-(sni)"
    },
    {
      "level": "h2",
      "text": "DNS record",
      "id": "dns-record"
    },
    {
      "level": "h2",
      "text": "Destination port",
      "id": "destination-port"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Host header override parameters",
      "id": "host-header-override-parameters"
    },
    {
      "level": "h2",
      "text": "SNI override parameters",
      "id": "sni-override-parameters"
    },
    {
      "level": "h2",
      "text": "DNS record override and destination port override parameters",
      "id": "dns-record-override-and-destination-port-override-parameters"
    },
    {
      "level": "h2",
      "text": "Configuring several overrides in the same rule",
      "id": "configuring-several-overrides-in-the-same-rule"
    },
    {
      "level": "h2",
      "text": "Create a page rule",
      "id": "create-a-page-rule"
    },
    {
      "level": "h2",
      "text": "Edit a page rule",
      "id": "edit-a-page-rule"
    },
    {
      "level": "h2",
      "text": "Delete a page rule",
      "id": "delete-a-page-rule"
    },
    {
      "level": "h2",
      "text": "Will this deprecation affect my account?",
      "id": "will-this-deprecation-affect-my-account?"
    },
    {
      "level": "h2",
      "text": "Which Cloudflare products should I use instead?",
      "id": "which-cloudflare-products-should-i-use-instead?"
    },
    {
      "level": "h2",
      "text": "Can I disable ESC right now to understand the deprecation impact?",
      "id": "can-i-disable-esc-right-now-to-understand-the-deprecation-impact?"
    },
    {
      "level": "h2",
      "text": "What kind of tests can I run?",
      "id": "what-kind-of-tests-can-i-run?"
    },
    {
      "level": "h2",
      "text": "What is the recommended testing strategy?",
      "id": "what-is-the-recommended-testing-strategy?"
    },
    {
      "level": "h2",
      "text": "Disabling ESC via API",
      "id": "disabling-esc-via-api"
    },
    {
      "level": "h3",
      "text": "API operations",
      "id": "api-operations"
    },
    {
      "level": "h3",
      "text": "API examples",
      "id": "api-examples"
    },
    {
      "level": "h2",
      "text": "Final remarks",
      "id": "final-remarks"
    },
    {
      "level": "h2",
      "text": "Page Rules migration",
      "id": "page-rules-migration"
    },
    {
      "level": "h2",
      "text": "Why transition?",
      "id": "why-transition?"
    },
    {
      "level": "h2",
      "text": "Key differences",
      "id": "key-differences"
    },
    {
      "level": "h2",
      "text": "Convert Page Rules URLs to filter expressions",
      "id": "convert-page-rules-urls-to-filter-expressions"
    },
    {
      "level": "h3",
      "text": "Important considerations",
      "id": "important-considerations"
    },
    {
      "level": "h2",
      "text": "Feature correspondence table",
      "id": "feature-correspondence-table"
    },
    {
      "level": "h3",
      "text": "Migrate Always Use HTTPS",
      "id": "migrate-always-use-https"
    },
    {
      "level": "h3",
      "text": "Migrate Automatic HTTPS Rewrites",
      "id": "migrate-automatic-https-rewrites"
    },
    {
      "level": "h3",
      "text": "Migrate Browser Cache TTL",
      "id": "migrate-browser-cache-ttl"
    },
    {
      "level": "h3",
      "text": "Migrate Browser Integrity Check",
      "id": "migrate-browser-integrity-check"
    },
    {
      "level": "h3",
      "text": "Migrate Bypass Cache on Cookie",
      "id": "migrate-bypass-cache-on-cookie"
    },
    {
      "level": "h3",
      "text": "Migrate Cache By Device Type",
      "id": "migrate-cache-by-device-type"
    },
    {
      "level": "h3",
      "text": "Migrate Cache Deception Armor",
      "id": "migrate-cache-deception-armor"
    },
    {
      "level": "h3",
      "text": "Migrate Cache Level (Cache Everything)",
      "id": "migrate-cache-level-(cache-everything)"
    },
    {
      "level": "h3",
      "text": "Migrate Cache on Cookie",
      "id": "migrate-cache-on-cookie"
    },
    {
      "level": "h3",
      "text": "Migrate Cache TTL by status code",
      "id": "migrate-cache-ttl-by-status-code"
    },
    {
      "level": "h3",
      "text": "Migrate Custom Cache Key",
      "id": "migrate-custom-cache-key"
    },
    {
      "level": "h3",
      "text": "Migrate Disable Apps",
      "id": "migrate-disable-apps"
    },
    {
      "level": "h3",
      "text": "Replace Disable Performance",
      "id": "replace-disable-performance"
    },
    {
      "level": "h3",
      "text": "Replace Disable Security",
      "id": "replace-disable-security"
    },
    {
      "level": "h3",
      "text": "Migrate Disable Zaraz",
      "id": "migrate-disable-zaraz"
    },
    {
      "level": "h3",
      "text": "Migrate Edge Cache TTL",
      "id": "migrate-edge-cache-ttl"
    },
    {
      "level": "h3",
      "text": "Migrate Email Obfuscation",
      "id": "migrate-email-obfuscation"
    },
    {
      "level": "h3",
      "text": "Migrate Forwarding URL",
      "id": "migrate-forwarding-url"
    },
    {
      "level": "h3",
      "text": "Migrate Host Header Override",
      "id": "migrate-host-header-override"
    },
    {
      "level": "h3",
      "text": "Migrate IP Geolocation Header",
      "id": "migrate-ip-geolocation-header"
    },
    {
      "level": "h3",
      "text": "Migrate Mirage (deprecated)",
      "id": "migrate-mirage-(deprecated)"
    },
    {
      "level": "h3",
      "text": "Migrate Opportunistic Encryption",
      "id": "migrate-opportunistic-encryption"
    },
    {
      "level": "h3",
      "text": "Migrate Origin Cache Control",
      "id": "migrate-origin-cache-control"
    },
    {
      "level": "h3",
      "text": "Migrate Origin Error Page Pass-thru",
      "id": "migrate-origin-error-page-pass-thru"
    },
    {
      "level": "h3",
      "text": "Migrate Polish",
      "id": "migrate-polish"
    },
    {
      "level": "h3",
      "text": "Migrate Query String Sort",
      "id": "migrate-query-string-sort"
    },
    {
      "level": "h3",
      "text": "Migrate Resolve Override",
      "id": "migrate-resolve-override"
    },
    {
      "level": "h3",
      "text": "Migrate Respect Strong ETags",
      "id": "migrate-respect-strong-etags"
    },
    {
      "level": "h3",
      "text": "Migrate Rocket Loader",
      "id": "migrate-rocket-loader"
    },
    {
      "level": "h3",
      "text": "Migrate Security Level",
      "id": "migrate-security-level"
    },
    {
      "level": "h3",
      "text": "Migrate True Client IP Header",
      "id": "migrate-true-client-ip-header"
    },
    {
      "level": "h3",
      "text": "Migrate SSL",
      "id": "migrate-ssl"
    },
    {
      "level": "h2",
      "text": "Settings that will not be migrated",
      "id": "settings-that-will-not-be-migrated"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "Interaction between redirects and other Cloudflare products",
      "id": "interaction-between-redirects-and-other-cloudflare-products"
    },
    {
      "level": "h2",
      "text": "Interaction between Cloudflare challenges and Rules features",
      "id": "interaction-between-cloudflare-challenges-and-rules-features"
    },
    {
      "level": "h2",
      "text": "Interaction between redirects and verification procedures like HTTP DCV",
      "id": "interaction-between-redirects-and-verification-procedures-like-http-dcv"
    },
    {
      "level": "h2",
      "text": "Content-Length header removed from response",
      "id": "content-length-header-removed-from-response"
    },
    {
      "level": "h2",
      "text": "This rule may not apply to your traffic",
      "id": "this-rule-may-not-apply-to-your-traffic"
    },
    {
      "level": "h2",
      "text": "URL rewrites affect other Rules features executed later",
      "id": "url-rewrites-affect-other-rules-features-executed-later"
    },
    {
      "level": "h3",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "Basic rule settings",
      "id": "basic-rule-settings"
    },
    {
      "level": "h2",
      "text": "Procedure",
      "id": "procedure"
    },
    {
      "level": "h2",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h2",
      "text": "Dashboard configuration settings",
      "id": "dashboard-configuration-settings"
    },
    {
      "level": "h3",
      "text": "Enable Zstandard (Zstd) compression Beta",
      "id": "enable-zstandard-(zstd)-compression-beta"
    },
    {
      "level": "h3",
      "text": "Enable Brotli and Gzip compression",
      "id": "enable-brotli-and-gzip-compression"
    },
    {
      "level": "h3",
      "text": "Disable compression",
      "id": "disable-compression"
    },
    {
      "level": "h3",
      "text": "Custom",
      "id": "custom"
    },
    {
      "level": "h2",
      "text": "API configuration settings",
      "id": "api-configuration-settings"
    },
    {
      "level": "h2",
      "text": "2024-04-15",
      "id": "2024-04-15"
    },
    {
      "level": "h2",
      "text": "2024-03-18",
      "id": "2024-03-18"
    },
    {
      "level": "h2",
      "text": "2024-03-12",
      "id": "2024-03-12"
    },
    {
      "level": "h2",
      "text": "Use Trace in the dashboard",
      "id": "use-trace-in-the-dashboard"
    },
    {
      "level": "h3",
      "text": "1. Configure one or more Cloudflare products",
      "id": "1.-configure-one-or-more-cloudflare-products"
    },
    {
      "level": "h3",
      "text": "2. Build a trace",
      "id": "2.-build-a-trace"
    },
    {
      "level": "h3",
      "text": "3. Assess results",
      "id": "3.-assess-results"
    },
    {
      "level": "h3",
      "text": "4. (Optional) Save the trace configuration",
      "id": "4.-(optional)-save-the-trace-configuration"
    },
    {
      "level": "h2",
      "text": "Use Trace via API",
      "id": "use-trace-via-api"
    },
    {
      "level": "h2",
      "text": "Steps in trace results",
      "id": "steps-in-trace-results"
    },
    {
      "level": "h2",
      "text": "Required permissions",
      "id": "required-permissions"
    },
    {
      "level": "h2",
      "text": "Endpoints",
      "id": "endpoints"
    },
    {
      "level": "h2",
      "text": "Example API calls",
      "id": "example-api-calls"
    },
    {
      "level": "h3",
      "text": "Create/update code snippet",
      "id": "create/update-code-snippet"
    },
    {
      "level": "h3",
      "text": "Create/update/delete snippet rules",
      "id": "create/update/delete-snippet-rules"
    },
    {
      "level": "h2",
      "text": "Example configuration",
      "id": "example-configuration"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "Error 1201: Snippet tried to continue to origin multiple times",
      "id": "error-1201:-snippet-tried-to-continue-to-origin-multiple-times"
    },
    {
      "level": "h3",
      "text": "Resolution",
      "id": "resolution"
    },
    {
      "level": "h2",
      "text": "Error 1202: Snippets exceeded subrequests limit",
      "id": "error-1202:-snippets-exceeded-subrequests-limit"
    },
    {
      "level": "h3",
      "text": "Resolution",
      "id": "resolution"
    },
    {
      "level": "h2",
      "text": "Snippets cannot be renamed",
      "id": "snippets-cannot-be-renamed"
    },
    {
      "level": "h3",
      "text": "Resolution",
      "id": "resolution"
    },
    {
      "level": "h2",
      "text": "1. Evaluate snippet rules",
      "id": "1.-evaluate-snippet-rules"
    },
    {
      "level": "h2",
      "text": "2. Build Snippets table",
      "id": "2.-build-snippets-table"
    },
    {
      "level": "h2",
      "text": "3. Execute snippets code",
      "id": "3.-execute-snippets-code"
    },
    {
      "level": "h2",
      "text": "4. Continue with the request execution workflow",
      "id": "4.-continue-with-the-request-execution-workflow"
    },
    {
      "level": "h2",
      "text": "What are Snippets?",
      "id": "what-are-snippets?"
    },
    {
      "level": "h2",
      "text": "What are Workers?",
      "id": "what-are-workers?"
    },
    {
      "level": "h2",
      "text": "Choosing the right product",
      "id": "choosing-the-right-product"
    },
    {
      "level": "h3",
      "text": "When to use Snippets",
      "id": "when-to-use-snippets"
    },
    {
      "level": "h3",
      "text": "What Snippets are not designed for",
      "id": "what-snippets-are-not-designed-for"
    },
    {
      "level": "h3",
      "text": "Key features",
      "id": "key-features"
    },
    {
      "level": "h2",
      "text": "Snippets vs Workers: Feature comparison",
      "id": "snippets-vs-workers:-feature-comparison"
    },
    {
      "level": "h2",
      "text": "Code examples: Common Snippets templates",
      "id": "code-examples:-common-snippets-templates"
    },
    {
      "level": "h3",
      "text": "Modify HTTP headers",
      "id": "modify-http-headers"
    },
    {
      "level": "h3",
      "text": "Serve a custom maintenance page",
      "id": "serve-a-custom-maintenance-page"
    },
    {
      "level": "h3",
      "text": "Custom cache",
      "id": "custom-cache"
    },
    {
      "level": "h3",
      "text": "Redirect based on country code",
      "id": "redirect-based-on-country-code"
    },
    {
      "level": "h3",
      "text": "Redirect 403 Forbidden to a different page",
      "id": "redirect-403-forbidden-to-a-different-page"
    },
    {
      "level": "h3",
      "text": "Retry to another origin",
      "id": "retry-to-another-origin"
    },
    {
      "level": "h3",
      "text": "Remove fields from API response",
      "id": "remove-fields-from-api-response"
    },
    {
      "level": "h3",
      "text": "Set CORS headers",
      "id": "set-cors-headers"
    },
    {
      "level": "h3",
      "text": "Rewrite links on HTML pages",
      "id": "rewrite-links-on-html-pages"
    },
    {
      "level": "h3",
      "text": "Slow down requests",
      "id": "slow-down-requests"
    },
    {
      "level": "h2",
      "text": "Using Snippets and Workers together",
      "id": "using-snippets-and-workers-together"
    },
    {
      "level": "h3",
      "text": "Example 1: Passing data between Snippets and Workers",
      "id": "example-1:-passing-data-between-snippets-and-workers"
    },
    {
      "level": "h3",
      "text": "Example 2: Caching Worker responses using Snippets",
      "id": "example-2:-caching-worker-responses-using-snippets"
    },
    {
      "level": "h2",
      "text": "Migration between Snippets and Workers",
      "id": "migration-between-snippets-and-workers"
    },
    {
      "level": "h3",
      "text": "When to migrate workloads to Snippets",
      "id": "when-to-migrate-workloads-to-snippets"
    },
    {
      "level": "h3",
      "text": "When to migrate workloads to Workers",
      "id": "when-to-migrate-workloads-to-workers"
    },
    {
      "level": "h2",
      "text": "Conclusion",
      "id": "conclusion"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "Important remarks",
      "id": "important-remarks"
    },
    {
      "level": "h2",
      "text": "Execution order",
      "id": "execution-order"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Important remarks",
      "id": "important-remarks"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Why do I not see my request header modifications?",
      "id": "why-do-i-not-see-my-request-header-modifications?"
    },
    {
      "level": "h2",
      "text": "Static and dynamic rewrites",
      "id": "static-and-dynamic-rewrites"
    },
    {
      "level": "h2",
      "text": "Serve images from custom paths",
      "id": "serve-images-from-custom-paths"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Important remarks",
      "id": "important-remarks"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Rule evaluation",
      "id": "rule-evaluation"
    },
    {
      "level": "h3",
      "text": "Field values during rule evaluation",
      "id": "field-values-during-rule-evaluation"
    },
    {
      "level": "h2",
      "text": "Entry point ruleset",
      "id": "entry-point-ruleset"
    },
    {
      "level": "h2",
      "text": "Managed rulesets",
      "id": "managed-rulesets"
    },
    {
      "level": "h2",
      "text": "Custom rulesets",
      "id": "custom-rulesets"
    },
    {
      "level": "h2",
      "text": "Example: Set the rules of a phase entry point ruleset at the zone level",
      "id": "example:-set-the-rules-of-a-phase-entry-point-ruleset-at-the-zone-level"
    },
    {
      "level": "h2",
      "text": "Example: Add a single rule to a phase entry point ruleset at the zone level",
      "id": "example:-add-a-single-rule-to-a-phase-entry-point-ruleset-at-the-zone-level"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "View available rulesets",
      "id": "view-available-rulesets"
    },
    {
      "level": "h3",
      "text": "Example: View available rulesets at the zone level",
      "id": "example:-view-available-rulesets-at-the-zone-level"
    },
    {
      "level": "h3",
      "text": "Example: View available rulesets at the account level",
      "id": "example:-view-available-rulesets-at-the-account-level"
    },
    {
      "level": "h2",
      "text": "Get an entry point ruleset",
      "id": "get-an-entry-point-ruleset"
    },
    {
      "level": "h3",
      "text": "Example: Get an entry point ruleset at the zone level",
      "id": "example:-get-an-entry-point-ruleset-at-the-zone-level"
    },
    {
      "level": "h3",
      "text": "Example: Get an entry point ruleset at the account level",
      "id": "example:-get-an-entry-point-ruleset-at-the-account-level"
    },
    {
      "level": "h2",
      "text": "View the rules included in a ruleset",
      "id": "view-the-rules-included-in-a-ruleset"
    },
    {
      "level": "h3",
      "text": "Example: View rules in a phase entry point ruleset at the zone level",
      "id": "example:-view-rules-in-a-phase-entry-point-ruleset-at-the-zone-level"
    },
    {
      "level": "h3",
      "text": "Example: View rules in a managed ruleset",
      "id": "example:-view-rules-in-a-managed-ruleset"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Add rules",
      "id": "add-rules"
    },
    {
      "level": "h2",
      "text": "Update rules",
      "id": "update-rules"
    },
    {
      "level": "h2",
      "text": "Example A - Custom ruleset at the account level",
      "id": "example-a---custom-ruleset-at-the-account-level"
    },
    {
      "level": "h2",
      "text": "Example B - Custom ruleset at the zone level",
      "id": "example-b---custom-ruleset-at-the-zone-level"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Example A - Account-level deployment",
      "id": "example-a---account-level-deployment"
    },
    {
      "level": "h2",
      "text": "Example B - Zone-level deployment",
      "id": "example-b---zone-level-deployment"
    },
    {
      "level": "h2",
      "text": "Deploy a managed ruleset to a phase at the zone level",
      "id": "deploy-a-managed-ruleset-to-a-phase-at-the-zone-level"
    },
    {
      "level": "h3",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Deploy a managed ruleset to a phase at the account level",
      "id": "deploy-a-managed-ruleset-to-a-phase-at-the-account-level"
    },
    {
      "level": "h3",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Types of exceptions",
      "id": "types-of-exceptions"
    },
    {
      "level": "h3",
      "text": "Skip all remaining rules",
      "id": "skip-all-remaining-rules"
    },
    {
      "level": "h3",
      "text": "Skip one or more managed rulesets",
      "id": "skip-one-or-more-managed-rulesets"
    },
    {
      "level": "h3",
      "text": "Skip one or more rules of managed rulesets",
      "id": "skip-one-or-more-rules-of-managed-rulesets"
    },
    {
      "level": "h2",
      "text": "Additional notes",
      "id": "additional-notes"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Work with overrides",
      "id": "work-with-overrides"
    },
    {
      "level": "h2",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h3",
      "text": "Rule override example",
      "id": "rule-override-example"
    },
    {
      "level": "h3",
      "text": "Ruleset override example",
      "id": "ruleset-override-example"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "Network layer",
      "id": "network-layer"
    },
    {
      "level": "h2",
      "text": "Application layer",
      "id": "application-layer"
    },
    {
      "level": "h3",
      "text": "Request phases",
      "id": "request-phases"
    },
    {
      "level": "h3",
      "text": "Response phases",
      "id": "response-phases"
    },
    {
      "level": "h2",
      "text": "Supported actions",
      "id": "supported-actions"
    },
    {
      "level": "h2",
      "text": "Simple expressions",
      "id": "simple-expressions"
    },
    {
      "level": "h2",
      "text": "Compound expressions",
      "id": "compound-expressions"
    },
    {
      "level": "h2",
      "text": "Maximum rule expression length",
      "id": "maximum-rule-expression-length"
    },
    {
      "level": "h2",
      "text": "Additional features",
      "id": "additional-features"
    },
    {
      "level": "h2",
      "text": "Differences from Wireshark display fields",
      "id": "differences-from-wireshark-display-fields"
    },
    {
      "level": "h2",
      "text": "Transformation functions",
      "id": "transformation-functions"
    },
    {
      "level": "h3",
      "text": "`any`",
      "id": "`any`"
    },
    {
      "level": "h3",
      "text": "`all`",
      "id": "`all`"
    },
    {
      "level": "h3",
      "text": "`cidr`",
      "id": "`cidr`"
    },
    {
      "level": "h3",
      "text": "`cidr6`",
      "id": "`cidr6`"
    },
    {
      "level": "h3",
      "text": "`concat`",
      "id": "`concat`"
    },
    {
      "level": "h3",
      "text": "`decode_base64`",
      "id": "`decode_base64`"
    },
    {
      "level": "h3",
      "text": "`ends_with`",
      "id": "`ends_with`"
    },
    {
      "level": "h3",
      "text": "`join`",
      "id": "`join`"
    }
  ],
  "url": "llms-txt#customize-your-customers-cloudflare-experience",
  "links": []
}