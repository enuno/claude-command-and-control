{
  "title": "Cache rule configuring cache settings and defining custom cache keys",
  "content": "resource \"cloudflare_ruleset\" \"cache_rules_example\" {\n  zone_id     = \"<ZONE_ID>\"\n  name        = \"Set cache settings\"\n  description = \"Set cache settings for incoming requests\"\n  kind        = \"zone\"\n  phase       = \"http_request_cache_settings\"\n\nrules {\n    ref         = \"cache_settings_custom_cache_key\"\n    description = \"Set cache settings and custom cache key for example.net\"\n    expression  = \"(http.host eq \\\"example.net\\\")\"\n    action      = \"set_cache_settings\"\n    action_parameters {\n      edge_ttl {\n        mode    = \"override_origin\"\n        default = 60\n        status_code_ttl {\n          status_code = 200\n          value       = 50\n        }\n        status_code_ttl {\n          status_code_range {\n            from = 201\n            to   = 300\n          }\n          value = 30\n        }\n      }\n      browser_ttl {\n        mode = \"respect_origin\"\n      }\n      serve_stale {\n        disable_stale_while_updating = true\n      }\n      respect_strong_etags = true\n      cache_key {\n        ignore_query_strings_order = false\n        cache_deception_armor      = true\n        custom_key {\n          query_string {\n            exclude {\n              all = true\n            }\n          }\n          header {\n            include        = [\"habc\", \"hdef\"]\n            check_presence = [\"habc_t\", \"hdef_t\"]\n            exclude_origin = true\n          }\n          cookie {\n            include        = [\"cabc\", \"cdef\"]\n            check_presence = [\"cabc_t\", \"cdef_t\"]\n          }\n          user {\n            device_type = true\n            geo         = false\n          }\n          host {\n            resolved = true\n          }\n        }\n      }\n      origin_error_page_passthru = false\n    }\n  }\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/purge_cache\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"files\": [\n        {\n            \"url\": \"http://my.website.com/\",\n            \"headers\": {\n                \"CF-Device-Type\": \"mobile\"\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/purge_cache\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"files\": [\n        {\n            \"url\": \"http://my.website.com/\",\n            \"headers\": {\n                \"CF-IPCountry\": \"ES\"\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/purge_cache\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"files\": [\n        {\n            \"url\": \"http://my.website.com/\",\n            \"headers\": {\n                \"accept-language\": \"zh-CN\"\n            }\n        }\n    ]\n  }'\nbash\nhttps://api.cloudflare.com/client/v4/zones/<zone_id>/environments\njson\n{\n  \"result\": {\n    \"environments\": [\n      {\n        \"name\": \"Production\",\n        \"ref\": \"12abcd3e45f678940a573f51834a54\",\n        \"version\": 0,\n        \"expression\": \"(cf.zone.name eq \\\"example.com\\\")\",\n        \"locked_on_deployment\": false,\n        \"position\": {\n          \"before\": \"5d41402abc4b2a76b9719d911017c\"\n        }\n      },\n      {\n        \"name\": \"Staging\",\n        \"ref\": \"5d41402abc4b2a76b9719d911017c\",\n        \"version\": 0,\n        \"expression\": \"((cf.edge.server_ip in {1.2.3.4 5.6.7.8})) and (cf.zone.name eq \\\"example.com\\\")\",\n        \"locked_on_deployment\": false,\n        \"position\": {\n          \"before\": \"49f0bad299687c62334182178bfd\",\n          \"after\": \"12abcd3e45f678940a573f51834a54\"\n        }\n      },\n      {\n        \"name\": \"Development\",\n        \"ref\": \"49f0bad299687c62334182178bfd\",\n        \"version\": 0,\n        \"expression\": \"((any(http.request.cookies[\\\"development\\\"][*] eq \\\"true\\\"))) and (cf.zone.name eq \\\"example.com\\\")\",\n        \"locked_on_deployment\": false,\n        \"position\": {\n          \"after\": \"5d41402abc4b2a76b9719d911017c\"\n        }\n      }\n    ]\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\nhttps://api.cloudflare.com/client/v4/zones/<zone_id>/purge_cache/\nbash\nhttps://api.cloudflare.com/client/v4/zones/<zone_id>/environments/5d41402abc4b2a76b9719d911017c/purge_cache/\nbash\nhttps://api.cloudflare.com/client/v4/zones/<zone_id>/environments/49f0bad299687c62334182178bfd/purge_cache/\nhtml\n<link rel=\"shortcut icon\" href=\"<FAVICON_LINK>\" />\ntxt\nnot cf.response.error_type in {\"managed_challenge\" \"iuam\" \"legacy_challenge\" \"country_challenge\"}\njs\nfetch(\"/my-api-endpoint\").then((response) => {\n  if (response.headers.get(\"cf-mitigated\") === \"challenge\") {\n    // Handle challenged response\n  } else {\n    // Process response as usual\n  }\n});\ntxt\n\"ssl\": {\n    \"cloudflare_branding\": true\n  }\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames/$CUSTOM_HOSTNAME_ID\" \\\n  --request PATCH \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"ssl\": {\n        \"method\": \"http\",\n        \"type\": \"dv\"\n    },\n    \"custom_metadata\": {\n        \"customer_id\": \"12345\",\n        \"redirect_to_https\": true,\n        \"security_tag\": \"low\"\n    }\n  }'\njs\n  export default {\n    /**\n     * Fetch and add a X-Customer-Id header to the origin based on hostname\n     * @param {Request} request\n     */\n    async fetch(request, env, ctx) {\n      const customer_id = request.cf.hostMetadata.customer_id;\n      const newHeaders = new Headers(request.headers);\n      newHeaders.append(\"X-Customer-Id\", customer_id);\n\nconst init = {\n        headers: newHeaders,\n        method: request.method,\n      };\n      return fetch(request.url, init);\n    },\n  };\n  ts\n  export default {\n    /**\n     * Fetch and add a X-Customer-Id header to the origin based on hostname\n     * @param {Request} request\n     */\n    async fetch(request, env, ctx): Promise<Response> {\n      const customer_id = request.cf.hostMetadata.customer_id;\n      const newHeaders = new Headers(request.headers);\n      newHeaders.append(\"X-Customer-Id\", customer_id);\n\nconst init = {\n        headers: newHeaders,\n        method: request.method,\n      };\n      return fetch(request.url, init);\n    },\n  } satisfies ExportedHandler<Env>;\n  txt\nlookup_json_string(cf.hostname.metadata, \"security_tag\") eq \"low\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames\" \\\n  --request POST \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"hostname\": \"<CUSTOM_HOSTNAME>\",\n    \"ssl\": {\n        \"method\": \"http\",\n        \"type\": \"dv\",\n        \"settings\": {\n            \"http2\": \"on\",\n            \"min_tls_version\": \"1.2\",\n            \"tls_1_3\": \"on\",\n            \"early_hints\": \"on\"\n        },\n        \"bundle_method\": \"ubiquitous\",\n        \"wildcard\": false\n    }\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames?hostname=%7Bhostname%7D\" \\\n  --request GET \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames/$CUSTOM_HOSTNAME_ID\" \\\n  --request PATCH \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"ssl\": {\n        \"method\": \"http\",\n        \"type\": \"dv\",\n        \"settings\": {\n            \"http2\": \"on\",\n            \"min_tls_version\": \"1.2\",\n            \"tls_1_3\": \"on\",\n            \"early_hints\": \"on\"\n        }\n    }\n  }'\nplaintext\nexample.com CAA 0 issue \"pki.goog; cansignhttpexchanges=yes\"\nexample.com CAA 0 issuewild \"pki.goog; cansignhttpexchanges=yes\"\n\nexample.com CAA 0 issue \"letsencrypt.org\"\nexample.com CAA 0 issuewild \"letsencrypt.org\"\n\nexample.com CAA 0 issue \"ssl.com\"\nexample.com CAA 0 issuewild \"ssl.com\"\nsh\n  curl --request PATCH \\\\\n  https://api.cloudflare.com/client/v4/zones/{zone_id}/custom_hostnames/{custom_hostname_id} \\\\\n  --header \"X-Auth-Email: <EMAIL>\" \\\\\n  --header \"X-Auth-Key: <API_KEY>\" \\\\\n  --header \"Content-Type: application/json\" \\\\\n  --data '{\n    \"ssl\": {\n        \"method\": \"txt\",\n        \"type\": \"dv\",\n        \"certificate_authority\": \"\"\n    }\n  }'\n  txt\nSince no host is 64 characters or fewer, Cloudflare Branding is required. Please check your input and try again. (1469)\nmermaid\nflowchart TD\naccTitle: O2O-enabled traffic flow diagram\n\nsubgraph Cloudflare\n  B[Customer-owned zone]\n  C[SaaS Provider-owned zone]\nend\n\nD[SaaS Provider Origin]\n\nA --> B\nB --> C\nC --> D\nmermaid\nflowchart TD\naccTitle: Your zone using a SaaS provider, but without O2O\n\nsubgraph Cloudflare\n    B[SaaS Provider-owned zone]\nend\n\nC[SaaS Provider Origin]\n\nA --> B\nB --> C\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames\" \\\n  --request POST \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"hostname\": \"<CUSTOM_HOSTNAME>\",\n    \"ssl\": {\n        \"wildcard\": false\n    }\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames\" \\\n  --request GET \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_hostnames/$CUSTOM_HOSTNAME_ID\" \\\n  --request PATCH \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"custom_metadata\": {\n        \"customer_id\": \"12345\",\n        \"security_level\": \"low\"\n    }\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_ratelimit/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"block\",\n            \"ratelimit\": {\n                \"characteristics\": [\n                    \"cf.colo.id\",\n                    \"ip.src\"\n                ],\n                \"period\": 10,\n                \"requests_per_period\": 2,\n                \"mitigation_timeout\": 60\n            },\n            \"expression\": \"lookup_json_string(cf.hostname.metadata, \\\"security_level\\\") eq \\\"low\\\" and http.request.uri contains \\\"login\\\"\"\n        }\n    ]\n  }'\ntxt\nmystore.example.com CNAME customers.saasprovider.com\nmermaid\nflowchart TD\naccTitle: How traffic routing works with a CNAME target\nA[Request to <code>mystore.example.com</code>] --> B[<code>customers.saasprovider.com</code>]\nB --> C[<code>proxy-fallback.saasprovider.com</code>]\nbash\ncurl -X PUT \\\n  \"https://api.cloudflare.com/client/v4/accounts/<account-id>/workers/dispatch/namespaces/<your-namespace>/scripts/<script-name>\" \\\n  -H \"Content-Type: multipart/form-data\" \\\n  -H \"Authorization: Bearer <api-token>\" \\\n  -F 'metadata={\n    \"main_module\": \"worker.js\",\n    \"bindings\": [\n      {\n        \"type\": \"kv_namespace\",\n        \"name\": \"USER_KV\",\n        \"namespace_id\": \"<your-namespace-id>\"\n      }\n    ]\n  }' \\\n  -F 'worker.js=@/path/to/worker.js'\nbash\ncurl -X PUT \\\n  \"https://api.cloudflare.com/client/v4/accounts/<account-id>/workers/dispatch/namespaces/<your-namespace>/scripts/<script-name>\" \\\n  -H \"Content-Type: multipart/form-data\" \\\n  -H \"Authorization: Bearer <api-token>\" \\\n  -F 'metadata={\n    \"bindings\": [\n      {\n        \"type\": \"r2_bucket\",\n        \"name\": \"STORAGE\",\n        \"bucket_name\": \"<your-bucket-name>\"\n      }\n    ],\n    \"keep_bindings\": [\"kv_namespace\"]\n  }'\njs\nexport default {\n  async fetch(request, env) {\n    try {\n      // parse the URL, read the subdomain\n      let workerName = new URL(request.url).host.split(\".\")[0];\n      let userWorker = env.dispatcher.get(\n        workerName,\n        {},\n        {\n          // set limits\n          limits: { cpuMs: 10, subRequests: 5 },\n        },\n      );\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        // we tried to get a worker that doesn't exist in our dispatch namespace\n        return new Response(\"\", { status: 404 });\n      }\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njsonc\n  {\n    \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n    \"dispatch_namespaces\": [\n      {\n        \"binding\": \"DISPATCHER\",\n        \"namespace\": \"my-dispatch-namespace\"\n      }\n    ]\n  }\n  toml\n  [[dispatch_namespaces]]\n  binding = \"DISPATCHER\"\n  namespace = \"my-dispatch-namespace\"\n  js\nexport default {\n  async fetch(request, env) {\n    try {\n      const url = new URL(request.url);\n\n// Use hostname, path, or any combination as the routing key\n      const routingKey = url.hostname;\n\n// Lookup user Worker name from KV store\n      const userWorkerName = await env.USER_ROUTING.get(routingKey);\n\nif (!userWorkerName) {\n        return new Response(\"Route not configured\", { status: 404 });\n      }\n\n// Optional: Cache the KV lookup result\n      const userWorker = env.DISPATCHER.get(userWorkerName);\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        return new Response(\"\", { status: 404 });\n      }\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njs\nexport default {\n  async fetch(request, env) {\n    try {\n      // Extract user Worker name from subdomain\n      // Example: customer1.example.com -> customer1\n      const url = new URL(request.url);\n      const userWorkerName = url.hostname.split(\".\")[0];\n\n// Get user Worker from dispatch namespace\n      const userWorker = env.DISPATCHER.get(userWorkerName);\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        // User Worker doesn't exist in dispatch namespace\n        return new Response(\"\", { status: 404 });\n      }\n      // Could be any other exception from fetch() or from the dispatched Worker\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njs\nexport default {\n  async fetch(request, env) {\n    try {\n      const url = new URL(request.url);\n      const pathParts = url.pathname.split(\"/\").filter(Boolean);\n\nif (pathParts.length === 0) {\n        return new Response(\"Invalid path\", { status: 400 });\n      }\n\n// example.com/customer-1 -> routes to 'customer-1' worker\n      const userWorkerName = pathParts[0];\n\nconst userWorker = env.DISPATCHER.get(userWorkerName);\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        return new Response(\"\", { status: 404 });\n      }\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njs\nexport default {\n  async fetch(request, env) {\n    try {\n      const url = new URL(request.url);\n      const userWorkerName = url.hostname.split(\".\")[0];\n\n// Look up customer plan from your database or KV\n      const customerPlan = await env.CUSTOMERS.get(userWorkerName);\n\n// Set limits based on plan type\n      const plans = {\n        enterprise: { cpuMs: 50, subRequests: 50 },\n        pro: { cpuMs: 20, subRequests: 20 },\n        free: { cpuMs: 10, subRequests: 5 },\n      };\n      const limits = plans[customerPlan] || plans.free;\n\nconst userWorker = env.DISPATCHER.get(userWorkerName, {}, { limits });\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        return new Response(\"\", { status: 404 });\n      }\n      if (e.message.includes(\"CPU time limit\")) {\n        // Track limit violations with Analytics Engine\n        env.ANALYTICS.writeDataPoint({\n          indexes: [userWorkerName],\n          blobs: [\"cpu_limit_exceeded\"],\n        });\n        return new Response(\"CPU limit exceeded\", { status: 429 });\n      }\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njs\nexport default {\n  async fetch(request, env) {\n    const hostname = new URL(request.url).hostname;\n\n// Get custom hostname metadata for routing decisions\n    const hostnameData = await env.KV.get(`hostname:${hostname}`, {\n      type: \"json\",\n    });\n\nif (!hostnameData?.workerName) {\n      return new Response(\"Hostname not configured\", { status: 404 });\n    }\n\n// Route to the appropriate user Worker\n    const userWorker = env.DISPATCHER.get(hostnameData.workerName);\n    return await userWorker.fetch(request);\n  },\n};\njs\nexport default {\n  async fetch(request, env) {\n    const url = new URL(request.url);\n    const subdomain = url.hostname.split(\".\")[0];\n\n// Route based on subdomain\n    if (subdomain && subdomain !== \"saas\") {\n      const userWorker = env.DISPATCHER.get(subdomain);\n      return await userWorker.fetch(request);\n    }\n\nreturn new Response(\"Invalid subdomain\", { status: 400 });\n  },\n};\njsonc\n  {\n    \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n    \"dispatch_namespaces\": [\n      {\n        \"binding\": \"dispatcher\",\n        \"namespace\": \"<NAMESPACE_NAME>\",\n        \"outbound\": {\n          \"service\": \"<SERVICE_NAME>\",\n          \"parameters\": [\n            \"params_object\"\n          ]\n        }\n      }\n    ]\n  }\n  toml\n  [[dispatch_namespaces]]\n  binding = \"dispatcher\"\n  namespace = \"<NAMESPACE_NAME>\"\n  outbound = {service = \"<SERVICE_NAME>\", parameters = [\"params_object\"]}\n  js\nexport default {\n  async fetch(request, env) {\n    try {\n      // parse the URL, read the subdomain\n      let workerName = new URL(request.url).host.split(\".\")[0];\n\nlet context_from_dispatcher = {\n        customer_name: workerName,\n        url: request.url,\n      };\n\nlet userWorker = env.dispatcher.get(\n        workerName,\n        {},\n        {\n          // outbound arguments. object name must match parameters in the binding\n          outbound: {\n            params_object: context_from_dispatcher,\n          },\n        },\n      );\n      return await userWorker.fetch(request);\n    } catch (e) {\n      if (e.message.startsWith(\"Worker not found\")) {\n        // we tried to get a worker that doesn't exist in our dispatch namespace\n        return new Response(\"\", { status: 404 });\n      }\n      return new Response(e.message, { status: 500 });\n    }\n  },\n};\njs\nexport default {\n  // this event is fired when the dispatched Workers make a subrequest\n  async fetch(request, env, ctx) {\n    // env contains the values we set in `dispatcher.get()`\n    const customer_name = env.customer_name;\n    const original_url = env.url;\n\n// log the request\n    ctx.waitUntil(\n      fetch(\"https://logs.example.com\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          customer_name,\n          original_url,\n        }),\n      }),\n    );\n\nconst url = new URL(original_url);\n    if (url.host === \"api.example.com\") {\n      // pre-auth requests to our API\n      const jwt = make_jwt_for_customer(customer_name);\n\nlet headers = new Headers(request.headers);\n      headers.set(\"Authorization\", `Bearer ${jwt}`);\n\n// clone the request to set new headers using existing body\n      let new_request = new Request(request, { headers });\n\nreturn fetch(new_request);\n    }\n\nreturn fetch(request);\n  },\n};\njson\n{\n  \"/index.html\": {\n    \"hash\": \"08f1dfda4574284ab3c21666d1ee8c7d4\",\n    \"size\": 1234\n  },\n  \"/styles.css\": {\n    \"hash\": \"36b8be012ee77df5f269b11b975611d3\",\n    \"size\": 5678\n  }\n}\nbash\nPOST /accounts/{account_id}/workers/dispatch/namespaces/{namespace}/scripts/{script_name}/assets-upload-session\nbash\ncurl -X POST \\\n  \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME/assets-upload-session\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $API_TOKEN\" \\\n  --data '{\n    \"manifest\": {\n      \"/index.html\": {\n        \"hash\": \"08f1dfda4574284ab3c21666d1ee8c7d4\",\n        \"size\": 1234\n      },\n      \"/styles.css\": {\n        \"hash\": \"36b8be012ee77df5f269b11b975611d3\",\n        \"size\": 5678\n      }\n    }\n  }'\nbash\nAuthorization: Bearer <upload-session-token>\njson\n\"buckets\": [\n  [\n    \"08f1dfda4574284ab3c21666d1ee8c7d4\",\n    \"36b8be012ee77df5f269b11b975611d3\"\n  ]\n]\nbash\ncurl -X POST \\\n  \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/assets/upload?base64=true\" \\\n  -H \"Authorization: Bearer <upload-session-token>\" \\\n  -F \"08f1dfda4574284ab3c21666d1ee8c7d4=<BASE64_OF_INDEX_HTML>\" \\\n  -F \"36b8be012ee77df5f269b11b975611d3=<BASE64_OF_STYLES_CSS>\"\njson\n{\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": [],\n  \"result\": {\n    \"jwt\": \"<completion-token>\"\n  }\n}\nbash\ncurl -X PUT \\\n  \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME\" \\\n  -H \"Content-Type: multipart/form-data\" \\\n  -H \"Authorization: Bearer $API_TOKEN\" \\\n  -F 'metadata={\n    \"main_module\": \"index.js\",\n    \"assets\": {\n      \"jwt\": \"<completion-token>\",\n      \"config\": {\n        \"html_handling\": \"auto-trailing-slash\"\n      }\n    },\n    \"compatibility_date\": \"2025-01-24\"\n  };type=application/json' \\\n  -F 'index.js=@/path/to/index.js;type=application/javascript'\njsonc\n  {\n    \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n    \"name\": \"my-static-site\",\n    \"main\": \"./src/index.js\",\n    \"compatibility_date\": \"2025-01-29\",\n    \"assets\": {\n      \"directory\": \"./public\",\n      \"binding\": \"ASSETS\"\n    }\n  }\n  toml\n  name = \"my-static-site\"\n  main = \"./src/index.js\"\n  compatibility_date = \"2025-01-29\"\n\n[assets]\n  directory = \"./public\"\n  binding = \"ASSETS\"\n  js\nexport default {\n  async fetch(request, env, ctx) {\n    return env.ASSETS.fetch(request);\n  },\n};\nbash\nnpx wrangler deploy --name <USER_WORKER_NAME> --dispatch-namespace <NAMESPACE_NAME>\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts/$SCRIPT_NAME/tags\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts/$SCRIPT_NAME/tags\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts/$SCRIPT_NAME/tags/$TAG\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts/$SCRIPT_NAME/tags/$TAG\" \\\n  --request DELETE \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts?tags=production%3Ayes\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$DISPATCH_NAMESPACE/scripts?tags=customer-123%3Ayes\" \\\n  --request DELETE \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\njsonc\n  {\n    \"dispatch_namespaces\": [\n      {\n        \"binding\": \"DISPATCH_NAMESPACE\",\n        \"namespace\": \"production\",\n        \"remote\": true\n      }\n    ]\n  }\n  toml\n  [[dispatch_namespaces]]\n  binding = \"DISPATCH_NAMESPACE\"\n  namespace = \"production\"\n  remote = true\n  sh\nnpm install cloudflare\nbash\n  # First, create the worker script file\n  cat > worker.mjs << 'EOF'\n  export default {\n    async fetch(request, env, ctx) {\n      return new Response(\"Hello from user Worker!\");\n    },\n  };\n  EOF\n\n# Deploy using multipart form (required for ES modules)\n  curl -X PUT \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME\" \\\n    -H \"Authorization: Bearer $API_TOKEN\" \\\n    -F 'metadata={\"main_module\": \"worker.mjs\"};type=application/json' \\\n    -F 'worker.mjs=@worker.mjs;type=application/javascript+module'\n  typescript\n  import Cloudflare from \"cloudflare\";\n\nconst client = new Cloudflare({\n    apiToken: process.env.API_TOKEN,\n  });\n\nasync function deployUserWorker(\n    accountId: string,\n    namespace: string,\n    scriptName: string,\n    scriptContent: string,\n  ) {\n    const scriptFile = new File([scriptContent], `${scriptName}.mjs`, {\n      type: \"application/javascript+module\",\n    });\n\nconst result =\n      await client.workersForPlatforms.dispatch.namespaces.scripts.update(\n        namespace,\n        scriptName,\n        {\n          account_id: accountId,\n          metadata: {\n            main_module: `${scriptName}.mjs`,\n          },\n          files: [scriptFile],\n        },\n      );\n\n// Usage\n  await deployUserWorker(\n    \"your-account-id\",\n    \"production\",\n    \"customer-123\",\n    `export default {\n    async fetch(request, env, ctx) {\n      return new Response(\"Hello from customer 123!\");\n    },\n  };`,\n  );\n  bash\n  curl -X PUT \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME\" \\\n    -H \"Authorization: Bearer $API_TOKEN\" \\\n    -F 'metadata={\"main_module\": \"worker.mjs\", \"bindings\": [{\"type\": \"kv_namespace\", \"name\": \"MY_KV\", \"namespace_id\": \"your-kv-namespace-id\"}], \"tags\": [\"customer-123\", \"production\", \"pro-plan\"], \"compatibility_date\": \"2024-01-01\"};type=application/json' \\\n    -F 'worker.mjs=@worker.mjs;type=application/javascript+module'\n  typescript\n  import Cloudflare from \"cloudflare\";\n\nconst client = new Cloudflare({\n    apiToken: process.env.API_TOKEN,\n  });\n\nasync function deployWorkerWithBindingsAndTags(\n    accountId: string,\n    namespace: string,\n    scriptName: string,\n    scriptContent: string,\n    kvNamespaceId: string,\n    tags: string[],\n  ) {\n    const scriptFile = new File([scriptContent], `${scriptName}.mjs`, {\n      type: \"application/javascript+module\",\n    });\n\nconst result =\n      await client.workersForPlatforms.dispatch.namespaces.scripts.update(\n        namespace,\n        scriptName,\n        {\n          account_id: accountId,\n          metadata: {\n            main_module: `${scriptName}.mjs`,\n            compatibility_date: \"2024-01-01\",\n            bindings: [\n              {\n                type: \"kv_namespace\",\n                name: \"MY_KV\",\n                namespace_id: kvNamespaceId,\n              },\n            ],\n            tags: tags, // e.g., [\"customer-123\", \"production\", \"pro-plan\"]\n          },\n          files: [scriptFile],\n        },\n      );\n\n// Usage\n  const scriptContent = `export default {\n    async fetch(request, env, ctx) {\n      const value = await env.MY_KV.get(\"key\") || \"default\";\n      return new Response(value);\n    },\n  };`;\n\nawait deployWorkerWithBindingsAndTags(\n    \"your-account-id\",\n    \"production\",\n    \"customer-123-app\",\n    scriptContent,\n    \"kv-namespace-id\",\n    [\"customer-123\", \"production\", \"pro-plan\"],\n  );\n  bash\n  curl -X POST \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME/assets-upload-session\" \\\n    -H \"Authorization: Bearer $API_TOKEN\" \\\n    -H \"Content-Type: application/json\" \\\n    -d '{\n      \"manifest\": {\n        \"/index.html\": {\n          \"hash\": \"<sha256-hash-first-16-bytes-hex>\",\n          \"size\": 1234\n        },\n        \"/styles.css\": {\n          \"hash\": \"<sha256-hash-first-16-bytes-hex>\",\n          \"size\": 567\n        }\n      }\n    }'\n  bash\n  curl -X POST \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/assets/upload?base64=true\" \\\n    -H \"Authorization: Bearer $JWT_FROM_STEP_1\" \\\n    -F '<hash1>=<base64-encoded-content>' \\\n    -F '<hash2>=<base64-encoded-content>'\n  bash\n  curl -X PUT \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME\" \\\n    -H \"Authorization: Bearer $API_TOKEN\" \\\n    -F 'metadata={\"main_module\": \"worker.mjs\", \"assets\": {\"jwt\": \"<completion-token>\"}, \"bindings\": [{\"type\": \"assets\", \"name\": \"ASSETS\"}]};type=application/json' \\\n    -F 'worker.mjs=export default { async fetch(request, env) { return env.ASSETS.fetch(request); } };type=application/javascript+module'\n  typescript\n  interface AssetFile {\n    path: string; // e.g., \"/index.html\"\n    content: string; // base64 encoded content\n    size: number; // file size in bytes\n  }\n\nasync function hashContent(base64Content: string): Promise<string> {\n    const binaryString = atob(base64Content);\n    const bytes = new Uint8Array(binaryString.length);\n    for (let i = 0; i < binaryString.length; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", bytes);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    // Use first 16 bytes (32 hex chars) per API requirement\n    return hashArray\n      .slice(0, 16)\n      .map((b) => b.toString(16).padStart(2, \"0\"))\n      .join(\"\");\n  }\n\nasync function deployWorkerWithAssets(\n    accountId: string,\n    namespace: string,\n    scriptName: string,\n    assets: AssetFile[],\n  ) {\n    const apiToken = process.env.API_TOKEN;\n    const baseUrl = `https://api.cloudflare.com/client/v4/accounts/${accountId}/workers`;\n\n// Step 1: Build manifest\n    const manifest: Record<string, { hash: string; size: number }> = {};\n    const hashToAsset = new Map<string, AssetFile>();\n\nfor (const asset of assets) {\n      const hash = await hashContent(asset.content);\n      const path = asset.path.startsWith(\"/\") ? asset.path : \"/\" + asset.path;\n      manifest[path] = { hash, size: asset.size };\n      hashToAsset.set(hash, asset);\n    }\n\n// Step 2: Create upload session\n    const sessionResponse = await fetch(\n      `${baseUrl}/dispatch/namespaces/${namespace}/scripts/${scriptName}/assets-upload-session`,\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${apiToken}`,\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ manifest }),\n      },\n    );\n\nconst sessionData = (await sessionResponse.json()) as {\n      success: boolean;\n      result?: { jwt: string; buckets?: string[][] };\n    };\n\nif (!sessionData.success || !sessionData.result) {\n      throw new Error(\"Failed to create upload session\");\n    }\n\nlet completionToken = sessionData.result.jwt;\n    const buckets = sessionData.result.buckets;\n\n// Step 3: Upload assets in buckets\n    if (buckets && buckets.length > 0) {\n      for (const bucket of buckets) {\n        const formData = new FormData();\n        for (const hash of bucket) {\n          const asset = hashToAsset.get(hash);\n          if (asset) {\n            formData.append(hash, asset.content);\n          }\n        }\n\nconst uploadResponse = await fetch(\n          `${baseUrl}/assets/upload?base64=true`,\n          {\n            method: \"POST\",\n            headers: { Authorization: `Bearer ${completionToken}` },\n            body: formData,\n          },\n        );\n\nconst uploadData = (await uploadResponse.json()) as {\n          success: boolean;\n          result?: { jwt?: string };\n        };\n\nif (uploadData.result?.jwt) {\n          completionToken = uploadData.result.jwt;\n        }\n      }\n    }\n\n// Step 4: Deploy worker with assets binding\n    const workerCode = `\n  export default {\n    async fetch(request, env) {\n      return env.ASSETS.fetch(request);\n    }\n  };`;\n\nconst deployFormData = new FormData();\n    const metadata = {\n      main_module: `${scriptName}.mjs`,\n      assets: { jwt: completionToken },\n      bindings: [{ type: \"assets\", name: \"ASSETS\" }],\n    };\n\ndeployFormData.append(\n      \"metadata\",\n      new Blob([JSON.stringify(metadata)], { type: \"application/json\" }),\n    );\n    deployFormData.append(\n      `${scriptName}.mjs`,\n      new Blob([workerCode], { type: \"application/javascript+module\" }),\n    );\n\nconst deployResponse = await fetch(\n      `${baseUrl}/dispatch/namespaces/${namespace}/scripts/${scriptName}`,\n      {\n        method: \"PUT\",\n        headers: { Authorization: `Bearer ${apiToken}` },\n        body: deployFormData,\n      },\n    );\n\nreturn deployResponse.json();\n  }\n\n// Usage\n  await deployWorkerWithAssets(\"your-account-id\", \"production\", \"customer-site\", [\n    {\n      path: \"/index.html\",\n      content: btoa(\"<html><body>Hello World</body></html>\"),\n      size: 37,\n    },\n    {\n      path: \"/styles.css\",\n      content: btoa(\"body { font-family: sans-serif; }\"),\n      size: 33,\n    },\n  ]);\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts\" \\\n    -H \"Authorization: Bearer $API_TOKEN\"\n  typescript\n  async function listWorkers(accountId: string, namespace: string) {\n    const response = await fetch(\n      `https://api.cloudflare.com/client/v4/accounts/${accountId}/workers/dispatch/namespaces/${namespace}/scripts`,\n      {\n        headers: {\n          Authorization: `Bearer ${process.env.API_TOKEN}`,\n        },\n      },\n    );\n\nconst data = (await response.json()) as {\n      success: boolean;\n      result: Array<{ id: string; tags?: string[] }>;\n    };\n\nreturn data.result;\n  }\n\n// Usage\n  const workers = await listWorkers(\"your-account-id\", \"production\");\n  console.log(workers);\n  bash\n  curl -X DELETE \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts?tags=customer-123:yes\" \\\n    -H \"Authorization: Bearer $API_TOKEN\"\n  typescript\n  async function deleteWorkersByTag(\n    accountId: string,\n    namespace: string,\n    tag: string,\n  ) {\n    const response = await fetch(\n      `https://api.cloudflare.com/client/v4/accounts/${accountId}/workers/dispatch/namespaces/${namespace}/scripts?tags=${tag}:yes`,\n      {\n        method: \"DELETE\",\n        headers: {\n          Authorization: `Bearer ${process.env.API_TOKEN}`,\n        },\n      },\n    );\n\nreturn response.json();\n  }\n\n// Usage: Delete all Workers for a customer\n  await deleteWorkersByTag(\"your-account-id\", \"production\", \"customer-123\");\n  bash\n  curl -X DELETE \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workers/dispatch/namespaces/$NAMESPACE_NAME/scripts/$SCRIPT_NAME\" \\\n    -H \"Authorization: Bearer $API_TOKEN\"\n  typescript\n  import Cloudflare from \"cloudflare\";\n\nconst client = new Cloudflare({\n    apiToken: process.env.API_TOKEN,\n  });\n\nasync function deleteWorker(\n    accountId: string,\n    namespace: string,\n    scriptName: string,\n  ) {\n    const result =\n      await client.workersForPlatforms.dispatch.namespaces.scripts.delete(\n        namespace,\n        scriptName,\n        { account_id: accountId },\n      );\n\n// Usage\n  await deleteWorker(\"your-account-id\", \"production\", \"customer-123\");\n  bash\ncurl -X PUT \"https://api.cloudflare.com/client/v4/accounts/{account_id}/workers/dispatch/namespaces/{namespace_name}\" \\\n  -H \"Authorization: Bearer {api_token}\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"{namespace_name}\",\n    \"trusted_workers\": true\n  }'\nmermaid\nflowchart TB\n    %% Accessibility\n    accTitle: Access session durations\n    accDescr: Flowchart describing the order of enforcement for Access sessions\n\n%% In with user traffic\n    start[\"User goes to Access application\"]\n    start--\"WARP authentication enabled\" -->warpsession[WARP session expired?]\n    start-- \"WARP authentication disabled\" --> policysession[Policy session expired?]\n\nwarpsession--\"Yes\"-->idp[Prompt to log in to IdP]\n\t\twarpsession--\"No\"-->accessgranted[Access granted]\n\npolicysession--\"Yes\"-->globalsession[Global session expired?]\n\t\tpolicysession--\"No\"-->accessgranted\n\nglobalsession--\"Yes\"-->idp\n\t\tglobalsession--\"No\"-->refreshtoken[Check identity against Access policies]\n\t\trefreshtoken-->accessgranted\n\t\tidp-->refreshtoken\njson\n{\n  \"mcpServers\": {\n    \"example-mcp-server\": {\n      \"command\": \"npx\",\n      \"args\": [\n        \"-y\",\n        \"mcp-remote@latest\",\n        \"https://<subdomain>.<domain>.com/mcp\"\n      ]\n    }\n  }\n}\nsh\nrm -rf ~/.mcp-auth\nmermaid\nflowchart LR\naccTitle: Link MCP servers and self-hosted applications in Access\n    subgraph SaaS[\"Access for SaaS <br> OIDC app\"]\n        mcp[\"MCP server <br> for internal apps\"]\n    end\n\nsubgraph \"Access self-hosted app\"\n        app1[Admin dashboard]\n    end\n\nsubgraph \"Access self-hosted app\"\n        app2[Company wiki]\n    end\n\nUser --> client[\"MCP client\"]\n    client --> mcp\n    mcp -- Access token --> app1\n\t\tmcp -- Access token --> app2\n\t\tidp[Identity provider] <--> SaaS\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps\" \\\n       --request GET \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n     json\n     {\n       \"id\": \"3537a672-e4d8-4d89-aab9-26cb622918a1\",\n       \"uid\": \"3537a672-e4d8-4d89-aab9-26cb622918a1\",\n       \"type\": \"saas\",\n       \"name\": \"mcp-server-cf-access\",\n       ...\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/policies\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"Allow MCP server\",\n         \"decision\": \"non_identity\",\n         \"include\": [\n             {\n                 \"linked_app_token\": {\n                     \"app_uid\": \"3537a672-e4d8-4d89-aab9-26cb622918a1\"\n                 }\n             }\n         ]\n       }'\n     json\n     {\n         \"created_at\": \"2025-08-06T20:06:23Z\",\n         \"decision\": \"non_identity\",\n         \"exclude\": [],\n         \"id\": \"a38ab4d4-336d-4f49-9e97-eff8550c13fa\",\n         \"include\": [\n           {\n             \"linked_app_token\": {\n               \"app_uid\": \"6cdc3892-f9f1-4813-a5ce-38c2753e1208\"\n             }\n           }\n         ],\n         \"name\": \"Allow MCP server\",\n         ...\n     }\n     txt\nAuthorization: Bearer ACCESS_TOKEN\nsh\n   npm create cloudflare@latest -- mcp-server-cf-access --template=cloudflare/ai/demos/remote-mcp-cf-access\n   sh\n   cd mcp-server-cf-access\n   sh\n   npx wrangler kv namespace create \"OAUTH_KV\"\n   sh\n   {\n     \"kv_namespaces\": [\n       {\n         \"binding\": \"OAUTH_KV\",\n         \"id\": \"<YOUR_KV_NAMESPACE_ID>\"\n       }\n     ]\n   }\n   jsonc\n   \"kv_namespaces\": [\n     {\n       \"binding\": \"OAUTH_KV\",\n       \"id\": \"<YOUR_KV_NAMESPACE_ID>\"\n     }\n   ],\n   sh\n   npx wrangler deploy\n   bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"MCP server\",\n         \"type\": \"saas\",\n         \"saas_app\": {\n             \"auth_type\": \"oidc\",\n             \"redirect_uris\": [\n                 \"https://mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev/callback\"\n             ],\n             \"grant_type\": [\n                 \"authorization_code\",\n                 \"refresh_tokens\"\n             ],\n             \"refresh_token_options\": {\n                 \"lifetime\": \"90d\"\n             }\n         },\n         \"policies\": [\n             \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\"\n         ],\n         \"allowed_idps\": []\n       }'\n     sh\n   wrangler secret put ACCESS_CLIENT_ID\n   wrangler secret put ACCESS_CLIENT_SECRET\n   wrangler secret put ACCESS_TOKEN_URL\n   wrangler secret put ACCESS_AUTHORIZATION_URL\n   wrangler secret put ACCESS_JWKS_URL\n   sh\n   openssl rand -hex 32\n   sh\n   wrangler secret put COOKIE_ENCRYPTION_KEY\n   sh\n   npm create cloudflare@latest my-worker -- --template https://github.com/cloudflare/workers-access-external-auth-example\n   sh\n   cd my-worker\n   sh\n   npx wrangler kv namespace create \"KV\"\n   txt\n     [[kv_namespaces]]\n      binding = \"KV\"\n      id = \"YOUR_KV_NAMESPACE_ID\"\n   jsonc\n  {\n    \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n    \"name\": \"my-worker\",\n    \"workers_dev\": true,\n    \"compatibility_date\": \"2024-08-06\",\n    \"main\": \"index.js\",\n    \"kv_namespaces\": [\n      {\n        \"binding\": \"KV\",\n        \"id\": \"YOUR_KV_NAMESPACE_ID\"\n      }\n    ],\n    \"vars\": {\n      \"TEAM_DOMAIN\": \"<TEAM_NAME>.cloudflareaccess.com\",\n      \"DEBUG\": false\n    }\n  }\n  toml\n  name = \"my-worker\"\n  workers_dev = true\n  compatibility_date = \"2024-08-06\"\n  main = \"index.js\"\n\n[[kv_namespaces]]\n  binding = \"KV\"\n  id = \"YOUR_KV_NAMESPACE_ID\"\n\n[vars]\n  TEAM_DOMAIN=\"<TEAM_NAME>.cloudflareaccess.com\"\n  DEBUG=false\n  sh\n   npx wrangler deploy\n   sh\n   cd my-worker\n   sh\n   npx wrangler deploy\n   sh\n   wrangler tail -f pretty\n   js\n   {\n   \"success\": true,\n   \"iat\": 1655409315,\n   \"exp\": 1655409375,\n   \"nonce\": \"9J2E9Xg6wYj8tlnA5MV4Zgp6t8rzmS0Q\"\n   }\n   bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/groups\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Lisbon-team\",\n      \"include\": [\n          {\n              \"geo\": {\n                  \"country_code\": \"PT\"\n              }\n          }\n      ],\n      \"exclude\": [],\n      \"require\": [\n          {\n              \"email_domain\": {\n                  \"domain\": \"team.com\"\n              }\n          }\n      ],\n      \"is_default\": false\n    }'\n  bash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps/$APP_ID/policies/$POLICY_ID/make_reusable\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\ntxt\n   -----BEGIN CERTIFICATE-----\n   <intermediate.pem>\n   -----END CERTIFICATE-----\n   -----BEGIN CERTIFICATE-----\n   <rootCA.pem>\n   -----END CERTIFICATE-----\n   sh\n   curl -sv https://auth.example.com\n   sh\n   curl -sv https://auth.example.com --cert example.pem --key key.pem\n   sh\n    openssl genrsa -aes256 -out rootCA.key 4096\n   sh\n   openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 3650 -out rootCA.pem\n   sh\n    openssl genrsa -aes256 -out intermediate.key 4096\n   sh\n   openssl req -new -sha256 -key intermediate.key -out intermediate.csr\n   txt\n   subjectKeyIdentifier = hash\n   authorityKeyIdentifier = keyid:always,issuer\n   basicConstraints = critical, CA:true\n   keyUsage = critical, cRLSign, keyCertSign\n   sh\n    openssl x509 -req -in intermediate.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out intermediate.pem -days 1825 -sha256 -extfile v3_intermediate_ca.ext\n   sh\n   cat intermediate.pem rootCA.pem > ca-chain.pem\n   sh\n    openssl genrsa -out client.key 2048\n   sh\n   openssl req -new -key client.key -out client.csr\n   sh\n    openssl x509 -req -in client.csr -CA intermediate.pem -CAkey intermediate.key -CAcreateserial -out client.pem -days 365 -sha256\n   sh\n   openssl verify -CAfile ca-chain.pem client.pem\n   sh\n   client.pem: OK\n   json\n     {\n       \"CN\": \"Access Testing CA\",\n       \"key\": {\n         \"algo\": \"rsa\",\n         \"size\": 4096\n       },\n       \"names\": [\n         {\n           \"C\": \"US\",\n           \"L\": \"Austin\",\n           \"O\": \"Access Testing\",\n           \"OU\": \"TX\",\n           \"ST\": \"Texas\"\n         }\n       ]\n     }\n     json\n     {\n       \"signing\": {\n         \"default\": {\n           \"expiry\": \"8760h\"\n         },\n         \"profiles\": {\n           \"server\": {\n             \"usages\": [\"signing\", \"key encipherment\", \"server auth\"],\n             \"expiry\": \"8760h\"\n           },\n           \"client\": {\n             \"usages\": [\"signing\", \"key encipherment\", \"client auth\"],\n             \"expiry\": \"8760h\"\n           }\n         }\n       }\n     }\n     sh\n   cfssl gencert -initca ca-csr.json | cfssljson -bare ca\n   sh\n   ls\n   sh\n   ca-config.json ca-csr.json ca-key.pem ca.csr  ca.pem\n   json\n   {\n     \"CN\": \"James Royal\",\n     \"hosts\": [\"\"],\n     \"key\": {\n       \"algo\": \"rsa\",\n       \"size\": 4096\n     },\n     \"names\": [\n       {\n         \"C\": \"US\",\n         \"L\": \"Austin\",\n         \"O\": \"Access\",\n         \"OU\": \"Access Admins\",\n         \"ST\": \"Texas\"\n       }\n     ]\n   }\n   sh\n   cfssl gencert -ca=ca.pem -ca-key=ca-key.pem  -config=ca-config.json -profile=client client-csr.json | cfssljson -bare client\n   sh\n   cfssl gencrl serials.txt ../mtls-test/ca.pem ../mtls-test/ca-key.pem | base64 -D > ca.crl\n   bash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/access/certificates/settings\" \\\n  --request PUT \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"settings\": [\n        {\n            \"hostname\": \"<HOSTNAME>\",\n            \"china_network\": false,\n            \"client_certificate_forwarding\": true\n        }\n    ]\n  }'\njs\nconst tlsHeaders = {\n    'X-CERT-ISSUER-DN': request.cf.tlsClientAuth.certIssuerDN,\n    'X-CERT-SUBJECT-DN': request.cf.tlsClientAuth.certSubjectDN,\n    'X-CERT-ISSUER-DN-L': request.cf.tlsClientAuth.certIssuerDNLegacy,\n    'X-CERT-SUBJECT-DN-L': request.cf.tlsClientAuth.certSubjectDNLegacy,\n    'X-CERT-SERIAL': request.cf.tlsClientAuth.certSerial,\n    'X-CERT-FINGER': request.cf.tlsClientAuth.certFingerprintSHA1,\n    'X-CERT-VERIFY': request.cf.tlsClientAuth.certVerify,\n    'X-CERT-NOTBE': request.cf.tlsClientAuth.certNotBefore,\n    'X-CERT-NOTAF': request.cf.tlsClientAuth.certNotAfter\n};\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/service_tokens\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"CI/CD token\",\n         \"duration\": \"8760h\"\n       }'\n     json\n     \"result\": {\n       \"client_id\": \"88bf3b6d86161464f6509f7219099e57.access\",\n       \"client_secret\": \"bdd31cbc4dec990953e39163fbbb194c93313ca9f0a6e420346af9d326b1d2a5\",\n       \"created_at\": \"2025-09-25T22:26:26Z\",\n       \"expires_at\": \"2026-09-25T22:26:26Z\",\n       \"id\": \"3537a672-e4d8-4d89-aab9-26cb622918a1\",\n       \"name\": \"CI/CD token\",\n       \"updated_at\": \"2025-09-25T22:26:26Z\",\n       \"duration\": \"8760h\",\n       \"client_secret_version\": 1\n     }\n     tf\n     resource \"cloudflare_zero_trust_access_service_token\" \"example_service_token\" {\n       account_id = var.cloudflare_account_id\n       name       = \"Example service token\"\n       duration  = \"8760h\"\n\nlifecycle {\n         create_before_destroy = true\n       }\n     }\n     tf\n        output \"example_service_token_client_id\" {\n          value     = cloudflare_zero_trust_access_service_token.example_service_token.client_id\n        }\n\noutput \"example_service_token_client_secret\" {\n          value     = cloudflare_zero_trust_access_service_token.example_service_token.client_secret\n          sensitive = true\n        }\n        sh\n        terraform apply\n        sh\n        terraform output -raw example_service_token_client_id\n        sh\n        terraform output -raw example_service_token_client_secret\n        tf\n       resource \"vault_generic_secret\" \"example_service_token\" {\n         path         = \"kv/cloudflare/example_service_token\"\n\ndata_json = jsonencode({\n           \"CLIENT_ID\"     = cloudflare_access_service_token.example_service_token.client_id\n           \"CLIENT_SECRET\" = cloudflare_access_service_token.example_service_token.client_secret\n         })\n       }\n     sh\ncurl -H \"CF-Access-Client-Id: <CLIENT_ID>\" -H \"CF-Access-Client-Secret: <CLIENT_SECRET>\" https://app.example.com\nbash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps/$APP_ID\" \\\n     --request GET \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n   bash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps/$APP_ID\" \\\n     --request PUT \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"domain\": \"app.example.com\",\n       \"type\": \"self_hosted\",\n       \"read_service_tokens_from_header\": \"Authorization\"\n     }'\n   sh\n   curl -H \"Authorization: {\\\"cf-access-client-id\\\": \\\"<CLIENT_ID>\\\", \\\"cf-access-client-secret\\\": \\\"<CLIENT_SECRET>\\\"}\" https://app.example.com\n   sh\ncurl -H \"cookie: CF_Authorization=<CF_AUTHORIZATION_COOKIE>\" https://app.example.com\nsh\ncurl -H \"cf-access-token: <CF_AUTHORIZATION_COOKIE>\" https://app.example.com\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block file types\",\n      \"description\": \"Block the upload or download of files based on their type\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.upload.file.types[*] in {\\\"docx\\\"}) and any(http.download.file.types[*] in {\\\"pdf\\\"})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  txt\nX-CFEmailSecurity-Disposition: [Value]\ntxt\nX-CFEmailSecurity-Disposition: UCE\ntxt\nX-CFEmailSecurity-Attribute: [Value]\nX-CFEmailSecurity-Attribute: [Value2]\ngraphql\n   query GatewaySampleQuery($accountTag: string!, $start: Time) {\n     viewer {\n       accounts(filter: { accountTag: $accountTag }) {\n         gatewayResolverQueriesAdaptiveGroups(\n           filter: { datetime_gt: $start }\n           limit: 10\n         ) {\n           count\n           dimensions {\n             queryNameReversed\n             resolverDecision\n           }\n         }\n       }\n     }\n   }\n   json\n   {\n     \"globalShortcut\": \"\",\n     \"mcpServers\": {\n       \"cloudflare-dex-analysis\": {\n         \"command\": \"npx\",\n         \"args\": [\"mcp-remote\", \"https://dex.mcp.cloudflare.com/mcp\"]\n       }\n     }\n   }\n   json\n   {\n     \"globalShortcut\": \"\",\n     \"mcpServers\": {\n       \"cloudflare-dex-analysis\": {\n         \"command\": \"npx\",\n         \"args\": [\"mcp-remote\", \"https://dex.mcp.cloudflare.com/mcp\"]\n       }\n     }\n   }\n   bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/logs/access_requests?limit=25&direction=desc&since=2020-07-01T05%3A20%3A00Z&until=2020-10-01T05%3A20%3A00Z\" \\\n    --request GET \\\n    --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n    --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\"\n  json\n  {\n    \"success\": true,\n    \"errors\": [],\n    \"messages\": [],\n    \"result\": [\n      {\n        \"user_email\": \"michelle@example.com\",\n        \"ip_address\": \"198.41.129.166\",\n        \"app_uid\": \"df7e2w5f-02b7-4d9d-af26-8d1988fca630\",\n        \"app_domain\": \"test.example.com/admin\",\n        \"action\": \"login\",\n        \"connection\": \"saml\",\n        \"allowed\": false,\n        \"created_at\": \"2014-01-01T05:20:00.12345Z\",\n        \"ray_id\": \"187d944c61940c77\"\n      }\n    ]\n  }\n  json\n{\n   \"ClientIP\": \"198.51.100.206\",\n   \"ClientRequestHost\": \"jira.widgetcorp.tech\",\n   \"ClientRequestMethod\": \"GET\",\n   \"ClientRequestURI\": \"/secure/Dashboard/jspa\",\n   \"ClientRequestUserAgent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36\",\n   \"EdgeEndTimestamp\": \"2019-11-10T09:51:07Z\",\n   \"EdgeResponseBytes\": 4600,\n   \"EdgeResponseStatus\": 200,\n   \"EdgeStartTimestamp\": \"2019-11-10T09:51:07Z\",\n   \"RayID\": \"5y1250bcjd621y99\",\n   \"RequestHeaders\":{\"cf-access-user\":\"srhea\"}\n},\n{\n   \"ClientIP\": \"198.51.100.206\",\n   \"ClientRequestHost\": \"jira.widgetcorp.tech\",\n   \"ClientRequestMethod\": \"GET\",\n   \"ClientRequestURI\": \"/browse/EXP-12\",\n   \"ClientRequestUserAgent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36\",\n   \"EdgeEndTimestamp\": \"2019-11-10T09:51:27Z\",\n   \"EdgeResponseBytes\": 4570,\n   \"EdgeResponseStatus\": 200,\n   \"EdgeStartTimestamp\": \"2019-11-10T09:51:27Z\",\n   \"RayID\": \"yzrCqUhRd6DVz72a\",\n   \"RequestHeaders\":{\"cf-access-user\":\"srhea\"}\n}\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logpush/jobs \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  ...\n  \"output_options\": {\n      \"field_names\": [\"ColoName\", \"Datetime\", \"Direction\", \"IPDestinationAddress\", \"IPDestinationSubnet\", \"IPProtocol\",\"IPSourceAddress\", \"IPSourceSubnet\", \"Outcome\", \"RuleID\", \"RulesetID\", \"SampleInterval\", \"Verdict\"],\n  },\n  \"filter\": \"{\\\"where\\\":{\\\"or\\\":[{\\\"and\\\":[{\\\"key\\\":\\\"MitigationSystem\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"magic-firewall\\\"},{\\\"key\\\":\\\"RulesetID\\\",\\\"operator\\\":\\\"!eq\\\",\\\"value\\\":\\\"\\\"},{\\\"key\\\":\\\"Outcome\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"pass\\\"},{\\\"key\\\":\\\"Verdict\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"drop\\\"}]}]}}\"\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logpush/jobs \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  ...\n  \"output_options\": {\n      \"field_names\": [\"ColoName\", \"Datetime\", \"Direction\", \"IPDestinationAddress\", \"IPDestinationSubnet\", \"IPProtocol\",\"IPSourceAddress\", \"IPSourceSubnet\", \"Outcome\", \"RuleID\", \"RulesetID\", \"SampleInterval\", \"Verdict\"],\n  },\n  \"filter\": \"{\\\"where\\\":{\\\"or\\\":[{\\\"and\\\":[{\\\"key\\\":\\\"MitigationSystem\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"magic-firewall\\\"},{\\\"key\\\":\\\"RulesetID\\\",\\\"operator\\\":\\\"!eq\\\",\\\"value\\\":\\\"\\\"},{\\\"or\\\":[{\\\"key\\\":\\\"Outcome\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"drop\\\"},{\\\"key\\\":\\\"Verdict\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"pass\\\"}]}]}]}}\"\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logpush/jobs \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  ...\n  \"output_options\": {\n      \"field_names\": [\"ColoName\", \"Datetime\", \"Direction\", \"IPDestinationAddress\", \"IPDestinationSubnet\", \"IPProtocol\",\"IPSourceAddress\", \"IPSourceSubnet\", \"Outcome\", \"RuleID\", \"RulesetID\", \"SampleInterval\", \"Verdict\"],\n  },\n  \"filter\": \"{\\\"where\\\":{\\\"and\\\":[{\\\"key\\\":\\\"MitigationSystem\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"magic-firewall\\\"},{\\\"key\\\":\\\"RulesetID\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"\\\"}]}}\"\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logpush/jobs \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  ...\n  \"output_options\": {\n      \"field_names\": [\"ColoName\", \"Datetime\", \"Direction\", \"IPDestinationAddress\", \"IPDestinationSubnet\", \"IPProtocol\",\"IPSourceAddress\", \"IPSourceSubnet\", \"Outcome\", \"RuleID\", \"RulesetID\", \"SampleInterval\", \"Verdict\"],\n  },\n  \"filter\": \"{\\\"where\\\":{\\\"and\\\":[{\\\"key\\\":\\\"MitigationSystem\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"magic-firewall\\\"},{\\\"key\\\":\\\"RulesetID\\\",\\\"operator\\\":\\\"!eq\\\",\\\"value\\\":\\\"\\\"}]}}\"\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/logpush/jobs \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  ...\n  \"output_options\": {\n      \"field_names\": [\"ColoName\", \"Datetime\", \"Direction\", \"IPDestinationAddress\", \"IPDestinationSubnet\", \"IPProtocol\",\"IPSourceAddress\", \"IPSourceSubnet\", \"Outcome\", \"RuleID\", \"RulesetID\", \"SampleInterval\", \"Verdict\"],\n  },\n  \"filter\": \"{\\\"where\\\":{\\\"key\\\":\\\"MitigationSystem\\\",\\\"operator\\\":\\\"eq\\\",\\\"value\\\":\\\"magic-firewall\\\"}}\"\n}'\njson\n{\n  \"ResourceRecords\": [\n    {\n      \"type\": \"5\",\n      \"data\": \"d3d3LmV4YW1wbGUuY29tAAABAAUAAABleGFtcGxlLmNvbQ==\"\n    },\n    {\n      \"type\": \"1\",\n      \"data\": \"ZXhhbXBsZS5jb20AAAEAAQAAAQIDBAUGBwgJ\"\n    }\n  ],\n  \"ResourceRecordsJSON\": \"[{\\\"name\\\":\\\"www.example.com\\\",\\\"type\\\":\\\"CNAME\\\",\\\"class\\\":\\\"IN\\\",\\\"ttl\\\":300,\\\"rdata\\\":\\\"example.com.\\\"},{\\\"name\\\":\\\"example.com\\\",\\\"type\\\":\\\"A\\\",\\\"class\\\":\\\"IN\\\",\\\"ttl\\\":300,\\\"rdata\\\":\\\"203.0.113.0\\\"}]\"\n}\ntxt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    bash\nSet-ADFSRelyingPartyTrust -TargetName \"Name of RPT Display Name\" -SamlResponseSignature \"MessageAndAssertion\"\ntxt\n   https://hostnameOfADFS/adfs/ls/\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/saml-metadata\n   json\n{\n  \"config\": {\n    \"issuer_url\": \"https://<your-team-name>.cloudflareaccess.com/\",\n    \"sso_target_url\": \"https://adfs.example.com/adfs/ls/\",\n    \"attributes\": [\"email\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_cert\": \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n  },\n  \"type\": \"saml\",\n  \"name\": \"adfs saml example\"\n}\ntxt\nhttps://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\njson\n{\n  \"config\": {\n    \"issuer_url\": \"https://portal.sso.eu-central-1.amazonaws.com/saml/assertion/b2yJrC4kjy3ZAS0a2SeDJj74ebEAxozPfiURId0aQsal3\",\n    \"sso_target_url\": \"https://portal.sso.eu-central-1.amazonaws.com/saml/assertion/b2yJrC4kjy3ZAS0a2SeDJj74ebEAxozPfiURId0aQsal3\",\n    \"attributes\": [\"email\"],\n    \"email_attribute_name\": \"email\",\n    \"sign_request\": true,\n    \"idp_public_certs\": [\n      \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n    ]\n  },\n  \"type\": \"saml\",\n  \"name\": \"AWS IAM SAML example\"\n}\ntxt\n       https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n       json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"auth_url\": \"https://<your user pool domain>/oauth2/authorize\",\n    \"token_url\": \"https://<your user pool domain>/oauth2/token\",\n    \"certs_url\": \"https://cognito-idp.<region>.amazonaws.com/<your user pool ID>/.well-known/jwks.json\",\n    \"scopes\": [\"openid\", \"email\", \"profile\"],\n    \"claims\": [\"sub\", \"cognito:username\", \"name\", \"cognito:groups\"]\n  },\n  \"type\": \"oidc\",\n  \"name\": \"Amazon Cognito example\"\n}\ntxt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"centrify_account\": \"https://abc123.my.centrify.com/\",\n    \"centrify_app_id\": \"exampleapp\"\n  },\n  \"type\": \"centrify\",\n  \"name\": \"my example idp\"\n}\ntxt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/saml-metadata\n   json\n{\n  \"config\": {\n    \"issuer_url\": \"https://abc123.my.centrify.com/baaa2117-0ec0-4d76-84cc-abccb551a123\",\n    \"sso_target_url\": \"https://abc123.my.centrify.com/applogin/appKey/baaa2117-0ec0-4d76-84cc-abccb551a123/customerId/abc123\",\n    \"attributes\": [\"email\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_cert\": \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n  },\n  \"type\": \"saml\",\n  \"name\": \"centrify saml example\"\n}\njson\n   add authentication samlIdPProfile samlProf_CloudflareAccess \\\n       -samlIdPCertName SAML_Signing \\\n       -assertionConsumerServiceURL \"https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\" \\\n       -samlIssuerName \"https://idp.yourdomain.com/saml/login\" \\\n       -rejectUnsignedRequests OFF \\\n       -NameIDFormat emailAddress \\\n       -Attribute1 email \\\n       -Attribute1Expr \"AAA.USER.ATTRIBUTE(\\\"email\\\")\" \\\n       -Attribute1Format Basic \\\n       -serviceProviderID \"https://idp.yourdomain.com/saml/login\"\n\nadd authentication samlIdPPolicy samlPol_CloudflareAccess -rule true -action samlProf_CloudflareAccess\n   bind authentication vserver nsidp -policy samlPol_CloudflareAccess\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/identity_providers\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Entra ID example\",\n      \"type\": \"azureAD\",\n      \"config\": {\n          \"client_id\": \"<your client id>\",\n          \"client_secret\": \"<your client secret>\",\n          \"directory_id\": \"<your azure directory uuid>\",\n          \"support_groups\": true\n      }\n    }'\n  tf\n     resource \"cloudflare_zero_trust_access_identity_provider\" \"microsoft_entra_id\" {\n       account_id = var.cloudflare_account_id\n       name       = \"Entra ID example\"\n       type       = \"azureAD\"\n       config      = {\n         client_id                  = var.entra_id_client_id\n         client_secret              = var.entra_id_client_secret\n         directory_id               = var.entra_id_directory_id\n         support_groups             = true\n         }\n     }\n     bash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/identity_providers/$IDENTITY_PROVIDER_ID\" \\\n     --request GET \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n   bash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/identity_providers/$IDENTITY_PROVIDER_ID\" \\\n     --request PUT \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"id\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n       \"type\": \"azureAD\",\n       \"uid\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n       \"name\": \"Entra ID\",\n       \"version\": \"31e74e9b4f033e16b604552091a72295\",\n       \"config\": {\n           \"azure_cloud\": \"default\",\n           \"client_id\": \"<CLIENT_ID>\",\n           \"conditional_access_enabled\": false,\n           \"directory_id\": \"<AZURE_DIRECTORY_ID>\",\n           \"redirect_url\": \"https://<TEAM_NAME>.cloudflareaccess.com/cdn-cgi/access/callback\",\n           \"prompt\": \"login\",\n           \"support_groups\": true\n       },\n       \"scim_config\": {\n           \"enabled\": true,\n           \"user_deprovision\": true,\n           \"seat_deprovision\": false,\n           \"group_member_deprovision\": false,\n           \"identity_update_behavior\": \"automatic\"\n       },\n       \"scim_base_url\": \"https://<TEAM_NAME>.cloudflareaccess.com/populations/f174e90a-fafe-4643-bbbc-4a0ed4fc8415/scim/v2\"\n     }'\n   txt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\"\n  },\n  \"type\": \"facebook\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/identity_providers\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Generic OIDC example\",\n      \"type\": \"oidc\",\n      \"config\": {\n          \"client_id\": \"<your client id>\",\n          \"client_secret\": \"<your client secret>\",\n          \"auth_url\": \"https://accounts.google.com/o/oauth2/auth\",\n          \"token_url\": \"https://accounts.google.com/o/oauth2/token\",\n          \"certs_url\": \"https://www.googleapis.com/oauth2/v3/certs\",\n          \"pkce_enabled\": false,\n          \"email_claim_name\": \"email\",\n          \"claims\": [\n              \"employeeID\",\n              \"groups\"\n          ],\n          \"scopes\": [\n              \"openid\",\n              \"email\",\n              \"profile\"\n          ]\n      }\n    }'\n  tf\n     resource \"cloudflare_zero_trust_access_identity_provider\" \"generic_oidc_example\" {\n       account_id = var.cloudflare_account_id\n       name       = \"Generic OIDC example\"\n       type       = \"oidc\"\n       config      = {\n         client_id = \"<your client id>\"\n         client_secret = \"<your client secret>\"\n         auth_url = \"https://accounts.google.com/o/oauth2/auth\"\n         token_url = \"https://accounts.google.com/o/oauth2/token\"\n         certs_url = \"https://www.googleapis.com/oauth2/v3/certs\"\n         pkce_enabled = false\n         email_claim_name = \"email\"\n         claims = [\"employeeID\", \"groups\"]\n         scopes = [\"openid\", \"email\", \"profile\"]\n       }\n     }\n     json\n     \"oidc_fields\": {\n       \"oid\": \"54eb1ed2-7150-44e6-bbe4-ead24c132fd4\"\n     },\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   tf\n     resource \"cloudflare_zero_trust_access_identity_provider\" \"generic_saml_example\" {\n       account_id = var.cloudflare_account_id\n       name       = \"Generic SAML example\"\n       type       = \"saml\"\n       config      = {\n         sso_target_url = \"https://example.com/1234/sso/saml\"\n         issuer_url = \"https://example.com/1234\"\n         idp_public_certs = [\"-----BEGIN CERTIFICATE-----\\nXXXXX\\n-----END CERTIFICATE-----\"]\n         sign_request = false\n         email_attribute_name = \"email\"\n         attributes = [\"employeeID\", \"groups\"]\n       }\n     }\n     txt\n   https://<your-team-name>.cloudflareaccess.com\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\"\n  },\n  \"type\": \"github\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\"\n  },\n  \"type\": \"google\",\n  \"name\": \"my example idp\"\n}\ntxt\n      https://<your-team-name>.cloudflareaccess.com/\n      txt\n      https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n      json\n{\n  \"config\": {\n    \"issuer_url\": \"jumpcloud\",\n    \"sso_target_url\": \"https://sso.myexample.jumpcloud.com/saml2/cloudflareaccess\",\n    \"attributes\": [\"email\", \"name\", \"username\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_cert\": \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n  },\n  \"type\": \"saml\",\n  \"name\": \"jumpcloud saml example\"\n}\ntxt\n    https://<your-team-name>.cloudflareaccess.com\n    txt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"apps_domain\": \"mycompany.com\"\n  },\n  \"type\": \"google-apps\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   txt\n    https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n    json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\"\n  },\n  \"type\": \"linkedin\",\n  \"name\": \"my example idp\"\n}\ntxt\n   <your-team-name>\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"okta_account\": \"https://dev-abc123.oktapreview.com\"\n  },\n  \"type\": \"okta\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"issuer_url\": \"http://www.okta.com/exkbhqj29iGxT7GwT0h7\",\n    \"sso_target_url\": \"https://dev-abc123.oktapreview.com/app/myapp/exkbhqj29iGxT7GwT0h7/sso/saml\",\n    \"attributes\": [\"email\", \"group\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_certs\": [\n      \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n    ]\n  },\n  \"type\": \"saml\",\n  \"name\": \"okta saml example\"\n}\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/identity_providers\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"One-time PIN login\",\n      \"type\": \"onetimepin\",\n      \"config\": {}\n    }'\n  tf\n     resource \"cloudflare_zero_trust_access_identity_provider\" \"onetimepin_login\" {\n       account_id = var.cloudflare_account_id\n       name       = \"One-time PIN login\"\n       type       = \"onetimepin\"\n       config      = {}\n     }\n     txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"onelogin_account\": \"https://mycompany.onelogin.com\"\n  },\n  \"type\": \"onelogin\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/saml-metadata\n   json\n{\n  \"config\": {\n    \"issuer_url\": \"https://app.onelogin.com/saml/metadata/1b84ee45-d4fa-4373-8853-abz438942123\",\n    \"sso_target_url\": \"https://sandbox.onelogin.com/trust/saml2/http-post/sso/123456\",\n    \"attributes\": [\"email\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_cert\": \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n  },\n  \"type\": \"saml\",\n  \"name\": \"onelogin saml example\"\n}\ntxt\nhttps://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\njson\n{\n  \"config\": {\n    \"issuer_url\": \"https://example.cloudflareaccess.com/cdn-cgi/access/callback\",\n    \"sso_target_url\": \"https://sso.connect.pingidentity.com/sso/idp/SSO.saml2?idpid=aebe6668-32fe-4a87-8c2b-avcd3599a123\",\n    \"attributes\": [\"PingOne.AuthenticatingAuthority\", \"PingOne.idpid\"],\n    \"email_attribute_name\": \"\",\n    \"sign_request\": false,\n    \"idp_public_cert\": \"MIIDpDCCAoygAwIBAgIGAV2ka+55MA0GCSqGSIb3DQEBCwUAMIGSMQswCQYDVQQGEwJVUzETMBEG\\nA1UEC.....GF/Q2/MHadws97cZg\\nuTnQyuOqPuHbnN83d/2l1NSYKCbHt24o\"\n  },\n  \"type\": \"saml\",\n  \"name\": \"ping saml example\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\",\n    \"ping_env_id\": \"<your ping environment id>\"\n  },\n  \"type\": \"ping\",\n  \"name\": \"my example idp\"\n}\ntxt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/saml-metadata\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/public-cert\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/public-cert\n   txt\n   https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback\n   json\n{\n  \"config\": {\n    \"client_id\": \"<your client id>\",\n    \"client_secret\": \"<your client secret>\"\n  },\n  \"type\": \"yandex\",\n  \"name\": \"my example idp\"\n}\nmermaid\nsequenceDiagram\n    participant WARP\n\t\tparticipant Cloudflare Access\n    participant External API\n    WARP->>Cloudflare Access: Client ID and Secret\n\t\tCloudflare Access->>External API: Application token\n\t\tWARP->>External API: JSON with user and device identity\n    External API-->>WARP: JSON with 0-100 result\njson\n{\n  \"devices\": {\n    [\n      {\n        \"device_id\": \"9ece5fab-7398-488a-a575-e25a9a3dec07\",\n        \"email\": \"jdoe@mycompany.com\",\n        \"serial_number\": \"jdR44P3d\",\n        \"mac_address\": \"74:1d:3e:23:e0:fe\",\n        \"virtual_ipv4\": \"100.96.0.10\",\n        \"hostname\": \"string\",\n      },\n      {...},\n      {...}\n    ]\n  }\n}\njson\n{\n  \"result\": {\n    \"9ece5fab-7398-488a-a575-e25a9a3dec07\": {\n      \"s2s_id\": \"\",\n      \"score\": 10\n    },\n    \"device_id2\": {...},\n    \"device_id3\": {...}\n  }\n}\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/proxy_endpoints\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"kind\": \"identity\",\n         \"name\": \"any_name\"\n       }'\n     json\n     {\n       \"result\": {\n         \"kind\": \"identity\",\n         \"id\": \"d969d7bf-ec28-4291-9af0-86825f472c21\",\n         \"name\": \"Identity Proxy Endpoint\",\n         \"created_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"updated_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"subdomain\": \"3ele0ss56t\"\n       },\n       \"success\": true,\n       \"errors\": [],\n       \"messages\": []\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/apps\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"domain\": \"<SUBDOMAIN>.proxy.cloudflare-gateway.com\",\n         \"name\": \"Proxy Endpoint App\",\n         \"session_duration\": \"12h\",\n         \"type\": \"proxy_endpoint\",\n         \"policies\": [\n             {\n                 \"id\": \"<ACCESS_POLICY_ID>\"\n             }\n         ]\n       }'\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/proxy_endpoints\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"any_name\",\n         \"ips\": [\n             \"<PUBLIC_IP>\",\n             \"<PUBLIC_IP2>\",\n             \"<PUBLIC_IP3>\"\n         ]\n       }'\n     json\n     {\n       \"result\": {\n         \"id\": \"d969d7bf-ec28-4291-9af0-86825f472c21\",\n         \"name\": \"test\",\n         \"created_at\": \"2022-03-02T10:57:18.094789Z\",\n         \"updated_at\": \"2022-03-02T10:57:18.094789Z\",\n         \"ips\": [\"90.90.241.229/8\"],\n         \"subdomain\": \"3ele0ss56t\"\n       },\n       \"success\": true,\n       \"errors\": [],\n       \"messages\": []\n     }\n     txt\n     <SUBDOMAIN>.proxy.cloudflare-gateway.com\n     txt\nhttps://pac.cloudflare-gateway.com/<account-id>/<slug>\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/proxy_endpoints\" \\\n       --request GET \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n     json\n     {\n       \"success\": true,\n       \"result\": {\n         \"id\": \"ed35569b41ce4d1facfe683550f54086\",\n         \"created_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"ips\": [\"192.0.2.1/32\"],\n         \"name\": \"DevOps team\",\n         \"subdomain\": \"oli3n9zkz5.proxy.cloudflare-gateway.com\",\n         \"updated_at\": \"2014-01-01T05:20:00.12345Z\"\n       }\n     }\n     bash\n     dig A example.cloudflare-gateway.com +short\n     txt\n     162.159.36.5\n     162.159.36.20\n     bash\n     dig AAAA example.cloudflare-gateway.com +short\n     txt\n     2606:4700:54::a29f:2407\n     2606:4700:5c::a29f:2e07\n     powershell\n     Resolve-DnsName -Name example.cloudflare-gateway.com -Type A\n     txt\n     Name                                           Type   TTL   Section    IPAddress\n     ----                                           ----   ---   -------    ---------\n     example.cloudflare-gateway.com                 A      300   Answer     162.159.36.5\n     example.cloudflare-gateway.com                 A      300   Answer     162.159.36.20\n     powershell\n     Resolve-DnsName -Name example.cloudflare-gateway.com -Type AAAA\n     txt\n     Name                                           Type   TTL   Section    IPAddress\n     ----                                           ----   ---   -------    ---------\n     example.cloudflare-gateway.com                 AAAA   300   Answer     2606:4700:5c::a29f:2e07\n     example.cloudflare-gateway.com                 AAAA   300   Answer     2606:4700:54::a29f:2407\n     txt\nhttps://<your-team-name>.cloudflareaccess.com/browser/<URL>\nhtml\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Redirecting website to a remote browser</title>\n    <script>\n      window.location.href =\n        \"https://<your-team-name>.cloudflareaccess.com/browser/<URL>}\";\n    </script>\n    <noscript>\n      <meta\n        http-equiv=\"refresh\"\n        content=\"0; url=https://<your-team-name>.cloudflareaccess.com/browser/<URL>\"\n      />\n    </noscript>\n  </head>\n  <body>\n    <p>\n      This website is being redirected to a remote browser. Select\n      <a href=\"https://<your-team-name>.cloudflareaccess.com/browser/<URL>\"\n        >here</a\n      >\n      if you are not automatically redirected.\n    </p>\n  </body>\n</html>\nhtml\n   <!doctype html>\n   <html>\n     <body>\n       <h1>Access denied.</h1>\n\n<p>To obtain access, contact your IT administrator.</p>\n     </body>\n   </html>\n   txt\ncloudflare.com/redirect-path?querystring=Y\ntf\n     resource \"cloudflare_zero_trust_gateway_settings\" \"team_name\" {\n       account_id = var.cloudflare_account_id\n       settings = {\n         block_page = {\n           enabled = true //do not use the default Gateway block page\n           mode = \"customized_block_page\" //use a custom block page\n           name = \"Cloudflare\"\n           logo_path = \"https://logos.com/a.png\"\n           header_text = \"--header--\"\n           footer_text = \"--footer--\"\n           mailto_address = \"admin@example.com\"\n           mailto_subject = \"Blocked Request\"\n           background_color = \"#ffffff\"\n           suppress_footer = false\n         }\n       }\n     }\n     bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/certificates\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/certificates/$CERTIFICATE_ID/activate\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/configuration\" \\\n    --request PUT \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"settings\": {\n          \"certificate\": {\n              \"id\": \"{certificate_id}\",\n              \"in_use\": true\n          }\n      }\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow corporate domains\",\n      \"description\": \"Allow any internal corporate domains added to a list\",\n      \"precedence\": 0,\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.domains[*] in $<LIST_UUID>)\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-DNS-SecurityCategories-Blocklist\",\n      \"description\": \"Block security categories based on Cloudflare'\\''s threat intelligence\",\n      \"precedence\": 20,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.security_category[*] in {68 178 80 83 176 175 117 131 134 151 153})\",\n      \"identity\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"block_security_threats\" {\n    account_id  = var.cloudflare_account_id\n    name        = \"All-DNS-SecurityCategories-Blocklist\"\n    description = \"Block security categories based on Cloudflare's threat intelligence\"\n    precedence  = 20\n    enabled     = true\n    action      = \"block\"\n    filters     = [\"dns\"]\n    traffic     = \"any(dns.security_category[*] in {68 178 80 83 176 175 117 131 134 151 153})\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-DNS-ContentCategories-Blocklist\",\n      \"description\": \"Block common content categories that may pose a risk\",\n      \"precedence\": 30,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.content_category[*] in {17 85 87 102 157 135 138 180 162 32 169 177 128 15 115 119 124 141 161})\",\n      \"identity\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"block_content_categories\" {\n    account_id  = var.cloudflare_account_id\n    name        = \"All-DNS-ContentCategories-Blocklist\"\n    description = \"Block common content categories that may pose a risk\"\n    enabled     = true\n    action      = \"block\"\n    filters     = [\"dns\"]\n    traffic     = \"any(dns.content_category[*] in {17 85 87 102 157 135 138 180 162 32 169 177 128 15 115 119 124 141 161})\"\n    identity    = \"\"\n  }\n  json\n{\n  \"categories\": [2, 67, 125, 133]\n}\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-DNS-Bock-Category-Matches-In-Request\",\n      \"description\": \"Block all category matches in the request EDNS context\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"dns.categories_in_request_context_matches\",\n      \"identity\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"block_content_categories\" {\n    account_id  = var.cloudflare_account_id\n    name        = \"All-DNS-Bock-Category-Matches-In-Request\"\n    description = \"Block all category matches in the request EDNS context\"\n    enabled     = true\n    action      = \"block\"\n    filters     = [\"dns\"]\n    traffic     = \"dns.categories_in_request_context_matches\"\n    identity    = \"\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-DNS-Application-Blocklist\",\n      \"description\": \"Block access to unauthorized AI applications\",\n      \"precedence\": 40,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(app.type.ids[*] in {25})\",\n      \"identity\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"block_unauthorized_apps\" {\n    account_id  = var.cloudflare_account_id\n    name        = \"All-DNS-Application-Blocklist\"\n    description = \"Block access to unauthorized AI applications\"\n    enabled     = true\n    action      = \"block\"\n    filters     = [\"dns\"]\n    traffic     = \"any(app.type.ids[*] in {25})\"\n    identity    = \"\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block banned countries\",\n      \"description\": \"Block access to banned countries\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.dst.geo.country[*] in {\\\"AF\\\" \\\"BY\\\" \\\"CD\\\" \\\"CU\\\" \\\"IR\\\" \\\"IQ\\\" \\\"KP\\\" \\\"MM\\\" \\\"RU\\\" \\\"SD\\\" \\\"SY\\\" \\\"UA\\\" \\\"ZW\\\"})\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block top-level domains\",\n      \"description\": \"Block top-level domains that are frequently used for malicious practices\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.domains[*] matches \\\"[.](cn|ru)$\\\") or any(dns.domains[*] matches \\\"[.](rest|hair|top|live|cfd|boats|beauty|mom|skin|okinawa)$\\\") or any(dns.domains[*] matches \\\"[.](zip|mobi)$\\\")\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block phishing attacks\",\n      \"description\": \"Block attempts to phish specific domains targeting your organization\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"not(any(dns.domains[*] in $<LIST_UUID>)) and any(dns.domains[*] matches \\\".*okta.*\\\\|.*cloudflare.*\\\\|.*mfa.*\\\\|.sso.*\\\")\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block online tracking\",\n      \"description\": \"Block domains used for tracking at an OS level\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.domains[*] in $<LIST_UUID>)\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block malicious IPs\",\n      \"description\": \"Block specific IP addresses that are known to be malicious or pose a threat to your organization\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.resolved_ips[*] in $<LIST_UUID>)\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Turn on CIPA filter\",\n      \"description\": \"Block access to unwanted or harmful online content for children\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.content_category[*] in {182})\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Hide explicit search results\",\n      \"description\": \"Force SafeSearch on search engines to filter explicit or offensive content\",\n      \"enabled\": true,\n      \"action\": \"safesearch\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.content_category[*] in {145})\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Check user identity\",\n      \"description\": \"Filter traffic based on a user identity group name\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(app.ids[*] in {606})\",\n      \"identity\": \"any(identity.groups.name[*] in {\\\"Contractors\\\"})\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow social media for Marketing\",\n      \"description\": \"Allow access to social media sites for users in the Marketing group\",\n      \"precedence\": 1,\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.content_category[*] in {149})\",\n      \"identity\": \"any(identity.groups.name[*] in {\\\"Marketing\\\"})\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block social media\",\n      \"description\": \"Block social media for all other users\",\n      \"precedence\": 2,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"any(dns.content_category[*] in {149})\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Force IPv4\",\n      \"description\": \"Force users to connect with IPv4 by blocking IPv6 resolution\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"dns.query_rtype == \\\"AAAA\\\"\",\n      \"identity\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Force IPv6\",\n      \"description\": \"Force users to connect with IPv6 by blocking IPv4 resolution\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"dns\"\n      ],\n      \"traffic\": \"dns.query_rtype == \\\"A\\\"\",\n      \"identity\": \"\"\n    }'\n  sh\n   dig example.com\n   sh\n   ; <<>> DiG 9.10.6 <<>> example.com\n   ;; global options: +cmd\n   ;; Got answer:\n   ;; ->>HEADER<<- opcode: QUERY, status: REFUSED, id: 6503\n   ;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n   ;example.com.                   IN      A\n\n;; Query time: 46 msec\n   ;; SERVER: 172.64.36.1#53(172.64.36.1)\n   ;; WHEN: Tue Mar 10 20:22:18 CDT 2020\n   ;; MSG SIZE  rcvd: 29\n   sh\n   dig example.com\n   sh\n   ; <<>> DiG 9.10.6 <<>> example.com\n   ;; global options: +cmd\n   ;; Got answer:\n   ;; ->>HEADER<<- opcode: QUERY, status: NOERROR id: 14531\n   ;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n   ; EDNS: version: 0, flags:; udp: 1452\n   ;; QUESTION SECTION:\n   ;example.com.                   IN      A\n\n;;ANSWER SECTION:\n   example.com.            60      IN      A                  162.159.36.12\n   example.com.            60      IN      A                  162.159.46.12\n\n;; Query time: 53 msec\n   ;; SERVER: 172.64.36.1#53(172.64.36.1)\n   ;; WHEN: Tue Mar 10 20:19:52 CDT 2020\n   ;; MSG SIZE  rcvd: 83\n   txt\n  <NAME_OF_CATEGORY>.testcategory.com\n  sh\n   curl 'https://<DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query?type=TXT&name=o-o.myaddr.google.com' -H 'Accept: application/dns-json' | json_pp\n   json\n   {\n     \"AD\": false,\n     \"Answer\": [\n       {\n         \"TTL\": 60,\n         \"data\": \"\\\"108.162.218.211\\\"\",\n         \"name\": \"o-o.myaddr.google.com\",\n         \"type\": 16\n       },\n       {\n         \"TTL\": 60,\n         \"data\": \"\\\"edns0-client-subnet 136.62.0.0/24\\\"\",\n         \"name\": \"o-o.myaddr.google.com\",\n         \"type\": 16\n       }\n     ],\n     \"CD\": false,\n     \"Question\": [\n       {\n         \"name\": \"o-o.myaddr.google.com\",\n         \"type\": 16\n       }\n     ],\n     \"RA\": true,\n     \"RD\": true,\n     \"Status\": 0,\n     \"TC\": false\n   }\n   sh\n   curl ifconfig.me\n   sh\n   136.62.12.156%\n   bash\nipconfig /flushdns\nsh\nsudo killall -HUP mDNSResponder\nsudo killall mDNSResponderHelper\nsudo dscacheutil -flushcache\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"action\": \"block\",\n      \"name\": \"Block gambling sites on weekends\",\n      \"traffic\": \"any(dns.content_category[*] in {\\\"Gambling\\\"})\",\n      \"schedule\": {\n          \"sat\": \"08:00-17:00\",\n          \"sun\": \"08:00-17:00\",\n          \"timezone\": \"Europe/Paris\"\n      }\n    }'\n  bash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"office-no-facebook-policy\",\n    \"action\": \"block\",\n    \"traffic\": \"dns.fqdn == \\\"facebook.com\\\"\",\n    \"enabled\": true,\n    \"schedule\": {\n        \"time_zone\": \"America/Chicago\",\n        \"mon\": \"08:00-12:30,13:30-17:00\",\n        \"tue\": \"08:00-12:30,13:30-17:00\",\n        \"wed\": \"08:00-12:30,13:30-17:00\",\n        \"thu\": \"08:00-12:30,13:30-17:00\",\n        \"fri\": \"08:00-12:30,13:30-17:00\"\n    }\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"clock-in-policy\",\n    \"action\": \"block\",\n    \"traffic\": \"dns.fqdn == \\\"clockin.com\\\"\",\n    \"enabled\": true,\n    \"schedule\": {\n        \"sat\": \"00:00-24:00\",\n        \"sun\": \"00:00-24:00\"\n    }\n  }'\nmermaid\n    flowchart LR\n      subgraph aws[\"AWS VPC\"]\n\t\t\t\tcloudflared[\"cloudflared\"]\n      end\n\t\t\tsubgraph cloudflare[Cloudflare]\n\t\t\t  gateway[\"Gateway\"]\n\t\t\tend\n\t\t\tsubgraph internet[Internet]\n\t\t\t\tresolver[1.1.1.1]\n\t\t\t\tapp[Application]\n\t\t\tend\n      warp[\"WARP\n\t\t\t  clients\"]--\"app.bank.com\"-->gateway--\"Network traffic\"-->cloudflared\n\t\t\tgateway<-.DNS lookup.->resolver\n\t\t\taws--AWS egress IP -->app\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/configuration\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"settings\": {\n          \"host_selector\": {\n              \"enabled\": true\n          }\n      }\n    }'\n  xml\n   <array>\n     <dict>\n       <key>doh_in_tunnel</key>\n       <true/>\n     </dict>\n   </array>\n   bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block sites by hostname\",\n      \"description\": \"Block all subdomains that use a specific hostname\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"http.request.host matches \\\".*example.com\\\"\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block sites by URL\",\n      \"description\": \"Block specific parts of a site without blocking the hostname\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"http.request.uri matches \\\"/r/gaming\\\"\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-HTTP-ContentCategories-Blocklist\",\n      \"description\": \"Block access to questionable content and potential security risks\",\n      \"precedence\": 40,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.uri.content_category[*] in {17 85 87 102 157 135 138 180 162 32 169 177 128 15 115 119 124 141 161 2 67 125 133 99})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"block_unauthorized_apps\" {\n    account_id     = var.cloudflare_account_id\n    name           = \"All-HTTP-ContentCategories-Blocklist\"\n    description    = \"Block access to questionable content and potential security risks\"\n    precedence     = 40\n    enabled        = true\n    action         = \"block\"\n    filters        = [\"http\"]\n    traffic        = \"any(http.request.uri.content_category[*] in {17 85 87 102 157 135 138 180 162 32 169 177 128 15 115 119 124 141 161 2 67 125 133 99})\"\n    identity       = \"\"\n    device_posture = \"\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-HTTP-Application-Blocklist\",\n      \"description\": \"Limit access to shadow IT by blocking web-based tools and applications\",\n      \"precedence\": 60,\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.type.ids[*] in {25})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"all_http_application_blocklist\" {\n    account_id     = var.cloudflare_account_id\n    name           = \"All-HTTP-Application-Blocklist\"\n    description    = \"Limit access to shadow IT by blocking web-based tools and applications\"\n    precedence     = 60\n    enabled        = true\n    action         = \"block\"\n    filters        = [\"http\"]\n    traffic        = \"any(app.type.ids[*] in {25})\"\n    identity       = \"\"\n    device_posture = \"\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Check user identity\",\n      \"description\": \"Block access to Salesforce by temporary employees and contractors\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.ids[] in {606})\",\n      \"identity\": \"any(identity.groups.name[] in {\\\"Contractors\\\"})\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Bypass incompatible applications\",\n      \"description\": \"Skip TLS decryption for applications that are incompatible with Gateway\",\n      \"enabled\": true,\n      \"action\": \"off\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.type.ids[*] in {16})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Require OS version\",\n      \"description\": \"Perform an OS version check for minimum version\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"\",\n      \"identity\": \"\",\n      \"device_posture\": \"any(device_posture.checks.passed[*] in {\\\"<POSTURE_CHECK_UUID>\\\"})\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Check for specific file\",\n      \"description\": \"Ensure users have a specific file on their device regardless of operating system\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"\",\n      \"identity\": \"\",\n      \"device_posture\": \"any(device_posture.checks.passed[] in {\\\"<POSTURE_CHECK_1_UUID>\\\"}) or any(device_posture.checks.passed[] in {\\\"<POSTURE_CHECK_2_UUID>\\\"})\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Bypass internal site inspection\",\n      \"description\": \"Bypass TLS decryption for internal sites with self-signed certificates\",\n      \"enabled\": true,\n      \"action\": \"off\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.domains[*] in {\\\"internal.example.com\\\"})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block file types\",\n      \"description\": \"Block the upload or download of files based on their type\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.upload.file.types[*] in {\\\"docx\\\"}) and any(http.download.file.types[*] in {\\\"pdf\\\"})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate unreviewed or in review application status\",\n      \"description\": \"Isolate Shadow IT applications that have not been reviewed or are in review in the Application Library\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.statuses[*] == \\\"unreviewed\\\") or any(app.statuses[*] == \\\"in review\\\")\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block unapproved application status\",\n      \"description\": \"Block Shadow IT applications that have been marked as unapproved in the Application Library\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.statuses[*] == \\\"unapproved\\\")\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block Google Drive downloads\",\n      \"description\": \"Block file downloads from Google Drive\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.ids[] in {554}) and http.request.uri.path_and_query matches \\\".(e=download|export).*\\\"\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block Google Drive uploads\",\n      \"description\": \"Block file uploads to Google Drive\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.ids[] in {554}) and http.upload.mime matches \\\".\\\" and not(http.request.host == \\\"drivefrontend-pa.clients6.google.com\\\")\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block Gmail downloads\",\n      \"description\": \"Block file downloads from Gmail\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"http.request.host == \\\"mail-attachment.googleusercontent.com\\\" and http.request.uri.path_and_query matches \\\"/attachment/u/0\\\"\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block Google Translate for websites\",\n      \"description\": \"Block use of Google Translate to translate entire webpages\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.domains[*] matches \\\"^(.+\\\\.)?translate\\\\.goog$\\\")\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Filter WebSocket\",\n      \"description\": \"Filter WebSocket traffic with HTTP response code 101\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"http.response.status_code == 101\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  mermaid\nflowchart TD\n    A([\"User starts file download\"]) --> B[\"File sent to AV scanner\"]\n    B --> C[\"Malicious file detected?\"]\n    C -- Yes --> D[\"Download blocked\"]\n    C -- No --> G[\"File sent to sandbox\"]\n    G --> n1[\"First time file downloaded?\"]\n    K[\"Malicious activity detected?\"] -- Yes --> N[\"Download blocked\"]\n    K -- No --> n3[\"Download allowed\"]\n    n2[\"Interstitial page displayed for user during scan\"] --> n4[\"File activity monitored\"]\n    n1 -- Yes --> n2\n    n4 --> K\n    n1 -- No --> K\n\nB@{ shape: subproc}\n    C@{ shape: hex}\n    D@{ shape: terminal}\n    n1@{ shape: hex}\n    K@{ shape: hex}\n    N@{ shape: terminal}\n    n3@{ shape: terminal}\n    n2@{ shape: display}\n    n4@{ shape: rect}\n    style D stroke:#D50000\n    style N stroke:#D50000\n    style n3 stroke:#00C853\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block ChatGPT uploads\",\n      \"description\": \"Block file uploads to ChatGPT while allowing other usage\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.ids[*] == 1199) and any(app_control.controls[*] in {1653})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  tf\n     resource \"cloudflare_zero_trust_gateway_settings\" \"team_name\" {\n       account_id = var.cloudflare_account_id\n       settings = {\n         tls_decrypt = {\n           enabled = true\n         }\n       }\n     }\n     tf\n     resource \"cloudflare_zero_trust_gateway_settings\" \"team_name\" {\n       account_id = var.cloudflare_account_id\n       settings = {\n         tls_decrypt = {\n           enabled = true\n         }\n       }\n     }\n     mermaid\nflowchart LR\n %% Accessibility\n accTitle: How Gateway routes FedRAMP compliant traffic with Regional Services\n accDescr: Flowchart describing how WARP with Gateway routes traffic to egress from a FedRAMP compliant data center when used with Regional Services in the United States.\n\n%% Flowchart\n subgraph s1[\"Non-FedRAMP data center\"]\n        n2[\"WARP TLS encryption terminated\"]\n  end\n subgraph s2[\"FedRAMP data center\"]\n        n3[\"Gateway TLS encryption (FIPS) terminated\"]\n  end\n subgraph s3[\"Private internal network\"]\n        n5[\"FedRAMP compliant cloudflared\"]\n        n6([\"Private server\"])\n  end\n    n1([\"User near non-FedRAMP compliant data center\"]) -- Gateway TLS connection wrapped with WARP TLS (MASQUE) --> n2\n    n2 -- Gateway TLS connection --> n3\n    n3 <-- FIPS tunnel --> n5\n    n5 --> n6\n\nn5@{ shape: rect}\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"Block security threats\",\n         \"description\": \"Block all default Cloudflare DNS security categories\",\n         \"precedence\": 0,\n         \"enabled\": true,\n         \"action\": \"block\",\n         \"filters\": [\n             \"dns\"\n         ],\n         \"traffic\": \"any(dns.security_category[*] in {68 178 80 83 176 175 117 131 134 151 153})\",\n         \"identity\": \"\"\n       }'\n     sh\n     {\n        \"success\": true,\n        \"errors\": [],\n        \"messages\": []\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"Do not inspect applications\",\n         \"description\": \"Bypass TLS decryption for unsupported applications\",\n         \"precedence\": 0,\n         \"enabled\": true,\n         \"action\": \"off\",\n         \"filters\": [\n             \"http\"\n         ],\n         \"traffic\": \"any(app.type.ids[*] in {16})\",\n         \"identity\": \"\",\n         \"device_posture\": \"\"\n       }'\n     sh\n     {\n        \"success\": true,\n        \"errors\": [],\n        \"messages\": []\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"Block known risks\",\n         \"description\": \"Block all default Cloudflare HTTP security categories\",\n         \"precedence\": 0,\n         \"enabled\": true,\n         \"action\": \"block\",\n         \"filters\": [\n             \"http\"\n         ],\n         \"traffic\": \"any(http.request.uri.security_category[*] in {68 178 80 83 176 175 117 131 134 151 153})\",\n         \"identity\": \"\",\n         \"device_posture\": \"\"\n       }'\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n       --json '{\n         \"name\": \"Enforce device posture\",\n         \"description\": \"Ensure only devices in Zero Trust organization can connect to application\",\n         \"precedence\": 0,\n         \"enabled\": true,\n         \"action\": \"block\",\n         \"filters\": [\n             \"l4\"\n         ],\n         \"traffic\": \"any(net.sni.domains[*] == \\\"internalapp.com\\\")\",\n         \"identity\": \"\",\n         \"device_posture\": \"not(any(device_posture.checks.passed[*] in {\\\"LIST_UUID\\\"}))\"\n       }'\n     sh\n  {\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block unauthorized applications\",\n      \"description\": \"Block access to unauthorized AI applications\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"any(app.type.ids[*] in {25})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Check user identity\",\n      \"description\": \"Block access to Salesforce by temporary employees and contractors\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"any(app.ids[*] in {606})\",\n      \"identity\": \"any(identity.groups.name[*] in {\\\"Contractors\\\"})\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"All-NET-ApplicationAccess-Allow\",\n      \"description\": \"Ensure access to the application comes from authorized WARP clients\",\n      \"precedence\": 70,\n      \"enabled\": false,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"any(net.sni.domains[*] == \\\"internalapp.com\\\")\",\n      \"device_posture\": \"not(any(device_posture.checks.passed[*] in {\\\"<DEVICE_SERIAL_NUMBERS_LIST_UUID>\\\"}))\"\n    }'\n  tf\n  resource \"cloudflare_zero_trust_gateway_policy\" \"all_net_applicationaccess_allow\" {\n    account_id  = var.cloudflare_account_id\n    name        = \"All-NET-ApplicationAccess-Allow\"\n    description = \"Ensure access to the application comes from authorized WARP clients\"\n    precedence  = 70\n    enabled     = false\n    action      = \"block\"\n    filters     = [\"l4\"]\n    traffic     = \"any(net.sni.domains[*] == \\\"internalapp.com\\\")\"\n    posture      =  \"not(any(device_posture.checks.passed[*] in {\\\"${\"$\"}${cloudflare_zero_trust_list.allowed_devices_sn_list.id}\\\"}))\"\n  }\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow HTTP and HTTPS traffic\",\n      \"description\": \"Restrict traffic to HTTP and HTTPS traffic\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.detected_protocol == \\\"tls\\\" and net.dst.port in {80 443}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block all other traffic\",\n      \"description\": \"Block all other traffic that is not HTTP or HTTPS\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.protocol in {\\\"tcp\\\" \\\"udp\\\"}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow on inspect all ports\",\n      \"description\": \"Filter HTTPS traffic when using inspect all ports\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.detected_protocol == \\\"tls\\\" or net.detected_protocol == \\\"http\\\"\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow proxy endpoint traffic from specific source IPs\",\n      \"description\": \"Allow traffic from proxy endpoint users with specific source IPs to reach private network\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.proxy_endpoint.ids[*] in {\\\"<PROXY_ENDPOINT_ID>\\\"} and net.src.ip in {203.0.113.0/24} and net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block all other proxy endpoint traffic\",\n      \"description\": \"Block any other proxy endpoint traffic from accessing the private network\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.proxy_endpoint.ids[*] in {\\\"<PROXY_ENDPOINT_ID>\\\"} and net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow authorized proxy endpoint traffic from specific source IPs\",\n      \"description\": \"Allow traffic from authorization proxy endpoint users with specific source IPs to reach private network\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.proxy_endpoint.ids[*] in {\\\"<PROXY_ENDPOINT_ID>\\\"} and net.src.ip in {203.0.113.0/24} and net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block all other authorized proxy endpoint traffic\",\n      \"description\": \"Block any other authorization proxy endpoint traffic from accessing the private network\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.proxy_endpoint.ids[*] in {\\\"<PROXY_ENDPOINT_ID>\\\"} and net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Allow company employees\",\n      \"description\": \"Allow any users with an organization email to reach the application\",\n      \"enabled\": true,\n      \"action\": \"allow\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"identity.email matches \\\".*@example.com\\\"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Block everyone else\",\n      \"description\": \"Block any other users from accessing the application\",\n      \"enabled\": true,\n      \"action\": \"block\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.dst.ip in {10.0.0.0/8}\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Override example.com with 1.1.1.1\",\n      \"description\": \"Override a site'\\''s IP address with another IP\",\n      \"enabled\": true,\n      \"action\": \"l4_override\",\n      \"filters\": [\n          \"l4\"\n      ],\n      \"traffic\": \"net.dst.ip in {203.0.113.17} and net.dst.port == 80\",\n      \"identity\": \"\",\n      \"device_posture\": \"\",\n      \"rule_settings\": {\n          \"l4override\": {\n              \"ip\": \"1.1.1.1\",\n              \"port\": 80\n          },\n          \"override_host\": \"\",\n          \"override_ips\": null\n      }\n    }'\n  sh\nsudo adduser jdoe\ntxt\nMatch user johndoe\n  AuthorizedPrincipalsCommand /bin/echo 'jdoe'\n  AuthorizedPrincipalsCommandUser nobody\nsh\nssh johndoe@server\ntxt\nMatch user vmuser\n  AuthorizedPrincipalsFile /etc/ssh/vmusers-list.txt\ntxt\njdoe\nbwayne\nrobin\ntxt\nMatch user vmuser\n  AuthorizedPrincipalsCommand /bin/bash -c \"echo '%t %k' | ssh-keygen -L -f - | grep -A1 Principals\"\n  AuthorizedPrincipalsCommandUser nobody\ntxt\nAuthorizedPrincipalsCommand /bin/bash -c \"echo '%t %k' | ssh-keygen -L -f - | grep -A1 Principals\"\nAuthorizedPrincipalsCommandUser nobody\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/gateway_ca\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/gateway_ca\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\nsh\n   cd /etc/ssh\n   sh\n   vim ca.pub\n   txt\n   ecdsa-sha2-nistp256 <redacted> open-ssh-ca@cloudflareaccess.org\n   bash\n   :w !sudo tee %\n   :q!\n   sh\n    sudo vim /etc/ssh/sshd_config\n   txt\n   PubkeyAuthentication yes\n   TrustedUserCAKeys /etc/ssh/ca.pub\n   sh\ncat /etc/ssh/sshd_config\nsh\n  sudo systemctl reload ssh\n  sh\n  sudo systemctl reload sshd\n  sh\nssh <username>@<hostname>\nsh\nssh-keygen -R <targetIP or hostname>\nsh\n   ./ssh-log-cli generate-key-pair -o sshkey\n   ls\n   sh\n   README.md    ssh-log-cli    sshkey    sshkey.pub\n   sh\n   ./ssh-log-cli decrypt -i sshlog -k sshkey\n   bash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"Example ruleset\",\n  \"kind\": \"root\",\n  \"phase\": \"magic_transit\",\n  \"description\": \"Example ruleset description\",\n  \"rules\": [\n    {\n      \"action\": \"skip\",\n      \"action_parameters\": { \"ruleset\": \"current\" },\n      \"expression\": \"tcp.dstport in { 8080 } \",\n      \"description\": \"Allow port 8080\"\n    },\n    {\n      \"action\": \"block\",\n      \"expression\": \"tcp.dstport in { 1..65535 }\",\n      \"description\": \"Block all TCP ports\"\n    }\n  ]\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"Example ruleset\",\n  \"kind\": \"root\",\n  \"phase\": \"magic_transit\",\n  \"description\": \"Example ruleset description\",\n  \"rules\": [\n    {\n      \"action\": \"block\",\n      \"expression\": \"ip.src.country == \\\"BR\\\"\",\n      \"description\": \"Block traffic from Brazil\"\n    }\n  ]\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"Example ruleset\",\n  \"kind\": \"root\",\n  \"phase\": \"magic_transit\",\n  \"description\": \"Example ruleset description\",\n  \"rules\": [\n    {\n      \"action\": \"block\",\n      \"expression\": \"ip.src in $cf.anonymizer\",\n      \"description\": \"Block traffic from anonymizer proxies\"\n    }\n  ]\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"execute ruleset\",\n  \"description\": \"Ruleset containing execute rules\",\n  \"kind\": \"root\",\n  \"phase\": \"magic_transit_managed\",\n  \"rules\": [\n    {\n      \"expression\": \"true\",\n      \"action\": \"execute\",\n      \"description\": \"Enable one rule \",\n      \"action_parameters\": {\n        \"id\": \"<MANAGED_RULESET_ID>\",\n        \"version\": \"latest\",\n        \"overrides\": {\n          \"rules\": [\n            {\n              \"id\": \"<MANAGED_RULE_ID>\",\n              \"enabled\": true,\n              \"action\": \"log\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}'\nbash\ncurl --request PATCH \\\nhttps://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/{root_kind_ruleset}/rules/{root_kind_rule} \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"expression\": \"true\",\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"<MANAGED_RULESET_ID>\",\n    \"version\": \"latest\",\n    \"overrides\": {\n      \"rules\": [\n        {\n          \"id\": \"<MANAGED_RULE_ID>\",\n          \"enabled\": true\n        }\n      ],\n      \"categories\": [\n        {\n          \"category\": \"simple\",\n          \"enabled\": true,\n          \"action\": \"log\"\n        }\n      ]\n    }\n  }\n}'\nbash\ncurl --request PATCH \\\nhttps://api.cloudflare.com/client/v4/accounts/{account_id}{account_id}/rulesets/{root_kind_ruleset}/rules/{root_kind_rule} \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"expression\": \"true\",\n  \"action\": \"execute\",\n  \"action_parameters\": {\n    \"id\": \"<MANAGED_RULESET_ID>\",\n    \"version\": \"latest\",\n    \"overrides\": {\n      \"enabled\": true\n    }\n  }\n}'\ntxt\nip.src == 192.0.2.0\ntxt\nip.src == 192.0.2.1 && (tcp.flags.push || tcp.flags.reset)\ntxt\nip.src == 192.0.2.0/24  # bad\nip.src in { 192.0.2.0/24 }  # good\ntxt\n(tcp.dstport == 1000 || tcp.dstport == 1001) && (tcp.dstport == 1002 || tcp.dstport == 1003) && (tcp.dstport == 1004 || tcp.dstport == 1005) && (tcp.dstport == 1006 || tcp.dstport == 1007) && (tcp.dstport == 1008 || tcp.dstport == 1009) && (tcp.dstport == 1010 || tcp.dstport == 1011) && (tcp.dstport == 1012 || tcp.dstport == 1013) && (tcp.dstport == 1014 || tcp.dstport == 1015) && (tcp.dstport == 1016 || tcp.dstport == 1017)\ntxt\nhttps://api.cloudflare.com/client/v4\ntxt\nhttps://api.cloudflare.com/client/v4\nmermaid\n    flowchart TD\n      accTitle: Random prefix attacks diagram\n      A[End user query to <code>example.com</code>] --\"1)\"--> B[<code>1.1.1.1 resolver</code>]\n      B --\"2)\"--> C[<code>com.</code> TLD NS]\n      C --\"3)\" <code>NXDOMAIN error</code>--> B\n      B --\"4)\" <code>NXDOMAIN error</code>--> A\n      D[Authoritative NS]\nmermaid\n    flowchart TD\n      accTitle: Random prefix attacks diagram\n      A[End user query to <code>random.example.com</code>] --\"1)\"--> B[<code>1.1.1.1 resolver</code>]\n      B -- \"2)\" --> C[<code>com.</code> TLD NS]\n      C -- \"3)\" Query Authoritative NS --> B\n      B -- \"4)\" --> D[Authoritative NS]\n      D --\"5)\" <code>NXDOMAIN error</code>--> B\n      B --\"6)\" <code>NXDOMAIN error</code>--> A\nbash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/dns_firewall/$DNS_FIREWALL_ID\" \\\n     --request PATCH \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"attack_mitigation\": {\n           \"enabled\": true,\n           \"only_when_upstream_unhealthy\": true\n       }\n     }'\n   bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dnssec\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"status\": \"active\",\n      \"dnssec_multi_signer\": true\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"type\": \"DNSKEY\",\n      \"name\": \"<ZONE_NAME>\",\n      \"data\": {\n          \"flags\": 256,\n          \"protocol\": 3,\n          \"algorithm\": 13,\n          \"public_key\": \"<PUBLIC_KEY>\"\n      },\n      \"ttl\": 3600\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"type\": \"NS\",\n      \"name\": \"<ZONE_NAME>\",\n      \"content\": \"<NS_DOMAIN>\",\n      \"ttl\": 86400\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_settings\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"multi_provider\": true\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dnssec\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"status\": \"active\",\n      \"dnssec_multi_signer\": true\n    }'\n  bash\ncurl \"https://api.cloudflare.com/client/v4/zones/{zone_id}/dnssec/zsk\" \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\"\nsh\n$ dig <ZONE_NAME> dnskey @<CLOUDFLARE_NAMESERVER> +noall +answer | grep 256\nmermaid\nflowchart LR\naccTitle: Internal DNS zones and CNAME flattening example\naccDescr: Diagram exemplifying Internal DNS zones and containing CNAME and A records\n\nsubgraph Internal DNS\nsubgraph Zone 700 - net\nA[\"@ A 192.0.2.10\"]\nB[\"xyz CNAME def.example.local\"]\nend\nsubgraph View 111 - London\nsubgraph Zone 600 - example.local\nX[\"@ A 192.0.2.1\"]\nY[\"abc CNAME xyz.net\"]\nU[\"def TXT 15192-51\"]\nZ[\"def A 192.0.2.9\"]\nend\nend\nend\nbash\n  curl \"https://api.cloudflare.com/client/v4/zones/8a904aeb565c42cfa207d98f6edea2f3/dns_settings\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"internal_dns\": {\n          \"reference_zone_id\": \"8e64c6fb4b514f3faf64de81efc11e51\"\n      }\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"account\": {\n          \"id\": \"<ACCOUNT_ID>\"\n      },\n      \"name\": \"<ZONE_NAME>\",\n      \"type\": \"internal\"\n    }'\n  bash\n{\n    \"deletes\": [\n        {\n            \"id\": \"2bff0ebc4df64beaa44b0dca93e37a28\"\n        },\n        {\n            \"id\": \"31d1d6e79ce04b8d93cbc5a13401d728\"\n        }\n    ],\n    \"patches\": [\n        {\n            \"id\": \"62276440f783445380480484648c1017\",\n            \"content\": \"192.0.2.46\"\n        },\n        {\n            \"id\": \"c942d948dc2343b9b97aed78479c9fb9\",\n            \"name\": \"update.example.com\",\n            \"proxied\": true\n        }\n    ],\n    \"puts\": [\n        {\n            \"id\": \"a50364543094428abde0f14061d42b0e\",\n            \"content\": \"192.0.2.50\",\n            \"name\": \"change.example.com\",\n            \"type\": \"A\",\n            \"ttl:\": 1\n        },\n        {\n            \"id\": \"3bce0920f19d43949498bd067b05dfa9\",\n            \"content\": \"192.0.2.45\",\n            \"name\": \"no-change.example.com\",\n            \"type\": \"A\",\n            \"proxied\": false,\n            \"ttl:\": 3000\n        }\n    ],\n    \"posts\": [\n        {\n            \"name\": \"@\",\n            \"type\": \"A\",\n            \"content\": \"192.0.2.41\",\n            \"proxied\": false,\n            \"ttl\": 3000\n        },\n        {\n            \"name\": \"a.example.com\",\n            \"type\": \"A\",\n            \"content\": \"192.0.2.42\",\n            \"proxied\": true\n        }\n    ]\n}\nbash\n   curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"type\": \"A\",\n       \"name\": \"mail.example.com\",\n       \"content\": \"192.0.2.1\",\n       \"ttl\": 3600,\n       \"proxied\": false\n     }'\n   json\n   {\n     \"result\": {\n       \"id\": \"<ID>\",\n       \"zone_id\": \"<ZONE_ID>\",\n       \"zone_name\": \"example.com\",\n       \"name\": \"mail.example.com\",\n       \"type\": \"A\",\n       \"content\": \"192.0.2.1\",\n       \"proxiable\": true,\n       \"proxied\": false,\n       \"ttl\": 3600,\n       \"locked\": false,\n       \"meta\": {\n         \"source\": \"primary\"\n       },\n       \"comment\": null,\n       \"tags\": [],\n       \"created_on\": \"2023-01-17T20:37:05.368097Z\",\n       \"modified_on\": \"2023-01-17T20:37:05.368097Z\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }\n   bash\n   curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n     --request POST \\\n     --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n     --json '{\n       \"type\": \"MX\",\n       \"name\": \"example.com\",\n       \"content\": \"mail.example.com\",\n       \"priority\": 5,\n       \"ttl\": 3600\n     }'\n   json\n   {\n     \"result\": {\n       \"id\": \"<ID>\",\n       \"zone_id\": \"<ZONE_ID>\",\n       \"zone_name\": \"example.com\",\n       \"name\": \"example.com\",\n       \"type\": \"MX\",\n       \"content\": \"mail.example.com\",\n       \"priority\": 5,\n       \"proxiable\": false,\n       \"proxied\": false,\n       \"ttl\": 3600,\n       \"locked\": false,\n       \"meta\": {\n         \"source\": \"primary\"\n       },\n       \"comment\": null,\n       \"tags\": [],\n       \"created_on\": \"2023-01-17T20:54:23.660869Z\",\n       \"modified_on\": \"2023-01-17T20:54:23.660869Z\"\n     },\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": []\n   }\n   bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records/import\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --form \"file=@your_formatted_file.txt\"\n  bash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records/export\" \\\n    --request GET \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n  txt\n; Only tags\na.example.com.  60  IN  A   1.1.1.1 ;   cf_tags=awesome\nb.example.com.  60  IN  A   1.1.1.1 ;   cf_tags=tag1,tag2:value2,tag3:\"value,with,commas\",tag4:\"value with \\\"escaped\\\" quotation marks\"\n\n; Only a comment\nc.example.com.  60  IN  A   1.1.1.1 ; just a comment without tags\nd.example.com.  60  IN  A   1.1.1.1 ; this comment contains cf_tags= as text cf_tags=\n\n; Comments and tags\ne.example.com.  60  IN  A   1.1.1.1 ; simple example cf_tags=important,ticket:THIS-12345\nf.example.com.  60  IN  A   1.1.1.1 ; this is the comment cf_tags=tag1:value1,tag2:value2,tag-without-value,another-tag-without-value,tag-with-quoted-value:\"because of the comma, quotes are needed\"\n\n; Neither attribute\ng.example.com.  60  IN  A   1.1.1.1\ntxt\n;; CNAME Records\na.cloudflaredocs.com.  1  IN  CNAME  example.com. ; cf_tags=test:1,cf-flatten-cname\nb.cloudflaredocs.com.  1  IN  CNAME  example.com. ; cf_tags=cf-proxied:false\nc.cloudflaredocs.com.  1  IN  CNAME  example.com. ; cf_tags=tag-without-value,cf-proxied:true\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"type\": \"A\",\n    \"name\": \"www.example.com\",\n    \"content\": \"192.0.2.1\",\n    \"ttl\": 3600,\n    \"proxied\": false\n  }'\njson\n{\n  \"result\": {\n    \"id\": \"<ID>\",\n    \"zone_id\": \"<ZONE_ID>\",\n    \"zone_name\": \"example.com\",\n    \"name\": \"www.example.com\",\n    \"type\": \"A\",\n    \"content\": \"192.0.2.1\",\n    \"proxiable\": true,\n    \"proxied\": false,\n    \"ttl\": 1,\n    \"locked\": false,\n    \"meta\": {\n      \"source\": \"primary\"\n    },\n    \"comment\": null,\n    \"tags\": [],\n    \"created_on\": \"2023-01-17T20:37:05.368097Z\",\n    \"modified_on\": \"2023-01-17T20:37:05.368097Z\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"type\": \"CNAME\",\n    \"name\": \"www.example.com\",\n    \"content\": \"www.another-example.com\",\n    \"ttl\": 3600,\n    \"proxied\": false\n  }'\njson\n{\n  \"result\": {\n    \"id\": \"<ID>\",\n    \"zone_id\": \"<ZONE_ID>\",\n    \"zone_name\": \"example.com\",\n    \"name\": \"www.example.com\",\n    \"type\": \"A\",\n    \"content\": \"www.another-example.com\",\n    \"proxiable\": true,\n    \"proxied\": false,\n    \"ttl\": 1,\n    \"locked\": false,\n    \"meta\": {\n      \"source\": \"primary\"\n    },\n    \"comment\": null,\n    \"tags\": [],\n    \"created_on\": \"2023-01-17T20:37:05.368097Z\",\n    \"modified_on\": \"2023-01-17T20:37:05.368097Z\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"type\": \"SRV\",\n    \"name\": \"_xmpp._tcp.example.com\",\n    \"data\": {\n        \"priority\": 10,\n        \"weight\": 5,\n        \"port\": 5223,\n        \"target\": \"server.example.com\"\n    }\n  }'\njson\n{\n  \"result\": {\n    \"id\": \"<ID>\",\n    \"zone_id\": \"<ZONE_ID>\",\n    \"zone_name\": \"example.com\",\n    \"name\": \"_xmpp._tcp.example.com\",\n    \"type\": \"SRV\",\n    \"content\": \"5 5223 server.example.com\",\n    \"priority\": 10,\n    \"proxiable\": false,\n    \"proxied\": false,\n    \"ttl\": 1,\n    \"locked\": false,\n    \"data\": {\n      \"port\": 5223,\n      \"priority\": 10,\n      \"target\": \"server.example.com\",\n      \"weight\": 5\n    },\n    \"meta\": {\n      \"auto_added\": false,\n      \"managed_by_apps\": false,\n      \"managed_by_argo_tunnel\": false,\n      \"source\": \"primary\"\n    },\n    \"comment\": null,\n    \"tags\": [],\n    \"created_on\": \"2022-11-08T15:57:39.585977Z\",\n    \"modified_on\": \"2022-11-08T15:57:39.585977Z\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\ntxt\nfiles  CNAME  files.example.com.s3.amazonaws.com\nplaintext\n<value>._domainkey.example.com CNAME <hostname>.<service provider domain>\ntxt\nNS records with that host already exist. (Code:81056)\ntxt\n  \"zone_defaults\": {\n    \"nameservers\": {\n      \"type\": \"custom.account\"\n    }\n  }\n  txt\n     \"nameservers\": {\n       \"type\": \"custom.tenant\"\n     }\n   txt\n\"zone_defaults\": {\n  \"nameservers\": {\n    \"type\": \"custom.tenant\"\n  }\n}\nbash\ncurl https://api.cloudflare.com/client/v4/tenants/{tenant_id}/custom_ns \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"ns_name\": \"<NS_NAME>\",\n  \"ns_set\": <SET>\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/tenants/{tenant_id}/custom_ns \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\"\ntxt\n  \"vanity_name_servers\": [\"ns1.example.com\",\"ns2.example.com\"]\n  txt\n  \"vanity_name_servers\": []\n  bash\n     curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records/export\" \\\n       --request GET \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n     txt\n   www.example.com CNAME www.example.com.cdn.cloudflare.net\n   bash",
  "code_samples": [
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nFor additional guidance on using Terraform with Cloudflare, refer to [Terraform](https://developers.cloudflare.com/terraform/).\n\n</page>\n\n<page>\n---\ntitle: Set Browser Cache TTL  Cloudflare Cache (CDN) docs\ndescription: Specify a time for a visitors Browser Cache TTL to accelerate the\n  page load for repeat visitors to your website. To configure cache duration\n  within Cloudflares data centers, refer to Edge Cache TTL.\nlastUpdated: 2025-09-16T11:22:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/edge-browser-cache-ttl/set-browser-ttl/\n  md: https://developers.cloudflare.com/cache/how-to/edge-browser-cache-ttl/set-browser-ttl/index.md\n---\n\nSpecify a time for a visitors Browser Cache TTL to accelerate the page load for repeat visitors to your website. To configure cache duration within Cloudflares data centers, refer to [Edge Cache TTL](https://developers.cloudflare.com/cache/how-to/cache-rules/settings/#edge-ttl).\n\nBy default, Cloudflare honors the cache expiration set in your `Expires` and `Cache-Control` headers. Cloudflare overrides any `Cache-Control` or `Expires` headers with values set via the **Browser Cache TTL** option under **Caching** on your dashboard if:\n\n* The value of the `Cache-Control` header from the origin web server is less than the **Browser Cache TTL** setting. This means that **Browser cache TTL** value needs to be higher than origin `max-age`.\n* The origin web server does not send a `Cache-Control` or an `Expires` header.\n\nUnless specifically set in a [Cache Rule](https://developers.cloudflare.com/cache/how-to/cache-rules/), Cloudflare does not override or insert `Cache-Control` headers if you set **Browser Cache TTL** to **Respect Existing Headers**.\n\nNevertheless, the value you set via Cache Rule will be ignored if `Cache-Control: max-age` is higher. In other words, you can override to make browsers cache longer than Cloudflare's edge but not less.\n\n## Set Browser Cache TTL\n\nNote\n\nIf you modify cached assets, the new asset is not displayed to repeat visitors before the Browser Cache TTL duration. [Purging Cloudflares cache](https://developers.cloudflare.com/cache/how-to/purge-cache/) does not affect assets cached in a visitors browser.\n\n1. In the Cloudflare dashboard, go to the **Caching** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Browser Cache TTL**, select the desired cache expiration time from the drop-down menu.\n\nThe **Respect Existing Headers** option tells Cloudflare to honor the settings in the `Cache-Control` headers from your origin web server.\n\n</page>\n\n<page>\n---\ntitle: Purge by single-file  Cloudflare Cache (CDN) docs\ndescription: With purge by single-file, cached resources are instantly removed\n  from the stored assets in your Content Delivery Network (CDN) across all data\n  centers. New requests for the purged asset receive the latest version from\n  your origin web server and add it back to your CDN cache within the specific\n  Cloudflare data center that served the request.\nlastUpdated: 2025-10-06T13:41:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-single-file/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-single-file/index.md\n---\n\nWith purge by single-file, cached resources are instantly removed from the stored assets in your Content Delivery Network (CDN) across all data centers. New requests for the purged asset receive the latest version from your origin web server and add it back to your CDN cache within the specific Cloudflare data center that served the request.\n\nFor information on single-file purge rate limits, refer to the [limits](https://developers.cloudflare.com/cache/how-to/purge-cache/#single-file-purge-limits) section.\n\nA single-file purge performed through your Cloudflare dashboard does not clear objects that contain any of the following:\n\n* [Custom cache keys](https://developers.cloudflare.com/cache/how-to/cache-keys/)\n\n* [Origin header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Origin)\n\n* Any of these request headers:\n\n  * `X-Forwarded-Host`\n  * `X-Host`\n  * `X-Forwarded-Scheme`\n  * `X-Original-URL`\n  * `X-Rewrite-URL`\n  * `Forwarded`\n\nYou can purge objects with these characteristics using an API call to ([purge files by URL](https://developers.cloudflare.com/api/resources/cache/methods/purge/)). In the data/header section of the API call, you must include all headers and cache keys contained in the cached resource, along with their matching values.\n\nWarning\n\nAlways use UTF-8 encoded URLs for single-file cache purges. Wildcards are not supported on single file purge, and you must use purge by hostname, prefix, or implement cache tags as an alternative solution.\n\n1. In the Cloudflare dashboard, go to the **Configuration** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Purge Cache**, select **Custom Purge**. The **Custom Purge** window appears.\n\n3. Under **Purge by**, select **URL**.\n\n4. Enter the appropriate value(s) in the text field using the format shown in the example. Be aware that the host part of the URL is not case-sensitive, meaning it will always be converted to lowercase according to RFC standards. However, the path portion is case-sensitive. For example, `https://EXAMPLE.com/helloHI` would be treated as `https://example.com/helloHI`.\n\n5. Perform any additional instructions to complete the form.\n\n6. Review your entries.\n\n7. Select **Purge**.\n\nNote\n\nFor information on how to use single-file purge to purge assets cached by a Workers fetch, refer to [Single file purge assets cached by a Worker](https://developers.cloudflare.com/workers/reference/how-the-cache-works/#single-file-purge-assets-cached-by-a-worker).\n\nFor information on how to purge assets cached by [Cache API](https://developers.cloudflare.com/workers/runtime-apis/cache/) operations, refer to [Purge assets stored with the Cache API](https://developers.cloudflare.com/workers/reference/how-the-cache-works/#purge-assets-stored-with-the-cache-api).\n\nWarning\n\nIf you have a [Transform Rule](https://developers.cloudflare.com/rules/transform/) in place that is modifying part of a URL path, you must use the non-transform (end user) URL when performing single file purge so that purge can take effect.\n\n## Resulting cache status\n\nPurging by single-file deletes the resource, resulting in the `CF-Cache-Status` header being set to [`MISS`](https://developers.cloudflare.com/cache/concepts/cache-responses/#miss) for subsequent requests.\n\n</page>\n\n<page>\n---\ntitle: Purge cache by hostname  Cloudflare Cache (CDN) docs\ndescription: Purging by hostname means that all assets at URLs with a host that\n  matches one of the provided values will be instantly purged from the cache.\nlastUpdated: 2025-10-06T13:41:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-hostname/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-hostname/index.md\n---\n\nPurging by hostname means that all assets at URLs with a host that matches one of the provided values will be instantly purged from the cache.\n\n1. In the Cloudflare dashboard, go to the **Configuration** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Purge Cache**, select **Custom Purge**. The **Custom Purge** window appears.\n\n3. Under **Purge by**, select **Hostname**.\n\n4. Follow the syntax instructions:\n\n   * One hostname per line.\n   * Separated by commas.\n   * You can purge up to 30 hostnames at a time.\n\n5. Enter the appropriate value(s) in the text field using the format shown in the example.\n\n6. Select **Purge**.\n\nFor information on rate limits, refer to the [Availability and limits](https://developers.cloudflare.com/cache/how-to/purge-cache/#availability-and-limits) section.\n\n## Resulting cache status\n\nPurging by hostname deletes the resource, resulting in the `CF-Cache-Status` header being set to [`MISS`](https://developers.cloudflare.com/cache/concepts/cache-responses/#miss) for subsequent requests.\n\nIf [tiered cache](https://developers.cloudflare.com/cache/how-to/tiered-cache/) is used, purging by hostname may return `EXPIRED`, as the lower tier tries to revalidate with the upper tier to reduce load on the latter. Depending on whether the upper tier has the resource or not, and whether the end user is reaching the lower tier or the upper tier, `EXPIRED` or `MISS` are returned.\n\n</page>\n\n<page>\n---\ntitle: Purge cache by cache-tags  Cloudflare Cache (CDN) docs\ndescription: Cache-tag purging makes multi-file purging easier because you can\n  instantly bulk purge by adding cache-tags to your assets, such as webpages,\n  image files, and more.\nlastUpdated: 2025-10-06T13:41:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-tags/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-tags/index.md\n---\n\nCache-tag purging makes multi-file purging easier because you can instantly bulk purge by adding cache-tags to your assets, such as webpages, image files, and more.\n\n## General workflow for cache-tags\n\n1. Add tags to the `Cache-Tag` HTTP response header from your origin web server for your web content, such as pages, static assets, etc.\n2. [Ensure your web traffic is proxied](https://developers.cloudflare.com/dns/proxy-status/) through Cloudflare.\n3. Cloudflare associates the tags in the `Cache-Tag` HTTP header with the content being cached.\n4. Use specific cache-tags to instantly purge your Cloudflare CDN cache of all content containing that cache-tag from your dashboard or [using our API](https://developers.cloudflare.com/api/resources/cache/methods/purge/).\n5. Cloudflare forces a [cache MISS](https://developers.cloudflare.com/cache/concepts/cache-responses/#miss) on content with the purged cache-tag.\n\nWarning\n\nBe careful when purging. A cache MISS can cause execution delays by requiring a fetch from your origin server.\n\n## Add Cache-Tag HTTP response headers\n\nYou add cache-tags to your web content in `Cache-Tag` HTTP response headers to allow the client and server to pass additional information in requests or responses. HTTP headers consist of a specific case-insensitive name followed by a colon `:` and the valid value, for example, `Cache-Tag:tag1,tag2,tag3`. Use commas to separate the tags when you want to use multiple cache-tags.\n\nWhen your content reaches our edge network, Cloudflare:\n\n* Removes the `Cache-Tag` HTTP header before sending the response to your website visitor or passing the response to a [Worker](https://developers.cloudflare.com/workers/). Your end users or Worker never see `Cache-Tag` HTTP headers on your Cloudflare-enabled website.\n* Removes whitespaces from the header and any before and after cache-tag names: `tag1`, `tag2` and `tag1,tag2` are considered the same.\n* Removes all repeated and trailing commas before applying cache-tags: `tag1,,,tag2` and `tag1,tag2` are considered the same.\n\n## A few things to remember\n\n* A single HTTP response can have more than one `Cache-Tag` HTTP header field.\n* The minimum length of a cache-tag is one byte.\n* Individual tags do not have a maximum length, but the aggregate `Cache-Tag` HTTP header cannot exceed 16 KB after the header field name, which is approximately 1,000 unique tags. Length includes whitespace and commas but does not include the header field name.\n* For cache purges, the maximum length of a cache-tag in an API call is 1,024 characters.\n* The `Cache-Tag` HTTP header must only contain printable ASCII encoded characters.\n* Spaces are not allowed in cache-tags.\n* Case is not sensitive. For example, `Tag1` and `tag1` are considered the same.\n\n## Purge using cache-tags\n\n1. In the Cloudflare dashboard, go to the **Configuration** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Purge Cache**, select **Custom Purge**. The **Custom Purge** window appears.\n\n3. Under **Purge by**, select **Tag**.\n\n4. In the text box, enter your tags to use to purge the cached resources. To purge multiple cache-tagged resources, separate each tag with a comma or have one tag per line.\n\n5. Select **Purge**.\n\nFor information on rate limits, refer to the [Availability and limits](https://developers.cloudflare.com/cache/how-to/purge-cache/#availability-and-limits) section.\n\n## Resulting cache status\n\nPurging by tag deletes the resource, resulting in the `CF-Cache-Status` header being set to [`MISS`](https://developers.cloudflare.com/cache/concepts/cache-responses/#miss) for subsequent requests.\n\nIf [Tiered Cache](https://developers.cloudflare.com/cache/how-to/tiered-cache/) is used, purging by tag may return `EXPIRED`, as the lower tier tries to revalidate with the upper tier to reduce load on the latter. Depending on whether the upper tier has the resource or not, and whether the end user is reaching the lower tier or the upper tier, `EXPIRED` or `MISS` are returned.\n\n</page>\n\n<page>\n---\ntitle: Purge cache key resources  Cloudflare Cache (CDN) docs\ndescription: Instantly purge resources that use Cache Keys via the Cloudflare\n  API. If you use Cloudflare's Purge by URL, include the headers and query\n  strings that are in your custom Cache Key.\nlastUpdated: 2025-07-09T13:51:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-cache-key/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-cache-key/index.md\n---\n\nInstantly purge resources that use Cache Keys via the [Cloudflare API](https://developers.cloudflare.com/api/resources/cache/methods/purge/). If you use [Cloudflare's Purge by URL](https://developers.cloudflare.com/api/resources/cache/methods/purge/#purge-cached-content-by-url), include the headers and query strings that are in your custom Cache Key.\n\nCurrently, it is not possible to purge a URL stored through Cache API that uses a custom cache key set by a Worker. Instead, use a [custom key created by Cache Rules](https://developers.cloudflare.com/cache/how-to/cache-rules/settings/#cache-key). Alternatively, purge your assets using purge everything, purge by tag, purge by host or purge by prefix.\n\nTo instantly purge by `device_type`, `geo`, or `lang` use `CF-Device-Type`, `CF-IPCountry` or `accept-language`, respectively. [Purge by Tag / Host](https://developers.cloudflare.com/api/resources/cache/methods/purge/#purge-cached-content-by-tag-host-or-prefix) and [Purge Everything](https://developers.cloudflare.com/api/resources/cache/methods/purge/#purge-all-cached-content) are not impacted by the use of custom Cache Keys.\n\n## Purge by device type\n\nFor a Cache Key based on device type, purge the asset by passing the `CF-Device-Type` header with the API purge request (valid headers include mobile, desktop, and tablet).\n\nRefer to the example API request below to instantly purge all mobile assets on the root webpage.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Cache Purge`",
      "language": "unknown"
    },
    {
      "code": "## Purge by geo\n\nInstantly purge resources for a location-based Cache Key by specifying the two-letter country code. Spain is used in the example below.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Cache Purge`",
      "language": "unknown"
    },
    {
      "code": "## Purge by language\n\nFor a Cache Key based on language, purge the asset by passing the `accept-language` header. Refer to the example API request below to instantly purge all assets in Chinese (PRC).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Cache Purge`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Purge everything  Cloudflare Cache (CDN) docs\ndescription: To maintain optimal site performance, Cloudflare strongly\n  recommends using single-file (by URL) purging instead of a complete cache\n  purge.\nlastUpdated: 2025-10-06T13:41:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-everything/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-everything/index.md\n---\n\nTo maintain optimal site performance, Cloudflare strongly recommends using single-file (by URL) purging instead of a complete cache purge.\n\nPurging everything instantly clears all resources from your CDN cache in all Cloudflare data centers. Each new request for a purged resource returns to your origin server to validate the resource. If Cloudflare cannot validate the resource, Cloudflare fetches the latest version from the origin server and replaces the cached version. When a site with heavy traffic contains a lot of assets, requests to your origin server can increase substantially and result in slow site performance.\n\n1. In the Cloudflare dashboard, go to the **Configuration** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Purge Cache**, select **Purge Everything**. A warning window appears.\n\n3. If you agree, select **Purge Everything**.\n\nNote\n\nWhen purging everything for a non-production cache environment, all files for that specific cache environment will be purged. However, when purging everything for the production environment, all files will be purged across all environments.\n\nFor information on rate limits, refer to the [Availability and limits](https://developers.cloudflare.com/cache/how-to/purge-cache/#availability-and-limits) section.\n\n## Resulting cache status\n\nPurge Everything invalidates the resource, resulting in the `CF-Cache-Status` header indicating [`EXPIRED`](https://developers.cloudflare.com/cache/concepts/cache-responses/#expired) for subsequent requests.\n\n</page>\n\n<page>\n---\ntitle: Purge varied images  Cloudflare Cache (CDN) docs\ndescription: Purging varied images instantly purges all content variants for\n  that URL. This behavior occurs so that if an image changes, you can easily\n  update the cache with a single purge request instead of trying to determine\n  the potential number of out-of-date variants. The behavior is true regardless\n  of purge type used, such as single file, tag, or hostname.\nlastUpdated: 2025-09-16T13:55:30.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-varied-images/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-varied-images/index.md\n---\n\nPurging varied images instantly purges all content variants for that URL. This behavior occurs so that if an image changes, you can easily update the cache with a single purge request instead of trying to determine the potential number of out-of-date variants. The behavior is true regardless of [purge type](https://developers.cloudflare.com/cache/how-to/purge-cache/) used, such as [single file](https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-single-file/), [tag](https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-tags/), or [hostname](https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-hostname/).\n\n</page>\n\n<page>\n---\ntitle: Purge zone versions via API  Cloudflare Cache (CDN) docs\ndescription: \"To purge zone versions via the Cloudflare API, follow these steps:\"\nlastUpdated: 2024-12-16T12:00:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-zone-versions/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge-zone-versions/index.md\n---\n\nTo purge zone versions via the Cloudflare API, follow these steps:\n\n## Step 1: Retrieve the environment ID\n\nFirst, retrieve your zone's environment ID by sending a request to the following API endpoint:",
      "language": "unknown"
    },
    {
      "code": "This API call will return a JSON response similar to the example below:",
      "language": "unknown"
    },
    {
      "code": "In this particular example, we have three environments: Production, Staging, and Development. You can find the environment ID in the `ref` field.\n\n## Step 2: Purge cache per environment\n\nTo purge the Production environment, use the general cache purge endpoint:",
      "language": "unknown"
    },
    {
      "code": "To purge non-production environments, you must use a new `purge_cache` endpoint and specify the environment you would like to purge.\n\nTo purge the Staging environment from the example above, send a request to the following endpoint:",
      "language": "unknown"
    },
    {
      "code": "To purge the Development environment from the example above, send a request to the following endpoint:",
      "language": "unknown"
    },
    {
      "code": "Note\n\nWhen purging everything for a non-production cache environment, all files for that specific cache environment will be purged. However, when purging everything for the production environment, all files will be purged across all environments.\n\n</page>\n\n<page>\n---\ntitle: Purge cache by prefix (URL)  Cloudflare Cache (CDN) docs\ndescription: \"You can instantly purge their cache by URL prefix or path\n  separators in their URL. For an example URL like\n  https://www.example.com/foo/bar/baz/qux.jpg, valid purge requests include:\"\nlastUpdated: 2025-10-06T13:41:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cache/how-to/purge-cache/purge_by_prefix/\n  md: https://developers.cloudflare.com/cache/how-to/purge-cache/purge_by_prefix/index.md\n---\n\nYou can instantly purge their cache by URL prefix or path separators in their URL. For an example URL like `https://www.example.com/foo/bar/baz/qux.jpg`, valid purge requests include:\n\n* `www.example.com`\n* `www.example.com/foo`\n* `www.example.com/foo/bar`\n* `www.example.com/foo/bar/baz`\n* `www.example.com/foo/bar/baz/qux.jpg`\n\nPurging by prefix is useful in different scenarios, such as:\n\n* Purging everything within a directory.\n* Increasing control over cached objects in a path.\n* Simplifying the number of purge calls sent.\n\n1. In the Cloudflare dashboard, go to the **Configuration** page.\n\n   [Go to **Configuration**](https://dash.cloudflare.com/?to=/:account/:zone/caching/configuration)\n\n2. Under **Purge Cache**, select **Custom Purge**. The **Custom Purge** window appears.\n\n3. Under **Purge by**, select **Prefix**.\n\n4. Follow the syntax instructions.\n\n   * One prefix per line.\n   * Maximum 30 prefixes per API call.\n\n5. Enter the appropriate value(s) in the text field using the format shown in the example.\n\n6. Select **Purge**.\n\nFor information on rate limits, refer to the [Availability and limits](https://developers.cloudflare.com/cache/how-to/purge-cache/#availability-and-limits) section.\n\nWarning\n\nIf you have a [Transform Rule](https://developers.cloudflare.com/rules/transform/) in place that is modifying part of a URL path, you must use the post-transformed (origin) URL when performing a prefix purge so that purge can take effect.\n\n## Resulting cache status\n\nPurging by prefix deletes the resource, causing `CF-Cache-Status` header to show [`MISS`](https://developers.cloudflare.com/cache/concepts/cache-responses/#miss) for the subsequent request.\n\nIf [tiered cache](https://developers.cloudflare.com/cache/how-to/tiered-cache/) is used, purging by prefix may return `EXPIRED`, as the lower tier tries to revalidate with the upper tier to reduce load on the latter. Depending on whether the upper tier has the resource or not, and whether the end user is reaching the lower tier or the upper tier, `EXPIRED` or `MISS` are returned.\n\n## Limitations\n\nThere are several limitations regarding purge by prefix:\n\n* Path separators are limited to 31 for a prefix `(example.com/a/b/c/d/e/f/g/h/i/j/k/l/m)`.\n\n* Purge requests are limited to 30 prefixes per request.\n\n* [Purge rate-limits apply](https://developers.cloudflare.com/api/resources/cache/methods/purge/).\n\n* URI query strings & fragments cannot purge by prefix:\n\n  * `www.example.com/foo?a=b` (query string)\n  * `www.example.com/foo#bar` (fragment)\n\nWarning\n\nBecause purge by prefix purges a directory, any URI for a resource within the purged directory is purged regardless of query string or fragment (though fragments are not generally sent by browsers). Purge by prefix rules do not accept fragments and query strings.\n\nExample: If you purge `foo.com/bar`, any asset that starts with `foo.com/bar` will be purged, for example, `foo.com/bar/baz`, `foo.com/bar?good=bad`, etc. and purging `foo.com/bar?good=bad` itself will not work.\n\n## Purge by prefix normalization\n\nUsing purge by prefix normalization, when a purge by prefix request comes into Cloudflare for a normalized URL path, the purge service respects the [URL normalization](https://developers.cloudflare.com/rules/normalization/) and purges the normalized URL.\n\n### How does URL Normalization work\n\nTake the following website as an example: `https://cloudflare.com/--/img_1.jpg`. The table below shows you how Cloudflares cache views these paths with [normalization on/off](https://developers.cloudflare.com/rules/normalization/).\n\n| Request from visitor to EDGE | What Cloudflare cache sees with Normalize Incoming URLs ON | What Cloudflare cache sees with Normalize Incoming URLs OFF |\n| - | - | - |\n| `https://cloudflare.com/--/img_1.jpg` | `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` | `https://cloudflare.com/--/img_1.jpg` |\n| `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` | `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` | `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` |\n| `https://cloudflare.com/hello/img_1.jpg` | `https://cloudflare.com/hello/img_1.jpg` | `https://cloudflare.com/hello/img_1.jpg` |\n\nAs shown above, with URL normalization **ON**, visitors to the two URLs, `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` and `https://cloudflare.com/--/img_1.jpg`, will be served the same cached asset. Purging `https://cloudflare.com/%D8%A7%D9%86%D8%B4%D8%A7%D8%A1-%D9%85%D9%88%D9%82%D8%B9-%D8%A7%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A/img_1.jpg` will instantly purge that asset for both visitors.\n\n</page>\n\n<page>\n---\ntitle: Additional configuration  Cloudflare challenges docs\ndescription: Refer to supported languages for more information.\nlastUpdated: 2025-10-13T17:48:00.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/additional-configuration/\n  md: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/additional-configuration/index.md\n---\n\n## Multi-language support\n\nRefer to [supported languages](https://developers.cloudflare.com/cloudflare-challenges/reference/supported-languages/) for more information.\n\n## Favicon customization\n\nCloudflare Challenges take the favicon of your website using `GET /favicon.ico` and displays it on the Challenge Page.\n\nYou can customize your favicon by using the HTML snippet below.",
      "language": "unknown"
    },
    {
      "code": "## Custom Content Security Policy (CSP) and error pages\n\nCloudflare-served Challenge Pages operate in a strictly controlled environment to maximize security and ensure the challenge mechanism functions correctly. Because of this, you cannot set your own Content Security Policy (CSP) or Referer-Policy using `<meta>` tags or Transform Rules on Challenge Pages. Origin headers can be modified within the Challenge Page context and are not immutable, but they may cause issues.\n\nIf you have an active Transform Rule configured to modify HTTP response headers globally across your website, such as adding custom CSP headers, this rule will interfere with and cause the Challenge Page to fail.\n\nTo prevent this conflict, you must modify your Transform Rule expression to explicitly exclude Challenge Page error types. Prefix your Transform Rule expression with the following logical exclusion:",
      "language": "unknown"
    },
    {
      "code": "This exclusion ensures that your custom header modification logic is only applied to traffic destined for your origin, allowing Cloudflare's Challenge Platform to function without being impacted by conflicting response headers.\n\n</page>\n\n<page>\n---\ntitle: Challenge Passage  Cloudflare challenges docs\ndescription: When a visitor solves a Cloudflare Challenge - as part of a WAF\n  custom rule or IP Access rule - you can set the Challenge Passage to prevent\n  them from having to solve future Challenges for a specified period of time.\nlastUpdated: 2025-10-28T10:49:34.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/challenge-passage/\n  md: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/challenge-passage/index.md\n---\n\nWhen a visitor solves a [Cloudflare Challenge](https://developers.cloudflare.com/cloudflare-challenges/) - as part of a [WAF custom rule](https://developers.cloudflare.com/waf/custom-rules/) or [IP Access rule](https://developers.cloudflare.com/waf/tools/ip-access-rules/) - you can set the **Challenge Passage** to prevent them from having to solve future Challenges for a specified period of time.\n\n### How it works\n\nWhen a visitor successfully solves a Challenge, Cloudflare sets a [`cf_clearance` cookie](https://developers.cloudflare.com/fundamentals/reference/policies-compliances/cloudflare-cookies/#additional-cookies-used-by-the-challenge-platform) in their browser. This cookie specifies the duration your website is accessible to that visitor.\n\nWhen that visitor tries to access other parts of your website, Cloudflare evaluates the cookie before presenting another Challenge. If the cookie is still valid, no Challenges will be shown.\n\nWhen Cloudflare evaluates a `cf_clearance` cookie, a few extra minutes are included to account for clock skew. For XmlHTTP requests, an extra hour is added to the validation time to prevent breaking XmlHTTP requests for pages that set short lifetimes.\n\n### Customize the Challenge Passage\n\nBy default, the `cf_clearance` cookie has a lifetime of 30 minutes. Cloudflare recommends a setting between 15 and 45 minutes.\n\nTo update the Challenge Passage (and the value of the `cf_clearance` cookie):\n\n1. In the Cloudflare dashboard, go to the **Security Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/security/settings)\n\n2. Go to **Challenge passage**.\n\n3. Select the edit icon to set a timeout duration.\n\n### Limitations\n\nThe Challenge Passage does not apply to rate limiting rules.\n\n</page>\n\n<page>\n---\ntitle: Implement a Challenge Page via WAF custom rules  Cloudflare challenges docs\ndescription: You can implement a Challenge Page to your website or application\n  by creating a WAF custom rule.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/create-custom-rule/\n  md: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/create-custom-rule/index.md\n---\n\nYou can implement a Challenge Page to your website or application by creating a [WAF custom rule](https://developers.cloudflare.com/waf/custom-rules/).\n\nChallenges are triggered by a rule in the [Web Application Firewall (WAF)](https://developers.cloudflare.com/waf/), [Bot Management](https://developers.cloudflare.com/bots/), or [Rate limiting](https://developers.cloudflare.com/waf/rate-limiting-rules/).\n\n* **Bot Management**: You can set the custom rule to challenge a visitor based on the [bot score](https://developers.cloudflare.com/bots/concepts/bot-score/) or [detection ID](https://developers.cloudflare.com/bots/additional-configurations/detection-ids/).\n* **Rate limiting**: You can challenge visitors based on your defined rate limits.\n\n</page>\n\n<page>\n---\ntitle: Detect a Challenge Page response  Cloudflare challenges docs\ndescription: When a request encounters a Cloudflare Challenge Page instead of\n  the originally anticipated response, the Challenge Page response (regardless\n  of the Challenge Page type) will have the cf-mitigated header present and set\n  to challenge. This header can be leveraged to detect if a response was\n  challenged when making fetch/XHR requests. This header provides a reliable way\n  to identify whether a response is a Challenge or not, enabling a web\n  application to take appropriate action based on the result. For example, a\n  front-end application encountering a response from the backend may check the\n  presence of this header value to handle cases where Challenge Pages\n  encountered unexpectedly.\nlastUpdated: 2025-10-13T17:48:00.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/detect-response/\n  md: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/detect-response/index.md\n---\n\nWhen a request encounters a Cloudflare Challenge Page instead of the originally anticipated response, the Challenge Page response (regardless of the Challenge Page type) will have the `cf-mitigated` header present and set to `challenge`. This header can be leveraged to detect if a response was challenged when making fetch/XHR requests. This header provides a reliable way to identify whether a response is a Challenge or not, enabling a web application to take appropriate action based on the result. For example, a front-end application encountering a response from the backend may check the presence of this header value to handle cases where Challenge Pages encountered unexpectedly.\n\nNote\n\nRegardless of the requested resource-type, the content-type of a Challenge will be `text/html`.\n\nFor the `cf-mitigated` header, `challenge` is the only valid value. The header is set for all Challenge Page types.\n\nTo illustrate, here is a JavaScript code snippet that demonstrates how to use the `cf-mitigated` header to detect whether a response was challenged:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Resolve a Challenge  Cloudflare challenges docs\ndescription: If a visitor encounters a Challenge, Cloudflare employees cannot\n  remove that Challenge. Only the website owner can configure their Cloudflare\n  settings to stop the Challenge being presented.\nlastUpdated: 2025-06-24T17:41:46.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/resolve-challenge/\n  md: https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/resolve-challenge/index.md\n---\n\nIf a visitor encounters a Challenge, Cloudflare employees cannot remove that Challenge. Only the website owner can configure their Cloudflare settings to stop the Challenge being presented.\n\nWhen observing a Cloudflare Challenge page, a visitor could:\n\n* Successfully pass the Challenge to visit the website.\n* Request the website owner to allow their IP address.\n* Scan their computer for malicious programs (it may be infected).\n* Check their antivirus or firewall service to make sure it is not blocking access to the Challenge resources (for example, images).\n\nNote\n\nVisitors must enable JavaScript and cookies on their browser to be able to pass any type of Challenge.\n\n</page>\n\n<page>\n---\ntitle: Create custom hostnames  Cloudflare for Platforms docs\ndescription: Learn how to create custom hostnames.\nlastUpdated: 2025-12-19T10:15:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/create-custom-hostnames/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/create-custom-hostnames/index.md\n---\n\nThere are several required steps before a custom hostname can become active. For more details, refer to our [Get started guide](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/).\n\nZone name restriction\n\nDo not configure a custom hostname which matches the zone name. For example, if your SaaS zone is `example.com`, do not create a custom hostname named `example.com`.\n\nTo create a custom hostname:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Custom Hostnames** page.\n\n     [Go to **Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames)\n\n  2. Select **Add Custom Hostname**.\n\n  3. Add your customer's hostname `app.customer.com` and set the relevant options, including:\n\n     * The [minimum TLS version](https://developers.cloudflare.com/ssl/reference/protocols/).\n     * Defining whether you want to use a certificate provided by Cloudflare or [upload a custom certificate](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/custom-certificates/uploading-certificates/).\n     * Selecting the [certificate authority (CA)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) that will issue the certificate.\n     * Choosing the [validation method](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/).\n     * Whether you want to **Enable wildcard**, which adds a `*.<custom-hostname>` SAN to the custom hostname certificate. For more details, refer to [Hostname priority](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/#hostname-priority).\n     * Choosing a value for [Custom origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/).\n\n  4. Select **Add Custom Hostname**.\n\n  Default behavior\n\n  When you create a custom hostname:\n\n  * If you issue a custom hostname certificate with wildcards enabled, you cannot customize TLS settings for these wildcard hostnames.\n  * If you do not specify the **Minimum TLS Version**, it defaults to the zone's Minimum TLS Version. You can still [edit this setting](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/#minimum-tls-version) after creation.\n\n* API\n\n  1. To create a custom hostname using the API, use the [Create Custom Hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/) endpoint.\n\n     * You can leave the `certificate_authority` parameter empty to set it to \"default CA\". With this option, Cloudflare checks the CAA records before requesting the certificates, which helps ensure the certificates can be issued from the CA.\n\n  2. For the newly created custom hostname, the `POST` response may not return the DCV validation token `validation_records`. It is recommended to make a second [`GET` command](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/list/) (with a delay) to retrieve these details.\n\n  The response contains the complete definition of the new custom hostname.\n\n  Default behavior\n\n  When you create a custom hostname:\n\n  * If you issue a custom hostname certificate with wildcards enabled, you cannot customize TLS settings for these wildcard hostnames.\n  * If you do not specify the **Minimum TLS Version**, it defaults to the zone's Minimum TLS Version. You can still [edit this setting](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/#minimum-tls-version) after creation.\n\nFor each custom hostname, Cloudflare issues two certificates bundled in chains that maximize browser compatibility (unless you [upload custom certificates](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/custom-certificates/uploading-certificates/)).\n\nThe primary certificate uses a `P-256` key, is `SHA-2/ECDSA` signed, and will be presented to browsers that support elliptic curve cryptography (ECC). The secondary or fallback certificate uses an `RSA 2048-bit` key, is `SHA-2/RSA` signed, and will be presented to browsers that do not support ECC.\n\n## Hostnames over 64 characters\n\nThe Common Name (CN) restriction establishes a limit of 64 characters ([RFC 5280](https://www.rfc-editor.org/rfc/rfc5280.html)). If you have a hostname that exceeds this length, you can set `cloudflare_branding` to `true` when creating your custom hostnames [via API](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/).",
      "language": "unknown"
    },
    {
      "code": "Cloudflare branding means that `sni.cloudflaressl.com` will be added as the certificate Common Name (CN) and the long hostname will be included as a part of the Subject Alternative Name (SAN).\n\n</page>\n\n<page>\n---\ntitle: Custom metadata  Cloudflare for Platforms docs\ndescription: Configure per-hostname settings such as URL rewriting and custom headers.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/index.md\n---\n\nYou may wish to configure per-hostname (customer) settings beyond the scale of Rules or Rate Limiting.\n\nTo do this, you will first need to reach out to your account team to enable access to Custom Metadata. After configuring custom metadata, you can use it in the following ways:\n\n* Read the metadata JSON from [Cloudflare Workers](https://developers.cloudflare.com/workers/) (requires access to Workers) to define per-hostname behavior.\n* Use custom metadata values in [rule expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/) of different Cloudflare security products to define the rule scope.\n\nNote\n\nOnly certain customers have access to this feature. For more details, see the [Plans page](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/plans/).\n\n***\n\n## Examples\n\n* Per-customer URL rewriting  for example, customers 1-10,000 fetch assets from server A, 10,001-20,000 from server B, etc.\n* Adding custom headers  for example, `X-Customer-ID: $number` based on the metadata you provided\n* Setting HTTP Strict Transport Security (HSTS) headers on a per-customer basis\n\nPlease speak with your Solutions Engineer to discuss additional logic and requirements.\n\n## Submitting custom metadata\n\nYou may add custom metadata to Cloudflare via the Custom Hostnames API. This data can be added via a [`PATCH` request](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/edit/) to the specific hostname ID to set metadata for that hostname, for example:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "Changes to metadata will propagate across Cloudflare's edge within 30 seconds.\n\n***\n\n## Accessing custom metadata from a Cloudflare Worker\n\nThe metadata object will be accessible on each request using the `request.cf.hostMetadata` property. You can then read the data, and customize any behavior on it using the Worker.\n\nIn the example below we will use the user\\_id in the Worker that was submitted using the API call above `\"custom_metadata\":{\"customer_id\":\"12345\",\"redirect_to_https\": true,\"security_tag\":\"low\"}`, and set a request header to send the `customer_id` to the origin:\n\n* JavaScript",
      "language": "unknown"
    },
    {
      "code": "* TypeScript",
      "language": "unknown"
    },
    {
      "code": "## Accessing custom metadata in a rule expression\n\nUse the [`cf.hostname.metadata`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.hostname.metadata/) field to access the metadata object in rule expressions. To obtain the different values from the JSON object, use the [`lookup_json_string`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#lookup_json_string) function.\n\nThe following rule expression defines that there will be a rule match if the `security_tag` value in custom metadata contains the value `low`:",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Best practices\n\n* Ensure that the JSON schema used is fixed: changes to the schema without corresponding Cloudflare Workers changes will potentially break websites, or fall back to any defined default behavior\n* Prefer a flat JSON structure\n* Use string keys in snake\\_case (rather than camelCase or PascalCase)\n* Use proper booleans (true/false rather than `true` or `1` or `0`)\n* Use numbers to represent integers instead of strings (`1` or `2` instead of `\"1\"` or `\"2\"`)\n* Define fallback behaviour in the non-presence of metadata\n* Define fallback behaviour if a key or value in the metadata are unknown\n\nGeneral guidance is to follow [Google's JSON Style guide](https://google.github.io/styleguide/jsoncstyleguide.xml) where appropriate.\n\n***\n\n## Limitations\n\nThere are some limitations to the metadata that can be provided to Cloudflare:\n\n* It must be valid JSON.\n* Any origin resolution  for example, directing requests for a given hostname to a specific backend  must be provided as a hostname that exists within Cloudflare's DNS (even for non-authoritative setups). Providing an IP address directly will cause requests to error.\n* The total payload must not exceed 4 KB.\n* It requires a Cloudflare Worker that knows how to process the schema and trigger logic based on the contents.\n\nNote\n\nBe careful when modifying the schema. Adding, removing, or changing keys and possible values may cause the Cloudflare Worker to either ignore the data or return an error for requests that trigger it.\n\n### Terraform support\n\n[Terraform](https://developers.cloudflare.com/terraform/) only allows maps of a single type, so Cloudflare's Terraform support for custom metadata for custom hostnames is limited to string keys and values.\n\n</page>\n\n<page>\n---\ntitle: Hostname validation  Cloudflare for Platforms docs\ndescription: Before Cloudflare can proxy traffic through a custom hostname, we\n  need to verify your customer's ownership of that hostname.\nlastUpdated: 2025-02-19T18:44:35.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/index.md\n---\n\nBefore Cloudflare can proxy traffic through a custom hostname, we need to verify your customer's ownership of that hostname.\n\nNote\n\nIf a custom hostname is already on Cloudflare, using the [pre-validation methods](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/pre-validation/) will not shift the traffic to the SaaS zone. That will only happen once the [DNS target](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#3-have-customer-create-cname-record) of the custom hostnames changes to point to the SaaS zone.\n\n## Options\n\nIf minimizing downtime is more important to you, refer to our [pre-validation methods](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/pre-validation/).\n\nIf ease of use for your customers is more important, review our [real-time validation methods](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/realtime-validation/).\n\n## Limitations\n\nCustom hostnames using another CDN are not compatible with Cloudflare for SaaS. Since Cloudflare must be able to validate your customer's ownership of the hostname you add, if their usage of another CDN obfuscates their DNS records, hostname validation will fail.\n\n## Related resources\n\n* [Pre-validation](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/pre-validation/)\n* [Real-time validation](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/realtime-validation/)\n* [Backoff schedule](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/backoff-schedule/)\n* [Validation status](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/validation-status/)\n* [Error codes](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/error-codes/)\n\n</page>\n\n<page>\n---\ntitle: Move hostnames between zones  Cloudflare for Platforms docs\ndescription: Learn how to move hostnames between different zones.\nlastUpdated: 2025-10-30T10:25:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/migrating-custom-hostnames/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/migrating-custom-hostnames/index.md\n---\n\nAs a SaaS provider, you may want, or have, multiple zones to manage hostnames. Each zone can have different configurations or origins, as well as correlate to varying products. You might shift custom hostnames between zones to enable or disable certain features. Cloudflare allows migration within the same account through the steps below:\n\n***\n\n## CNAME\n\nIf your custom hostname uses a CNAME record, add the custom hostname to the new zone and [update your DNS record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#edit-dns-records) to point to the new zone.\n\nNote\n\nIf you would like to migrate the custom hostname without end customers changing the DNS target, use [apex proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/).\n\n1. [Add custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) to your new zone.\n\n2. Direct your customer to [change the DNS record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#edit-dns-records) so that it points to the new zone.\n\n3. Confirm that the custom hostname has validated in the new zone.\n\n4. Wait for the certificate to validate automatically through Cloudflare or [validate it using Domain Control Validation (DCV)](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/#perform-dcv).\n\n5. Remove custom hostname from the old zone.\n\nOnce these steps are complete, the custom hostname's traffic will route to the second SaaS zone and will use its configuration.\n\n## A record\n\nThrough [Apex Proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/) or [BYOIP](https://developers.cloudflare.com/byoip/), you can migrate the custom hostname without action from your end customer.\n\n1. Verify with the account team that your apex proxying IPs have been assigned to both SaaS zones.\n\n2. [Add custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) to the new zone.\n\n3. Confirm that the custom hostname has validated in the new zone.\n\n4. Wait for the certificate to validate automatically through Cloudflare or [validate it using DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/#perform-dcv).\n\n5. Remove custom hostname from the old zone.\n\nNote\n\nThe most recently edited custom hostname will be active. For instance, `example.com` exists on `SaaS Zone 1`. It is added to `SaaS Zone 2`. Because it was activated more recently on `SaaS Zone 2`, that is where it will be active. However, if edits are made to example.com on `SaaS Zone 1`, it will reactivate on that zone instead of `SaaS Zone 2`.\n\n## Wildcard certificate\n\nIf you are migrating custom hostnames that rely on a Wildcard certificate, Cloudflare cannot automatically complete Domain Control Validation (DCV).\n\n1. [Add custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) to the new zone.\n\n2. Direct your customer to [change the DNS record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#edit-dns-records) so that it points to the new zone.\n\n3. [Validate the certificate](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/#perform-dcv) on the new zone through DCV.\n\nThe custom hostname can activate on the new zone even if the certificate is still active on the old zone. This ensures a valid certificate exists during migration. However, it is important to validate the certificate on the new zone as soon as possible.\n\nNote\n\nVerify that the custom hostname successfully activated after the migration on the [**Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames) page.\n\n</page>\n\n<page>\n---\ntitle: Remove custom hostnames  Cloudflare for Platforms docs\ndescription: Learn how to remove custom hostnames for inactive customers.\nlastUpdated: 2025-10-14T10:16:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/remove-custom-hostnames/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/remove-custom-hostnames/index.md\n---\n\nAs a SaaS provider, your customers may decide to no longer participate in your service offering. If that happens, you need to stop routing traffic through those custom hostnames.\n\n## Domains using Cloudflare\n\nIf your customer's domain is also using Cloudflare, they can stop routing their traffic through your custom hostname by updating their Cloudflare DNS.\n\nIf they update their [`CNAME` record](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#3-have-customer-create-cname-record) so that it no longer points to your `CNAME` target:\n\n* The domain's traffic will not route through your custom hostname.\n* The custom hostname will enter into a **Moved** state.\n\nIf the custom hostname is in a **Moved** state for seven days, it will transition into a **Deleted** state.\n\nYou should remove a customer's custom hostname from your zone if they decide to churn. This is especially important if your end customers are using Cloudflare because if the churned customer changes the DNS target to point away from your SaaS zone but you have not removed it, the custom hostname will continue to route to your service. This is a result of the [custom hostname priority logic](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/#hostname-priority).\n\n## Domains not using Cloudflare\n\nIf your customer's domain is not using Cloudflare, you must remove a customer's custom hostname from your zone if they decide to churn.\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Custom Hostnames** page.\n\n     [Go to **Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames)\n\n  2. Select the custom hostname and select **Delete**.\n\n  3. A confirmation window will appear. Acknowledge the warning and select **Delete** again.\n\n* API\n\n  To delete a custom hostname and any issued certificates using the API, send a [`DELETE` request](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/delete/).\n\n## For end customers\n\nIf your SaaS domain is also a [domain using Cloudflare](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/), you can use your Cloudflare DNS to remove your domain from your SaaS provider.\n\nThis means that - if you [remove the DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#delete-dns-records) pointing to your SaaS provider - Cloudflare will stop routing domain traffic through your SaaS provider and the associated custom hostname will enter a **Moved** state.\n\nThis also means that you need to keep DNS records pointing to your SaaS provider for as long as you are a customer. Otherwise, you could accidentally remove your domain from their services.\n\n</page>\n\n<page>\n---\ntitle: Argo Smart Routing for SaaS  Cloudflare for Platforms docs\ndescription: Argo Smart Routing uses real-time global network information to\n  route traffic on the fastest possible path across the Internet. Regardless of\n  geographic location, this allows Cloudflare to optimize routing to make it\n  faster, more reliable, and more secure. As a SaaS provider, you may want to\n  emphasize the quickest traffic delivery for your end customers. To do so,\n  enable Argo Smart Routing.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/argo-for-saas/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/argo-for-saas/index.md\n---\n\nArgo Smart Routing uses real-time global network information to route traffic on the fastest possible path across the Internet. Regardless of geographic location, this allows Cloudflare to optimize routing to make it faster, more reliable, and more secure. As a SaaS provider, you may want to emphasize the quickest traffic delivery for your end customers. To do so, [enable Argo Smart Routing](https://developers.cloudflare.com/argo-smart-routing/get-started/).\n\n</page>\n\n<page>\n---\ntitle: Cache for SaaS  Cloudflare for Platforms docs\ndescription: \"Cloudflare makes customer websites faster by storing a copy of the\n  websites content on the servers of our globally distributed data centers.\n  Content can be either static or dynamic: static content is cacheable or\n  eligible for caching, and dynamic content is uncacheable or ineligible for\n  caching. The cached copies of content are stored physically closer to users,\n  optimized to be fast, and do not require recomputing.\"\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/cache-for-saas/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/cache-for-saas/index.md\n---\n\nCloudflare makes customer websites faster by storing a copy of the websites content on the servers of our globally distributed data centers. Content can be either static or dynamic: static content is cacheable or eligible for caching, and dynamic content is uncacheable or ineligible for caching. The cached copies of content are stored physically closer to users, optimized to be fast, and do not require recomputing.\n\nAs a SaaS provider, enabling caching reduces latency on your custom domains. For more information, refer to [Cache](https://developers.cloudflare.com/cache/). If you would like to enable caching, review [Getting Started with Cache](https://developers.cloudflare.com/cache/get-started/).\n\n</page>\n\n<page>\n---\ntitle: Early Hints for SaaS  Cloudflare for Platforms docs\ndescription: Early Hints allows the browser to begin loading resources while the\n  origin server is compiling the full response. This improves webpages loading\n  speed for the end user. As a SaaS provider, you may prioritize speed for some\n  of your custom hostnames. Using custom metadata, you can enable Early Hints\n  per custom hostname.\nlastUpdated: 2025-10-30T10:25:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/early-hints-for-saas/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/performance/early-hints-for-saas/index.md\n---\n\n[Early Hints](https://developers.cloudflare.com/cache/advanced-configuration/early-hints/) allows the browser to begin loading resources while the origin server is compiling the full response. This improves webpages loading speed for the end user. As a SaaS provider, you may prioritize speed for some of your custom hostnames. Using custom metadata, you can [enable Early Hints](https://developers.cloudflare.com/cache/advanced-configuration/early-hints/#enable-early-hints) per custom hostname.\n\n***\n\n## Prerequisites\n\nBefore you can employ Early Hints for SaaS, you need to create a custom hostname. Review [Get Started with Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) if you have not already done so.\n\n***\n\n## Enable Early Hints per custom hostname via the API\n\n1. [Locate your zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/), available in the Cloudflare dashboard.\n\n2. Locate your Authentication Key on the [**API Tokens**](https://dash.cloudflare.com/?to=/:account/profile/api-tokens) page, under **Global API Key**.\n\n3. If you are [creating a new custom hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/), make an API call such as the example below, specifying `\"early_hints\": \"on\"`:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "1. For an existing custom hostname, locate the `id` of that hostname via a `GET` call:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`\n* `SSL and Certificates Read`",
      "language": "unknown"
    },
    {
      "code": "1. Then make an API call such as the example below, specifying `\"early_hints\": \"on\"`:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "Currently, all options within `settings` are required in order to prevent those options from being set to default. You can pull the current settings state prior to updating Early Hints by leveraging the output that returns the `id` for the hostname.\n\n</page>\n\n<page>\n---\ntitle: Certificate authorities  Cloudflare for Platforms docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/certificate-authorities/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/certificate-authorities/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Certificate statuses  Cloudflare for Platforms docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/certificate-statuses/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/certificate-statuses/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Connection request details  Cloudflare for Platforms docs\ndescription: \"When forwarding connections to your origin server, Cloudflare will\n  set request parameters according to the following:\"\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/connection-details/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/connection-details/index.md\n---\n\nWhen forwarding connections to your origin server, Cloudflare will set request parameters according to the following:\n\n## Host header\n\nCloudflare will not alter the Host header by default, and will forward exactly as sent by the client. If you wish to change the value of the Host header you can utilise [Page-Rules](https://developers.cloudflare.com/workers/configuration/workers-with-page-rules/) or [Workers](https://developers.cloudflare.com/workers/) using the steps outlined in [certificate management](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/).\n\n## SNI\n\nWhen establishing a TLS connection to your origin server, if the request is being sent to your configured Fallback Host then the value of the SNI sent by Cloudflare will match the value of the Host header sent by the client (i.e. the custom hostname).\n\nIf however the request is being forwarded to a Custom Origin, then the value of the SNI will be that of the Custom Origin.\n\n</page>\n\n<page>\n---\ntitle: Domain control validation backoff schedule  Cloudflare for Platforms docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/dcv-validation-backoff/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/dcv-validation-backoff/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Certificate and hostname priority  Cloudflare for Platforms docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/hostname-priority/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/hostname-priority/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Status codes  Cloudflare for Platforms docs\ndescription: \"Cloudflare uses many different status codes for Cloudflare for\n  SaaS. They can be related to:\"\nlastUpdated: 2024-09-20T16:41:42.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/status-codes/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/status-codes/index.md\n---\n\nCloudflare uses many different status codes for Cloudflare for SaaS. They can be related to:\n\n* [Custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/status-codes/custom-hostnames/)\n* [Custom CSRs](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/status-codes/custom-csrs/)\n\n</page>\n\n<page>\n---\ntitle: Token validity periods  Cloudflare for Platforms docs\ndescription: When you perform TXT domain control validation, you will need to\n  share these tokens with your customers.\nlastUpdated: 2024-09-19T08:55:48.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/token-validity-periods/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/token-validity-periods/index.md\n---\n\nWhen you perform [TXT](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/txt/) domain control validation, you will need to share these tokens with your customers.\n\nHowever, these tokens expire after a certain amount of time, depending on your chosen certificate authority.\n\n| Certificate authority | Token validity |\n| - | - |\n| Let's Encrypt | 7 days |\n| Google Trust Services | 14 days |\n| SSL.com | 14 days |\n\nWarning\n\nTokens may also become invalid upon validation failure. For more details, refer to [Domain control validation flow](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/#dcv-tokens).\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting Cloudflare for SaaS  Cloudflare for Platforms docs\ndescription: By default, you may issue up to 15 certificates per minute. Only\n  successful submissions (POSTs that return 200) are counted towards your limit.\n  If you exceed your limit, you will be prevented from issuing new certificates\n  for 30 seconds.\nlastUpdated: 2025-12-19T10:15:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/troubleshooting/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/troubleshooting/index.md\n---\n\n## Rate limits\n\nBy default, you may issue up to 15 certificates per minute. Only successful submissions (POSTs that return 200) are counted towards your limit. If you exceed your limit, you will be prevented from issuing new certificates for 30 seconds.\n\nIf you require a higher rate limit, contact your Customer Success Manager.\n\n***\n\n## Purge cache\n\nTo remove specific files from Cloudflares cache, [purge the cache](https://developers.cloudflare.com/cache/how-to/purge-cache/purge-by-hostname/) while specifying one or more hostnames.\n\n***\n\n## Resolution error 1016 (Origin DNS error) when accessing the custom hostname\n\nCloudflare returns a 1016 error when the custom hostname cannot be routed or proxied.\n\nThere are three main causes of error 1016:\n\n1. Custom Hostname ownership validation is not complete. To check validation status, run an API call to [search for a certificate by hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/common-api-calls/) and check the verification error field: `\"verification_errors\": [\"custom hostname does not CNAME to this zone.\"]`.\n2. Fallback Origin is not [correctly set](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#1-create-fallback-origin). Confirm that you have created a DNS record for the fallback origin and also set the fallback origin.\n3. A Wildcard Custom Hostname has been created, but the requested hostname is associated with a domain that exists in Cloudflare as a standalone zone. In this case, the [hostname priority](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/#hostname-priority) for the standalone zone will take precedence over the wildcard custom hostname. This behavior applies even if there is no DNS record for this standalone zone hostname.\n\nIn this scenario each hostname that needs to be served by the Cloudflare for SaaS parent zone needs to be added as an individual Custom Hostname.\n\nNote\n\nIf you encounter other 1XXX errors, refer to [Troubleshooting Cloudflare 1XXX Errors](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-1xxx-errors/).\n\n***\n\n## Custom hostname in Moved status\n\nTo move a custom hostname back to an Active status, send a [PATCH request](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/edit/) to restart the hostname validation. A Custom Hostname in a Moved status is deleted after 7 days.\n\nIn some circumstances, custom hostnames can also enter a **Moved** state if your customer changes their DNS records pointing to your SaaS service. For more details, refer to [Remove custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/remove-custom-hostnames/).\n\n***\n\n## CAA Errors\n\nThe `caa_error` in the status of a custom hostname means that the CAA records configured on the domain prevented the Certificate Authority to issue the certificate.\n\nYou can check which CAA records are configured on a domain using the `dig` command: `dig CAA example.com`\n\nYou will need to ensure that the required CAA records for the selected Certificate Authority are configured. For example, here are the records required to issue [Let's Encrypt](https://letsencrypt.org/docs/caa/) and [Google Trust Services](https://pki.goog/faq/#caa) certificates:",
      "language": "unknown"
    },
    {
      "code": "More details can be found on the [CAA records FAQ](https://developers.cloudflare.com/ssl/edge-certificates/troubleshooting/caa-records/).\n\n***\n\n## Custom hostname matches zone name (403 Forbidden)\n\nDo not configure a custom hostname which matches the zone name. For example, if your SaaS zone is `example.com`, do not create a custom hostname named `example.com`.\n\nThis configuration will cause a 403 Forbidden error due to DNS override restrictions applied for security reasons. This limitation also affects Worker Routes making subrequests.\n\n***\n\n## Older devices have issues connecting\n\nAs Let's Encrypt - one of the [certificate authorities (CAs)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) used by Cloudflare - has announced changes in its [chain of trust](https://developers.cloudflare.com/ssl/concepts/#chain-of-trust), starting September 9, 2024, there may be issues with older devices trying to connect to your custom hostname certificate.\n\nConsider the following solutions:\n\n* Use the [Edit Custom Hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/edit/) endpoint to set the `certificate_authority` parameter to an empty string (`\"\"`): this sets the custom hostname certificate to \"default CA\", leaving the choice up to Cloudflare. Cloudflare will always attempt to issue the certificate from a more compatible CA, such as [Google Trust Services](https://developers.cloudflare.com/ssl/reference/certificate-authorities/#google-trust-services), and will only fall back to using Lets Encrypt if there is a [CAA record](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) in place that blocks Google from issuing a certificate.\n\n  Example API call",
      "language": "unknown"
    },
    {
      "code": "* Use the [Edit Custom Hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/edit/) endpoint to set the `certificate_authority` parameter to `google`: this sets Google Trust Services as the CA for your custom hostnames. In your API call, make sure to also include `method` and `type` in the `ssl` object.\n\n* If you are using a custom certificate for your custom hostname, refer to the [custom certificates troubleshooting](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/troubleshooting/#lets-encrypt-chain-update).\n\n## Custom hostname fails to verify because the zone is held\n\nThe [zone hold feature](https://developers.cloudflare.com/fundamentals/account/account-security/zone-holds/) is a toggle that will prevent their zone from being activated on other Cloudflare account. When enabled, Cloudflare is not able to issue an SSL/TLS certificate on behalf of that domain name for either a zone or custom hostname. When the option `Also prevent subdomains` is enabled, this prevents the verification of custom hostnames for this domain. The custom hostname will remain in the `Blocked` status, with the following error message: `The hostname is associated with a held zone. Please contact the owner of this domain to have the hold removed.` In this case, the owner of the zone needs to [release the hold](https://developers.cloudflare.com/fundamentals/account/account-security/zone-holds/#release-zone-holds) before the custom hostname can become activated. After the hostname has been validated, the zone hold can be enabled again.\n\n## Hostnames over 64 characters\n\nThe Common Name (CN) restriction establishes a limit of 64 characters ([RFC 5280](https://www.rfc-editor.org/rfc/rfc5280.html)). If you have a hostname that exceeds this length, you may find the following error:",
      "language": "unknown"
    },
    {
      "code": "To solve this, you can set `cloudflare_branding` to `true` when [creating your custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/create-custom-hostnames/#hostnames-over-64-characters) via API.\n\nCloudflare branding means that `sni.cloudflaressl.com` will be added as the certificate Common Name (CN) and the long hostname will be included as a part of the Subject Alternative Name (SAN).\n\n</page>\n\n<page>\n---\ntitle: Deprecation notice for SSL for SaaS - Version 1  Cloudflare for Platforms docs\ndescription: The first version of SSL for SaaS will be deprecated on September 1, 2021.\nlastUpdated: 2025-07-22T08:48:22.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/versioning/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/reference/versioning/index.md\n---\n\nThe first version of SSL for SaaS will be deprecated on September 1, 2021.\n\n## Why is SSL for SaaS changing?\n\nIn SSL for SaaS v1, traffic for Custom Hostnames is proxied to the origin based on the IP addresses assigned to the zone with SSL for SaaS enabled. This IP-based routing introduces complexities that prevented customers from making changes with zero downtime.\n\nSSL for SaaS v2 removes IP-based routing and its associated problems. Instead, traffic is proxied to the origin based on the custom hostname of the SaaS zone. This means that Custom Hostnames will now need to pass a **hostname verification** step after Custom Hostname creation and in addition to SSL certificate validation. This adds a layer of security from SSL for SaaS v1 by ensuring that only verified hostnames are proxied to your origin.\n\n## What action is needed?\n\nTo ensure that your service is not disrupted, you need to perform an additional ownership check on every new Custom Hostname. There are three methods to verify ownership: TXT, HTTP, and CNAME. Use TXT and HTTP for pre-validation to validate the Custom Hostname before traffic is proxied by Cloudflares edge.\n\n### Recommended validation methods\n\nUsing a [TXT](#dns-txt-record) or [HTTP](#http-token) validation method helps you avoid downtime during your migration. If you choose to use [CNAME validation](#cname-validation), your domain might fall behind on its [backoff schedule](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/validation-backoff-schedule/).\n\n#### DNS TXT Record\n\nWhen creating a Custom Hostname with the TXT method through the [API](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/), a TXT ownership\\_verification record is provided for your customer to add to their DNS for the ownership validation check. When the TXT record is added, the Custom Hostname will be marked as **Active** in the Cloudflare SSL/TLS app under the Custom Hostnames tab.\n\n#### HTTP Token\n\nWhen creating a Custom Hostname with the HTTP through the [API](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/), an HTTP ownership\\_verification token is provided. HTTP verification is used mainly by organizations with a large deployed base of custom domains with HTTPS support. Serving the HTTP token from your origin web server allows hostname verification before proxying domain traffic through Cloudflare.\n\nCloudflare sends GET requests to the http\\_url using `User-Agent: Cloudflare Custom Hostname Verification`.\n\nIf you validated a hostname that is not proxying traffic through Cloudflare, the Custom Hostname will be marked as **Active** in the Cloudflare SSL/TLS app when the HTTP token is verified (under the **Custom Hostnames** tab).\n\nIf your hostname is already proxying traffic through Cloudflare, then HTTP validation is not enough by itself and the hostname will only go active when DNS-based validation is complete.\n\n### Other validation methods\n\nThough you can use [CNAME validation](#cname-validation), we recommend you either use a [TXT](#dns-txt-record) or [HTTP](#http-token) validation method.\n\n#### CNAME Validation\n\nCustom Hostnames can also be validated once Cloudflare detects that the Custom Hostname is a CNAME record pointing to the fallback record configured for the SSL for SaaS domain. Though this is the simplest validation method, it increases the risk of errors. Since a CNAME record would also route traffic to Cloudflares edge, traffic may reach our edge before the Custom Hostname has completed validation or the SSL certificate has issued.\n\nOnce you have tested and added the hostname validation step to your Custom Hostname creation process, please contact your account team to schedule a date to migrate your SSL for SaaS v1 zones. Your account team will work with you to validate your existing Custom Hostnames without downtime.\n\n## If you are using BYOIP or Apex Proxying:\n\nBoth BYOIP addresses and IP addresses configured for Apex Proxying allow for hostname validation to complete successfully by having either a BYOIP address or an Apex Proxy IP address as the target of a DNS A record for a custom hostname.\n\n## What is available in the new version of SSL for SaaS?\n\nSSL for SaaS v2 is functionally equivalent to SSL for SaaS v1, but removes the requirements to use specific anycast IP addresses at Cloudflares edge and Cloudflares Universal SSL product with the SSL for SaaS zone.\n\nNote\n\nSSL for SaaS v2 is now called Cloudflare for SaaS.\n\n## What happens during the migration?\n\nOnce the migration has been started for your zone(s), Cloudflare will require every Custom Hostname to pass a hostname verification check. Existing Custom Hostnames that are proxying to Cloudflare with a DNS CNAME record will automatically re-validate and migrate to the new version with no downtime. Any Custom Hostnames created after the start of the migration will need to pass the hostname validation check using one of the validation methods mentioned above.\n\nNote\n\nYou can revert the migration at any time.\n\n### Before the migration\n\nBefore your migration, you should:\n\n1. To test validation methods, set up a test zone and ask your account team to enable SSL for SaaS v2.\n\n2. Wait for your account team to run our pre-migration tool. This tool groups your hostnames into one of the following statuses:\n\n   * `test_pending`: In the process of being verified or was unable to be verified and re-queued for verification. A custom hostname will be re-queued 25 times before moving to the `test_failed` status.\n   * `test_active`: Passed CNAME verification\n   * `test_active_apex`: Passed Apex Proxy verification\n   * `test_blocked`: Hostname will be blocked during the migration because hostname belongs to a banned zone. Contact your account team to verify banned custom hostnames and proceed with the migration.\n   * `test_failed`: Failed hostname verification 25 times\n\n3. Review the results of our pre-migration tool (run by your account team) using one of the following methods:\n\n   * Via the API: `https://api.cloudflare.com/client/v4/zones/{zone_tag}/custom_hostnames?hostname_status={status}`\n   * Via a CSV file (provided by your account team)\n   * Via the Cloudflare dashboard: ![Review SSL migration status in the dashboard](https://developers.cloudflare.com/_astro/ssl-migration-status.CLPmua84_ZdTqFL.webp)\n\n4. Approve the migration. Your account team will work with you to schedule a migration window for each of your SSL for SaaS zones.\n\n## During the migration\n\nAfter the migration has started and has had some time to progress, Cloudflare will generate a list of Custom Hostnames that failed to migrate and ask for your approval to complete the migration. When you give your approval, the migration will be complete, SSL for SaaS v1 will be disabled for the zone, and any Custom Hostname that has not completed hostname validation will no longer function.\n\nThe migration timeline depends on the number of Custom Hostnames. For example, if a zone has fewer than 10,000 Custom Hostnames, the list can be generated around an hour after beginning the migration. If a zone has millions of Custom Hostnames, it may take up to 24 hours to identify instances that failed to successfully migrate.\n\nWhen your account team asks for approval to complete the migration, please respond in a timely manner. You will have **two weeks** to validate any remaining Custom Hostnames before they are systematically deleted.\n\n## When is the migration?\n\nThe migration process starts on March 31, 2021 and will continue until final deprecation on September 1, 2021.\n\nIf you would like to begin the migration process before March 31, 2021, please contact your account team and they will work with you to expedite the process. Otherwise, your account team will reach out to you with a time for a migration window so that your zones are migrated before **September 1, 2021** end-of-life date.\n\n## What if I have additional questions?\n\nIf you have any questions, please contact your account team or [SaaSv2@cloudflare.com](mailto:saasv2@cloudflare.com).\n\n</page>\n\n<page>\n---\ntitle: How Orange-to-Orange (O2O) works  Cloudflare for Platforms docs\ndescription: \"Orange-to-Orange (O2O) is a specific traffic routing configuration\n  where traffic routes through two Cloudflare zones: the first Cloudflare zone\n  is owned by customer 1 and the second Cloudflare zone is owned by customer 2,\n  who is considered a SaaS provider.\"\nlastUpdated: 2025-12-02T11:50:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/how-it-works/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/how-it-works/index.md\n---\n\nOrange-to-Orange (O2O) is a specific traffic routing configuration where traffic routes through two Cloudflare zones: the first Cloudflare zone is owned by customer 1 and the second Cloudflare zone is owned by customer 2, who is considered a SaaS provider.\n\nIf one or more hostnames are onboarded to a SaaS Provider that uses Cloudflare products as part of their platform - specifically the [Cloudflare for SaaS product](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/) - those hostnames will be created as [custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/) in the SaaS Provider's zone.\n\nTo give the SaaS provider permission to route traffic through their zone, any custom hostname must be activated by you (the SaaS customer) by placing a [CNAME record](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#3-have-customer-create-cname-record) on your authoritative DNS. If your authoritative DNS is Cloudflare, you have the option to [proxy](https://developers.cloudflare.com/fundamentals/concepts/how-cloudflare-works/#application-services) your CNAME record, achieving an Orange-to-Orange setup.\n\n## Prerequisites\n\n* O2O only applies when the two zones are part of different Cloudflare accounts.\n* Since O2O is based on CNAME, it does not apply when an A record is used to point to the SaaS provider's ([apex proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/)).\n\n## With O2O\n\nIf you have your own Cloudflare zone (`example.com`) and your zone contains a [proxied DNS record](https://developers.cloudflare.com/dns/proxy-status/) matching the custom hostname (`mystore.example.com`) with a **CNAME** target defined by the SaaS Provider, then O2O will be enabled.\n\nDNS management for **example.com**\n\n| **Type** | **Name** | **Target** | **Proxy status** |\n| - | - | - | - |\n| `CNAME` | `mystore` | `customers.saasprovider.com` | Proxied |\n\nWith O2O enabled, the settings configured in your Cloudflare zone will be applied to the traffic first, and then the settings configured in the SaaS provider's zone will be applied to the traffic second.",
      "language": "unknown"
    },
    {
      "code": "## Without O2O\n\nIf you do not have your own Cloudflare zone and have only onboarded one or more of your hostnames to a SaaS Provider, then O2O will not be enabled.\n\nWithout O2O enabled, the settings configured in the SaaS Provider's zone will be applied to the traffic.",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Product compatibility  Cloudflare for Platforms docs\ndescription: As a general rule, settings on the customer zone will override\n  settings on the SaaS zone. In addition, Orange-to-Orange does not permit\n  traffic directed to a custom hostname zone into another custom hostname zone.\nlastUpdated: 2025-09-15T16:47:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/product-compatibility/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/product-compatibility/index.md\n---\n\nAs a general rule, settings on the customer zone will override settings on the SaaS zone. In addition, [Orange-to-Orange](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/) does not permit traffic directed to a custom hostname zone into another custom hostname zone.\n\nThe following table provides a list of compatibility guidelines for various Cloudflare products and features.\n\nNote\n\nThis is not an exhaustive list of Cloudflare products and features.\n\n| Product | Customer zone | SaaS provider zone | Notes |\n| - | - | - | - |\n| [Access](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/secure-with-access/) | Yes | Yes | |\n| [API Shield](https://developers.cloudflare.com/api-shield/) | Yes | No | |\n| [Argo Smart Routing](https://developers.cloudflare.com/argo-smart-routing/) | No | Yes | Customer zones can still use Smart Routing for non-O2O traffic. |\n| [Bot Management](https://developers.cloudflare.com/bots/plans/bm-subscription/) | Yes | Yes | |\n| [Browser Integrity Check](https://developers.cloudflare.com/waf/tools/browser-integrity-check/) | Yes | Yes | |\n| [Cache](https://developers.cloudflare.com/cache/) | Yes\\* | Yes | Though caching is possible on a customer zone, it is generally discouraged (especially for HTML). Your SaaS provider likely performs its own caching outside of Cloudflare and caching on your zone might lead to out-of-sync or stale cache states. Customer zones can still cache content that are not routed through a SaaS provider's zone. |\n| [China Network](https://developers.cloudflare.com/china-network/) | No | No | |\n| [DNS](https://developers.cloudflare.com/dns/) | Yes\\* | Yes | As a SaaS customer, do not remove the records related to your Cloudflare for SaaS setup. Otherwise, your traffic will begin routing away from your SaaS provider. |\n| [HTTP/2 prioritization](https://blog.cloudflare.com/better-http-2-prioritization-for-a-faster-web/) | Yes | Yes\\* | This feature must be enabled on the customer zone to function. |\n| [Image resizing](https://developers.cloudflare.com/images/transform-images/) | Yes | Yes | |\n| IPv6 | Yes | Yes | |\n| [IPv6 Compatibility](https://developers.cloudflare.com/network/ipv6-compatibility/) | Yes | Yes\\* | If the customer zone has **IPv6 Compatibility** enabled, generally the SaaS zone should as well. If not, make sure the SaaS zone enables [Pseudo IPv4](https://developers.cloudflare.com/network/pseudo-ipv4/). |\n| [Load Balancing](https://developers.cloudflare.com/load-balancing/) | No | Yes | Customer zones can still use Load Balancing for non-O2O traffic. |\n| [Page Rules](https://developers.cloudflare.com/rules/page-rules/) | Yes\\* | Yes | Page Rules that match the subdomain used for O2O may block or interfere with the flow of visitors to your website. |\n| [Mirage](https://developers.cloudflare.com/speed/optimization/images/mirage/) (deprecated) | Yes | Yes | |\n| [Origin Rules](https://developers.cloudflare.com/rules/origin-rules/) | Yes | Yes | Enterprise zones can configure Origin Rules, by setting the Host Header and DNS Overrides to direct traffic to a SaaS zone. |\n| [Page Shield](https://developers.cloudflare.com/page-shield/) | Yes | Yes | |\n| [Polish](https://developers.cloudflare.com/images/polish/) | Yes\\* | Yes | Polish only runs on cached assets. If the customer zone is bypassing cache for SaaS zone destined traffic, then images optimized by Polish will not be loaded from origin. |\n| [Rate Limiting](https://developers.cloudflare.com/waf/rate-limiting-rules/) | Yes\\* | Yes | Rate Limiting rules that match the subdomain used for O2O may block or interfere with the flow of visitors to your website. |\n| [Rocket Loader](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/) | No | No | |\n| [Security Level](https://developers.cloudflare.com/waf/tools/security-level/) | Yes | Yes | |\n| [Spectrum](https://developers.cloudflare.com/spectrum/) | No | No | |\n| [Transform Rules](https://developers.cloudflare.com/rules/transform/) | Yes\\* | Yes | Transform Rules that match the subdomain used for O2O may block or interfere with the flow of visitors to your website. |\n| [WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/) | Yes | Yes | WAF custom rules that match the subdomain used for O2O may block or interfere with the flow of visitors to your website. |\n| [WAF managed rules](https://developers.cloudflare.com/waf/managed-rules/) | Yes | Yes | |\n| [Waiting Room](https://developers.cloudflare.com/waiting-room/) | Yes | Yes | |\n| [WebSockets](https://developers.cloudflare.com/network/websockets/) | No | No | |\n| [Workers](https://developers.cloudflare.com/workers/) | Yes\\* | Yes | Similar to Page Rules, Workers that match the subdomain used for O2O may block or interfere with the flow of visitors to your website. |\n| [Zaraz](https://developers.cloudflare.com/zaraz/) | Yes | No | |\n\n</page>\n\n<page>\n---\ntitle: Provider guides  Cloudflare for Platforms docs\ndescription: Learn how to configure your Enterprise zone on several SaaS providers.\nlastUpdated: 2024-09-20T16:41:42.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/index.md\n---\n\n* [BigCommerce](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/bigcommerce/)\n* [HubSpot](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/hubspot/)\n* [Kinsta](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/kinsta/)\n* [Render](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/render/)\n* [Salesforce Commerce Cloud](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/salesforce-commerce-cloud/)\n* [Shopify](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/shopify/)\n* [Webflow](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/webflow/)\n* [WP Engine](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/wpengine/)\n\n</page>\n\n<page>\n---\ntitle: Remove domain from SaaS provider  Cloudflare for Platforms docs\ndescription: If your SaaS domain is also a domain using Cloudflare, you can use\n  your Cloudflare DNS to remove your domain from your SaaS provider.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/remove-domain/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/remove-domain/index.md\n---\n\nIf your SaaS domain is also a [domain using Cloudflare](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/), you can use your Cloudflare DNS to remove your domain from your SaaS provider.\n\nThis means that - if you [remove the DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#delete-dns-records) pointing to your SaaS provider - Cloudflare will stop routing domain traffic through your SaaS provider and the associated custom hostname will enter a **Moved** state.\n\nThis also means that you need to keep DNS records pointing to your SaaS provider for as long as you are a customer. Otherwise, you could accidentally remove your domain from their services.\n\n</page>\n\n<page>\n---\ntitle: Certificate management  Cloudflare for Platforms docs\ndescription: Cloudflare for SaaS takes away the burden of certificate issuance\n  and management from you, as the SaaS provider, by proxying traffic through\n  Cloudflare's edge. You can choose between Cloudflare managing all the\n  certificate issuance and renewals on your behalf, or maintain control over\n  your TLS private keys by uploading your customers' own certificates.\nlastUpdated: 2024-09-20T16:41:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/index.md\n---\n\nCloudflare for SaaS takes away the burden of certificate issuance and management from you, as the SaaS provider, by proxying traffic through Cloudflare's edge. You can choose between Cloudflare managing all the certificate issuance and renewals on your behalf, or maintain control over your TLS private keys by uploading your customers' own certificates.\n\n## Resources\n\n* [Certificate statuses](https://developers.cloudflare.com/ssl/reference/certificate-statuses/)\n* [Issue and validate certificates](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/)\n* [TLS Management](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/)\n* [Custom certificates](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/custom-certificates/)\n* [Webhook definitions](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/webhook-definitions/)\n\n</page>\n\n<page>\n---\ntitle: Secure with Cloudflare Access  Cloudflare for Platforms docs\ndescription: Cloudflare Access provides visibility and control over who has\n  access to your custom hostnames. You can allow or block users based on\n  identity, device posture, and other Access rules.\nlastUpdated: 2025-10-24T20:47:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/secure-with-access/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/secure-with-access/index.md\n---\n\nCloudflare Access provides visibility and control over who has access to your [custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/). You can allow or block users based on identity, device posture, and other [Access rules](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/).\n\n## Prerequisites\n\n* You must have an active custom hostname. For setup instructions, refer to [Configuring Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/).\n* You must have a Cloudflare Zero Trust plan in your SaaS provider account. Learn more about [getting started with Zero Trust](https://developers.cloudflare.com/cloudflare-one/setup/).\n* You can only run Access on custom hostnames if they are managed externally to Cloudflare or in a separate Cloudflare account. If the custom hostname zone is in the same account as the SaaS zone, the Access application will not be applied.\n\n## Setup\n\n1. At your SaaS provider account, select [Zero Trust](https://one.dash.cloudflare.com).\n2. Go to **Access** > **Applications**.\n3. Select **Add an application** and, for type of application, select **Self-hosted**.\n4. Enter a name for your Access application and, in **Session Duration**, choose how often the user's [application token](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/) should expire.\n5. Select **Add public hostname**.\n6. For **Input method**, select *Custom*.\n7. In **Hostname**, enter your custom hostname (for example, `mycustomhostname.com`).\n8. Follow the remaining [self-hosted application creation steps](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) to publish the application.\n\n</page>\n\n<page>\n---\ntitle: WAF for SaaS  Cloudflare for Platforms docs\ndescription: Web Application Firewall (WAF) allows you to create additional\n  security measures through Cloudflare. As a SaaS provider, you can link custom\n  rules, rate limiting rules, and managed rules to your custom hostnames. This\n  provides more control to keep your domains safe from malicious traffic.\nlastUpdated: 2025-10-30T10:25:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/waf-for-saas/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/waf-for-saas/index.md\n---\n\n[Web Application Firewall (WAF)](https://developers.cloudflare.com/waf/) allows you to create additional security measures through Cloudflare. As a SaaS provider, you can link custom rules, rate limiting rules, and managed rules to your custom hostnames. This provides more control to keep your domains safe from malicious traffic.\n\nAs a SaaS provider, you may want to apply different security measures to different custom hostnames. With WAF for SaaS, you can create multiple WAF configuration that you can apply to different sets of custom hostnames. This added flexibility and security leads to optimal protection across the domains of your end customers.\n\n***\n\n## Prerequisites\n\nBefore you can use WAF for SaaS, you need to create a custom hostname. Review [Get started with Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/) if you have not already done so.\n\nYou can also create a custom hostname through the API:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "## 1. Associate custom metadata to a custom hostname\n\nTo apply WAF to your custom hostname, you need to create an association between your customer's domain and the WAF configuration that you would like to attach to it. Cloudflare's product, [custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/) allows you to do this via the API.\n\n1. [Locate your zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/), available in the Cloudflare dashboard.\n\n2. Locate your Authentication Key on the [**API Tokens**](https://dash.cloudflare.com/?to=/:account/profile/api-tokens) page, under **Global API Key**.\n\n3. Locate your custom hostname ID by making a `GET` call in the API:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`\n* `SSL and Certificates Read`",
      "language": "unknown"
    },
    {
      "code": "1. Plan your [custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/). It is fully customizable. In the example below, we have chosen the tag `\"security_level\"` to which we expect to assign three values (low, medium, and high).\n\nNote\n\nOne instance of low, medium, and high rules could be rate limiting. You can specify three different thresholds: low - 100 requests/minute, medium - 85 requests/minute, high - 50 requests/minute, for example. Another possibility is a WAF custom rule in which low challenges requests and high blocks them.\n\n1. Make an API call in the format below using your Cloudflare email and the IDs gathered above:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "This assigns custom metadata to your custom hostname so that it has a security tag associated with its ID.\n\n## 2. Trigger security products based on tags\n\n1. Locate the custom metadata field in the Ruleset Engine where the WAF runs. This can be used to trigger different configurations of products such as [WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/), [rate limiting rules](https://developers.cloudflare.com/waf/rate-limiting-rules/), and [Transform Rules](https://developers.cloudflare.com/rules/transform/).\n\n2. Build your rules either [through the dashboard](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/) or via the API. An example rate limiting rule, corresponding to `\"security_level\"` low, is shown below as an API call.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "To build rules through the dashboard:\n\n1. In the Cloudflare dashboard, go to the **WAF** page.\n\n   [Go to **WAF**](https://dash.cloudflare.com/?to=/:account/application-security/waf)\n\n2. Follow the instructions on the dashboard specific to custom rules, rate limiting rules, or managed rules, depending on your security goal.\n\n3. Once the rule is active, you should see it under the applicable tab (custom rules, rate limiting, or managed rules).\n\n   Warning\n\n   This API call will replace any existing rate limiting rules in the zone.\n\n</page>\n\n<page>\n---\ntitle: Advanced Settings  Cloudflare for Platforms docs\nlastUpdated: 2024-09-20T16:41:42.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/index.md\n---\n\n* [Apex proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/)\n* [Regional Services for SaaS](https://developers.cloudflare.com/data-localization/how-to/cloudflare-for-saas/)\n* [Custom origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/)\n* [Workers as your fallback origin](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/worker-as-origin/)\n\n</page>\n\n<page>\n---\ntitle: Common API Calls  Cloudflare for Platforms docs\ndescription: As a SaaS provider, you may want to configure and manage Cloudflare\n  for SaaS via the API rather than the Cloudflare dashboard. Below are relevant\n  API calls for creating, editing, and deleting custom hostnames, as well as\n  monitoring, updating, and deleting fallback origins. Further details can be\n  found in the Cloudflare API documentation.\nlastUpdated: 2024-12-16T22:33:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/common-api-calls/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/common-api-calls/index.md\n---\n\nAs a SaaS provider, you may want to configure and manage Cloudflare for SaaS [via the API](https://developers.cloudflare.com/api/) rather than the [Cloudflare dashboard](https://dash.cloudflare.com/). Below are relevant API calls for creating, editing, and deleting custom hostnames, as well as monitoring, updating, and deleting fallback origins. Further details can be found in the [Cloudflare API documentation](https://developers.cloudflare.com/api/).\n\n***\n\n## Custom hostnames\n\n| Endpoint | Notes |\n| - | - |\n| [List custom hostnames](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/list/) | Use the `page` parameter to pull additional pages. Add a `hostname` parameter to search for specific hostnames. |\n| [Create custom hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/) | In the `validation_records` object of the response, use the `txt_name` and `txt_record` listed to validate the custom hostname. |\n| [Custom hostname details](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/get/) | |\n| [Edit custom hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/edit/) | When sent with an `ssl` object that matches the existing value, indicates that hostname should restart domain control validation (DCV). |\n| [Delete custom hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/delete/) | Also deletes any associated SSL/TLS certificates. |\n\n## Fallback origins\n\nOur API includes the following endpoints related to the [fallback origin](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#1-create-fallback-origin) of a custom hostname:\n\n* [Get fallback origin](https://developers.cloudflare.com/api/resources/custom_hostnames/subresources/fallback_origin/methods/get/)\n* [Update fallback origin](https://developers.cloudflare.com/api/resources/custom_hostnames/subresources/fallback_origin/methods/update/)\n* [Remove fallback origin](https://developers.cloudflare.com/api/resources/custom_hostnames/subresources/fallback_origin/methods/delete/)\n\n</page>\n\n<page>\n---\ntitle: Enable Cloudflare for SaaS  Cloudflare for Platforms docs\ndescription: \"To enable Cloudflare for SaaS for your account:\"\nlastUpdated: 2025-10-30T10:25:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/enable/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/enable/index.md\n---\n\nTo enable Cloudflare for SaaS for your account:\n\n1. In the Cloudflare dashboard, go to the **Custom Hostnames** page.\n\n   [Go to **Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames)\n\n2. Select **Enable**.\n\n3. The next step depends on the zone's plan:\n\n   * **Enterprise**: Can preview this product as a [non-contract service](https://developers.cloudflare.com/billing/preview-services/), which provide full access, free of metered usage fees, limits, and certain other restrictions.\n   * **Non-enterprise**: Will have to enter payment information.\n\nNote\n\nDifferent zone plan levels have access to different features. For more details, refer to [Plans](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/plans/).\n\n</page>\n\n<page>\n---\ntitle: Configuring Cloudflare for SaaS  Cloudflare for Platforms docs\ndescription: Get started with Cloudflare for SaaS\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/index.md\n---\n\n***\n\n## Before you begin\n\nBefore you start creating custom hostnames:\n\n1. [Add](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/) your zone to Cloudflare on a Free plan.\n2. [Enable](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/enable/) Cloudflare for SaaS for your zone.\n3. Review the [Hostname prioritization guidelines](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/#hostname-priority). Wildcard custom hostnames behave differently than an exact hostname match.\n4. (optional) Review the following documentation:\n\n* [API documentation](https://developers.cloudflare.com/fundamentals/api/) (if you have not worked with the Cloudflare API before).\n* [Certificate validation](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/).\n\n***\n\n## Initial setup\n\nWhen you first [enable](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/enable/) Cloudflare for SaaS, you need to perform a few steps prior to creating any custom hostnames.\n\n\n\n### 1. Create fallback origin\n\nThe fallback origin is where Cloudflare will route traffic sent to your custom hostnames (must be proxied).\n\nNote\n\nTo route custom hostnames to distinct origins, refer to [custom origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/).\n\nTo create your fallback origin:\n\n1. [Create](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records) a proxied `A`, `AAAA`, or `CNAME` record pointing to the IP address of your fallback origin (where Cloudflare will send custom hostname traffic).\n\n| **Type** | **Name** | **IPv4 address** | **Proxy status** |\n| - | - | - | - |\n| `A` | `proxy-fallback` | `192.0.2.1` | Proxied |\n\n1. Designate that record as your fallback origin.\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Custom Hostnames** page.\n\n     [Go to **Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames)\n\n  2. For **Fallback Origin**, enter the hostname for your fallback origin.\n\n  3. Select **Add Fallback Origin**.\n\n* API\n\n  Using the hostname of the record you just created, [update the fallback origin value](https://developers.cloudflare.com/api/resources/custom_hostnames/subresources/fallback_origin/methods/update/).\n\n1. Once you have added the fallback origin, confirm that its status is **Active**.\n\nNote\n\nWhen Cloudflare marks your fallback origin as **Active**, that only reflects that we are ready to send traffic to that DNS record.\n\nYou need to make sure your DNS record is sending traffic to the correct origin location.\n\n### 2. (Optional) Create CNAME target\n\nThe CNAME target  optional, but highly encouraged  provides a friendly and more flexible place for customers to [route their traffic](#3-have-customer-create-cname-record). You may want to use a subdomain such as `customers.<SAAS_PROVIDER>.com`.\n\n[Create](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records) a proxied CNAME that points your CNAME target to your fallback origin (can be a wildcard such as `*.customers.saasprovider.com`).\n\n| **Type** | **Name** | **Target** | **Proxy status** |\n| - | - | - | - |\n| `CNAME` | `.customers` | `proxy-fallback.saasprovider.com` | Proxied |\n\n***\n\n## Per-hostname setup\n\nYou need to perform the following steps for each custom hostname.\n\n### 1. Plan for validation\n\nBefore you create a hostname, you need to plan for:\n\n1. [Certificate validation](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/): Upon successful validation, the certificates are deployed to Cloudflares global network.\n2. [Hostname validation](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/): Upon successful validation, Cloudflare proxies traffic for this hostname.\n\nYou must complete both these steps for the hostname to work as expected.\n\nNote\n\nDepending on which method you select for each of these options, additional steps might be required for you and your customers.\n\n### 2. Create custom hostname\n\nAfter planning for certification and hostname validation, you can create the custom hostname.\n\nZone name restriction\n\nDo not configure a custom hostname which matches the zone name. For example, if your SaaS zone is `example.com`, do not create a custom hostname named `example.com`.\n\nTo create a custom hostname:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Custom Hostnames** page.\n\n     [Go to **Custom Hostnames**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/custom-hostnames)\n\n  2. Select **Add Custom Hostname**.\n\n  3. Add your customer's hostname `app.customer.com` and set the relevant options, including:\n\n     * The [minimum TLS version](https://developers.cloudflare.com/ssl/reference/protocols/).\n     * Defining whether you want to use a certificate provided by Cloudflare or [upload a custom certificate](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/custom-certificates/uploading-certificates/).\n     * Selecting the [certificate authority (CA)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) that will issue the certificate.\n     * Choosing the [validation method](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/).\n     * Whether you want to **Enable wildcard**, which adds a `*.<custom-hostname>` SAN to the custom hostname certificate. For more details, refer to [Hostname priority](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/#hostname-priority).\n     * Choosing a value for [Custom origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/).\n\n  4. Select **Add Custom Hostname**.\n\n  Default behavior\n\n  When you create a custom hostname:\n\n  * If you issue a custom hostname certificate with wildcards enabled, you cannot customize TLS settings for these wildcard hostnames.\n  * If you do not specify the **Minimum TLS Version**, it defaults to the zone's Minimum TLS Version. You can still [edit this setting](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/#minimum-tls-version) after creation.\n\n* API\n\n  1. To create a custom hostname using the API, use the [Create Custom Hostname](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/create/) endpoint.\n\n     * You can leave the `certificate_authority` parameter empty to set it to \"default CA\". With this option, Cloudflare checks the CAA records before requesting the certificates, which helps ensure the certificates can be issued from the CA.\n\n  2. For the newly created custom hostname, the `POST` response may not return the DCV validation token `validation_records`. It is recommended to make a second [`GET` command](https://developers.cloudflare.com/api/resources/custom_hostnames/methods/list/) (with a delay) to retrieve these details.\n\n  The response contains the complete definition of the new custom hostname.\n\n  Default behavior\n\n  When you create a custom hostname:\n\n  * If you issue a custom hostname certificate with wildcards enabled, you cannot customize TLS settings for these wildcard hostnames.\n  * If you do not specify the **Minimum TLS Version**, it defaults to the zone's Minimum TLS Version. You can still [edit this setting](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/#minimum-tls-version) after creation.\n\nNote\n\nFor each custom hostname, Cloudflare issues two certificates bundled in chains that maximize browser compatibility (unless you [upload custom certificates](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/custom-certificates/uploading-certificates/)).\n\nThe primary certificate uses a `P-256` key, is `SHA-2/ECDSA` signed, and will be presented to browsers that support elliptic curve cryptography (ECC). The secondary or fallback certificate uses an `RSA 2048-bit` key, is `SHA-2/RSA` signed, and will be presented to browsers that do not support ECC.\n\n### 3. Have customer create CNAME record\n\nTo finish the custom hostname setup, your customer needs to set up a CNAME record at their authoritative DNS that points to your [CNAME target](#2-optional-create-cname-target) [1](#user-content-fn-1).\n\nWarning\n\nBefore your customer does this step, confirm that the hostname's **Certificate status** and **Hostname status** are both **Active**.\n\nIf not, confirm that you are using a method of [certificate](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/validate-certificates/http/#http-automatic) or [hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/hostname-validation/realtime-validation/) validation that occurs after your customer adds their DNS record.\n\nYour customer's CNAME record might look like the following:",
      "language": "unknown"
    },
    {
      "code": "This record would route traffic in the following way:",
      "language": "unknown"
    },
    {
      "code": "Requests to `mystore.example.com` would go to your CNAME target (`customers.saasprovider.com`), which would then route to your fallback origin (`proxy-fallback.saasprovider.com`).\n\nWarning\n\nIf your customer needs to use an A record to point to the SaaS target, you will need to get [apex proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/). By default, using an A record to point to the target is not a supported setup.\n\n#### Service continuation\n\nIf your customer is also using Cloudflare for their domain, they should keep their DNS record pointing to your SaaS provider in place for as long as they want to use your service.\n\nFor more details, refer to [Remove custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/remove-custom-hostnames/).\n\n## Footnotes\n\n1. If you have [regional services](https://developers.cloudflare.com/data-localization/regional-services/) set up for your custom hostnames, Cloudflare always uses the processing region associated with your DNS target record (instead of the processing region of any [custom origins](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/)).\n\n   [](#user-content-fnref-1)\n\n</page>\n\n<page>\n---\ntitle: Bindings  Cloudflare for Platforms docs\ndescription: When you deploy User Workers through Workers for Platforms, you can\n  attach bindings to give them access to resources like KV namespaces, D1\n  databases, R2 buckets, and more. This enables your end customers to build more\n  powerful applications without you having to build the infrastructure\n  components yourself.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\ntags: Bindings\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/bindings/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/bindings/index.md\n---\n\nWhen you deploy User Workers through Workers for Platforms, you can attach [bindings](https://developers.cloudflare.com/workers/runtime-apis/bindings/) to give them access to resources like [KV namespaces](https://developers.cloudflare.com/kv/), [D1 databases](https://developers.cloudflare.com/d1/), [R2 buckets](https://developers.cloudflare.com/r2/), and more. This enables your end customers to build more powerful applications without you having to build the infrastructure components yourself.\n\nWith bindings, each of your users can have their own:\n\n* [KV namespace](https://developers.cloudflare.com/kv/) that they can use to store and retrieve data\n* [R2 bucket](https://developers.cloudflare.com/r2/) that they can use to store files and assets\n* [Analytics Engine](https://developers.cloudflare.com/analytics/analytics-engine/) dataset that they can use to collect observability data\n* [Durable Objects](https://developers.cloudflare.com/durable-objects/) class that they can use for stateful coordination\n\n#### Resource isolation\n\nEach User Worker can only access the bindings that are explicitly attached to it. For complete isolation, you can create and attach a unique resource (like a D1 database or KV namespace) to every User Worker.\n\n![Resource Isolation Model](https://developers.cloudflare.com/_astro/programmable-platforms-5.B2yd7IjV_Z1gqk3t.svg)\n\n## Adding a KV Namespace to a User Worker\n\nThis example walks through how to create a [KV namespace](https://developers.cloudflare.com/kv/) and attach it to a User Worker. The same process can be used to attach to other [bindings](https://developers.cloudflare.com/workers/runtime-apis/bindings/).\n\n### 1. Create a KV namespace\n\nCreate a KV namespace using the [Cloudflare API](https://developers.cloudflare.com/api/resources/kv/subresources/namespaces/methods/bulk_update/).\n\n### 2. Attach the KV namespace to the User Worker\n\nUse the [Upload User Worker API](https://developers.cloudflare.com/api/resources/workers_for_platforms/subresources/dispatch/subresources/namespaces/subresources/scripts/methods/update/) to attach the KV namespace binding to the Worker. You can do this when you're first uploading the Worker script or when updating an existing Worker.\n\nNote\n\nWhen using the API to upload scripts, bindings must be specified in the `metadata` object of your multipart upload request. You cannot upload the `wrangler.toml` file as a module to configure the bindings. For more details about multipart uploads, see [Multipart upload metadata](https://developers.cloudflare.com/workers/configuration/multipart-upload-metadata/).\n\n##### Example API request",
      "language": "unknown"
    },
    {
      "code": "Now, the User Worker has can access the `USER_KV` binding through the `env` argument using `env.USER_DATA.get()`, `env.USER_DATA.put()`, and other KV methods.\n\nNote: If you plan to add new bindings to the Worker, use the `keep_bindings` parameter to ensure existing bindings are preserved while adding new ones.",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Custom limits  Cloudflare for Platforms docs\ndescription: Custom limits allow you to programmatically enforce limits on your\n  customers' Workers' resource usage. You can set limits for the maximum CPU\n  time and number of subrequests per invocation. If a user Worker hits either of\n  these limits, the user Worker will immediately throw an exception.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/index.md\n---\n\nCustom limits allow you to programmatically enforce limits on your customers' Workers' resource usage. You can set limits for the maximum CPU time and number of subrequests per invocation. If a user Worker hits either of these limits, the user Worker will immediately throw an exception.\n\n## Set Custom limits\n\nCustom limits can be set in the dynamic dispatch Worker:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Dynamic dispatch Worker  Cloudflare for Platforms docs\ndescription: A dynamic dispatch Worker is a specialized routing Worker that\n  directs incoming requests to the appropriate user Workers in your dispatch\n  namespace. Instead of using Workers Routes, dispatch Workers let you\n  programmatically control request routing through code.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/dynamic-dispatch/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/dynamic-dispatch/index.md\n---\n\nA [dynamic dispatch Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/how-workers-for-platforms-works/#dynamic-dispatch-worker) is a specialized routing Worker that directs incoming requests to the appropriate user Workers in your dispatch namespace. Instead of using [Workers Routes](https://developers.cloudflare.com/workers/configuration/routing/routes/), dispatch Workers let you programmatically control request routing through code.\n\n![Figure 1: Workers for Platforms: Main Flow](https://developers.cloudflare.com/_astro/programmable-platforms-1.BCCEhzLr_Z2oGmWd.svg)\n\nNote\n\nYou can also create a dispatch Worker from the Cloudflare dashboard. Go to **Workers for Platforms**, select your namespace, and click **Create** > **Dispatch Worker**. The dashboard provides templates for path-based and subdomain-based routing.\n\n#### Why use a dynamic dispatch Worker?\n\n* **Scale**: Route requests to millions of hostnames to different Workers, without defining [Workers Routes](https://developers.cloudflare.com/workers/configuration/routing/routes/) configuration for each one\n\n* **Custom routing logic**: Write code to determine exactly how requests should be routed. For example:\n\n  * Store hostname-to-Worker mappings in [Workers KV](https://developers.cloudflare.com/kv/) and look them up dynamically\n  * Route requests based on subdomain, path, headers, or other request properties\n  * Use [custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/) attached to [custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/) for routing decisions\n\n* **Add platform functionality**: Build additional features at the routing layer:\n\n  * Run authentication checks before requests reach user Workers\n  * Remove or add headers or metadata from incoming requests\n  * Attach useful context like user IDs or account information\n  * Transform requests or responses as needed\n\n### Configure the dispatch namespace binding\n\nTo allow your dynamic dispatch Worker to dynamically route requests to Workers in a namespace, you need to configure a dispatch namespace [binding](https://developers.cloudflare.com/workers/runtime-apis/bindings/). This binding enables your dynamic dispatch Worker to call any user Worker within that namespace using `env.dispatcher.get()`.\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "Once the binding is configured, your dynamic dispatch Worker can route requests to any Worker in the namespace. Below are common routing patterns you can implement in your dispatcher.\n\n### Routing examples\n\n![Figure 2: Workers for Platforms: Main Flow](https://developers.cloudflare.com/_astro/programmable-platforms-2.DGAT6ZDR_ZG0FdN.svg)\n\n#### KV-Based Routing\n\nStore the routing mappings in [Workers KV](https://developers.cloudflare.com/kv/). This allows you to modify your routing logic without requiring you to change or redeploy the dynamic dispatch Worker.",
      "language": "unknown"
    },
    {
      "code": "#### Subdomain-Based Routing\n\nRoute subdomains to the corresponding Worker. For example, `my-customer.example.com` will route to the Worker named `my-customer` in the dispatch namespace.",
      "language": "unknown"
    },
    {
      "code": "#### Path-Based routing\n\nRoute URL paths to the corresponding Worker. For example, `example.com/customer-1` will route to the Worker named `customer-1` in the dispatch namespace.",
      "language": "unknown"
    },
    {
      "code": "### Enforce custom limits\n\nUse [custom limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/) to control how much CPU time a given user Worker can use, or how many subrequests it can make. You can set different limits based on customer plan type or other criteria.",
      "language": "unknown"
    },
    {
      "code": "For more details on available limits, refer to [Custom limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/).\n\nTo track limit violations and other metrics across user Workers, use [Workers Analytics Engine](https://developers.cloudflare.com/analytics/analytics-engine/). For detailed logging and debugging, configure a [Tail Worker](https://developers.cloudflare.com/workers/observability/logs/tail-workers/) to capture events from your dispatch Worker.\n\n</page>\n\n<page>\n---\ntitle: Hostname routing  Cloudflare for Platforms docs\ndescription: Learn how to route requests to the dispatch worker.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/hostname-routing/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/hostname-routing/index.md\n---\n\nYou can use [dynamic dispatch](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/dynamic-dispatch/) Workers to route millions of vanity domains or subdomains to Workers without hitting traditional [route limits](https://developers.cloudflare.com/workers/platform/limits/#number-of-routes-per-zone). These hostnames can be subdomains under your managed domain (e.g. `customer1.saas.com`) or vanity domains controlled by your end customers (e.g. `mystore.com`), which can be managed through [custom hostnames](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/).\n\n## (Recommended) Wildcard route with a dispatch Worker\n\nConfigure a wildcard [Route](https://developers.cloudflare.com/workers/configuration/routing/routes/) (`*/*`) on your SaaS domain (the domain where you configure custom hostnames) to point to your dynamic dispatch Worker. This allows you to:\n\n* **Support both subdomains and vanity domains**: Handle `customer1.myplatform.com` (subdomain) and `shop.customer.com` (custom hostname) with the same routing logic.\n* **Avoid route limits**: Instead of creating individual routes for every domain, which can cause you to hit [Routes limits](https://developers.cloudflare.com/workers/platform/limits/#number-of-routes-per-zone), you can handle the routing logic in code and proxy millions of domains to individual Workers.\n* **Programmatically control routing logic**: Write custom code to route requests based on hostname, [custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/), path, or any other properties.\n\nNote\n\nThis will route all traffic inbound to the domain to the dispatch Worker.\n\nIf you'd like to exclude certain hostnames from routing to the dispatch Worker, you can either:\n\n* Add routes without a Worker specification to opt certain hostnames or paths from being executed by the dispatcher Worker (for example, for `saas.com`, `api.saas.com`, etc)\n* Use a [dedicated domain](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/) (for example, `customers.saas.com`) for custom hostname and dispatch worker management to keep the rest of the traffic for that domain separate.\n\n### Setup\n\nTo set up hostname routing with a wildcard route:\n\n1. **Configure custom hostnames**: Set up your domain and custom hostnames using [Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/)\n2. **Set the fallback origin**: Set up a [fallback origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#1-create-fallback-origin), this is where all custom hostnames will be routed to. If youd like to route them to separate origins, you can use a [custom origin server](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/custom-origin/). Requests will route through the Worker before reaching the origin. If the Worker is the origin then place a dummy DNS record for the fallback origin (e.g., `A 192.0.2.0`).\n3. **Configure DNS**: Point DNS records (subdomains or custom hostname) via [CNAME record to the saas domain](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/getting-started/#3-have-customer-create-cname-record). If your customers need to proxy their apex hostname (e.g. `example.com`) and cannot use CNAME records, check out [Apex Proxying](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/start/advanced-settings/apex-proxying/).\n4. **Create wildcard route**: Add a `*/*` route on your platform domain (e.g. saas.com) and associate it with your dispatch Worker.\n5. **Implement dispatch logic**: Add logic to your dispatch Worker to route based on hostname, lookup mappings stored in \\[Workers KV]\\([Workers KV](https://developers.cloudflare.com/kv/)), or use [custom metadata](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/custom-metadata/) attached to custom hostnames.\n\nNote\n\nIf you plan to route requests based on custom metadata, you'll need to create subdomains (e.g. `customer1.saas.com`) as custom hostnames. This is because DNS records do not support custom metadata.\n\n#### Example dispatch Worker",
      "language": "unknown"
    },
    {
      "code": "## Subdomain routing\n\nIf you're only looking to route subdomain records (e.g. `customer1.saas.com`), you can use a more specific route (`*.saas.com/*`) to route requests to your dispatch Worker.\n\n### Setup\n\nTo set up subdomain routing:\n\n1. Create an orange-clouded wildcard DNS record: `*.saas.com` that points to the origin. If the Worker is the origin then you can use a dummy DNS value (for example, `A 192.0.2.0`).\n2. Set wildcard route: `*.saas.com/*` pointing to your dispatch Worker\n3. Add logic to the dispatch Worker to route subdomain requests to the right Worker.\n\n#### Example subdomain dispatch Worker",
      "language": "unknown"
    },
    {
      "code": "### Orange-to-Orange (o2o) Behavior\n\nWhen your customers are also using Cloudflare and point their custom domain to your SaaS domain via CNAME (for example, `mystore.com`  `saas.com`), Worker routing behavior depends on whether the customer's DNS record is proxied (orange cloud) or DNS-only (grey cloud). Learn more about [Orange-to-Orange setups](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/how-it-works/#with-o2o)\n\nThis can cause inconsistent behavior when using specific hostname routes:\n\n* If you're routing based on the CNAME target (`saas.com`), the custom hostname's DNS record must be orange-clouded for the Worker to be invoked.\n* If you're routing based on the custom hostname (`mystore.com`), the customer's record must be grey-clouded for the Worker to be invoked.\n\nSince you may not have control over your customer's DNS proxy settings, we recommend using `*/*` wildcard route to ensure routing logic always works as expected, regardless of how DNS is configured.\n\n#### Worker invocation across route configurations and proxy modes\n\nThe table below shows when Workers are invoked based on your route pattern and the customer's DNS proxy settings:\n\n| Route Pattern | Custom Hostname (Orange Cloud) | Custom Hostname (Grey Cloud) |\n| - | - | - |\n| `*/*` (Recommended) |  |  |\n| Target hostname route |  |  |\n| Custom hostname route |  |  |\n\n</page>\n\n<page>\n---\ntitle: Observability  Cloudflare for Platforms docs\ndescription: Workers for Platforms provides you with logs and analytics that can\n  be used to share data with end users.\nlastUpdated: 2024-09-26T09:08:34.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/observability/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/observability/index.md\n---\n\nWorkers for Platforms provides you with logs and analytics that can be used to share data with end users.\n\n## Logs\n\nLearn how to access logs with Workers for Platforms.\n\n### Workers Trace Events Logpush\n\nWorkers Trace Events logpush is used to get raw Workers execution logs. Refer to [Logpush](https://developers.cloudflare.com/workers/observability/logs/logpush/) for more information.\n\nLogpush can be enabled for an entire dispatch namespace or a single user Worker. To capture logs for all of the user Workers in a dispatch namespace:\n\n1. Create a [Logpush job](https://developers.cloudflare.com/workers/observability/logs/logpush/#create-a-logpush-job).\n2. Enable [logging](https://developers.cloudflare.com/workers/observability/logs/logpush/#enable-logging-on-your-worker) on your dispatch Worker.\n\nEnabling logging on your dispatch Worker collects logs for both the dispatch Worker and for any user Workers in the dispatch namespace. Logs are automatically collected for all new Workers added to a dispatch namespace. To enable logging for an individual user Worker rather than an entire dispatch namespace, skip step 1 and complete step 2 on your user Worker.\n\nAll logs are forwarded to the Logpush job that you have setup for your account. Logpush filters can be used on the `Outcome` or `Script Name` field to include or exclude specific values or send logs to different destinations.\n\n### Tail Workers\n\nA [Tail Worker](https://developers.cloudflare.com/workers/observability/logs/tail-workers/) receives information about the execution of other Workers (known as producer Workers), such as HTTP statuses, data passed to `console.log()` or uncaught exceptions.\n\nUse [Tail Workers](https://developers.cloudflare.com/workers/observability/logs/tail-workers/) instead of Logpush if you want granular control over formatting before logs are sent to their destination to receive [diagnostics channel events](https://developers.cloudflare.com/workers/runtime-apis/nodejs/diagnostics-channel), or if you want logs delivered in real-time.\n\nAdding a Tail Worker to your dispatch Worker collects logs for both the dispatch Worker and for any user Workers in the dispatch namespace. Logs are automatically collected for all new Workers added to a dispatch namespace. To enable logging for an individual user Worker rather than an entire dispatch namespace, add the [Tail Worker configuration](https://developers.cloudflare.com/workers/observability/logs/tail-workers/#configure-tail-workers) directly to the user Worker.\n\n## Analytics\n\nThere are two ways for you to review your Workers for Platforms analytics.\n\n### Workers Analytics Engine\n\n[Workers Analytics Engine](https://developers.cloudflare.com/analytics/analytics-engine/) can be used with Workers for Platforms to provide analytics to end users. It can be used to expose events relating to a Workers invocation or custom user-defined events. Platforms can write/query events by script tag to get aggregates over a users usage.\n\n### GraphQL Analytics API\n\nUse Cloudflares [GraphQL Analytics API](https://developers.cloudflare.com/analytics/graphql-api) to get metrics relating to your Dispatch Namespaces. Use the `dispatchNamespaceName` dimension in the `workersInvocationsAdaptive` node to query usage by namespace.\n\n</page>\n\n<page>\n---\ntitle: Outbound Workers  Cloudflare for Platforms docs\ndescription: Outbound Workers sit between your customer's Workers and the public\n  Internet. They give you visibility into all outgoing fetch() requests from\n  user Workers.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/outbound-workers/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/outbound-workers/index.md\n---\n\nOutbound Workers sit between your customer's Workers and the public Internet. They give you visibility into all outgoing `fetch()` requests from user Workers.\n\n![Outbound Workers diagram information](https://developers.cloudflare.com/_astro/outbound-worker-diagram.BSvN4KG0_Z1b2pcV.webp)\n\n## General Use Cases\n\nOutbound Workers can be used to:\n\n* Log all subrequests to identify malicious domains or usage patterns.\n* Create, allow, or block lists for hostnames requested by user Workers.\n* Configure authentication to your APIs behind the scenes (without end developers needing to set credentials).\n\nNote\n\nWhen an Outbound Worker is enabled, your customer's Worker will no longer be able to use the [`connect() API`](https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/#connect) to create outbound TCP Sockets. This is to ensure all outbound communication goes through the Outbound Worker's `fetch` method.\n\n## Use Outbound Workers\n\nTo use Outbound Workers:\n\n1. Create a Worker intended to serve as your Outbound Worker.\n2. Outbound Worker can be specified as an optional parameter in the [dispatch namespaces](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/dynamic-dispatch/) binding in a project's [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/). Optionally, to pass data from your dynamic dispatch Worker to the Outbound Worker, the variable names can be specified under **parameters**.\n\nMake sure that you have `wrangler@3.3.0` or later [installed](https://developers.cloudflare.com/workers/wrangler/install-and-update/).\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "1. Edit your dynamic dispatch Worker to call the Outbound Worker and declare variables to pass on `dispatcher.get()`.",
      "language": "unknown"
    },
    {
      "code": "1. The Outbound Worker will now be invoked on any `fetch()` requests from a user Worker. The user Worker will trigger a [FetchEvent](https://developers.cloudflare.com/workers/runtime-apis/handlers/fetch/) on the Outbound Worker. The variables declared in the binding can be accessed in the Outbound Worker through `env.<VAR_NAME>`.\n\nThe following is an example of an Outbound Worker that logs the fetch request from user Worker and creates a JWT if the fetch request matches `api.example.com`.",
      "language": "unknown"
    },
    {
      "code": "Note\n\nOutbound Workers do not intercept fetch requests made from [Durable Objects](https://developers.cloudflare.com/durable-objects/) or [mTLS certificate bindings](https://developers.cloudflare.com/workers/runtime-apis/bindings/mtls/).\n\n</page>\n\n<page>\n---\ntitle: Static assets  Cloudflare for Platforms docs\ndescription: Host static assets on Cloudflare's global network and deliver\n  faster load times worldwide with Workers for Platforms.\nlastUpdated: 2025-08-08T14:30:35.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/static-assets/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/static-assets/index.md\n---\n\nWorkers for Platforms lets you deploy front-end applications at scale. By hosting static assets on Cloudflare's global network, you can deliver faster load times worldwide and eliminate the need for external infrastructure. You can also combine these static assets with dynamic logic in Cloudflare Workers, providing a full-stack experience for your customers.\n\n### What you can build\n\n#### Static sites\n\nHost and serve HTML, CSS, JavaScript, and media files directly from Cloudflare's network, ensuring fast loading times worldwide. This is ideal for blogs, landing pages, and documentation sites.\n\n#### Full-stack applications\n\nCombine asset hosting with Cloudflare Workers to power dynamic, interactive applications. Store and retrieve data using Cloudflare KV, D1, and R2 Storage, allowing you to serve both front-end assets and backend logic from a single Worker.\n\n### Benefits\n\n#### Global caching for faster performance\n\nCloudflare automatically caches static assets at data centers worldwide, reducing latency and improving load times by up to 2x for users everywhere.\n\n#### Scalability without infrastructure management\n\nYour applications scale automatically to handle high traffic without requiring you to provision or manage infrastructure. Cloudflare dynamically adjusts to demand in real time.\n\n#### Unified deployment for static and dynamic content\n\nDeploy front-end assets alongside server-side logic, all within Cloudflare Workers. This eliminates the need for a separate hosting provider and ensures a streamlined deployment process.\n\n***\n\n## Deploy static assets to User Workers\n\nIt is common that, as the Platform, you will be responsible for uploading static assets on behalf of your end users. This often looks like this:\n\n1. Your user uploads files (HTML, CSS, images) through your interface.\n2. Your platform interacts with the Workers for Platforms APIs to attach the static assets to the User Worker script.\n\nOnce you receive the static files from your users (for a new or updated site), complete the following steps to attach the files to the corresponding User Worker:\n\n1. Create an Upload Session\n2. Upload file contents\n3. Deploy/Update the Worker\n\nAfter these steps are completed, the User Worker's static assets will be live on the Cloudflare's global network.\n\n### 1. Create an Upload Session\n\nBefore sending any file data, you need to tell Cloudflare which files you intend to upload. That list of files is called a manifest. Each item in the manifest includes:\n\n* A file path (for example, `\"/index.html\"` or `\"/assets/logo.png\"`)\n* A hash (32-hex characters) representing the file contents\n* The file size in bytes\n\nAsset Isolation Considerations\n\nStatic assets uploaded to Workers for Platforms are associated with the namespace rather than with individual User Worker. If multiple User Workers exist under the same namespace, assets with identical hashes may be shared across them. **JWTs should therefore only be shared with trusted platform services and should never be distributed to end-users.**\n\nIf strict isolation of assets is required, we recommend either salting with a random value each time, or incorporating an end-user identifier (for example, account ID or Worker script ID) within the hashing process, to ensure uniqueness. For example, `hash = slice(sha256(accountID + fileContents), 32)`.\n\n#### Example manifest (JSON)",
      "language": "unknown"
    },
    {
      "code": "To start the upload process, send a POST request to the Create Assets Upload Session [API endpoint](https://developers.cloudflare.com/api/resources/workers_for_platforms/subresources/dispatch/subresources/namespaces/subresources/scripts/subresources/asset_upload/methods/create/).",
      "language": "unknown"
    },
    {
      "code": "Path Parameters:\n\n* `namespace`: Name of the Workers for Platforms dispatch namespace\n* `script_name`: Name of the User Worker\n\nIn the request body, include a JSON object listing each file path along with its hash and size. This helps Cloudflare identify which files you intend to upload and allows Cloudflare to check if any of them are already stored.\n\n#### Sample request",
      "language": "unknown"
    },
    {
      "code": "#### Generating the hash\n\nYou can compute a SHA-256 digest of the file contents, then truncate or otherwise represent it consistently as a 32-hex-character string. Make sure to do it the same way each time so Cloudflare can reliably match files across uploads.\n\n#### API Response\n\nIf all the files are already stored on Cloudflare, the response will only return the JWT token. If new or updated files are needed, the response will return:\n\n* `jwt`: An upload token (valid for 1 hour) which will be used in the API request to upload the file contents (Step 2).\n* `buckets`: An array of file-hash groups indicating which files to upload together. Files that have been recently uploaded will not appear in buckets, since Cloudflare already has them.\n\nNote\n\nThis step alone does not store files on Cloudflare. You must upload the actual file data in the next step.\n\n### 2. Upload File Contents\n\nIf the response to the Upload Session API returns `buckets`, that means you have new or changed files that need to be uploaded to Cloudflare.\n\nUse the [Workers Assets Upload API](https://developers.cloudflare.com/api/resources/workers/subresources/assets/subresources/upload/) to transmit the raw file bytes in base64-encoded format for any missing or changed files. Once uploaded, Cloudflare will store these files so they can then be attached to a User Worker.\n\nWarning\n\nAsset uniqueness is determined by the provided hash and are associated globally to their namespace rather than with each specific User Worker. If an asset has already been uploaded for that namespace earlier, Cloudflare will automatically omit sending this asset hash back in the `buckets` response to save you from re-uploading the same thing twice. This means that an asset can be shared between multiple User Workers if it shares the same hash unless you **explicitly make the hash unique**. If you require full isolation between assets across User Workers, incorporate a unique identifier within your asset hashing process (either salting it with something entirely random each time, or by including the end-user account ID or their Worker name to retain per-customer re-use).\n\n#### API Request Authentication\n\nUnlike most Cloudflare API calls that use an account-wide API token in the Authorization header, uploading file contents requires using the short-lived JWT token returned in the `jwt` field of the `assets-upload-session` response.\n\nInclude it as a Bearer token in the header:",
      "language": "unknown"
    },
    {
      "code": "This token is valid for one hour and must be supplied for each upload request to the Workers Assets Upload API.\n\n#### File fields (multipart/form-data)\n\nYou must send the files as multipart/form-data with base64-encoded content:\n\n* Field name: The file hash (for example, `36b8be012ee77df5f269b11b975611d3`)\n* Field value: A Base64-encoded string of the file's raw bytes\n\n#### Example: Uploading multiple files within a single bucket\n\nIf your Upload Session response listed a single \"bucket\" containing two file hashes:",
      "language": "unknown"
    },
    {
      "code": "You can upload both files in one request, each as a form-data field:",
      "language": "unknown"
    },
    {
      "code": "* `<upload-session-token>` is the token from step 1's assets-upload-session response\n* `<BASE64_OF_INDEX_HTML>` is the Base64-encoded content of index.html\n* `<BASE64_OF_STYLES_CSS>` is the Base64-encoded content of styles.css\n\nIf you have multiple buckets (for example, `[[\"hashA\"], [\"hashB\"], [\"hashC\"]]`), you might need to repeat this process for each bucket, making one request per bucket group.\n\nOnce every file in the manifest has been uploaded, a status code of `201` will be returned, with the `jwt` field present. This JWT is a final \"completion\" token which can be used to create a deployment of a Worker with this set of assets. This completion token is valid for 1 hour.",
      "language": "unknown"
    },
    {
      "code": "`<completion-token>` indicates that Cloudflare has successfully received and stored the file contents specified by your manifest. You will use this `<completion-token>` in Step 3 to finalize the attachment of these files to the Worker.\n\n### 3. Deploy the User Worker with static assets\n\nNow that Cloudflare has all the files it needs (from the previous upload steps), you must attach them to the User Worker by making a PUT request to the [Upload User Worker API](https://developers.cloudflare.com/api/resources/workers_for_platforms/subresources/dispatch/subresources/namespaces/subresources/scripts/methods/update/). This final step links the static assets to the User Worker using the completion token you received after uploading file contents.\n\nYou can also specify any optional settings under the `assets.config` field to customize how your files are served (for example, to handle trailing slashes in HTML paths).\n\n#### API request example",
      "language": "unknown"
    },
    {
      "code": "* The `\"jwt\": \"<completion-token>\"` links the newly uploaded files to the Worker\n* Including \"html\\_handling\" (or other fields under \"config\") is optional and can customize how static files are served\n* If the user's Worker code has not changed, you can omit the code file or re-upload the same index.js\n\nOnce this PUT request succeeds, the files are served on the User Worker. Requests routed to that Worker will serve the new or updated static assets.\n\n***\n\n## Deploying static assets with Wrangler\n\nIf you prefer a CLI-based approach and your platform setup allows direct publishing, you can use Wrangler to deploy both your Worker code and static assets. Wrangler bundles and uploads static assets (from a specified directory) along with your Worker script, so you can manage everything in one place.\n\nCreate or update your [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/) to specify where Wrangler should look for static files:\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "- `directory`: The local folder containing your static files (for example, `./public`).\n- `binding`: The binding name used to reference these assets within your Worker code.\n\n### 1. Organize your files\n\nPlace your static files (HTML, CSS, images, etc.) in the specified directory (in this example, `./public`). Wrangler will detect and bundle these files when you publish your Worker.\n\nIf you need to reference these files in your Worker script to serve them dynamically, you can use the `ASSETS` binding like this:",
      "language": "unknown"
    },
    {
      "code": "### 2. Deploy the User Worker with the static assets\n\nRun Wrangler to publish both your Worker code and the static assets:",
      "language": "unknown"
    },
    {
      "code": "Wrangler will automatically detect your static files, bundle them, and upload them to Cloudflare along with your Worker code.\n\n</page>\n\n<page>\n---\ntitle: Tags  Cloudflare for Platforms docs\ndescription: Use tags to organize, search, and filter user Workers at scale. Tag\n  Workers based on customer ID, plan type, project ID, or environment. After you\n  tag user Workers, you can perform bulk operations like deleting all Workers\n  for a specific customer.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/tags/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/tags/index.md\n---\n\nUse tags to organize, search, and filter user Workers at scale. Tag Workers based on customer ID, plan type, project ID, or environment. After you tag user Workers, you can perform bulk operations like deleting all Workers for a specific customer.\n\nNote\n\nYou can set a maximum of eight tags per script. Avoid special characters like `,` and `&` when naming your tag.\n\n## Add tags via dashboard\n\n1. Go to **Workers for Platforms** in the Cloudflare dashboard and select your namespace.\n2. Select a user Worker from the list.\n3. Go to **Settings** > **Tags**.\n4. Add your tags (for example, `customer-123`, `pro-plan`, `production`).\n5. Select **Save**.\n\nYou can also search and filter Workers by tags in the namespace view.\n\n## Tags API reference\n\nFor complete API documentation, refer to [Workers for Platforms API](https://developers.cloudflare.com/api/resources/workers_for_platforms/subresources/dispatch/subresources/namespaces/subresources/scripts/subresources/tags/).\n\n### Get script tags\n\nFetch all tags for a Worker script.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Tail Read`\n* `Workers Scripts Write`\n* `Workers Scripts Read`",
      "language": "unknown"
    },
    {
      "code": "### Set script tags\n\nReplace all tags on a Worker script. Existing tags not in the request are removed.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Scripts Write`",
      "language": "unknown"
    },
    {
      "code": "### Add a single tag\n\nAdd one tag to a Worker script without affecting existing tags.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Scripts Write`",
      "language": "unknown"
    },
    {
      "code": "### Delete a single tag\n\nRemove one tag from a Worker script.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Scripts Write`",
      "language": "unknown"
    },
    {
      "code": "### Filter Workers by tag\n\nList all Workers that match a tag filter. Use `tag:yes` to include or `tag:no` to exclude.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Tail Read`\n* `Workers Scripts Write`\n* `Workers Scripts Read`",
      "language": "unknown"
    },
    {
      "code": "### Delete Workers by tag\n\nDelete all Workers matching a tag filter. Use this to bulk delete Workers when a customer leaves your platform.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Workers Scripts Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Platform Starter Kit  Cloudflare for Platforms docs\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform-templates/platform-starter-kit/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform-templates/platform-starter-kit/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Deploy an AI vibe coding platform  Cloudflare for Platforms docs\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform-templates/vibesdk/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/platform-templates/vibesdk/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Limits  Cloudflare for Platforms docs\ndescription: Cloudflare provides an unlimited number of scripts for Workers for\n  Platforms customers.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/limits/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/limits/index.md\n---\n\n## Script limits\n\nCloudflare provides an unlimited number of scripts for Workers for Platforms customers.\n\n## `cf` object\n\nThe [`cf` object](https://developers.cloudflare.com/workers/runtime-apis/request/#the-cf-property-requestinitcfproperties) contains Cloudflare-specific properties of a request. This field is not accessible in [user Workers](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/how-workers-for-platforms-works/#user-workers) by default because some fields in this object are sensitive and can be used to manipulate Cloudflare features (for example, `cacheKey`, `resolveOverride`, `scrapeShield`.)\n\nTo access the `cf` object, you need to enable [trusted mode](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/worker-isolation/#trusted-mode) for your namespace. Only enable this if you control all Worker code in the namespace.\n\n## Durable Object namespace limits\n\nWorkers for Platforms do not have a limit for the number of Durable Object namespaces.\n\n## Cache API\n\nFor isolation, `caches.default` is disabled for namespaced scripts. To learn more about the cache, refer to [How the cache Works](https://developers.cloudflare.com/workers/reference/how-the-cache-works/).\n\n## Tags\n\nYou can set a maximum of eight tags per script. Avoid special characters like `,` and `&` when naming your tag.\n\nNeed a higher limit?\n\nTo request an adjustment to a limit, complete the [Limit Increase Request Form](https://forms.gle/ukpeZVLWLnKeixDu7). If the limit can be increased, Cloudflare will contact you with next steps.\n\n## Gradual Deployments\n\n[Gradual Deployments](https://developers.cloudflare.com/workers/configuration/versions-and-deployments/gradual-deployments/) is not supported yet for user Workers. Changes made to user Workers create a new version that deployed all-at-once to 100% of traffic.\n\n## API Rate Limits\n\n| Type | Limit |\n| - | - |\n| Client API per user/account token | 1200/5 minutes |\n| Client API per IP | 200/second |\n| GraphQL | Varies by query cost. Max 320/5 min |\n| User API token quota | 50 |\n| Account API token quota | 500 |\n\nNote\n\nThe global rate limit for the Cloudflare API is 1,200 requests per five minute period per user, and applies cumulatively regardless of whether the request is made via the dashboard, API key, or API token.\n\nIf you exceed this limit, all API calls for the next five minutes will be blocked, receiving a `HTTP 429 - Too Many Requests` response.\n\nSome specific API calls have their own limits and are documented separately, such as the following:\n\n* [Cache Purge APIs](https://developers.cloudflare.com/cache/how-to/purge-cache/#availability-and-limits)\n* [GraphQL APIs](https://developers.cloudflare.com/analytics/graphql-api/limits/)\n* [Rulesets APIs](https://developers.cloudflare.com/ruleset-engine/rulesets-api/#limits)\n* [Lists API](https://developers.cloudflare.com/waf/tools/lists/lists-api/#rate-limiting-for-lists-api-requests)\n* [Gateway Lists API](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/#api-rate-limit)\n\nEnterprise customers can also [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to raise the Client API per user, GraphQL, or API token limits to a higher value.\n\n</page>\n\n<page>\n---\ntitle: Local development  Cloudflare for Platforms docs\ndescription: Test changes to your dynamic dispatch Worker by running the dynamic\n  dispatch Worker locally but connecting it to user Workers that have been\n  deployed to Cloudflare.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/local-development/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/local-development/index.md\n---\n\nTest changes to your [dynamic dispatch Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/how-workers-for-platforms-works/#dynamic-dispatch-worker) by running the dynamic dispatch Worker locally but connecting it to user Workers that have been deployed to Cloudflare.\n\nNote\n\nConsider using a staging namespace to test changes safely before deploying to production.\n\nThis is helpful when:\n\n* **Testing routing changes** and validating that updates continue to work with deployed User Workers\n* **Adding new middleware** like authentication, rate limiting, or logging to the dynamic dispatch Worker\n* **Debugging issues** in the dynamic dispatcher that may be impacting deployed User Workers\n\n### How to use remote dispatch namespaces\n\nIn the dynamic dispatch Worker's Wrangler file, configure the [dispatch namespace binding](https://developers.cloudflare.com/workers/wrangler/configuration/#dispatch-namespace-bindings-workers-for-platforms) to connect to the remote namespace by setting [`remote = true`](https://developers.cloudflare.com/workers/development-testing/#remote-bindings):\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "This tells your dispatch Worker that's running locally to connect to the remote `production` namespace. When you run `wrangler dev`, your Dispatch Worker will route requests to the User Workers deployed in that namespace.\n\nFor more information about remote bindings during local development, refer to [remote bindings documentation](https://developers.cloudflare.com/workers/development-testing/#remote-bindings).\n\n</page>\n\n<page>\n---\ntitle: User Worker metadata  Cloudflare for Platforms docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/metadata/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/metadata/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: API examples  Cloudflare for Platforms docs\ndescription: REST API and TypeScript SDK examples for deploying Workers programmatically.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/platform-examples/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/platform-examples/index.md\n---\n\n## API examples\n\nAs a platform, you deploy Workers on behalf of your customers programmatically. The following examples show how to use the REST API and TypeScript SDK.\n\n### Prerequisites\n\nBefore using these examples, you need:\n\n* Your **Account ID** - Found in the Cloudflare dashboard URL or API settings\n* A **dispatch namespace** - Created via the [dashboard](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/get-started/)\n* An **API token** with Workers permissions - Create one at [API Tokens](https://dash.cloudflare.com/profile/api-tokens)\n\nFor SDK examples, install the Cloudflare SDK:",
      "language": "unknown"
    },
    {
      "code": "### Deploy a user Worker\n\nUpload a Worker script to your dispatch namespace. This is the primary operation your platform performs when customers deploy code.\n\n* REST API",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "### Deploy with bindings and tags\n\nUse [bindings](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/bindings/) to give each user Worker its own resources like a KV store or database. Use [tags](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/tags/) to organize Workers by customer ID, project ID, or plan type for bulk operations.\n\nThe following example shows how to deploy a Worker with its own KV namespace and tags attached:\n\n* REST API",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to [Bindings](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/bindings/) and [Tags](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/tags/).\n\n### Deploy a Worker with static assets\n\nDeploy a Worker that serves static files (HTML, CSS, JavaScript, images). This is a three-step process:\n\n1. Create an upload session with a manifest of files\n2. Upload the asset files\n3. Deploy the Worker with the assets binding\n\nFor more details on static assets configuration and options, refer to [Static assets](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/static-assets/).\n\n* REST API\n\n  **Step 1: Create upload session**",
      "language": "unknown"
    },
    {
      "code": "The response includes a `jwt` token and `buckets` array indicating which files need uploading.\n\n  **Step 2: Upload assets**",
      "language": "unknown"
    },
    {
      "code": "**Step 3: Deploy Worker with assets**",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "### List Workers in a namespace\n\nRetrieve all user Workers deployed to a namespace.\n\n* REST API",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "### Delete Workers by tag\n\nDelete all Workers matching a tag filter. This is useful when a customer deletes their account and you need to remove all their Workers at once.\n\n* REST API\n\n  Delete all Workers tagged with `customer-123`:",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "### Delete a single Worker\n\nDelete a specific Worker by name.\n\n* REST API",
      "language": "unknown"
    },
    {
      "code": "* TypeScript SDK",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Pricing  Cloudflare for Platforms docs\ndescription: The Workers for Platforms Paid plan is $25 monthly. Workers for\n  Platforms can be purchased through the Cloudflare dashboard.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/pricing/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/pricing/index.md\n---\n\nThe Workers for Platforms Paid plan is **$25 monthly**. Workers for Platforms can be purchased through the [Cloudflare dashboard](https://dash.cloudflare.com/?to=/:account/workers-for-platforms).\n\nWorkers for Platforms comes with the following usage allotments and overage pricing.\n\n| | Requests1 2 | Duration | CPU time2 | Scripts |\n| - | - | - | - | - |\n| | 20 million requests included per month +$0.30 per additional million | No charge or limit for duration | 60 million CPU milliseconds included per month +$0.02 per additional million CPU milliseconds Max of 30 seconds of CPU time per invocation Max of 15 minutes of CPU time per [Cron Trigger](https://developers.cloudflare.com/workers/configuration/cron-triggers/) or [Queue Consumer](https://developers.cloudflare.com/queues/configuration/javascript-apis/#consumer) invocation | 1000 scripts +$0.02 per additional script |\n\n1 Inbound requests to your Worker. Cloudflare does not bill for [subrequests](https://developers.cloudflare.com/workers/platform/limits/#subrequests) you make from your Worker.\\\n2 Workers for Platforms only charges for 1 request across the chain of [dispatch Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/how-workers-for-platforms-works/#dynamic-dispatch-worker) -> [user Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/how-workers-for-platforms-works/#user-workers) -> [outbound Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/outbound-workers/). CPU time is charged across these Workers.\n\n## Example pricing:\n\nA Workers for Platforms project that serves 100 million requests per month, uses an average of 10 milliseconds (ms) of CPU time per request and uses 1200 scripts would have the following estimated costs:\n\n| | Monthly Costs | Formula |\n| - | - | - |\n| **Subscription** | $25.00 | |\n| **Requests** | $24.00 | (100,000,000 requests - 20,000,000 included requests) / 1,000,000 \\* $0.30 |\n| **CPU time** | $18.80 | ((10 ms of CPU time per request \\* 100,000,000 requests) - 60,000,000 included CPU ms) / 1,000,000 \\* $0.02 |\n| **Scripts** | $4.00 | (1200 scripts - 1000 included scripts) \\* $0.02 |\n| **Total** | $71.80 | |\n\nCustom limits\n\nSet [custom limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/) for user Workers to get control over your Cloudflare bill, prevent accidental runaway bills or denial-of-wallet attacks. Configure the maximum amount of CPU time that can be used per invocation by [defining custom limits in your dispatch Worker](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/configuration/custom-limits/#set-custom-limits).\n\n</page>\n\n<page>\n---\ntitle: Worker Isolation  Cloudflare for Platforms docs\ndescription: By default, Workers inside of a dispatch namespace are considered\n  \"untrusted.\" This provides the strongest isolation between Workers and is best\n  in cases where your customers have control over the code that's being\n  deployed.\nlastUpdated: 2025-12-29T17:29:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/worker-isolation/\n  md: https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/worker-isolation/index.md\n---\n\n### Untrusted Mode (Default)\n\nBy default, Workers inside of a dispatch namespace are considered \"untrusted.\" This provides the strongest isolation between Workers and is best in cases where your customers have control over the code that's being deployed.\n\nIn untrusted mode:\n\n* The [`request.cf`](https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties) object is not available in Workers (see [limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/limits/#cf-object) for more information)\n* Each Worker has an isolated cache, when using the [Cache API](https://developers.cloudflare.com/workers/runtime-apis/cache/) or when making subrequests using `fetch()`, which egress via [Cloudflare's cache](https://developers.cloudflare.com/cache/)\n* [`caches.default`](https://developers.cloudflare.com/workers/reference/how-the-cache-works/#cache-api) is disabled for all Workers in the namespace\n\nThis mode ensures complete isolation between customer Workers, preventing any potential cross-tenant data access.\n\n### Trusted Mode\n\nIf you control the Worker code and want to disable isolation mode, you can configure the namespace as \"trusted\". This is useful when building internal platforms where your company controls all Worker code.\n\nIn trusted mode:\n\n* The [`request.cf`](https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties) object becomes available, providing access to request metadata\n* All Workers in the namespace share the same cache space when using the Cache API\n\nNote\n\nIn trusted mode, Workers can potentially access cached responses from other Workers in the namespace. Only enable this if you control all Worker code or have appropriate cache key isolation strategies.\n\nTo convert a namespace from untrusted to trusted:",
      "language": "unknown"
    },
    {
      "code": "If you enable trusted mode for a namespace that already has deployed Workers, you'll need to redeploy those Workers for the `request.cf` object to become available. Any new Workers you deploy after enabling trusted mode will automatically have access to it.\n\n### Maintaining cache isolation in trusted mode\n\nIf you need access to `request.cf` but want to maintain cache isolation between customers, use customer-specific [cache keys](https://developers.cloudflare.com/workers/examples/cache-using-fetch/#custom-cache-keys) or the [Cache API](https://developers.cloudflare.com/workers/examples/cache-api/) with isolated keys.\n\n## Related Resources\n\n* [Platform Limits](https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/limits) - Understanding script and API limits\n* [Cache API Documentation](https://developers.cloudflare.com/workers/runtime-apis/cache/) - Learn about cache behavior in Workers\n* [Request cf object](https://developers.cloudflare.com/workers/runtime-apis/request/#the-cf-property-requestcf) - Details on the cf object properties\n\n</page>\n\n<page>\n---\ntitle: App Launcher  Cloudflare One docs\ndescription: With the Access App Launcher, users can open all applications that\n  they have access to from a single dashboard.\nlastUpdated: 2025-10-24T18:16:28.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/index.md\n---\n\nWith the Access App Launcher, users can open all applications that they have access to from a single dashboard.\n\nThe App Launcher is available at a team domain unique to your Cloudflare Zero Trust account, for example `mycompany.cloudflareaccess.com`.\n\nUsers log in using one of the identity providers configured for the account. Once Access authenticates the user, the App Launcher displays applications they are authorized to use, in the form of application tiles. Selecting an application tile launches the application's hostname, sending the user to that tool as part of their SSO flow.\n\n![App Launcher portal](https://developers.cloudflare.com/_astro/app-launcher.BA8TF5r4_Z1EpRVo.webp)\n\n## Enable the App Launcher\n\nBy default, the App Launcher is disabled. To enable it, you must configure a policy that defines which users can access the App Launcher.\n\nTo enable the App Launcher:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Access settings**.\n\n2. Under the **Manage your App Launcher** card, select **Manage**.\n\n3. On the **Policies** tab, [build a policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to define who can access your App Launcher portal. These rules do not impact permissions for the applications secured behind Access.\n\n4. On the **Authentication** tab, choose the identity providers users can authenticate with.\n\n5. Select **Save**.\n\nThe App Launcher is now available at `<your-team-name>.cloudflareaccess.com`. You can always edit your App Launcher rules by going to **Access controls** > **Access settings**.\n\n## Add a tile to the App Launcher\n\nTiles have a one-to-one relationship with each application you create in Access. The tile names displayed in the Access App Launcher portal correspond to the application names listed under **Access controls** > **Applications**. For example, if you create one application for general access to your Jira deployment and a separate application that restricts requests to a particular Jira path, a user authorized for both will see separate tiles for each. If you add multiple hostnames to a single application, the user will only see the domain selected in the application's **App Launcher** settings.\n\nTo show an Access application in the App Launcher:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n\n2. Select an application and select **Configure**.\n\n3. Go to **Experience settings**.\n\n4. Select **Show application in App Launcher**. The App Launcher link will only appear for users who are allowed by your Access policies. Blocked users will not see the app in their App Launcher.\n\n   Note\n\n   This toggle does not impact the user's ability to reach the application. Allowed users can always reach the application via a direct link, regardless of whether the toggle is enabled. Blocked users will never have access to the application.\n\n5. (Optional) To use a custom logo for the application tile, select **Use custom logo** and enter a link to your desired image.\n\n   Note\n\n   If you are having issues specifying a custom logo, check that the image is served from an HTTPS endpoint. For example, `http://www.example.com/upload/logo.png` will not work. However, `https://www.example.com/upload/logo.png` will.\n\n6. In **Application domains**, choose a domain to use for the App Launcher link.\n\n7. (Optional) In **Tags**, add [custom tags](https://developers.cloudflare.com/cloudflare-one/reusable-components/tags/) so that users can more easily find the application in their App Launcher.\n\n## Customize App Launcher appearance\n\nTo customize the App Launcher with your own branding, messages, and links, refer to the [Custom pages documentation](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/app-launcher-customization/).\n\n</page>\n\n<page>\n---\ntitle: Session management  Cloudflare One docs\ndescription: A user session determines how long a user can access an Access\n  application without re-authenticating.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/index.md\n---\n\nA user session determines how long a user can access an Access application without re-authenticating.\n\n## Session durations\n\nWhen a user logs in to an application protected by Access, Access validates their identity against your Access policies and generates two signed JSON Web Tokens (JWTs):\n\n| Token | Description | Expiration | Storage |\n| - | - | - | - |\n| Global session token | Stores the user's identity from the IdP and provides single sign-on (SSO) functionality for all Access applications. | [Global session duration](#global-session-duration) | Your Cloudflare team domain |\n| [Application token](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/) | Allows the user to access a specific Access application. | [Policy session duration](#policy-session-duration), which defaults to the [application session duration](#application-session-duration) | The hostname protected by the Access application |\n\nThe user can access the application for the entire duration of the application token's lifecycle. When the application token expires, Cloudflare will automatically issue a new application token if the global token is still valid (and the user's identity still passes your Access policies). If the global token has also expired, the user will be prompted to re-authenticate with the IdP.\n\nThe global token expiration is usually set to equal or exceed the application token expiration. Setting a longer global token provides a more secure way to allow for longer user sessions, since the global token cannot be used to directly access an application.\n\nAs an analogy, you can think of the global session like a festival where you buy a ticket to enter for the day. For certain rides or areas, the staff may periodically check your ticket to make sure you are authorized to enter. For example, the backstage area may allow ticket holders to go on a 30 minutes tour, after which you need to sign up for another tour. This is analogous to the app session. Now imagine a special policy exists where VIP ticket holders can go backstage for as long as they want. The VIPs have a policy session duration which overrides the default 30 minutes value.\n\nNote\n\nAccess and WARP will evaluate identity based on a user's last-known state. If a user authenticates via your Identity Provider, but later authenticates with a different method (such as One-Time PIN), Access will no longer evaluate the user's Identity Provider group memberships. Identity Provider group memberships are created and managed by the IdP and group membership data can only persist in an IdP-based authentication.\n\n### Global session duration\n\nThe global session duration determines how often Cloudflare Access prompts the user to log in to their identity provider. You can set a global session duration between 15 minutes and one month. The default value is 24 hours.\n\nTo set the global session duration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Access settings**.\n2. Under **Set your global session duration**, select **Edit**,\n3. Select the desired timeout duration from the dropdown menu.\n4. Select **Save**.\n\nThe user will be required to re-authenticate with the IdP after this period of time.\n\n### Policy session duration\n\nThe policy session duration determines how long the user can access a self-hosted Access application. When the user's session expires, Access rechecks their stored user identity against the application's Access policies.\n\nBy default, the policy session duration is equal to the [application session duration](#application-session-duration). To configure more granular permissions for specific users, you can change the policy session duration to a value ranging from immediate timeout to one month. For example, you may wish to set the application session duration to seven days for engineers, but set a policy session duration to 24 hours for contractors.\n\nTo set the policy session duration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Policies**.\n2. Choose a policy and select **Configure**.\n3. Select a **Session Duration** from the dropdown menu.\n4. Save the policy.\n\nUsers who match this policy will be issued an application token with this expiration time.\n\n### Application session duration\n\nThe application session duration is the default [policy session duration](#policy-session-duration) for all policies in an Access application. Available session durations range from immediate timeout to one month. The default value is 24 hours.\n\nTo set the application session duration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n2. Choose an application and select **Configure**.\n3. Select a **Session Duration** from the dropdown menu.\n4. Save the application.\n\nUsers who match a policy configured with a *Same as application session timeout* duration will be issued an application token with this expiration time.\n\n#### SaaS applications\n\nApplication session durations only control the front door to a SaaS app; Access does not control how long the user can stay in the SaaS app itself. For example, if the user logs out of the SaaS app and then comes back to it, a valid Access application token allows them to re-authenticate without another login. The SaaS app issues its own authorization cookie that manages the user's session within the app.\n\n#### SSH, RDP, and VNC\n\nCloudflare does not control the length of an active SSH, VNC, or RDP session. [Application session durations](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/) determine the window in which a user can initiate a new connection or refresh an existing one.\n\n### WARP session duration\n\nWhen [WARP authentication identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/#configure-warp-sessions-in-access) is enabled for an Access application, the WARP session duration overrides the application and policy session durations. If the global session expires but the user already has a valid WARP session, the user will not need to reauthenticate with the IdP until the WARP session expires, given the user is running WARP.\n\n### Order of enforcement\n\nThe following flowchart illustrates how Access enforces user sessions for a self-hosted application.",
      "language": "unknown"
    },
    {
      "code": "## Revoke user sessions\n\nAccess provides two options for revoking user sessions: per-application and per-user.\n\n### Per-Application\n\nTo immediately terminate all active sessions for a specific application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Locate the application for which you would like to revoke active sessions and select **Configure**.\n\n3. Select **Revoke existing tokens**.\n\nUnless there are changes to rules in the policy, users can start a new session if their profile in your identity provider is still active.\n\n### Per-User\n\nAccess can immediately revoke a single user session across all applications in your account. However, if the user's identity profile is still active, they can generate a new session.\n\nIf you want to permanently revoke a user's access:\n\n1. Disable their account in your identity provider so that they cannot authenticate.\n\n2. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Team & Resources** > **Users**.\n\n3. Select the checkbox next to the user you want to revoke.\n\n4. Select **Action** > **Revoke**.\n\nThe user will no longer be able to log in to any application protected by Access. The user will still count towards your seat subscription until you [remove the user](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management) from your account.\n\n### Subsequent Logins\n\nWhen administrators revoke a user's Cloudflare Access token, that user will not be able to log in again for up to 1 minute. If they attempt to do so, Cloudflare Access will display an error.\n\n## Log out as a user\n\nTo log out of Access, the end user can visit either of the following URLs:\n\n* `<your-application-domain>/cdn-cgi/access/logout`\n* `<your-team-name>.cloudflareaccess.com/cdn-cgi/access/logout`\n\nThis action [revokes the user's session](#per-user) across all applications. Access will immediately clear the authorization cookie from the user's browser, and all previously issued tokens will stop being accepted in 20-30 seconds. The only difference between these two URLs is which domain the authorization cookie is deleted from. For example, going to `<your-application-domain>/cdn-cgi/access/logout` will remove the application cookie and make the logout action feel more instantaneous.\n\nYou can use these URLs to create custom logout buttons or links directly within your application.\n\nNote\n\nAt this time, end users cannot log themselves out on a per-application basis.\n\n## AJAX\n\nPages that rely heavily on AJAX or single-page applications can block sub-requests due to an expired Access token without prompting the user to re-authenticate.\n\nYou can configure Access to provide a `401` response on sub-requests with an expired session token. We recommend using this response code to either force a page refresh or to display a message to the user that their session has expired.\n\nIn order to receive a `401` for an expired session, add the following header to all AJAX requests:\n\n`X-Requested-With: XMLHttpRequest`\n\n</page>\n\n<page>\n---\ntitle: MCP server portals  Cloudflare One docs\ndescription: \"An MCP server portal centralizes multiple Model Context Protocol\n  (MCP) servers onto a single HTTP endpoint. Key benefits include:\"\nlastUpdated: 2025-12-01T21:48:21.000Z\nchatbotDeprioritize: false\ntags: MCP\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/mcp-portals/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/mcp-portals/index.md\n---\n\nAn MCP server portal centralizes multiple [Model Context Protocol (MCP) servers](https://www.cloudflare.com/learning/ai/what-is-model-context-protocol-mcp/) onto a single HTTP endpoint. Key benefits include:\n\n* **Streamlined access to multiple MCP servers**: MCP server portals support both unauthenticated MCP servers (such as the [Cloudflare Documentation MCP server](https://github.com/cloudflare/mcp-server-cloudflare/tree/main/apps/docs-vectorize)) as well as MCP servers secured using any [third-party or custom OAuth provider](https://developers.cloudflare.com/agents/model-context-protocol/authorization/). Users log in to the portal URL through Cloudflare Access and are prompted to authenticate separately to each server that requires OAuth.\n\n* **Customized tools per portal**: Admins can tailor an MCP portal to a particular use case by choosing the specific tools and prompt templates that they want to make available to users through the portal. This allows users to access a curated set of tools and prompts  the less external context exposed to the AI model, the better the AI responses tend to be.\n\n* **Observability**: Once the user's AI agent is connected to the portal, Cloudflare Access logs the individual requests made using the tools in the portal.\n\n## Prerequisites\n\n* An [active domain on Cloudflare](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/)\n* Domain uses either a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/) or a [partial (`CNAME`) setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup/)\n* An [identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) configured on Cloudflare Zero Trust\n\n## Add an MCP server\n\nAdd individual MCP servers to Cloudflare Access to bring them under centralized management.\n\nTo add an MCP server:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **AI controls**.\n\n2. Go to the **MCP servers** tab.\n\n3. Select **Add an MCP server**.\n\n4. Enter any name for the server.\n\n5. (Optional) Enter a custom string for the **Server ID**.\n\n6. In **HTTP URL**, enter the full URL of your MCP server. For example, if you want to add the [Cloudflare Documentation MCP server](https://github.com/cloudflare/mcp-server-cloudflare/tree/main/apps/docs-vectorize), enter `https://docs.mcp.cloudflare.com/sse`.\n\n7. Add [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to show or hide the server in an [MCP server portal](#create-a-portal). The MCP server link will only appear in the portal for users who match an Allow policy. Users who do not pass an Allow policy will not see this server through any portals.\n\n   Warning\n\n   Blocked users can still connect to the server (and bypass your Access policies) by using its direct URL. If you want to enforce authentication through Cloudflare Access, [configure Access as the server's OAuth provider](https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/saas-mcp/).\n\n8. Select **Save and connect server**.\n\n9. If the MCP server supports OAuth, you will be redirected to log in to your OAuth provider. You can log in to any account on the MCP server. The account used to authenticate will serve as the admin credential for that MCP server. You can [configure an MCP portal](#create-a-portal) to use this admin credential to make requests.\n\nCloudflare Access will validate the server connection and fetch a list of tools and prompts. Once the server is successfully connected, the [server status](#server-status) will change to **Ready**. You can now add the MCP server to an [MCP server portal](#create-a-portal).\n\n### Server status\n\nThe MCP server status indicates the synchronization status of the MCP server to Cloudflare Access.\n\n| Status | Description |\n| - | - |\n| Error | The server's authentication failed due to expired or incorrect credentials. To fix the issue, [reauthenticate the server](#reauthenticate-the-mcp-server). |\n| Waiting | The server's tools, prompts, and resources are being synchronized. |\n| Ready | The server was successfully synchronized and all tools, prompts, and resources are available. |\n\n### Reauthenticate the MCP server\n\nTo reauthenticate an MCP server in Cloudflare Access:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **AI controls**.\n2. Go to the **MCP servers** tab.\n3. Select the server that you want to reauthenticate, then select **Edit**.\n4. Select **Authenticate server**.\n\nYou will be redirected to log in to your OAuth provider. The account used to authenticate will serve as the new admin credential for this MCP server.\n\n### Synchronize the MCP server\n\nCloudflare Access automatically synchronizes with your MCP server every 24 hours. To manually refresh the MCP server in Zero Trust:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **AI controls**.\n2. Go to the **MCP servers** tab and find the server that you want to refresh.\n3. Select the three dots > **Sync capabilities**.\n\nThe MCP server page will show the updated list of tools and prompts. New tools and prompts are automatically enabled in the MCP server portal.\n\n## Create a portal\n\nTo create an MCP server portal:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **AI controls**.\n\n2. Select **Add MCP server portal**.\n\n3. Enter any name for the portal.\n\n4. Under **Custom domain**, select a domain for the portal URL. Domains must belong to an active zone in your Cloudflare account. You can optionally specify a subdomain.\n\n5. [Add MCP servers](#add-an-mcp-server) to the portal.\n\n6. (Optional) Under **MCP servers**, configure the tools and prompts available through the portal.\n\n7. (Optional) Configure **Require user auth** for servers that support OAuth: - `Enabled`: (default) User will be prompted to utilize their own login credentials to establish a connection with the MCP server. - `Disabled`: Users who are connected to the portal will automatically have access to the MCP server via its [admin credential](#reauthenticate-the-mcp-server).\n\n8. Add [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to define the users who can connect to the portal URL.\n\n9. Select **Add an MCP server portal**.\n\n10. (Optional) [Customize the login experience](#customize-login-settings) for the portal.\n\nUsers can now [connect to the portal](#connect-to-a-portal) at `https://<subdomain>.<domain>/mcp` using an MCP client.\n\n### Customize login settings\n\nCloudflare Access automatically creates an Access application for each MCP server portal. You can customize the portal login experience by updating Access application settings:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n\n2. Find the portal that you want to configure, then select the three dots > **Edit**.\n\n3. To configure identity providers for the portal:\n\n   1. Go to the **Login methods** tab.\n   2. Select the [identity providers](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) that you want to enable for your application.\n   3. (Recommended) If you plan to only allow access via a single identity provider, turn on **Instant Auth**. End users will not be shown the [Cloudflare Access login page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/). Instead, Cloudflare will redirect users directly to your SSO login event.\n\n4. To customize the block page:\n\n   1. Go to the **Experience settings** tab.\n\n   2. Under **Block page**, choose what end users will see when they are denied access to the application:\n\n      * **Cloudflare default**: Reload the [login page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/) and display a block message below the Cloudflare Access logo. The default message is `That account does not have access`, or you can enter a custom message.\n      * **Redirect URL**: Redirect to the specified website.\n      * **Custom page template**: Display a [custom block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/) hosted in Cloudflare One.\n\n5. Select **Save application**.\n\n## Connect to a portal\n\nUsers can connect to your MCP server running at `https://<subdomain>.<domain>/mcp` using [Workers AI Playground](https://playground.ai.cloudflare.com/), [MCP inspector](https://github.com/modelcontextprotocol/inspector), or [other MCP clients](https://developers.cloudflare.com/agents/guides/remote-mcp-server/#connect-your-mcp-server-to-claude-and-other-mcp-clients) that support remote MCP servers.\n\nTo test in Workers AI Playground:\n\n1. Go to [Workers AI Playground](https://playground.ai.cloudflare.com/).\n2. Under **MCP Servers**, enter `https://<subdomain>.<domain>/mcp` for the portal URL.\n3. Select **Connect**.\n4. In the popup window, log in to your Cloudflare Access identity provider.\n5. The popup window will list the MCP servers in the portal that require authentication. For each of these MCP servers, select **Connect** and follow the login prompts.\n6. Select **Done** to complete the portal authentication process.\n\nWorkers AI Playground will show a **Connected** status and list the available tools. You can now ask the AI model to complete a task using an available tool. Requests made to an MCP server will appear in your [portal logs](#view-portal-logs).\n\nFor MCP clients with server configuration files, we recommend using the `npx` command with the `mcp-remote@latest` argument:",
      "language": "unknown"
    },
    {
      "code": "We do not recommend using the `serverURL` parameter since it may cause issues with portal session creation and management.\n\nIf you want to force your MCP client to reauthenticate, most MCP clients will refresh a session after removing the existing MCP OAuth sessions. To clear authentication credentials used by your MCP client, open a terminal and run the following command:\n\nNote\n\nThis command will trigger all MCP servers using `mcp-remote@latest` to force reauthenticate, not just MCP portals.",
      "language": "unknown"
    },
    {
      "code": "## View portal logs\n\nPortal logs allow you to monitor user activity through an MCP server portal. You can view logs on a per-portal or per-server basis.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **AI controls**.\n2. Find the portal or server that you want to view logs for, then select the three dots > **Edit**.\n3. Select **Logs**.\n\n### Log fields\n\n| Field | Description |\n| - | - |\n| Time | Date and time of the request |\n| Status | Whether the server successfully returned a response |\n| Server | Name of the MCP server that handled the request |\n| Capability | The tool used to process the request |\n| Duration | Processing time for the request in milliseconds |\n\n## Troubleshooting\n\n### After authenticating to the portal, my user receives the error `No allowed servers available, check your Zero Trust Policies`.\n\n1. An MCP portal and server must both have an attached Access policy. Ensure that all MCP servers assigned to the portal have their own associated policy.\n2. The server's admin authentication may be expired. Check that the [server's status](#server-status) is **Ready**. If the status shows an error, [reauthenticate the server](#reauthenticate-the-mcp-server).\n\n### The portal URL does not prompt for authentication when it is added to an MCP client.\n\n1. Verify that the portal has an assigned Access policy.\n2. Verify that the portal URL does not have any applied [Workers](https://developers.cloudflare.com/workers/configuration/routing/custom-domains/), [Page Rules](https://developers.cloudflare.com/rules/page-rules/manage/), [custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/domain-support/) definitions, or any other configuration that may interfere with its ability to connect to the MCP client.\n\n</page>\n\n<page>\n---\ntitle: Authenticate MCP server to self-hosted apps  Cloudflare One docs\ndescription: Cloudflare Access can delegate access from any self-hosted\n  application to an Access for SaaS MCP server via OAuth. The OAuth access token\n  authorizes the MCP server to make requests to your self-hosted applications on\n  behalf of the user, using the user's specific permissions and scopes.\nlastUpdated: 2025-12-04T19:29:43.000Z\nchatbotDeprioritize: false\ntags: MCP\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/linked-apps/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/linked-apps/index.md\n---\n\nCloudflare Access can delegate access from any [self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) to an [Access for SaaS MCP server](https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/saas-mcp/) via [OAuth](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization). The OAuth access token authorizes the MCP server to make requests to your self-hosted applications on behalf of the user, using the user's specific permissions and scopes.\n\nFor example, your organization may wish to deploy an MCP server that helps employees interact with internal applications. You can configure [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors) to ensure that only authorized users can access those applications, either directly or by using an MCP client.",
      "language": "unknown"
    },
    {
      "code": "This guide covers how to use the Cloudflare API to link a self-hosted application to a remote MCP server. The core of this feature is the Linked App Token rule type, which allows an Access policy on one application to accept OAuth access tokens generated for another.\n\n## Prerequisites\n\n* A [self-hosted Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/)\n\n## 1. Secure the MCP server with Access for SaaS\n\nThe first step is to add the MCP server to Cloudflare Access as an OIDC-based SaaS application. For step-by-step instructions on how to add an MCP server, refer to [Secure MCP servers with Access for SaaS](https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/saas-mcp/).\n\n## 2. Create an Access policy with a Linked App Token\n\n* Dashboard\n\n  1. [Create a new Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/#create-a-policy).\n\n  2. Set the policy **Action** to *Service Auth*.\n\n  3. For **Selector**, select *Linked App Token*.\n\n  4. For **Value**, select the SaaS application created in [step 1](#1-secure-the-mcp-server-with-access-for-saas). For example,\n\n     | Action | Rule type | Selector | Value |\n     | - | - | - | - |\n     | Service Auth | Include | Linked App Token | `mcp-server-cf-access` |\n\n  Note\n\n  The Linked App Token selector only works with the [Service Auth](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#service-auth) action, similar to service token rules.\n\n* API\n\n  1. Get the `id` of the MCP server SaaS application:\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Access: Apps and Policies Revoke`\n     * `Access: Apps and Policies Write`\n     * `Access: Apps and Policies Read`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "2. Create the following Access policy, replacing the `app_uid` value with the `id` of your SaaS application:\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Access: Apps and Policies Write`",
      "language": "unknown"
    },
    {
      "code": "Note\n\n     The `linked_app_token` rule type only works with [`non_identity` decisions](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#service-auth), similar to service token rules.\n\n  3. Copy the Access policy `id` returned in the response:",
      "language": "unknown"
    },
    {
      "code": "This policy will allow requests if they present a valid OAuth access token that was issued for the specified SaaS application.\n\n## 3. Update the self-hosted application\n\nYou can add the Linked App Token policy to any [self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) in your Zero Trust account. Other app types (such as [SaaS applications](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/)) are [not currently supported](#known-limitations).\n\n## 4. Configure the MCP server\n\nWith the policy in place, every API request to the self-hosted application must now include a valid `access_token` from Cloudflare Access. You will need to configure the MCP server to forward the `access_token` in an HTTP request header:",
      "language": "unknown"
    },
    {
      "code": "The end-to-end authorization flow is as follows:\n\n1. The MCP server authenticates against the Access for SaaS app via OAuth.\n2. Upon success, the MCP server receives an `access_token`.\n3. The MCP server makes an API request to the self-hosted application with the token in the request headers.\n4. Cloudflare Access intercepts the request to the self-hosted app, inspects the token, and validates it against the `linked_app_token` rule in the policy.\n5. If the token is valid and was issued for the linked SaaS app, the request is allowed. Otherwise, it is blocked.\n\n## Known limitations\n\nThe MCP OAuth feature only works with self-hosted applications that rely on the [Cloudflare Access JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/) to authenticate and identify the user. If the application implements its own layer of authentication after Cloudflare Access, then this feature is at best a partial solution. Requests that are successfully authenticated by Access may still be blocked by the application itself, resulting in an HTTP `401` or `403` error.\n\n</page>\n\n<page>\n---\ntitle: Secure MCP servers with Access for SaaS  Cloudflare One docs\ndescription: You can secure Model Context Protocol (MCP) servers by using\n  Cloudflare Access as an OAuth Single Sign-On (SSO) provider.\nlastUpdated: 2025-10-27T15:01:51.000Z\nchatbotDeprioritize: false\ntags: MCP\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/saas-mcp/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/saas-mcp/index.md\n---\n\nYou can secure [Model Context Protocol (MCP) servers](https://www.cloudflare.com/learning/ai/what-is-model-context-protocol-mcp/) by using Cloudflare Access as an OAuth Single Sign-On (SSO) provider.\n\nThis guide walks through how to deploy a remote MCP server on [Cloudflare Workers](https://developers.cloudflare.com/workers/) that requires Cloudflare Access for authentication. When users connect to the MCP server using an MCP client, they will be prompted to log in to your [identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) and are only granted access if they pass your [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors).\n\n## Prerequisites\n\n* Add an [identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) to Cloudflare Zero Trust\n* Install [npm](https://docs.npmjs.com/getting-started)\n* Install [Node.js](https://nodejs.org/en/)\n\n## 1. Deploy an example MCP server\n\nTo deploy our [example MCP server](https://github.com/cloudflare/ai/tree/main/demos/remote-mcp-cf-access) on Workers:\n\n1. Open a terminal and clone our example project:",
      "language": "unknown"
    },
    {
      "code": "When asked if you want to deploy to Cloudflare, select **No**.\n\n2. Go to the project directory:",
      "language": "unknown"
    },
    {
      "code": "3. Create a [Workers KV namespace](https://developers.cloudflare.com/kv/concepts/kv-namespaces/) to store the key. The binding name should be `OAUTH_KV` if you want to run the example as written.",
      "language": "unknown"
    },
    {
      "code": "The command will output the binding name and KV namespace ID:",
      "language": "unknown"
    },
    {
      "code": "4. Open `wrangler.jsonc` in an editor and insert your `OAUTH_KV` namespace ID:",
      "language": "unknown"
    },
    {
      "code": "5. You can now deploy the Worker to Cloudflare's global network:",
      "language": "unknown"
    },
    {
      "code": "The Worker will be deployed to your `*.workers.dev` subdomain at `mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev`.\n\n## 2. Create an Access for SaaS app\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n  2. Select **Add an application**.\n\n  3. Select **SaaS**.\n\n  4. In **Application**, enter a custom name (for example, `MCP server`) and select the textbox that appears below.\n\n  5. Select **OIDC** as the authentication protocol.\n\n  6. Select **Add application**.\n\n  7. In **Redirect URLs**, enter the authorization callback URL for your MCP server. The callback URL for our [example MCP server](#1-deploy-an-example-mcp-server) is `txt https://mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev/callback`\n\n  8. Copy the following values to input into our example MCP server. Other MCP servers may require different sets of input values.\n\n     * **Client secret**\n     * **Client ID**\n     * **Token endpoint**\n     * **Authorization endpoint**\n     * **Key endpoint**\n\n  9. (Optional) Under **Advanced settings**, turn on [**Refresh tokens**](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/generic-oidc-saas/#advanced-settings) if you want to reduce the number of times a user needs to log in to the identity provider.\n\n  10. Configure [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to define the users who can access the MCP server.\n\n  11. Save the application.\n\n* API\n\n  1. Make a `POST` request to the [Access applications](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/applications/methods/create/) endpoint:\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Access: Apps and Policies Write`",
      "language": "unknown"
    },
    {
      "code": "2. Copy the `client_id` and `client_secret` returned in the response.\n\n  3. To determine the OAuth endpoint URLs for the SaaS application, refer to the [generic OIDC documentation](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/generic-oidc-saas/#2-add-your-application-to-access).\n\n## 3. Configure your MCP server\n\nYour MCP server needs to perform an OAuth 2.0 authorization flow to get an `access_token` from the SaaS app created in [Step 1](#1-create-an-access-for-saas-app). When setting up the OAuth client on your MCP server, you will need to paste in the OAuth endpoints and credentials from the SaaS app.\n\nTo add OAuth endpoints and credentials to our [example MCP server](#1-deploy-an-example-mcp-server):\n\n1. Create the following [Workers secrets](https://developers.cloudflare.com/workers/configuration/secrets/):",
      "language": "unknown"
    },
    {
      "code": "2. When prompted to enter a secret value, paste the corresponding values from your SaaS app:\n\n   | Workers secret | SaaS app field |\n   | - | - |\n   | `ACCESS_CLIENT_ID` | Client ID |\n   | `ACCESS_CLIENT_SECRET` | Client secret |\n   | `ACCESS_TOKEN_URL` | Token endpoint |\n   | `ACCESS_AUTHORIZATION_URL` | Authorization endpoint |\n   | `ACCESS_JWKS_URL` | Key endpoint |\n\n3. Configure a cookie encryption key:\n\n   a. Generate a random string:",
      "language": "unknown"
    },
    {
      "code": "b. Store the string in a Workers secret:",
      "language": "unknown"
    },
    {
      "code": "## 4. Test the connection\n\nYou should now be able to connect to your MCP server using [Workers AI Playground](https://playground.ai.cloudflare.com/), [MCP inspector](https://github.com/modelcontextprotocol/inspector), or [other MCP clients](https://developers.cloudflare.com/agents/guides/remote-mcp-server/#connect-your-mcp-server-to-claude-and-other-mcp-clients) that support remote MCP servers. The demo MCP server [supports connections](https://github.com/cloudflare/ai/blob/main/demos/remote-mcp-cf-access/src/index.ts#L63-L69) via either `https://mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev/mcp` or `https://mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev/sse`.\n\nTo test in Workers AI Playground:\n\n1. Go to [Workers AI Playground](https://playground.ai.cloudflare.com/).\n\n2. Under **MCP Servers**, enter `https://mcp-server-cf-access.<YOUR_SUBDOMAIN>.workers.dev/mcp` for the MCP server URL.\n\n3. Select **Connect**.\n\n4. A popup window will appear requesting access to the MCP server. Select **Approve**.\n\n5. Follow the prompts to log in to your identity provider.\n\nWorkers AI Playground will show a **Connected** status. The MCP server should successfully obtain an `access_token` from Cloudflare Access.\n\n</page>\n\n<page>\n---\ntitle: Add bookmarks  Cloudflare One docs\ndescription: With Cloudflare One, you can show applications on the App Launcher\n  even if those applications are not secured behind Access. This way, users can\n  access all the applications they need to work, all in one place  regardless\n  of whether those applications are protected by Access.\nlastUpdated: 2025-10-24T18:16:28.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/bookmarks/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/bookmarks/index.md\n---\n\nWith Cloudflare One, you can show applications on the [App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/) even if those applications are not secured behind Access. This way, users can access all the applications they need to work, all in one place  regardless of whether those applications are protected by Access.\n\nLinks to applications not protected by Access can be added as bookmarks. To add a bookmark:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Select **Add an application** > **Bookmark**.\n\n3. Name your application.\n\n4. Enter your **Application URL**, for example `https://mybookmark.com`.\n\n5. Turn on **App Launcher visibility** if you want the application to be visible in the App Launcher. The toggle does not impact the ability for users to reach the application.\n\n6. (Optional) To add a custom logo for your application, select **Custom** and enter the image URL.\n\n   Note\n\n   If you are having issues specifying a custom logo, check that the image is served from an HTTPS endpoint. For example, `http://www.example.com/upload/logo.png` will not work. However, `https://www.example.com/upload/logo.png` will.\n\n7. Select **Add application** to save and exit.\n\nThe application will show up on the Applications page labeled as `BOOKMARK`. You can always edit or delete your bookmarks, as you would any other application.\n\n</page>\n\n<page>\n---\ntitle: Add web applications  Cloudflare One docs\ndescription: Cloudflare Access allows you to secure your web applications by\n  acting as an identity aggregator, or proxy. You can use signals from your\n  existing identity providers (IdPs), device posture providers, and other rules\n  to control who can log in to the application.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/index.md\n---\n\nCloudflare Access allows you to secure your web applications by acting as an identity aggregator, or proxy. You can use signals from your existing identity providers (IdPs), device posture providers, and [other rules](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors) to control who can log in to the application.\n\n![Cloudflare Access verifies a user's identity before granting access to your application.](https://developers.cloudflare.com/_astro/diagram-saas.BmFlwn8e_1emNwT.webp)\n\nYou can protect the following types of web applications:\n\n* [**SaaS applications**](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/) consist of applications your team relies on that are not hosted by your organization. Examples include Salesforce and Workday. To secure SaaS applications, you must integrate Cloudflare Access with the SaaS application's SSO configuration.\n\n* **Self-hosted applications** consist of internal applications that you host in your own environment. These can be the data center versions of tools like the Atlassian suite or applications created by your own team. Setup requirements for a self-hosted application depend on whether the application is publicly accessible on the Internet or restricted to users on a private network.\n\n  * [**Public hostname applications**](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) are web applications that have public DNS records. Anyone on the Internet can access the application by entering the URL in their browser and authenticating through Cloudflare Access. Securing access to a public website requires a Cloudflare DNS [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/) or [partial CNAME setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup/).\n  * [**Private network applications**](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/self-hosted-private-app/) do not have public DNS records, meaning they are not reachable from the public Internet. To connect using a private IP or private hostname, the user's traffic must route through Cloudflare Gateway. The preferred method is to install the WARP client on the user's device, but you could also forward device traffic from a [network location](https://developers.cloudflare.com/magic-wan/) or use an agentless option such as [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) or [Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/).\n\n* [**Model Context Protocol (MCP) servers**](https://developers.cloudflare.com/cloudflare-one/access-controls/ai-controls/) are web applications that enable generative AI tools to read and write data within your business applications. For example, Salesforce provides an [MCP server](https://github.com/salesforcecli/mcp) for developers to interact with resources in their Salesforce tenant using GitHub Copilot or other AI code editors.\n\n* [**Cloudflare Dashboard SSO**](https://developers.cloudflare.com/fundamentals/manage-members/dashboard-sso/) is a special type of SaaS application that manages SSO settings for the Cloudflare dashboard and has limited permissions for administrator edits.\n\n</page>\n\n<page>\n---\ntitle: Non-HTTP applications  Cloudflare One docs\ndescription: Cloudflare offers both client-based and clientless ways to grant\n  secure access to non-HTTP applications.\nlastUpdated: 2025-10-23T19:01:53.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/index.md\n---\n\nCloudflare offers both client-based and clientless ways to grant secure access to non-HTTP applications.\n\nNote\n\nNon-HTTP applications require [connecting your private network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/) to Cloudflare. For more details, refer to our [Replace your VPN](https://developers.cloudflare.com/learning-paths/replace-vpn/connect-private-network/) implementation guide.\n\n## WARP client\n\nUsers can connect by installing the Cloudflare WARP client on their device and enrolling in your Zero Trust organization. Remote devices connect to your applications as if they were on your private network. By default, all devices enrolled in your organization can access any private route unless they are protected by an Access policy or Gateway firewall rule. To secure the application, you can [create a self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/self-hosted-private-app/) for a private IP range, port range, and/or hostname and build [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) that allow or block specific users.\n\nIf you would like to define how users access specific infrastructure servers within your network, [create an infrastructure application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/) in Access for Infrastructure. Access for Infrastructure provides an additional layer of control and visibility over how users access non-HTTP applications, including:\n\n* Define fine-grained policies to govern who has access to specific servers and exactly how a user may access that server.\n* Eliminate SSH keys by using short-lived certificates to authenticate users.\n* Export SSH command logs to a storage service or SIEM solution using [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/).\n\n## Clientless access\n\nClientless access methods are suited for organizations that cannot deploy the WARP client or need to support third-party contractors where installing a client is not possible. Clientless access requires onboarding a domain to Cloudflare and configuring a public hostname in order to make the server reachable. Command logging is not supported.\n\n### Browser-rendered terminal\n\nCloudflare's [browser-based terminal](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/browser-rendering/) allows users to connect over SSH, RDP, and VNC without any configuration. When users visit the public hostname URL (for example, `https://ssh.example.com`) and log in with their Access credentials, Cloudflare will render a terminal in their browser. For RDP connections, users must authenticate to the Windows server using their Windows username and password in addition to being authenticated by Cloudflare Access.\n\n### Client-side cloudflared (legacy)\n\nNote\n\nNot recommended for new deployments.\n\nUsers can log in to the application by installing `cloudflared` on their device and running a hostname-specific command in their terminal. For more information, refer to [cloudflared authentication](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/cloudflared-authentication/).\n\n## Related resources\n\nTo connect to an application over a specific protocol, refer to these tutorials:\n\n* [SSH](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/)\n* [SMB](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/smb/)\n* [RDP](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/rdp/)\n\n</page>\n\n<page>\n---\ntitle: Application paths  Cloudflare One docs\ndescription: Application paths define the URLs protected by an Access policy.\n  When adding a self-hosted application to Access, you can choose to protect the\n  entire website by entering its apex domain, or alternatively, protect specific\n  subdomains and paths.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/index.md\n---\n\nApplication paths define the URLs protected by an Access policy. When adding a self-hosted application to Access, you can choose to protect the entire website by entering its apex domain, or alternatively, protect specific subdomains and paths.\n\n## Policy inheritance\n\nCloudflare Zero Trust allows you to create unique rules for parts of an application that share a root path. Imagine an example application is deployed at `dashboard.com/eng` that anyone on the engineering team should be able to access. However, a tool deployed at `dashboard.com/eng/exec` should only be accessed by the executive team.\n\nWhen multiple rules are set for a common root path, the more specific rule takes precedence. For example, when setting rules for `dashboard.com/eng` and `dashboard.com/eng/exec` separately, the more specific rule for `dashboard.com/eng/exec` takes precedence, and no rule is inherited from `dashboard.com/eng`. If no separate, specific rule is set for `dashboard.com/eng/exec`, it will inherit any rules set for `dashboard.com/eng`.\n\n## Wildcards\n\nWhen you create an application for a specific subdomain or path, you can use asterisks (`*`) as wildcards. Wildcards allow you to extend the application you are creating to multiple subdomains or paths in a given apex domain.\n\n### Examples\n\n#### Match all subdomains of an apex domain\n\nA wildcard in the **Subdomain** field only matches that specific subdomain level. It does not cover the apex domain or multiple levels of the subdomain. If you want to cover multiple subdomain levels, you can use multiple wildcards.\n\n| Application | Covers | Does not cover |\n| - | - | - |\n| `*.example.com` | `alpha.example.com` `beta.example.com` | `example.com` `foo.bar.example.com` |\n\n#### Match all paths of an apex domain\n\nTo protect an apex domain and all of the paths under it, leave the **Path** field empty. Alternatively, use a wildcard in the **Path** field.\n\n| Application | Covers | Does not cover |\n| - | - | - |\n| `example.com` or `example.com/*` | `example.com` `example.com/alpha` `example.com/beta` | `alpha.example.com` |\n\n#### Match multi-level subdomains\n\nUsing a wildcard in the **Subdomain** field does not cover the parent subdomain nor the apex domain.\n\n| Application | Covers | Does not cover |\n| - | - | - |\n| `*.test.example.com` | `alpha.test.example.com` `beta.test.example.com` | `test.example.com` `example.com` |\n\n#### Partially match subdomains\n\nUsing a wildcard at the beginning or end of the **Subdomain** field does not cover multiple levels of the subdomain.\n\n| Application | Covers | Does not cover |\n| - | - | - |\n| `*test.example.com` | `test.example.com` `alphatest.example.com` | `beta.test.example.com` |\n\n#### Match multi-level paths\n\nUsing a wildcard in the **Path** field does not cover the parent path nor the apex domain.\n\n| Application | Covers | Does not cover |\n| - | - | - |\n| `example.com/alpha/*` | `example.com/alpha/one` `example.com/alpha/two` | `example.com/alpha` `example.com` |\n\n#### Partially match paths\n\nUsing a wildcard in the middle of the **Path** field covers multiple segments of the URL.\n\n| Application | Covers |\n| - | - |\n| `example.com/foo*/bar` | `example.com/foo/bar` `example.com/food/bar` `example.com/food/stuff/bar` |\n\n### Limitations\n\n* At most one wildcard in between each dot in the **Subdomain**. For example, `foo*bar*baz.example.com` is not allowed.\n* At most one wildcard in between each slash in the **Path**. For example, `example.com/foo*bar*baz` is not allowed.\n\n## Subdomain setups\n\n[Subdomain setups](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/) allow you to manage a child domain separately from its parent domain. In Access application paths, your configured child domains will appear in the **Domain** dropdown menu. If you [split out a subdomain](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/) which already has an Access application, you will need to re-save the Access application to associate it with the new child domain.\n\n## Unsupported URLs\n\n### Port numbers\n\nPort numbers are not supported in Access application paths. If a request includes a port number in the URL, Access will strip the port number and redirect the request to the default HTTP/HTTPS port.\n\n### Query strings\n\nQuery strings (such as`?foo=bar`) are not supported in Access application paths.\n\n### Anchor links\n\nSince anchor links are processed by the browser and not the server, Access applications do not support `#` characters in the URL. For example, requests to `dashboard.com/#settings` will redirect to `dashboard.com`.\n\n</page>\n\n<page>\n---\ntitle: External Evaluation rules  Cloudflare One docs\ndescription: \"With Cloudflare Access, you can create Allow or Block policies\n  which evaluate the user based on custom criteria. This is done by adding an\n  External Evaluation rule to your policy. The External Evaluation selector\n  requires two values:\"\nlastUpdated: 2025-10-28T17:07:12.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/external-evaluation/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/external-evaluation/index.md\n---\n\nWith Cloudflare Access, you can create Allow or Block policies which evaluate the user based on custom criteria. This is done by adding an **External Evaluation** rule to your policy. The **External Evaluation** selector requires two values:\n\n* **Evaluate URL**  the API endpoint containing your business logic.\n* **Keys URL**  the key that Access uses to verify that the response came from your API\n\nAfter the user authenticates with your identity provider, Access sends the user's identity to the external API at **Evaluate URL**. The external API returns a True or False response to Access, which will then allow or deny access to the user. To protect against man-in-the-middle attacks, Access signs all requests with your Access account key and checks that responses are signed by the key at **Keys URL**.\n\nYou can set up External Evaluation rules using any API service, but to get started quickly we recommend using [Cloudflare Workers](https://developers.cloudflare.com/workers/).\n\n## Set up external API and key with Cloudflare Workers\n\n### Prerequisites\n\n* [Workers account](https://developers.cloudflare.com/workers/get-started/guide/)\n* Install [npm](https://docs.npmjs.com/getting-started)\n* Install [Node.js](https://nodejs.org/en/)\n* Application protected by Access\n\n### 1. Create a new Worker\n\n1. Open a terminal and clone our example project.",
      "language": "unknown"
    },
    {
      "code": "2. Go to the project directory.",
      "language": "unknown"
    },
    {
      "code": "3. Create a [Workers KV namespace](https://developers.cloudflare.com/kv/concepts/kv-namespaces/) to store the key. The binding name should be `KV` if you want to run the example as written.",
      "language": "unknown"
    },
    {
      "code": "The command will output the binding name and KV namespace ID, for example",
      "language": "unknown"
    },
    {
      "code": "4. Open the [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/) in an editor and insert the following:\n\n   * `[[kv_namespaces]]`: Add the output generated in the previous step.\n   * `<TEAM_NAME>`: your Cloudflare One team name.\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "### 2. Program your business logic\n\n1. Open `index.js` and modify the `externalEvaluation` function to perform logic on any identity-based data sent by Access.\n\nNote\n\n* Sample code is available in our [GitHub repository](https://github.com/cloudflare/workers-access-external-auth-example).\n* To view a list of identity-based data fields, log in to your Access application and append `/cdn-cgi/access/get-identity` to the URL. For example, if `www.example.com` is behind Access, visit `https://www.example.com/cdn-cgi/access/get-identity`.\n\n1. Deploy the Worker to Cloudflare's global network.",
      "language": "unknown"
    },
    {
      "code": "The Worker will be deployed to your `*.workers.dev` subdomain at `my-worker.<YOUR_SUBDOMAIN>.workers.dev`.\n\n### 3. Generate a key\n\nTo generate an RSA private/public key pair:\n\n1. Open a browser and go to `https://my-worker.<YOUR_SUBDOMAIN>.workers.dev/keys`.\n\n2. (Optional) Verify that the key has been stored in the `KV` namespace:\n\n   1. In the Cloudflare dashboard, go to the **Workers KV** page. [Go to **Workers KV**](https://dash.cloudflare.com/?to=/:account/workers/kv/namespaces)\n   2. Select **View** next to `my-worker-KV`.\n\nOther key formats (such as DSA) are not supported at this time.\n\n### 4. Create an External Evaluation rule\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Policies**.\n\n2. Edit an existing policy or select **Add a policy**.\n\n3. Add the following rule to your policy:\n\n| Rule Type | Selector | Evaluate URL | Keys URL |\n| - | - | - | - |\n| Include | External Evaluation | `https://my-worker.<YOUR_SUBDOMAIN>.workers.dev/` | `https://my-worker.<YOUR_SUBDOMAIN>.workers.dev/keys/` |\n\n1. Save the policy.\n\n2. Go to **Access controls** > **Applications** and edit the application for which you want to apply the External Evaluation rule.\n\n3. In the **Policies** tab, add the policy that contains the External Evaluation rule.\n\n4. Select **Save application**.\n\nWhen a user logs in to your application, Access will now check their email, device, location, and other identity-based data against your business logic.\n\n### Troubleshooting the Worker\n\nTo debug your External Evaluation rule:\n\n1. Go to your Worker directory.",
      "language": "unknown"
    },
    {
      "code": "2. Open the [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/) in an editor and set the `debug` variable to `TRUE`.\n\n3. Deploy your changes.",
      "language": "unknown"
    },
    {
      "code": "4. Next, start a session to output realtime logs from your Worker.",
      "language": "unknown"
    },
    {
      "code": "5. Log in to your Access application.\n\n   The session logs should show an incoming and outgoing JWT. The incoming JWT was sent by Access to the Worker API, while the outgoing JWT was sent by the Worker back to Access.\n\n6. To decode the contents of a JWT, you can copy the token into [jwt.io](https://jwt.io/).\n\n   The incoming JWT should contain the user's identity data. The outgoing JWT should look similar to:",
      "language": "unknown"
    },
    {
      "code": "Access checks the outgoing JWT for all of the following criteria:\n\n   * Token was signed by **Keys URL**.\n   * Expiration date has not elapsed.\n   * API returns `\"success\": true`.\n   * `nonce` is unchanged from the incoming JWT. The `nonce` value is unique per request.\n\n   If any condition fails, the External Evaluation rule evaluates to false.\n\n</page>\n\n<page>\n---\ntitle: Rule groups  Cloudflare One docs\ndescription: A rule group is a collection of Access rules that can be configured\n  once and then quickly applied across many Access policies. Rule groups use the\n  same rule types and selectors shown in the Access policy builder.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/groups/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/groups/index.md\n---\n\nA rule group is a collection of Access rules that can be configured once and then quickly applied across many Access policies. Rule groups use the same [rule types](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#rule-types) and [selectors](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors) shown in the Access policy builder.\n\nNote\n\nRule groups are distinct from groups in your identity provider, like Okta groups. Rule groups can contain a mix of individual users, groups from identity providers, and service authentication options like service tokens.\n\n## Create a rule group\n\nTo create an Access rule group:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Policies**, and select the **Rule groups** tab.\n\n  2. Select **Add a group**.\n\n  3. Enter a name for the group (for example, `Lisbon-team`).\n\n  4. Specify as many rules as needed to define your user group. For example, the following rules define a team based in Lisbon, Portugal:\n\n     | Rule type | Selector | Value |\n     | - | - | - |\n     | Include | Country | `Portugal` |\n     | Require | Emails Ending In | `@team.com` |\n\n  5. Select **Save**.\n\n* API\n\n  Send a `POST` request to the [`/access/groups`](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/groups/methods/create/) endpoint:\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Access: Organizations, Identity Providers, and Groups Write`",
      "language": "unknown"
    },
    {
      "code": "You can now add this group to an Access policy using the *Rule groups* selector.\n\n## Use cases\n\n### IP-based rules\n\nWe recommend using rule groups to define any IP address-based rules you configure in policies. Keeping IP addresses in one place allows you to modify or remove addresses once, rather than in each policy, and reduces the potential for mistakes.\n\nNote\n\nIf adding more than one IP address or range to a rule group, use an Include rule for the IPs. If you do not use an Include rule, the policy will require traffic to originate from all ranges.\n\n### Country requirements\n\nYou can create a rule group that consists of countries to allow or block. Access will treat the countries in the Include rule with an OR logical operator. When building policies for an Access application, you can assign this rule group to a Require policy to require at least one of the countries inside of the group. For an example policy, refer to [Require rules with OR operators](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#require-rules-with-or-operators).\n\n</page>\n\n<page>\n---\ntitle: Isolate self-hosted application  Cloudflare One docs\ndescription: With Access policies, you can require users to open self-hosted\n  applications in a secure remote browser. Because the remote browser is\n  directly integrated into our Secure Web Gateway platform, HTTP policies can be\n  applied to isolated applications without needing to install the WARP client.\n  This allows you to distribute internal applications to unmanaged users while\n  retaining control over sensitive data.\nlastUpdated: 2025-10-23T20:06:36.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/index.md\n---\n\nNote\n\nRequires [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/).\n\nWith Access policies, you can require users to open self-hosted applications in a secure [remote browser](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/). Because the remote browser is directly integrated into our Secure Web Gateway platform, [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) can be applied to isolated applications without needing to install the WARP client. This allows you to distribute internal applications to unmanaged users while retaining control over sensitive data.\n\n## Prerequisites\n\nYour browser must [allow third-party cookies](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/#allow-third-party-cookies-in-the-browser) on the application domain.\n\n## Enable Browser Isolation\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Browser isolation** > **Browser isolation settings**.\n2. Under **Manage remote browser permissions**, select **Manage**.\n3. Enable **Clientless Web Isolation**.\n\n1) Go to **Access controls** > **Applications**.\n2) Choose a [self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) and select **Configure**.\n3) Go to **Policies**.\n4) Choose an [Allow policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) and select **Configure**.\n5) Under **Additional settings**, turn on **Isolate application**.\n6) Save the policy.\n\nBrowser Isolation is now enabled for users who match this policy. After the user logs into Access, the application will launch in a remote browser. To confirm that the application is isolated, refer to [Check if a web page is isolated](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/#3-check-if-a-web-page-is-isolated).\n\nYou can optionally add another Allow policy for users on managed devices who do not require isolation.\n\n## Policies for isolated applications\n\nTraffic to the isolated Access application is filtered by your Gateway [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/). Useful policies include:\n\n* [Identity-based policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) to allow or block requests based on user identity.\n* [Data Loss Prevention policies](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) to log or block transmission of sensitive data.\n* [Isolation policies](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/) to disable browser actions such as copy/paste, printing, or file downloads.\n\nFor example, if your application is hosted on `internal.site.com`, the following policy blocks users from uploading and downloading credit card numbers within the remote browser:\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| Domain | in | `internal.site.com` | And | Block |\n| DLP Profile | in | `Financial Information` | | |\n\n## Product compatibility\n\nFor a list of products that are incompatible with the **Isolate application** feature, refer to [Product Compatibility](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/#product-compatibility) .\n\n</page>\n\n<page>\n---\ntitle: Enforce MFA  Cloudflare One docs\ndescription: With Zero Trust policies, you can require that users log in to\n  certain applications with specific types of multifactor authentication (MFA)\n  methods. For example, you can create rules that only allow users to reach a\n  given application if they authenticate with a physical hard key.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/mfa-requirements/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/mfa-requirements/index.md\n---\n\nWith Zero Trust policies, you can require that users log in to certain applications with specific types of multifactor authentication (MFA) methods. For example, you can create rules that only allow users to reach a given application if they authenticate with a physical hard key.\n\nThis feature is only available if you are using the following identity providers:\n\n* Okta\n* Microsoft Entra ID (formerly Azure AD)\n* OpenID Connect (OIDC)\n* SAML\n\nTo enforce an MFA requirement to an application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n\n2. Find the application for which you want to enforce MFA and select **Configure**. Alternatively, [create a new application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/).\n\n3. Go to **Policies**.\n\n4. If your application already has a policy containing an identity requirement, find it and select **Configure**.\n\n   Note\n\n   The policy should contain an Include rule that uses identity-based selectors. For example, the Include rule could allow users who are part of a [rule group](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/groups/), email domain, or identity provider group.\n\n5. Add the following rule to the policy:\n\n   | Rule type | Selector | Value |\n   | - | - | - |\n   | Require | Authentication method | `mfa - multiple-factor authentication` |\n\n6. Save the policy.\n\nImportant\n\n**What happens if the user fails to present the required MFA method?**\n\nCloudflare Access will reject the user, even if they successfully login to the identity provider with an alternative method.\n\n## Adding authentication methods into the JWT\n\nWhen users authenticate with their identity provider, the identity provider then shares their username with Cloudflare Access. Cloudflare Access then writes that value into the JSON Web Token (JWT) generated for the user.\n\nCertain identity providers can also share the multifactor authentication (MFA) method presented by the user to login. Cloudflare Access can add these values into the JWT and force. For example, if the user authenticated with their password and a physical hard key, the identity provider can send a confirmation to Cloudflare Access.\n\nCloudflare Access then stores that method into the same JWT issued to the user.\n\nCloudflare Access follows [RFC 8176](https://tools.ietf.org/html/rfc8176), Authentication Method Reference Values, to define authentication methods.\n\n</page>\n\n<page>\n---\ntitle: Manage Access policies  Cloudflare One docs\ndescription: Access policies define the users who can log in to your Access\n  applications. You can create, edit, or delete policies at any time and reuse\n  policies across multiple applications.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/index.md\n---\n\nAccess policies define the users who can log in to your Access applications. You can create, edit, or delete policies at any time and reuse policies across multiple applications.\n\n## Create a policy\n\nTo create a reusable Access policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Policies**.\n\n2. Select **Add a policy**.\n\n3. Enter a **Policy name**.\n\n4. Choose an [**Action**](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#actions) for the policy.\n\n5. Choose a [**Session duration**](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/) for the policy.\n\n6. Configure as many [**Rules**](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#rule-types) as needed.\n\n7. (Optional) Configure additional settings for users who match this policy:\n\n   * [Isolate application](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/).\n   * [Purpose justificaton](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/require-purpose-justification/)\n   * [Temporary authentication](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/temporary-auth/)\n\n8. Select **Save**.\n\nYou can now add this policy to an [Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/).\n\n## Edit a policy\n\nTo make changes to an existing Access policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Policies**.\n2. Locate the policy you want to update and select **Configure**.\n3. Once you have made the necessary changes, select **Save**.\n\nThe updated policy is now in effect for all associated Access applications.\n\n## Delete a policy\n\nTo delete a reusable Access policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Policies** and locate the policy you want to delete.\n2. If the policy is used by an application, remove the policy from all associated applications.\n3. Select **Delete**.\n4. A pop-up message will ask you to confirm your decision to delete the policy. Select **Delete**.\n\n## Test your policies\n\nYou can test your Access policies against all existing user identities in your Zero Trust organization. For the policy tester to work, users must have logged into the [App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/) or any other Access application at some point in time.\n\nCloudflare will use the most recent device that was authenticated with Access to test your policies.\n\n### Test a single policy\n\nThe Access policy builder allows you to test your rules before saving any changes.\n\nTo test an individual Access policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Policies**.\n2. Locate the policy you want to test and select **Configure**.\n3. Go to **Policy tester** and select **Test policies**.\n\nThe policy tester reports the percentage of active users who are allowed or denied access to an application based on this policy. You can expand the test results to view a list of allowed or blocked users.\n\n### Test all policies in an application\n\nYou can test your Access application policies against your user population before deploying changes to your users. After saving your changes, you can also perform a more detailed policy test for a specific user.\n\nTo test if users have access to an application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n\n2. Locate the application you want to test and select **Configure**.\n\n3. Go to **Policies** > **Policy tester**.\n\n4. To test all active users in your organization, select **Test policies**.\n\n   The policy tester reports the percentage of users who are allowed or denied access to this application based on all configured policies. You can expand the test results to view a list of allowed or blocked users.\n\n5. To perform a detailed test on a single user:\n\n   a. If you made any changes to your policies, first save the application.\n\n   b. Select **testing a single user**.\n\n   c. Enter their email address and select **Test policies**.\n\n   The single user test results will show:\n\n   * Whether the user is allowed or denied access to this application based on all configured policies.\n   * The user's identity from their most recent Access login attempt.\n   * Whether the user matches individual Allow, Block, or Bypass policies.\n\n## Legacy policies\n\nLegacy policies are scoped to a specific application and cannot be added to newly created Access applications.\n\n### Migrate to reusable policies\n\nTo migrate legacy policies to reusable policies:\n\n1. [Create a reusable policy](#create-a-policy) that will replace the legacy policy.\n2. Go to the Access application associated with the legacy policy.\n3. Add the reusable policy to the application and remove the legacy policy.\n4. Repeat these steps for each legacy policy. If you have duplicate legacy policies, you can replace them with a single reusable policy.\n\n### Convert a legacy policy\n\nYou can use the API to convert a legacy policy into a reusable policy. To convert a legacy policy, make a `PUT` request with an empty request body:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: Apps and Policies Write`",
      "language": "unknown"
    },
    {
      "code": "The policy is now removed from the applications endpoint (`/access/apps/$APP_ID/policies`) and managed using the [reusable policies endpoints](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/policies/)(`/access/policies/$POLICY_ID`).\n\n</page>\n\n<page>\n---\ntitle: Require purpose justification after login  Cloudflare One docs\ndescription: Cloudflare Access allows security and IT teams to present users\n  with a purpose justification screen directly after they log in to an Access\n  application. This allows organizations to audit not only for who is accessing\n  their resources, but also for why they are requesting access.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/require-purpose-justification/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/require-purpose-justification/index.md\n---\n\nCloudflare Access allows security and IT teams to present users with a purpose justification screen directly after they log in to an Access application. This allows organizations to audit not only for who is accessing their resources, but also for why they are requesting access.\n\nThe purpose justification screen will show for any new sessions of an application. For example, if an Access application has a session time of eight hours, a user will see the purpose justification screen once every eight hours.\n\nConfiguring a purpose justification screen is done as part of configuring an Access policy.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n2. Choose an application and select **Configure**.\n3. Go to **Policies**.\n4. Choose an **Allow** policy and select **Configure**.\n5. Under **Additional settings**, turn on **Purpose justification**.\n6. (Optional) Set a custom purpose justification message. This will appear on the purpose justification screen and will be visible to the user.\n7. Save the policy.\n\nUsers who match this policy will see the following screen:\n\n![Finalized purpose justification screen displaying custom message.](https://developers.cloudflare.com/_astro/purpose-justification.Bgv25E7i_28Shdw.webp)\n\n</page>\n\n<page>\n---\ntitle: Temporary authentication  Cloudflare One docs\ndescription: With Cloudflare Access, you can require that users obtain approval\n  before they can access a specific self-hosted application or SaaS application.\n  The administrator will receive an email notification to approve or deny the\n  request. Unlike a typical Allow policy, the user will have to request access\n  at the end of each session. This allows you to define the users who should\n  have persistent access and those who must request temporary access.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/temporary-auth/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/policies/temporary-auth/index.md\n---\n\nWith Cloudflare Access, you can require that users obtain approval before they can access a specific self-hosted application or SaaS application. The administrator will receive an email notification to approve or deny the request. Unlike a typical Allow policy, the user will have to request access at the end of each session. This allows you to define the users who should have persistent access and those who must request temporary access.\n\n## Set up temporary authentication\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Choose a **Self-hosted** or **SaaS** application and select **Configure**.\n\n3. Choose an **Allow** policy and select **Configure**.\n\n4. Under **Additional settings**, turn on [**Purpose justification**](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/require-purpose-justification/).\n\n5. Turn on **Temporary authentication**.\n\n6. Enter the **Email addresses of the approvers**.\n\n   Note\n\n   Your approvers must be authenticated by Access. If they do not have an active session, Access will verify their identity against your [App Launcher Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/).\n\n7. Save the policy.\n\nTemporary authentication is now enabled for users who match this policy. You can optionally add a second **Allow** policy for users who should have persistent access. Be sure the policy order is set to allow persistent users through.\n\n## Temporary authentication requests\n\n![Temporary authentication request page shown to users](https://developers.cloudflare.com/_astro/temp-auth-request.WnwXx8ul_GCVA5.webp)\n\nApprovers will receive a request similar to the example below. The approver can then grant access for a set amount of time, up to a maximum of 24 hours.\n\n![Temporary authentication approval page shown to administrators](https://developers.cloudflare.com/_astro/temp-auth-approval.D0-hjStz_1NNzm1.webp)\n\n</page>\n\n<page>\n---\ntitle: Mutual TLS  Cloudflare One docs\ndescription: Mutual TLS (mTLS) authentication ensures that traffic is both\n  secure and trusted in both directions between a client and server. It allows\n  requests that do not log in with an identity provider (like IoT devices) to\n  demonstrate that they can reach a given resource. Client certificate\n  authentication is also a second layer of security for team members who both\n  log in with an identity provider (IdP) and present a valid client certificate.\nlastUpdated: 2025-11-07T17:00:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/index.md\n---\n\n[Mutual TLS (mTLS) authentication](https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/) ensures that traffic is both secure and trusted in both directions between a client and server. It allows requests that do not log in with an identity provider (like IoT devices) to demonstrate that they can reach a given resource. Client certificate authentication is also a second layer of security for team members who both log in with an identity provider (IdP) and present a valid client certificate.\n\nWith a root certificate authority (CA) in place, Access only allows requests from devices with a corresponding client certificate. When a request reaches the application, Access responds with a request for the client to present a certificate. If the device fails to present the certificate, the request is not allowed to proceed. If the client does have a certificate, Access completes a key exchange to verify.\n\n![mTLS handshake diagram](https://developers.cloudflare.com/_astro/mtls.BbZYLY1o_1otkUM.webp)\n\nImportant\n\nThe mTLS certificate is used only to verify the client certificate. It does not control the SSL certificate presented during the [server hello](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/).\n\n## Enforce mTLS authentication\n\n### Prerequisites\n\n* An [Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) for the hostname that you would like to secure with mTLS.\n\n* A CA that issues client certificates for your devices.\n\n  * The CA certificate can be from a publicly trusted CA or self-signed.\n\n  * In the certificate `Basic Constraints`, the attribute `CA` must be set to `TRUE`.\n\n  * The certificate must use one of the signature algorithms listed below:\n\n    Allowed signature algorithms\n\n    `x509.SHA1WithRSA`\n\n    `x509.SHA256WithRSA`\n\n    `x509.SHA384WithRSA`\n\n    `x509.SHA512WithRSA`\n\n    `x509.ECDSAWithSHA1`\n\n    `x509.ECDSAWithSHA256`\n\n    `x509.ECDSAWithSHA384`\n\n    `x509.ECDSAWithSHA512`\n\n### Add mTLS to your Access application\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Service credentials** > **Mutual TLS**.\n\n2. Select **Add mTLS Certificate**.\n\n3. Enter any name for the root CA.\n\n4. In **Certificate content**, paste the contents of your root CA.\n\n   If the client certificate is directly signed by the root CA, you only need to upload the root. If the client certificate is signed by an intermediate certificate, you must upload the entire CA chain (intermediate and root). For example:",
      "language": "unknown"
    },
    {
      "code": "Do not include any SSL/TLS server certificates; Access only uses the CA chain to verify the connection between the user's device and Cloudflare.\n\n1) In **Associated hostnames**, enter the fully-qualified domain names (FQDN) that will use this certificate.\n\n   These FQDNs will be the hostnames used for the resources being protected in the [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). You must associate the Root CA with the FQDN that the application being protected uses.\n\n2) Save the policy.\n\n3) Go to **Access controls** > **Policies**.\n\n4) [Create an Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/#create-a-policy) using one of the following [selectors](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors):\n\n   * **Valid Certificate**: Any client certificate that can authenticate with the Root CA will be allowed to proceed.\n   * **Common Name**: Only client certificates with a specific common name will be allowed to proceed.\n\n5) If this is for a client who does not need to log in through an IdP, set the policy **Action** to *Service Auth*.\n\n   **Example mTLS policy**\n\n   | Action | Rule type | Selector | Value |\n   | - | - | - | - |\n   | Service Auth | Include | Common Name | `John Doe` |\n\n6) Save the policy, then go to **Access controls** > **Applications**.\n\n7) Select the application you would like to enforce mTLS on and select **Configure**. The application must be included in the **Associated hostnames** list from Step 5.\n\n8) In the **Policies** tab, add your mTLS policy.\n\n9) Save the application.\n\nYou can now authenticate to the application using a client certificate. For instructions on how to present a client certificate, refer to [Test mTLS](#test-mtls).\n\n## Test mTLS\n\n### Test using cURL\n\nTo test the application protected by an mTLS policy:\n\n1. First, attempt to curl the site without a client certificate. This curl command example is for the site `example.com` that has an [Access application and policy](#add-mtls-to-your-access-application) set for `https://auth.example.com`:",
      "language": "unknown"
    },
    {
      "code": "Without a client certificate in the request, a `403 forbidden` response displays and the site cannot be accessed.\n\n2. Now, add your client certificate and key to the request:",
      "language": "unknown"
    },
    {
      "code": "When the authentication process completes successfully, a `CF_Authorization Set-Cookie` header returns in the response.\n\nWarning\n\nCloudflare Gateway cannot inspect traffic to mTLS-protected domains. If a device has the WARP client turned on and passes HTTP requests through Gateway, access will be blocked unless you [bypass HTTP inspection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) for the domain.\n\n### Test in a browser\n\nTo access an mTLS-protected application in a browser, the client certificate must be imported into your browser's certificate manager. Instructions vary depending on the browser. Your browser may use the operating system's root store or its own internal trust store.\n\nThe following example demonstrates how to add a client certificate to the macOS system keychain:\n\nImportant\n\nThe command adds the client certificate to the trusted store on your device. Only proceed if you are comfortable doing so and intend to keep these testing certificates safeguarded.\n\n1. Navigate to the directory containing the client certificate and key.\n\n   1. Open the `client.pem` file in Keychain Access. If prompted, enter your local password.\n   2. In **Keychain**, choose the access option that suits your needs and select **Add**.\n   3. In the list of certificates, locate the newly installed certificate. Keychain Access will mark this certificate as not trusted. Right-click the certificate and select **Get Info**.\n   4. Select **Trust**. Under **When using this certificate**, select *Always Trust*.\n\nAssuming your browser uses the macOS system store, you can now connect to the mTLS application through the browser.\n\n## Generate mTLS certificates\n\nYou can use open source private key infrastructure (PKI) tools to generate certificates to test the mTLS feature in Cloudflare Access.\n\n### OpenSSL\n\nThis section covers how to use [OpenSSL](https://www.openssl.org/) to generate a root and intermediate certificate, and then issue client certificates that can authenticate against the CA chain.\n\n#### Generate the root CA\n\n1. Generate the root CA private key:",
      "language": "unknown"
    },
    {
      "code": "When prompted, enter a password to use with `rootCA.key`.\n\n2. Create a self-signed root certificate called `rootCA.pem`:",
      "language": "unknown"
    },
    {
      "code": "You will be prompted to enter your private key password and fill in some optional fields. For testing purposes, you can leave the optional fields blank.\n\n#### Generate an intermediate certificate\n\n1. Generate the intermediate CA private key:",
      "language": "unknown"
    },
    {
      "code": "When prompted, enter a password to use with `intermediate.key`.\n\n2. Create a certificate signing request (CSR) for the intermediate certificate:",
      "language": "unknown"
    },
    {
      "code": "You will be prompted to enter your private key password and fill in some optional fields. For testing purposes, you can leave the optional fields blank.\n\n3. Create a CA Extension file called `v3_intermediate_ca.ext`. For example,",
      "language": "unknown"
    },
    {
      "code": "Make sure that `basicConstraints` includes the `CA:true` property. This property allows the intermediate certificate to act as a CA and sign client certificates.\n\n4. Sign the intermediate certificate with the root CA:",
      "language": "unknown"
    },
    {
      "code": "#### Create a CA chain file\n\n1. Combine the intermediate and root certificates into a single file:",
      "language": "unknown"
    },
    {
      "code": "The intermediate certificate should be at the top of the file, followed by its signing certificate.\n\n2. Upload the contents of `ca-chain.pem` to Cloudflare Access. For instructions, refer to [Add mTLS to your Access application](#add-mtls-to-your-access-application).\n\n#### Generate a client certificate\n\n1. Generate a private key for the client:",
      "language": "unknown"
    },
    {
      "code": "2. Create a CSR for the client certificate:",
      "language": "unknown"
    },
    {
      "code": "You will be prompted to fill in some optional fields. For testing purposes, you can set **Common Name** to something like `John Doe`.\n\n3. Sign the client certificate with the intermediate certificate:",
      "language": "unknown"
    },
    {
      "code": "4. Validate the client certificate against the certificate chain:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "You can now use the client certificate (`client.pem`) and its key (`client.key`) to [test mTLS](#test-mtls).\n\n### Cloudflare PKI\n\nThis guide uses [Cloudflare's PKI toolkit](https://github.com/cloudflare/cfssl) to generate a root CA and client certificates from JSON files.\n\n#### 1. Install dependencies\n\nThe process requires two packages from Cloudflare's PKI toolkit:\n\n* `cf-ssl`\n* `cfssljson`\n\nYou can install these packages from the [Cloudflare SSL GitHub repository](https://github.com/cloudflare/cfssl). You will need a working installation of Go, version 1.12 or later. Alternatively, you can [download the packages](https://github.com/cloudflare/cfssl) directly. Use the instructions under Installation to install the toolkit, and ensure that you install all of the utility programs in the toolkit.\n\n#### 2. Generate the root CA\n\n1. Create a new directory to store the root CA.\n\n2. Within that directory, create two new files:\n\n   * **CSR**. Create a file named `ca-csr.json` and add the following JSON blob, then save the file.",
      "language": "unknown"
    },
    {
      "code": "* **config**. Create a file named `ca-config.json` and add the following JSON blob, then save the file.",
      "language": "unknown"
    },
    {
      "code": "3. Now, run the following command to generate the root CA with those files.",
      "language": "unknown"
    },
    {
      "code": "4. The command will output a root certificate (`ca.pem`) and its key (`ca-key.pem`).",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "5. Upload the contents of `ca.pem` to Cloudflare Access. For instructions, refer to [Add mTLS to your Access application](#add-mtls-to-your-access-application).\n\n#### 3. Generate a client certificate\n\nTo generate a client certificate that will authenticate against the uploaded root CA:\n\n1. Create a file named `client-csr.json` and add the following JSON blob:",
      "language": "unknown"
    },
    {
      "code": "2. Now, use the following command to generate a client certificate with the Cloudflare PKI toolkit:",
      "language": "unknown"
    },
    {
      "code": "The command will output a client certificate file (`client.pem`) and its key (`client-key.pem`). You can now use these files to [test mTLS](#test-mtls).\n\n#### Create a certificate revocation list\n\nYou can use the Cloudflare PKI toolkit to generate a certificate revocation list (CRL), as well. This list will contain client certificates that are revoked.\n\n1. Get the serial number from the client certificate generated earlier. Add that serial number, or any others you intend to revoke, in hex format in a text file. This example uses a file named `serials.txt`.\n\n2. Create the CRL with the following command.",
      "language": "unknown"
    },
    {
      "code": "You will need to add the CRL to your server or enforce the revocation in a Cloudflare Worker. An example Worker Script can be found on the [Cloudflare GitHub repository](https://github.com/cloudflare/access-crl-worker-template).\n\n## Forward a client certificate\n\nIn addition to enforcing mTLS authentication for your host, you can also forward a client certificate to your origin server as an HTTP header. This setup is often helpful for server logging.\n\nTo avoid adding the certificate to every single request, the certificate is only forwarded on the first request of an mTLS connection.\n\nWarning\n\nThis process is only available on accounts with [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/).\n\n### Cloudflare API\n\nThe most common approach to forwarding a certificate is to use the Cloudflare API to [update an mTLS certificate's hostname settings](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/certificates/subresources/settings/methods/update/).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: Mutual TLS Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "Once `client_certificate_forwarding` is set to `true`, every request within an mTLS connection will now include the following headers:\n\n* `Cf-Client-Cert-Der-Base64`\n* `Cf-Client-Cert-Sha256`\n\n### Managed Transforms\n\nYou can also [modify HTTP response headers](https://developers.cloudflare.com/rules/transform/response-header-modification/) using Managed Transforms to pass along **TLS client auth headers**.\n\n### Cloudflare Workers\n\nAdditionally, Workers can provide details around the [client certificate](https://developers.cloudflare.com/workers/runtime-apis/bindings/mtls/).",
      "language": "unknown"
    },
    {
      "code": "## Known limitations\n\nmTLS does not currently work for:\n\n* Cloudflare Pages site served on a [custom domain](https://developers.cloudflare.com/pages/configuration/custom-domains/)\n* Cloudflare R2 public bucket served on a [custom domain](https://developers.cloudflare.com/r2/buckets/public-buckets/#connect-a-bucket-to-a-custom-domain)\n\n## Notifications for mutual TLS certificates\n\nCloudflare will send the following [notifications](https://developers.cloudflare.com/notifications/) before your mutual TLS certificates expire:\n\nAccess mTLS Certificate Expiration Alert\n\n**Who is it for?**\n\n[Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) customers that use client certificates for mutual TLS authentication. This notification will be sent 30 and 14 days before the expiration of the certificate.\n\n**Other options / filters**\n\nNone.\n\n**Included with**\n\nPurchase of [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/) and/or [Cloudflare for SaaS](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/).\n\n**What should you do if you receive one?**\n\nUpload a [renewed certificate](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/#add-mtls-authentication-to-your-access-configuration).\n\n</page>\n\n<page>\n---\ntitle: Service tokens  Cloudflare One docs\ndescription: You can provide automated systems with service tokens to\n  authenticate against your Cloudflare One policies. Cloudflare Access will\n  generate service tokens that consist of a Client ID and a Client Secret.\n  Automated systems or applications can then use these values to reach an\n  application protected by Access.\nlastUpdated: 2025-10-28T17:49:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/\n  md: https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/index.md\n---\n\nYou can provide automated systems with service tokens to authenticate against your Cloudflare One policies. Cloudflare Access will generate service tokens that consist of a Client ID and a Client Secret. Automated systems or applications can then use these values to reach an application protected by Access.\n\nThis section covers how to create, renew, and revoke a service token.\n\n## Create a service token\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Service credentials** > **Service Tokens**.\n\n  2. Select **Create Service Token**.\n\n  3. Name the service token. The name allows you to easily identify events related to the token in the logs and to revoke the token individually.\n\n  4. Choose a **Service Token Duration**. This sets the expiration date for the token.\n\n  5. Select **Generate token**. You will see the generated Client ID and Client Secret for the service token, as well as their respective request headers.\n\n  6. Copy the Client Secret.\n\n     Warning\n\n     This is the only time Cloudflare Access will display the Client Secret. If you lose the Client Secret, you must generate a new service token.\n\n* API\n\n  1. Make a `POST` request to the [Access Service Tokens](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/service_tokens/methods/create/) endpoint:\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Access: Service Tokens Write`",
      "language": "unknown"
    },
    {
      "code": "2. Copy the `client_id` and `client_secret` values returned in the response.",
      "language": "unknown"
    },
    {
      "code": "Warning\n\n     This is the only time Cloudflare Access will display the Client Secret. If you lose the Client Secret, you must generate a new service token.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Service Tokens Write`\n\n  2. Configure the [`cloudflare_zero_trust_access_service_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_service_token) resource:",
      "language": "unknown"
    },
    {
      "code": "3. Get the Client ID and Client Secret of the service token:\n\n     Example: Output to CLI\n\n     1. Output the Client ID and Client Secret to the Terraform state file:",
      "language": "unknown"
    },
    {
      "code": "2. Apply the configuration:",
      "language": "unknown"
    },
    {
      "code": "3. Read the Client ID and Client Secret:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "Example: Store in HashiCorp Vault",
      "language": "unknown"
    },
    {
      "code": "You can now configure your Access applications and [device enrollment permissions](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/device-enrollment/#check-for-service-token) to accept this service token. Make sure to set the policy action to [**Service Auth**](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#service-auth); otherwise, Access will prompt for an identity provider login.\n\n## Connect your service to Access\n\n### Initial request\n\nTo authenticate to an Access application using your service token, add the following to the headers of any HTTP request:\n\n`CF-Access-Client-Id: <CLIENT_ID>`\n\n`CF-Access-Client-Secret: <CLIENT_SECRET>`\n\nFor example,",
      "language": "unknown"
    },
    {
      "code": "If the service token is valid, Access generates a JWT scoped to the application in the form of a [`CF_Authorization` cookie](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/). You can use this cookie to authenticate [subsequent requests](#subsequent-requests) to the application.\n\n#### Authenticate with a single header\n\nYou can configure a self-hosted Access application to accept a service token in a single HTTP header, as an alternative to the `CF-Access-Client-Id` and `CF-Access-Client-Secret` pair of headers. This is useful for authenticating SaaS services that only support sending one custom header in a request (for example, the `Authorization` header).\n\nTo authenticate using a single header:\n\n1. Get your existing Access application configuration:\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `Access: Apps and Policies Write`\n   * `Access: Apps and Policies Read`",
      "language": "unknown"
    },
    {
      "code": "2. Make a `PUT` request with the name of the header you want to use for service token authentication. To avoid overwriting your existing configuration, the `PUT` request body should contain all fields returned by the previous `GET` request.\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `Access: Apps and Policies Write`",
      "language": "unknown"
    },
    {
      "code": "3. Add the header to any HTTP request. For example,",
      "language": "unknown"
    },
    {
      "code": "### Subsequent requests\n\nAfter you have [authenticated to the application](#initial-request) using the service token, add the resulting `CF_Authorization` cookie to the headers of all subsequent requests:",
      "language": "unknown"
    },
    {
      "code": "If you prefer to use a raw header, send the value as `cf-access-token`:",
      "language": "unknown"
    },
    {
      "code": "All requests with this cookie will succeed until the JWT expires.\n\nNote\n\nIf your Access application only has Service Auth policies, you must send the service token on every subsequent request. You can only use the JWT if the application has at least one Allow policy.\n\n## Renew service tokens\n\nService tokens expire according to the token duration you selected when you created the token.\n\nTo renew the service token:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Service credentials** > **Service Tokens**.\n\n2. Locate the token you want to renew.\n\n3. To extend the token's lifetime by one year, select **Refresh**.\n\n4. To extend the token's lifetime by more than a year:\n\n   1. Select **Edit**.\n   2. Choose a new **Service Token Duration**.\n   3. Select **Save**. The expiration date will be extended by the selected amount of time.\n\n## Revoke service tokens\n\nIf you need to revoke access before the token expires, simply delete the token.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Service credentials** > **Service Tokens**.\n2. **Delete** the token you need to revoke.\n\nServices that rely on a deleted service token can no longer reach your application.\n\nNote\n\nWhen editing an Access application, selecting **Revoke existing tokens** revokes existing sessions but does not prevent the user from starting a new session. As long as the Client ID and Client Secret are still valid, they can be exchanged for a new token on the next request. To revoke access, you must delete the service token.\n\n## Set a token expiration alert\n\nAn alert can be configured to notify a week before a service token expires to allow an administrator to invoke a token refresh.\n\nExpiring Access Service Token Alert\n\n**Who is it for?**\n\n[Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) customers who want to receive a notification when their service token is about to expire.\n\n**Other options / filters**\n\nNone.\n\n**Included with**\n\nPurchase of Access\n\n**What should you do if you receive one?**\n\nExtend the expiration date of the service token. For more details, refer to [Renew your service token](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/#renew-service-tokens).\n\nTo configure a service token expiration alert:\n\n1. In the [Cloudflare dashboard](https://dash.cloudflare.com), go to the **Notifications** page. [Go to **Notifications**](https://dash.cloudflare.com/?to=/:account/notifications)\n2. Select **Add**.\n3. Select *Expiring Access Service Token*.\n4. Enter a name for your alert and an optional description.\n5. (Optional) Add other recipients for the notification email.\n6. Select **Save**.\n\nYour alert has been set and is now visible on the **Notifications** page.\n\n</page>\n\n<page>\n---\ntitle: Common DLP policies  Cloudflare One docs\ndescription: The following in-line DLP policies are commonly used to secure data\n  in uploaded and downloaded files.\nlastUpdated: 2025-10-24T15:59:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/common-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/common-policies/index.md\n---\n\nThe following in-line DLP policies are commonly used to secure data in uploaded and downloaded files.\n\n## Log uploads/downloads\n\nThe **Allow** action functions as an implicit logger, providing visibility into where your sensitive data is going without impacting the end user experience. The following example scans for your enabled Financial Information profile entries when users upload or download data to file sharing apps.\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| DLP Profile | in | *Financial Information* | And | Allow |\n| Content Categories | in | *File Sharing* | | |\n\n## Block file types\n\nBlock the upload or download of files based on their type.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Upload File Types | in | *Microsoft Office Word Document (docx)* | And | Block |\n  | Download File Types | in | *PDF (pdf)* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "For more information on what file formats DLP can scan, refer to [Supported file types](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/#supported-file-types).\n\n## Block uploads/downloads for specific users\n\nYou can configure access on a per-user or group basis by adding [identity-based conditions](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) to your policies. The following example blocks only contractors from uploading/downloading Financial Information to file sharing apps.\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| DLP Profile | in | *Financial Information* | And | Block |\n| Content Categories | in | *File Sharing* | And | |\n| User Group Names | in | *Contractors* | | |\n\n## Exclude Android applications\n\nMany Android applications (such as Google Drive) use [certificate pinning](https://developers.cloudflare.com/ssl/reference/certificate-pinning/), which is incompatible with Gateway inspection. If needed, you can create a [Do Not Inspect policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) so that the app can continue to function on Android:\n\n1. Set up an [OS version device posture check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/) that checks for the Android operating system.\n\n2. Create the following HTTP policy in Gateway:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | Application | in | *Google Drive* | And | Do Not Inspect |\n   | Passed Device Posture Checks | in | *OS Version Android* | | |\n\nAndroid users can now use the app, but the app traffic will bypass DLP scanning.\n\n## Exclude specific sites\n\nIn your [DLP logs](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#4-view-dlp-logs), you may find that certain sites are a common source of noise. To exempt these sites from DLP scanning:\n\n1. [Create a list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of hostnames or URLs.\n\n2. Exclude the list from your DLP policy as shown in the example below:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | DLP Profile | in | *Financial Information* | And | Block |\n   | Application | in | *Google Drive* | And | |\n   | Domain | not in list | *Do not DLP - SSN* | | |\n\n</page>\n\n<page>\n---\ntitle: Logging options  Cloudflare One docs\ndescription: Data Loss Prevention allows you to capture, store, and view the\n  data that triggered a specific DLP policy for use as forensic evidence. Users\n  on all plans can log the payload or generative AI prompt content of matched\n  HTTP requests in their Cloudflare logs. Additionally, Enterprise users can\n  configure a Logpush job to send copies of entire matched HTTP requests to\n  storage destinations.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/index.md\n---\n\nData Loss Prevention allows you to capture, store, and view the data that triggered a specific DLP policy for use as forensic evidence. Users on all plans can log the [payload](#log-the-payload-of-matched-rules) or [generative AI prompt content](#log-generative-ai-prompt-content) of matched HTTP requests in their Cloudflare logs. Additionally, Enterprise users can [configure a Logpush job](#send-http-requests-to-logpush-destination) to send copies of entire matched HTTP requests to storage destinations.\n\nThe data that triggers a DLP policy is stored in the portion of the HTTP request known as the payload. Payload logging is especially useful when diagnosing the behavior of DLP policies. Since the values that triggered a rule may contain sensitive data, they are encrypted with a customer-provided public key so that only you can examine them later. The stored data will include a redacted version of the match, plus 75 bytes of additional context on both sides of the match.\n\n## Set a DLP payload encryption public key\n\nBefore you begin logging DLP payloads, you will need to set a DLP payload encryption public key.\n\n### Generate a key pair\n\nTo generate a public/private key pair in the command line, refer to [these instructions](https://developers.cloudflare.com/waf/managed-rules/payload-logging/command-line/generate-key-pair/).\n\n### Upload the public key to Cloudflare\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. In the **Set a DLP payload and prompt encryption public key** field, select **Edit**.\n3. Paste your public key.\n4. Select **Save**.\n\nNote\n\nThe matching private key is required to view logs. If you lose your private key, you will need to [generate](#1-generate-a-key-pair) and [upload](#2-upload-the-public-key-to-cloudflare) a new public key. The payload of new requests will be encrypted with the new public key.\n\n## Log the payload of matched rules\n\nDLP can log the payload of matched HTTP requests in your Cloudflare logs.\n\n### Turn on payload logging for a DLP policy\n\nYou can enable payload logging for any Allow or Block HTTP policy that uses the [*DLP Profile*](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#dlp-profile) selector.\n\n1. Go to **Traffic policies** > **Firewall policies** > **HTTP**.\n2. Edit an existing Allow or Block DLP policy, or [create a new policy](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy).\n3. In the policy builder, scroll down to **Configure policy settings** and turn on **Log the payload of matched rules**.\n4. Select **Save**.\n\nData Loss Prevention will now store a portion of the payload for HTTP requests that match this policy.\n\n### View payload logs\n\nTo view DLP payload logs:\n\n1. Go to **Insights** > **Logs** > **HTTP request logs**.\n2. Go to the DLP log you are interested in reviewing and expand the row.\n3. Select **Decrypt payload log**.\n4. Enter your private key and select **Decrypt**.\n\nYou will see the [ID of the matched DLP Profile](https://developers.cloudflare.com/api/resources/zero_trust/subresources/dlp/subresources/profiles/methods/list/) followed by the decrypted payload.\n\nNote\n\nCloudflare does not store the key or the decrypted payload.\n\n### Report false and true positives to AI context analysis\n\nWhen you have [AI context analysis](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/advanced-settings/#ai-context-analysis) turned on for a DLP profile, you can train the AI model to adjust its confident threshold by reporting false and true positives.\n\nTo report a DLP match payload as a false or true positive:\n\n1. [Find and decrypt](#4-view-payload-logs) the payload log you want to report.\n2. In **Log details**, choose a detected context match.\n3. In **Context**, select the redacted match data.\n4. In **Match details**, choose whether you want to report the match as a false positive or a true positive.\n\nBased on your report, DLP's machine learning will adjust its confidence in future matches for the associated profile.\n\n### Data privacy\n\n* All Cloudflare logs are encrypted at rest. Encrypting the payload content adds a second layer of encryption for the matched values that triggered a DLP rule.\n* Cloudflare cannot decrypt encrypted payloads, since this operation requires your private key. Cloudflare staff will never ask for the private key.\n* DLP will redact all predefined alphanumeric characters in the log. For example, `123-45-6789` will become `XXX-XX-XXXX`.\n  * You can define sensitive data with [Exact Data Match (EDM)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/#exact-data-match). EDM match logs will redact your defined strings.\n\n## Log generative AI prompt content\n\nDLP can detect and log the prompt topic sent to an AI tool.\n\n### Turn on AI prompt content logging for a DLP policy\n\nYou can enable payload logging for any Allow or Block HTTP policy that uses the [*Application*](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application) selector with a supported [Application Granular Controls](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application-granular-controls) application.\n\n1. Go to **Traffic policies** > **Firewall policies** > **HTTP**.\n2. Edit an existing Allow or Block DLP policy, or [create a new policy](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy).\n3. In the policy builder, scroll down to **Configure policy settings** and turn on **Capture generative AI prompt content in logs**.\n4. Select **Save**.\n\nData Loss Prevention will now store the user prompt and AI model response for requests that match this policy.\n\n### View prompt logs\n\nTo view generative AI prompt log details:\n\n1. Go to **Insights** > **Logs** > **HTTP request logs**.\n2. Go to the DLP log you are interested in reviewing and expand the row.\n3. Select **Decrypt payload log**.\n4. Enter your private key and select **Decrypt**.\n5. In **Summary** > **GenAI prompt captured**, select **View prompt**.\n\nGateway logs will provide a summary of the conversation, including the topic and AI model used, and the user prompt and AI model's raw response if available. A text prompt must be present for DLP to capture the prompt.\n\n## Send DLP forensic copies to Logpush destination\n\nAvailability\n\nOnly available on Enterprise plans.\n\nGateway allows you to send copies of entire HTTP requests matched in HTTP Allow and Block policies to storage destinations configured in [Logpush](https://developers.cloudflare.com/logs/logpush/), including third-party destinations. Forensic copies include unaltered payloads and headers which may include sensitive data. Logpush logs are encrypted in transit only, such as when sent as TLS traffic. Further encryption depends on your storage destination's policies.\n\nTo set up the DLP Forensic Copy Logpush job:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** >**Logs**, and select **Manage Logpush**.\n2. In Logpush, select **Create a Logpush job**.\n3. Choose a [Logpush destination](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/).\n4. In **Configure logpush job**, choose the *DLP forensic copies* dataset. Select **Create Logpush job**.\n5. Return to Cloudflare One and go to **Traffic policies** > **Firewall policies** > **HTTP**.\n6. Edit an existing Allow or Block policy, or [create a new policy](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy). Your policy does not need to include a DLP profile.\n7. In the policy builder, scroll down to **Configure policy settings** and turn on **Send DLP forensic copies to storage**.\n8. Select a storage destination. Gateway will list any configured Logpush jobs or integrations that can receive HTTP requests.\n9. Select **Save policy**.\n\nDLP will now send a copy of HTTP requests that match this policy to your Logpush destination.\n\nLogpush supports up to four DLP Forensic Copy Logpush jobs per account. By default, Gateway will send all matched HTTP requests to your configured DLP Forensic Copy jobs. To send specific policy matches to specific jobs, configure [Log filters](https://developers.cloudflare.com/logs/logpush/logpush-job/filters/). If the request contains an archive file, DLP will only send up to 100 MB of uncompressed content to your configured storage.\n\n</page>\n\n<page>\n---\ntitle: Profile settings  Cloudflare One docs\ndescription: This page lists the profile settings available when configuring a\n  predefined or custom DLP profile. You can configure profile settings when you\n  create a custom profile or edit profile settings for an existing predefined or\n  custom profile.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/advanced-settings/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/advanced-settings/index.md\n---\n\nThis page lists the profile settings available when configuring a [predefined](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/) or [custom](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile) DLP profile. You can configure profile settings when you create a custom profile or [edit profile settings](#edit-profile-settings) for an existing predefined or custom profile.\n\n## Edit profile settings\n\nTo edit profile settings for an existing predefined or custom DLP profile:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Profiles**.\n2. Choose a profile, then select **Edit**.\n3. In **Settings**, configure the [settings](#available-settings) for your profile.\n4. Select **Save profile**.\n\n## Available settings\n\nThe following advanced detection settings are available for predefined and custom DLP profiles.\n\n### Match count\n\nMatch count refers to the number of times that any enabled entry in the profile can be detected before an action is triggered, such as blocking or logging. For example, if you select a match count of 10, the scanned file or HTTP body must contain 11 or more matching strings. Detections do not have to be unique.\n\n### Optical Character Recognition (OCR)\n\nOptical Character Recognition (OCR) analyzes and interprets text within image files. When used with DLP profiles, OCR can detect sensitive data within images your users upload.\n\nOCR supports scanning `.jpg`/`.jpeg` and `.png` files between 4 KB and 1 MB in size. Text is encoded in UTF-8 format, including support for non-Latin characters.\n\n### AI context analysis Beta\n\nNote\n\nAI context analysis only supports Gateway HTTP and HTTPS traffic.\n\nAI context analysis uses a pretrained model to analyze and adjust the confidence in a detection based on its surrounding context. DLP will log any matches that are above your confidence threshold.\n\nDLP redacts any matched text, then submits the context as an AI text embedding vector to [Cloudflare Workers AI](https://developers.cloudflare.com/workers-ai/). Vectors are stored in user-specific private namespaces for up to six months, along with hit count and the [false positive/negative report](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#report-false-and-true-positives-to-ai-context-analysis).\n\nTo use AI context analysis:\n\n1. Choose the **Confidence threshold** in a DLP profile.\n2. [Add the profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy) to a DLP policy.\n3. When configuring the DLP policy, turn on [payload logging](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#log-the-payload-of-matched-rules).\n\nAI context analysis results will appear in the payload section of your [DLP logs](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#4-view-dlp-logs). To improve future detections of sensitive data, you need to [report false and true positives](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#report-false-and-true-positives-to-ai-context-analysis).\n\n### Confidence thresholds\n\nConfidence thresholds indicate how confident Cloudflare DLP is in a DLP detection. DLP determines the confidence by inspecting the content for proximity keywords around the detection.\n\nConfidence threshold is set on the DLP profile. When you select a confidence threshold in Cloudflare One, you will see which DLP entries will be affected by the confidence threshold. Entries that do not reflect a confidence threshold in Cloudflare One are not yet supported or are not applicable.\n\nDLP confidence detections consist of Low, Medium, and High confidence thresholds. DLP will default to Low confidence detections, which are based on regular expressions, require few keywords, and will trigger more often. Medium and High confidence detections require more keywords, will trigger less often, and have a higher likelihood of accuracy.\n\nTo change the confidence threshold of a DLP profile:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Profiles**.\n2. Select the profile, then select **Edit**.\n3. In **Settings** > **Confidence threshold**, choose a new confidence threshold from the dropdown menu.\n4. Select **Save profile**.\n\nSetting the confidence to Low will also consider Medium and High confidence detections as matches. Setting the confidence to Medium or High will filter out lower confidence detections.\n\n#### Gateway detections\n\nFor inline detections in Gateway, to display Low and Medium confidence detections but block High confidence detections, Cloudflare recommends creating two HTTP policies. The first policy should use a Low confidence DLP profile with an Allow action. The second policy should use a High confidence DLP profile with a Block action. For example:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| DLP Profile | in | *Low Confidence Detections* | Allow |\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| DLP Profile | in | *High Confidence Detections* | Block |\n\n</page>\n\n<page>\n---\ntitle: Integration profiles  Cloudflare One docs\ndescription: Cloudflare DLP integration profiles enable data loss prevention\n  support for third-party data classification providers. Data classification\n  information is retrieved from the third-party platform and populated into a\n  DLP Profile. You can then enable detection entries in the profile and create a\n  DLP policy to allow or block matching data.\nlastUpdated: 2025-11-13T15:48:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/integration-profiles/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/integration-profiles/index.md\n---\n\nNote\n\nIntegration profiles require [Cloudflare CASB](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/).\n\nCloudflare DLP integration profiles enable data loss prevention support for third-party data classification providers. Data classification information is retrieved from the third-party platform and populated into a DLP Profile. You can then enable detection entries in the profile and create a DLP policy to allow or block matching data.\n\nDetection entries in integration profiles are managed by the third-party platform and cannot be manually added, edited, or deleted within Cloudflare DLP.\n\n## Microsoft Purview Information Protection (MIP) sensitivity labels\n\nMicrosoft provides [Purview Information Protection sensitivity labels](https://learn.microsoft.com/en-us/purview/sensitivity-labels) to classify and protect sensitive data.\n\nWarning\n\nDLP does not filter or log [MIP sublabels](https://learn.microsoft.com/purview/sensitivity-labels#sublabels-that-use-parent-labels-or-label-groups). Only top-level sensitivity labels will be detected, filtered, and logged.\n\nTo ensure DLP will detect and filter all sensitive data, use only [MIP top-level labels](https://learn.microsoft.com/purview/sensitivity-labels#top-level-labels).\n\n### Setup\n\nTo add MIP sensitivity labels to a DLP Profile, simply integrate your Microsoft account with [Cloudflare CASB](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/). A new integration profile will appear under **Data loss prevention** > **DLP profiles**. The profile is named **MIP Sensitivity Labels** followed by the name of the CASB integration.\n\nMIP sensitivity labels can also be added to a [custom DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile) as an existing entry.\n\n### Syncing\n\nAllow 24 hours for label additions and edits in your Microsoft account to propagate to Cloudflare DLP. Deletions in your Microsoft account will not delete entries in your Cloudflare DLP Profile.\n\n</page>\n\n<page>\n---\ntitle: Predefined profiles  Cloudflare One docs\ndescription: Cloudflare Zero Trust provides predefined DLP profiles for common\n  types of sensitive data. Some profiles include built-in validation checks to\n  increase detection granularity. Additionally, you can configure advanced\n  settings for predefined profiles.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/index.md\n---\n\nCloudflare Zero Trust provides predefined DLP profiles for common types of sensitive data. Some profiles include built-in validation checks to increase detection granularity. Additionally, you can configure [advanced settings](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/advanced-settings/) for predefined profiles.\n\n## AI Prompt\n\nDLP provides AI prompt protection with the following predefined profiles:\n\n* AI Prompt: AI Security\n* AI Prompt: Customer\n* AI Prompt: Financial Information\n* AI Prompt: PII\n* AI Prompt: Technical\n\nFor more information on included detection entries, refer to [AI prompt topics](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/#ai-prompt-topics).\n\n## Credentials and Secrets\n\nThe following secrets are validated with regex.\n\n* Google Cloud Platform keys\n* AWS keys\n* Azure API keys\n* SSH keys\n\n## Financial Information\n\nAvailability\n\nThis predefined profile is available on all Zero Trust plans.\n\nCredit card numbers begin with a six or eight-digit Issuer Identification Number (IIN) and are followed by up to 23 additional digits. Card verification values (CVVs) are not validated.\n\n| Detection entry | Notes |\n| - | - |\n| American Express Card Number | Validated using [Luhn's algorithm](https://en.wikipedia.org/wiki/Luhn_algorithm). |\n| American Express Text | Text matching `amex` or `american express`. |\n| Diners Club Card Number | Validated using Luhn's algorithm. |\n| Generic CVV Card Number | Validated with regex. |\n| Mastercard Card Number | Validated using Luhn's algorithm. |\n| Mastercard Text | Text matching `mastercard`. |\n| Union Pay Card Number | Validated using Luhn's algorithm. |\n| Union Pay Text | Text matching `union pay`. |\n| Visa Card Number | Validated using Luhn's algorithm. |\n| Visa Text | Text matching `visa`. |\n| United States ABA Routing Number | Validated algorithmically with checksum. |\n| IBAN | Validated with checksum. |\n\n## Health Information\n\nThe following diagnosis and medication names are checked for surrounding ASCII characters to prevent false positives.\n\n* FDA active ingredients\n* FDA drug names\n* ICD-10 FY2023 short descriptions\n\n## Social Security, Insurance, Tax, and Identifier Numbers\n\nAvailability\n\nThis predefined profile is available on all Zero Trust plans.\n\nThe following national identifier detections are validated algorithmically when possible.\n\n| Detection entry | Notes |\n| - | - |\n| United States SSN Numeric Detection | Commonly used separators are required to match the detection entry. For example, `000-00-0000` matches but `000000000` does not. Social security numbers do not adhere to algorithmic validation. |\n| Social Security Number Text | Text matching `ssn` or `social security`. |\n| Australia Tax File Number | Validated with checksum. |\n| Canada Social Insurance Number | Validated using Luhn's algorithm. |\n| France Social Security Number | Validated with regex. |\n| Hong Kong Identity Card (HKIC) Number | Validated with checksum. |\n| Indonesia Identity Card Number | Validated with regex. |\n| Malaysian National Identity Card Number | Validated with regex. |\n| Philippines Unified Multi-Purpose ID (UMID) Number | Validated with regex. |\n| Singapore National Registration Identity Card Number | Validated with checksum. |\n| Taiwan National Identification Number | Validated with checksum. |\n| Thai Identity Card Number | Validated with checksum. |\n| United Kingdom NHS Number | Validated with checksum. |\n| United Kingdom National Insurance Number | Validated with regex. |\n\n## Source Code\n\nThe following programming languages are validated with natural language processing (NLP).\n\n* C\n* C++\n* C#\n* Go\n* Haskell\n* Java\n* JavaScript\n* Lua\n* Python\n* R\n* Rust\n* Swift\n\n</page>\n\n<page>\n---\ntitle: Manage Email security directories  Cloudflare One docs\ndescription: You can manage your Email security directory by editing and\n  deleting added users.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-es-directories/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-es-directories/index.md\n---\n\nYou can manage your Email security directory by editing and deleting added users.\n\nRegistered users\n\nThe Email security directory contains registered users only. A registered user is a user added to the [impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/).\n\nTo modify or delete users in the Email security directory:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security** > **Directories**.\n2. Select **Email security Directory**.\n\n## Add a user\n\nTo manually add a user to the Email security directory:\n\n1. On the sidebar, go to **Settings** > **Impersonation registry** > **View**.\n2. Select **Add a user**:\n\n* Choose **Manual input** as the **Input method**.\n* Under **User info**, enter the **Display name**.\n* Under **User email**, enter the **Email addresses**.\n\n1. Select **Save**.\n\nTo view users you manually added:\n\n1. Go to **Directories**.\n2. Select **Email security Directory**.\n3. Any manually added user will be displayed under the table as **REGISTERED**.\n\n## Edit a user\n\nTo edit a user in the Email security directory:\n\n1. Select the user you want to edit.\n2. Select the three dots > **Edit**.\n3. Enter a user name and/or email.\n4. Select **Save**.\n\n## Delete a user\n\nTo delete a user from the Email security directory:\n\n1. Select the user you want to delete.\n2. Select the three dots > **Delete**.\n3. Read the pop-up message, and then select **Delete user**.\n\nTo delete multiple users from the registry at once:\n\n1. Select the users you want to delete.\n2. Select the **Action** dropdown list > **Delete**.\n\n</page>\n\n<page>\n---\ntitle: Manage integrated directories  Cloudflare One docs\ndescription: \"To manage an integrated directory:\"\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-integrated-directories/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-integrated-directories/index.md\n---\n\nTo manage an integrated directory:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security**.\n3. Select **Directories**.\n4. Under **Directory name**, select your directory.\n5. You will be redirected to a page where you can manage [Groups](https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-integrated-directories/manage-groups-directory/) or [Users](https://developers.cloudflare.com/cloudflare-one/email-security/directories/manage-integrated-directories/manage-users-directory/) directories.\n\n</page>\n\n<page>\n---\ntitle: Search email  Cloudflare One docs\ndescription: With Email security, you can use different screen criteria to\n  search through your email, reclassify and move a certain volume of messages,\n  find similar emails, and export messages.\nlastUpdated: 2025-12-15T12:59:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/index.md\n---\n\nWith Email security, you can use different screen criteria to search through your email, reclassify and move a certain volume of messages, find similar emails, and export messages.\n\n## Screen criteria\n\nEmail security allows you to use popular, regular, and advanced screening criteria to search through your inbox. Advanced screening will give you the most in-depth investigation of your inbox.\n\nTo screen through your email traffic:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security**.\n3. Select **Investigation**, then **Run new screen**.\n4. Choose between **Popular**, **Regular**, and **Advanced** screen methods. Refer to the explanation below to learn what each method does.\n\nThe results will be displayed on a table. The table allows you to review and take action on the messages that match your chosen screening criteria.\n\n### Popular screen\n\nA popular screen allows you to view messages based on common pre-defined criteria.\n\nTo use a popular screen criteria:\n\n1. Under **Method**, select **Popular screens**.\n\n2. Select one of the following criteria:\n\n   * **Moved emails**: View emails automatically or manually moved within the last seven days.\n   * **Reclassified emails**: Emails that had their disposition reclassified within the last seven days.\n   * **Malicious emails**: Emails assigned the malicious disposition within the last seven days.\n   * **Spoof emails**: Emails assigned the spoof disposition within the last seven days.\n   * **Suspicious emails**: Emails assigned the suspicious disposition within the last seven days.\n   * **Spam emails**: Emails assigned to the spam disposition within the last seven days.\n\n3. Select **Run screen**.\n\nTo modify your screening criteria, under **Active screen criteria**, select **Modify**.\n\n### Regular screen\n\nA regular screen allows you to investigate your inbox by inserting a term to screen across all criteria.\n\nTo use a regular screen criteria:\n\n1. Under **Method**, select **Regular screen**.\n2. Select a **Date range**.\n3. Enter a keyword.\n4. Select **Run screen**.\n\nTo include all emails as part of the search, enable **Include all mail**.\n\nTo modify your screening criteria, under **Active screen criteria**, select **Modify**.\n\nTo reset your screening criteria, select **Reset**.\n\n### Advanced screen\n\nThe advanced screen criteria gives you the option to narrow message results based on specific criteria. The advanced screen has several options (such as keywords, subject keywords, sender domain, and more) to scan your inbox.\n\nTo use advanced screen criteria:\n\n1. Under **Method**, select **Advanced screen**.\n2. (Required) Select a date range.\n3. (Optional) Fill in the other fields. All fields, except for Subject, must be filled with one value only.\n4. Select **Run screen**.\n\nTo include all emails as part of the search, enable **Include all mail**.\n\nTo modify your screening criteria, under **Active screen criteria**, select **Modify**.\n\nTo reset your screening criteria, select **Reset**.\n\n## Move messages\n\nMoving messages allows you to move messages to a specific folder. You can move up to 1,000 messages at a time.\n\nTo move messages:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security**, and select **Investigation**.\n\n2. On the Investigation page, select all the messages you want to move.\n\n3. Select the **Action** dropdown, then select **Move**.\n\n4. Select among one of the following folders:\n\n   * **Inbox**: Move messages to the primary email folder.\n   * **Junk email**: Move messages to the junk or spam folder.\n   * **Trash**: Move messages to the trash or deleted items email folder.\n   * **Soft delete (user recoverable)**: Move messages to the user's Deleted Items folder. This option is for Microsoft 365 only.\n   * **Hard delete (admin recoverable)**: Delete messages from a user's inbox.\n\n5. Select **Save**.\n\nTo move messages in bulk, select **Select all messages** > **Action** > **Move**.\n\n## Find similar emails\n\nEach detection has an Email Detection Fingerprint (EDF) hash that Email security sends to the Search API to retrieve similar detections.\n\nTo find similar detection results:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security**, and select **Investigation**.\n2. On the Investigation page, under **Your matching messages**, search for the **Similar emails** column.\n3. Select the number of similar emails. Selecting the number will show you a list of similar emails.\n\n## Export messages\n\nWith Email security, you can export messages to a CSV file.\n\nTo export messages:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security**, and select **Investigation**.\n2. On the Investigation page, under **Your matching messages**, select **Export to CSV**.\n3. Select **Export messages** on the pop-up message. You can export up to 500 messages from the dashboard. To export up to 1,000 matching messages, use the [API](https://developers.cloudflare.com/api/resources/email_security/subresources/investigate/methods/get/).\n\nTo export messages in bulk, select **Select all messages** > **Export to CSV**.\n\n## Email status\n\nEmail security allows you to review the status and actions of each email.\n\nTo view status and actions for each email:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security**, and select **Investigation**.\n2. On the Investigation page, select the three dots.\n3. Selecting the three dots will show you the following options:\n\n* If the email is quarantined:\n\n  * **View details**: Refer to [Email details](#email-details) to learn more.\n  * **View similar emails**: Find similar emails based on the `value_edf_hash` (Electronic Detection Fingerprint hash).\n  * **Release**: Email security will no longer quarantine your chosen messages.\n  * **Submit for review**: Choose the dispositions of your messages if they are incorrect. Refer to [Reclassify messages](#reclassify-messages) to learn more.\n\n* If the email is not quarantined:\n\n  * **View details**.\n  * **View similar emails**.\n  * **View submission detail**.\n  * **[Move](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/)** (only available if you authorized moves).\n  * **[Submit for review](#reclassify-messages)**.\n\n## Email details\n\nEmail security shows you the following email detail information:\n\n* Details\n* Action log\n* Raw message\n* Mail trace\n\n### Details\n\nEmail security displays the following details:\n\n1. **Threat type**: Threat type of the email, for example, [credential harvester](https://developers.cloudflare.com/cloudflare-one/email-security/reference/how-es-detects-phish/), and [IP-based spam](https://developers.cloudflare.com/cloudflare-one/email-security/reference/how-es-detects-phish/).\n\n2. **Validation**: Email validation methods [SPF](https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/), [DKIM](https://www.cloudflare.com/learning/dns/dns-records/dns-dkim-record/), [DMARC](https://www.cloudflare.com/learning/dns/dns-records/dns-dmarc-record/). The dashboard will display Pass if SPF, DKIM and DMARC checks have passed.\n\n3. **Sender details**: Information include:\n\n   * IP address\n   * Registered domain\n   * Autonomous sys number: This number identifies your [autonomous system (AS)](https://www.cloudflare.com/en-gb/learning/network-layer/what-is-an-autonomous-system/).\n   * Autonomous sys name: This name identifies your autonomous system (AS).\n   * Country\n\n4. **Links identified**: A list of malicious links identified by Email security. Refer to [Open links](#open-links) to open links in Security Center, Browser Isolation or an external tool of your choice.\n\n5. **Attachments**: If an email has an attachment, the Cloudflare dashboard will display the filename, and the disposition assigned. You can open attachments in [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/). Only PDF files are currently supported.\n\n6. **Reasons for disposition**: Description of why the email was deemed as malicious, suspicious, or spam. The dashboard also displays [Cloudy summaries](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/#cloudy-summaries).\n\n#### Cloudy summaries\n\nThe Cloudflare dashboard uses [Cloudy](https://developers.cloudflare.com/fundamentals/reference/cloudy-ai-agent/) to explain why an email was classified as unwanted.\n\nCloudy analyzes the underlying detection code and generates a description of the specific detection logic that led to an email final disposition. Each summary provides a rating option that allows you to provide feedback to the Email security team. Cloudy summaries are only available for emails with a final [disposition](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n\n**View all signatures** allows you to view all the detections that triggered on the email, including detections that did not determine the final disposition.\n\n#### Open links\n\nYou can open links in Security Center or [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/), or copy and paste the link so you can investigate content in external tools.\n\nTo open links in Security Center:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Email security** > **Investigation**.\n2. Locate the message you want to open links for, select the three dots, then select **View details**.\n3. Under **Details**, go to **Links identified**.\n4. Locate the link you want to open, and select **Open in Security Center**.\n5. You will be redirected to Investigate in the Cloudflare dashboard.\n6. Select **Scan now**.\n7. The dashboard will generate a report for your link.\n\nTo open links in Browser Isolation:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Email security** > **Investigation**.\n2. Locate the message you want to open links for, select the three dots, then select **View details**.\n3. Under **Details**, go to **Links identified**.\n4. Locate the link you want to open, and select **Open in Browser Isolation**.\n5. The link will open in a separate window where you will be able to browse the content securely.\n\nAlternatively, you can directly [open links in Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/#open-links-in-browser-isolation).\n\nNote\n\nIf you purchased Gateway and [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/), you can perform more actions when opening links.\n\nWhen opening links, Email security will not allow you to:\n\n* [Copy (from remote to client)](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n* [Paste (from client to remote)](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n* Use [keyboard](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n* [Print](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n* [Download files](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n* [Uploads files](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/)\n\nTo open and investigate a link in an external tool:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Email security** > **Investigation**.\n2. Locate the message you want to open links for, select the three dots, then select **View details**.\n3. Under **Details**, go to **Links identified**.\n4. Locate the link you want to open, and select **Copy URL**.\n5. Paste the link in your external tool.\n\nWarning\n\nYou may encounter a `400 Bad Request` error after turning Clientless Web Isolation on.\n\nIf you encounter this error:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Settings** > **Resources**.\n2. Select **Generate certificate**.\n3. Choose the **Expiration** (5 years is recommended), then select **Generate certificate**. Your certificate is now generated, and the dashboard will display its Deployment Status as INACTIVE.\n4. Select the three dots, and then select **Activate** to activate your certificate.\n5. Select the three dots, and then select **Mark as in-use**.\n6. Your certificate deployment status should display AVAILABLE IN-USE.\n\n### Action log\n\nAction log allows you to review post-delivery actions performed on your selected message. The action log displays:\n\n* **Date**: Date when the post-delivery action was performed.\n* **Activity**: The activity taken on an email. For example, moving the email to the trash folder, releasing a quarantined email, and more.\n\n### Raw message\n\nRaw message allows you to view the raw details of the message. You can also choose to download the email message. To download the message, select **Download .EML**.\n\n### Mail trace\n\nMail trace allows you to track the path your selected message took from the sender to the recipient. Mail trace displays:\n\n* **Date**: The date and time when the mail was tracked.\n* **Type**: An email can be inbound (email sent to you from another email), or outbound (emails sent from your email address).\n* **Activity**: The activity taken on an email. For example, moving the email to the trash folder, releasing a quarantined email, and more.\n\n</page>\n\n<page>\n---\ntitle: Download a report  Cloudflare One docs\ndescription: \"Email security allows you to download three types of reports:\"\nlastUpdated: 2025-12-04T22:38:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/download-report/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/download-report/index.md\n---\n\nEmail security allows you to download three types of reports:\n\n* Disposition report\n* Retro scan report\n* Security report\n\n## Download a disposition report\n\nA disposition report shows you all the email messages based on the type of disposition you selected.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), select **Email security**.\n2. Select **Monitoring** > **Download report**.\n3. In **Report type**, select **Email disposition report**.\n4. Under **Email disposition report**, select the **Date Range** (required), and the **Disposition**.\n5. Select **Export to CSV**.\n\nRefer to [Dispositions and attributes](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/) to learn more.\n\n## Download a retro scan report\n\nRetro scan scans the last 14 days of your emails, and gives you a report on bulk, spam, spoof, suspicious and malicious emails.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), select **Email security**.\n2. Select **Monitoring** > **Download report**.\n3. In **Report type**, select **Retro Scan report**.\n4. Select **View report** to view a report of your last 14 days of emails.\n\nRefer to [Retro Scan](https://developers.cloudflare.com/cloudflare-one/email-security/retro-scan/) to learn more.\n\n## Download a security report\n\nA security report provides an overview of your email traffic. The report can be generated on the last 30, 60, 90 days, or a timeframe of your choice.\n\nThe reports contains:\n\n* An executive summary: A summary of the threats detected in your organization's email traffic in the last 30 days.\n* Threat detection: Review metrics regarding dispositions, policy detection, and impersonation attempts.\n* Submissions: Review the metrics of emails your security team or users have requested to reclassify.\n\nTo download a security report:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), select **Email security**.\n2. Select **Monitoring** > **Download report**.\n3. In **Report type**, select **Security report** and the **Date range**.\n4. Select **Generate report**.\n5. Your security report is being generated. You will receive an email with the security report attached once it is ready.\n\n</page>\n\n<page>\n---\ntitle: Dispositions and attributes  Cloudflare One docs\ndescription: Email security uses a variety of factors to determine whether a\n  given email message, domain, URL, or packet is part of a phishing campaign.\n  These small pattern assessments are dynamic in nature and  in many cases  no\n  single pattern will determine the final verdict.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/index.md\n---\n\nEmail security uses a variety of factors to determine whether a given email message, domain, URL, or packet is part of a phishing campaign. These small pattern assessments are dynamic in nature and  in many cases  no single pattern will determine the final verdict.\n\nDetection vs. disposition\n\nDetection is the process Email security does to identify what threat an email may contain. An email can have multiple detections, but they will only have one and final disposition. The detections an email have will determine the disposition of the email.\n\n## Dispositions\n\nAny traffic that flows through Email security is given a final disposition, which represents our evaluation of that specific message. Each message will receive only one disposition header, so your organization can take clear and specific actions on different message types.\n\nYou can use disposition values when [setting up auto-moves](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/).\n\n### Available values\n\nThe following disposition values follow an order of maliciousness:\n\n* **Malicious**: Traffic associated with active threat campaigns. Malicious messages invoked multiple phishing verdict triggers and met thresholds for bad behavior.\n  * **Recommendation**: Block.\n* **Suspicious**: Traffic associated with phishing campaigns (and is under further analysis by our automated systems).\n  * **Recommendation**: Research these messages internally to evaluate legitimacy.\n* **Spam**: Traffic associated with non-malicious, commercial campaigns.\n  * **Recommendation**: Route to existing Spam quarantine folder.\n* **Spoof**: Traffic associated with phishing campaigns that is either non-compliant with your email authentication policies ([SPF](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-spf-record/), [DKIM](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-dkim-record/), [DMARC](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-dmarc-record/)) or has mismatching `Envelope From` and `Header From` values.\n  * **Recommendation**: Block after investigating (can be triggered by third-party mail services).\n* **Bulk**: Traffic often associated with newsletters or marketing campaigns. Refer to [Graymail](https://en.wikipedia.org/wiki/Graymail_%28email%29) for more details.\n  * **Recommendation**: Monitor or tag.\n\n### Header structure\n\nWhen Email security adds a disposition header to an email message, that header matches the following format:",
      "language": "unknown"
    },
    {
      "code": "Note that emails with a disposition of `SPAM` will be tagged with `UCE` (unsolicited commercial emails) in their headers:",
      "language": "unknown"
    },
    {
      "code": "## Attributes\n\nTraffic that flows through Email security can also receive one or more Attributes, which indicate that a specific condition has been met.\n\n### Available values\n\n| Attribute | Notes |\n| - | - |\n| `CUSTOM_BLOCK_LIST` | This message matches a value you have defined in your custom block list. |\n| `NEW_DOMAIN_SENDER=<REGISTRATION_DATE>` | Alerts to mail from a newly registered domain. Formatted as yyyy-MM-dd HH:mm:ss ZZZ. |\n| `NEW_DOMAIN_LINK=<REGISTRATION_DATE>` | Alerts to mail with links pointing out to a newly registered domain. Formatted as yyyy-MM-dd HH:mm:ss ZZZ. |\n| `ENCRYPTED` | Email message is encrypted. |\n| `EXECUTABLE` | Email message contains an executable file. |\n| `BEC` | Indicates that an email address was contained in your [impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/) list. Associated with `MALICIOUS` or `SPOOF` dispositions. |\n\n### Header structure\n\nWhen Email security adds a disposition header to an email message, that header matches the following format:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: How Email security detects phish  Cloudflare One docs\ndescription: Email security uses a variety of factors to determine whether a\n  given email message, a web domain or URL, or specific network traffic is part\n  of a phishing campaign (marked with a Malicious disposition) or other common\n  campaigns (for example, Spam).\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/reference/how-es-detects-phish/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/reference/how-es-detects-phish/index.md\n---\n\nEmail security uses a variety of factors to determine whether a given email message, a web domain or URL, or specific network traffic is part of a phishing campaign (marked with a [`Malicious` disposition](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/)) or other common campaigns (for example, `Spam`).\n\nNote\n\nCertain URL rewrite schemes cannot be decoded (for example, Mimecast).\n\nThese small pattern assessments are dynamic in nature and  in many cases  no single one in and of itself will determine the final verdict. Instead, our automated systems use a combination of factors and non-factors to clearly distinguish between a valid phishing campaign and benign traffic.\n\n## Sample attack types and detections\n\n### Malicious payload attached to the message\n\n* **Example**: Classic campaign technique which utilizes a variety of active attachment types (EXE, DOC, XLS, PPT, OLE, PDF, and more) as the malicious payload for ransomware attacks, Trojans, viruses, and malware.\n* **Detections applied**: Machine learning (ML) models on binary bitmaps of the payload as well as higher-level attributes of the payload, with specific focus on signatureless detections for maximum coverage. Additionally, for relevant active payloads, the engine invokes a real-time sandbox to assess behavior and determine maliciousness.\n\n### Encrypted malicious payload attached to the message, with password in message body as text\n\n* **Example**: Campaigns that induce the user to apply a password within the message body to the attachment.\n* **Detections applied**: Real-time lexical parsing of message body for password extraction and ML models on binary bitmaps of the payload, signatureless detections for maximum coverage.\n\n### Encrypted malicious payload attached to the message, with password in message body as an image\n\n* **Example**: Campaigns that induce the user to apply a password within the message body to the attachment, with the entire body or part of the body being an image.\n* **Detections applied**: Real-time OCR parsing of message body for password extraction and ML models on binary bitmaps of the payload, signatureless detections for maximum coverage.\n\n### Malicious payload within an archive attached to the message\n\n* **Example**: Campaigns with payloads within typical archives, such as `.zip` files.\n* **Detections applied**: ML detection tree on the payload, as well as decomposition of each individual archive into component parts and fragments for compound documents.\n\n### Malicious URLs within message body\n\n* **Example**: Typical phish campaigns with a socially engineered call to action URL that will implant malware (for example, Watering Hole attacks, Malvertizing, or scripting attacks).\n* **Detections applied**: Continuous web crawling, followed by real-time link crawling for a select group of suspicious urls, followed by machine learning applied to URL patterns in combination with other pattern rules and topic-based machine learning models for exhaustive coverage of link-based attacks.\n\n### Malicious payload linked through a URL in a message\n\n* **Example**: Campaigns where the URL links through to a remote malicious attachment (for example, in a `.doc` or `.pdf` file).\n* **Detections applied**: Remote document and/or attachment extraction followed by ML detection tree on the payload, instant crawl of links.\n\n### Blind URL campaigns\n\n* **Example**: Entirely new domain with intentional obfuscation, seen for the first time in a campaign.\n* **Detections applied**: Link structure analysis, link length analysis, domain age analysis, neural net models on entire URL as well as domain and IP reputation of URL host, including autonomous system name reputation and geolocation based reputation.\n\n### Malicious URLs within a benign attachment in the message\n\n* **Example**: Campaigns obfuscating the payload within attachments.\n* **Detections applied**: URL extraction within attachments, followed by above mentioned URL detection mechanisms.\n\n### Malicious URLs within an archive attached to the message\n\n* **Example**: Campaigns obfuscating the payload within attachments.\n* **Detections applied**: Attachments decomposed recursively (both in archive formats and compound document formats) to extract URLs, followed by above mentioned URL detection mechanisms.\n\n### Malicious URLs behind URL shortening services\n\n* **Example**: Campaigns leveraging Bitly, Owly, and similar services at multiple levels of redirection to hide the target URL.\n* **Detections applied**: URL shorteners crawled in real time at the moment of message delivery to get to the eventual target URL, followed by URL detection methods. Real-time shorterners are intentionally not crawled ahead of time due to the dynamic nature of these services and the variation of target URLs based on time and source.\n\n### Malicious URLs associated with QR codes (QR Code Phishing Attacks, Quishing)\n\n* **Example**: Campaigns leveraging QR code image attachment to deliver malicious payload links for malware distribution and/or credential harvesting.\n* **Detections applied**: Resolving for images resembling QR codes into URL, followed by above mentioned URL detection mechanisms.\n\n### Instant crawl of URLs within message body\n\n* **Example**: Typical phish campaigns with a socially engineered call to action URL that will implant a malware (for example, Watering Hole attacks, Malvertizing, or scripting attacks).\n* **Detections applied**: Heuristics applied to URLs in message bodies that are not already detected from ahead of time crawling and those deemed suspicious according to strict criteria are crawled in real time.\n\n### Credential Harvesters\n\n* **Example**: Form-based credential submission attacks, leveraging known brands (Office 365, PayPal, Dropbox, Google, and more).\n* **Detections applied**: Continuous web crawling, computer vision on top brand lures, ML models, and infrastructure association.\n\n### Domain Spoof Attacks\n\n* **Example**: Campaigns spoofing sender domains to refer to the recipient domain or some known partner domain.\n* **Detections applied**: Header mismatches, email authentication assessments, sender reputation analysis, homographic analysis, and punycode manipulation assessments.\n\n### Domain proximity attacks\n\n* **Example**: Campaigns taking advantage of domain similarity to confuse the end user (for example, `sampledoma1n.com` or `sampledomaln.com` compared to `sampledomain.com`).\n* **Detections applied**: Header mismatches, email authentication assessments, and sender reputation analysis.\n\n### Email Auth violations\n\n* **Example**: Campaigns taking advantage of incorrect or invalid sender Auth records (SPF/DKIM/DMARC) and bypassing incoming Auth-based controls.\n* **Detections applied**: Assessment of sender authentication records against published SPF/DKIM/DMARC records which is applied in combination with overall message attributes.\n\n### Name Spoof Attacks / Executive Attacks (BEC)\n\n* **Example**: Campaigns targeting executives and high-value targets within the organization or using the high-value targets as sources to attack other employees within the organization.\n* **Detections applied**: Display names compared with known executive names for similarity using several matching models including the Levenshtein algorithm, and if matched, flagged when sender is originating from an unknown domain.\n\n### Fileless / Linkless campaigns (BEC)\n\n* **Example**: Typically BEC campaigns with an offline call to action (call me, wire money, invoice, or others).\n* **Detections applied**: Message lexical analysis, subject analysis, word count assessments, and sender analysis.\n\n### Deferred campaign attacks\n\n* **Example**: Campaigns that have no malicious payload and the URL is clean when delivered, but is activated in a deferred manner (3-4 hours later), so the end user is compromised at click time.\n* **Detections applied**: URL rewrites and/or DNS blocks.\n\n### IP-based spam\n\n* **Example**: Volume-based, large scale spam campaigns primarily originating from compromised IP address spaces or botnets.\n* **Detections applied**: Sender and IP reputation, history, and volume analysis.\n\n### Content-based spam\n\n* **Example**: Commodity spam largely focused on selling wares.\n* **Detections applied**: Sender reputation, history, volume analysis, and message content analysis for commercial intent.\n\n### Web phishing\n\n* **Example**: Directly originated or targeted through web (for example, LinkedIn, Malvertizing, and more).\n* **Detections applied**: Web and DNS service and network device integrations, like web proxies and firewalls.\n\n### Mobile phishing\n\n* **Example**: Remote employee getting phished while outside the corporate network.\n* **Detections applied**: Employee email protection and web and DNS services enforcement in remote users (typically through an MDM integration or an always-on VPN solution).\n\n### Network phishing\n\n* **Example**: C2 communications for lateral spread within the network or malicious phish downloaded from an external host. Typically seen when an end user gets infected outside the organization, comes back into the network and the C2 hosts uses the infected endpoint to download the implant based on the IP address space it is now resident in.\n* **Detections applied**: Network device integrations (firewalls) and API-based integrations within existing orchestration services.\n\n</page>\n\n<page>\n---\ntitle: Auto-move events  Cloudflare One docs\ndescription: Auto-move events are events where emails are automatically moved to\n  different inboxes based on the disposition Email security assigned to them.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/index.md\n---\n\nAuto-move events are events where emails are automatically moved to different inboxes based on the disposition Email security assigned to them.\n\nEmail security shows you the total number of auto-moves and the source folder from which these moves are originating from.\n\nTo configure auto-move events:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n\n2. Select **Email security**.\n\n3. Select **Settings**.\n\n4. Select **Moves**.\n\n5. Under **Auto-moves**, select **Configure**.\n\n6. Assign actions based on malicious, spoof, suspicious, spam, and bulk dispositions. Select among:\n\n   * **Soft delete - user recoverable**: Moves the message to the user's **Recoverable Items - Deleted** folder. Messages can be recovered by the user.\n   * **Hard delete - admin recoverable**: Completely deletes messages from a user's inbox.\n   * **Move to trash**: Moves messages to the trash or deleted items email folder.\n   * **Move to junk**: Moves the message to the junk or spam folder.\n   * **No action**: Messages stay in the origin folder.\n\n7. Select **Post-delivery** moves:\n\n   * **(Recommended) Post-delivery response**: Enabling this option allows Email security to rescan delivered emails at multiple time intervals for previously unknown phishing sites or campaigns.\n   * **(Recommended) Phish submission response**: Enabling this option allows Email security to move emails that your users reported as phishing and Email security determined to be malicious.\n\n8. Select **Save**.\n\n</page>\n\n<page>\n---\ntitle: Domain management  Cloudflare One docs\nlastUpdated: 2025-10-27T11:42:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/settings/domain-management/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/settings/domain-management/index.md\n---\n\n* [Information about your domain](https://developers.cloudflare.com/cloudflare-one/email-security/settings/domain-management/domain/)\n\n</page>\n\n<page>\n---\ntitle: Detection settings  Cloudflare One docs\nlastUpdated: 2025-10-27T11:42:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/index.md\n---\n\n* [Allow policies](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/allow-policies/)\n* [Blocked senders](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/blocked-senders/)\n* [Trusted domains](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/trusted-domains/)\n* [Impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/)\n* [Additional detections](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/additional-detections/)\n* [Configure link actions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/configure-link-actions/)\n* [Configure text add-ons](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/configure-text-add-ons/)\n\n</page>\n\n<page>\n---\ntitle: Phish submissions  Cloudflare One docs\ndescription: As part of your continuous email security posture, administrators\n  and security analysts need to submit missed phishing samples to Email\n  security, so Cloudflare can process them and take necessary action.\nlastUpdated: 2025-12-04T22:38:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/index.md\n---\n\nAs part of your continuous email security posture, administrators and security analysts need to submit missed phishing samples to Email security, so Cloudflare can process them and take necessary action.\n\nSubmitting missed phish samples to Cloudflare is of paramount importance and necessary for continuous protection. Submitting missed phish samples helps Cloudflare improve our machine learning (ML) models, and alerts us of new attack vectors before they become prevalent.\n\nThere are three routes you can use to report an email as a phish:\n\n* Via Investigation, by [reclassifying an email](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/#reclassify-an-email).\n* Via [PhishNet 365](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/phishnet-365/).\n* Via [Submission addresses](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/submission-addresses/).\n\n## Reclassify an email\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security** > **Investigation**.\n3. On the **Investigation** page, under **Your matching messages**, select the message you want to reclassify. Select the three dots, then select **Submit for review**. By selecting **Submit for review**, you are requesting a new disposition for the message.\n4. Select the new disposition, then select **Save**.\n\nWhen you report an email as phish, this email will be displayed under [User submissions](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/user-submissions/).\n\n</page>\n\n<page>\n---\ntitle: Manage domains  Cloudflare One docs\ndescription: Once you have deployed your domain, Email security allows you to\n  filter and edit domains. You can also choose to stop a domain from being\n  scanned.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/setup/manage-domains/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/setup/manage-domains/index.md\n---\n\nOnce you have deployed your domain, Email security allows you to filter and edit domains. You can also choose to stop a domain from being scanned.\n\n## Filter domains\n\nTo filter your domains:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/) > **Email security**.\n2. Go to **Settings** > **Domain management** > **Domains**, then select **View**.\n3. Select **Show filters** > **Configured method**. Choose among the following filters: - **MS Graph API**: To view domains connected via MS Graph API. - **BCC/Journaling**: To view domains connected via BCC/Journaling. - **MX/Inline**: To view domains connected via MX/Inline. - **Retro Scan**: To view domains scanned by Retro Scan.\n4. Select **Apply filters**.\n\n## Edit domains\n\nTo edit your domains:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/) > **Email security**.\n2. Go to **Settings** > **Domain management** > **Domains**, then select **View**.\n3. On the **Domains** page, locate your domain, select the three dots > **Edit**.\n4. If you did not manually add your domain, you will only be able to edit **Hops**. If you manually added your domain, you will be able to edit **Domain name** and **Hops**.\n5. Select **Save**.\n\n## Prevent Cloudflare from scanning a domain\n\nTo stop scanning domains:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/) > **Email security**.\n2. Go to **Settings** > **Domain management** > **Domains**, then select **View**.\n3. On the **Domains** page, locate your domain, select the three dots > **Stop scanning**.\n4. Select **Stop scanning** again to stop Cloudflare from scanning your domain.\n\n</page>\n\n<page>\n---\ntitle: Invalid submissions  Cloudflare One docs\ndescription: \"A submission is invalid when:\"\nlastUpdated: 2025-12-04T22:38:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/invalid-submissions/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/invalid-submissions/index.md\n---\n\nA submission is invalid when:\n\n* A submission has no EML file attached.\n* A submission has been made with an incorrect file extension.\n* A submission was made to the wrong team or user alias.\n\nTo ensure your submission is valid:\n\n* Ensure your submission has a file attached with a `.eml` file extension.\n* Ensure you configure the domain you are submitting emails for.\n* Ensure policies are configured correctly.\n\nTo view invalid submissions:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security** > **Submissions**.\n3. Select **Invalid submissions**.\n\nYou can search by submission ID or submitted email.\n\nYou can filter based on **Date Range** and **Submitted by** (which will list emails that made the invalid submissions). Once you have configured your desired filters, select **Apply filters**.\n\n## Enable notifications\n\nTo enable Invalid submission email notifications:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security** > **Settings**.\n3. Go to **Invalid submission emails** and turn on **Invalid submission email notifications**.\n\n</page>\n\n<page>\n---\ntitle: Post-delivery deployment  Cloudflare One docs\nlastUpdated: 2025-06-24T09:02:28.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/index.md\n---\n\n* [API deployment](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/api/)\n* [BCC/Journaling](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/)\n\n</page>\n\n<page>\n---\ntitle: Team submissions  Cloudflare One docs\ndescription: Team submissions are the emails your security team submitted for\n  submission. All team submissions receive a human review by Cloudflare.\nlastUpdated: 2025-12-04T22:38:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/team-submissions/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/team-submissions/index.md\n---\n\nTeam submissions are the emails your security team submitted for submission. All team submissions receive a human review by Cloudflare.\n\n## View team submissions\n\nTo view team submissions:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security** > **Submissions**.\n3. Select **Team submissions**.\n\n## Filter team submissions\n\nSelect among the following filters:\n\n* **Date Range**: You can select a date range from the last 7, last 30, and last 90 days.\n* **Original disposition**: Select among the [available values](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n* **Submitted as**: Select among the [available values](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n* **Final disposition**: Select among the [available values](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n* **Escalation**: Filter by team submissions that have been escalated or not. Select among `Yes`, `No`, or `All`.\n\nOnce you have selected all the filters, select **Apply filters**.\n\nThe dashboard will populate the table with the list of emails your security team submitted for submission, including a **Submission ID**, and the **Email subject**.\n\n## View submission details\n\nTo gain more details on a specific submission:\n\n1. Go to the submission you want to have more details for.\n2. Select the three dots > select among **View more**, **View email message** and **View similar details**.\n\n</page>\n\n<page>\n---\ntitle: Pre-delivery deployment  Cloudflare One docs\nlastUpdated: 2025-04-10T10:40:28.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/index.md\n---\n\n* [Prerequisites](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/prerequisites/)\n* [MX/Inline deployment](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/mx-inline-deployment/)\n* [Set up MX/Inline deployment](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/mx-inline-deployment-setup/)\n* [Egress IPs](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/egress-ips/)\n* [Partner domain TLS](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/partner-domain-tls/)\n\n</page>\n\n<page>\n---\ntitle: User submissions  Cloudflare One docs\ndescription: User submissions are the emails your users submitted for\n  submission. User submissions help enhance our detection model, but can be\n  escalated for human review.\nlastUpdated: 2025-12-04T22:38:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/user-submissions/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/user-submissions/index.md\n---\n\nUser submissions are the emails your users submitted for submission. User submissions help enhance our detection model, but can be escalated for human review.\n\nAny email that is reported as [phish](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/#reclassify-an-email) will be displayed under **User submissions**.\n\nNote\n\n[PhishGuard](https://developers.cloudflare.com/cloudflare-one/email-security/phishguard/) customers can have submissions analyzed when submitting at either user or team level. Any non-PhishGuard customer can still have submissions analyzed by submitting at team level.\n\n## View user submissions\n\nTo view user submissions:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security** > **Submissions**.\n3. Select **User submissions**.\n\n## Filter user submissions\n\nSelect among the following filters:\n\n* **Date Range**: Select a date range from the last 7, last 30, and last 90 days.\n* **Original disposition**: Select among the [available values](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n* **Submitted as**: Select among the [available values](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#available-values).\n\nOnce you have selected all the filters, select **Apply filters**.\n\nThe dashboard will populate the table with the list of emails your users submitted for submission, including a **Submission ID**, and the **Email subject**.\n\n## View submission details\n\nTo gain more details on a specific submission:\n\n1. Go to the submission you want to have more details for.\n2. Select the three dots > select among **View more**, **View email message**, **View similar details**, and **Escalate**.\n\n## Escalate a submission\n\nTo escalate a submission:\n\n1. Go to the submission you want to escalate.\n2. Select the three dots > select **Escalate**.\n3. The dashboard will display a message to authorize escalation. Select **Escalate**.\n\n</page>\n\n<page>\n---\ntitle: Access event analytics  Cloudflare One docs\ndescription: Access event analytics allows you to review login attempts to the\n  applications you protect behind Access. Access event analytics are powered by\n  Access audit logs.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/access/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/access/index.md\n---\n\nAccess event analytics allows you to review login attempts to the applications you protect behind [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). Access event analytics are powered by [Access audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/).\n\nTo view Access event analytics:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select **Access event analytics**.\n\nAccess Event Analytics aggregates authentication activity based on your [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/).\n\nThe [Application Access Report](https://developers.cloudflare.com/cloudflare-one/insights/analytics/application-access/) dashboard offers a summary of overall Access activity, while [Access event analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/access/) dashboard provides a view of login events. You can export the Application Access Report to a PDF to share with stakeholders.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Available insights\n\nThe Access event analytics dashboard includes a chart of Access activity over time. You can view a chronological chart of access events. The Access event analytics dashboard shows when access requests occurred, helping you spot spikes in login attempts.\n\n* Events are displayed on the vertical axis.\n* Time (in your local timezone) is shown along the horizontal axis.\n\nThe Access event analytics dashboard also shows data on your usage patterns with metrics including:\n\n* Top used applications\n* Top users\n* Top IP addresses\n* Top identities\n* Top countries\n* Top application types\n\nThese insights help you detect anomalies, and optimize policy rules.\n\n</page>\n\n<page>\n---\ntitle: AI prompt logs  Cloudflare One docs\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/ai-prompt-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/ai-prompt-logs/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: AI security  Cloudflare One docs\ndescription: The AI security report dashboard summarizes your organization's AI\n  usage and potential security risks.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/ai-security/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/ai-security/index.md\n---\n\nThe AI security report dashboard summarizes your organization's AI usage and potential security risks.\n\nTo view the AI security report dashboard:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select **AI security report**.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Prerequisites\n\nTo populate the AI security report dashboard, you must have:\n\n* [Cloudflare Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) enabled to inspect outbound HTTP and DNS traffic.\n* User traffic to SaaS AI applications (for example, ChatGPT or Gemini) sent through Cloudflare Gateway.\n* MCP servers behind Cloudflare Access policies.\n\n## Available insights\n\nThe AI security report dashboard includes the following panels and metrics:\n\n* [Top 5 visited AI applications by user count](#top-5-visited-ai-applications-by-user-count)\n* [Statuses applied to AI applications by application count](#statuses-applied-to-ai-applications-by-application-count)\n* [Data uploaded to Artificial Intelligence applications by status](#data-uploaded-to-artificial-intelligence-applications-by-status)\n* [MCP servers behind Access over time](#mcp-servers-behind-access-over-time)\n* [Access login events to MCP servers](#access-login-events-to-mcp-servers)\n\n### Top 5 visited AI applications by user count\n\nDisplays the most accessed AI tools in your organization and the number of users visiting each application in a time-series graph.\\\nEach bar represents user activity for a specific AI application (for example, ChatGPT or Gemini) over time.\n\nUse this chart to monitor adoption trends and detect new or unauthorized AI tools being accessed.\n\n### Statuses applied to AI applications by application count\n\nReports the total number of AI applications identified and their review statuses.\\\nStatuses include:\n\n* Unreviewed  Applications not yet evaluated by administrators.\n* In Review  Applications currently under review for approval.\n* Unapproved  Applications that are restricted or blocked.\n* Approved  Applications explicitly permitted for organizational use.\n\n### Data uploaded to Artificial Intelligence applications by status\n\nReports the amount of data transferred to AI tools, broken down by review status (Unreviewed, In Review, Unapproved, Approved).\\\nUse this report to understand whether sensitive data is being sent to unapproved or unreviewed AI applications.\n\n### MCP servers behind Access over time\n\nDisplays the number of Managed Control Plane (MCP) servers that are protected behind Access policies over time.\\\nUse this panel to monitor the number of MCP servers protected behind Access policies.\n\n### Access login events to MCP servers\n\nReports the number of login events to MCP servers protected behind Access policies.\\\nUse this panel to monitor the number of login events to MCP servers protected behind Access policies.\n\n</page>\n\n<page>\n---\ntitle: Application Access Report  Cloudflare One docs\ndescription: The Application Access Report provides a high-level summary of\n  Access usage across your organization. This dashboard helps administrators\n  monitor authentication patterns, identity provider usage, and Access\n  configuration metrics. If Access is not configured in your account, the\n  dashboard appears empty.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/application-access/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/application-access/index.md\n---\n\nThe Application Access Report provides a high-level summary of [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) usage across your organization. This dashboard helps administrators monitor authentication patterns, identity provider usage, and Access configuration metrics. If Access is not configured in your account, the dashboard appears empty.\n\nTo view the Application Access Report dashboard:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select **Application Access Report**.\n\nThe [Application Access Report](https://developers.cloudflare.com/cloudflare-one/insights/analytics/application-access/) dashboard offers a summary of overall Access activity, while [Access event analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/access/) dashboard provides a view of login events. You can export the Application Access Report to a PDF to share with stakeholders.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Prerequisites\n\nTo populate the Application Access Report dashboard, you must have:\n\n* At least one [Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/) configured in your account.\n* Users authenticating to these applications through Cloudflare Access.\n\n## Available insights\n\nThe Application Access Report dashboard includes the following panels and metrics:\n\n* [Summary of Access activity](#summary-of-access-activity)\n* [Access events](#access-events)\n* [Access decisions by event count](#access-decisions-by-event-count)\n* [Access applications by event count](#access-applications-by-event-count)\n* [Access events by type](#access-events-by-type)\n* [Top counts of event details](#top-counts-of-event-details)\n* [Access admin metrics](#access-admin-metrics)\n\n### Summary of Access activity\n\nThe Summary of Access activity section shows a time series of Access login events over a selected period and a summary of login events. You can filter a time period in the upper right corner of the dashboard.\n\n### Access events\n\nShows a time series of Access login events over a selected period. Each bar represents the number of login events in the x-axis time interval. You can use this graph to review user authentication activity and detect unusual login spikes.\n\n### Access decisions by event count\n\nDisplays the total number of Access decisions made, grouped by outcome (for example, **Granted** or **Denied**).\n\n### Access applications by event count\n\nShows a breakdown of authentication events by application type (for example, **Self-hosted**, **SaaS**, **Private network**, **Infrastructure** or **MCP Portal**).\\\nUse this view to determine which application types users most frequently access.\n\n### Access events by type\n\nCategorizes authentication events by method, such as **SSO** or **Login** (direct credential-based authentication).\\\nThis panel helps administrators understand how users are authenticating across applications and identity providers.\n\n### Top counts of event details\n\nLists the most common Access event attributes, including:\n\n* Application name  Displays the top accessed applications.\n* Identity provider  Shows which identity providers (IdPs) were most used.\n* Users  Lists top users by number of login events.\n* Countries  Displays top countries where users logged in.\n* IP addresses  Lists the top source IPs associated with login events.\n\nThese insights help administrators identify usage patterns and trends.\n\n### Access admin metrics\n\nProvides a summary of Access configurations made by admin in your organization, including:\n\n* Applications configured  Total number of Access-protected applications, broken down by type (for example, Self-hosted, SaaS, RDP, SSH, Private network, and Dash SSO.)\n* Policies configured  Total number of Access policies, grouped by policy type (for example, Allow, Block, Bypass, or Service Auth.)\n\nThis section helps administrators audit their Access setup and verify that expected resources and policies are in place.\n\n</page>\n\n<page>\n---\ntitle: Data security analytics  Cloudflare One docs\ndescription: The Data security analytics dashboard reports security issues and\n  sensitive data found within your SaaS applications, cloud environments, and\n  HTTP traffic. It visualizes event data collected from your DLP and CASB\n  policies. If neither DLP nor CASB is enabled in your account, the dashboard\n  appears empty.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/index.md\n---\n\nThe Data security analytics dashboard reports security issues and sensitive data found within your SaaS applications, cloud environments, and HTTP traffic. It visualizes event data collected from your DLP and CASB policies. If neither DLP nor CASB is enabled in your account, the dashboard appears empty.\n\nTo view the Data security analytics dashboard:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select **Data security analytics**.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Prerequisites\n\nTo populate this dashboard, you must have:\n\n* [Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) configured to generate event data from scanned web traffic or SaaS applications.\n* At least one [Cloud Access Security Broker (CASB)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/) integration connected to capture findings from your SaaS applications or cloud environments.\n\n## Available insights\n\nThe dashboard includes the following panels and metrics:\n\n* [SaaS and Cloud findings by count](https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/#saas-and-cloud-findings-by-count)\n* [Posture findings by Severity](https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/#posture-findings-by-severity)\n* [DLP matches in HTTP requests over time](https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/#dlp-matches-in-http-requests-over-time)\n* Top integrations by posture findings\n* Top integrations by content findings\n* Top cloud resources by findings\n* Top users by DLP policies triggered\n\n### SaaS and Cloud findings by count\n\nThe SaaS and Cloud findings by count chart shows a time series view of Posture and Content findings. [Posture](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#posture-findings) denotes posture findings which include misconfigurations, unauthorized user activity, and other data security issues. [Content](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#content-findings) denotes content findings which include instances of potential data exposure as identified by [DLP](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/).\n\nEach bar represents the total number of findings detected within a given time interval. You can use this view to observe patterns or spikes in findings over time. Hover over any bar to view the exact count of Posture and Content findings for that period.\n\nTo review findings in detail, log into [Cloudflare One](https://one.dash.cloudflare.com) and go to **Cloud & SaaS findings** > **Posture Findings** or **Content Findings**.\n\n### Posture findings by Severity\n\nThe Posture findings by severity chart displays the distribution of CASB findings based on their [severity levels](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels). Each segment of the circle represents the number of posture issues classified as `Critical`, `High`, `Medium`, or `Low`.\n\nTo review findings in detail, log into [Cloudflare One](https://one.dash.cloudflare.com) and go to **Cloud & SaaS findings** > **Posture Findings**.\n\n### DLP matches in HTTP requests over time\n\nThe DLP matches in HTTP requests over time chart displays when [DLP policies](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/) were triggered by users over a specified period of time.\n\nUnlike the SaaS and Cloud findings by count chart above, which relies on CASB findings from data at rest, the DLP matches in HTTP requests over time chart reflects DLP detections in HTTP traffic  helping you monitor sensitive data movement in real time.\n\nTo review DLP detections in detail, log into [Cloudflare One](https://one.dash.cloudflare.com) and go to **Insights** > **Logs** > **HTTP request logs**. Use the **DLP profiles** or **DLP match data** filters to view HTTP requests that triggered a DLP policy.\n\n</page>\n\n<page>\n---\ntitle: Gateway analytics (DNS, HTTP, network sessions)  Cloudflare One docs\ndescription: \"Gateway analytics include three separate dashboards:\"\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/gateway/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/gateway/index.md\n---\n\nGateway analytics include three separate dashboards:\n\n* HTTP request analytics.\n* DNS query analytics.\n* Network session analytics.\n\nTo review Gateway analytics:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select your desired dashboard.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## HTTP request analytics\n\nThe HTTP request analytics dashboard is powered by your [Gateway HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/). If you are not using Gateway HTTP policies, the dashboard will appear empty.\n\nThe HTTP request analytics dashboard helps you identify trends in how your HTTP policies are applied over time. By visualizing allowed, isolated, and do not inspect requests, the dashboard provides insights into traffic behavior and policy trends, making it easier to spot anomalies or shifts in usage patterns.\n\nTo review a detailed description of an HTTP request and its associated policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Select **Logs**.\n3. Select **HTTP request logs**.\n4. Use the **Policy** filter to view HTTP requests that triggered a policy or other filters to narrow down your results.\n\n### Provided analytics\n\n* HTTP Requests over time\n  * Time series view of HTTP requests\n* Top Actions\n* Top Countries\n* Top Blocked Users\n* Top Bandwidth Consumers\n* Top Devices\n* Top Source IPs\n\n## DNS query analytics\n\nThe DNS query analytics dashboard is powered by your [Gateway DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/). If you are not using Gateway DNS policies, the dashboard will appear empty.\n\nThe DNS query analytics dashboard helps you identify trends in how your DNS policies are applied over time. By visualizing allowed, blocked, and overridden queries, the dashboard provides insights into traffic behavior and policy trends, making it easier to spot anomalies or shifts in usage patterns.\n\nTo review a detailed description of a DNS query and its associated policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Select **Logs**.\n3. Select **DNS query logs**.\n4. Use the **Policy** filter to view DNS queries that triggered a policy or other filters to narrow down your results.\n\n### Provided analytics\n\n* DNS Queries over time\n  * Time series view of DNS queries\n* Top Actions\n* Top Countries\n* Top Blocked Users\n* Top Allowed Users\n* Top Blocked Devices\n\n## Network session analytics\n\nThe Network session analytics dashboard is powered by your [Gateway network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/). If you are not using Gateway network policies, the dashboard will appear empty.\n\nThe Network session analytics dashboard helps you identify trends in how your network policies are applied over time. By visualizing allowed, blocked, and overridden sessions, the dashboard provides insights into traffic behavior and policy trends, making it easier to spot anomalies or shifts in usage patterns.\n\nTo review a detailed description of a network session and its associated policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Select **Logs**.\n3. Select **Network logs**.\n4. Use the **Policy** filter to view network sessions that triggered a policy or other filters to narrow down your results.\n\n### Provided analytics\n\n* Network Sessions over time\n  * Time series view of network sessions\n* Top Actions\n* Top Countries\n* Top Blocked Users\n* Top Bandwidth Consumers\n* Top Devices\n* Top Source IPs\n\n## GraphQL queries\n\nYou can use the [GraphQL Analytics API](https://developers.cloudflare.com/analytics/graphql-api/) to query your Gateway Analytics data. Available [datasets](https://developers.cloudflare.com/analytics/graphql-api/features/data-sets/) for Gateway include:\n\n| Dataset | Description |\n| - | - |\n| `gatewayL4DownstreamSessionsAdaptiveGroups` | Metrics for Gateway network sessions from user devices to the Cloudflare global network. |\n| `gatewayL4UpstreamSessionsAdaptiveGroups` | Metrics for Gateway network sessions from the Cloudflare global network to user devices. |\n| `gatewayL4SessionsAdaptiveGroups` | Metrics for Gateway network sessions with adaptive sampling. |\n| `gatewayL7RequestsAdaptiveGroups` | Metrics for Gateway HTTP requests with adaptive sampling. |\n| `gatewayResolverQueriesAdaptiveGroups` | Metrics for Gateway DNS queries with adaptive sampling. |\n| `gatewayResolverByRuleExecutionPerformanceAdaptiveGroups` | Time to execute Gateway DNS policies on the Cloudflare global network. |\n| `gatewayResolverByCustomResolverGroups` | Metrics for Gateway DNS queries resolved using custom resolvers. |\n| `gatewayResolverByCategoryAdaptiveGroups` | Metrics for Gateway DNS queries sorted by [domain category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) with adaptive sampling. |\n\nTo explore the schema, you can use a GraphQL client such as [GraphiQL](https://github.com/graphql/graphiql/tree/main/packages/graphiql#readme) or [Altair](https://altairgraphql.dev/).\n\n1. [Create an API token](https://developers.cloudflare.com/analytics/graphql-api/getting-started/authentication/api-token-auth/) with the following permissions:\n\n   | Type | Item | Permission |\n   | - | - | - |\n   | Account | Account Analytics | Read |\n\n2. In your GraphQL client, [add your API token](https://developers.cloudflare.com/analytics/graphql-api/getting-started/authentication/graphql-client-headers/) as an Authorization header.\n\n3. Compose a query to access your Gateway Analytics datasets. For example, you can query the `gatewayResolverQueriesAdaptiveGroups` dataset to return the adaptive groups of DNS queries resolved by Gateway:",
      "language": "unknown"
    },
    {
      "code": "[Run in GraphQL API Explorer](https://graphql.cloudflare.com/explorer?query=I4VwpgTgngBA4gQwC5gO4KgZQQWwA4A2YAiuNABQAkCAxjQPYgB2SAKggOYBcMAzkhACWTDgEIANDEr8EEJD1aCcYAJQwA3gCgYMAG6C0kDdp0xaDZkl7kAZoIIoIPdWbqMW7blPPu2nGAC+alqmphzIaBgASmC89AS6kKSQBrwAggAmCHhIgolwEIx41iahOnYOkM4wWSi5ygD6HPJSMnKBpWUESoItAIwADJ06wcOmFixjOhlKYEy8gvTzxmVloJBQAHK4YDGJELxgGVOmELHx+wAiYDSCC0snAWNPoS8dAUA\\&variables=N4IghgxhD2CuB2AXAKmA5iAXCAggYTwHkBVAOWQH0BJAERABoQBnRMAJ0SxACYAGbgKwBaAIzchAZl7Ju3TFMwjeALRABfIA)\n\nFor more information, refer to [Compose a query in GraphiQL](https://developers.cloudflare.com/analytics/graphql-api/getting-started/compose-graphql-query/).\n\n</page>\n\n<page>\n---\ntitle: Shadow IT SaaS analytics  Cloudflare One docs\ndescription: Shadow IT SaaS analytics provides visibility into the SaaS\n  applications your users are visiting. This information allows you to create\n  identity and device-driven Cloudflare One policies to secure your users and\n  data.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/index.md\n---\n\nShadow IT SaaS analytics provides visibility into the SaaS applications your users are visiting. This information allows you to create identity and device-driven Cloudflare One policies to secure your users and data.\n\nTo access Shadow IT SaaS analytics:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Go to **Dashboards**.\n3. Select **Shadow IT: SaaS analytics**.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Prerequisites\n\nTo allow Cloudflare to discover shadow IT in your traffic, you must set up [HTTP filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/).\n\n## Use Shadow IT SaaS analytics\n\n### 1. Review applications\n\nThe first step in using the Shadow IT SaaS analytics dashboard is to review applications in the [Application Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/). The App Library synchronizes application review statuses with approval statuses from the Shadow IT Discovery SaaS analytics dashboard.\n\nTo organize applications into their approval status for your organization, you can mark them as **Unreviewed** (default), **In review**, **Approved**, and **Unapproved**.\n\n| Status | API value | Description |\n| - | - | - |\n| Approved | `approved` | Applications that have been marked as sanctioned by your organization. |\n| Unapproved | `unapproved` | Applications that have been marked as unsanctioned by your organization. |\n| In review | `in review` | Applications in the process of being reviewed by your organization. |\n| Unreviewed | `unreviewed` | Unknown applications that are neither sanctioned nor being reviewed by your organization at this time. |\n\nTo set the status of an application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Applications**.\n2. Locate the card for the application.\n3. In the three-dot menu, select the option to mark your desired status.\n\nOnce you mark the status of an application, its badge will change. You can filter applications by their status to review each application in the list for your organization. The review status for an application in the App Library and Shadow IT Discovery will update within one hour.\n\nNote\n\nApproval status does not impact a user's ability to access an application. Users are allowed or blocked according to your [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) and [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/). To filter traffic based on approval status, use the [*Application Status*](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application-approval-status) selector.\n\n### 2. Monitor usage\n\nReview the Shadow IT SaaS analytics dashboard for application usage. Filter the view based on:\n\n| Field | Description |\n| - | - |\n| Application | SaaS application's name and logo. |\n| Application type | [Application type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/#app-types) assigned by Cloudflare Cloudflare One. |\n| Status | Application's approval status. |\n| Secured | Whether the application is currently secured behind Cloudflare Access. |\n| Users | Number of users who connected to the application over the period of time specified on the Shadow IT Discovery overview page. |\n\nTo manage application statuses in bulk, select **Set Application Statuses** to review applications your users commonly visit and update their approval statuses.\n\n### 3. Create policies\n\nAfter marking applications, you can create [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) based on application review status. For example, you can create policies that:\n\n* Launch all **Unreviewed** and **In review** applications in an [isolated browser](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/#1-isolate-unreviewed-or-in-review-applications).\n* [Block access](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/#2-block-unapproved-applications) to all **Unapproved** applications.\n* Limit file upload capabilities for specific application statuses.\n\nTo create an HTTP status policy directly from Shadow IT Discovery:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights**.\n2. Select **Dashboards** > **Shadow IT: SaaS analytics**.\n3. Select **Set application statuses**.\n4. Select **Manage HTTP status policies**, then choose an application status and select **Create policy**.\n\n## Available insights\n\nThe Shadow IT SaaS analytics dashboard includes several insights to help you monitor and manage SaaS application usage.\n\n* **Number of applications by status**: A breakdown of how many applications have been categorized into each [approval status](#1-review-applications). The list of applications is available in the [App Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/).\n* **Data uploaded per application status**: A time-series graph showing the amount of data (in gigabytes) uploaded to an application in the given status.\n* **Data downloaded per application status**: A time-series graph showing the amount of data (in gigabytes) downloaded from an application in the given status.\n* **User count per application status**: A time-series graph showing the number of users who have interacted with at least one application in a given status. For example, a user can use an **Approved** application shortly followed by an **In review** application, contributing to counts for both of those statuses.\n* **Top-N metrics**: A collection of metrics providing insights into top applications, users, devices, and countries.\n\n</page>\n\n<page>\n---\ntitle: IP visibility  Cloudflare One docs\ndescription: \"DEX's IP visibility gives administrators insight into three\n  different IP types per device:\"\nlastUpdated: 2025-12-05T19:54:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/ip-visibility/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/ip-visibility/index.md\n---\n\nFeature availability\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2025.1.861.0 |\n| macOS |  | 2025.1.861.0 |\n| Linux |  | 2025.1.861.0 |\n| iOS |  | |\n| Android |  | |\n| ChromeOS |  | |\n\nDEX's IP visibility gives administrators insight into three different IP types per device:\n\n1. **Device**: The private IP address of an end-user device.\n2. **ISP**: The public IP assigned by the ISP that the end-user device is being routed though.\n3. **Gateway**: The router's private IP (the router the end device is connected to.)\n\nNote\n\nThe ISP IP is only visible to users with the [Zero Trust PII role](https://developers.cloudflare.com/cloudflare-one/roles-permissions/#cloudflare-zero-trust-pii).\n\nDEX's IP visibility supports both IPv6 and IPv4 addresses.\n\nIP information is crucial for IT administrators to accurately troubleshoot network issues and identify user locations. IT administrators face challenges like:\n\n* Pinpointing the exact location of a user experiencing issues (\"AP 87 is bad.\")\n* Identifying network access control policy violations (\"NAC Policies is not applied properly.\")\n* Troubleshooting firewall restrictions (\"Firewall on VLAN 93 is blocking.\")\n* Resolving Layer 2 and DHCP related problems.\n* Indirectly determining user identity and device location.\n\n## View a device's IP information\n\nTo view IP information for a user device:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices** > **Your devices**.\n2. Select a device, then select **View details**.\n3. Go to **IP details**.\n4. Review the IP details for your selected device's most recent session.\n\n## View a device's IP history\n\nDEX's IP visibility allows you to review an event log of a device's IP history for the last seven days. To view a device's IP history:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices** > **Your devices**.\n2. Select a device > **View details** > go to **IP details**.\n3. Select **View all ISPs**.\n\n## Troubleshoot with IP visibility\n\nWhile IP visibility allows you to inspect a device's IP information, use [DEX's live analytics](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#available-metrics) to review which Cloudflare data center the device is connected to. When traffic leaves a WARP-connected end-user device, it will hit a [Cloudflare data center](https://developers.cloudflare.com/support/troubleshooting/general-troubleshooting/gathering-information-for-troubleshooting-sites/#identify-the-cloudflare-data-center-serving-your-request).\n\nTo find which Cloudflare data center a device is connected to:\n\n1. Follow the steps listed in [View IP information](#view-a-devices-ip-history) to find a device's IP information.\n2. On the device page, select **Colocation & client** or find the **Client** table at the top of the page.\n3. In the **Client** table, find **Colocation** to review which Cloudflare data center your selected device's egress traffic is connected to.\n\n</page>\n\n<page>\n---\ntitle: DEX MCP server  Cloudflare One docs\ndescription: The MCP server (Model Context Protocol) for Digital Experience\n  Monitoring (DEX) is an AI tool that allows customers to ask a question like,\n  \"Show me the connectivity and performance metrics for the device used by\n  carly@acme.com\", and receive an answer that contains data from the DEX API.\nlastUpdated: 2025-11-19T00:38:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/dex-mcp-server/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/dex-mcp-server/index.md\n---\n\nThe MCP server [(Model Context Protocol)](https://cloudflare.com/learning/ai/what-is-model-context-protocol-mcp/) for Digital Experience Monitoring (DEX) is an AI tool that allows customers to ask a question like, \"Show me the connectivity and performance metrics for the device used by carly@acme.com\", and receive an answer that contains data from the DEX API.\n\nAny Cloudflare One customer using a Free, PayGo, or Enterprise account can access the DEX MCP Server. This feature is available to everyone.\n\nThere are two primary options for connecting to the DEX MCP server:\n\n* [In Cloudflare's AI Playground](#cloudflare-ai-playground)\n* [With your preferred AI assistant](#ai-assistant)\n\n## Cloudflare AI Playground\n\nCloudflare's AI Playground is a great way to quickly try out a new MCP Server.\n\nYou can test the DEX MCP server in less than one minute by visiting the AI Playground's website.\n\n1. Copy the URL for the DEX MCP server: `https://dex.mcp.cloudflare.com/mcp`.\n2. Open [playground.ai.cloudflare.com](https://playground.ai.cloudflare.com) in a browser.\n3. Find the section in the left sidebar titled **MCP Servers**.\n4. Paste the URL for the DEX MCP server into the URL input box and select **Connect**.\n5. Authenticate your Cloudflare account, and then start asking questions about your DEX data.\n\nNote\n\nYou need to ask specific and explicit questions to get a response. For example, first you need to provide the following instruction: \"Set XYZ as the active account\". Then, you can ask a specific question: \"Fetch the DEX test results for the user bob@acme.com over the past 24 hours\".\n\n## AI Assistant\n\nCustomers will get a more flexible and robust prompt experience by configuring the DEX MCP server with their preferred AI assistant (for example, Claude, Gemini, or ChatGPT).\n\nIf you have any issues during the configuration process, you can ask your AI assistant for help with configuring an MCP server via URL.\n\n### Claude\n\nYou need a Claude Pro account (or higher subscription) to configure an MCP server.\n\n1. Download the [Claude desktop client](https://claude.ai/download).\n\n2. Open the Claude desktop client, and log in or set up an account.\n\n3. Expand the left sidebar menu, and select **Claude Code**.\n\n4. Under **Desktop app**, select **Developer** to show the **Local MCP servers** page.\n\n5. Select **Edit Config** and open the `claude_desktop_config.json` file in a text editor of your choice.\n\n6. Copy the JSON configuration for the DEX MCP server and paste it into `claude_desktop_config.json`. Save the file.",
      "language": "unknown"
    },
    {
      "code": "7. Fully close Claude by using the task manager to stop any background processes related to Claude.\n\n8. Open Claude, and your DEX MCP server configuration should appear on the **Local MCP servers** page.\n\n9. Authenticate your Cloudflare account and allow the DEX MCP server.\n\n10. You can start asking Claude questions about DEX. As a simple test, you can ask \"Are you connected to the DEX MCP server\".\n\n### Gemini CLI\n\nAll tiers of Google AI Free, Pro, and Ultra offer an MCP server integration via the Gemini CLI.\n\nYou will need to use a CLI of your choice and npm or homebrew to install and access the Gemini CLI.\n\n1. Visit the GitHub page for the [Gemini CLI](https://github.com/google-gemini/gemini-cli) and follow the installation instructions.\n\n2. Navigate to the `settings.json` file for your Gemini CLI install and open it in a text editor of your choice.\n\n   File path for the `settings.json` file\n\n   * Windows: `%USERPROFILE%\\.gemini\\settings.json`\n   * Mac and Linux: `~/.gemini/settings.json`\n\n3. Copy the JSON configuration for the DEX MCP server and paste it into **settings.json**. Save the file.",
      "language": "unknown"
    },
    {
      "code": "4. Run Gemini in your CLI of choice.\n\n5. If everything is working as expected, the Gemini CLI will show the following message:\\\n   `Using: 1 MCP server (ctrl+t to view)`\n\n6. Authenticate the email associated with your Cloudflare account in the Gemini CLI.\n\n7. You can start asking the Gemini CLI questions about DEX. As a simple test, you can ask \"Are you connected to the DEX MCP server\".\n\n### ChatGPT\n\nYou need a ChatGPT Pro or Business account to configure an MCP server. ChatGPT Free and Plus do not support MCP servers.\n\n1. Download the [ChatGPT desktop app](https://chatgpt.com/features/desktop).\n2. Open the ChatGPT desktop app, and log in or set up an account.\n3. Open the **Settings** menu and select **Connectors**.\n4. Select the option to create a new Connector.\n5. Provide a **Name** (like `DEX MCP`), **Description** (optional), and **MCP Server URL** for the Connector. The DEX MCP Server URL is: `https://dex.mcp.cloudflare.com/mcp`.\n6. Create the new Connector.\n7. Before you ask ChatGPT a question about DEX, select the **+** (plus) button next to the ChatGPT prompt box.\n8. Select **Use Connectors** > **Add Sources**, then select the DEX MCP as a source.\n9. You can start asking ChatGPT questions about DEX. As a simple test, you can ask \"Are you connected to the DEX MCP server\".\n\n</page>\n\n<page>\n---\ntitle: MCP server  Cloudflare One docs\nlastUpdated: 2025-10-09T17:32:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/mcp-server/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/mcp-server/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Device monitoring  Cloudflare One docs\ndescription: Monitor performance and network status for your organization's\n  fleet or individual user devices.\nlastUpdated: 2025-12-05T19:54:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/index.md\n---\n\nMonitor performance and network status for your organization's [fleet](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#fleet-status) or individual [user devices](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#device-monitoring).\n\nNetwork and device performance data helps IT administrators troubleshoot performance issues, investigate network connectivity problems, and monitor device health.\n\n## Device overview\n\nA fleet is a collection of user devices. All devices in a fleet have WARP installed and are connected to a [Cloudflare Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/setup/#create-a-zero-trust-organization).\n\nTo view fleet status:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Digital experience**.\n2. Review the information under **Live analytics**.\n\n### View metrics\n\nThe **Device overview** tab will show real-time and historical connectivity metrics for all devices in your organization.\n\nTo view analytics on a per-device level, go to [Device monitoring](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#device-monitoring).\n\n### Available metrics\n\n* **Devices connected by colo**: Number of devices that are connected to a given [Cloudflare data center](https://www.cloudflarestatus.com/).\n\n* **Connectivity status**: Percentage of devices in a given WARP client state.\n\n  | Status | Description |\n  | - | - |\n  | Connected | WARP has successfully established a connection to the Cloudflare global network. |\n  | Disconnected | WARP has been intentionally or unintentionally disconnected from the Cloudflare global network. |\n  | Paused | A user or administrator has taken an explicit action to temporarily turn off WARP, for example by entering an [admin override code](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#allow-admin-override-codes). Paused clients will [auto-connect](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#auto-connect) after a timeout period. |\n  | Connecting | WARP is pending connection, but is actively trying to establish a connection to the Cloudflare global network. |\n\n* **Mode**: [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) deployed on the device.\n\n* **Colo**: Percentage of devices connected to a given Cloudflare data center.\n\n* **Platform**: Operating system of the device.\n\n* **Major Version**: WARP client version installed on the device.\n\n* **Device Status Over Time**: WARP client connection status over the selected time period.\n\n* **Connection Methods Over Time**: WARP mode used by the device over the selected time period.\n\n## Device monitoring\n\nReview network and device performance for a device enrolled in your fleet.\n\n### View a device's performance\n\nTo view a device's network and device performance metrics:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices** > **Your devices**.\n2. Select a device > **View details**.\n3. Select the **DEX** tab.\n4. In **Device Monitoring**, scroll down to **Network performance** and **Device Performance**.\n\n### Network and device performance metrics\n\n#### Network performance metrics\n\n* **Unique networks over time**: How many unique SSIDs the device was connected to.\n\n* **Network I/O**: How much data has been transferred (uploads and downloads) over the primary network interface.\n\n#### Device performance metrics\n\n* **Battery percentage and cycles**: Displays battery percentage and [battery cycles](https://support.apple.com/en-us/102888) over time. Used to debug potential performance issues possibly related to battery health or power-saving measures that are triggered at low-battery levels.\n\n* **CPU usage**: CPU utilization over time. Used to debug slow system performance due to high CPU usage.\n\n* **Memory utilization**: Memory utilization over time. Used to debug performance issues related to an overtaxed memory.\n\n* **Disk I/O**: Displays number of disk read/write operations over time. Used to debug performance errors due to heavy disk operations.\n\n## Export DEX device state event logs\n\nThe log data for all [DEX device state events](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/dex_device_state_events/) can be exported to [R2](https://developers.cloudflare.com/r2/), a cloud bucket, or a SIEM via [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/).\n\n</page>\n\n<page>\n---\ntitle: DEX notifications  Cloudflare One docs\ndescription: Administrators can receive alerts when Cloudflare detects\n  connectivity issues with the WARP client or degraded application performance.\n  Notifications can be delivered via email, webhook, and third-party services.\nlastUpdated: 2025-12-05T19:54:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/index.md\n---\n\nAdministrators can receive alerts when Cloudflare detects connectivity issues with the WARP client or degraded application performance. Notifications can be delivered via email, webhook, and third-party services.\n\n## Manage notifications\n\nDEX notifications are configured on the [Cloudflare dashboard](https://dash.cloudflare.com/). For more information, refer to [Create a notification](https://developers.cloudflare.com/notifications/get-started/#create-a-notification).\n\n## Available notifications\n\nDevice connectivity anomaly\n\n**Who is it for?**\n\nZero Trust customers who want to be notified when Cloudflare detects a spike or drop in the number of devices connected to the WARP client.\n\n**Other options / filters**\n\n* **Alert configuration**: Choose when to trigger a notification. Available options are *Connectivity spike*, *Connectivity drop*, and *Connectivity spike or drop*.\n\n* Filters:\n\n  * **Colo**: Cloudflare data center that the device is connected to.\n  * **Platform**: Operating system of the device.\n  * **Version**: WARP client version (for example, `2024.3.409.0`).\n  * **Mode**: [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) deployed on the device.\n\n**Included with**\n\nAll Cloudflare Zero Trust plans.\n\n**What should you do if you receive one?**\n\nReview your [fleet status](https://developers.cloudflare.com/cloudflare-one/insights/dex/fleet-status/) to investigate why the spike or drop occurred and which devices are impacted.\n\n**Additional information**\n\nTo learn more about the alert logic, refer to [Z-score](https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/#z-score).\n\nDEX test latency\n\n**Who is it for?**\n\nZero Trust customers who wish to receive alerts when there is a spike or drop in application latency, as measured by the HTTP test [Resource Fetch time](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/http/#test-results) or Traceroute test [Round trip time](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/traceroute/#test-results). Requires setting up a [DEX test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/).\n\n**Other options / filters**\n\n* **Alert configuration**: Choose when to trigger a notification. Available options are *Latency spike*, *Latency drop*, and *Latency spike or drop*.\n\n* Filters:\n\n  * **Colo**: Cloudflare data center that the device is connected to.\n  * **Platform**: Operating system of the device.\n  * **Version**: WARP client version (for example, `2024.3.409.0`).\n  * **Test name**: Choose which DEX test the alert should monitor. You will receive individual notifications for each test.\n\n**Included with**\n\nAll Cloudflare Zero Trust plans.\n\n**What should you do if you receive one?**\n\nView your [test results](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/view-results/) to investigate why the spike occurred.\n\n**Additional information**\n\nTo learn more about the alert logic, refer to [Z-score](https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/#z-score).\n\nDEX test low availability\n\n**Who is it for?**\n\nZero Trust customers who wish to receive alerts when the percentage of successful HTTP or traceroute requests to an application drops below the selected service-level objective (SLO). Requires setting up a [DEX test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/).\n\n**Other options / filters**\n\n* **Service Level Objective (SLO)**: Specify the availability threshold that will trigger an alert. Enter a percentage in `xx.x` format (for example, `98.0`).\n\n* Filters:\n\n  * **Colo**: Cloudflare data center that the device is connected to.\n  * **Platform**: Operating system of the device.\n  * **Version**: WARP client version (for example, `2024.3.409.0`).\n  * **Test name**: Choose which DEX test the alert should monitor. You will receive individual notifications for each test.\n\n**Included with**\n\nAll Cloudflare Zero Trust plans.\n\n**What should you do if you receive one?**\n\nView your [test results](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/view-results/) to investigate why the degradation occurred.\n\n**Additional information**\n\nTo learn more about the alert logic, refer to [SLO](https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/#slo).\n\n## Alert logic\n\n### Z-score\n\nCloudflare uses a z-score to detect traffic spikes or drops. A [z-score](https://en.wikipedia.org/wiki/Standard_score) is the number of standard deviations the current value is to the mean. We calculate the mean and standard deviation by comparing the current five minutes to the past four hours. This is measured every five minutes.\n\nTo trigger an alert, the z-score value must be above 3.5 or less than -3.5.\n\n### SLO\n\nA service-level objective (SLO) is defined as (x / y) \\* 100 where x = the number of good events and y = the number of valid events for a given time period. DEX notifications look at both a short window (five minutes) and a long time window (one hour) and triggers an alert if the availability falls below the SLO threshold in either window.\n\n</page>\n\n<page>\n---\ntitle: Remote captures  Cloudflare One docs\ndescription: Remote captures allow administrators to collect packet captures\n  (PCAPs) and WARP diagnostic logs directly from end user devices. This data can\n  be used to troubleshoot network problems, investigate security incidents, and\n  identify performance bottlenecks.\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/index.md\n---\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/teams-pricing/) |\n| - | - |\n| * Gateway with WARP\n* Secure Web Gateway without DNS Filtering | All plans |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2024.12.492.0 |\n| macOS |  | 2024.12.492.0 |\n| Linux |  | 2024.12.492.0 |\n| iOS |  | |\n| Android |  | |\n| ChromeOS |  | |\n\nRemote captures allow administrators to collect packet captures (PCAPs) and WARP diagnostic logs directly from end user devices. This data can be used to troubleshoot network problems, investigate security incidents, and identify performance bottlenecks.\n\n## Start a remote capture\n\nDevices must be actively connected to the Internet for remote captures to run.\n\nTo capture data from a remote device:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **DEX** > **Remote captures**.\n\n2. Select up to 10 devices that you want to run a capture on. Devices must be [registered](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) in your Zero Trust organization.\n\n3. Configure the types of captures to run.\n\n   * **Packet captures (PCAP)**: Performs packet captures for traffic outside of the WARP tunnel (default network interface) and traffic inside of the WARP tunnel ([WARP virtual interface](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/warp-architecture/#ip-traffic)).\n\n   * **WARP Diagnostics Logs**: Generates a [WARP diagnostic log](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/#warp-diag-logs) of the past 96 hours. To include a routing test for all IPs and domains in your [Split Tunnel configuration](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/), select **Test all routes**.\n\n     Note\n\n     **Test all routes** will extend the time for diagnostics to run and may temporarily impact device performance during the test.\n\n4. Select **Run diagnostics**.\n\nDEX will now send capture requests to the configured devices. If the WARP client is disconnected, the capture will time out after 10 minutes.\n\n## Check remote capture status\n\nTo view a list of captures, go to **DEX** > **Remote captures**. The **Status** column displays one of the following options:\n\n* **Success**: The capture is complete and ready for download. Any partially successful captures will still upload to Cloudflare. For example, there could be a scenario where the PCAP succeeds on the primary network interface but fails on the WARP tunnel interface. You can [review PCAP results](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/#download-remote-captures) to determine which PCAPs succeeded or failed.\n* **Running**: The capture is in progress on the device.\n* **Pending Upload**: The capture is complete but not yet ready for download.\n* **Failed**: The capture has either timed out or encountered an error. To retry the capture, check the WARP client version and [connectivity status](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#fleet-status), then start a [new capture](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/#start-a-remote-capture).\n\n## Download remote captures\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **DEX** > **Remote captures**.\n2. Find a successful capture.\n3. Select the three-dot menu and select **Download**.\n\nThis will download a ZIP file to your local machine called `<capture-id>.zip`. DEX will store capture data according to our [log retention policy](https://developers.cloudflare.com/cloudflare-one/insights/logs/#log-retention).\n\n### Device PCAP contents\n\nThe downloaded PCAP folder contains three files:\n\n* `capture-default.pcap`: Packet captures for the primary network interface.\n* `capture-tunnel.pcap`: Packet captures for traffic inside of the WARP tunnel.\n* `results.json`: Reports successful and failed packet captures.\n\nYou can analyze `.pcap` files using Wireshark or another third-party packet capture tool.\n\n### WARP Diag contents\n\nRefer to [WARP diagnostic logs](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/#warp-diag-logs) for a description of each file.\n\n## WARP diagnostics analyzer (beta)\n\nThe WARP diagnostics analyzer highlights what Cloudflare determines to be the most important detection events in a `warp-diag` log. You can use the detection report to help parse your [log files](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/#warp-diag-logs) and identify the root cause of client issues. The WARP diagnostic analyzer is only available for logs [collected via the dashboard](#collect-logs-via-the-dashboard).\n\nTo access the WARP diagnostic analyzer:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **DEX** > **Remote captures**.\n\n2. Locate an existing `warp-diag` log from the list or select **Run diagnostics** to generate a new `warp-diag` log.\n\n3. Select the three dots for the `warp-diag` log that you want to analyze, then select **View WARP Diag**.\n\n   The **Overview** tab will display an [AI-generated summary](https://developers.cloudflare.com/fundamentals/reference/cloudy-ai-agent/) of the results, a list of detection events, and basic device information.\n\n   Explanation of the fields\n\n   | Field | Description |\n   | - | - |\n   | Detection type | A common WARP issue that can appear in the diagnostic logs. |\n   | Occurences | Number of times an issue was detected in the logs. |\n   | Severity level | Indicates the impact of the issue on WARP client functionality. The severity levels are:- **Critical**: Issue causes complete loss of functionality.\n   - **Warning**: Issue causes degraded functionality but core features should still work.\n   - **No detection**: Issue was not detected in the logs. |\n   | Operating system | OS and OS version of the device. |\n   | WARP version | [WARP release version](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/) |\n   | Profile ID | [WARP device profile](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/) UUID |\n   | Service mode | [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) |\n   | Configuration name | Name of the [Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/switch-organizations/) that WARP is connected to. |\n   | Device ID | ID generated by the WARP client. |\n\n4. Select a detection type for more information about the event and recommended next steps.\n\nCloudflare DEX will store the `warp-diag` log and its detection report per our [log retention policy](https://developers.cloudflare.com/cloudflare-one/insights/logs/#log-retention). To save a copy onto your local machine, [download the log file](#download-remote-captures) and go to the **JSON file** tab to copy the report in JSON format.\n\n## Limitations\n\n* Packet captures are subject to the following limits:\n\n  | Limit Type | Maximum Value |\n  | - | - |\n  | Time limit | 600 seconds |\n  | File size | 50 MB |\n  | Packet size | 1500 bytes |\n\n* WARP diagnostic logs have no file size limit, but files larger than 100 MB cannot be uploaded to Cloudflare and must be shared directly with the admin.\n\n* Windows devices do not support concurrent remote captures. If you start a remote capture while another is in progress, the second capture will fail immediately.\n\n* PCAPs will fail on Windows if you have another third-party packet capture tool (such as, Packet Monitor `pktmon`) running.\n\n* On Windows, packet captures may fail on devices configured with a non-English language due to limitations with the underlying `PktMon` tool.\n\n</page>\n\n<page>\n---\ntitle: Rules  Cloudflare One docs\ndescription: DEX rules allow you to create and manage testing policies for\n  targeted user groups within your fleet. After creating a rule, you can use it\n  to define the scope of a test to specific groups such as departments (like\n  finance or sales), devices, and/or users. You can apply and reuse rules on\n  your desired tests.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/rules/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/rules/index.md\n---\n\nDEX rules allow you to create and manage testing policies for targeted user groups within your [fleet](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/). After creating a rule, you can use it to define the scope of a [test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/) to specific groups such as departments (like finance or sales), devices, and/or users. You can apply and reuse rules on your desired tests.\n\nDEX rules are ideal for admins who want to define the scope of a test to a specific group within their fleet to allow for more precise problem detection and resolution.\n\n## Create a rule\n\nTo create a rule:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Digital experience**.\n2. Select the **Rules** tab.\n3. Select **Add a rule**.\n4. Give your rule a name and build your desired expressions.\n5. Select **Create rule** to finalize your rule.\n\n### Selectors\n\nSelectors are required categories in a DEX rule expression that define a group within a fleet. The selector(s) you have defined in a rule will determine which group a test will impact.\n\nReview the available selectors and their scope in the following list.\n\n| Selector | Description |\n| - | - |\n| **User email** | For specifying [user emails](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#user-email). |\n| **User group emails** | For specifying [group emails](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#user-group-email). |\n| **User group IDs** | For specifying [group IDs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#user-group-ids). |\n| **User group names** | For specifying a [group name](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#user-group-names). |\n| **Operating systems** | For specifying operating systems. |\n| **Operating system version** | For specifying an operating system version (use Operator `in`) or versions (use Operator `is`). |\n| **Managed network** | For specifying users accessing the network from the office (managed network) compared to those accessing remotely. |\n| **SAML attributes** | For specifying a value from the [SAML Attribute Assertion](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#saml-attributes). |\n| **Colos** | For specifying a Cloudflare data center location users are connected to. |\n\n## Add a rule to a test\n\nAfter you have created a rule, you can add it to a test. If you do not add a rule to a test, the test will run on your entire device fleet.\n\nTo add a rule to a test:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Digital experience**.\n2. Select the **Tests** tab.\n3. Choose an existing test and select **Edit**, or select **Add a test** to make a new test.\n4. Under **Select DEX rules**, select the rule you would like to apply.\n5. Select **Save test** for an existing rule or **Add rule** for the new test.\n\nNote\n\nIt may take up to 10 minutes for newly updated settings to propagate to devices.\n\nTo view which tests a rule is being applied to:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Digital experience**.\n2. Select the **Rules** tab.\n3. Choose a rule and select **Edit**.\n4. Select the **DEX tests** tab and review the list of tests that include your selected rule.\n\n## Create a test using a rule\n\nYou can create a new test from the [DEX test dashboard as described above](https://developers.cloudflare.com/cloudflare-one/insights/dex/rules/#add-a-rule-to-a-test) or directly from the DEX rules dashboard.\n\nTo create a new test using a rule from DEX rules:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Digital experience**.\n2. Select the **Rules** tab.\n3. Select a rule and select **Edit**.\n4. Select the **DEX tests** tab.\n5. You will be able to review all the tests that currently include this rule. To create a new test, select **Create a test using this rule**.\n6. Enter all required information, making sure that the box next to your rule name is checked.\n7. Select **Add test**.\n\n## Related resources\n\n* [DEX HTTP test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/http/) - Assess the accessibility of a web application.\n* [DEX Traceroute test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/traceroute/) - Measure the network path of an IP packet from an end-user device to a server.\n\n</page>\n\n<page>\n---\ntitle: Synthetic tests  Cloudflare One docs\ndescription: With Digital Experience Monitoring (DEX), you can test if your\n  devices can connect to a private or public endpoint through the WARP client.\n  Tests allow you to monitor availability for a given application and\n  investigate performance issues reported by your end users.\nlastUpdated: 2025-11-19T00:38:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/index.md\n---\n\nWith Digital Experience Monitoring (DEX), you can test if your devices can connect to a private or public endpoint through the WARP client. Tests allow you to monitor availability for a given application and investigate performance issues reported by your end users.\n\nDEX tests will only run when the WARP client is turned on, whereas [fleet status](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/#fleet-status) metrics are always available.\n\nTo specify the target group of a test, use [DEX rules](https://developers.cloudflare.com/cloudflare-one/insights/dex/rules/).\n\n* [HTTP test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/http/)\n* [Traceroute test](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/traceroute/)\n* [View test results](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/view-results/)\n\n## Export DEX application test logs\n\nThe Cloudflare Logs documentation lists the full set of data fields available in [DEX application tests](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/dex_application_tests/).\n\nThe log data for all [DEX application tests](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/dex_application_tests/) (including HTTP tests) can be exported to [R2](https://developers.cloudflare.com/r2/), a cloud bucket, or a SIEM via [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/).\n\n</page>\n\n<page>\n---\ntitle: Access audit logs  Cloudflare One docs\ndescription: Use Access audit logs to review authentication events and requests\n  to protected URI paths and infrastructure targets.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/index.md\n---\n\nCloudflare Access generates two types of audit logs:\n\n* **[Authentication audit logs](#authentication-audit-logs)** maintain a record of authentication events.\n* **[Per-request audit logs](#per-request-audit-logs)** record requests to protected URI paths and infrastructure targets.\n\n## Authentication logs\n\nCloudflare Access logs an authentication event whenever a user or service attempts to log in to an application, whether the attempt succeeds or not.\n\n[Identity-based authentication](#identity-based-authentication) refers to login attempts that matched on user email, IdP group, SAML group, or OIDC claim.\n\n[Non-identity authentication](#non-identity-authentication) refers to login attempts that matched a non-identity policy such as IP address, device posture, country, valid certificate, or service token.\n\nNote\n\nAuthentication logs do not capture the user's actions during a self-hosted or SaaS application session.\n\n### Identity-based authentication\n\n#### View Access authentication logs\n\n* Dashboard\n\n  To view logs for identity-based authentication events:\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights** > **Logs** > **Access authentication logs**.\n  2. Select a row to view details such as the login method, the IP address of the user, and more.\n\n* API\n\n  The [Access authentication logs](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/logs/subresources/access_requests/methods/list/) API endpoint provides a custom URL to export audit log events for your account.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Access: Audit Logs Read`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "#### Explanation of the fields\n\nIdentity-based authentication logs contain the following fields:\n\n##### Basic information\n\n| Field | Description |\n| - | - |\n| **App** | Name of the Access application. |\n| **User email** | Email address of the authenticating user. |\n| **User ID** | UUID of the authenticating user. |\n| **IP address** | IP address of the authenticating user. |\n| **App UID** | UUID of the Access application. |\n| **App domain** | URL of the Access application. |\n| **App type** | Specifies the type of Access application: self-hosted, browser SSH, browser VNC, browser RDP, SaaS, or infrastructure. |\n| **Event** | Type of authentication event, such as a login attempt. |\n| **Connection** | IdP used to authenticate. |\n| **Allow** | Result of the authentication event. |\n| **Request time** | Timestamp of the authentication event. |\n| **Ray ID** | A unique identifier for every request through Cloudflare. |\n| **Country** | Country associated with the user's IP address. |\n\n##### Infrastructure applications\n\nCloudflare Access logs the following information when the user authenticates to an [infrastructure application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/):\n\n| Field | Description |\n| - | - |\n| **Hostname** | Hostname of the infrastructure target. |\n| **Target ID** | UUID of the infrastructure target. |\n| **SSH user** | The UNIX user, such as `root`, that the authenticating user specified when connecting to the infrastructure target. |\n| **SSH logs** | SSH commands that the user ran on the target. Requires configuring an [SSH encryption key](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/#ssh-command-logs) before the session begins. |\n\n### Non-identity authentication\n\nTo retrieve logs for non-identity authentication events, use the [GraphQL Analytics API](https://developers.cloudflare.com/analytics/graphql-api/tutorials/querying-access-login-events/). These logs are not available in Zero Trust.\n\n## Per-request logs\n\nUsers who have authenticated through Access have access to authorized URL paths for the duration of their session. Cloudflare provides several ways to audit these requests.\n\n### Using Cloudflare Logs\n\nEnterprise customers have access to detailed logs of requests on their Cloudflare dashboard. Enterprise customers also have access to Cloudflare's Logpush service, which can be configured from the Cloudflare dashboard or API. For more information about Cloudflare HTTP and infrastructure logging, refer to [Cloudflare Logs](https://developers.cloudflare.com/logs/).\n\nOnce a member of your team authenticates to reach an HTTP resource behind Access, Cloudflare generates a token for that user that contains their SSO identity. The token is structured as a JSON Web Token (JWT). Cloudflare relies on an RSA Signature with SHA-256, or RS256, an asymmetric algorithm, to perform that signature. Cloudflare also makes the public key available, so that you can validate their authenticity, as well.\n\nWhen a user requests a given URL, Access appends the user identity from that token as a request header, which we then log as the request passes through our network. Your team can collect these logs in your preferred third-party Security information and event management (SIEM) software or storage destination by using [Cloudflare Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/). When enabled with the Access user identity field, the logs will export to your systems as JSON similar to the logs below.",
      "language": "unknown"
    },
    {
      "code": "### Using the `cf-access-user` field\n\nIn addition to the HTTP request fields available in Cloudflare Enterprise logging, requests made to applications behind Access include the `cf-access-user` field, which contains the user identity string. This offers another tool for auditing user behavior. To add the `cf-access-user` field to your HTTP request logs, you must add it as a custom field. Refer to [Custom fields](https://developers.cloudflare.com/logs/logpush/logpush-job/custom-fields/) for instructions.\n\nKeep in mind that Access does not log all interactions. For example, per-request audit logs can indicate that a specific user visited `domain.com/admin` and then `domain.com/admin/panel`, but the logs can only identify user interactions that result in a new HTTP request.\n\n</page>\n\n<page>\n---\ntitle: Filter different views  Cloudflare One docs\ndescription: You can utilize different Log filters to only view specific data\n  from Magic Firewall.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/filter-views/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/filter-views/index.md\n---\n\nYou can utilize different [Log filters](https://developers.cloudflare.com/logs/logpush/logpush-job/filters/) to only view specific data from Magic Firewall.\n\n## Filter by enabled or disabled rules\n\nUse the filter examples below to filter your Magic Firewall traffic to display events for enabled or disabled rules.\n\nThe example below only displays fields relevant to Magic Firewall, and the filter only displays events for disabled rules.",
      "language": "unknown"
    },
    {
      "code": "The example below only displays fields relevant to Magic Firewall, and the filter only displays events for enabled rules.",
      "language": "unknown"
    },
    {
      "code": "## Filter by allowed or blocked traffic\n\nUse the filter examples below to filter your Magic Firewall traffic to display events for allowed or blocked traffic.\n\nThe example below only displays fields relevant to Magic Firewall, and the filter only displays events where no explicit action was taken, for example, a packet \"fell through\" Magic Firewall. This example does not have any rules applied.",
      "language": "unknown"
    },
    {
      "code": "The example below only displays fields relevant to Magic Firewall, and the filter only displays events where explicit action was taken. The example includes both enabled and disabled Magic Firewall rules.",
      "language": "unknown"
    },
    {
      "code": "## Filter by relevant fields to Magic Firewall\n\nUse the examples below to filter out fields that are not relevant to traffic flowing through Magic Firewall. The example below only includes Magic Firewall events.",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Enable Email security logs  Cloudflare One docs\ndescription: Email security allows you to configure Logpush to send detection\n  data to an endpoint of your choice.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/enable-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/enable-logs/index.md\n---\n\nEmail security allows you to configure Logpush to send detection data to an endpoint of your choice.\n\n## Enable detection logs\n\nDetection logs generate logs made by Email security and some of the metadata associated with the detection.\n\nTo enable detection logs, refer to [Enable destinations](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/).\n\nIf you enable detection logs using [R2](https://developers.cloudflare.com/r2/), choose **Email security alerts** when configuring the **Dataset**.\n\n## Enable user action logs\n\nUser action logs allow you to view logs regarding all actions taken via the [API](https://developers.cloudflare.com/api/resources/email_security/) or the dashboard.\n\nBefore you can enable audit logs for Email security, you will have to enable logpush jobs to your storage destination. Refer to [Enable destinations](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/) to enable logs on destinations such as Cloudflare R2, HTTP, Amazon S3, and more.\n\nOnce you have configured your destination, you can set up audit logs for user action:\n\n1. In the Cloudflare dashboard, go to the **Logpush** page.\n\n   [Go to **Logpush**](https://dash.cloudflare.com/?to=/:account/logs)\n\n2. Select your storage destination.\n\n3. Select the three dots > **Edit**.\n\n4. Under **Configure logpush job**:\n\n* **Job name**: Enter the job name, if it is not already prepopulated.\n\n* **If logs match** > Select **Filtered logs**:\n\n  * **Field**: Choose `ResourceType`.\n  * **Operator**: Choose `starts with`.\n  * **Value**: Enter `email_security`.\n\n1. Select **Submit**.\n\nYou can now view logs via the Cloudflare dashboard.\n\n</page>\n\n<page>\n---\ntitle: Gateway activity logs  Cloudflare One docs\ndescription: Gateway activity logs show the individual DNS queries, Network\n  packets, and HTTP requests inspected by Gateway. You can also download\n  encrypted SSH command logs for sessions proxied by Gateway.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/index.md\n---\n\nPrivate source IP substitution\n\nGateway logs will only show the public IP address for the **Source IP** field. Private IP addresses are substituted by a public IP address via network address translation (NAT).\n\nGateway activity logs show the individual DNS queries, Network packets, and HTTP requests inspected by Gateway. You can also download encrypted [SSH command logs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/ssh-logging/) for sessions proxied by Gateway.\n\nTo view Gateway activity logs, log in to [Cloudflare One](https://one.dash.cloudflare.com/) and go to **Insights** > **Logs** and choose a type of Gateway log. Select an individual row to investigate the event in more detail.\n\nEnterprise users can generate more detailed logs with [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/).\n\n## Selective logging\n\nBy default, Gateway logs all events, including DNS queries and HTTP requests that are allowed and not a risk. You can choose to disable logs or only log blocked requests. To customize what type of events are recorded, log in to [Cloudflare One](https://one.dash.cloudflare.com/) and go to **Traffic policies** > **Traffic settings**. Under **Traffic logging** > **Log traffic activity**, indicate your DNS, Network, and HTTP log preferences.\n\nThese settings will only apply to logs displayed in Cloudflare One. Logpush data is unaffected.\n\n## DNS logs\n\n### Explanation of the fields\n\n#### Basic information\n\n| Field | Description |\n| - | - |\n| **Query name** | Name of the domain that was queried. |\n| **Query ID** | UUID of the query assigned by Cloudflare. |\n| **Email** | Email address of the user who registered the WARP client where traffic originated from. If a non-identity on-ramp (such as a [proxy endpoint](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)) or machine-level authentication (such as a [service token](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/)) was used, this value will be `non_identity@<team-domain>.cloudflareaccess.com`. |\n| **Action** | The [Action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#actions) Gateway applied to the query (such as Allow or Block). |\n| **Time** | Date and time of the DNS query. |\n| **Resolver decision** | The reason why Gateway applied a particular **Action** to the request. Refer to the [list of resolver decisions](#resolver-decisions). |\n| **Resolved IPs** | Resolved IP addresses in the response. |\n| **CNAMEs** | `CNAME` records in the query. |\n\n#### Configuration information\n\n| Field | Description |\n| - | - |\n| **DNS location** | [User-configured location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) from where the DNS query was made. |\n| **Policy name** | Name of the matched policy. |\n| **Policy ID** | ID of the matched policy. |\n| **Policy description** | Description of the matched policy. |\n| **DoH subdomain** | DoH subdomain of the DNS location. |\n| **Protocol** | Protocol that was used to make the DNS query (such as `https`). |\n\n#### Identities\n\n| Field | Description |\n| - | - |\n| **Email** | Email address of the user who registered the WARP client where traffic originated from. |\n| **User ID** | UUID of the user. Each unique email address in your organization will have a UUID associated with it. |\n| **Registration ID** | UUID of the user's WARP client registration. A unique registration ID is generated each time a device is registered for a particular email. The same physical device may have multiple registration IDs. |\n| **Device name** | Display name of the device returned by the operating system to the WARP client. Typically this is the hostname of a device. Not all devices will have a device name. Device names are not guaranteed to be unique. |\n| **Device ID** | UUID of the device connected with the WARP client. Each physical device in your organization will have a UUID. |\n| **Last authenticated** | Date and time the user last authenticated their Zero Trust session. |\n\n#### DNS query details\n\n| Field | Description |\n| - | - |\n| **Query ID** | UUID of the query assigned by Cloudflare. |\n| **Query type** | Type of [DNS query](https://en.wikipedia.org/wiki/List_of_DNS_record_types). |\n| **Initial query domain categories** | [Content categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) that the domain belongs to. |\n| **Matched categories** | Name of the Gateway policy category that match the domain. |\n| **Matched indicator feed names** | Name of the indicator feeds that matched a Gateway policy. |\n| **Query indicator feed names** | Name of the indicator feeds that a matched domain or IP belongs to. |\n| **Resolved continent IP geolocation** | Continent code of the resolved IP address. |\n| **Resolved country IP geolocation** | Country code of the resolved IP address. |\n| **DoT subdomain** | DoT subdomain of the DNS location. |\n| **Source IP** | Public source IP address of the DNS query. |\n| **Source IP continent** | Continent code of the source IP address. |\n| **Source IP country** | Country code of the source IP address. |\n| **Source internal IP** | Private IP address assigned by the user's local network. |\n| **Application name** | Name of the application that matched the domain. |\n| **Resolver IP** | Public IP address of the DNS resolver. |\n| **Port** | Port that was used to make the DNS query. |\n| **Location ID** | ID of the DNS location where the query originated. |\n| **Scheduling - Time zone** | Time zone of the DNS query source. |\n| **Scheduling - Time zone inferred method** | Method used to determine the DNS query source's time zone. |\n\n#### DNS response details\n\n| Field | Description |\n| - | - |\n| **Resolved CNAME categories** | Content categories associated with the resolved `CNAME` records in the response. |\n| **Resolved IP categories** | Content categories associated with the resolved IPs in the response. |\n| **Resolved IPs** | Resolved IPs in the response. |\n| **Authoritative nameserver IP** | IP address of the authoritative nameserver answering the DNS query. |\n| **EDE errors** | [Extended DNS error codes](https://www.rfc-editor.org/rfc/rfc8914.html) in the response. |\n\n#### Custom resolver\n\n| Field | Description |\n| - | - |\n| **Address** | Address of your custom resolver. |\n| **Policy** | Name of the matched resolver policy. |\n| **Response** | Status of the custom resolver response. |\n| **Time (in milliseconds)** | Duration of time it took for the custom resolver to respond. |\n\n### Resolver decisions\n\n| Name | Value | Description |\n| - | - | - |\n| `blockedByCategory` | `3` | Domain or hostname matched a category in a Block policy. |\n| `allowedOnNoLocation` | `4` | Allowed because query did not match a Gateway DNS location. |\n| `allowedOnNoPolicyMatch` | `5` | Allowed because query did not match a policy. |\n| `blockedAlwaysCategory` | `6` | Domain or hostname is always blocked by Cloudflare. |\n| `overrideForSafeSearch` | `7` | Response was overridden by a Safe Search policy. |\n| `overrideApplied` | `8` | Response was overridden by an Override policy. |\n| `blockedRule` | `9` | IP address in the response matched a Block policy. |\n| `allowedRule` | `10` | IP address in the response matched an Allow policy. |\n\n## Network logs\n\nFailed connection logs\n\nGateway will only log TCP traffic with completed connections. If a connection is not complete (such as a TCP SYN with no SYN ACK), Gateway will not log this traffic in network logs.\n\nGateway can log failed connections in [network session logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/). These logs are available for Enterprise users via [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/) or [GraphQL](https://developers.cloudflare.com/cloudflare-one/insights/analytics/gateway/#graphql-queries).\n\n### Explanation of the fields\n\n#### Basic information\n\n| Field | Description |\n| - | - |\n| **Source IP** | IP address of the user sending the packet. |\n| **Source Internal IP** | Private IP address assigned by the user's local network. |\n| **Destination IP** | IP address of the packet's target. |\n| **Action** | The Gateway [Action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#actions) taken based on the first rule that matched (such as Allow or Block). |\n| **Session ID** | ID of the unique session. |\n| **Time** | Date and time of the session. |\n\n#### Matched policies\n\n| Field | Description |\n| - | - |\n| **DNS location** | [User-configured location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) from where the DNS query was made. |\n| **Policy name** | Name of the matched policy. |\n| **Policy ID** | ID of the policy enforcing the decision Gateway made. |\n| **Policy description** | Description of the matched policy. |\n\n#### Identities\n\n| Field | Description |\n| - | - |\n| **Email** | Email address of the user sending the packet. This is generated by the WARP client. |\n| **User ID** | ID of the user sending the packet. This is generated by the WARP client. |\n| **Registration ID** | ID of the user's device registration. This is generated by the WARP client. |\n| **Device name** | Name of the device that sent the packet. |\n| **Device ID** | ID of the physical device that sent the packet. This is generated by the WARP client. |\n| **Last authenticated** | Date and time the user last authenticated with Zero Trust. |\n\n#### Network query details\n\n| Field | Description |\n| - | - |\n| **Source IP** | IP address of the user sending the packet. |\n| **Source port** | Source port number for the packet. |\n| **Source country** | Country code for the packet source. |\n| **Source IP continent** | Continent code of the source IP address. |\n| **Source IP country** | Country code of the source IP address. |\n| **Destination IP** | IP address of the packet's target. |\n| **Destination port** | Destination port number for the packet. |\n| **Destination IP continent** | Continent code of the IP address for the packet's destination. |\n| **Destination IP country** | Country code of the IP address for the packet's destination. |\n| **Transport protocol** | Protocol over which the packet was sent. |\n| **Detected Protocol** | The detected [network protocol](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/). |\n| **SNI** | Host whose Server Name Indication (SNI) header Gateway will filter traffic against. |\n| **Virtual Network** | [Virtual network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) that the client is connected to. |\n| **Category details** | Category or categories associated with the packet. |\n| **Proxy endpoint** | [PAC file proxy endpoint](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) Gateway forwarded traffic to, if applicable. |\n| **Application ID** | ID of the application that matched the domain. |\n| **Application name** | Name of the application that matched the domain. |\n\n## HTTP logs\n\nNote\n\nWhen an HTTP request results in an error, Gateway logs the first 512 bytes of the request for 30 days for internal troubleshooting. Otherwise, Gateway does not log HTTP bodies.\n\n### Explanation of the fields\n\n#### Basic information\n\n| Field | Description |\n| - | - |\n| **Host** | Hostname in the HTTP header for the HTTP request. Gateway will log the SNI in this field if it responded to the request with a Do Not Inspect action. If Gateway does not receive the SNI, this field will be empty. |\n| **Email** | Email address of the user who made the HTTP request. This is generated by the WARP client. |\n| **Action** | The Gateway [Action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#actions) taken based on the first rule that matched (such as Allow or Block). |\n| **Request ID** | Unique ID of the request. |\n| **Time** | Date and time of the HTTP request. |\n| **Source internal IP** | Private IP address assigned by the user's local network. |\n| **User agent** | User agent header sent in the request by the originating device. |\n| **Policy details** | Policy corresponding to the decision Gateway made based on the traffic criteria of the request. |\n| **DLP profiles** | Name of the matched [DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/). |\n| **DLP profile entries** | Name of the matched entry within the DLP profile. |\n| **Uploaded/downloaded file** | Information about the file transferred in the request found by [enhanced file detection](#enhanced-file-detection). Details include:- File name\n- File type\n- File size\n- File hash (for Allowed requests only)\n- Content type\n- Direction (Upload/Download)\n- Action (Block/Allow) |\n\n#### Matched policies\n\n| Field | Description |\n| - | - |\n| **DNS location** | [User-configured location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) from where the DNS query was made. |\n| **Policy name** | Name of the matched policy. |\n| **Policy ID** | ID of the matched policy. |\n| **Policy description** | Description of the matched policy. |\n| **Matched category ID** | ID of the category matched in the policy. |\n| **Matched category name** | Name of the category matched in the policy. |\n\n#### Identities\n\n| Field | Description |\n| - | - |\n| **Email** | Email address of the user who made the HTTP request. This is generated by the WARP client. |\n| **User ID** | ID of the user who made the request. This is generated by the WARP client. |\n| **Registration ID** | ID of the user's device registration. This is generated by the WARP client. |\n| **Device name** | Name of the device that made the request. |\n| **Device ID** | ID of the physical device that made the request. This is generated by the WARP client on the device that created the request. |\n| **Last authenticated** | Date and time the user last authenticated with Zero Trust. |\n\n#### HTTP query details\n\n| Field | Description |\n| - | - |\n| **HTTP Version** | HTTP version of the origin that Gateway connected to on behalf of the user. |\n| **HTTP Method** | HTTP method used for the request (such as `GET` or `POST`). |\n| **HTTP Status Code** | [HTTP status code](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/) returned in the response. |\n| **URL** | Full URL of the HTTP request. |\n| **Referer** | Referer request header containing the address of the page making the request. |\n| **Source IP** | Public source IP address of the HTTP request. |\n| **Source Port** | Port that was used to make the HTTP request. |\n| **Source IP continent** | Continent code of the HTTP request. |\n| **Source IP country** | Country code of the HTTP request. |\n| **Destination IP** | Public IP address of the destination requested. |\n| **Destination Port** | Port of the destination requested. |\n| **Destination IP continent** | Continent code of the destination requested. |\n| **Destination IP country** | Country code of the destination requested. |\n| **Blocked file reason** | Reason why the file was blocked if a file transfer occurred or was attempted. |\n| **Category details** | Detailed information on the category the blocked file belongs to. |\n| **Application ID** | ID of the application that matched the domain. |\n| **Application name** | Name of the application that matched the domain. |\n| **Categories** | [Content categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) that the domain belongs to. |\n| **Proxy endpoint** | [PAC file proxy endpoint](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) Gateway forwarded traffic to, if applicable. |\n| **Virtual Network** | [Virtual network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) that the client is connected to. |\n| **Sandbox scanned** | Status of the [file quarantine](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/file-sandboxing/). |\n\n#### File detection details\n\n| Field | Description |\n| - | - |\n| **Name** | Name of the detected file. |\n| **Type** | File type of the detected file. |\n| **Size** | Size of the detected file. |\n| **Hash** | Hash of the detected file, generated by DLP. |\n| **Content type** | MIME type of the detected file. |\n| **Direction** | Upload or download direction of the detected file. |\n| **Action** | The Action Gateway applied to the request. |\n\n### Enhanced file detection\n\nEnhanced file detection is an optional feature to extract more file information from HTTP traffic. When turned on, Gateway will read file information from the HTTP body rather than the HTTP headers to provide greater accuracy and reliability. This feature may have a minor impact on performance for file-heavy organizations.\n\nTo turn on enhanced file detection:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n2. In **Proxy and inspection settings**, turn on **Inspect HTTPS requests with TLS decryption**.\n3. In **Policy settings**, turn on **Allow enhanced file detection**.\n\n### Isolate requests\n\nWhen a user creates an [isolation policy](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/), Gateway logs the initial request that triggers isolation as an Isolate action. Because this request is not isolated yet, the `is_isolated` field will return `false`. Zero Trust then securely returns the result to the user in an isolated browser. Gateway will log all subsequent requests in the isolated browser with the action (such as Allow or Block), and the `is_isolated` field will return `true`.\n\n## Limitations\n\nIf a connection closes before Gateway inspects and filters the traffic, Gateway will log the traffic with an Unknown action.\n\nGateway activity logs are not available in the dashboard if you turn on the [Customer Metadata Boundary (CMB)](https://developers.cloudflare.com/data-localization/metadata-boundary/) within Cloudflare Data Localization Suite (DLS). Enterprise users using CMB can still export logs via [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/). For more information, refer to [DLS product compatibility](https://developers.cloudflare.com/data-localization/compatibility/#zero-trust).\n\n</page>\n\n<page>\n---\ntitle: Logpush integration  Cloudflare One docs\ndescription: With Cloudflare's Logpush service, you can configure the automatic\n  export of Zero Trust logs to third-party storage destinations or to\n  third-party security information and event management (SIEM) solutions. Once\n  exported, your team can analyze and audit the data as needed.\nlastUpdated: 2025-12-23T00:33:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/index.md\n---\n\nNote\n\nOnly available on Enterprise plans.\n\nWith Cloudflare's [Logpush](https://developers.cloudflare.com/logs/logpush/) service, you can configure the automatic export of Zero Trust logs to third-party storage destinations or to third-party security information and event management (SIEM) solutions. Once exported, your team can analyze and audit the data as needed.\n\n## Export Zero Trust logs with Logpush\n\nDashboard limitation\n\nCloudflare One does not support configuring [Cloudflare R2](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/r2/) as a Logpush destination in the dashboard. To use R2 as a destination for Zero Trust logs, configure your Logpush jobs [with the API](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/r2/#manage-via-api).\n\nTo configure Logpush for Zero Trust logs:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Logs**.\n2. Select **Manage Logpush**.\n3. In Logpush, select **Create a Logpush job**.\n4. Choose a [Logpush destination](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/).\n5. Follow the service-specific instructions to configure and validate your destination.\n6. Choose the [Zero Trust datasets](#zero-trust-datasets) to export.\n7. Enter a **Job name**, any [filters](https://developers.cloudflare.com/logs/logpush/logpush-job/filters/) you would like to add, and the data fields you want to include in the logs.\n8. (Optional) In **Advanced settings**, choose the timestamp format you prefer and whether you want to enable log sampling.\n9. Select **Submit**.\n\nThe setup of your Logpush integration is now complete. Logpush will send updated logs every five minutes to your selected destination. You can configure multiple destinations and add additional fields to your logs by returning to the **Logpush** page.\n\nFor more information on supported destinations, refer to [Enable destinations](https://developers.cloudflare.com/logs/logpush/logpush-job/enable-destinations/).\n\n## Zero Trust datasets\n\nRefer to [Logpush datasets](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/) for a list of all available fields.\n\n| Dataset | Description |\n| - | - |\n| [Access Requests](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/access_requests/) | HTTP requests to sites protected by Cloudflare Access |\n| [Audit Logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/audit_logs/) | Authentication events through Cloudflare Access |\n| [Browser Isolation User Actions](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/biso_user_actions/) | Data transfer actions performed by a user in the remote browser |\n| [CASB Findings](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/casb_findings/) | Security issues detected by Cloudflare CASB |\n| [Device Posture Results](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/device_posture_results/) | Device posture status from the WARP client |\n| [DEX Application Tests](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/dex_application_tests/) | Device application synthetic test results from the WARP client |\n| [DEX Device State Events](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/dex_device_state_events/) | Device event data like connectivity, CPU usage, and Disk I/O from the WARP client |\n| [Gateway DNS](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_dns/) | DNS queries inspected by Cloudflare Gateway |\n| [Gateway HTTP](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_http/) | HTTP requests inspected by Cloudflare Gateway |\n| [Gateway Network](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_network/) | Network packets inspected by Cloudflare Gateway |\n| [SSH Logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/ssh_logs/) | SSH command logs for [Access for Infrastructure targets](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/) |\n| [WARP Config Changes](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/warp_config_changes/) | Event logs that are generated whenever a WARP device changes [profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/) |\n| [WARP Toggle Events](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/warp_toggle_changes/) | Event logs that are generated whenever a WARP device toggles WARP on or off |\n| [Zero Trust Network Session Logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/) | Network session logs for traffic proxied by Cloudflare Gateway |\n\n## Verify regional map application\n\nIf you are using [Regional Services](https://developers.cloudflare.com/data-localization/regional-services/) with Cloudflare One, you can configure which subset of Cloudflare data centers decrypt and route your traffic. This allows you to accommodate regional restrictions like GDPR or meet compliance requirements that include geographic restrictions on data flows or processing.\n\nTo verify that your regional map is being applied correctly, check the `IngressColoName` field in your [Zero Trust Network Session logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/#ingresscoloname). This field shows the name of the Cloudflare data center where traffic ingressed. Since regionalization is applied upstream from Gateway, the ingress data center will be located within your configured regional map, confirming that traffic is being processed in the correct region.\n\n## Parse DNS logs\n\nLogpush logs the following fields for each DNS query:\n\n* Query name\n* Query type\n* Query class\n* Response TTL\n* Response data\n\nDNS query resource records are available in [Base64-encoded binary format](https://datatracker.ietf.org/doc/html/rfc1035#section-4.1.3) and JSON. For example:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Posture logs  Cloudflare One docs\ndescription: Posture logs show the device posture check results reported by the WARP client.\nlastUpdated: 2025-12-02T17:49:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/posture-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/posture-logs/index.md\n---\n\nPosture logs show the [device posture check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/) results reported by the WARP client.\n\nTo view device posture logs, log in to [Cloudflare One](https://one.dash.cloudflare.com/) and go to **Logs** > **Posture**. Logs will only display if you have configured [device posture checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/) for your Zero Trust organization.\n\nEnterprise users can generate more detailed logs with [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/).\n\n## Explanation of the fields\n\n### Device details\n\n| Field | Description |\n| - | - |\n| **Name** | Name of the device. |\n| **ID** | Device ID generated by the WARP client. |\n| **Serial number** | Serial number of the device. |\n| **Manufacturer** | Manufacturer of the device. |\n| **Model** | Model of the device. |\n\n### User details\n\n| Field | Description |\n| - | - |\n| **Email** | Email used to register the device with Zero Trust. |\n| **User ID** | UUID of the user who registered the device. |\n| **Registration ID** | UUID of the user's WARP client registration. |\n\n### Posture details\n\n| Field | Description |\n| - | - |\n| **Name** | Name of the [device posture check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/). |\n| **Type** | Type of [WARP client check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/) or [service provider check](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/). |\n| **Rule ID** | UUID of the device posture check. |\n| **Conditions met** | Whether the device passed or failed the posture check criteria. Evaluates to `true` if the **Received values** match the **Expected values**. |\n| **Expected values** | Values required to pass the device posture check. |\n| **Received values** | Posture check values detected by the WARP client. |\n\n</page>\n\n<page>\n---\ntitle: SCIM activity logs  Cloudflare One docs\ndescription: SCIM activity logs allow administrators to audit how SCIM\n  provisioning events in an identity provider (such as create, update, and\n  delete) affect a user's identity and group membership in Zero Trust. You can\n  compare your Zero Trust SCIM logs with your identity provider's SCIM logs to\n  track how identity data is shared between the two services and pinpoint the\n  source of any provisioning errors.\nlastUpdated: 2025-12-02T17:49:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/index.md\n---\n\nSCIM activity logs allow administrators to audit how [SCIM provisioning](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/) events in an identity provider (such as create, update, and delete) affect a user's identity and group membership in Zero Trust. You can compare your Zero Trust SCIM logs with your identity provider's SCIM logs to track how identity data is shared between the two services and pinpoint the source of any provisioning errors.\n\n## View SCIM logs\n\nFor an overview of SCIM events across all users, log in to [Cloudflare One](https://one.dash.cloudflare.com/) and go to **Logs** > **SCIM provisioning**. This page lists the inbound SCIM requests from all identity providers configured with SCIM. You can select an individual request to view more details about the SCIM operation.\n\nTo investigate how SCIM events impacted a specific user, go to their [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\n## Log fields\n\nSCIM provisioning logs show the following information for each inbound SCIM request:\n\n* **IdP name**: Name of the identity provider\n* **Timestamp**: Date and time of the request\n* **Action**: HTTP request method (`POST`, `PUT`, `PATCH`, `DELETE`)\n* **User email**: User who received the SCIM identity update\n* **Group name**: Group that received the SCIM identity update\n* **Resource type**: SCIM resource that was modified (`GROUP` or `USER`)\n* **CF resource ID**: Persistent identifier for the user or group created by Cloudflare SCIM\n* **IDP resource ID**: Identifier for the user or group provided by the identity provider\n* **Outcome**: Whether the SCIM request was applied successfully (`SUCCESS` or `ERROR`)\n* **Request body**: HTTP request body containing the data that was added, modified, or removed\n* **JSON log**: SCIM request log in JSON format\n\n</page>\n\n<page>\n---\ntitle: Tunnel audit logs  Cloudflare One docs\ndescription: \"Audit logs for Tunnel are available in the account section of the\n  Cloudflare dashboard which you can find by selecting your name or email in the\n  upper right-hand corner of the dashboard. The following actions are logged:\"\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/tunnel-audit-logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/tunnel-audit-logs/index.md\n---\n\nAudit logs for Tunnel are available in the [account section of the Cloudflare dashboard](https://dash.cloudflare.com/?account=audit-log) which you can find by selecting your name or email in the upper right-hand corner of the dashboard. The following actions are logged:\n\n| Action | Description |\n| - | - |\n| Registered | This is logged when Tunnel is started and connects to the Cloudflare edge. |\n| Unregistered | This is logged when Tunnel is disconnected from the Cloudflare edge. |\n| CNAME add | This is logged when Tunnel registers a new DNS (CNAME or AAAA) record for the tunneled application. |\n\n</page>\n\n<page>\n---\ntitle: Use Logpush with IDS  Cloudflare One docs\ndescription: \"You can use Logpush with Magic Firewall IDS to log detected risks:\"\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/use-logpush-with-ids/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/use-logpush-with-ids/index.md\n---\n\nYou can use Logpush with Magic Firewall IDS to log detected risks:\n\n1. Consult the [Logpush Destination docs](https://developers.cloudflare.com/logs/logpush/logpush-job/api-configuration/#destination) to learn about what destinations Logpush supports. The documentation will also instruct you on how to correctly format the destination URL for Logpush.\n\n2. Follow the [Manage Lopush with cURL](https://developers.cloudflare.com/logs/logpush/examples/example-logpush-curl/) tutorial to validate your Logpush destination and define a Logpush job.\n\n## Notes on using Logpush with IDS\n\n* Magic IDS is an account-scoped dataset. This means the string `/zone/<ZONE_ID>` in the Cloudflare API URLs in the tutorial should be replaced with `/account/<ACCOUNT_ID>`.\n\n* Consult the [Magic IDS Detection fields doc](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/magic_ids_detections/) to know what fields you want configured for the job.\n\n* When creating the Logpush job, the dataset field should equal `magic_ids_detections`.\n\n* Timestamps by default are unixnano. Consult the [Logpush Options docs](https://developers.cloudflare.com/logs/logpush/logpush-job/api-configuration/#options) to learn what format you can choose that will be compatible with your destination and/or expectations. Note that all options must be added *after* all fields you want from the Logpush job, akin to URL parameters.\n\n</page>\n\n<page>\n---\ntitle: Diagnostics  Cloudflare One docs\ndescription: \"Cloudflare supports two types of packet captures: full and sample.\n  Full packet captures is the default behavior.\"\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/diagnostics/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/diagnostics/index.md\n---\n\nCloudflare supports two types of packet captures: full and sample. Full packet captures is the default behavior.\n\nNote\n\nThe maximum packet capture runtime is 24 hours for sample and full packet captures.\n\n## Sample packet captures\n\nSample packet captures collects historical data on network traffic that has already passed through Cloudflare's network. It will not collect any new traffic sent to Cloudflare's network after the packet capture has started. All sample packet captures will complete immediately after they are started because they query historical traffic data.\n\nSample packet captures can be viewed in the Cloudflare dashboard. They only include the first 160 bytes of data. This is useful for capturing packet headers, but will not provide detailed packet data. The sample data is collected across all Cloudflare's data centers to build a PCAP file. This allows you to get a global picture of traffic across all data centers.\n\nYou should use full packet captures if you need to collect data on packets that pass through your network less frequently.\n\n## Full packet captures\n\nFull packet captures will actively monitor Cloudflare's network for packets that match the selected filters, and will capture the matching packet data. The matching packet data is saved to a cloud storage bucket that is owned and configured by you.\n\nFull packet captures will collect new traffic sent to Cloudflare's network after the packet capture has started, and include the full packet data. This type of capture cannot be viewed in the Cloudflare dashboard. You can download them from a cloud storage bucket and analyze them in Wireshark or another packet capture tool.\n\nRefer to the articles in this section to learn how to use packet captures.\n\n* [Packet captures](https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/diagnostics/packet-captures/)\n* [Buckets](https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/diagnostics/buckets/)\n\n</page>\n\n<page>\n---\ntitle: Anthropic  Cloudflare One docs\ndescription: The Anthropic integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Anthropic account that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/anthropic/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/anthropic/index.md\n---\n\nThe Anthropic integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Anthropic account that could leave you and your organization vulnerable.\n\nThis integration covers the following Anthropic products:\n\n* Claude Console (organizations, workspaces/projects, users, invites)\n* Anthropic API Platform (organization and project API keys)\n\n## Integration prerequisites\n\n* An Anthropic [Team or Enterprise organization](https://www.anthropic.com/pricing#team-&-enterprise)\n* [Organization-level admin (or equivalent) privileges in Anthropic](https://support.anthropic.com/articles/10186004-api-console-roles-and-permissions) to view organization metadata and manage API keys\n\n## Integration permissions\n\nFor the Anthropic integration to function, Cloudflare CASB requires authorization via **API keys**:\n\n* `Organization API key (organization-level)`: Grants read-only access to organization/workspace metadata, members and invites, and key metadata used for findings.\n* (Optional) `Project API key (project-level)`: Grants read-only access to project metadata and keys when you include project scopes in the scan.\n\nThese credentials follow the principle of least privilege so that only the minimum required access is granted.\n\n## Security findings\n\nThe Anthropic integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/anthropic.mdx.atom).\n\n### API key hygiene\n\nDetect API keys that may be unused or overdue for rotation.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Anthropic: Unused API key | `f343cd22-21f0-45a6-b6f7-39b1539a0f2b` | Medium |\n\n### Access security\n\nFlag organization access issues to help enforce best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Anthropic: High-privilege invite | `a435d091-3bb1-42e1-bc98-32d80c6340a5` | High |\n| Anthropic: Stale pending invite | `5667f7fa-4215-4a8e-80d7-4694ea33335b` | Low |\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Anthropic: Downloadable File with DLP Profile match | `74ec2a38-0e69-48d4-80ed-a8faad5f40ef` | High |\n\n</page>\n\n<page>\n---\ntitle: Atlassian Confluence  Cloudflare One docs\ndescription: The Atlassian Confluence integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Atlassian Confluence Cloud account that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-confluence/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-confluence/index.md\n---\n\nThe Atlassian Confluence integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Atlassian Confluence Cloud account that could leave you and your organization vulnerable.\n\nNote\n\nAt this time, the CASB integration for Confluence is only compatible with Confluence Cloud accounts. Support for Confluence Data Center will come at a future date.\n\n## Integration prerequisites\n\n* A Confluence Cloud plan (Free, Standard, Premium, Enterprise)\n\n* Access to a Confluence Cloud account with Site admin and/or Organization admin permissions\n\n## Integration permissions\n\nFor the Confluence Cloud integration to function, Cloudflare CASB requires the following permissions via an OAuth 2.0 app:\n\n* `read:confluence-space.summary`\n* `read:confluence-props`\n* `read:confluence-content.all`\n* `read:confluence-content.summary`\n* `read:confluence-content.permission`\n* `read:confluence-user`\n* `read:confluence-groups`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Atlassian scopes documentation](https://developer.atlassian.com/cloud/confluence/scopes-for-oauth-2-3LO-and-forge-apps/).\n\n## Security findings\n\nThe Atlassian Confluence integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/atlassian-confluence.mdx.atom).\n\n### Access security\n\nFlag user and third-party app access issues, including account misuse, sharing security, and users not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Confluence: Unknown or anonymous user with edit access to content | `d5ad6f5e-3e7a-4409-a9dc-9707caca047e` | Critical |\n| Confluence: Unknown or anonymous user with edit access to space | `a531c40f-76f5-404e-9c9b-3b21a6da7b98` | High |\n| Confluence: Third-party app with edit access to space | `aac0ac18-25ad-442a-9a24-01ecd85b0b2b` | Medium |\n| Confluence: Third-party app with edit access to content | `8214431e-b708-49c9-b28b-3214f1b491d8` | Medium |\n| Confluence: Unknown or anonymous user with access | `a1d0d098-2602-4312-85a8-a62d3bc56aca` | Low |\n| Confluence: Third-party app with content access | `5ccf7326-386d-4afb-867a-fbf25978c33a` | Low |\n\n</page>\n\n<page>\n---\ntitle: Atlassian Jira  Cloudflare One docs\ndescription: The Atlassian Jira integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Atlassian Jira Cloud account that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-jira/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-jira/index.md\n---\n\nThe Atlassian Jira integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Atlassian Jira Cloud account that could leave you and your organization vulnerable.\n\nNote\n\nAt this time, the CASB integration for Jira is only compatible with Jira Cloud accounts. Support for Jira Data Center will come at a future date.\n\n## Integration prerequisites\n\n* A Jira Cloud plan (Free, Standard, Premium, Enterprise)\n\n* Access to a Jira Cloud account with Site admin and/or Organization admin permissions\n\n## Integration permissions\n\nFor the Jira Cloud integration to function, Cloudflare CASB requires the following permissions via an OAuth 2.0 app:\n\n* `read:jira-work`\n* `read:jira-user`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Atlassian scopes documentation](https://developer.atlassian.com/cloud/jira/platform/scopes-for-oauth-2-3LO-and-forge-apps/).\n\n## Security findings\n\nThe Jira Cloud integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/atlassian-jira.mdx.atom).\n\n### Access security\n\nFlag user and third-party app access issues, including account misuse and users not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Jira: Active user with unknown account type | `8dfd390d-911e-47bb-9ded-cb75fd91e793` | Low |\n| Jira: Active third-party app with access | `01118135-a4ab-4b8f-887d-c814358da217` | Low |\n| Jira: Inactive third-party app with access | `36f7de49-2938-4a54-b212-b4da74145a58` | Low |\n| Jira: Inactive user | `1e1a085c-1ef3-4199-bea5-ff52ccbd6d2d` | Low |\n\n### File security\n\nIdentify files that could be potentially problematic and worth deeper investigation.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Jira: Issue attachment larger than 512 MB | `1e5473b7-588e-4954-b97d-a5a20b4f8c5a` | Medium |\n\n</page>\n\n<page>\n---\ntitle: Amazon Web Services (AWS) S3  Cloudflare One docs\ndescription: The Amazon Web Services (AWS) S3 integration detects a variety of\n  data loss prevention, account misconfiguration, and user security risks in an\n  integrated AWS account that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-27T15:01:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/aws-s3/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/aws-s3/index.md\n---\n\nThe Amazon Web Services (AWS) S3 integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated AWS account that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* An AWS account using AWS S3 (Simple Storage Service)\n* For initial setup, access to the AWS account with permission to create a new IAM Role with the scopes listed below.\n\n## Integration permissions\n\nFor the AWS S3 integration to function, Cloudflare CASB requires the following access scopes via an IAM Role with cross-account access:\n\n* `s3:PutBucketNotification`\n* `s3:GetObject`\n* `s3:ListBucket`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission scope, refer to the [AWS S3 Permissions documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-with-s3-policy-actions.html).\n\n## Compute account\n\nYou can connect an AWS compute account to your CASB integration to perform [Data Loss Prevention](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) scans within your S3 bucket and avoid data egress. CASB will scan any objects that exist in the bucket at the time of configuration.\n\n### Add a compute account\n\nTo connect a compute account to your AWS integration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Cloud & SaaS findings** > **Integrations**.\n2. Find and select your AWS integration.\n3. Select **Open connection instructions**.\n4. Follow the instructions provided to connect a new compute account.\n5. Select **Refresh**.\n\nYou can only connect one computer account to an integration. To remove a compute account, select **Manage compute accounts**.\n\n### Configure compute account scanning\n\nOnce your AWS compute account has successfully connected to your CASB integration, you can configure where and how to scan for sensitive data:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Cloud & SaaS integrations**.\n2. Find and select your AWS integration.\n3. Select **Create new configuration**.\n4. In **Resources**, choose the buckets you want to scan. Select **Continue**.\n5. Choose the file types, sampling percentage, and [DLP profiles](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) to scan for.\n6. (Optional) Configure additional settings, such as the limit of API calls over time for CASB to adhere to.\n7. Select **Continue**.\n8. Review the details of the scan, then select **Start scan**.\n\nCASB will take up to an hour to begin scanning. To view the scan results, go to **Cloud & SaaS findings** > **Content Findings**.\n\nTo manage your resources, go to **Integrations** > **Cloud & SaaS integrations**, then find and select your AWS integration. From here, you can pause all or individual scans, add or remove resources, and change scan settings.\n\nFor more information, refer to [Content findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#content-findings).\n\n## Security findings\n\nThe AWS S3 integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/aws-s3.mdx.atom).\n\n### S3 Bucket security\n\nFlag security issues in S3 Buckets, including overpermissioning, access policies, and user security best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| S3 Bucket ACL Allows Any Authenticated User to Write | `09bc7d1f-e682-43bc-a4ce-e6e03b408244` | Critical |\n| S3 Bucket ACL Allows Any Authenticated User to Write ACP | `9392a460-c566-4e0d-b06b-01d87dc84d7c` | Critical |\n| S3 Bucket ACL Allows Public ACP Write | `5b792c7f-2546-4fcd-96dc-a58a53fea7e0` | Critical |\n| S3 Bucket ACL Allows Public Write | `f50ae197-fa0a-4caa-be95-79aed91eed63` | Critical |\n| S3 Bucket Policy Allows Any Authenticated User to Write | `70fe0596-28bc-41dd-a2c3-1486fb0fb1dd` | Critical |\n| S3 Bucket Policy Allows Public Write | `5e2aac4b-d8be-43dc-b324-84fdf63f760e` | Critical |\n| S3 Bucket Publicly Accessible | `6b1276e3-88e8-4150-a4d5-1b8273f11078` | Critical |\n| S3 Bucket ACL Allows Any Authenticated User to Read | `fda31c4d-24dc-43d4-8a84-a1a9e1df01a1` | High |\n| S3 Bucket ACL Allows Any Authenticated User to Read ACP | `7232e46b-3539-4080-b905-022f1091556c` | High |\n| S3 Bucket ACL Allows Public ACP Read | `e324242c-5feb-41a3-8d91-f70611471fad` | High |\n| S3 Bucket ACL Allows Public Read | `f8c9f979-29f0-4ada-b09e-a149937a55d4` | High |\n| S3 Bucket Policy Allows Any Authenticated User to Read | `c6b3a745-b535-45ea-b2c0-ba8a139ca634` | High |\n| S3 Bucket Policy Allows Public Read | `f3915412-eef9-47d9-8448-e04462de8ba2` | High |\n| S3 Bucket Without MFA Delete Enabled | `f108bd28-9870-453f-a439-01818e85bdc7` | High |\n| S3 Bucket Without Server-Side Encryption (SSE) | `7817b383-79c3-44ca-8d5d-e01748afe75b` | High |\n| S3 Bucket Encryption in Transit Disabled | `0b3227dd-63d3-46bc-97b3-e62d9c11567a` | Medium |\n| S3 Bucket MFA Delete Disabled | `518697ff-3f7e-463e-acf3-79d106599f0e` | Medium |\n| S3 Bucket ACL Allows Public List | `e3c8a170-7817-4151-bd01-55442f4416ea` | Medium |\n| S3 Bucket Objects Can Be Public | `0ff170dc-be6b-46fa-a1cf-95ca7d067f4b` | Medium |\n| S3 Bucket Policy Allows Any Authenticated AWS User | `264be783-7fe1-4f50-aee7-d8df370b7b77` | Medium |\n| S3 Bucket Policy Allows Any Authenticated User to Delete | `4431eaeb-63e3-43c1-a4bc-029f09da66fd` | Medium |\n| S3 Bucket Policy Allows Any Authenticated User to List | `319c9715-b86d-4215-bdfa-c5d9b3a5cc83` | Medium |\n| S3 Bucket Policy Allows Public Delete | `bbbeacbc-6692-4121-a785-d634da1e5c56` | Medium |\n| S3 Bucket Policy Allows Public List | `f7ae03e3-1303-4404-b6f5-a7f97e52105e` | Medium |\n| S3 Bucket Server Side Encryption Disabled | `d69ab398-fba8-4e71-bf49-60af48d00cbc` | Medium |\n| S3 Bucket Without Access Logging | `67d0995d-7b4a-40c5-a43f-7a98d20faac6` | Medium |\n| S3 Bucket Without AWS CloudTrail Logging | `89366ebe-ca0b-45fc-a9cb-135674e0a49b` | Medium |\n| S3 Bucket Without Cross-Region Replication | `d4e5c815-33e3-4a01-b852-fe040d51ee55` | Medium |\n| S3 Bucket Without Default Encryption | `fb7a41af-294c-4e9b-a6ca-a1fed35542d6` | Medium |\n| S3 Bucket Without Lifecycle Policies | `2df6f1b8-e41c-4ab5-a466-992ce485a367` | Medium |\n| S3 Bucket Without Object-Level Logging | `9af2594c-3999-49c9-bd3d-2f4b091f99c0` | Medium |\n| S3 Bucket Without Replication Enabled | `cb61ef18-a498-456c-985c-78a45e19f4fe` | Medium |\n| S3 Bucket Without Versioning Enabled | `95e1284f-a514-4396-bf64-cd003818790c` | Medium |\n| S3 Bucket Access Logging Disabled | `84ba76fa-4703-490e-ab75-1b554993c054` | Low |\n| S3 Bucket Lifecycle Disabled | `970d2ca8-e189-42a8-8e86-9f674fcb1aea` | Low |\n| S3 Bucket Policy Not Existent | `3e1d0535-d82f-4ed1-9664-d2c50905db17` | Low |\n| S3 Bucket Versioning Disabled | `4e976e0d-b545-4c4a-99c5-a2f5d9a6f3d8` | Low |\n\n### IAM Policies\n\nIdentify AWS IAM-related security issues that could affect S3 Bucket and Object security.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| IAM Account Password Policy Does Not Exist | `e39ee4da-eed5-49d0-95f7-b423884b858c` | Critical |\n| IAM Account Password Policy Doesn't Require Lowercase Letters | `9278444b-0c38-4ed0-8127-f3f25444811c` | High |\n| IAM Account Password Policy Doesn't Require Passwords to Expire | `5be79a96-4570-45cf-8ba3-1abe62802d16` | High |\n| IAM Account Password Policy Doesn't Require Symbols | `dd17afa3-4d4c-49e4-84c3-e829af9fff97` | High |\n| IAM Account Password Policy Doesn't Require Uppercase Letters | `e4976e53-bab5-4276-a1d3-1d85ebfd4d57` | High |\n| IAM Account Password Policy Max Age is greater than 90 days | `4e1092a0-7092-405f-a991-537d8c371440` | High |\n| IAM Account Password Policy Minimum Length is less than 8 | `2a2fa181-7beb-48ba-bc8d-8f1170c6062c` | High |\n| IAM Account Password Policy Re-use Prevention is less than 5 | `a4791a20-373f-44d3-9f6e-e61f1685fe05` | High |\n| IAM Role with Cross-Account Access | `8de72710-b23a-4d94-915e-26ef7249d21e` | High |\n| IAM Access Key Inactive over 90 Days | `37d1adb1-8e37-4708-a849-e06945c60802` | Medium |\n| IAM Access Key Not Rotated over 90 Days | `d2caf571-4c99-4da7-a21c-4384f8cb4e5c` | Medium |\n| IAM User Console Login Inactive Over 90 Days | `82b50a4d-8582-4766-9bad-f41b441bf336` | Medium |\n| IAM User MFA Disabled | `4679563f-5975-4c68-9dbf-896810ec8de9` | Medium |\n| IAM User Password Older Than 90 Days | `c5376384-e4e4-4b2c-af84-12d6740939f0` | Medium |\n| IAM Account Password Policy Doesn't Require Numbers | `15c65813-c7e6-4b22-95b3-b3942c8b8924` | Low |\n\n### Root User Management\n\nDetect security issues related to the use of an IAM Root User, which has the ability to access and configure important settings.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| AWS Root User Access Key Used within Last 90 Days | `9d23c002-aece-42b5-b082-2b51fab8d7c1` | Critical |\n| AWS Root User has Access Keys | `1b788d31-ed56-4008-b136-6993f38e4d1c` | Critical |\n| AWS Root User Logged in within Last 90 Days | `e9959d6e-edc9-4ea3-9113-3c30b02a811e` | Critical |\n| AWS Root User MFA Disabled | `19abe0ee-e8bd-4e3b-9ee9-ea5c64fe769c` | Critical |\n\n### Certificates\n\nCatch certificate-related issues and risks to prevent malicious compromise of internal resources.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ACM Certificate Expired | `30ce0a22-eb3d-457d-bc59-6468f9bb4c4f` | Critical |\n| ACM Certificate Has Domain Wildcard | `d313bc0c-a2fb-41d8-b5a8-ef2704bb5570` | High |\n| ACM Certificate Expires within 30 days | `cd93f2c1-9b07-4e6c-964c-79f3a64d56ac` | Medium |\n\n</page>\n\n<page>\n---\ntitle: Bitbucket Cloud  Cloudflare One docs\ndescription: The Bitbucket Cloud integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Bitbucket Cloud Cloud account that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/bitbucket-cloud/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/bitbucket-cloud/index.md\n---\n\nThe Bitbucket Cloud integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Bitbucket Cloud Cloud account that could leave you and your organization vulnerable.\n\nNote\n\nCurrently, the CASB integration for Bitbucket is only compatible with Bitbucket Cloud accounts. Support for Bitbucket Data Center will come at a future date.\n\n## Integration prerequisites\n\n* A Bitbucket Cloud plan (Free, Standard, Premium, Enterprise)\n* Access to a Bitbucket Cloud account with Site admin and/or Organization admin permissions\n\n## Integration permissions\n\nFor the Bitbucket Cloud integration to function, Cloudflare CASB requires the following permission scopes via an OAuth 2.0 app:\n\n* `account`\n* `email`\n* `issue`\n* `pipeline`\n* `project`\n* `project:admin`\n* `pullrequest`\n* `repository`\n* `repository:admin`\n* `runner`\n* `snippet`\n* `webhook`\n* `wiki`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission scope, refer to the [Atlassian scopes documentation](https://developer.atlassian.com/cloud/bitbucket/rest/intro/#oauth-2-0).\n\n## Security findings\n\nThe Bitbucket Cloud integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/bitbucket-cloud.mdx.atom).\n\n### Repository security\n\nFlag repository issues, including branch protection, access, and update frequency.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Bitbucket Cloud: Repository is publicly accessible | `be273f0a-678e-49af-b9f8-8f3913acef97` | Critical |\n| Bitbucket Cloud: Repository Default Branch Protection does not have PR Review Required | `6ad95c13-0d13-4595-bc76-bd86f4eba4b9` | High |\n| Bitbucket Cloud: Repository has no Default Branch Protection | `324f2014-4d4b-4aa6-89a8-72a6c7da09d7` | Medium |\n| Bitbucket Cloud: Repository not updated in 12+ months | `a1bd3076-a68d-492e-9947-a01e15a4d1b3` | Medium |\n| Bitbucket Cloud: Repository Default Branch Protection does not disable direct pushes for all users/groups | `c60a7b00-1592-429a-8a32-d58101e4551f` | Medium |\n| Bitbucket Cloud: Repository Default Branch Protection does not have Stale PR Approvals Disabled | `738c9839-5e1e-4048-85a3-7935ec4c647a` | Medium |\n| Bitbucket Cloud: Repository Default Branch Protection does not have Force Pushes Disabled | `4c52f441-0c24-4dbd-8f5e-0e5b829ee8e2` | Medium |\n| Bitbucket Cloud: Repository Default Branch Protection does not require passing builds to merge | `afe4a27e-ee01-4ebe-914c-d480ac49a5c2` | Low |\n| Bitbucket Cloud: Repository Default Branch Protection allows branch deletion | `86411562-4b85-4677-b048-7887cc5b1567` | Low |\n| Bitbucket Cloud: Repository Default Branch Protection does not enforce merge checks | `64440d40-91de-4d13-9280-d5afa418ccf0` | Low |\n| Bitbucket Cloud: Key is older than 180 days | `0a135600-a109-434f-877c-1a6594dcd76d` | Low |\n\n</page>\n\n<page>\n---\ntitle: Dropbox  Cloudflare One docs\ndescription: The Dropbox integration detects a variety of data loss prevention,\n  account misconfiguration, and user security risks in an integrated Dropbox\n  account that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/dropbox/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/dropbox/index.md\n---\n\nThe Dropbox integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Dropbox account that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A Dropbox Business plan (Standard, Advanced, Enterprise, or Education)\n* Access to a Dropbox Business account with Team admin permissions\n\n## Integration permissions\n\nFor the Dropbox integration to function, Cloudflare CASB requires the following Dropbox permissions via an OAuth 2.0 app:\n\n* `account_info.read`\n* `files.metadata.read`\n* `files.content.read`\n* `sharing.read`\n* `team_info.read`\n* `team_data.member`\n* `team_data.governance.write`\n* `team_data.governance.read`\n* `files.team_metadata.read`\n* `members.read`\n* `groups.read`\n* `sessions.list`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Dropbox API Permissions documentation](https://developers.dropbox.com/oauth-guide#dropbox-api-permissions).\n\n## Security findings\n\nThe Dropbox integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/dropbox.mdx.atom).\n\n### File and folder sharing\n\nIdentify files and folders that have been shared in a potentially insecure fashion.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Dropbox: File publicly accessible with edit access | `7fefad57-371b-4f27-b1f0-7d500c863bd0` | Critical |\n| Dropbox: File shared company-wide with edit access | `265ed167-435c-4626-99ba-2fafd766c096` | High |\n| Dropbox: File publicly accessible with view access | `e8c057e4-d6ce-431b-9d03-d9aadff610d4` | High |\n| Dropbox: Shared link create policy set to default 'Public' | `0afabc9a-3a98-4a67-941a-d1f0ce0cfbfe` | High |\n| Dropbox: File shared company-wide with view access | `02a14d67-27fa-4621-a280-1a25925d506f` | Medium |\n| Dropbox: Folder shared company-wide with edit access | `ac4da5b9-ddb0-4285-ba52-2ba4de43b530` | Medium |\n| Dropbox: Shared folder policy set to default 'Anyone' | `5d479ad5-d0f1-4c8f-b439-a39b399fe6c5` | Medium |\n| Dropbox: Group creation policy set to 'Admins and Members' | `6f54b5eb-6867-490e-b823-08e91878eb40` | Medium |\n| Dropbox: Folder join policy set to 'Can join folders shared by Anyone' | `e5ffaecc-f61a-4019-a54f-2e5ac882d3f3` | Medium |\n| Dropbox: Folder member policy set to 'Can share folders with Anyone' | `99d4a2af-12ec-43a1-9630-27ac4adf625c` | Medium |\n| Dropbox: Shared link create policy set to default 'Team-wide' | `a3d02f04-4372-4ae3-99f9-e2caccee6e76` | Low |\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\n| Finding type | Severity | Description |\n| - | - | - |\n| File Publicly Accessible Read and Write with DLP Profile match | Critical | A Dropbox file contains sensitive data that anyone on the Internet can read or write. |\n| File Publicly Accessible Read Only with DLP Profile match | Critical | A Dropbox file contains sensitive data that anyone on the Internet can read. |\n| File Shared Company Wide Read and Write with DLP Profile match | Medium | A Dropbox file is shared with the entire company with read and write permissions. |\n| File Shared Company Wide Read Only with DLP Profile match | Medium | A Dropbox file is shared with the entire company with read permissions. |\n\n### Suspicious applications\n\nDetect when suspicious Dropbox applications are linked by members.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Dropbox: Suspicious application linked by member | `8384c58c-1fc2-4caa-9836-c8ede7ca440d` | High |\n\n### User access and account misconfigurations\n\nFlag user access issues, including users misusing accounts or not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Dropbox: Admin user with unverified secondary email | `cebb4104-1235-4049-a664-9fcd003ece71` | Medium |\n| Dropbox: Admin user with restricted directory access | `19378bb3-a3b7-4ee5-8ea7-39eec0a2ca7c` | Medium |\n| Dropbox: User with unverified email | `2b5804f7-4888-4872-a85a-a64805d10654` | Medium |\n| Dropbox: Invited user | `44d34aab-82fb-4a60-8e35-d7a75cfc789c` | Low |\n| Dropbox: Suspended user | `e356cfe6-97e6-4e30-9cb9-4a42a387844e` | Low |\n| Dropbox: User with secondary email configured | `4bbb795a-cd34-41ba-865d-9bf9de61a592` | Low |\n\n</page>\n\n<page>\n---\ntitle: Box  Cloudflare One docs\ndescription: The Box integration detects a variety of data loss prevention,\n  account misconfiguration, and user security risks in an integrated Box account\n  that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/box/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/box/index.md\n---\n\nThe Box integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Box account that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A Box account on a Business plan (Business, Business Plus, Enterprise, Enterprise Plus)\n\n* Access to a Box Business account with Admin permission\n\n## Integration permissions\n\nFor the Box integration to function, Cloudflare CASB requires the following Box permissions via an OAuth 2.0 app:\n\n* `Read all files and folders stored in Box`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about the permission, refer to the [Box Scopes documentation](https://developer.box.com/guides/api-calls/permissions-and-errors/scopes/#read-all-files-and-folders).\n\n## Security findings\n\nThe Box integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/box.mdx.atom).\n\n### File sharing\n\nIdentify files and folders that have been shared in a potentially insecure fashion.\n\nTo access some file findings, you may need to review shared links. For more information, refer to [View shared files](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#view-shared-files).\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Box: File publicly accessible with edit access | `fa0532dd-9d13-4c21-8227-62b8bd8be275` | Critical |\n| Box: File publicly accessible with high download count | `97c0845a-754b-4269-b548-85026867da64` | High |\n| Box: Folder publicly accessible with edit access | `154eabed-19a7-4a07-9dfd-d08f5e839aed` | High |\n| Box: File shared company-wide with edit access | `8df801de-327b-4d71-9f36-fc6f3e2c18da` | High |\n| Box: File publicly accessible with view access | `ecca7eeb-3c04-46b2-a509-40393ada32ec` | High |\n| Box: Folder shared company-wide with high download count | `21bed8a9-b587-4a8b-b38f-8c9492b1d132` | Medium |\n| Box: File publicly accessible with high view count | `540ab1db-5a9e-4968-b669-100e2b97fa85` | Medium |\n| Box: Folder that can be shared by anyone | `c56757c6-72e4-456c-8cb9-a5b0fd6ceb4a` | Medium |\n| Box: Folder shared company-wide with edit access | `61082e41-3205-44a0-bb7e-34c02abd5137` | Medium |\n| Box: File shared company-wide with view access | `5afdbe74-0311-4da8-a64e-6f25c3d4a2b7` | Medium |\n| Box: File shared company-wide with high download count | `3cd0d8dd-d92b-4a46-b88f-076a17e11837` | Medium |\n| Box: Folder publicly accessible with view access | `2e9d5774-3a22-4d45-9307-bb24207af3d7` | Medium |\n| Box: Folder shared company-wide with high view count | `fd303606-a513-4bb5-9a87-b1c836f6e993` | Low |\n| Box: File larger than 2 GB | `ef889ceb-4cad-4d25-8845-d350a599825e` | Low |\n| Box: Folder with external email upload access | `90f9b277-0846-4918-aac2-2e63fed576b5` | Low |\n| Box: Folder shared company-wide with view access | `1bb68e90-9c1d-44ef-91a9-2ed4eb2eb5b2` | Low |\n| Box: File shared company-wide with high view count | `22bf3a7b-1fd1-4eb6-b8f5-1b2e772b3484` | Low |\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\n| Finding type | Severity | Description |\n| - | - | - |\n| Box: File Publicly Accessible Read and Write with DLP Profile match | Critical | A Box file contains sensitive data that anyone on the Internet can read or write. |\n| Box: File Publicly Accessible Read Only with DLP Profile match | Critical | A Box file contains sensitive data that anyone on the Internet can read. |\n| Box: File Shared Company Wide Read and Write with DLP Profile match | Medium | A Box file is shared with the entire company with read and write permissions. |\n| Box: File Shared Company Wide Read Only with DLP Profile match | Medium | A Box file is shared with the entire company with read permissions. |\n\n### User access\n\nFlag user access issues, including account misuse and users not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Box: Admin not required to use two-factor authentication | `40f33ef2-3eab-4855-b171-a71463f8fc96` | High |\n| Box: User not required to use two-factor authentication | `a8f9e55a-cb7c-4e35-8dc0-fdf569919a97` | Medium |\n| Box: Inactive admin user | `e6b82aa9-7d0d-4c85-a582-a377684ace47` | Medium |\n| Box: User with unconfirmed notification email | `15b70c97-68f6-4ef0-afd1-891971162114` | Low |\n| Box: User with email alias configured | `085164ed-c555-40ed-9374-358a892e49ef` | Low |\n| Box: User allowed to collaborate with external users | `01ed4b90-c470-4ea1-961a-7e64c2fec525` | Low |\n| Box: Inactive user | `d709ccb3-9b9d-4a3c-a3af-a1def54c9a2e` | Low |\n\n### Account misconfigurations\n\nDiscover account and admin-level settings that have been configured in a potentially insecure way.\n\n| Finding type | Severity |\n| - | - |\n| Box: Active Webhook | Low |\n\n</page>\n\n<page>\n---\ntitle: Google Cloud Platform (GCP) Cloud Storage  Cloudflare One docs\ndescription: The Google Cloud Platform (GCP) Cloud Storage integration detects a\n  variety of data loss prevention, account misconfiguration, and user security\n  risks in an integrated GCP account that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-27T15:01:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/gcp-cloud-storage/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/gcp-cloud-storage/index.md\n---\n\nThe Google Cloud Platform (GCP) Cloud Storage integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated GCP account that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A GCP account using Cloud Storage.\n* For initial setup, access to the GCP account with permission to create a new Service Account with the scopes listed below.\n\n## Integration permissions\n\nFor the GCP Cloud Storage integration to function, Cloudflare CASB requires the following access scopes via a Service Account:\n\n* `roles/viewer`\n* `roles/storage.admin`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission scope, refer to the [GCP IAM roles for Cloud Storage documentation](https://cloud.google.com/storage/docs/access-control/iam-roles).\n\n## Compute account\n\nYou can connect a GCP compute account to your CASB integration to perform [Data Loss Prevention](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) scans within your Cloud Storage bucket and avoid data egress. CASB will scan any objects that exist in the bucket at the time of configuration.\n\n### Add a compute account\n\nTo connect a compute account to your GCP integration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Cloud & SaaS integrations**.\n2. Find and select your GCP integration.\n3. Select **Open connection instructions**.\n4. Follow the instructions provided to connect a new compute account.\n5. Select **Refresh**.\n\nYou can only connect one compute account to an integration. To remove a compute account, select **Manage compute accounts**.\n\n### Configure compute account scanning\n\nOnce your GCP compute account has successfully connected to your CASB integration, you can configure where and how to scan for sensitive data:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Cloud & SaaS integrations**.\n2. Find and select your GCP integration.\n3. Select **Create new configuration**.\n4. In **Resources**, choose the buckets you want to scan. Select **Continue**.\n5. Choose the file types, sampling percentage, and [DLP profiles](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) to scan for.\n6. (Optional) Configure additional settings, such as the limit of API calls over time for CASB to adhere to.\n7. Select **Continue**.\n8. Review the details of the scan, then select **Start scan**.\n\nCASB will take up to one hour to begin scanning. To view the scan results, go to **Cloud & SaaS findings** > **Content Findings**.\n\nTo manage your resources, go to **Cloud & SaaS findings** > **Integrations**, then find and select your GCP integration. From here, you can pause all or individual scans, add or remove resources, and change scan settings.\n\nFor more information, refer to [Content findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#content-findings).\n\n## Security findings\n\nThe GCP Cloud Storage integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/gcp-cloud-storage.mdx.atom).\n\n### Cloud Storage Bucket security\n\nFlag security issues in Cloud Storage Buckets, including overpermissioning, access policies, and user security best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Google Cloud Platform: GCS Bucket Allows Public Write | `4583f5a9-a343-4e2f-a8b3-9237a911f337` | Critical |\n| Google Cloud Platform: GCS Bucket IAM Policy Allows Public Access | `032c1e88-0cff-47f6-8d75-046e0a7330de` | Critical |\n| Google Cloud Platform: GCS Bucket Publicly Accessible | `cc028a95-46d4-4156-ac11-bc5713529824` | Critical |\n| Google Cloud Platform: Public Access Prevention Enabled But Policy Grants Public | `cc02680e-9cc3-49d1-99d5-29d425bf142f` | Critical |\n| Google Cloud Platform: GCS Bucket ACL Grants All Authenticated Users Access | `e1a588af-0500-482e-b59d-fd2693ce7fc0` | Critical |\n| Google Cloud Platform: GCS Bucket ACL Grants All Users Public Access | `1904c004-8d4f-470e-9460-e77db23d6a86` | Critical |\n| Google Cloud Platform: Public Access Prevention but ACL Grants allUsers | `fcf2e27e-673f-4cd2-9b76-ec89c4c5872c` | Critical |\n| Google Cloud Platform: GCS Bucket Versioning Disabled | `bd66e214-f205-4e00-bd68-121dad0a7988` | High |\n| Google Cloud Platform: GCS Bucket Without KMS Encryption | `0105d9c4-1a01-4b65-b33e-df6c55905147` | High |\n| Google Cloud Platform: GCS Uniform Bucket-Level Access Disabled | `6960b459-aa9e-4b41-84f6-26cdb75a1995` | High |\n| Google Cloud Platform: GCS Bucket IAM Policy Allows Public Read | `10420f34-8fdd-49cb-8d38-096a2de5824f` | High |\n| Google Cloud Platform: GCS Bucket Lacks Lifecycle Rules | `edcd5a8b-b128-404b-8207-23a80f669b65` | Medium |\n| Google Cloud Platform: GCS Bucket Logging Disabled | `d26f43c8-9406-481c-8c8b-1a7f05f3cc27` | Medium |\n| Google Cloud Platform: GCS Bucket Not Using 'Soft Delete' | `5542ed8e-77a6-43c1-8b9e-935e66009d34` | Medium |\n| Google Cloud Platform: GCS Bucket Retention Policy Disabled | `2d4a247c-8adb-4f2b-ae58-3568d633cb81` | Medium |\n| Google Cloud Platform: GCS Bucket IAM Policy Not Version 3 | `ade2ede6-08c7-4962-b084-f6a29ee4a5b8` | Low |\n| Google Cloud Platform: GCS Bucket IAM Policy Using Legacy Roles | `11a592b9-4f51-4a1a-9925-a48a5ed01521` | Low |\n\n</page>\n\n<page>\n---\ntitle: GitHub - CASB  Cloudflare One docs\ndescription: The GitHub integration detects a variety of data loss prevention,\n  account misconfiguration, and user security risks in an integrated GitHub\n  Organization that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/github/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/github/index.md\n---\n\nThe GitHub integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated GitHub Organization that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A GitHub account with a Free, Pro, or Enterprise plan\n* Membership to a GitHub Organization with Owner or GitHub App manager permissions\n\n## Integration permissions\n\nFor the GitHub integration to function, Cloudflare CASB requires the following GitHub API permissions:\n\n| Permission | Access | Description |\n| - | - | - |\n| Administration | `Read-only` | View basic administrative information from the account. |\n| Members | `Read-only` | View metadata on organization members |\n| Metadata | `Read-only` | View metadata surrounding an organization's assets, excluding sensitive private repository information. |\n| Organization administration | `Read-only` | View information on organization settings |\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [GitHub App permissions reference](https://docs.github.com/en/rest/overview/permissions-required-for-github-apps).\n\n## Security findings\n\nThe GitHub integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/github.mdx.atom).\n\n### Branches and merges\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| GitHub: Repository has no Default Branch Protection | `5a0428fa-5c13-44b8-a028-9351c1d10a91` | Medium | A repository's default branch does not have any branch protection rules enabled. |\n| GitHub: Repository Default Branch Protection does not have PR Review Required | `edd3f193-af01-421d-9a50-cb1d147bf3a6` | Medium | A repository's default branch does not have a **Require pull request reviews before merging** rule. |\n| GitHub: Repository Default Branch Protection does not have Force Pushes Disabled | `efc3e582-ef39-4316-b1f3-d4717ef30867` | Medium | A repository's default branch has enabled **Allow force pushes**. |\n| GitHub: Repository Default Branch Protection does not have Stale PR Approvals Disabled | `7dc170d7-b1ef-4138-95fb-403d16e7ed43` | Medium | A repository's default branch does not have a **Dismiss stale pull request approvals when new commits are pushed** rule. |\n| GitHub: Repository Default Branch Protection does not have Admin Restrictions | `4e4aec5b-e763-41ac-9099-af874606959b` | Medium | A repository's default branch does not have a **Do not allow bypassing the above settings** rule for administrators. |\n| GitHub: Repository Default Branch Protection does not have Status Checks | `1eba1aeb-9827-4a03-9c47-8290bd3a83d5` | Medium | A repository's default branch does not have a **Require status checks to pass before merging** rule. |\n| GitHub: Organization repository has default WRITE permission | `fc074da0-1e1c-4982-8673-0852d70bf80c` | Medium | A repository's default write protection settings were not changed. |\n| GitHub: Repository not updated in 12+ months | `68b6ef6d-7e00-4761-b3f1-fcf323dc9c26` | Medium | No changes were made to a repository in at least a year. |\n\nLearn more about [GitHub branch protection rules](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/managing-a-branch-protection-rule).\n\n### User accounts\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| GitHub: Organization two-factor authentication disabled | `47d01030-0ed8-496d-9484-f77899b21d59` | High | An organization does not have its organization-wide two-factor authentication (2FA) requirement enabled. |\n| GitHub: Organization user two-factor authentication disabled | `dfed92b2-a45e-46ed-a86b-8c7e3db01f3c` | High | A member of the organization does not have two-factor authentication (2FA) enabled. |\n\n</page>\n\n<page>\n---\ntitle: Google Workspace - CASB  Cloudflare One docs\ndescription: The Google Workspace integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Google Workspace account that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/index.md\n---\n\nThe Google Workspace integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Google Workspace account that could leave you and your organization vulnerable.\n\nThis integration covers the following Google Workspace products:\n\n* [Gemini for Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gemini/)\n* [Gmail](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gmail/)\n* [Google Admin](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-admin/)\n* [Google Calendar](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-calendar/)\n* [Google Drive](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-drive/)\n* [Gmail (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gmail-fedramp/)\n* [Google Admin (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-admin-fedramp/)\n* [Google Calendar (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-calendar-fedramp/)\n* [Google Drive (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-drive-fedramp/)\n\n## Integration prerequisites\n\n* A Google Workspace account with a Business Starter, Business Standard, Business Plus or Enterprise plan\n* A Google Workspace user with [Super Admin privileges](https://support.google.com/a/answer/2405986) and [Owner permissions](https://cloud.google.com/iam/docs/understanding-roles) in the Google Cloud Platform (GCP) project used\n\n## Integration permissions\n\nFor the Google Workspace integration to function, Cloudflare CASB requires the following Google API permissions:\n\n* `https://www.googleapis.com/auth/admin.directory.domain.readonly`\n* `https://www.googleapis.com/auth/admin.directory.user.readonly`\n* `https://www.googleapis.com/auth/admin.directory.user.security`\n* `https://www.googleapis.com/auth/calendar`\n* `https://www.googleapis.com/auth/cloud-platform.read-only`\n* `https://www.googleapis.com/auth/drive.readonly`\n* `https://www.googleapis.com/auth/gmail.settings.basic`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Google Workspace Admin SDK Directory API](https://developers.google.com/admin-sdk/directory/v1/guides/authorizing).\n\n## Security findings\n\nThe Google Workspace integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/google-workspace.mdx.atom).\n\n### User account settings\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Admin user with two-factor authentication disabled | `5f7c1f62-0ac6-4422-b3d3-d0566dd4e3f2` | Critical | An administrator in Google Workspace does not have two-factor authentication enabled. |\n| Google Workspace: User with two-factor authentication disabled | `739e1965-2ab4-4946-8a56-73fd75154efa` | High | A user in Google Workspace does not have two-factor authentication enabled. |\n| Google Workspace: Admin user with Gemini license with two-factor authentication disabled | `27a0a9a0-13c6-4d8f-a67c-b455dd213cb9` | High | An administrator with a Gemini for Google Workspace license does not have two-factor authentication enabled. |\n| Google Workspace: User with Gemini license with two-factor authentication disabled | `c82024dc-b836-4b86-8c90-ab07971474e4` | Medium | A user with a Gemini for Google Workspace license does not have two-factor authentication enabled. |\n| Google Workspace: User without recovery email | `2e2383bb-51e8-47fc-8ba7-2dd255c2545f` | Low | A user in Google Workspace does not have a recovery email set. |\n| Google Workspace: User without recovery phone number | `ec326c68-f331-4597-9ec4-43dc197c86f4` | Low | A user in Google Workspace does not have a recovery phone number set. |\n\n### Inactive or suspended users\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Inactive admin user | `391ee66d-10e0-4b26-91b3-741a2a4c39d0` | Medium | An administrator account in Google Workspace has not logged in for 30 days. |\n| Google Workspace: Suspended admin user | `31e02a11-aa3b-4278-97d3-9c0f7e8fd2c7` | Medium | An administrator account in Google Workspace is suspended. |\n| Google Workspace: Inactive user | `7c098546-2e67-4f01-9fb7-bd48412bd178` | Low | A user account in Google Workspace has not logged in for 30 days. |\n| Google Workspace: Suspended user | `84f514e3-f12d-49e5-bdfe-9073e336d89e` | Low | A user account in Google Workspace is suspended. |\n| Google Workspace: Admin user suspended with AI Ultra license | `ee7d4ed6-479f-404f-8dbd-f82dce2a0f66` | Low | An administrator account in Google Workspace with an AI Ultra (Gemini for Workspace) license is suspended. |\n| Google Workspace: User suspended with AI Ultra license | `cf20e808-29ad-4026-a8f9-6ec3e069376c` | Low | A user account in Google Workspace with an AI Ultra (Gemini for Workspace) license is suspended. |\n\n### Gemini licensing\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Admin user with AI Ultra license | `62fa682a-c2b5-4d5a-a086-8e60bed804d3` | Low | An administrator in Google Workspace is assigned an AI Ultra (Gemini for Workspace) license. |\n| Google Workspace: User with AI Ultra license | `5b847ed3-6c02-4963-a1ab-82a4aa2b6c64` | Low | A user in Google Workspace is assigned an AI Ultra (Gemini for Workspace) license. |\n\n### File sharing\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: File publicly accessible with edit access | `29b01269-025f-4249-b5c1-0b9ec39823e0` | Critical | A Google Drive file is publicly accessible on the Internet that anyone can read or write. |\n| Google Workspace: File publicly accessible with view access | `d5132bc7-4c41-4824-b879-3918bf7f6ee7` | High | A Google Drive file is publicly accessible on the Internet that anyone can read. |\n| Google Workspace: File shared outside company with edit access | `71ec135e-3d4c-4d35-a2b7-4fd1e5b65b99` | High | A Google Drive file is shared with another organization or outside party with read and write permissions. |\n| Google Workspace: File shared outside company with view access | `d4b231ad-9a8c-40d3-8654-5bd5bb86bf1a` | Medium | A Google Drive file is shared with another organization or outside party with read permissions. |\n| Google Workspace: File shared company-wide with edit access | `0ed79f27-32fd-415a-a919-ea4af3bd25fd` | Medium | A Google Drive file is shared with the entire company with read and write permissions. |\n| Google Workspace: File shared company-wide with view access | `a34753f3-aec7-4134-a30b-2ebb1d7e47de` | Medium | A Google Drive file is shared with the entire company with read permissions. |\n\n### Calendar sharing\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Calendar is publicly accessible | `ec68bf68-b0c0-47b3-ad48-fcb3d7eaf8b6` | Medium | A user's Google Calendar is publicly accessible on the Internet that anyone can read. |\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: File publicly accessible with edit access with DLP Profile match | `868a21e9-62b2-4e4a-8150-92cf9eb0c2e3` | Critical | A Google Drive file contains sensitive data that anyone on the Internet can read or write. |\n| Google Workspace: File publicly accessible with view access with DLP Profile match | `bfe54b22-5ee5-4ccc-b62b-ea822b34c164` | High | A Google Drive file contains sensitive data that anyone on the Internet can read. |\n| Google Workspace: File shared outside company with edit access with DLP Profile match | `124cfac5-12c6-4b55-8691-9c11776b365a` | High | A Google Drive file contains sensitive data that anyone the file is shared to can read. |\n| Google Workspace: File shared company-wide with edit access with DLP Profile match | `5b2ad0d2-f35f-47a3-96cb-6e8fbb1fcb36` | Medium | A Google Drive file contains sensitive data that anyone in your organization can read or write. |\n| Google Workspace: File shared company-wide with view access with DLP Profile match | `b9fa5fef-c1d0-44da-8364-2c0887be0820` | Medium | A Google Drive file contains sensitive data that anyone in your organization can read. |\n| Google Workspace: File shared outside company with view access with DLP Profile match | `aebdda6d-ab48-4408-9941-881683972d83` | Medium | A Google Drive file contains sensitive data that anyone the file is shared to can read. |\n\n### Third-party apps\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Installed 3rd-party app with Drive access | `191f0751-7087-4588-9e99-93c5dd834b5b` | High | A third-party application has been granted permissions to a user's Google Drive. |\n| Google Workspace: Installed 3rd-party app with Gmail access | `431aecad-20e5-4a20-80ba-4b66eaaa1be4` | High | A third-party application has been granted permissions to a user's Gmail. |\n| Google Workspace: Installed 3rd-party app with Google Docs access | `fe41d53b-3bc3-45ef-95d2-75ba159ce60d` | Medium | A third-party application has been granted permissions to a user's Google Documents. |\n| Google Workspace: Installed 3rd-party app with Google Calendar access | `80102f46-43d4-437e-b694-e8ee2c077ade` | Medium | A third-party application has been granted permissions to a user's Google Calendar. |\n| Google Workspace: Installed 3rd-party app with Google Slides access | `d88e106c-1f2e-4b63-acae-5cee19ded9ec` | Medium | A third-party application has been granted permissions to a user's Google Slides. |\n| Google Workspace: Installed 3rd-party app with Google Sheets access | `ece9a2fd-4248-4f11-bc45-8b4189eedb54` | Medium | A third-party application has been granted permissions to a user's Google Sheets. |\n| Google Workspace: Installed 3rd-party app with Google Sign In access | `26b938ea-8d24-4ea5-8e81-2eae26830061` | Low | A user has used their Google Workspace account to sign up for a third party service. |\n\n### Gmail administrator settings\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: Domain SPF record allows any IP address | `f28dcc8d-1f0c-4b5a-b254-4169095c16e5` | High | A Google Workspace Domain SPF record allows any email to be sent from any IP address on your behalf. |\n| Google Workspace: Domain SPF record not present | `2e13e5dd-88ed-4d65-8d0a-d3fdff9ee7bb` | Medium | An SPF record does not exist for a Google Workspace Domain. |\n| Google Workspace: Domain DMARC record not present | `ec39eabf-3536-4005-940b-22d815c628ec` | Medium | A DMARC record does not exist for a Google Workspace Domain. |\n| Google Workspace: Domain DMARC not enforced | `8971666d-c049-436d-b4d1-6816a70650ef` | Medium | A DMARC record for a Google Workspace Domain is not enforced. |\n| Google Workspace: Domain DMARC not enforced for subdomains | `fe485f42-b158-4187-85fe-79acdd92055b` | Medium | A DMARC record for a Google Workspace Subdomain is not configured to quarantine or reject messages that fail authentication. |\n| Google Workspace: Domain DMARC only partially enforced | `b682c603-9bc6-485e-be8c-a6e58a989407` | Medium | A DMARC record for a Google Workspace Domain is not configured to quarantine or reject messages that fail authentication. |\n\n### Email forwarding\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Google Workspace: User delegates email access | `66897c22-29a5-4f55-b39a-1bfcdd3c12c5` | High | A user has delegated access to their inbox to another party. Delegates can read, send, and delete messages on the user's behalf. |\n\n</page>\n\n<page>\n---\ntitle: OpenAI  Cloudflare One docs\ndescription: The OpenAI integration detects a variety of data loss prevention,\n  account misconfiguration, and user security risks in an integrated OpenAI\n  account that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/openai/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/openai/index.md\n---\n\nThe OpenAI integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated OpenAI account that could leave you and your organization vulnerable.\n\nThis integration covers the following OpenAI products:\n\n* ChatGPT Enterprise (Workspaces)\n* OpenAI Platform Projects (API keys)\n* GPTs (custom GPTs)\n\nNote\n\nBefore you begin, ensure that OpenAI has enabled ChatGPT Enterprise Compliance API access for your organization. You will need a Project API key issued for your organization, your Organization ID, and your Workspace ID. These are available in your [OpenAI Project API Keys](https://platform.openai.com/settings/organization/projects).\n\nIf Compliance API access is not yet turned on for your organization, refer to [Enable Compliance API access](#enable-combliane-api-access).\n\n## Integration prerequisites\n\n* An OpenAI organization with a ChatGPT Enterprise workspace\n* Organization-level admin privileges to create and manage Admin API keys\n* (Optional) A Project API key and the corresponding Project ID if you plan to include OpenAI Platform Projects in the scan scope\n\n### Enable Compliance API access\n\nCompliance API access is required to use the OpenAI CASB integration. To enable Compliance API access:\n\n1. Contact `support@openai.com` to request access to the Compliance API for your organization and for the API key you will use with Cloudflare CASB. In your request, include:\n\n   * The last four characters of the API key\n   * The name of the API key\n   * The name of the user who created the key\n   * The requested scope (`read`, `write`, or both)\n\n2. OpenAI will verify the key and grant the requested Compliance API scopes.\n\n3. After the scopes are granted, [add the OpenAI integration to CASB](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/#add-an-integration). When prompted, enter your Open AI Admin API key, Organization ID, and Workspace ID (available at `https://chatgpt.com/admin/settings`).\n\nFor more information, refer to the [OpenAI Help Center](https://help.openai.com/articles/9261474-compliance-api-for-enterprise-customers).\n\n## Integration permissions\n\nFor the OpenAI integration to function, Cloudflare CASB requires the following authorization via API keys:\n\n* `Admin API key (organization-level)`: Grants read-only access to organization/workspace metadata, GPTs, users, invites, and audit/compliance objects exposed by the ChatGPT Enterprise Compliance API.\n* (Optional) `Project API key (project-level)`: Grants read-only access to OpenAI Platform project metadata and keys.\n\nThese credentials follow the principle of least privilege so that only the minimum required access is granted.\n\n## Security findings\n\nThe OpenAI integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/openai.mdx.atom).\n\n### Model and tool governance\n\nFlag risky tool and capability settings on custom GPTs.\n\n| Finding type | FindingTypeID | Severity | ChatGPT Enterprise required |\n| - | - | - | - |\n| OpenAI: GPT with Custom Actions enabled | `5a2995f5-0cc1-4af3-9045-cdf7e6601f7b` | High |  |\n| OpenAI: GPT with Code Interpreter enabled | `d368036a-be90-49f0-b7da-5092a3f8beb4` | Medium |  |\n| OpenAI: GPT with web browsing enabled | `3af14358-5ff2-4502-921e-7ffd9a310093` | Medium |  |\n\n### Publishing and sharing\n\nIdentify GPTs that are externally visible beyond your organization.\n\n| Finding type | FindingTypeID | Severity | ChatGPT Enterprise required |\n| - | - | - | - |\n| OpenAI: GPT publicly accessible via GPT Store | `c69adfa6-2362-4939-86ec-49ff34093cfd` | High |  |\n| OpenAI: GPT publicly accessible via public link | `de460c9f-55c0-4131-9cdf-e4c3b84f9549` | High |  |\n\n### API key hygiene\n\nDetect API keys that may be stale, unused, or overdue for rotation.\n\n| Finding type | FindingTypeID | Severity | ChatGPT Enterprise required |\n| - | - | - | - |\n| OpenAI: Admin API key not rotated | `b72e971d-f5b9-4cf3-96f4-ef82bdf38453` | High |  |\n| OpenAI: Project API key not rotated | `2c079fe8-6188-43e1-a2e5-d0e2dd8c7686` | High |  |\n| OpenAI: Unused admin API key | `49c75a36-1e64-437b-98a1-e54ec35d0a64` | Medium |  |\n| OpenAI: Unused project API key | `c8fd231b-de51-43cc-8c3f-e1e57114c5f5` | Medium |  |\n\n### Access security\n\nFlag user/invite issues to help enforce best practices.\n\n| Finding type | FindingTypeID | Severity | ChatGPT Enterprise required |\n| - | - | - | - |\n| OpenAI: High-privilege invite | `776ceb93-fa9a-4ca0-83db-668a67c09936` | High |  |\n| OpenAI: Inactive user | `20ab9ddb-fd48-46a8-9fdf-9bb9b9061f21` | Medium |  |\n| OpenAI: Stale pending invite | `18fd5b21-8489-485e-9c93-0bd4a696e724` | Low |  |\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\n| Finding type | FindingTypeID | Severity | ChatGPT Enterprise required |\n| - | - | - | - |\n| OpenAI: File in ChatGPT Conversation with DLP Profile match | `9aca654d-b331-4052-a5b4-2ceecced8676` | High |  |\n| OpenAI: File in ChatGPT GPT with DLP Profile match | `520200f5-7dcc-42c9-bc3c-423019159d45` | High |  |\n| OpenAI: File in ChatGPT Project with DLP Profile match | `8e46ec69-e5c1-4f53-ab00-a92f2050ec33` | High |  |\n\n</page>\n\n<page>\n---\ntitle: Microsoft 365  Cloudflare One docs\ndescription: The Microsoft 365 (M365) integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Microsoft 365 account that could leave you and your organization vulnerable.\nlastUpdated: 2025-11-13T15:48:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/index.md\n---\n\nThe Microsoft 365 (M365) integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Microsoft 365 account that could leave you and your organization vulnerable.\n\nThis integration covers the following Microsoft 365 products:\n\n* [Admin Center](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/admin-center/)\n* [OneDrive](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/onedrive/)\n* [Outlook](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/outlook/)\n* [SharePoint](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/sharepoint/)\n* [Admin Center (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/admin-center-fedramp/)\n* [OneDrive (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/onedrive-fedramp/)\n* [Outlook (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/outlook-fedramp/)\n* [SharePoint (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/sharepoint-fedramp/)\n\n## Integration prerequisites\n\n* A Microsoft 365 account with an active Microsoft Business Basic, Microsoft Business Standard, Microsoft 365 E3, Microsoft 365 E5, or Microsoft 365 F3 subscription\n* [Global admin role](https://docs.microsoft.com/en-us/microsoft-365/admin/add-users/about-admin-roles?view=o365-worldwide#commonly-used-microsoft-365-admin-center-roles) or equivalent permissions in Microsoft 365\n\n## Integration permissions\n\nFor the Microsoft 365 integration to function, Cloudflare CASB requires the following delegated Microsoft Graph API permissions:\n\n* `Application.Read.All`\n* `Calendars.Read`\n* `Domain.Read.All`\n* `Group.Read.All`\n* `InformationProtectionPolicy.Read.All`\n* `MailboxSettings.Read`\n* `offline_access`\n* `RoleManagement.Read.All`\n* `User.Read.All`\n* `UserAuthenticationMethod.Read.All`\n* `Files.Read.All`\n* `AuditLog.Read.All`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted.\n\nAdditionally, to [remediate findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#remediate-findings), CASB requires the following permissions:\n\n* `Application.ReadWrite.All`\n* `AuditLog.Read.All`\n* `Calendars.ReadWrite`\n* `Domain.ReadWrite.All`\n* `Files.ReadWrite.All`\n* `Group.ReadWrite.All`\n* `InformationProtectionPolicy.Read.All`\n* `MailboxSettings.ReadWrite`\n* `IdentityRiskyUser.ReadWrite.All`\n* `RoleManagement.ReadWrite.Directory`\n* `User.ReadWrite.All`\n* `UserAuthenticationMethod.ReadWrite.All`\n* `Directory.ReadWrite.All`\n* `GroupMember.ReadWrite.All`\n* `Organization.ReadWrite.All`\n* `Mail.ReadWrite`\n\nTo learn more about each permission, refer to the [Microsoft Graph permissions documentation](https://docs.microsoft.com/en-us/graph/permissions-reference).\n\n## Security findings\n\nThe Microsoft 365 integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/microsoft-365.mdx.atom).\n\n### User account settings\n\nKeep user accounts safe by ensuring the following settings are maintained. Review password configurations and password strengths to ensure alignment to your organization's security policies and best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: FIDO2 authentication method unattested | `5a9fd288-c04f-4f7a-8976-bfd5464c6cf1` | Low |\n| Microsoft: Provisioning error for on-prem user | `3123d99e-a83c-4d9d-9a10-80da5af6dee5` | Low |\n| Microsoft: Password expiration disabled for user | `ce8cc363-7cbb-445e-8385-79ae7348e430` | Low |\n| Microsoft: Password not changed for 90+ days | `93be1fd1-b6c6-4b98-a04c-121d5ea66745` | Low |\n| Microsoft: Strong password disabled for user | `aecfdcb2-ec1f-4571-be3c-4ae46c93125e` | Low |\n| Microsoft: Cloud sync disabled for on-prem user | `8370628b-73f1-41a5-bbff-4d5adee7bf33` | Low |\n| Microsoft: Weak Windows Hello for Business key strength | `6fae390f-07a3-4577-9821-034a7b29e18e` | Low |\n| Microsoft: On-prem user not synced in 7+ days | `1eefc5a1-e665-431a-b939-cfbb76a309f5` | Low |\n| Microsoft: User is not a legal adult | `329030a3-db43-4959-9d92-2616a42f1731` | Low |\n| Microsoft: User configured proxy addresses | `61406f68-feea-43c5-bda8-b7c4ef9b83cf` | Low |\n| Microsoft: User account disabled | `0a8bd094-9138-4e7f-8ce8-bebdf5c27c4e` | Low |\n| Microsoft: Reusable temporary access pass | `98571e6b-c323-48bc-8c60-f0425c7f9342` | Low |\n| Microsoft: Long-lived temporary access pass | `45cdbd9c-1594-488b-973e-7c62c6e7234e` | Low |\n\n### File sharing\n\nGet alerted when files in your Microsoft 365 account have their permissions changed to a less secure setting. Additionally, you can automatically remediate certain finding types directly from CASB. For more information, refer to [Remediate findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#remediate-findings).\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: File publicly accessible with edit access | `85241e6b-205f-4de6-a1d1-325656130995` | Critical |\n| Microsoft: Folder publicly accessible with edit access | `c9662c5c-c3d6-453b-9367-281e024f7e7a` | Critical |\n| Microsoft: File publicly accessible with view access | `a2b40dc9-b96a-4ace-b8f8-739c2be37dbd` | High |\n| Microsoft: Folder publicly accessible with view access | `7c673785-8b70-41bc-b7d4-d0f346487ff6` | High |\n| Microsoft: File shared company-wide with edit access | `a81a79c8-a0bf-4c60-aa46-7547b4d34266` | Medium |\n| Microsoft: File shared company-wide with view access | `364c9c0e-684b-4a83-bf28-fdbb1430bb59` | Medium |\n| Microsoft: Folder shared company-wide with edit access | `80f73d47-7dcf-4997-8ed3-6564c8388bd1` | Medium |\n| Microsoft: Folder shared company-wide with view access | `f3fc8ae6-815e-4d5f-a57e-b00d5413f98c` | Medium |\n\nTo access some file findings, you may need to review shared links. For more information, refer to [View shared files](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#view-shared-files).\n\n### Data Loss Prevention (optional)\n\nThese findings will only appear if you [added DLP profiles](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/) to your CASB integration.\n\nAdditionally, you can automatically remediate certain finding types directly from CASB. For more information, refer to [Remediate findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#remediate-findings).\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: File publicly accessible with edit access with DLP Profile match | `7b6ecb52-852f-4184-bf19-175fe59202b7` | Critical |\n| Microsoft: File publicly accessible with view access with DLP Profile match | `8150f237-576d-4b48-8839-0c257f612171` | High |\n| Microsoft: File shared company-wide with edit access with DLP Profile match | `f838ec6b-7d7a-4c1c-9c61-958ac24c27fa` | Medium |\n| Microsoft: File shared company-wide with view access with DLP Profile match | `0b882cf3-7e33-4c58-b425-0202206a2c10` | Medium |\n\n### Third-party apps\n\nIdentify and get alerted about the third-party apps that have access to at least one service in your Microsoft 365 domain. Additionally, receive information about which services are being accessed and by whom to get full visibility into [shadow IT](https://www.cloudflare.com/learning/access-management/what-is-shadow-it/).\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: App not certified by Microsoft | `3f049bb1-3709-4d8f-8591-59dd034cf396` | Low |\n| Microsoft: App not attested by publisher | `d7390d6b-f466-4293-8528-6218e29b1179` | Low |\n| Microsoft: App disabled by Microsoft | `b5156b76-caaa-4ca8-bdb7-ea282da62356` | Low |\n\n### Calendar sharing\n\nGet alerted when calendars in your Microsoft 365 account have their permissions changed to a less secure setting.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: Calendar shared externally | `7d2d9b00-3871-4abf-9e65-f29cf00c428b` | Low |\n\n### Email administrator settings\n\nDiscover suspicious or insecure email configurations in your Microsoft domain. Missing SPF and DMARC records make it easier for bad actors to spoof email, while SPF records configured to another domain can be a potential warning sign of malicious activity.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: Domain SPF record allows any IP address | `27893e48-663e-43f9-83d4-c158c50259d0` | High |\n| Microsoft: Domain SPF record not present | `009093d9-43df-45a2-bdc6-2f35fc3a0c71` | Medium |\n| Microsoft: Domain DMARC record not present | `bb3d3760-2c4e-4161-9164-cff92e809f9c` | Medium |\n| Microsoft: Domain DMARC not enforced | `a020d87d-332b-49d1-acc3-16c19d72fba4` | Medium |\n| Microsoft: Domain DMARC not enforced for subdomains | `1837a549-4d4e-4101-917c-e9a4036e0c08` | Medium |\n| Microsoft: Domain DMARC only partially enforced | `943414ed-7c79-4d17-a253-8d73f34dcc1d` | Medium |\n| Microsoft: Domain not verified | `dd1e9aba-57ee-4cf1-a895-dd2f1fc166a7` | Medium |\n| Microsoft: App certification expires within 90 Days | `d5ede282-0339-4983-88f3-849ac59ba840` | Low |\n\n### Email forwarding\n\nGet alerted when users set their email to be forwarded externally. This can either be a sign of unauthorized activity, or an employee unknowingly sending potentially sensitive information to a personal email.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Microsoft: Active message rule forwards externally as attachment | `9efca21a-aba2-452f-bb17-e66d34b58765` | Low |\n| Microsoft: Active message rule forwards externally | `42fa3fe6-da72-4bf0-9bc9-5faa4a118ec4` | Low |\n| Microsoft: Active message rule redirects externally | `b75ba81e-c98d-4b78-b5a1-47a2f54499e8` | Low |\n\n## Microsoft Information Protection (MIP) sensitivity labels\n\nNote\n\nRequires [Cloudflare Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/).\n\nMicrosoft provides [MIP sensitivity labels](https://learn.microsoft.com/en-us/microsoft-365/compliance/sensitivity-labels?view=o365-worldwide) to classify and protect sensitive data. When you add the CASB Microsoft 365 integration, Cloudflare will automatically retrieve the labels from your Microsoft account and populate them in a [DLP Profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/integration-profiles/).\n\nWarning\n\nDLP does not filter or log [MIP sublabels](https://learn.microsoft.com/purview/sensitivity-labels#sublabels-that-use-parent-labels-or-label-groups). Only top-level sensitivity labels will be detected, filtered, and logged.\n\nTo ensure DLP will detect and filter all sensitive data, use only [MIP top-level labels](https://learn.microsoft.com/purview/sensitivity-labels#top-level-labels).\n\n</page>\n\n<page>\n---\ntitle: Salesforce - CASB  Cloudflare One docs\ndescription: The Salesforce integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  Salesforce environment that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce/index.md\n---\n\nThe Salesforce integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Salesforce environment that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A Salesforce environment (most editions are compatible)\n\n* Permissions to a Salesforce organization with either:\n\n  * System Administrator permission\n  * Permissions for View Setup and Configuration, Customize Applications, and Modify All Data\n\n## Integration permissions\n\nFor the Salesforce integration to function, Cloudflare CASB requires the following Salesforce permissions via a Connected App:\n\n* `Manage user data via APIs (api)`\n* `Manage user data via Web browsers (web)`\n* `Perform requests at any time (refresh_token, offline_access)`\n* `Access unique user identifiers (openid)`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Salesforce OAuth Tokens and Scopes documentation](https://help.salesforce.com/s/articleView?id=sf.remoteaccess_oauth_tokens_scopes.htm).\n\n## Security findings\n\nThe Salesforce integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/salesforce.mdx.atom).\n\n### File sharing\n\nIdentify uploaded content, files, and attachments that have been shared in a potentially insecure fashion.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce: Content Document publicly accessible without a password | `4cde56ed-19db-4cdb-a6c6-3aede5e17785` | Critical |\n| Salesforce: Content Document publicly accessible with weak password | `68c43ab8-733d-4798-b25f-202f6fcf435f` | High |\n| Salesforce: Content Document publicly accessible and password protected | `75194f6b-5a95-48fa-b485-37181d2d19c8` | Medium |\n| Salesforce: Content Document shared and not viewed in 12+ months (stale permission) | `7125e209-234a-4f10-89d2-1af0601c277f` | Medium |\n| Salesforce: Content Document larger than 2 GB | `3d21de13-4b9f-483c-921a-44cdef7a58c5` | Medium |\n\n### Account misconfigurations\n\nDiscover account and admin-level settings that have been configured in an insecure way.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce: Domain without HTTPS | `20916e32-442e-4622-9e54-e1f37eb7d79f` | High |\n| Salesforce: Default Account record access allows edit | `316f1d9a-447e-432c-add7-7adde67c4f19` | Medium |\n| Salesforce: Default Case record access allows edit | `a7c8eb3e-b5be-4bfc-969a-358186bf927a` | Medium |\n| Salesforce: Default Contact record access allows edit | `e7be14f0-24d6-4d6c-9e12-ca3f23d34ba9` | Medium |\n| Salesforce: Default Lead record access allows edit | `12fde974-45e8-4449-8bf4-dc319370d5ca` | Medium |\n| Salesforce: Default Opportunity record access allows edit | `2ab78d14-e804-4334-9d46-213d8798dd2a` | Medium |\n| Salesforce: Organization with active compliance BCC email | `43e5fd20-1cba-4f1d-aa39-90c7ce2e088a` | Low |\n\n### User access\n\nFlag user access issues, including account misuse and users not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce: User sending email with different email address | `a2790c4f-03f5-449f-b209-5f4447f417af` | Medium |\n| Salesforce: Inactive user | `57e44995-c7ad-46fe-9c55-59706e663adf` | Low |\n| Salesforce: User has never logged in | `a0bf74df-c796-4574-ac1c-0f239ea8c9ac` | Low |\n| Salesforce: User has not logged in for 90+ days | `8395c824-bc44-4c12-b300-40f2477384d4` | Low |\n\n</page>\n\n<page>\n---\ntitle: Salesforce (FedRAMP) - CASB  Cloudflare One docs\ndescription: The Salesforce (FedRAMP) integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  FedRAMP-compliant Salesforce environment that could leave you and your\n  organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce-fedramp/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce-fedramp/index.md\n---\n\nAvailability\n\nThe Salesforce (FedRAMP) CASB integration requires a special entitlement on your account. To request access, contact your account team.\n\nThe Salesforce (FedRAMP) integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated FedRAMP-compliant Salesforce environment that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A FedRAMP-compliant Salesforce environment (most editions are compatible)\n\n* Permissions to a Salesforce organization with either:\n\n  * System Administrator permission\n  * Permissions for View Setup and Configuration, Customize Applications, and Modify All Data\n\n## Integration permissions\n\nFor the Salesforce (FedRAMP) integration to function, Cloudflare CASB requires the following Salesforce permissions via a Connected App:\n\n* `Manage user data via APIs (api)`\n* `Manage user data via Web browsers (web)`\n* `Perform requests at any time (refresh_token, offline_access)`\n* `Access unique user identifiers (openid)`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Salesforce OAuth Tokens and Scopes documentation](https://help.salesforce.com/s/articleView?id=sf.remoteaccess_oauth_tokens_scopes.htm).\n\n## Security findings\n\nThe Salesforce (FedRAMP) integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/salesforce-fedramp.mdx.atom).\n\n### File sharing\n\nIdentify uploaded content, files, and attachments that have been shared in a potentially insecure fashion.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce (FedRAMP): Content Document publicly accessible without a password | `4cde56ed-19db-4cdb-a6c6-3aede5e17785` | Critical |\n| Salesforce (FedRAMP): Content Document publicly accessible with weak password | `68c43ab8-733d-4798-b25f-202f6fcf435f` | High |\n| Salesforce (FedRAMP): Content Document publicly accessible and password protected | `75194f6b-5a95-48fa-b485-37181d2d19c8` | Medium |\n| Salesforce (FedRAMP): Content Document shared and not viewed in 12+ months (stale permission) | `7125e209-234a-4f10-89d2-1af0601c277f` | Medium |\n| Salesforce (FedRAMP): Content Document larger than 2 GB | `3d21de13-4b9f-483c-921a-44cdef7a58c5` | Medium |\n\n### Account misconfigurations\n\nDiscover account and admin-level settings that have been configured in an insecure way.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce (FedRAMP): Domain without HTTPS | `20916e32-442e-4622-9e54-e1f37eb7d79f` | High |\n| Salesforce (FedRAMP): Default Account record access allows edit | `316f1d9a-447e-432c-add7-7adde67c4f19` | Medium |\n| Salesforce (FedRAMP): Default Case record access allows edit | `a7c8eb3e-b5be-4bfc-969a-358186bf927a` | Medium |\n| Salesforce (FedRAMP): Default Contact record access allows edit | `e7be14f0-24d6-4d6c-9e12-ca3f23d34ba9` | Medium |\n| Salesforce (FedRAMP): Default Lead record access allows edit | `12fde974-45e8-4449-8bf4-dc319370d5ca` | Medium |\n| Salesforce (FedRAMP): Default Opportunity record access allows edit | `2ab78d14-e804-4334-9d46-213d8798dd2a` | Medium |\n| Salesforce (FedRAMP): Organization with active compliance BCC email | `43e5fd20-1cba-4f1d-aa39-90c7ce2e088a` | Low |\n\n### User access\n\nFlag user access issues, including account misuse and users not following best practices.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| Salesforce (FedRAMP): User sending email with different email address | `a2790c4f-03f5-449f-b209-5f4447f417af` | Medium |\n| Salesforce (FedRAMP): Inactive user | `57e44995-c7ad-46fe-9c55-59706e663adf` | Low |\n| Salesforce (FedRAMP): User has never logged in | `a0bf74df-c796-4574-ac1c-0f239ea8c9ac` | Low |\n| Salesforce (FedRAMP): User has not logged in for 90+ days | `8395c824-bc44-4c12-b300-40f2477384d4` | Low |\n\n</page>\n\n<page>\n---\ntitle: ServiceNow  Cloudflare One docs\ndescription: The ServiceNow integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  ServiceNow instance that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow/index.md\n---\n\nThe ServiceNow integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated ServiceNow instance that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* `admin` access to a ServiceNow instance\n* Ability to [create an OAuth API endpoint for external clients](https://docs.servicenow.com/csh?topicname=t_CreateEndpointforExternalClients)\n\n## Integration permissions\n\nFor the ServiceNow integration to function, Cloudflare CASB requires the following permissions:\n\n* `Global` application scope\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [ServiceNow Application scope documentation](https://docs.servicenow.com/bundle/utah-application-development/page/build/applications/concept/c_GlobalScope.html).\n\n## Security findings\n\nThe ServiceNow integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/servicenow.mdx.atom).\n\n### Instance security\n\nIdentify security risks related to the ServiceNow instance itself.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Production instance with exposed admin credentials | `6c75c56f-df42-454d-85ee-c919bba70191` | Critical |\n| ServiceNow: Production instance with exposed database user credentials | `37652a12-93d3-453f-961b-de32f419ed33` | High |\n| ServiceNow: Instance with exposed admin credentials | `8235e0a2-6a53-4596-adff-632203c60ab2` | High |\n| ServiceNow: Instance with exposed database user credentials | `4f8bf0e4-fa79-44fc-b171-84926cbc73c7` | Medium |\n\n### User security\n\nFlag user-related security risks and misconfigurations.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: User with pending password reset | `42097604-73db-46b3-9a5c-c3e0d2629531` | High |\n| ServiceNow: User with 3+ failed login attempts | `49079a4b-5280-4c9c-bf61-a45b53c2fd9f` | Medium |\n| ServiceNow: User with locked account | `344f5a37-7df5-4a26-a0fe-4d3c4215df61` | Low |\n| ServiceNow: User without multi-factor authentication enabled | `4efbe128-608d-4b19-b7c8-10c312e4cd9f` | Low |\n| ServiceNow: User with no assigned roles | `8b5ca10d-951c-46d8-b786-223756b39165` | Low |\n| ServiceNow: Inactive user | `a3ee8ec7-85de-480c-bd98-6bc9581bacf9` | Low |\n| ServiceNow: User with no recent activity | `2477faf4-1887-44bc-b663-94373afb03d7` | Low |\n\n### Incident management\n\nIdentify issues related to ServiceNow incidents.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: High priority incident with no assigned user | `8bd04e4e-4f2f-4b44-9c6c-df6341822521` | High |\n| ServiceNow: Incident with no assigned user | `0ea6e2dc-4748-436f-9407-bf24997ae574` | Medium |\n\n### Knowledge management\n\nHighlight potential misconfigurations in ServiceNow knowledge articles.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Knowledge article without expiration date | `0bd59519-a5ec-4327-92ec-c74f26184a5c` | Low |\n| ServiceNow: Knowledge article without any roles | `3caf029c-9840-43e4-a024-6d4af9f3d57e` | Low |\n| ServiceNow: Knowledge article with flagged status | `12bd46d5-e627-4bba-8644-59e01cca6646` | Low |\n\n### Integration and access\n\nDetect issues related to ServiceNow integrations and access controls.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Internal Integration user | `fa63799a-24ce-4f5f-8e88-09dbf87a6fb9` | Low |\n| ServiceNow: Web Service Access only user | `3523fbb4-8725-4ffc-b200-9aef44bbbe98` | Low |\n\n</page>\n\n<page>\n---\ntitle: ServiceNow (FedRAMP)  Cloudflare One docs\ndescription: The ServiceNow (FedRAMP) integration detects a variety of data loss\n  prevention, account misconfiguration, and user security risks in an integrated\n  ServiceNow (FedRAMP) instance that could leave you and your organization\n  vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow-fedramp/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow-fedramp/index.md\n---\n\nAvailability\n\nThe ServiceNow (FedRAMP) CASB integration requires a special entitlement on your account. To request access, contact your account team.\n\nThe ServiceNow (FedRAMP) integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated ServiceNow (FedRAMP) instance that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* `admin` access to a ServiceNow (FedRAMP) instance\n* Ability to [create an OAuth API endpoint for external clients](https://docs.servicenow.com/csh?topicname=t_CreateEndpointforExternalClients)\n\n## Integration permissions\n\nFor the ServiceNow (FedRAMP) integration to function, Cloudflare CASB requires the following permissions:\n\n* `Global` application scope\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [ServiceNow Application scope documentation](https://docs.servicenow.com/bundle/utah-application-development/page/build/applications/concept/c_GlobalScope.html).\n\n## Security findings\n\nThe ServiceNow (FedRAMP) integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/servicenow-fedramp.mdx.atom).\n\n### Instance security\n\nIdentify security risks related to the ServiceNow instance itself.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Production instance with exposed admin credentials | `6c75c56f-df42-454d-85ee-c919bba70191` | Critical |\n| ServiceNow: Production instance with exposed database user credentials | `37652a12-93d3-453f-961b-de32f419ed33` | High |\n| ServiceNow: Instance with exposed admin credentials | `8235e0a2-6a53-4596-adff-632203c60ab2` | High |\n| ServiceNow: Instance with exposed database user credentials | `4f8bf0e4-fa79-44fc-b171-84926cbc73c7` | Medium |\n\n### User security\n\nFlag user-related security risks and misconfigurations.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: User with pending password reset | `42097604-73db-46b3-9a5c-c3e0d2629531` | High |\n| ServiceNow: User with 3+ failed login attempts | `49079a4b-5280-4c9c-bf61-a45b53c2fd9f` | Medium |\n| ServiceNow: User with locked account | `344f5a37-7df5-4a26-a0fe-4d3c4215df61` | Low |\n| ServiceNow: User without multi-factor authentication enabled | `4efbe128-608d-4b19-b7c8-10c312e4cd9f` | Low |\n| ServiceNow: User with no assigned roles | `8b5ca10d-951c-46d8-b786-223756b39165` | Low |\n| ServiceNow: Inactive user | `a3ee8ec7-85de-480c-bd98-6bc9581bacf9` | Low |\n| ServiceNow: User with no recent activity | `2477faf4-1887-44bc-b663-94373afb03d7` | Low |\n\n### Incident management\n\nIdentify issues related to ServiceNow incidents.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: High priority incident with no assigned user | `8bd04e4e-4f2f-4b44-9c6c-df6341822521` | High |\n| ServiceNow: Incident with no assigned user | `0ea6e2dc-4748-436f-9407-bf24997ae574` | Medium |\n\n### Knowledge management\n\nHighlight potential misconfigurations in ServiceNow knowledge articles.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Knowledge article without expiration date | `0bd59519-a5ec-4327-92ec-c74f26184a5c` | Low |\n| ServiceNow: Knowledge article without any roles | `3caf029c-9840-43e4-a024-6d4af9f3d57e` | Low |\n| ServiceNow: Knowledge article with flagged status | `12bd46d5-e627-4bba-8644-59e01cca6646` | Low |\n\n### Integration and access\n\nDetect issues related to ServiceNow integrations and access controls.\n\n| Finding type | FindingTypeID | Severity |\n| - | - | - |\n| ServiceNow: Internal Integration user | `fa63799a-24ce-4f5f-8e88-09dbf87a6fb9` | Low |\n| ServiceNow: Web Service Access only user | `3523fbb4-8725-4ffc-b200-9aef44bbbe98` | Low |\n\n</page>\n\n<page>\n---\ntitle: Slack  Cloudflare One docs\ndescription: The Slack integration detects a variety of data loss prevention,\n  account misconfiguration, and user security risks in an integrated Slack\n  Workspace that could leave you and your organization vulnerable.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/slack/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/slack/index.md\n---\n\nThe Slack integration detects a variety of data loss prevention, account misconfiguration, and user security risks in an integrated Slack Workspace that could leave you and your organization vulnerable.\n\n## Integration prerequisites\n\n* A Slack user account\n* Membership in a Slack Workspace (Free, Pro, Business+, or Enterprise Grid)\n* If you are not the Workspace Owner and the `Require App Approval` setting is enabled for the Workspace, [request permission](https://slack.com/help/articles/202035138-Add-apps-to-your-Slack-workspace) to install apps.\n\n## Integration permissions\n\nFor the Slack integration to function, Cloudflare CASB requires the following Slack API permissions:\n\n* `channels:read`\n* `files:read`\n* `groups:read`\n* `users:read`\n\nThese permissions follow the principle of least privilege to ensure that only the minimum required access is granted. To learn more about each permission, refer to the [Slack Permission scopes reference](https://api.slack.com/scopes).\n\n## Security findings\n\nThe Slack integration currently scans for the following findings, or security risks. Findings are grouped by category and then ordered by [severity level](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#severity-levels).\n\nTo stay up-to-date with new CASB findings as they are added, bookmark this page or subscribe to its [RSS feed](https://github.com/cloudflare/cloudflare-docs/commits/production/src/content/docs/cloudflare-one/integrations/cloud-and-saas/slack.mdx.atom).\n\n### User account settings\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Slack: User with two-factor authentication disabled | `d1cc8596-d22c-435c-9f94-3ba068f019cd` | Critical | A user in the Slack Workspace does not have two-factor authentication (2FA) enabled for their account. |\n| Slack: User with unverified email | `9fa4ae7c-07f0-453a-b232-e734b0f8877c` | High | A user in the Slack Workspace has not verified the email they use to sign in. |\n\n### Channel sharing\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Slack: Channel shared externally | `d298ba64-f013-4e28-b68a-63f758380355` | High | A channel in the Slack Workspace has been shared with users who are not members of the Workspace. |\n\n### File sharing\n\n| Finding type | FindingTypeID | Severity | Description |\n| - | - | - | - |\n| Slack: File publicly accessible with view access | `9d96d3a2-696b-4802-98aa-c6c8572e806e` | Medium | An external link has been created for a file uploaded to the Slack Workspace. |\n| Slack: File larger than 2 GB | `c16d64a8-9f78-4f24-99ff-de7fcdc6871b` | Low | A file  2 GB has been uploaded to the Slack Workspace. |\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting  Cloudflare One docs\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/index.md\n---\n\n* [Troubleshoot integrations](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/troubleshoot-integrations/)\n* [Troubleshoot compute accounts](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/troubleshoot-compute-accounts/)\n\n</page>\n\n<page>\n---\ntitle: Active Directory (SAML)  Cloudflare One docs\ndescription: Integrate Active Directory with Cloudflare One for secure identity management.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/adfs/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/adfs/index.md\n---\n\nWarning\n\nMicrosoft recommends migrating your Active Directory Federation Service (AD FS) SSO to Microsoft Entra ID. For more information, refer to [Microsoft Learn](https://learn.microsoft.com/windows-server/identity/ad-fs/ad-fs-overview).\n\nTo set up the Microsoft Entra ID IdP integration with Cloudflare One, refer to [Microsoft Entra ID](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/).\n\nActive Directory is a directory service developed by Microsoft for Windows domain networks. It is included in most Windows Server operating systems as a set of processes and services. Active Directory integrates with Cloudflare Access using Security Assertion Markup Language (SAML).\n\n## Before you start\n\nTo get started, you need:\n\n* An Active Directory Domain Controller where all users have an email attribute.\n* Generic SAML enabled for your Access Identity Provider (IdP).\n* A Microsoft server running with Active Directory Federation Services (AD FS) installed. All screenshots in these instructions are for Server 2012R2. Similar steps will work for newer versions.\n* A browser safe certificate for Active Directory Federation Services (AD FS).\n\nOnce you fulfill the requirements above, you are ready to begin. Installation and basic configuration of Active Directory Federation Services (AD FS) is outside the scope of this guide. A detailed guide can be found in a [Microsoft KB](https://docs.microsoft.com/en-us/previous-versions/dynamicscrm-2016/deployment-administrators-guide/gg188612\\(v=crm.8\\)).\n\nThen to begin the connection between Cloudflare Access and AD FS create a Relying Party Trust in AD FS.\n\n## Create a Relying Party Trust\n\nRun the Add Relying Party Trust wizard to begin SAML AD integration with Cloudflare Access.\n\nTo create a Relying Party Trust:\n\n1. In **Windows Server**, launch the **ADFS Management** tool.\n\n2. Select the **Relying Party Trusts** folder.\n\n3. On the **Actions** sidebar, select **Add Relying Party Trust**. The **Add Relying Party Trust Wizard** launches.\n\n4. In the left menu, choose **Select Data Source**.\n\n5. Select the **Enter data about the relying party manually** option.\n\n6. Select **Next**.\n\n7. Enter a **Display name**. We suggest you use a recognizable name. Include any information regarding this connection in the **Notes** field.\n\n8. Select **Next**. The **Choose Profile** step displays.\n\n9. Select the **AD FS profile** option.\n\n10. Select **Next**. The **Configure Certificate** step displays.\n\n11. Leave the **Certificate** options at their defaults.\n\n12. Select **Next**. The **Configure URL** step displays.\n\n13. Select the **Enable support for the SAML 2.0 WebSSO protocol** option.\n\n14. In the **Relying party SAML 2.0 SSO service URL** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n15. Select **Next**. The **Configure Identifiers** step displays.\n\n    ![Add relying party trust wizard with callback URL pasted into open form field](https://developers.cloudflare.com/_astro/adfs-7.BHM4h9Ct_Z4Nbuf.webp)\n\n16. Paste your callback URL in the **Relying party trust identifier** field.\n\n17. Select **Next**. In the **Configure Multi-factor Authentication Now?** step, you can configure multi-factor authentication.\n\n18. Select **Next**. The **Choose Issuance Authorization Rules** step displays.\n\n19. Select the **Permit all users to access this relying party** option.\n\n20. Select **Next**. The **Ready to Add Trust** step displays.\n\n21. Review your settings.\n\n22. Select **Next**. Cloudflare now relies on AD FS for user-identity authorization.\n\nThe **Edit Claim Rules for CF Login** screen automatically displays.\n\n## Create claim rules\n\nNow create 2 Claim Rules so that AD FS can take information from Cloudflare and return it to create [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/).\n\nIf you closed the Add Relying Trust wizard, use Explorer to find the **Relying Party Trusts** folder, select the newly created RPT file, and select **Edit Claim Rules** in the **Action** sidebar.\n\nTo create Claim Rules:\n\n1. In the **Edit Claim Rules for CF Login** window, select **Add Rule**. The **Choose Rule Type** step displays.\n\n2. In the **Claim rule template** field, select **Send LDAP Attributes as Claims** from the drop-down list.\n\n3. Select **Next**. The **Edit Rule  Send Email** step displays.\n\n4. Enter a descriptive **Claim rule name**.\n\n5. Select **Active Directory** from the **Attribute store** drop-down list.\n\n6. Select **E-mail-Addresses** from the **LDAP Attribute** and **Outgoing Claim Type** drop-down lists.\n\nAD FS groups\n\nIf you wish to use AD FS groups in your SAML claims, use `token-groups - unqualified names` instead of `is-member-of-DL`. Using `is-member-of-DL` will display the group in the form of LDAP paths, whereas `token-groups - unqualified names` will return only the group name.\n\n1. Select **OK**. You return to the **Choose Rule Type** step.\n\n2. Select **Transform an Incoming Claim** from the **Claim rule template** drop-down list to create the second rule.\n\n3. Select **Next**. The **Edit - Create Transient Name Identifier** window displays.\n\n4. Enter a descriptive **Claim rule name**.\n\n5. Select **E-Mail Address** from the **Incoming claim type** drop-down list.\n\n6. Select **Name ID** from the **Outgoing claim type** drop-down list.\n\n7. Select **Transient Identifier** from the **Outgoing name ID format** drop-down list.\n\n8. Ensure that the **Pass through all claim values** option is selected.\n\n9. Select **OK**.\n\nBoth Claim Rules are now available to export to your Cloudflare Access account.\n\n## Export the certificate\n\nNow you'll configure Cloudflare to recognize AD FS by extracting the *token-signing certificate* from AD FS.\n\nTo export the certificate:\n\n1. Within the AD FS management console, select the **Service** under AD FS and choose the **Certificates** folder which contains the certificate to export.\n\n2. In the **Certificates** card, right-click on the entry under **Token-signing**, and select **View certificate**. The **Certificates** window displays.\n\n   ![Certificates window with token-signing certificate selected](https://developers.cloudflare.com/_astro/adfs-16.Rob0iaqT_1wJQkA.webp)\n\n3. Select the **Details** tab, and select the **Copy to File** option.\n\n4. The **Certificate Export Wizard** displays.\n\n5. Select **Next**. The **Export File Format** window displays.\n\n6. Select the **Base-64 encoded X.509 (.CER)** option.\n\n7. Select **Next**.\n\n8. Enter a name for the file.\n\n9. Select **Next**.\n\n10. Select **Finish**.\n\n    Note the file path for later.\n\n## Configure AD FS to sign SAML responses\n\nTo ensure that AD FS signs the full response when communicating with Cloudflare, open your local **PowerShell** and enter the following command:",
      "language": "unknown"
    },
    {
      "code": "## Configure Cloudflare One\n\nTo enable Cloudflare One to accept the claims and assertions sent from AD FS, follow these steps:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **SAML**.\n\n4. Enter an IdP **Name**.\n\n5. Under **Single Sign On URL** enter:",
      "language": "unknown"
    },
    {
      "code": "This is the default location. You can find your federation service identifier in AD FS.\n\n6. In the **IdP Entity ID or Issuer URL** field, enter your Cloudflare Zero Trust team domain and include this callback at the end of the path: `/cdn-cgi/access/callback`. For example:",
      "language": "unknown"
    },
    {
      "code": "7. Under **Signing certificate**, paste the exported certificate.\n\n   There can be no spaces or return characters in the text field.\n\n8. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the identity provider you want to test.\n\n## Download SP metadata (optional)\n\nSome IdPs allow administrators to upload metadata files from their SP (service provider).\n\nTo get your Cloudflare metadata file:\n\n1. Download your unique SAML metadata file at the following URL:",
      "language": "unknown"
    },
    {
      "code": "In Cloudflare Access, you can find a link to this URL in the **Edit a SAML identity provider** dialog. The link returns a web page with your SAML SP data in XML format.\n\n2. Save the file in XML format.\n\n3. Upload the XML document to your **Active Directory** account.\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: AWS IAM (SAML)  Cloudflare One docs\ndescription: AWS IAM Identity Center provides SSO identity management for users\n  who interact with AWS resources (such as EC2 instances or S3 buckets). You can\n  integrate AWS IAM with Cloudflare Zero Trust as a SAML identity provider,\n  which allows users to authenticate to Zero Trust using their AWS credentials.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/aws-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/aws-saml/index.md\n---\n\nAWS IAM Identity Center provides SSO identity management for users who interact with AWS resources (such as EC2 instances or S3 buckets). You can integrate AWS IAM with Cloudflare Zero Trust as a SAML identity provider, which allows users to authenticate to Zero Trust using their AWS credentials.\n\n## Prerequisites\n\n* Admin access to an IAM Identity Center [organization instance](https://docs.aws.amazon.com/singlesignon/latest/userguide/identity-center-instances.html)\n\n## Set up AWS IAM as a SAML provider\n\nTo set up SAML with AWS IAM as your identity provider:\n\n1. Open your [IAM Identity Center console](https://console.aws.amazon.com/singlesignon) and go to **Applications**.\n\n2. Select the **Customer managed** tab.\n\n3. Select **Add application**.\n\n4. Select **I have an application I want to set up**.\n\n5. For **Application type**, select **SAML 2.0**.\n\n6. Select **Next**.\n\n7. Enter a **Display name** for the application (for example, `Cloudflare One`).\n\n8. Download the **IAM Identity Center SAML metadata file**. You will need this file later when configuring the identity provider in Cloudflare One.\n\n9. Under **Application metadata**, select **Manually type your metadata values**.\n\n10. In **Application ACS URL** and **Application SAML audience**, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n1. Select **Submit**.\n\n2. Next, select the **Actions** dropdown menu and select *Edit attribute mappings*.\n\n3. For the `Subject` user attribute, enter `${user:email}`.\n\n4. (Recommended) Add user name attributes:\n\n| User attribute | String value |\n| - | - |\n| `name` | `${user:name}` |\n| `surName` | `${user:familyName}` |\n| `givenName` | `${user:givenName}` |\n\n![Configuring attribute statements in IAM Identity Center](https://developers.cloudflare.com/_astro/aws-saml-attributes.DuPGeU5b_14myvM.webp)\n\n1. Select **Save changes**.\n\n2. Under **Assign users and groups**, add individuals and/or groups that should be allowed to login to Cloudflare One.\n\n3. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n4. Under **Your identity providers**, select **Add new identity provider**.\n\n5. Select **SAML**.\n\n6. Enter a **Name** for the IdP integration (for example, `AWS`).\n\n7. Upload the **IAM Identity Center SAML metadata file** that you downloaded in Step 8.\n\n8. (Recommended) Enable [**Sign SAML authentication request**](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#sign-saml-authentication-request).\n\n9. Select **Save**.\n\nTo [test](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) that your connection is working, select **Test**.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Amazon Cognito  Cloudflare One docs\ndescription: Amazon Cognito provides SSO identity management for end users of\n  web and mobile apps. You can integrate Amazon Cognito as an OIDC identity\n  provider for Cloudflare One.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/awscognito-oidc/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/awscognito-oidc/index.md\n---\n\nAmazon Cognito provides SSO identity management for end users of web and mobile apps. You can integrate Amazon Cognito as an OIDC identity provider for Cloudflare One.\n\n## Prerequisites\n\n* An Amazon Cognito [user pool](https://docs.aws.amazon.com/cognito/latest/developerguide/tutorial-create-user-pool.html)\n\n## Set up Amazon Cognito (OIDC)\n\n### 1. Obtain Amazon Cognito settings\n\nThe following Amazon Cognito values are required to set up the integration:\n\n* App (client) ID\n* Client secret\n* Auth URL\n* Token URL\n* Certificate (key) URL\n\nTo retrieve those values:\n\n1. Log in to your Amazon Cognito admin portal.\n\n2. Go to **User pools** and select your user pool.\n\n3. Select the **App integration** tab.\n\n4. Under **Domain**, copy your user pool domain or [configure a new domain](https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pools-assign-domain.html).\n\n5. Make note of the following [Amazon Cognito OIDC endpoints](https://docs.aws.amazon.com/cognito/latest/developerguide/federation-endpoints.html):\n\n   * **Auth URL**: `https://<your user pool domain>/oauth2/authorize`\n   * **Token URL**: `https://<your user pool domain>/oauth2/token`\n   * **Certificate (key) URL**: `https://cognito-idp.<region>.amazonaws.com/<your user pool ID>/.well-known/jwks.json` (This is the **Token signing key URL** shown in **User pool overview**.)\n\n6. Under **App client list**, select **Create app client**.\n\n7. For **App type**, select **Confidential client**.\n\n8. Enter an **App client name** for your application.\n\n9. Ensure that **Generate a client secret** is selected.\n\n10. Configure the following **Hosted UI settings**:\n\n    1. In **Allowed callback URLs**, add the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n    2. Select **Identity providers** to use with this app client. At minimum, enable **Cognito user pool** as a provider.\n\n    3. For **OAuth 2.0 grant types**, select **Authorization code grant**.\n\n    4. For **OpenID Connect scopes**, select **OpenID**, **Email**, and **Profile**.\n\n11. Select **Create app client**.\n\n12. Next, select the app client you just created.\n\n13. Copy its **Client ID** and **Client secret**.\n\n### 2. Add Amazon Cognito as an identity provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **OpenID Connect**.\n\n4. Name your identity provider and fill in the required fields with the information obtained from Amazon Cognito.\n\n5. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/) if the protocol is supported by your IdP. PKCE will be performed on all login attempts.\n\n6. (Optional) Under **Optional configurations**, enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to users' identity.\n\n7. Select **Save**.\n\nTo [test](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) that your connection is working, select **Test**.\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Centrify  Cloudflare One docs\ndescription: \"Centrify secures access to infrastructure, DevOps, cloud, and\n  other modern enterprise so you can prevent the number one cause of breaches:\n  privileged access abuse.\"\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/centrify/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/centrify/index.md\n---\n\nCentrify secures access to infrastructure, DevOps, cloud, and other modern enterprise so you can prevent the number one cause of breaches: privileged access abuse.\n\n## Set up Centrify as an OIDC provider\n\n### 1. Create an application in Centrify\n\n1. Log in to the Centrify administrator panel.\n\n2. Select **Apps**.\n\n3. Select **Add Web Apps**.\n\n4. Select the **Custom** tab, then select **Add OpenID Connect**.\n\n5. On the **Add Web App** screen, select **Yes** to create an OpenID Connect application.\n\n6. Enter an **Application ID**.\n\n   ![Centrify Settings with Application ID added](https://developers.cloudflare.com/_astro/centrify-4.C0i78_vc_Z1QPBsV.webp)\n\n7. Select **Save**.\n\n8. Select **Trust** in the **Settings** menu.\n\n9. Enter a strong application secret on the **Trust** section.\n\n10. Under **Service Provider Configuration** enter your application's authentication domain as the resource application URL.\n\n11. Under **Authorized Redirect URIs**, select **Add**.\n\n12. Under **Authorized Redirect URIs**, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n    ![Centrify Trust Identity Provider Configuration with team domain and callback](https://developers.cloudflare.com/_astro/centrify-6.ChCQ_t69_Z2d4gi7.webp)\n\n13. Select **Save**.\n\n14. Copy the following values:\n\n* **Client ID**\n* **Client Secret**\n* **OpenID Connect Issuer URL**\n* **Application ID** from the **Settings** tab\n\n1. Go to the **User Access** tab.\n\n2. Select the roles to grant access to your application.\n\n### 2. Add Centrify to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Paste in the **Client ID**, **Client Secret**, **Centrify account URL** and **Application ID**.\n\n4. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#synchronize-users-and-groups).\n\n5. (Optional) Under **Optional configurations**, enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to your users' identity.\n\n6. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the identity provider you want to test.\n\n## Example API Config",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Centrify (SAML)  Cloudflare One docs\ndescription: Learn how to integrate Centrify as a SAML identity provider with\n  Cloudflare One.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/centrify-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/centrify-saml/index.md\n---\n\nCentrify secures access to infrastructure, DevOps, cloud, and other modern enterprise so you can prevent the number one cause of breaches: privileged access abuse.\n\n## Set up Centrify as a SAML provider\n\n## 1. Create an application in Centrify\n\n1. Log in to your **Centrify** admin portal and select **Apps**.\n\n2. Select **Add Web Apps**.\n\n3. Select the **Custom** tab.\n\n4. Next to the **SAML** icon, select **Add**.\n\n   ![Centrify Settings Add Application details page with template text](https://developers.cloudflare.com/_astro/saml-centrify-3.CEH90Xdy_ZMwrJK.webp)\n\n5. Enter the required information for your application.\n\n6. Select **Save**.\n\n7. Select **Settings** in the left pane.\n\n8. In the middle menu pane, select **Trust**.\n\n9. Choose the **Manual Configuration** option.\n\n10. In the **SP Entity ID** and **Assertion Consumer Service (ACS) URL fields**, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n11. Select **Save**.\n\n12. In the middle menu pane, select **User Access**.\n\n13. Select **Add**. The **Select Role** dialog displays.\n\n14. Complete your roles access assignments. The Role rules display on the **User Access** card.\n\n15. In the **User Access** card's middle menu pane, select **SAML Response**.\n\n16. Select **Active** > **Add** to create a new **Attribute Name**, **Email**.\n\n    ![Centrify SAML Response card with Settings Email Attribute selected](https://developers.cloudflare.com/_astro/saml-centrify-9.BpHIxUlM_Z14DHjz.webp)\n\n17. Enter the user email addresses in the **Attribute Value** field.\n\n18. Select **Save**.\n\n19. Select **Settings** again from the left menu pane, and **Trust**.\n\n20. Select the **Manual Configuration** option.\n\n### 2. Add Centrify to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **SAML**.\n\n4. Copy and paste the corresponding information from Centrify into the fields.\n\n5. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#synchronize-users-and-groups).\n\n6. (Optional) Under **Optional configurations**, configure [additional SAML options](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#optional-configurations).\n\n7. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the identity provider you want to test.\n\n## Download SP metadata (optional)\n\nSome IdPs allow administrators to upload metadata files from their SP (service provider).\n\nTo get your Cloudflare metadata file:\n\n1. Download your unique SAML metadata file at the following URL:",
      "language": "unknown"
    },
    {
      "code": "2. Save the file in XML format.\n\n3. Upload the XML document to your **Centrify** account.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Citrix ADC (SAML)  Cloudflare One docs\ndescription: Cloudflare One can integrate with Citrix ADC (formerly Citrix\n  NetScaler ADC) as a SAML IdP. Documentation from Citrix shows you how to\n  configure Citrix ADC as a SAML IdP. These steps are specific to Cloudflare\n  One.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/citrixadc-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/citrixadc-saml/index.md\n---\n\nCloudflare One can integrate with Citrix ADC (formerly Citrix NetScaler ADC) as a SAML IdP. Documentation from Citrix shows you [how to configure Citrix ADC as a SAML IdP](https://docs.citrix.com/en-us/citrix-adc/12-1/aaa-tm/saml-authentication/citrix-adc-saml-idp.html). These steps are specific to Cloudflare One.\n\n## Set up Citrix ADC (SAML)\n\nTo set up Citrix ADC (SAML) as your identity provider:\n\n1. First, you'll need to configure 2 SAML certificates:\n\n   * A certificate to **terminate TLS at the vServer**. Ensure that the certificate is issued by a publicly trusted CA.\n   * A certificate for **signing SAML assertions**.\n\n   If you do not already have a certificate for signing SAML assertions, you can use a self-signed certificate generated on Citrix ADC by following these steps:\n\n   1. Go to **Traffic Management** > **SSL**.\n   2. Select **Create and Install a Server Test Certificate**.\n\n2. Select **Configuration** and enter a **Certificate File Name**, **Fully Qualified Domain Name**, and a select a **Country**.\n\n   ![Citrix AD Create and Install Test Certificate interface with file name, domain name, and country](https://developers.cloudflare.com/_astro/citrixadc-saml-2.D4502Bei_Z28YUVY.webp)\n\n3. Create a publicly accessible authentication vServer and configure the user identity source (like, local users, LDAP) by following this [Citrix documentation](https://docs.citrix.com/en-us/citrix-adc/12-1/aaa-tm/authentication-virtual-server/ns-aaa-setup-auth-vserver-tsk.html).\n\n   For the rest of this example, the user refers to the IdP address `idp.yourdomain.com`.\n\n## Add a new profile\n\n1. Go to **Security** > **AAA - Application Traffic** > **Policies** > **Authentication** > **Advanced Policies** > **SAML IDP** to add a new profile.\n\n   Include the following required configuration details:\n\n   | Field | Description |\n   | - | - |\n   | **Name** | The certificate name you defined while [configuring SAML](#set-up-citrix-adc-saml) |\n   | **Assertion Consumer Service URL** | `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback` |\n   | **IdP Certificate Name** | The IdP certificate name you defined while [configuring SAML](#set-up-citrix-adc-saml) |\n   | **Issuer Name** | `https://idp.<yourdomain>.com/saml/login` |\n   | **Service Provider ID** | `https://idp.<yourdomain>.com/saml/login` |\n   | **Name ID Format** | EmailAddress |\n   | **Attribute 1** | `email = AAA.USER.ATTRIBUTE(\"email\")` |\n\n   Cloudflare Access currently sends the IdP address in place of the *Service Provider ID* for the AuthN request.\n\n2. Create an Authentication Policy that refers to the Profile just created, and bind it to the authentication vServer mentioned above.\n\n   ![Citrix AD Configure Authentication SAML IDP Policy](https://developers.cloudflare.com/_astro/citrixadc-saml-4.Ci1ulauO_Z1T8Lcy.webp)\n\n   To configure all of the above using just the CLI, run the following:",
      "language": "unknown"
    },
    {
      "code": "3. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n4. Under **Your identity providers**, select **Add new identity provider**.\n\n5. Configure the fields as follows:\n\n   | Field | Description |\n   | - | - |\n   | **Name** | Your chosen name |\n   | **Single Sign On URL** | The FQDN of the IdP, with the path `/saml/login` |\n   | **IdP Entity ID/Issuer URL** | As above |\n   | **Signing Certificate** | The public certificate from the NetScaler |\n   | **Email attribute name** | This is listed under **Optional configurations** |\n\n6. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the identity provider you want to test.\n\n</page>\n\n<page>\n---\ntitle: Microsoft Entra ID  Cloudflare One docs\ndescription: You can integrate Microsoft Entra ID (formerly Azure Active\n  Directory) with Cloudflare One and build policies based on user identity and\n  group membership. Users will authenticate to Cloudflare One using their Entra\n  ID credentials.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/index.md\n---\n\nYou can integrate Microsoft Entra ID (formerly Azure Active Directory) with Cloudflare One and build policies based on user identity and group membership. Users will authenticate to Cloudflare One using their Entra ID credentials.\n\n## Set up Entra ID as an identity provider\n\n### 1. Obtain Entra ID settings\n\nThe following Entra ID values are required to set up the integration:\n\n* Application (client) ID\n* Directory (tenant) ID\n* Client secret\n\nTo retrieve those values:\n\n1. Log in to the [Microsoft Entra admin center](https://entra.microsoft.com/).\n\n2. Go to **Applications** > **Enterprise applications**.\n\n3. Select **New application**, then select **Create your own application**.\n\n4. Name your application.\n\n5. Select **Register an application to integrate with Microsoft Entra ID (App you're developing)**. If offered, do not select any of the gallery applications. Select **Create**.\n\n6. Under **Redirect URI**, select the *Web* platform and enter the following URL.",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n   ![Registering an application in Azure](https://developers.cloudflare.com/_astro/name-app.BaJD5DTz_llkEb.webp)\n\n7. Select **Register**.\n\n8. Next, return to Microsoft Entra ID and go to **Applications** > **App registrations**.\n\n9. Select **All applications** and select the app you just created. Copy the **Application (client) ID** and **Directory (tenant) ID**. You will need these values when [adding Entra ID as an identity provider in step 3](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#3-add-entra-id-as-an-identity-provider).\n\n   ![Viewing the Application ID and Directory ID in Azure](https://developers.cloudflare.com/_astro/azure-values.BIjGV_0A_Z1Eu7vp.webp)\n\n10. On the same page, under **Client credentials**, go to **Add a certificate or secret**. Select **New client secret**.\n\n11. Name the client secret and choose an expiration period.\n\n    Note\n\n    When the client secret expires, users will be unable to log in through Access. Take note of your expiry date to prevent login errors and renew your client secret when necessary.\n\n12. After the client secret is created, copy its **Value** field. Store the client secret in a safe place, as it can only be viewed immediately after creation. You will need this client secret value when [adding Entra ID as an identity provider in step 3](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#3-add-entra-id-as-an-identity-provider).\n\n    ![Location of client secret in Azure](https://developers.cloudflare.com/_astro/client-cert-value.BgU55T2B_ZaqOUk.webp)\n\n### 2. Configure API permissions in Entra ID\n\n1. Go to **App registrations** > **All applications** > select your application > **API permissions**.\n\n2. Select **Add a permission**.\n\n3. Select **Microsoft Graph**.\n\n4. Select **Delegated permissions** and enable the following [permissions](https://learn.microsoft.com/graph/permissions-reference):\n\n   * `email`\n   * `offline_access`\n   * `openid`\n   * `profile`\n   * `User.Read`\n   * `Directory.Read.All`\n   * `GroupMember.Read.All`\n\nNote\n\nMore narrow permissions may be used, however this is the set of permissions that are tested and supported by Cloudflare.\n\n1. Once all seven permissions are enabled, select **Add permissions**.\n\n2. Select **Grant admin consent**.\n\n   ![Configured permissions list in Azure](https://developers.cloudflare.com/_astro/configured-perms.C3NcHNrM_Z1WCyL8.webp)\n\n### 3. Add Entra ID as an identity provider\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n  2. Under **Your identity providers**, select **Add new identity provider**.\n\n  3. Select **Azure AD**.\n\n  4. Enter the **Application (client) ID**, **Client secret**, and **Directory (tenant) ID** obtained from Microsoft Entra ID.\n\n  5. Select **Save**.\n\n  6. To [test](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) that your connection is working, select **Test**.\n\n  7. (Optional) Configure the following settings:\n\n     * **Proof Key for Code Exchange**: Perform [PKCE](https://www.oauth.com/oauth2-servers/pkce/) on all login attempts.\n     * **Support Groups**: Allow Cloudflare to read a user's Entra ID group membership.\n     * **Entra ID Policy Sync**: Refer to our [Entra ID Conditional Access tutorial](https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-conditional-access/).\n     * **Enable SCIM**: Refer to [Synchronize users and groups](#synchronize-users-and-groups).\n     * **Email claim**: Enter the Entra ID claim that you wish to use for user identification (for example, `preferred_username`).\n     * **OIDC Claims**: Enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to your users' identity.\n\n* API\n\n  Make a `POST` request to the [Identity Providers](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/methods/create/) endpoint:\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Access: Organizations, Identity Providers, and Groups Write`",
      "language": "unknown"
    },
    {
      "code": "* Terraform\n\n  Provider versions\n\n  The following example requires Cloudflare provider version `4.40.0` or greater.\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Organizations, Identity Providers, and Groups Write`\n\n  2. Configure the [`cloudflare_zero_trust_access_identity_provider`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_identity_provider) resource:",
      "language": "unknown"
    },
    {
      "code": "#### UPN and email\n\nIf your organization's UPNs do not match users' email addresses, you must add a custom claim for email. For example, if your organization's email format is `user@domain.com` but the UPN is `u908080@domain.com`, you must create an email claim if you are configuring email-based policies.\n\nBy default, Cloudflare will first look for the unique claim name you created and configured in Cloudflare One to represent email (for example, `email_identifier`) in the `id_token` JSON response. If you did not configure a unique claim name, Cloudflare will then look for an `email` claim. Last, if neither claim exists, Cloudflare will look for the UPN claim.\n\nTo receive an email claim in the `id_token` from Microsoft Entra, you must:\n\n1. In the [Microsoft Entra admin center](https://entra.microsoft.com/), go to **Application** > **App registration** > **All applications** and select the relevant application.\n\n2. Under **Manage**, select **Token configuration**.\n\n3. Add a claim for email.\n\n   ![Email claim for Entra](https://developers.cloudflare.com/_astro/entra-email-claim.CPt-1jZE_121z85.webp)\n\n   The example above includes both a UPN claim and an email claim. Because an email claim was created in the Microsoft Entra configuration, Cloudflare will look for the `email` key-value pair in the JSON response.\n\n4. If you gave your email claim another name than `email`, you must update your configuration in Cloudflare One:\n\n   a. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers** > **Azure AD** > **Edit**.\n\n   b. Under **Optional configurations** > **Email claim**, enter the name of the claim representing your organization's email addresses.\n\n#### Object ID\n\nIf you are concerned that users' emails or UPNs may change, you can pass the user's object ID (`oid`) from Microsoft Entra to Cloudflare Access. To configure Access to receive the object ID, refer to [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims). No additional configuration is required in Microsoft Entra.\n\n## Synchronize users and groups\n\nThe Microsoft Entra ID integration allows you to synchronize IdP groups and automatically deprovision users using [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/).\n\n### Prerequisites\n\n* Microsoft Entra ID P1 or P2 license\n\n### 1. Enable SCIM in Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Find the Entra ID integration and select **Edit**.\n\n3. Turn on **Enable SCIM** and **Support groups**.\n\n4. (Optional) Configure the following settings:\n\n* **Enable user deprovisioning**: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when they are removed from the SCIM application in Entra ID. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n* **Remove user seat on deprovision**: [Remove a user's seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) from your Cloudflare One account when they are removed from the SCIM application in Entra ID.\n\n* **SCIM identity update behavior**: Choose what happens in Cloudflare One when the user's identity updates in Entra ID.\n\n  * *Automatic identity updates*: Automatically update the [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/) when Entra ID sends an updated identity or group membership through SCIM. This identity is used for Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/); Access will read the user's updated identity when they reauthenticate.\n  * *Group membership change reauthentication*: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when their group membership changes in Entra ID. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). Access will read the user's updated group membership when they reauthenticate.\n  * *No action*: Update the user's identity the next time they reauthenticate to Access or WARP.\n\n1. Select **Regenerate Secret**. Copy the **SCIM Endpoint** and **SCIM Secret**. You will need to enter these values into Entra ID.\n\n2. Select **Save**.\n\nThe SCIM secret never expires, but you can manually regenerate the secret at any time.\n\n### 2. Configure SCIM in Entra ID\n\nNote\n\nSCIM requires a separate enterprise application from the one created during [initial setup](#set-up-entra-id-as-an-identity-provider).\n\n1. In the Microsoft Entra ID menu, go to **Enterprise applications**.\n\n2. Select **New application** > **Create your own application**.\n\n3. Name your application (for example, `Cloudflare Access SCIM`).\n\n4. Select **Integrate any other application you don't find in the gallery (Non-gallery)**. If offered, do not select any of the gallery applications. Select **Create**.\n\n5. After you have created the application, go to **Provisioning** > select **New Configuration**.\n\n6. In the **Tenant URL** field, enter the **SCIM Endpoint** obtained from your Entra ID integration in Cloudflare One [in the previous step](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#1-enable-scim-in-zero-trust).\n\n7. In the **Secret token** field, enter the **SCIM Secret** obtained from your Entra ID integration in Cloudflare One [in the previous step](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#1-enable-scim-in-zero-trust).\n\n8. Select **Test Connection** to ensure that the credentials were entered correctly. If the test fails, go to your Entra ID integration in Cloudflare One, select **Regenerate Secret**, select **Save**, and enter your new **SCIM Secret** in the **Secret token** field.\n\n9. Select **Create**.\n\n10. Once the SCIM application is created, [assign users and groups to the application](https://learn.microsoft.com/entra/identity/enterprise-apps/assign-user-or-group-access-portal).\n\nNote\n\nGroups in this SCIM application should match the groups in your other [Cloudflare Access enterprise application](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#set-up-entra-id-as-an-identity-provider). Because SCIM group membership updates will overwrite any groups in a user's identity, assigning the same groups to each app ensures consistent policy evaluation.\n\n1. Go to **Provisioning** and select **Start provisioning**.\n\n2. For **Provisioning Mode**, the default mode should be set by Microsoft to *Automatic*.\n\n3. On the **Overview** page in Entra ID, you will see the synchronization status.\n\nTo check which users and groups were synchronized, select **Provisioning logs**.\n\nTo check if user identities were updated in Cloudflare One, view your [SCIM provisioning logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\nTo monitor the exchange of identity details between Cloudflare Access and Microsoft Entra ID, go to [Cloudflare One](https://one.dash.cloudflare.com) > **Insights** > **Logs** > **SCIM provisioning logs** and view the [SCIM activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\n### Provisioning attributes\n\nProvisioning attributes define the user properties that Entra ID will synchronize with Cloudflare Access. To modify your provisioning attributes, go to the **Attribute mapping** and select **Provision Microsoft Entra ID Users**.\n\nIf not already configured, Cloudflare recommends enabling the following user attribute mappings:\n\n| customappsso Attribute | Entra ID Attribute | Recommendation |\n| - | - | - |\n| `userName` | `userPrincipalName` or `mail` | Required. Must match the user's email address in Cloudflare One. |\n| `emails[type eq \"work\"].value` | `mail` | Required. Must match the user's email address in Cloudflare One. |\n| `name.givenName` | `givenName` | Recommended |\n| `name.familyName` | `surname` | Recommended |\n\n## Entra groups in Zero Trust policies\n\n### Automatic entry\n\nWhen [SCIM synchronization is enabled](#synchronize-users-and-groups), your Entra group names will automatically appear in the Access and Gateway policy builders.\n\n![Azure group names displayed in the Access policy builder](https://developers.cloudflare.com/_astro/azure-scim-groups.CShvL-AY_Z13loiJ.webp)\n\nIf building a Gateway policy, choose the [*User Group Names*](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#user-group-names) selector.\n\n### Manual entry\n\nYou can create Access and Gateway policies for groups that are not synchronized with SCIM. Entra ID exposes directory groups in a format that consists of random strings, the `Object Id`, that is distinct from the `Name`.\n\n1. Make sure you enable **Support groups** as you set up Microsoft Entra ID in Cloudflare One.\n\n2. In your Microsoft Entra dashboard, note the `Object Id` for the Entra group. In the example below, the group named Admins has an ID of `61503835-b6fe-4630-af88-de551dd59a2`.\n\n   ![Viewing the Azure group ID on the Azure dashboard](https://developers.cloudflare.com/_astro/object-id.Cr5EOUSk_Z1y4aPG.webp)\n\n3. If building an Access policy, choose the *Azure Groups* selector. If building a Gateway policy, choose the *User Group IDs* selector.\n\n4. In the **Value** field, enter the `Object Id` for the Entra group.\n\n   ![Entering an Azure group ID in Cloudflare One](https://developers.cloudflare.com/_astro/configure-group-n.CdHBsLpw_Z1jU6Qs.webp)\n\n### Nested groups\n\n#### Authentication\n\nAccess and Gateway policies for an Entra group will also apply to all [nested groups](https://learn.microsoft.com/entra/fundamentals/how-to-manage-groups#add-a-group-to-another-group). For example, if a user belongs to the group `US devs`, and `US devs` is part of the broader group `Devs`, the user would be allowed or blocked by all policies created for `Devs`.\n\n#### SCIM provisioning\n\nFor SCIM provisioning, [nested groups are not supported](https://learn.microsoft.com/en-us/entra/identity/app-provisioning/how-provisioning-works#assignment-based-scoping). Microsoft Entra ID's SCIM implementation does not send information about nested group memberships to Cloudflare. Only users who are direct members of an explicitly assigned group will be provisioned. To ensure group memberships are correctly synchronized, you must flatten your groups in Entra ID by directly assigning users to the groups you want to provision.\n\nSince the SCIM request from Microsoft does not include nested group information, neither Cloudflare nor Microsoft can provide a notification that nested groups are not being synchronized.\n\n## Force user interaction during WARP reauthentication\n\nYou can require users to re-enter their credentials into Entra ID whenever they [re-authenticate their WARP session](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). To configure this setting:\n\n1. Make a `GET` request to the [Identity Providers endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/) and copy the response for the Entra ID identity provider.\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `Access: Organizations, Identity Providers, and Groups Write`\n   * `Access: Organizations, Identity Providers, and Groups Read`",
      "language": "unknown"
    },
    {
      "code": "2. [Update the Entra ID identity provider](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/methods/update/) using a `PUT` request. In the request body, include all existing configurations and set the `prompt` parameter to either `login` or `select_account`. For example:\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `Access: Organizations, Identity Providers, and Groups Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Facebook  Cloudflare One docs\ndescription: Use these steps to set up Facebook as your identity provider.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/facebook-login/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/facebook-login/index.md\n---\n\nUse these steps to set up Facebook as your identity provider.\n\n1. Go to [developers.facebook.com](https://developers.facebook.com/).\n\n2. Select **Create App** at the top-right. The **Create a New App ID** card displays.\n\n3. Enter the **Display Name** and **Contact Email**.\n\n4. Select **Create App ID**. The **Create a New App ID** window displays.\n\n5. Enter the CAPTCHA code to proceed.\n\n6. Select **Submit**.\n\n7. On the **Facebook Login** card, select **Set Up**. A Quickstart card displays offering platform choices.\n\n8. Select **Web**. The **Web** tab displays.\n\n9. Enter your **Site URL**.\n\n10. Select **Save**.\n\n11. Select **Continue**. Ignore any JavaScript page that suggests that you install it on your site.\n\n12. Select **Settings** > **Basic**.\n\n13. Copy the **App ID** and **App Secret**.\n\n    ![Facebook Settings with App ID and App Secret highlighted](https://developers.cloudflare.com/_astro/fb6.BYub0V9o_Z2nbsRN.webp)\n\n14. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n15. Under **Your identity providers**, select **Add new identity provider**.\n\n16. Fill in the **App ID** and **App Secret** obtained from Facebook.\n\n17. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/). PKCE will be performed on all login attempts.\n\n18. Select **Save**.\n\n19. On [developers.facebook.com](https://developers.facebook.com/), select **Facebook Login** > **Settings** on the left-hand menu.\n\n20. Ensure that the **Use Strict Mode for Redirect URIs** slider is set to **Yes**.\n\n21. In the **Valid OAuth redirect URIs** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n22. Select **Save Changes**.\n\nTo test that your connection is working, follow the steps on [SSO Integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one).\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Generic OIDC  Cloudflare One docs\ndescription: Cloudflare Access has a generic OpenID Connect (OIDC) connector to\n  help you integrate IdPs not already set in Access.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/index.md\n---\n\nCloudflare Access has a generic OpenID Connect (OIDC) connector to help you integrate IdPs not already set in Access.\n\n## 1. Create an application in your identity provider\n\n1. Visit your identity provider and create a client/app.\n\n2. When creating a client/app, your IdP may request an **authorized redirect URI**. Enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n3. Copy the content of these fields:\n\n   * Client ID\n   * Client secret\n   * Auth URL: The `authorization_endpoint` URL of your IdP\n   * Token URL: The `token_endpoint` URL of your IdP\n   * Certificate URL: The `jwks_uri` endpoint of your IdP to allow the IdP keys to sign the tokens\n\n   You can find these values on your identity provider's **OIDC discovery endpoint**. Some providers call this the \"well-known URL\".\n\n## 2. Add an OIDC provider to Cloudflare One\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n  2. Under **Your identity providers**, select **Add new identity provider**.\n\n  3. Choose **OpenID Connect**.\n\n  4. Name your identity provider and fill in the required fields with the information obtained from your identity provider.\n\n  5. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/) if the protocol is supported by your IdP. PKCE will be performed on all login attempts.\n\n  6. (Optional) To enable SCIM, refer to [Synchronize users and groups](#synchronize-users-and-groups).\n\n  7. (Optional) Under **Optional configurations**, enter [custom OIDC claims](#oidc-claims) that you wish to add to users' identity. This information will be available in the [user identity endpoint](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/#user-identity).\n\n  8. Select **Save**.\n\n* API\n\n  Make a `POST` request to the [Identity Providers](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/methods/create/) endpoint:\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Access: Organizations, Identity Providers, and Groups Write`",
      "language": "unknown"
    },
    {
      "code": "* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Organizations, Identity Providers, and Groups Write`\n\n  2. Configure the [`cloudflare_zero_trust_access_identity_provider`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_identity_provider) resource:",
      "language": "unknown"
    },
    {
      "code": "## 3. Test the connection\n\nTo test that your connection is working, go to **Authentication** > **Login methods** and select **Test** next to the login method you want to test. On success, a confirmation screen displays.\n\n## Synchronize users and groups\n\nThe generic OIDC integration allows you to synchronize user groups and automatically deprovision users using [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/).\n\n### Prerequisites\n\nYour identity provider must support SCIM version 2.0.\n\n### 1. Enable SCIM in Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Find the IdP integration and select **Edit**.\n\n3. Turn on **Enable SCIM**\n\n4. (Optional) Configure the following settings:\n\n* **Enable user deprovisioning**: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when they are removed from the SCIM application in IdP. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n* **Remove user seat on deprovision**: [Remove a user's seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) from your Cloudflare One account when they are removed from the SCIM application in IdP.\n\n* **SCIM identity update behavior**: Choose what happens in Cloudflare One when the user's identity updates in IdP.\n\n  * *Automatic identity updates*: Automatically update the [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/) when IdP sends an updated identity or group membership through SCIM. This identity is used for Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/); Access will read the user's updated identity when they reauthenticate.\n  * *Group membership change reauthentication*: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when their group membership changes in IdP. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). Access will read the user's updated group membership when they reauthenticate.\n  * *No action*: Update the user's identity the next time they reauthenticate to Access or WARP.\n\n1. Select **Regenerate Secret**. Copy the **SCIM Endpoint** and **SCIM Secret**. You will need to enter these values into IdP.\n\n2. Select **Save**.\n\nThe SCIM secret never expires, but you can manually regenerate the secret at any time.\n\n### 2. Configure SCIM in the IdP\n\nSetup instructions vary depending on the identity provider. In your identity provider, you will either need to edit the [original SSO application](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#1-create-an-application-in-your-identity-provider) or create a new SCIM application. Refer to your identity provider's documentation for more details. For example instructions, refer to our [Okta](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/#synchronize-users-and-groups) or [Jumpcloud](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/jumpcloud-saml/#synchronize-users-and-groups) guides.\n\n#### IdP groups\n\nIf you would like to build policies based on IdP groups:\n\n* Ensure that your IdP sends a `groups` field. The naming must match exactly (case insensitive). All other values will be sent as a OIDC claim.\n* If your IdP requires creating a new SCIM application, ensure that the groups in the SCIM application match the groups in the [original SSO application](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#1-create-an-application-in-your-identity-provider). Because SCIM group membership updates will overwrite any groups in a user's identity, assigning the same groups to each app ensures consistent policy evaluation.\n\n### 3. Verify SCIM provisioning\n\nTo check if user identities were updated in Cloudflare One, view your [SCIM provisioning logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\n## Optional configurations\n\n### Custom OIDC claims\n\nAll OIDC IdP integrations support the use of custom OIDC claims. Once configured, Access will add the claims to the [Access JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/) for consumption by your origin services. You can reference the custom OIDC claims in [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/), offering a means to control user access to applications based on custom identity attributes. Custom OIDC claims are not currently supported in Gateway policies.\n\nTo add a custom OIDC claim to an IdP integration:\n\n1. In your identity provider, ensure that the custom claim is included in your OIDC ID token.\n\n2. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n3. Under **Your identity providers**, find your identity provider and select **Edit**.\n\n4. Under **OIDC Claims**, enter the name of your custom claim (for example, `oid`).\n\n5. Select **Save**.\n\n6. Select **Test** and verify that the custom claim appears in `oidc_fields`. For example,",
      "language": "unknown"
    },
    {
      "code": "You can now build an Access policy for the custom claim using the **OIDC Claim** or **IdP OIDC Claim** selector. The custom claim will also be passed to origins behind Access in a [JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/#custom-saml-attributes-and-oidc-claims).\n\n#### Email claim\n\nYou can specify a custom **Email claim** name that Access will use to identify user emails. This is useful if your IdP does not return the standard `email` claim in the OIDC ID token.\n\n#### Multi-record OIDC claims\n\nCloudflare Access extends support for multi-record OIDC claims. These claims are parsed out and can be individually referenced in policies. This feature enables granular access control and precise user authorization in applications.\n\nCloudflare Access does not support partial OIDC claim value references or OIDC scopes.\n\n## Supported algorithms for generic OIDC tokens\n\nCloudflare supports the following algorithms for verifying generic OIDC tokens:\n\n* RS512\n* RS256\n* PS512\n* ES256\n* ES384\n* ES512\n\n</page>\n\n<page>\n---\ntitle: Generic SAML 2.0  Cloudflare One docs\ndescription: Cloudflare One integrates with any identity provider that supports\n  SAML 2.0. If your identity provider is not listed in the integration list of\n  login methods in Cloudflare One, it can be configured using SAML 2.0 (or\n  OpenID if OIDC based). Generic SAML can also be used if you would like to pass\n  additional SAML headers or claims for an IdP in the integration list.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/index.md\n---\n\nCloudflare One integrates with any identity provider that supports SAML 2.0. If your identity provider is not listed in the integration list of login methods in Cloudflare One, it can be configured using SAML 2.0 (or OpenID if OIDC based). Generic SAML can also be used if you would like to pass additional SAML headers or claims for an IdP in the integration list.\n\n## Prerequisites\n\nMinimum requirements for identity providers:\n\n* The IdP must conform to SAML 2.0.\n* The IdP must provide a **Single sign-on URL**, an **Entity ID or Issuer URL**, and a **Signing certificate**.\n* The IdP must include the signing public key in the SAML response.\n\n## 1. Create an application in your identity provider\n\nMost identity providers allow users to create an **Application**. In this context, an application is a set of parameters that the identity provider will then pass on to Cloudflare to establish an integration.\n\nThe typical setup requirements are:\n\n1. Create a new integration in the identity provider with the type set as **SAML**.\n\n2. Set both the **Entity/Issuer ID** and the **Single sign-on URL** to:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n3. Set the **Name ID/Email format** to `emailAddress`.\n\n4. (Optional) Set the signature policy to *Always Sign*.\n\n### (Optional) Upload SAML metadata\n\nIf your identity provider supports metadata file configuration, you can use the default or identity provider specific metadata endpoint:\n\n* **Default:** `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/saml-metadata`\n* **Identity provider specific:** `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/<identity-provider-id>/saml-metadata`, where `<identity-provider-id>` is the `id` value obtained from [List Access identity providers](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/methods/list/). Use this endpoint if your IdP requires a configuration not defined in the default metadata file.\n\nTo download the SAML metadata file, copy-paste the metadata endpoint into a web browser and save the page as an `.xml` file. Upload this XML file to the identity provider.\n\n## 2. Add a SAML identity provider to Cloudflare One\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n  2. Select **Add new identity provider** and select **SAML**.\n  3. Choose a descriptive name for your identity provider.\n  4. Enter the **Single Sign on URL**, **IdP Entity ID or Issuer URL**, and **Signing certificate** obtained from your identity provider.\n  5. (Optional) To enable SCIM, refer to [Synchronize users and groups](#synchronize-users-and-groups).\n  6. (Optional) Under **Optional configurations**, configure [additional SAML options](#optional-configurations).\n  7. Select **Save**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Organizations, Identity Providers, and Groups Write`\n\n  2. Configure the [`cloudflare_zero_trust_access_identity_provider`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_identity_provider) resource:",
      "language": "unknown"
    },
    {
      "code": "Warning\n\nSet a reminder for the expiry date of the signing certificate obtained from your generic SAML identity provider. After the certificate expires, you will need to generate a new signing certificate and re-add it to your Cloudflare configuration via the Cloudflare dashboard or Terraform.\n\n## 3. Test the connection\n\nYou can now [test the IdP integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one). A success response should return the configured SAML attributes.\n\n## Synchronize users and groups\n\nThe generic SAML integration allows you to synchronize user groups and automatically deprovision users using [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/).\n\n### Prerequisites\n\nYour identity provider must support SCIM version 2.0.\n\n### 1. Enable SCIM in Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Find the IdP integration and select **Edit**.\n\n3. Turn on **Enable SCIM**\n\n4. (Optional) Configure the following settings:\n\n* **Enable user deprovisioning**: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when they are removed from the SCIM application in IdP. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n* **Remove user seat on deprovision**: [Remove a user's seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) from your Cloudflare One account when they are removed from the SCIM application in IdP.\n\n* **SCIM identity update behavior**: Choose what happens in Cloudflare One when the user's identity updates in IdP.\n\n  * *Automatic identity updates*: Automatically update the [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/) when IdP sends an updated identity or group membership through SCIM. This identity is used for Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/); Access will read the user's updated identity when they reauthenticate.\n  * *Group membership change reauthentication*: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when their group membership changes in IdP. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). Access will read the user's updated group membership when they reauthenticate.\n  * *No action*: Update the user's identity the next time they reauthenticate to Access or WARP.\n\n1. Select **Regenerate Secret**. Copy the **SCIM Endpoint** and **SCIM Secret**. You will need to enter these values into IdP.\n\n2. Select **Save**.\n\nThe SCIM secret never expires, but you can manually regenerate the secret at any time.\n\n### 2. Configure SCIM in the IdP\n\nSetup instructions vary depending on the identity provider. In your identity provider, you will either need to edit the [original SSO application](#1-create-an-application-in-your-identity-provider) or create a new SCIM application. Refer to your identity provider's documentation for more details. For example instructions, refer to our [Okta](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/#synchronize-users-and-groups) or [JumpCloud](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/jumpcloud-saml/#synchronize-users-and-groups) guides.\n\n#### IdP groups\n\nIf you would like to build policies based on IdP groups:\n\n* Ensure that your IdP sends a `groups` field. The naming must match exactly (case insensitive). All other values will be sent as a SAML attribute.\n* If your IdP requires creating a new SCIM application, ensure that the groups in the SCIM application match the groups in the [original SSO application](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#1-create-an-application-in-your-identity-provider). Because SCIM group membership updates will overwrite any groups in a user's identity, assigning the same groups to each app ensures consistent policy evaluation.\n\n### 3. Verify SCIM provisioning\n\nTo check if user identities were updated in Cloudflare One, view your [SCIM provisioning logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\n## Optional configurations\n\nSAML integrations allow you to pass additional headers or claims to applications.\n\n### Sign SAML authentication request\n\nThis optional configuration signs the [Access JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/) with the Cloudflare Access public key to ensure that the JWT is coming from a legitimate source. The Cloudflare public key can be obtained at `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/certs`.\n\n### Email attribute name\n\nMany [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) depend on a user's email address. Some identity providers have a different naming for the email address attribute (for example, `Email`, `e-mail`, `emailAddress`). This can typically be checked in the identity provider's SAML test option.\n\nExample in Okta:\n\n![Preview the SAML assertion from the Okta dashboard](https://developers.cloudflare.com/_astro/saml-assertion.z-CnJcdz_ZwpCxn.webp)![Determine the email attribute name from the SAML assertion](https://developers.cloudflare.com/_astro/saml-attributes.B1LfosVi_uuOI7.webp)\n\n### SAML headers and attributes\n\nCloudflare Access supports SAML (Security Assertion Markup Language) attributes and SAML headers for all SAML IdP integrations.\n\n[**SAML attributes**](#saml-attributes) refer to specific data points or characteristics that the IdP shares about the authenticated user. These attributes often include details like email address, name, or role, and are passed along to the service provider upon successful authentication.\n\n[**SAML headers**](#saml-headers) are metadata in the SAML protocol communication which convey information about the sender, recipient, and the message itself. These headers can be leveraged to provide extra context or control over the communication.\n\n#### SAML attributes\n\nSAML attributes are added to the [Access JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/). These attributes can then be consumed by self-hosted or SaaS applications connected to Access. Any SAML attribute configured in the SAML integration must also be sent from the IdP.\n\nExample in Okta:\n\n![Configure Okta to send SAML attributes](https://developers.cloudflare.com/_astro/attribute-statements.CXJ3Jtln_jMOU2.webp)\n\nHow to receive these SAML attributes in Cloudflare:\n\n![Configure Cloudflare to receive SAML attributes](https://developers.cloudflare.com/_astro/attributes-cloudflare.Dpoa5y0H_Z29p53r.webp)\n\n#### SAML headers\n\nIf an application specifically requires SAML attributes upon sign-in, then the attributes can be passed as headers. The **Attribute name** should be the value coming from your IdP (for example, `department`). You can assign any **Header name** to the attribute. The header name will appear in the response headers when Access makes the initial authorization request to `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback`.\n\n#### Multi-record SAML attributes\n\nCloudflare Access extends support for multi-record SAML attributes such as groups. These attributes are parsed out and can be individually referenced in policies. This feature enables granular access control and precise user authorization in applications.\n\nCloudflare Access does not currently support partial attribute value references.\n\n</page>\n\n<page>\n---\ntitle: GitHub  Cloudflare One docs\ndescription: Cloudflare One allows your team to connect to your applications\n  using their GitHub login. You do not need to have a GitHub organization to use\n  the integration.\nlastUpdated: 2025-11-26T17:12:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/github/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/github/index.md\n---\n\nCloudflare One allows your team to connect to your applications using their GitHub login. You do not need to have a GitHub organization to use the integration.\n\n## Set up GitHub Access\n\nTo configure GitHub access in both GitHub and Cloudflare One:\n\n1. Log in to [GitHub](https://github.com/).\n\n2. Go to your account **Settings** > **Developer Settings**.\n\n3. In **Developer Settings**, select **OAuth Apps** and select **New OAuth app**.\n\n4. On the **Register a new OAuth application** page, enter an **Application name**. Your users will see this application name on the login page.\n\n5. In the **Homepage URL** field, enter your team domain:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n6. In the GitHub **Authorization callback URL** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "7. Select **Register application**.\n\n8. Find the **Client ID** and **Client Secret**.\n\n9. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n10. Select **Add new identity provider** and select **GitHub**.\n\n11. Choose **GitHub** on the next page.\n\n12. In the **App ID** field, copy and paste the **Client ID** you found in step 8. In the **Client secret** field, copy and paste the **Client secret** you found in step 8. You will need to select **Generate a new client secret** if one is not already displayed.\n\n13. Select **Save**.\n\nTo test that your connection is working, go to [Cloudflare One](https://one.dash.cloudflare.com) > **Integrations** > **Identity providers** and select **Test** next to your GitHub login method. If you have GitHub two-factor authentication enabled, you will need to first login to GitHub directly and return to Access.\n\nTroubleshooting organization policies\n\nWhen using a GitHub organization policy, if a user joins the required organization after a failed login attempt, they will remain blocked. To fix this, they must revoke the application's access in their GitHub settings and log in again to update their permissions.\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Google  Cloudflare One docs\ndescription: You can integrate Google authentication with Cloudflare Access\n  without a Google Workspace account. The integration allows any user with a\n  Google account to log in (if the Access policy allows them to reach the\n  resource). Unlike the instructions for Google Workspace, the steps below will\n  not allow you to pull group membership information from a Google Workspace\n  account.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/index.md\n---\n\nYou can integrate Google authentication with Cloudflare Access without a Google Workspace account. The integration allows any user with a Google account to log in (if the [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) allows them to reach the resource). Unlike the instructions for [Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google-workspace/), the steps below will not allow you to pull group membership information from a Google Workspace account.\n\nYou do not need to be a Google Cloud Platform user to integrate Google as an identity provider with Cloudflare One. You will only need to open the Google Cloud Platform to configure IdP integration settings.\n\n## Set up Google as an identity provider\n\n1. Log in to the Google Cloud Platform [console](https://console.cloud.google.com/). Create a new project, name the project, and select **Create**.\n\n2. On the project home page, go to **APIs & Services** and on the sidebar select **Credentials**.\n\n3. Select **Configure Consent Screen**.\n\n   ![Location to configure a Consent Screen in the Google Cloud Platform console.](https://developers.cloudflare.com/_astro/configure-consent-screen.ChcdZJTT_Z13MLL2.webp)\n\n4. To configure the consent screen:\n\n   1. Select **Get started**.\n   2. Enter an **App name** and a **User support email**.\n   3. Choose **External** as the Audience Type. Since this application is not being created in a Google Workspace account, any user with a Gmail address can log in.\n   4. Enter your **Contact Information**. Google Cloud Platform requires an email in your account.\n   5. Agree to Google's user data policy and select **Continue**.\n   6. Select **Create**.\n\n5. The OAuth overview page will load. On the OAuth overview screen, select **Create OAuth client**.\n\n   ![Location to create an OAuth client in the Google Cloud Platform console.](https://developers.cloudflare.com/_astro/create-oauth-client.BkzE5MZU_5zcR8.webp)\n\n6. Choose *Web application* as the **Application type** and give your OAuth Client ID a name.\n\n7. Under **Authorized JavaScript origins**, in the **URIs** field, enter your team domain:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n8. Under **Authorized redirect URIs**, in the **URIs** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "9. After creating the OAuth client, select the OAuth client that you just created. Google will present the **OAuth Client ID** value and **Client secret** value. The client secret field functions like a password and should not be shared. Copy both the **OAuth Client ID** value and **Client secret** value.\n\n10. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n11. Under **Your identity providers**, select **Add new identity provider**. Choose **Google** on the next page.\n\n12. Input the Client ID (**App ID** in the Cloudflare dashboard) and Client Secret fields generated previously.\n\n13. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/). PKCE will be performed on all login attempts.\n\n14. Select **Save**.\n\n## Test your connection\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to Google.\n\n## Example API Config",
      "language": "unknown"
    },
    {
      "code": "## Troubleshooting\n\n### `Error 401: deleted_client`\n\nIf you deleted the OAuth client (or the OAuth client expired) in Google, you will receive a `Error 401: deleted_client` authorization error.\n\nTo fix this issue, complete steps 6 through 12 in the [Google](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide and steps 9 through 15 in the [Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide.\n\n</page>\n\n<page>\n---\ntitle: JumpCloud (SAML)  Cloudflare One docs\ndescription: JumpCloud provides SSO identity management. Cloudflare Access\n  integrates with JumpCloud as a SAML identity provider.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/jumpcloud-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/jumpcloud-saml/index.md\n---\n\n[JumpCloud](https://jumpcloud.com/#platform) provides SSO identity management. Cloudflare Access integrates with JumpCloud as a SAML identity provider.\n\nThe following steps are specific to setting up JumpCloud with Cloudflare Access. For more information on configuring JumpCloud SSO application, refer to the [JumpCloud documentation](https://jumpcloud.com/support/integrate-with-cloudflare).\n\n## Set up Jumpcloud as a SAML provider\n\n### 1. Create an SSO application in JumpCloud\n\n1. In the [JumpCloud Admin Portal](https://console.jumpcloud.com/#/home), go to **SSO Applications**.\n\n2. Select **Add New Application**.\n\n3. In the search bar, enter `Cloudflare` and select the **Cloudflare Access** application.\n\n4. Select **Next**.\n\n5. In **Display Label**, enter an application name.\n\n6. Select **Save Application**.\n\n7. Review the application summary and select **Configure Application**.\n\n8. In the **SSO** tab, configure the following settings:\n\n   1. In **IdP Entity ID**, enter your Cloudflare team domain:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n   2. Set both **SP Entity ID** and **ACS URL** to the following callback URL:",
      "language": "unknown"
    },
    {
      "code": "3. (Optional) Configure SAML attributes that you want to send to Cloudflare Access.\n\n   4. Scroll up to **JumpCloud Metadata** and select **Export Metadata**. Save this XML file for use in a [later step](#2-add-jumpcloud-to-zero-trust).\n\n9. In the **User Groups** tab, [assign user groups](https://jumpcloud.com/support/get-started-applications-saml-sso#managing-employee-access-to-applications) to this application.\n\n10. Select **Save**.\n\n### 2. Add JumpCloud to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **SAML**.\n\n4. Upload your JumpCloud XML metadata file.\n\n5. (Optional) To enable SCIM, refer to [Synchronize users and groups](#synchronize-users-and-groups).\n\n6. (Optional) Under **Optional configurations**, configure [additional SAML options](#optional-configurations).\n\n7. Select **Save**.\n\nYou can now [test your connection](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) and create [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) based on the configured login method and SAML attributes.\n\n## Synchronize users and groups\n\nThe JumpCloud integration allows you to synchronize user groups and automatically deprovision users using [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/).\n\n### 1. Enable SCIM in Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Find the JumpCloud integration and select **Edit**.\n\n3. Turn on **Enable SCIM**\n\n4. (Optional) Configure the following settings:\n\n* **Enable user deprovisioning**: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when they are removed from the SCIM application in JumpCloud. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n* **Remove user seat on deprovision**: [Remove a user's seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) from your Cloudflare One account when they are removed from the SCIM application in JumpCloud.\n\n* **SCIM identity update behavior**: Choose what happens in Cloudflare One when the user's identity updates in JumpCloud.\n\n  * *Automatic identity updates*: Automatically update the [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/) when JumpCloud sends an updated identity or group membership through SCIM. This identity is used for Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/); Access will read the user's updated identity when they reauthenticate.\n  * *Group membership change reauthentication*: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when their group membership changes in JumpCloud. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). Access will read the user's updated group membership when they reauthenticate.\n  * *No action*: Update the user's identity the next time they reauthenticate to Access or WARP.\n\n1. Select **Regenerate Secret**. Copy the **SCIM Endpoint** and **SCIM Secret**. You will need to enter these values into JumpCloud.\n\n2. Select **Save**.\n\nThe SCIM secret never expires, but you can manually regenerate the secret at any time.\n\n### 2. Configure SCIM in JumpCloud\n\n1. In the [JumpCloud Admin Portal](https://console.jumpcloud.com/#/home), go to **SSO Applications**.\n2. Select the Cloudflare application that was created when you [Set up JumpCloud as a SAML provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/jumpcloud-saml/#set-up-jumpcloud-as-a-saml-provider).\n3. Select the **SSO** tab.\n4. To provision user groups, select **Include group attribute** and enter `groups`. The group attribute name has to exactly match `groups` or else it will be sent as a SAML attribute.\n5. Select the **Identity Management** tab.\n6. Make sure that **Enable management of User Groups and Group Membership in this application** is turned on.\n7. Select **Configure**.\n8. In the **Base URL** field, enter the **SCIM Endpoint** obtained from Cloudflare One.\n9. In the **Token Key** field, enter the **SCIM Secret** obtained from Cloudflare One.\n10. Select **Activate**. You will receive a confirmation that the Identity Management integration has been successfully verified.\n11. Select **Save**.\n\nTo check if user identities were updated in Cloudflare One, view your [SCIM provisioning logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\n### Provisioning attributes\n\nProvisioning attributes define the user and group properties that JumpCloud will synchronize with Cloudflare Access. By default, JumpCloud will send the following attributes during a SCIM update event:\n\n| JumpCloud user attribute | Cloudflare Access attribute |\n| - | - |\n| `email` | `email` |\n| `firstname` | `givenName` |\n| `lastname` | `surname` |\n\n| JumpCloud group attribute | Cloudflare Access attribute |\n| - | - |\n| `name` | `groups` |\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Google Workspace  Cloudflare One docs\ndescription: You can integrate a Google Workspace (formerly G Suite) account\n  with Cloudflare Access. Unlike the instructions for generic Google\n  authentication, the steps below will allow you to pull group membership\n  information from your Google Workspace account.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google-workspace/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google-workspace/index.md\n---\n\nNote\n\nThe Google Workspace IdP integration [is not supported](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#after-putting-google-workspace-behind-access-i-cant-log-in-it-keeps-redirecting-between-access-and-google-without-ever-completing-authentication) if your Google Workspace account is protected by Access.\n\nYou can integrate a Google Workspace (formerly G Suite) account with Cloudflare Access. Unlike the instructions for [generic Google authentication](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/), the steps below will allow you to pull group membership information from your Google Workspace account.\n\nOnce integrated, users will log in with their Google Workspace credentials to reach resources protected by Cloudflare Access or to enroll their device into Cloudflare Gateway.\n\nYou do not need to be a Google Cloud Platform user to integrate Google Workspace as an identity provider with Cloudflare One. You will only need to open the Google Cloud Platform to configure IdP integration settings.\n\n## Set up Google Workspace as an identity provider\n\n### 1. Configure Google Workspace\n\n1. Log in to the Google Cloud Platform [console](https://console.cloud.google.com/). This is separate from your Google Workspace console.\n\n2. A Google Cloud project is required to enable Google Workspace APIs. If you do not already have a Google Cloud project, go to **IAM & Admin** > **Create Project**. Name the project and select **Create**.\n\n3. Go to **APIs & Services** and select **Enable APIs and Services**. The API Library will load.\n\n4. In the API Library, search for `admin` and select **Admin SDK API**.\n\n5. **Enable** the Admin SDK API.\n\n6. Return to the **APIs & Services** page and go to **Credentials**.\n\n7. Select **Configure Consent Screen**.\n\n   ![Location to configure a Consent Screen in the Google Cloud Platform console.](https://developers.cloudflare.com/_astro/configure-consent-screen.ChcdZJTT_Z13MLL2.webp)\n\n8. To configure the consent screen:\n\n   1. Select **Get Started**.\n   2. Enter an **App name** and a **User support email**.\n   3. Choose **Internal** as the Audience Type. This Audience Type limits authorization requests to users in your Google Workspace and blocks users who have regular Gmail addresses.\n   4. Enter your **Contact Information**. Google Cloud Platform requires an email in your account.\n   5. Agree to Google's user data policy and select **Continue**.\n   6. Select **Create**.\n\n9. The OAuth overview page will load. Select **Create OAuth Client**.\n\n   ![Location to create an OAuth client in the Google Cloud Platform console.](https://developers.cloudflare.com/_astro/create-oauth-client.BkzE5MZU_5zcR8.webp)\n\n10. Choose *Web application* as the **Application type** and give your OAuth Client ID a name.\n\n11. Under **Authorized JavaScript origins**, in the **URIs** field, enter your team domain:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n12. Under **Authorized redirect URIs**, in the **URIs** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "13. After creating the OAuth client, select the OAuth client that you just created. Google will present the **OAuth Client ID** value and **Client secret** value. The client secret field functions like a password and should not be shared. Copy both the **OAuth Client ID** value and **Client secret** value.\n\n14. On your [Google Admin console](https://admin.google.com), go to **Security** > **Access and data control** > **API controls**.\n\n15. In **API Controls**, select **Settings**.\n\n16. Select **Internal apps** and check the box next to **Trust internal apps** to enable this option. The **Trust internal apps** setting is disabled by default and must be enabled for Cloudflare Access to work correctly.\n\n    ![Location to trust internal apps in the Google Cloud Platform console.](https://developers.cloudflare.com/_astro/trust-internal-apps.BFE-UHaC_2rdqa.webp)\n\n### 2. Add Google Workspace to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Select **Add new identity provider** and select **Google Workspace**.\n\n3. Input the Client ID (**App ID** in the Cloudflare dashboard) and Client Secret fields generated previously. Additionally, enter the domain of your Google Workspace account.\n\n4. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/). PKCE will be performed on all login attempts.\n\n5. (Optional) Under **Optional configurations**, enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to your user's identity.\n\n6. Select **Save**. To complete setup, you must visit the generated link. If you are not the Google Workspace administrator, share the link with the administrator.\n\n7. The generated link will prompt you to log in to your Google admin account and to authorize Cloudflare Access to view group information. After allowing permissions, you will see a success page from Cloudflare Access.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to Google Workspace. Your user identity and group membership should return.\n\nSCIM Provisioning (Beta)\n\nThe direct SCIM provisioning integration with Google Workspace is not currently supported. Cloudflare is working with Google to complete the final approval process required to enable this feature. In the meantime, the SCIM endpoint will accept inbound SCIM events from any SCIM compliant service.\n\nTo generate the SCIM endpoint, you must:\n\n1. Save your Google Workspace login method in Cloudflare One (step 6 above) and select **Back to Authentication** or return to **Integrations** > **Identity providers** in Cloudflare One.\n2. Find the Google Workspace login method you created > select **Edit**.\n3. Enable the **Enable SCIM** toggle.\n4. Select **Regenerate Secret**.\n\nThis will generate a **SCIM Endpoint** that can accept inbound SCIM events from any SCIM compliant service.\n\n`Failed to fetch group information from the identity provider` error\n\nTo test successfully, you must [finish setup](https://community.cloudflare.com/t/google-workspace-failed-to-fetch-group-information-from-the-identity-provider/313361/2). Testing before finishing setup will result in a [`Failed to fetch user/group information from the identity provider` error](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#i-am-getting-the-error-failed-to-fetch-usergroup-information-from-the-identity).\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "## Troubleshooting\n\n### `Error 401: deleted_client`\n\nIf you deleted the OAuth client (or the OAuth client expired) in Google, you will receive a `Error 401: deleted_client` authorization error.\n\nTo fix this issue, complete steps 6 through 12 in the [Google](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide and steps 9 through 15 in the [Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide.\n\n</page>\n\n<page>\n---\ntitle: Keycloak (SAML)  Cloudflare One docs\ndescription: Keycloak is an open source identity and access management solution\n  built by JBoss. If you need a Keycloak lab environment for testing, refer to\n  this example.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/keycloak/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/keycloak/index.md\n---\n\nKeycloak is an open source identity and access management solution built by JBoss. If you need a Keycloak lab environment for testing, refer to [this example](https://github.com/mw866/tunnel-keycloak).\n\n## Set up Keycloak (SAML)\n\nTo set up Keycloak (SAML) as your identity provider:\n\n1. In Keycloak, select **Clients** in the navigation bar and create a new client.\n\n2. Under **Client ID**, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n   ![SAML Client interface with team domain and callback in Client ID](https://developers.cloudflare.com/_astro/configure-client.gStYVFuK_Z1NJii6.webp)\n\n3. Change the `Name ID Format` to `email`\n\n4. Next, set the valid redirect URI to the Keycloak domain that you are using. For example, `https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/callback`.\n\n5. Set the Master SAML Processing URL using the same Keycloak domain: `https://<keycloak_domain>/auth/realms/master/protocol/saml`.\n\n6. If you wish to enable client signatures, enable `Client Signature Required` and select **save**.\n\n   1. You will need to [follow the steps here to get the certificate and enable it in the Cloudflare dashboard](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/signed_authn/).\n\n   2. Import the Access certificate you downloaded into the `SAML Keys` tab. Use `Certificate PEM` as the format.\n\n7. Set the built-in protocol mapper for the `email` property.\n\n   ![Protocol Mapper with email property set](https://developers.cloudflare.com/_astro/protocol-mapper.CZf2t0Ex_27FE3B.webp)\n\n   Next, you will need to integrate with Cloudflare Access.\n\n8. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n9. Under **Your identity providers**, select **Add new identity provider**.\n\n10. Choose **SAML** on the next page.\n\n    You will need to input the Keycloak details manually. The examples below should be replaced with the specific domains in use with Keycloak and Cloudflare Access.\n\n    | Field | Example |\n    | - | - |\n    | Single Sign-On URL | `https://<keycloak_domain>/auth/realms/master/protocol/saml` |\n    | IdP Entity ID or Issuer URL | `https://<unique_id>.cloudflareaccess.com/cdn-cgi/access/callback` |\n    | Signing certificate | Use the X509 Certificate in the Realm Settings from Keycloak |\n\n11. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the login method you want to test.\n\n</page>\n\n<page>\n---\ntitle: LinkedIn  Cloudflare One docs\ndescription: Cloudflare Access allows your users to use LinkedIn as their\n  identity provider (IdP).\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/linkedin/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/linkedin/index.md\n---\n\nCloudflare Access allows your users to use LinkedIn as their identity provider (IdP).\n\n## Prerequisites\n\nSign in to your LinkedIn account before continuing. Configuring LinkedIn as a Cloudflare Access IdP requires a LinkedIn account.\n\n## Set up LinkedIn as an IdP\n\nTo configure LinkedIn as an IdP:\n\n1. Go to the [LinkedIn Developer Portal](https://www.linkedin.com/developers).\n\n2. Select **Create App**.\n\n3. On the **Create an app** page, enter an **App name** for your application.\n\n4. Select a **LinkedIn Page** for your application or select **Create a new LinkedIn page** if you do not have a LinkedIn page.\n\n5. Select **Upload a logo** and upload your company logo image file.\n\n6. Select **API Terms of Use** to read the terms of use, and agree to the terms.\n\n7. Select **Create app**.\n\n8. In the **Products** tab of your LinkedIn application, select **Request Access** next to the **Sign In with LinkedIn using OpenID Connect** option.\n\n9. In the **Auth** tab of your LinkedIn application, find the **Client ID** and **Client Secret**.\n\n   ![LinkedIn account settings where you will copy the Client ID and Client Secret](https://developers.cloudflare.com/_astro/lin5.ovn9KSN7_v2VjA.webp)\n\n10. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n11. Under **Your identity providers**, select **Add new identity provider**.\n\n12. Select **LinkedIn** as your IdP.\n\n13. In the **App ID** field, copy and paste the **Client ID** from step 9. In the **Client secret** field, copy and paste the **Client secret** from step 9.\n\n14. Select **Save**.\n\n15. In the **Auth** tab of your LinkedIn application, go to **OAuth 2.0 settings** and select the pencil icon next to **Authorized redirect URLs for your app**.\n\n16. Enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\nTo test that your connection is working, go to [Cloudflare One](https://one.dash.cloudflare.com/) > **Integrations** > **Identity providers** > select **Test** next to your LinkedIn login method.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Okta  Cloudflare One docs\ndescription: Integrate Okta as an identity provider for Cloudflare One.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/index.md\n---\n\nOkta provides cloud software that helps companies manage and secure user authentication to modern applications, and helps developers build identity controls into applications, website web services, and devices. You can integrate Okta with Cloudflare One and build rules based on user identity and group membership. Cloudflare One supports Okta integrations using either the OIDC (default) or [SAML](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta-saml/) protocol.\n\nAdditionally, you can configure Okta to use risk information from Cloudflare One [user risk scores](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/) to create SSO-level policies. For more information, refer to [Send risk score to Okta](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/#send-risk-score-to-okta).\n\n## Prerequisites\n\n* A [Zero Trust Organization](https://developers.cloudflare.com/cloudflare-one/setup/) with any subscription tier (including Free)\n* A [Cloudflare One administrator role](https://developers.cloudflare.com/cloudflare-one/roles-permissions/) with `Access Edit` permissions\n\n## Supported features\n\n* **SP-initiated SSO**: When a user goes to an Access application, Access redirects them to sign in with Okta.\n* **SCIM provisioning**: Synchronize Okta groups and automatically deprovision users. SCIM currently requires a separate [custom OIDC application](#synchronize-users-and-groups).\n\n## Set up Okta as an OIDC provider (Okta App Catalog)\n\nActive Directory limitation\n\nThe Okta App Catalog template does not support synchronizing [Active Directory groups](https://help.okta.com/en-us/Content/Topics/Directory/ad-agent-import-groups.htm). If you would like to build policies using AD groups, use the Okta [OIDC app integration](#set-up-okta-as-an-oidc-provider-custom-app-integration) or [SAML app integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta-saml/).\n\nTo set up the Okta integration using the Okta Integration Network (OIN) App Catalog:\n\n1. Log in to your Okta admin dashboard.\n\n2. Go to **Applications** > **Applications**.\n\n3. Select **Browse App Catalog**.\n\n4. Search for `Cloudflare` and select the **Cloudflare One** app.\n\n5. Select **Add integration**.\n\n6. In **Application label**, enter a name for the application (for example, `Cloudflare Access`).\n\n7. In **Team domain**, enter your Cloudflare Zero Trust team name (only the subdomain prefix, do not include `.cloudflareaccess.com`):",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n8. In the **Sign On** tab, copy the **Client ID** and **Client secret** and paste these into `App ID` and `Client secret`.\n\n9. Copy your Okta Account URL (without the `-admin` value) and copy it into the Cloudflare Okta setup field.\n\n## Set up Okta as an OIDC provider (Custom App Integration)\n\n1. Log in to your Okta admin dashboard and go to **Applications** > **Applications**.\n\n2. Select **Create App Integration**.\n\n3. For the **Sign-in method**, select **OIDC - OpenID Connect**.\n\n   ![Creating an OIDC application in Okta](https://developers.cloudflare.com/_astro/okta-1.BlGKmCip_Z246AIu.webp)\n\n4. For the **Application type**, select **Web Application**. Select **Next**.\n\n5. Enter any name for the application. In the **Sign-in redirect URIs** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n6. Choose the desired **Assignment** option and select **Save**.\n\n7. From the application view, go to the **Sign On** tab.\n\n8. Scroll down to **OpenID ConnectID Token** and select **Edit**.\n\n   ![Configuring the Groups claim filter in Okta](https://developers.cloudflare.com/_astro/okta-2.BjmmVu1g_2uWaPO.webp)\n\n9. Set the **Groups claim filter** to *Matches regex* and its value to `.*`.\n\n   Note\n\n   Groups managed outside of Okta (for example, Microsoft Entra ID or Google groups) may require different regex values. For more information, refer to the Okta documentation on [Groups Claims](https://support.okta.com/help/s/article/Why-isnt-my-Groups-claim-returning-Active-Directory-groups) and [OpenID Connect Claims](https://support.okta.com/help/s/article/Can-we-retrieve-both-Active-Directory-and-Okta-groups-in-OpenID-Connect-claims).\n\n10. In the **General** tab, copy the **Client ID** and **Client secret**.\n\n    ![Finding your Client credentials in Okta](https://developers.cloudflare.com/_astro/okta-3.BzGr0OXt_Z219Iz4.webp)\n\n1) In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2) Under **Your identity providers**, select **Add new identity provider**. Select **Okta** as your identity provider.\n\n3) Fill in the following information:\n\n   * **Name**: Name your identity provider.\n   * **App ID**: Enter your Okta client ID.\n   * **Client secret**: Enter your Okta client secret.\n   * **Okta account URL**: Enter your [Okta domain](https://developer.okta.com/docs/guides/find-your-domain/main/), for example `https://my-company.okta.com`.\n\n4) (Optional) Create an Okta API token and enter it in [Cloudflare One](https://one.dash.cloudflare.com/) (the token can be read-only). This will prevent your Okta groups from failing if you have more than 100 groups.\n\n5) (Optional) To configure [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims):\n\n   1. In Okta, create a [custom authorization server](https://developer.okta.com/docs/guides/customize-authz-server/main/) and ensure that the `groups` scope is enabled.\n   2. In [Cloudflare One](https://one.dash.cloudflare.com/), enter the **Authorization Server ID** obtained from Okta.\n   3. Under **Optional configurations**, enter the claims that you wish to add to your users' identity.\n\n6) (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/). PKCE will be performed on all login attempts.\n\n7) Select **Save**.\n\nTo [test](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) that your connection is working, select **Test**.\n\n## Synchronize users and groups\n\nThe Okta integration allows you to synchronize IdP groups and automatically deprovision users using [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/). To enable SCIM provisioning between Access and Okta, you need two separate app integrations in Okta:\n\n* The OIDC application you created when adding Okta as an identity provider. You can create this application via the [Okta App Catalog](#set-up-okta-as-an-oidc-provider-okta-app-catalog) or via a [Custom App Integration](#set-up-okta-as-an-oidc-provider-custom-app-integration).\n* A second Okta application of type **SCIM 2.0 Test App (Header Auth)**. This is technically a SAML app but is responsible for sending user and group info via SCIM.\n\nNote\n\nIf you would like to only maintain one Okta app instance, Okta does support SAML and SCIM within the same application. Create a [generic SAML integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/) and configure those values in the **Sign-On** field of your Okta SCIM application.\n\n### 1. Enable SCIM in Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Find the Okta integration and select **Edit**.\n\n3. Turn on **Enable SCIM**\n\n4. (Optional) Configure the following settings:\n\n* **Enable user deprovisioning**: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when they are removed from the SCIM application in Okta. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n* **Remove user seat on deprovision**: [Remove a user's seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) from your Cloudflare One account when they are removed from the SCIM application in Okta.\n\n* **SCIM identity update behavior**: Choose what happens in Cloudflare One when the user's identity updates in Okta.\n\n  * *Automatic identity updates*: Automatically update the [User Registry identity](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/) when Okta sends an updated identity or group membership through SCIM. This identity is used for Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/); Access will read the user's updated identity when they reauthenticate.\n  * *Group membership change reauthentication*: [Revoke a user's active session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#per-user) when their group membership changes in Okta. This will invalidate all active Access sessions and prompt for reauthentication for any [WARP session policies](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/). Access will read the user's updated group membership when they reauthenticate.\n  * *No action*: Update the user's identity the next time they reauthenticate to Access or WARP.\n\n1. Select **Regenerate Secret**. Copy the **SCIM Endpoint** and **SCIM Secret**. You will need to enter these values into Okta.\n\n2. Select **Save**.\n\nThe SCIM secret never expires, but you can manually regenerate the secret at any time.\n\n### 2. Configure SCIM in Okta\n\n1. On your Okta admin dashboard, go to **Applications** > **Applications**.\n\n2. Select **Browse App Catalog**.\n\n3. Search for `SCIM Header Auth` and select **SCIM 2.0 Test App (Header Auth)**.\n\n4. Select **Add Integration**.\n\n5. On the **General Settings** tab, name your application and select **Next**.\n\n6. On the **Sign-on Options** tab, ensure that **SAML 2.0** is selected.\n\n7. Under **Credential Details**, set **Application username format** to either *Okta Username* or *Email*. This value will be used for the SCIM `userName` attribute.\n\n   Note\n\n   The `userName` attribute must match the user's email address in Cloudflare One.\n\n8. Select **Done** to create the integration.\n\n9. On the **Provisioning** tab, select **Configure API Integration**.\n\n10. Select **Enable API integration**.\n\n11. In the **Base URL** field, enter the **SCIM Endpoint** obtained from Cloudflare One.\n\n12. In the **API Token** field, enter the **SCIM Secret** obtained from Cloudflare One.\n\n    ![Enter SCIM values into Okta](https://developers.cloudflare.com/_astro/enter-scim-values.CxQEosHF_25svng.webp)\n\n13. Select **Test API Credentials** to ensure that the credentials were entered correctly. Select **Save**.\n\n14. On the **Provisioning** tab, select **Edit** and enable:\n\n    * **Create Users**\n    * **Update User Attributes**\n    * **Deactivate Users**\n\n    ![Configure provisioning settings in Okta](https://developers.cloudflare.com/_astro/enable-provisioning.CUZPrFdg_xM6l2.webp)\n\n15. In the **Assignments** tab, add the users you want to synchronize with Cloudflare Access. You can add users in batches by assigning a group. If a user is removed from the application assignment via a either direct user assignment or removed from the group that was assigned to the app, this will trigger a deprovisioning event from Okta to Cloudflare.\n\n16. In the **Push Groups** tab, add the Okta groups you want to synchronize with Cloudflare Access. These groups will display in the Access policy builder and are the group memberships that will be added and removed upon membership change in Okta.\n\n    Note\n\n    Groups in this SCIM app Push Groups integration should match the groups in your base [OIDC app integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/#set-up-okta-as-an-oidc-provider). Because SCIM group membership updates will overwrite any groups in a user's identity, assigning the same groups to each app ensures consistent policy evaluation.\n\nTo verify the integration, select **View Logs** in the Okta SCIM application.\n\nTo check if user identities were updated in Cloudflare One, view your [SCIM provisioning logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/).\n\nNote\n\nNew users must first [register the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) or authenticate to an Access application before SCIM provisioning can begin.\n\n## Example API Configuration",
      "language": "unknown"
    },
    {
      "code": "## Troubleshooting\n\n### Failed to fetch user/group information from the identity\n\nIf you see the error `Failed to fetch user/group information from the identity`, double-check your Okta configuration:\n\n* If you have more than 100 Okta groups, ensure you include the API token.\n* The request may be blocked by the [ThreatInsights feature](https://help.okta.com/en/prod/Content/Topics/Security/threat-insight/ti-index.htm) within Okta.\n\n</page>\n\n<page>\n---\ntitle: Okta (SAML)  Cloudflare One docs\ndescription: Integrate Okta as a SAML identity provider with Cloudflare One.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta-saml/index.md\n---\n\nCloudflare One can integrate SAML with Okta as an identity provider.\n\n## Set up Okta as a SAML provider\n\nTo set up SAML with Okta as your identity provider:\n\n1. On your Okta admin dashboard, go to **Applications** > **Applications**.\n\n2. Select **Create App Integration**.\n\n3. In the pop-up dialog, select **SAML 2.0** and then elect **Next**.\n\n4. Enter an app name and select **Next**.\n\n   ![Entering your Cloudflare One callback URL into Okta](https://developers.cloudflare.com/_astro/okta-saml-1.BO9WudzS_2mBicN.webp)\n\n5. In the **Single sign on URL** and the **Audience URI (SP Entity ID)** fields, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n6. In the **Attribute Statements** section, enter the following information:\n\n   * **Name**: Enter `email`.\n   * **Value**: Enter `user.email`.\n\n7. (Optional) If you are using Okta groups, create a **Group Attribute Statement** with the following information:\n\n   * **Name**: Enter `groups`.\n   * **Filter**: Select *Matches regex* and enter `.*`.\n\n![Configuring attribute statements in Okta](https://developers.cloudflare.com/_astro/okta-saml-2.BkDiypq5_1gEsSA.webp)\n\n1. Select **Next**.\n\n2. Select **I'm an Okta customer adding an internal app** and check **This is an internal app that we have created**.\n\n![Configuring feedback options in Okta](https://developers.cloudflare.com/_astro/okta-saml-3.-GrxFq28_6b1N9.webp)\n\n1. Select **Finish**.\n\n2. In the **Assignments** tab, select **Assign** and assign individuals or groups you want to grant access to.\n\n3. Select **Done**. The assigned individuals and groups will display in the **Assignments** tab.\n\n![Assigning individuals and groups to Okta application](https://developers.cloudflare.com/_astro/okta-saml-4.CrMrhldk_JD3rd.webp)\n\n1. To retrieve the SAML provider information, go to the **Sign On** tab and select **View Setup Instructions**. A new page will open showing the **Identity Provider Single Sign-on URL**, **Identity Provider Issuer**, and **X.509 Certificate**. Save this information for configuring your Cloudflare One settings.\n\n![Retrieving SAML provider information in Okta](https://developers.cloudflare.com/_astro/okta-saml-5.CWJU56SQ_80iNi.webp)\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity provider**.\n\n2. Under **Your identity providers**, select **Add new identity provider**, and select *SAML*.\n\n3. Fill in the following information:\n\n   * **Name**: Name your identity provider.\n   * **Single Sign On URL**: Enter the Identity Provider Single-Sign-On URL from Okta.\n   * **Issuer ID**: Enter the Identity Provider Issuer from Okta, for example `http://www.okta.com/<your-okta-entity-id>`.\n   * **Signing Certificate**: Copy-paste the X.509 Certificate from Okta.\n\n4. (Recommended) Enable **Sign SAML authentication request**.\n\n5. (Recommended) Under **SAML attributes**, add the `email` and `groups` attributes. The `groups` attribute is required if you want to create policies based on [Okta groups](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/#okta-saml).\n\n![Adding optional SAML attributes in Cloudflare One](https://developers.cloudflare.com/_astro/okta-saml-6.4pq9o6NF_awYpQ.webp)\n\n1. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to Okta. A success response should return the configured SAML attributes.\n\nWarning\n\nSAML attributes are only refreshed during authentications with the Okta identity provider. This means the Okta group membership is not updated unless a user logs in and out of the WARP client, or logs in to an Access application.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: One-time PIN login  Cloudflare One docs\ndescription: Cloudflare Access can send a one-time PIN (OTP) to approved email\n  addresses as an alternative to integrating an identity provider. You can\n  simultaneously configure OTP login and the identity provider of your choice to\n  allow users to select their own authentication method.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/index.md\n---\n\nCloudflare Access can send a one-time PIN (OTP) to approved email addresses as an alternative to integrating an identity provider. You can simultaneously configure OTP login and the identity provider of your choice to allow users to select their own authentication method.\n\nFor example, if your team uses Okta but you are collaborating with someone outside your organization, you can use OTP to grant access to guests.\n\nNote\n\nAccess and WARP will evaluate identity based on a user's last-known state. If a user authenticates via your Identity Provider, but later authenticates with a different method (such as One-Time PIN), Access will no longer evaluate the user's Identity Provider group memberships. Identity Provider group memberships are created and managed by the IdP and group membership data can only persist in an IdP-based authentication.\n\n## Set up OTP\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n  2. Under **Your identity providers**, select **Add new identity provider**.\n  3. Select **One-time PIN**.\n\n* API\n\n  Make a `POST` request to the [Identity Providers](https://developers.cloudflare.com/api/resources/zero_trust/subresources/identity_providers/methods/create/) endpoint:\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Access: Organizations, Identity Providers, and Groups Write`",
      "language": "unknown"
    },
    {
      "code": "* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Organizations, Identity Providers, and Groups Write`\n\n  2. Configure the [`cloudflare_zero_trust_access_identity_provider`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_identity_provider) resource:",
      "language": "unknown"
    },
    {
      "code": "Tip\n\nIf your organization uses a third-party email scanning service (for example, Mimecast or Barracuda), add `noreply@notify.cloudflare.com` to the email scanning allowlist.\n\nTo grant a user access to an application, simply add their email address to an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/#create-a-policy).\n\n## Log in with OTP\n\nTo log in to Access using the one-time PIN:\n\n1. Go to the application protected by Access.\n2. On the Access login page, enter your email address and select **Send me a code**. ![Enter email to sign in with OTP.](https://developers.cloudflare.com/_astro/otp1.uhxnR_Si_Zsczob.webp)\n3. If the email is allowed by an Access policy, you will receive a PIN in your inbox. This secure PIN expires 10 minutes after the initial request.\n\nNote\n\nBy design, blocked users will not receive an email. The login page will always say **A code has been emailed to you**, regardless of whether or not an email was sent.\n\n1. Paste the PIN into the Access login page and select **Sign in**. ![Enter PIN to sign in.](https://developers.cloudflare.com/_astro/otp2.GG9Vuvxx_Zp26Xz.webp)\n\n   * If the code was valid, you will be redirected to the application.\n   * If the code was invalid, you will see **That account does not have access.**\n\nNote\n\nAccess only logs an authentication attempt after the user enters a code. If the user enters their email but never submits a code, the event will not appear in your [audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/#authentication-logs).\n\n</page>\n\n<page>\n---\ntitle: OneLogin  Cloudflare One docs\ndescription: OneLogin provides SSO identity management. Cloudflare Access\n  supports OneLogin as an OIDC identity provider.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/onelogin-oidc/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/onelogin-oidc/index.md\n---\n\nOneLogin provides SSO identity management. Cloudflare Access supports OneLogin as an OIDC identity provider.\n\n## Set up OneLogin as an OIDC provider\n\n### 1. Create an application in OneLogin\n\n1. Log in to your OneLogin admin portal.\n\n2. Go to **Applications** > **Applications** and select **Add App**.\n\n3. Search for `OIDC` and select **OpenId Connect (OIDC)** by OneLogin, Inc.\n\n4. In **Display Name**, enter any name for your application. Select **Save**.\n\n5. Next, go to **Configuration**. In the **Redirect URI** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n6. Select **Save**.\n\n7. Go to **Access** and choose the **Roles** that can access this application. Select **Save**.\n\n8. Go to **SSO** and select **Show client secret**.\n\n9. Copy the **Client ID** and **Client Secret**.\n\n### 2. Add OneLogin to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **OneLogin**.\n\n4. Fill in the following information:\n\n   * **Name**: Name your identity provider.\n   * **App ID**: Enter your OneLogin client ID.\n   * **Client secret**: Enter your OneLogin client secret.\n   * **OneLogin account URL**: Enter your OneLogin domain, for example `https://<your-domain>.onelogin.com`.\n\n5. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#synchronize-users-and-groups).\n\n6. (Optional) Under **Optional configurations**, enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to your user's identity.\n\n7. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to OneLogin.\n\n## Example API Config",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: OneLogin (SAML)  Cloudflare One docs\ndescription: Integrate OneLogin as a SAML identity provider for Cloudflare One.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/onelogin-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/onelogin-saml/index.md\n---\n\nOneLogin provides SSO identity management. Cloudflare Access supports OneLogin as an SAML identity provider.\n\n## Set up OneLogin as a SAML provider\n\n## 1. Create an application in OneLogin\n\n1. Log in to your OneLogin admin portal.\n\n2. Select **Apps** > **Add Apps**.\n\n3. Under **Find Applications**, search for **Cloudflare Access**.\n\n4. Select the result sponsored by **Cloudflare, Inc**. You can customize the name or logo.\n\n5. Select **Save**. You can change this information at any time.\n\n6. Select the **Configuration** tab.\n\n7. In the **Cloudflare Access Authorization Domain** field, paste your team domain:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n8. Select the **Parameters** tab, select **Add Parameter** and enter your values for **Cloudflare Access Field**.\n\n9. Select the **Access** tab\n\n10. In Roles, use the mapping to programmatically and automatically assign users that can access the application.\n\n    ![OneLogin SAML Application Access interface with available Roles listed](https://developers.cloudflare.com/_astro/onelogin-saml-6.72q8OCR8_28aiIa.webp)\n\n11. Select the **SSO** tab.\n\n12. Copy the OneLogin **SAML 2.0 Endpoint (HTTP)** to the Cloudflare Single Sign On URL.\n\n13. Copy the OneLogin **Issuer URL** to the Cloudflare **IdP Entity ID**.\n\n14. Copy the **X.509 Certificate** to the Cloudflare **Signing Certificate**.\n\n    ![OneLogin SAML Application SSO interface with SAML2.0 sign on method, Issuer URL, and X.509 Certificate](https://developers.cloudflare.com/_astro/onelogin-saml-7.DF0eCD1C_2gxV2X.webp)\n\n### 2. Add OneLogin to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **SAML**.\n\n4. Input the details from your OneLogin account in the fields.\n\n5. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#synchronize-users-and-groups).\n\n6. (Optional) Under **Optional configurations**, configure [additional SAML options](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#optional-configurations). If you added other SAML headers and attribute names to OneLogin, be sure to add them to Cloudflare.\n\n7. Select **Save**.\n\nTo test that your connection is working, go to **Integrations** > **Identity providers** and select **Test** next to the login method you want to test.\n\n## Download SP metadata (optional)\n\nOneLogin SAML allows administrators to upload metadata files from the service provider.\n\nTo add a metadata file to your OneLogin SAML configuration:\n\n1. Download your unique SAML metadata file at the following URL:",
      "language": "unknown"
    },
    {
      "code": "2. Save the file as an XML document.\n\n3. Upload the XML document to **OneLogin**.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: PingFederate  Cloudflare One docs\ndescription: The PingFederate offering from PingIdentity provides SSO identity\n  management. Cloudflare Access supports PingFederate as a SAML identity\n  provider.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingfederate-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingfederate-saml/index.md\n---\n\nThe PingFederate offering from PingIdentity provides SSO identity management. Cloudflare Access supports PingFederate as a SAML identity provider.\n\n## Set up PingFederate as an identity provider\n\n1. Log in to your **Ping** dashboard and go to **Applications**.\n\n2. Select **Add Application**.\n\n3. Select **New SAML Application**.\n\n4. Complete the fields for name, description, and category.\n\nThese can be any value. A prompt displays to select a signing certificate to use.\n\n1. In the **SAML attribute configuration** dialog select **Email attribute** > **urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress**.\n\n2. Go to **SP Connections** > **SP Connection** > **Credentials**.\n\n3. Add the matching certificate that you upload into the Cloudflare SAML configuration for Ping. Select **Include the certificate in the signature `<KEYINFO>` element**.\n\nNote\n\nThere is an additional setting for PingFederate prior to 9.0.\n\n1. In the **Signature Policy** tab, disable the option to **Always Sign Assertion**.\n\n2. Leave the option enabled for **Sign Response As Required**.\n\nThis ensures that SAML destination headers are sent during the integration.\n\nIn versions 9.0 above, you can leave both of these options enabled.\n\n1. A prompt displays to download the SAML metadata from Ping.\n\nThis file shares several fields with Cloudflare Access so you do not have to input this data.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select SAML.\n\n4. In the **IdP Entity ID** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n1. Fill the other fields with values from your Ping dashboard.\n\n2. Select **Save**.\n\nTo test that your connection is working, go to **Authentication** > **Login methods** and select **Test** next to the login method you want to test.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: PingOne  Cloudflare One docs\ndescription: The PingOne cloud platform from PingIdentity provides SSO identity\n  management. Cloudflare Access supports PingOne as an OIDC identity provider.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingone-oidc/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingone-oidc/index.md\n---\n\nThe PingOne cloud platform from PingIdentity provides SSO identity management. Cloudflare Access supports PingOne as an OIDC identity provider.\n\n## Set up PingOne as an OIDC provider\n\n### 1. Create an application in PingOne\n\n1. In your PingIdentity environment, go to **Connections** > **Applications**.\n\n2. Select **Add Application**.\n\n3. Enter an **Application Name**.\n\n4. Select **OIDC Web App** and then **Save**.\n\n5. Select **Resource Access** and add the **email** and **profile** scopes.\n\n6. In the **Configuration** tab, select **General**.\n\n7. Copy the **Client ID**, **Client Secret**, and **Environment ID** to a safe place. These IDs will be used in a later step to add PingOne to Cloudflare One.\n\n8. In the **Configuration** tab, select the pencil icon.\n\n9. In the **Redirect URIs** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n10. Select **Save**.\n\n### 2. Add PingOne to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n2. Under **Your identity providers**, select **Add new identity provider**.\n3. Select **PingOne**.\n4. Input the **Client ID**, **Client Secret**, and **Environment ID** generated previously.\n5. (Optional) Enable [Proof of Key Exchange (PKCE)](https://www.oauth.com/oauth2-servers/pkce/). PKCE will be performed on all login attempts.\n6. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#synchronize-users-and-groups).\n7. (Optional) Under **Optional configurations**, enter [custom OIDC claims](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/#custom-oidc-claims) that you wish to add to your users' identity.\n8. Select **Save**.\n\nYou can now [test your connection](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) and create [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) based on the configured login method.\n\n## Example API configuration",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: PingOne (SAML)  Cloudflare One docs\ndescription: Learn how to integrate PingOne as a SAML identity provider with Cloudflare One.\nlastUpdated: 2025-10-28T17:07:12.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingone-saml/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/pingone-saml/index.md\n---\n\nThe PingOne cloud platform from PingIdentity provides SSO identity management. Cloudflare Access supports PingOne as a SAML identity provider.\n\n## Set up PingOne as a SAML provider\n\n## 1. Create an application in PingOne\n\n1. In your PingIdentity environment, go to **Connections** > **Applications**.\n\n2. Select **Add Application**.\n\n3. Enter an **Application Name**.\n\n4. Select **SAML Application**.\n\n5. Select **Configure**.\n\n6. To fill in your Cloudflare Access metadata:\n\n   1. Select **Import from URL**.\n   2. Set the **Import URL** to:",
      "language": "unknown"
    },
    {
      "code": "where `<your-team-name>` is your Cloudflare One team name. 3. Select **Import**. 4. **Save** the configuration.\n\n7. In the **Configuration** tab, select **Download metadata** and save the XML metadata file. This file will be used in a later step to add PingOne to Cloudflare One.\n\n8. In the **Attribute Mappings** tab, add the following required attributes (case sensitive) and select **Save**.\n\n   | Application attribute | Outgoing value |\n   | - | - |\n   | `email` | Email Address |\n   | `givenName` | Given Name |\n   | `surName` | Family Name |\n\n   These [SAML attributes](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#saml-attributes) tell Cloudflare Access who the user is.\n\n9. Set the application to **Active**.\n\n### 2. Add PingOne to Cloudflare One\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Select **SAML**.\n\n4. Upload your PingOne XML metadata file.\n\n5. (Optional) To enable SCIM, refer to [Synchronize users and groups](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#synchronize-users-and-groups).\n\n6. (Optional) Under **Optional configurations**, configure [additional SAML options](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/#optional-configurations).\n\n7. Select **Save**.\n\nYou can now [test your connection](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/#test-idps-in-cloudflare-one) and create [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) based on the configured login method and SAML attributes.\n\n</page>\n\n<page>\n---\ntitle: Signed AuthN requests (SAML)  Cloudflare One docs\ndescription: In a SAML request flow, Cloudflare Access functions as the service\n  provider (SP) to the identity provider (IdP). Cloudflare Access sends a SAML\n  request to your IdP. The signing certificate that you upload from your SAML\n  provider verifies the response.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/signed_authn/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/signed_authn/index.md\n---\n\nIn a SAML request flow, Cloudflare Access functions as the service provider (SP) to the identity provider (IdP). Cloudflare Access sends a SAML request to your IdP. The signing certificate that you upload from your SAML provider verifies the response.\n\nIn some cases, administrators need to verify that the request from the SP is authentic. By validating both the requests from the SP and the responses from the IdP, teams can ensure that operations in the SAML relationship are signed in both directions.\n\nCloudflare Access supports this requirement in the form of Signed AuthN requests. When enabled, Access sends a signature embedded in an HTTP POST request that contains the AuthN details.\n\n## Set up Signed AuthN requests\n\nTo set up Signed AuthN requests:\n\n1. In Cloudflare One, go to **Integrations** > **Identity providers**.\n\n2. Under **Your identity providers**, select **Add new identity provider**.\n\n3. Choose **SAML** on the next page.\n\n4. Complete the fields in the dialog.\n\n5. Go to this URL to find the certificate:",
      "language": "unknown"
    },
    {
      "code": "Ensure that your IdP validation uses the most recent certificate. Cloudflare Access routinely rotates the public key as a security measure.\n\n   Cloudflare Access uses a certificate that includes the following 2 distinguished name fields:\n\n   * **Issuer Distinguished Name** - `CN=cloudflareaccess.com, C=US, ST=Texas, L=Austin, O=Cloudflare`\n   * **Subject Distinguished Name** - `CN=*.cloudflareaccess.com, C=US, ST=Texas, L=Austin, O=Cloudflare`\n\n   Most IdP configurations require 3 components to enforce AuthN signature verification:\n\n   * **Certificate issuer [distinguished name (DN)](https://knowledge.digicert.com/generalinformation/INFO1745.html)**\n   * **Certificate subject distinguished name**\n   * **Public certificate**\n\n6. In your IdP account, replace your authorization domain with the team domain generated by Cloudflare Access.\n\n   This is an example format:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Yandex  Cloudflare One docs\ndescription: Yandex is a web search engine that also offers identity provider\n  (IdP) services.\nlastUpdated: 2025-11-24T22:12:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/yandex/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/yandex/index.md\n---\n\nYandex is a web search engine that also offers identity provider (IdP) services.\n\n## Set up Yandex\n\nTo set up Yandex for Cloudflare Access:\n\n1. Log in to your Yandex account.\n\n2. Select **Open a new OAuth Application**.\n\n3. Select **New client**.\n\n4. Complete the required fields.\n\n5. Choose **Yandex.Passport API** to set the basic scopes.\n\n6. Select the **Access to email address**, **Access to user avatar,** and **Access to username, first name and surname, gender** options.\n\n7. Select **Platform** and select **Web Services.**\n\n8. In the **Callback URL #1** field, enter the following URL:",
      "language": "unknown"
    },
    {
      "code": "You can find your team name in [Cloudflare One](https://one.dash.cloudflare.com) under **Settings** > **Team name and domain** > **Team name**.\n\n   ![Yandex Platform interface with Web services checked and callback URI in open form field](https://developers.cloudflare.com/_astro/yandex-3.DteBNxdB_1r0dEp.webp)\n\n9. Select **Add**.\n\n10. Scroll to the **Platforms** card, and select **Submit**.\n\n    **Yandex OAuth** card titled **Cloudflare Access App** displays.\n\n11. Copy the **ID** and **Password**.\n\n12. In Cloudflare One, go to **Integrations** > **Identity providers**.\n\n13. Under **Your identity providers**, select **Add new identity provider**.\n\n14. Select Yandex.\n\n15. Paste the ID and password in the appropriate fields.\n\n16. Select **Save**.\n\n## Example API Config",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: CrowdStrike  Cloudflare One docs\ndescription: Cloudflare One can integrate with Crowdstrike to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from Crowdstrike.\n  Devices are identified by their serial numbers. If multiple devices have the\n  same serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-23T02:03:04.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/crowdstrike/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/crowdstrike/index.md\n---\n\nCloudflare One can integrate with Crowdstrike to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Crowdstrike. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\nDevice posture with Crowdstrike requires:\n\n* Falcon Enterprise plan or above\n\n* Crowdstrike agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## Set up CrowdStrike as a service provider\n\n### 1. Obtain CrowdStrike settings\n\nThe following CrowdStrike values are needed to set up the CrowdStrike posture check:\n\n* Client ID\n* Client Secret\n* Base URL\n* Customer ID\n\nTo retrieve those values:\n\n1. Log in to your Falcon Dashboard.\n\n2. Go to **Support and resources** > **API Clients and Keys**.\n\n3. Select **Create API client** and enter any name for the client.\n\n4. Turn on the following API permissions:\n\n   | Scope | Permission |\n   | - | - |\n   | Hosts | Read |\n   | Zero Trust Assessment | Read |\n\n5. Select **Create**.\n\n6. Copy the **Client ID**, **Client Secret**, and **Base URL** to a safe place.\n\n7. Go to **Host setup and management** > **Sensor downloads** and copy your **Customer ID**.\n\n### 2. Add CrowdStrike as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Crowdstrike**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client ID** and **Client secret** you noted down above.\n2) In **Rest API URL**, enter your **Base URL**.\n3) Enter your **Customer ID**.\n4) Choose a **Polling frequency** for how often Cloudflare Zero Trust should query CrowdStrike for information.\n5) Select **Test and save**.\n\n### 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Crowdstrike provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nDevice posture data is gathered from the [CrowdStrike Zero Trust Assessment APIs](https://falcon.us-2.crowdstrike.com/documentation/156/zero-trust-assessment-apis). To learn more about how scores are calculated, refer to the [CrowdStrike Zero Trust Assessment](https://falcon.us-2.crowdstrike.com/documentation/138/zero-trust-assessment) documentation.\n\n| Selector | Description | Value |\n| - | - | - |\n| OS | OS signal score | `1` to `100` |\n| Overall | Overall ZTA score | `1` to `100` |\n| Sensor config | Sensor signal score | `1` to `100` |\n| Version | ZTA score version | `2.1.0` |\n| State | Current online status of the device | *Online*, *Offline*, or *Unknown* |\n| Last seen | Elapsed time since the device was last seen. Only returned if its state is `online` or `unknown`. | In the last 1 hour, 3 hours, 6 hours, 12 hours, 24 hours, 7 days, 30 days, or more than 30 days |\n\n</page>\n\n<page>\n---\ntitle: Kolide  Cloudflare One docs\ndescription: Cloudflare One can integrate with Kolide to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from Kolide. Devices\n  are identified by their serial numbers. If multiple devices have the same\n  serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/kolide/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/kolide/index.md\n---\n\nCloudflare One can integrate with Kolide to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Kolide. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\n* Kolide agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## Set up Kolide as a service provider\n\n### 1. Create a Client Secret in Kolide\n\n1. Log in to your Kolide dashboard.\n2. Select your profile and go to **Settings** > **Developers**.\n3. Select **Create New Key**.\n4. Enter a **Key Name** and select **Save**.\n5. Copy the **Secret token** to a safe place. This will be your Client Secret.\n\n### 2. Add Kolide as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Kolide**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client secret** you noted down above.\n2) Choose a **Polling frequency** for how often Cloudflare One should query Kolide for information.\n3) Select **Test and save**.\n\n### 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Kolide provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nDevice posture data is gathered from the [Kolide K2 API](https://kolidek2.readme.io/reference/get_issues).\n\n| Selector | Description |\n| - | - |\n| Issue count | Total number of issues detected on the device |\n\n</page>\n\n<page>\n---\ntitle: Custom device posture integration  Cloudflare One docs\ndescription: Configure custom device posture checks in Cloudflare One using a\n  service-to-service integration.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/custom/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/custom/index.md\n---\n\nCloudflare One allows you to enforce custom device posture checks on your applications. This involves configuring a WARP service-to-service integration that periodically calls the external API of your choice, whether it is a third-party endpoint provider or a home built solution. When called, the API will receive device identifying information from Cloudflare and be expected to return a value between `0` to `100`. You can then set up a device posture check that determines if the returned value counts as a pass or fail; for example, you could allow access to a user only if their device has a posture value greater than `60`.",
      "language": "unknown"
    },
    {
      "code": "## External API requirements\n\nThe custom service provider integration works with any API service that meets the following specifications. For an example of a custom device posture integration API, refer to our [Cloudflare Workers sample code](https://github.com/cloudflare/custom-device-posture-integration-example-worker).\n\n### Authentication\n\nThe WARP client authenticates to the external API through Cloudflare Access. The external API should [validate the application token](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/) issued by Cloudflare Access to ensure that any requests which bypass Access (for example, due to a network misconfiguration) are rejected.\n\n### Data passed to external API\n\nCloudflare will pass the following parameters to the configured API endpoint. You can use this data to identify the device and assign a posture score. For some devices, not all identifying information will apply, in which case the field will be blank. A maximum of 1,000 devices will be sent per a request.\n\n| Field | Description |\n| - | - |\n| `device_id` | Device UUID assigned by the WARP client |\n| `email` | Email address used to authenticate the WARP client |\n| `serial_number` | Device serial number |\n| `mac_address` | Device MAC address |\n| `virtual_ipv4` | Device virtual IPv4 address |\n| `hostname` | Device name |\n\nNote\n\nDevices are identified by their serial numbers. You must ensure that each of your devices has a unique serial number. If multiple devices have the same serial number, Cloudflare and your external API will not be able to accurately match them.\n\nExample request body:",
      "language": "unknown"
    },
    {
      "code": "### Expected response from external API\n\nFor each Cloudflare `device_id`, the API service is expected to return a posture score and optionally a third-party device ID.\n\n| Field | Description |\n| - | - |\n| `s2s_id` | Third party device ID (empty string if unavailable) |\n| `score` | Integer value between `0` - `100` |\n\nExample response body:",
      "language": "unknown"
    },
    {
      "code": "## Set up custom device posture checks\n\n### 1. Create a service token\n\nWARP uses an Access Client ID and Access Client Secret to securely authenticate to the external API. If you do not already have an Access Client ID and Access Client Secret, [create a new service token](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/#create-a-service-token).\n\n### 2. Create an Access application\n\nNext, secure the external API behind Cloudflare Access so that WARP can authenticate with the service token. To add the API endpoint to Access:\n\n1. [Create a self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) for your API endpoint.\n\n2. Add the following Access policy to the application. Make sure that **Action** is set to *Service Auth* (not *Allow*).\n\n   | Action | Rule type | Selector | Value |\n   | - | - | - | - |\n   | Service Auth | Include | Service Token | `<TOKEN-NAME>` |\n\n### 3. Add a service provider integration\n\nTo create a custom service-to-service integration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Custom service provider**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) In **Access client ID** and **Access client secret**, enter the Access service token used to authenticate to your external API.\n2) In **Rest API URL**, enter the external API endpoint that Cloudflare will query for posture information (for example, `https://api.example.com`). For more information, refer to [External API requirements](#external-api-requirements).\n3) In **Polling frequency**, choose how often Cloudflare One should query the external API for information.\n4) Select **Test and save**. The test checks if Cloudflare can authenticate to the API URL using the provided Access credentials.\n\nNext, [configure a device posture check](#4-configure-the-posture-check) to determine if a given posture score constitutes a pass or fail.\n\n### 4. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Custom service provider provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\n| Selector | Description | Value |\n| - | - | - |\n| Score | Posture score returned by external API | `0` to `100` |\n\n</page>\n\n<page>\n---\ntitle: Microsoft Endpoint Manager  Cloudflare One docs\ndescription: Cloudflare One can integrate with Microsoft to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from Microsoft.\n  Devices are identified by their serial numbers. If multiple devices have the\n  same serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/microsoft/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/microsoft/index.md\n---\n\nCloudflare One can integrate with Microsoft to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Microsoft. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\nDevice posture with Microsoft Endpoint Manager requires:\n\n* An Intune license\n\n* Microsoft Endpoint Manager is managing the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## 1. Obtain Microsoft Graph settings\n\nThe following values are required:\n\n* Client secret\n* Application (client) ID\n* Direct (tenant) ID\n\nTo retrieve those values:\n\n1. Log in to your Microsoft Dashboard.\n2. Go to **App Registrations** and select **New Registrations**.\n3. Copy the `Application (client) ID` value to a safe place. This will be your Client ID.\n4. Copy the `Directory (tenant) ID` value to a safe place. This will be your Customer ID.\n5. Go to **Certificates & Secrets** and select **New client secret**.\n6. Fill in a description and how long the secret should be valid.\n7. After completing the form, immediately copy the resulting secret. This will be your Client Secret.\n8. Go to **API Permissions** and select **Add permission**.\n9. Select **Microsoft Graph**.\n10. Select **Application permissions**.\n11. Add `DeviceManagementManagedDevices.Read.All`.\n12. If the permission status shows **Not granted**, select **Grant admin consent**.\n\n## 2. Add Intune as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Microsoft Endpoint Manager**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client ID**, **Client secret** and **Customer ID** as you noted down above.\n2) Select a **Polling frequency** for how often Cloudflare One should query Microsoft Graph API for information.\n3) Select **Test and save**.\n\n## 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Microsoft Endpoint Manager provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nThe Microsoft Endpoint Manager device posture check relies on information from the Microsoft Graph API. Refer to Microsoft's [ComplianceState](https://docs.microsoft.com/en-us/graph/api/resources/intune-devices-compliancestate?view=graph-rest-1.0) and [List managedDevices](https://docs.microsoft.com/en-us/graph/api/intune-devices-manageddevice-list?view=graph-rest-1.0) documentation for a list of properties returned by the API.\n\nTo learn more about how to control ComplianceState, refer to Microsoft's [compliance policies guide](https://docs.microsoft.com/en-us/mem/intune/protect/device-compliance-get-started).\n\n</page>\n\n<page>\n---\ntitle: SentinelOne - Posture checks  Cloudflare One docs\ndescription: Cloudflare One can integrate with SentinelOne to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from SentinelOne.\n  Devices are identified by their serial numbers. If multiple devices have the\n  same serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/index.md\n---\n\nCloudflare One can integrate with SentinelOne to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from SentinelOne. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\n* SentinelOne agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## Set up SentinelOne as a service provider\n\n### 1. Obtain SentinelOne settings\n\nThe following SentinelOne values are needed to set up the SentinelOne posture check:\n\n* API Token\n* REST API URL\n\nTo retrieve those values:\n\n1. Log in to your SentinelOne Dashboard.\n2. Go to **Settings** > **Users** > **Create new Service User**.\n3. Select **Create New Service User**.\n4. Enter a **Name** and **Expiration Date** and select **Next**.\n5. Set **Scope of Access** to *Viewer*.\n6. Select **Create User**. SentinelOne will generate an API Token for this user.\n7. Copy the **API Token** to a safe location.\n8. Select **Close**.\n9. Copy the **Rest API URL** from your browser's address bar (for example, `https://<S1-DOMAIN>.sentinelone.net`).\n\n### 2. Add SentinelOne as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **SentinelOne**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) In **Client Secret**, enter your **API Token**.\n2) In **Rest API URL**, enter `https://<S1-DOMAIN>.sentinelone.net`.\n3) Choose a **Polling frequency** for how often Cloudflare One should query SentinelOne for information.\n4) Select **Test and save**.\n\n### 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the SentinelOne provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nDevice posture data is gathered from the SentinelOne Management APIs. For more information, refer to `https://<S1-DOMAIN>.sentinelone.net/api-doc/overview`.\n\n| Selector | Description |\n| - | - |\n| Infected | Whether the device is infected |\n| Active Threats | Number of active threats on the device |\n| Is Active | Whether the SentinelOne Agent is active |\n| Network status | Whether the SentinelOne Agent is connected to the SentinelOne service |\n| Operational State | The [operational state](https://community.sentinelone.com/s/login/?ec=302\\&startURL=%2Fs%2Farticle%2F000005285) of the SentinelOne Agent. |\n\n### Detect user risk behavior\n\nSentinelOne provides endpoint detection and response (EDR) signals to determine [user risk score](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/). User risk scores allow you to detect users that present security risks to your organization. For more information, refer to [Predefined risk behaviors](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/#predefined-risk-behaviors).\n\n</page>\n\n<page>\n---\ntitle: Tanium - Posture checks  Cloudflare One docs\ndescription: Cloudflare One can integrate with Tanium to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from Tanium. Devices\n  are identified by their serial numbers. If multiple devices have the same\n  serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/taniums2s/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/taniums2s/index.md\n---\n\nCloudflare One can integrate with Tanium to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Tanium. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\n* Either Tanium Cloud or on-premise installations of Tanium with the Benchmark entitlement\n\n* Tanium agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## Set up Tanium as a service provider\n\n### 1. Get Tanium settings\n\nThe following Tanium values are needed to set up the Tanium posture check:\n\n* Client Secret\n* REST API URL\n\nTo retrieve the client secret, create an API token:\n\n1. Log in to your Tanium instance.\n2. Go to **Administration** > **API Tokens**.\n3. Select **New API Token**.\n4. Set **Expire in days** to an appropriate value for your organization. When this token expires, all device posture results will begin to fail unless updated.\n5. Set **Trusted IP addresses** to `0.0.0.0/0`.\n6. Select **Save**.\n7. Copy the **Client Secret** to a safe place.\n\nTo retrieve the API URL, determine your Tanium Gateway root endpoint:\n\n* Tanium Cloud: `https://<customerName>-api.cloud.tanium.com/plugin/products/gateway/graphql`\n* Tanium On Prem: `https://<server>/plugin/products/gateway/graphql`\n\n### 2. Add Tanium as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Tanium**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client Secret** and **REST API URL** you noted down above.\n2) Choose a **Polling frequency** for how often Cloudflare One should query Tanium for information.\n3) Select **Test and save**.\n\n### 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Tanium provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nDevice posture data is gathered from [Tanium's EndpointRisk API](https://developer.tanium.com/site/global/apis/graphql/spectaql/index.gsp#definition-EndpointRisk). To learn more about how scores are calculated, refer to the [Tanium risk score documentation](https://help.tanium.com/bundle/ug_benchmark_cloud/page/benchmark/risk_score.html).\n\n| Selector | Description | Value |\n| - | - | - |\n| Total score | `totalScore` of the device. | `1` to `1000` |\n| Risk level | `riskLevel` of the device. | Low, medium, high, or critical |\n| EID last seen | Elapsed time since the device was last seen, based on its `datetime` attribute. | In the last 1 hour, 3 hours, 6 hours, 12 hours, 24 hours, 7 days, 30 days, or more than 30 days |\n\n</page>\n\n<page>\n---\ntitle: Uptycs  Cloudflare One docs\ndescription: Cloudflare One can integrate with Uptycs to require that users\n  connect to certain applications from managed devices. This service-to-service\n  posture check uses the WARP client to read endpoint data from Uptycs. Devices\n  are identified by their serial numbers. If multiple devices have the same\n  serial number, Cloudflare cannot accurately match a WARP device with a\n  third-party provider device. You must ensure that each of your devices has a\n  unique serial number.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/uptycs/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/uptycs/index.md\n---\n\nCloudflare One can integrate with Uptycs to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Uptycs. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\n* Uptycs agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## 1. Obtain Uptycs Settings\n\nThe following Uptycs values are needed to set up the Uptycs posture check:\n\n* Client key\n* Client Secret\n* Customer ID\n\nTo obtain these values:\n\n1. Open your Uptycs console.\n2. Go to **Account Settings** > **API Key**.\n3. Generate and download your `.json` file. This file will contain your **Client key**, **Client Secret** and **Customer ID**.\n\n## 2. Add Uptycs as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Uptycs**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client ID**, **Client secret** and **Customer ID** as you noted down above.\n2) Select a **Polling frequency** for how often Cloudflare One should query Uptycs for information.\n3) Select **Test and save**.\n\n## 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Uptycs provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\n| Selector | Description |\n| - | - |\n| Score | Zero Trust score assigned to the device by Uptycs |\n\n</page>\n\n<page>\n---\ntitle: Workspace ONE  Cloudflare One docs\ndescription: Cloudflare One can integrate with Workspace ONE to require that\n  users connect to certain applications from managed devices. This\n  service-to-service posture check uses the WARP client to read endpoint data\n  from Workspace ONE. Devices are identified by their serial numbers. If\n  multiple devices have the same serial number, Cloudflare cannot accurately\n  match a WARP device with a third-party provider device. You must ensure that\n  each of your devices has a unique serial number.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/workspace-one/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/workspace-one/index.md\n---\n\nCloudflare One can integrate with Workspace ONE to require that users connect to certain applications from managed devices. This service-to-service posture check uses the WARP client to read endpoint data from Workspace ONE. Devices are identified by their serial numbers. If multiple devices have the same serial number, Cloudflare cannot accurately match a WARP device with a third-party provider device. You must ensure that each of your devices has a unique serial number.\n\n## Prerequisites\n\n* Workspace ONE agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Service providers](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/).\n\n## 1. Obtain Workspace ONE Settings\n\nThe following Workspace ONE values are needed to set up the Workspace ONE posture check:\n\n* ClientID\n* Client Secret\n* REST API URL\n* Region-Specific token URL\n\nTo retrieve those values:\n\n1. Log in to your Workspace ONE dashboard.\n2. Go to **Groups & Settings** > **Configurations**.\n3. Enter `OAuth` in the search bar labeled **Enter a name or category**.\n4. Select **OAuth Client Management** in the results. The OAuth Client Management screen displays.\n5. Select **Add**.\n6. Enter values for the **Name**, **Description**, **Organization Group**, and **Role**.\n7. Ensure that the **Status** is **Enabled**.\n8. Select **Save**.\n9. Copy the **Client ID** and **Client Secret** to a safe place.\n10. To obtain your REST API URL, gp tp **Groups & Settings** > **All Settings** > **System** > **Advance** > **Site URLs** > **REST API URL**.\n11. Retrieve the Region-Specific Token URL from Workspace ONE and copy it to a safe place.\n\n## 2. Add Workspace ONE as a service provider\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Service providers**.\n2. Select **Add new**.\n3. Select **Workspace ONE**.\n4. Enter any name for the provider. This name will be used throughout the dashboard to reference this connection.\n\n1) Enter the **Client ID** and **Client secret** you noted down above.\n2) Select a **Polling frequency** for how often Cloudflare One should query Workspace ONE for information.\n3) Enter the **Region-specific token URL** and **REST API URL** you noted down above.\n4) Select **Test and save**.\n\n## 3. Configure the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks** > **Service provider checks**.\n2. Select **Add a check**.\n3. Select the Workspace ONE provider.\n4. Enter any name for the posture check.\n5. Configure the [attributes](#device-posture-attributes) required for the device to pass the posture check.\n6. Select **Save**.\n7. To test, go to **Insight** > **Logs** > **Posture logs** and verify that the service provider posture check is returning the expected results.\n\nYou can now use this posture check in a [device posture policy](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#3-build-a-device-posture-policy).\n\n## Device posture attributes\n\nWorkspace ONE posture checks work with the [Compliance flags](https://docs.vmware.com/en/VMware-Workspace-ONE-UEM/services/UEM_Managing_Devices/GUID-CompliancePolicies.html) in Workspace ONE. All compliance tests must pass for the device to be considered compliant.\n\n</page>\n\n<page>\n---\ntitle: Cloudflare Tunnel  Cloudflare One docs\ndescription: Cloudflare Tunnel provides you with a secure way to connect your\n  resources to Cloudflare without a publicly routable IP address. With Tunnel,\n  you do not send traffic to an external IP  instead, a lightweight daemon in\n  your infrastructure (cloudflared) creates outbound-only connections to\n  Cloudflare's global network. Cloudflare Tunnel can connect HTTP web servers,\n  SSH servers, remote desktops, and other protocols safely to Cloudflare. This\n  way, your origins can serve traffic through Cloudflare without being\n  vulnerable to attacks that bypass Cloudflare.\nlastUpdated: 2025-12-19T21:52:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/index.md\n---\n\nCloudflare Tunnel provides you with a secure way to connect your resources to Cloudflare without a publicly routable IP address. With Tunnel, you do not send traffic to an external IP  instead, a lightweight daemon in your infrastructure (`cloudflared`) creates [outbound-only connections](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/#outbound-only-connection) to Cloudflare's global network. Cloudflare Tunnel can connect HTTP web servers, [SSH servers](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/), [remote desktops](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/rdp/), and other protocols safely to Cloudflare. This way, your origins can serve traffic through Cloudflare without being vulnerable to attacks that bypass Cloudflare.\n\nRefer to our [reference architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/) for details on how to implement Cloudflare Tunnel into your existing infrastructure.\n\n## How it works\n\nCloudflared establishes [outbound connections](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/#outbound-only-connection) (tunnels) between your resources and Cloudflare's global network. Tunnels are persistent objects that route traffic to DNS records. Within the same tunnel, you can run as many 'cloudflared' processes (connectors) as needed. These processes will establish connections to Cloudflare and send traffic to the nearest Cloudflare data center.\n\n![How an HTTP request reaches a private application connected with Cloudflare Tunnel](https://developers.cloudflare.com/_astro/handshake.eh3a-Ml1_1IcAgC.webp)\n\n## Outbound-only connection\n\nCloudflare Tunnel uses an outbound-only connection model to enable bidirectional communication. When you install and run `cloudflared`, `cloudflared` initiates an outbound connection through your firewall from the origin to the Cloudflare global network.\n\nOnce the connection is established, traffic flows in both directions over the tunnel between your origin and Cloudflare. Most firewalls allow outbound traffic by default. `cloudflared` takes advantage of this standard by connecting out to the Cloudflare network from the server you installed `cloudflared` on. You can then configure your firewall to allow only these outbound connections and block all inbound traffic, effectively blocking access to your origin from anything other than Cloudflare. This setup ensures that all traffic to your origin is securely routed through the tunnel.\n\n## Next steps\n\n* Create a tunnel using the [Cloudflare dashboard](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/) or [API](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel-api/).\n* Learn more about [`cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/downloads/), the server-side daemon that connects your infrastructure to Cloudflare.\n* Review useful [Tunnel terms](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/tunnel-useful-terms/) to familiarize yourself with the concepts used in Tunnel documentation.\n* [Troubleshoot](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/troubleshoot-tunnels/) your Tunnel by reviewing available logs and common errors.\n\n</page>\n\n<page>\n---\ntitle: Overview  Cloudflare One docs\ndescription: Magic WAN provides secure, performant connectivity and routing for\n  your entire corporate networking, reducing cost and operation complexity.\n  Magic Firewall integrates smoothly with Magic WAN, enabling you to enforce\n  network firewall policies at Cloudflare's global network, across traffic from\n  any entity within your network.\nlastUpdated: 2025-10-31T13:37:27.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/index.md\n---\n\nImprove security and performance for your entire corporate networking, reducing cost and operation complexity.\n\nEnterprise-only\n\nMagic WAN provides secure, performant connectivity and [routing](https://www.cloudflare.com/learning/network-layer/what-is-routing/) for your entire corporate networking, reducing cost and operation complexity. [Magic Firewall](https://developers.cloudflare.com/magic-firewall/) integrates smoothly with Magic WAN, enabling you to enforce network firewall policies at Cloudflare's global network, across traffic from any entity within your network.\n\nWith Magic WAN, you can securely connect any traffic source - data centers, offices, devices, cloud properties - to Cloudflare's network and configure routing policies to get the bits where they need to go, all within one SaaS solution.\n\nMagic WAN supports a variety of on-ramps including any device that supports anycast GRE or IPsec tunnels.\n\nRefer to [On-ramps](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/on-ramps/) for a full list of supported on-ramps.\n\nLearn how to [get started](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/get-started/).\n\n***\n\n## Features\n\n### Connect your network automatically\n\nUse Magic WAN Connector to automatically connect, steer, and shape any IP traffic.\n\n[Use Magic WAN Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/configuration/appliances/)\n\n### Connect your network manually\n\nMagic WAN is compatible with a host of third-party devices. If you do not have Magic WAN Connector, start here to learn how to set up Magic WAN manually.\n\n[Use a third-party device](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/configuration/manually/third-party/)\n\n### Zero Trust integration\n\nLearn how you can use Magic WAN with other Cloudflare Zero Trust products.\n\n[Integrate with other Zero Trust products](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/zero-trust/)\n\n### BGP peering\n\nUse BGP peering between your networks and Cloudflare to automate the process of adding or removing networks and subnets, and take advantage of failure detection and session recovery features.\n\n[Use BGP peering](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/configuration/manually/how-to/configure-routes/#configure-bgp-routes)\n\n***\n\n## Related products\n\n**[Magic Firewall](https://developers.cloudflare.com/magic-firewall/)**\n\nMagic Firewall is a firewall-as-a-service (FWaaS) delivered from the Cloudflare global network to protect office networks and cloud infrastructure with advanced, and scalable protection.\n\n**[Cloudflare Network Interconnect](https://developers.cloudflare.com/network-interconnect/)**\n\nCloudflare Network Interconnect (CNI) allows you to connect your network infrastructure directly with Cloudflare - rather than using the public Internet - for a more reliable and secure experience.\n\n**[Load Balancing](https://developers.cloudflare.com/load-balancing/)**\n\nCloudflare Load Balancing distributes traffic across your endpoints, which reduces endpoint strain and latency and improves the experience for end users.\n\n***\n\n## More resources\n\n[Reference Architecture](https://developers.cloudflare.com/reference-architecture/architectures/sase/)\n\nDeep dive into key architecture and functionalities aspects of Cloudflare One, and learn more about Magic WAN and its structure.\n\n</page>\n\n<page>\n---\ntitle: DNS  Cloudflare One docs\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/index.md\n---\n\n* [Locations](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/)\n* [DNS over TLS (DoT)](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-tls/)\n* [DNS over HTTPS (DoH)](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-https/)\n\n</page>\n\n<page>\n---\ntitle: Proxy endpoints  Cloudflare One docs\ndescription: \"Proxy endpoints allow you to apply Gateway policies without\n  installing a client on your devices. By configuring a Proxy Auto-Configuration\n  (PAC) file at the browser level, you can route traffic through Gateway for\n  filtering and policy enforcement. Cloudflare supports configuring two types of\n  proxy endpoints: identity-based authorization endpoints and source IP proxy\n  endpoints.\"\nlastUpdated: 2025-12-12T22:32:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/index.md\n---\n\nNote\n\nPAC files are only available on Enterprise plans.\n\n[Authorization endpoints](#authorization-endpoint) and [PAC file hosting](#create-a-hosted-pac-file) are in beta for Enterprise plans. To opt in, contact your account team.\n\nProxy endpoints allow you to apply Gateway policies without installing a client on your devices. By configuring a Proxy Auto-Configuration (PAC) file at the browser level, you can route traffic through Gateway for filtering and policy enforcement. Cloudflare supports configuring two types of proxy endpoints: identity-based [authorization endpoints](#authorization-endpoint) and [source IP proxy endpoints](#source-ip-endpoint).\n\nA PAC file is a file containing a JavaScript function which can instruct a browser to forward traffic to a proxy server instead of directly to the destination server.\n\nWhen end users visit a website, their browser sends the request to a Cloudflare proxy server associated with your account to be filtered by Gateway. PAC files are evaluated by the browser for every request, determining whether traffic should go through the proxy or connect directly. Note that Gateway [cannot filter every type of HTTP traffic](#traffic-limitations) proxied using PAC files.\n\nPAC files offer several advantages:\n\n* **Centralized management**: Update routing rules in one location without reconfiguring individual devices\n* **Flexible routing**: Route different traffic types to different proxies or direct connections based on domain, IP range, or protocol\n* **Load balancing**: Distribute traffic across multiple proxy servers with automatic failover\n\nNote\n\nPAC files require user interaction. Authorization endpoints require users to log in through [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). PAC files do not support username/password or mTLS authorization.\n\n## Types of proxy endpoints\n\nCloudflare One offers two types of proxy endpoints, each with different authorization methods.\n\nOnce you create a proxy endpoint, you cannot change its type. If you need a different authorization method, you must create a new proxy endpoint.\n\n### Authorization endpoint Beta\n\nAuthorization endpoints use [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to provide Zero Trust authorization. Users must authenticate through an identity provider and pass Access policies before they can use the proxy endpoint.\n\nUse authorization endpoints when:\n\n* You need user-level authentication and identity-based policies\n* You want to associate specific users with their proxy traffic\n* Your organization requires login through identity providers (such as Okta, Microsoft Entra ID, or Google Workspace)\n* You need granular control over who can access the proxy\n\n### Source IP endpoint\n\nSource IP endpoints authorize traffic based on the originating IP address. Only traffic from pre-configured IP addresses can use the proxy endpoint.\n\nUse source IP endpoints when:\n\n* You have a fixed set of office or network locations\n* You want simpler setup without user authentication\n* Your devices share a common egress IP address\n* You do not need to identify individual users\n\n## 1. Create a proxy endpoint\n\nWarning\n\nAll devices you add to the proxy endpoint can access your Cloudflare Tunnel applications and services. If you only want to proxy web traffic, [create a Network policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/#restrict-private-network-access-to-proxy-endpoint-users) that restricts proxy endpoint traffic from connecting to your internal resources.\n\n* Dashboard\n\n  Authorization endpoint\n\n  To add an [authorization endpoint](#authorization-endpoint):\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies**, then go to **Proxy endpoints**.\n  2. In **Proxy endpoints**, select **Add an endpoint**.\n  3. Choose **Add an authorization endpoint**.\n  4. Name your endpoint.\n  5. Add [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to control who can access your applications. You can select existing policies or create new policies.\n  6. Choose which login methods to support. To accept all login methods, turn on **Accept all available identity providers**.\n  7. (Optional) If only one identity provider is configured, turn on **Instant Auth** to skip identity provider selection when your users reach the proxy endpoint.\n  8. Select **Create**.\n\n  Source IP endpoint\n\n  To add a [source IP endpoint](#source-ip-endpoint):\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies**, then go to **Proxy endpoints**.\n\n  2. In **Proxy endpoints**, select **Add an endpoint**.\n\n  3. Choose **Add a source IP endpoint**.\n\n  4. Name your endpoint.\n\n  5. Add the source IP addresses of your devices in CIDR notation. For example:\n\n     * **IPv4**: `192.0.2.0/8`\n     * **IPv6**: `2001:0db8:0000:0000:0000:1234:5678:0000/32`\n\n  6. Select **Save endpoint**.\n\n* API\n\n  Authorization endpoint\n\n  To create an authorization endpoint:\n\n  1. Use [Create a Proxy Endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/proxy_endpoints/methods/create/) with the following call:",
      "language": "unknown"
    },
    {
      "code": "2. The response returns output similar to the following:",
      "language": "unknown"
    },
    {
      "code": "Note the `subdomain` value returned by the API. You will use this to create the Access application.\n\n  3. Use [Add An Access Application](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/applications/methods/create/) to associate the proxy endpoint with Access policies:\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Access: Apps and Policies Write`",
      "language": "unknown"
    },
    {
      "code": "Replace `<SUBDOMAIN>` with the subdomain from step 2 and `<ACCESS_POLICY_ID>` with the ID of an existing [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/).\n\n  Source IP endpoint\n\n  To create a source IP endpoint:\n\n  1. Use [Create A Proxy Endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/proxy_endpoints/methods/create/) with the following call:",
      "language": "unknown"
    },
    {
      "code": "Replace `<PUBLIC_IP>` with the source IP address of your device in CIDR notation. For example:\n\n     * **IPv4**: `192.0.2.0/8`\n     * **IPv6**: `2001:0db8:0000:0000:0000:1234:5678:0000/32`\n\n     Note\n\n     Gateway limits the prefix length of source networks for proxy endpoints to `/8` for IPv4 networks and `/32` for IPv6 networks.\n\n  2. The response returns output similar to the following:",
      "language": "unknown"
    },
    {
      "code": "Note the `subdomain` value returned by the API. Your Cloudflare proxy server domain is of the form:",
      "language": "unknown"
    },
    {
      "code": "In the example above, the subdomain is `3ele0ss56t` and the proxy server domain is `3ele0ss56t.proxy.cloudflare-gateway.com`.\n\n## 2. Create a PAC file\n\nA PAC file is a text file written in JavaScript that specifies which traffic should redirect to the proxy server. You can create a PAC file in the Cloudflare dashboard or write your own custom PAC file.\n\nTip\n\nFor detailed instructions and examples for creating a PAC file, refer to [PAC file best practices](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/best-practices/).\n\n### Create a hosted PAC file Beta\n\nWhen you create a PAC file in Cloudflare One, Cloudflare will host it in a publicly accessible Worker. Hosted PAC files are automatically distributed through Cloudflare's global network.\n\nTo create a hosted PAC file:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies**.\n\n2. Select **Proxy endpoints**.\n\n3. [Create a proxy endpoint](#1-create-a-proxy-endpoint) or select an existing one, then select **Edit**.\n\n4. Select **Add PAC files**.\n\n5. Configure your PAC file:\n\n   In **PAC file details**:\n\n   1. Enter the **Basic Information**, including a name and optional description.\n   2. (Optional) Customize the **URL slug** to create a memorable URL path. The slug cannot be changed after creation.\n   3. In **PAC file configuration**, select **Browse PAC file configuration templates** and choose a pre-configured template to customize. The available templates are Okta and Azure. After you select a template, **PAC file JavaScript** will populate with the selected template.\n   4. Modify the JavaScript as needed to match your network requirements.\n\n   In **Setup instructions**:\n\n   1. Choose a browser.\n   2. Follow the instructions in Cloudflare One to configure devices.\n\n6. Select **Create**.\n\nYour hosted PAC file URL will be:",
      "language": "unknown"
    },
    {
      "code": "Where:\n\n* `<account-id>` is your [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/)\n* `<slug>` is the customizable path you specified (or an auto-generated value if not customized)\n\n#### Hosted PAC file limits\n\nCloudflare-hosted PAC files have the following limits:\n\n* **Maximum file size**: 256 KB per PAC file\n* **Maximum PAC files per account**: 100\n* **Update propagation**: Changes to PAC files propagate within seconds to minutes across the global network\n\n#### Caching behavior\n\nHosted PAC files are cached globally for performance and reliability:\n\n* Browsers and operating systems may cache PAC files locally based on their own policies\n* Updates to hosted PAC files automatically invalidate the cache\n* If you need to force clients to fetch a new version, you may need to clear browser caches or restart browsers depending on the client configuration\n\n### Self-hosting PAC files\n\nYou can also host PAC files on your own infrastructure, such as an internal web server or [Cloudflare Workers](https://developers.cloudflare.com/workers/). Self-hosting gives you complete control over the hosting environment but requires you to manage availability and distribution.\n\n## 3. Configure your devices\n\n### 3a. Install Cloudflare certificate\n\nTo use Gateway HTTP policies with proxy endpoints, you must [install a Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on your devices. This allows Gateway to inspect HTTPS traffic and apply policies such as blocking specific domains or displaying the Gateway block page.\n\n### 3b. Configure browser to use PAC file\n\nAll major browsers support PAC files. You can configure individual browsers, or you can configure system settings that apply to all browsers on the device. Multiple devices can call the same PAC file as long as their source IP addresses were included in the proxy endpoint configuration.\n\nChromium-based browsers\n\nChromium-based browsers (such as Google Chrome, Microsoft Edge, and Brave) rely on your operating system's proxy server settings. To configure your browser to use Gateway with PAC files, refer to the [macOS](https://support.apple.com/guide/mac-help/mchlp2591/mac) or [Windows](https://support.microsoft.com/windows/use-a-proxy-server-in-windows-03096c53-0554-4ffe-b6ab-8b1deee8dae1) documentation.\n\nMozilla Firefox\n\n1. In Firefox, go to **Settings** and scroll down to **Network Settings**.\n2. Select **Settings**.\n3. Select **Automatic proxy configuration URL**.\n4. Enter the URL where your PAC file is hosted, for example `https://proxy-pac.cflr.workers.dev/3ele0ss56t.pac`.\n5. Select **OK**. HTTP traffic from Firefox is now being filtered by Gateway.\n\nSafari\n\nSafari relies on your operating system's proxy server settings. To configure your browser to use Gateway with PAC files, refer to the [macOS documentation](https://support.apple.com/guide/mac-help/mchlp2591/mac).\n\n## 4. Test your HTTP policy\n\nTo test your configuration, create an [HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to block a test domain. When you visit the blocked domain in your browser, you should see the Gateway block page.\n\nYou can now use the Proxy Endpoint selector in [network](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#proxy-endpoint) and [HTTP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#proxy-endpoint) policies to filter traffic proxied via PAC files.\n\n## 5. (Optional) Configure firewall\n\nYou may need to configure your organization's firewall to allow your users to connect to a proxy endpoint. Depending on your firewall, you will need to create a rule using either your proxy endpoint's domain or IP addresses.\n\nTo get the domain of a proxy endpoint:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies** > **Proxy endpoints**.\n  2. Choose the proxy endpoint. Select **Edit**.\n  3. In **Proxy Endpoint**, copy the domain.\n\n* API\n\n  1. Use the [List proxy endpoints](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/proxy_endpoints/methods/list/) operation to get a list of your proxy endpoints and their details. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "2. Find the proxy endpoint you want to use.\n\n  3. Copy the value of the `subdomain` key.\n\nUsing your proxy endpoint's domain, you can get the IP addresses assigned to the proxy endpoint:\n\n* macOS and Linux\n\n  1. Open a terminal.\n\n  2. Run `dig` on your proxy endpoint's A records to get its IPv4 addresses. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "3. Run `dig` on your proxy endpoint's AAAA records to get its IPv6 addresses. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "* Windows\n\n  1. Open a PowerShell terminal.\n\n  2. Run `Resolve-DnsName` on your proxy endpoint's A records. Your proxy endpoint's IPv4 addresses will appear under `IPAddress`. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "3. Run `Resolve-DnsName` on your proxy endpoint's AAAA records. Your proxy endpoint's IPv6 addresses will appear under `IPAddress`. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "To ensure responses are allowed through your firewall, add an inbound rule to allow the static IPv4 address for Cloudflare proxy endpoints, `162.159.193.21`.\n\n## Edit proxy endpoints\n\nYou can modify proxy endpoint settings after creation.\n\n### Edit authorization endpoint\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies** > **Proxy endpoints**.\n\n2. Locate your authorization endpoint (indicated by **Authorization** under **Type**).\n\n3. Select the three dots, then select **Configure**.\n\n4. Choose what to edit:\n\n   * **Basic info**: Update the endpoint name and description.\n   * **Access policies**: Add, remove, or modify Access policies that control who can use the endpoint.\n   * **Login methods**: Select which [identity providers](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) users can authenticate with.\n\n5. Select **Save**.\n\n### Edit source IP endpoint\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Networks** > **Resolvers & Proxies** > **Proxy endpoints**.\n2. Locate your source IP endpoint (indicated by **Source IP** under **Type**).\n3. Select the three dots, then select **Configure**.\n4. Update the endpoint name or modify the allowed source IP addresses.\n5. Select **Save**.\n\n## Limitations\n\n### Traffic limitations\n\nEach type of proxy endpoint supports the following features:\n\n| Feature | Source IP endpoint | Authorization endpoint |\n| - | - | - |\n| **HTTP/HTTPS traffic** | [1](#user-content-fn-1) | [1](#user-content-fn-1) |\n| **Non-HTTP TCP traffic** |  |  |\n| **UDP traffic** |  |  |\n| **[HTTP3](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/)** |  |  |\n| **[Identity-based policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/)** |  |  |\n| **mTLS authentication** |  |  |\n| **[Happy Eyeballs](https://datatracker.ietf.org/doc/html/rfc6555)** |  |  |\n| **Browser HTTPS auto-upgrade** | [2](#user-content-fn-2) | [2](#user-content-fn-2) |\n\n### Session duration\n\nAll connections proxied through Cloudflare Gateway have a maximum guaranteed duration of 10 hours. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#long-lived-ssh-sessions-frequently-disconnect).\n\n### Gateway DNS and resolver policies\n\nGateway [DNS](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/) and [resolver](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/) policies will always apply to traffic proxied with PAC files, regardless of device configuration.\n\n## Footnotes\n\n1. To access plaintext HTTP (non-HTTPS) origins through proxy endpoints, configure them as [self-hosted Access applications](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/). This allows users to access HTTP resources while maintaining security through Access policies. [](#user-content-fnref-1) [2](#user-content-fnref-1-2)\n\n2. Proxy endpoints do not support HTTPS when browsers automatically upgrade HTTP requests to HTTPS (such as Chrome's automatic HTTPS upgrades). If you encounter connection issues with sites that are being auto-upgraded, you may need to disable automatic HTTPS upgrades in your browser settings or configure the site as an exception. [](#user-content-fnref-2) [2](#user-content-fnref-2-2)\n\n</page>\n\n<page>\n---\ntitle: Clientless Web Isolation  Cloudflare One docs\ndescription: Clientless Web Isolation allows users to securely browse high risk\n  or sensitive websites in a remote browser without having to install the\n  Cloudflare WARP client on their device.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/index.md\n---\n\nClientless Web Isolation allows users to securely browse high risk or sensitive websites in a remote browser without having to install the Cloudflare WARP client on their device.\n\n## Set up Clientless Web Isolation\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Browser isolation** > **Browser isolation settings**.\n2. Under **Manage remote browser permissions**, select **Manage**.\n3. Enable **Clientless Web Isolation**.\n\n1) To configure permissions, in **Browser isolation** > **Browser isolation settings** > select **Manage** next to **Manage remote browser permissions**. You can add authentication methods and [rules](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to control who can access the remote browser.\n\n2) Under **Policies** > Access Policies > select **Create new policy**.\n\n3) Name your policy and define who will have access to your isolated application. Refer to the [Access policy documentation](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#actions) to construct your policy.\n\n4) Select **Save**.\n\n5) Under **Policies** > Access Policies > select **Select existing policies** and select the policy or policies you created in the previous step > select **Confirm**.\n\n6) At the bottom of the page, select **Save**.\n\nYour application will now be served in an isolated browser for users matching your policies.\n\n### Open links in Browser Isolation\n\nTo open links using Browser Isolation:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Browser isolation**.\n2. Select **Launch isolated browser**. Turn **Clientless web isolation** on.\n3. In **Launch browser**, enter the URL link, and then select **Launch**. Your URL will open in a secure isolated browser.\n\n## Filter DNS queries\n\nGateway filters and resolves DNS queries for isolated sessions via [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/). Enterprise users can resolve domains available only through private resolvers by creating [resolver policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/).\n\nGateway DNS and resolver policies will always apply to Clientless Web Isolation traffic, regardless of device configuration.\n\n## Use the remote browser\n\nClientless Web Isolation is implemented through a prefixed URL, where `<your-team-name>` is your organization's team name.",
      "language": "unknown"
    },
    {
      "code": "For example, to isolate `www.example.com`, users would visit `https://<your-team-name>.cloudflareaccess.com/browser/https://www.example.com/` in their preferred browser.\n\nIf `<url>` is not provided, users are presented with a Cloudflare Zero Trust landing page where they can input a target URL or search for a website.\n\n## Optional configurations\n\n### Allow or block websites\n\nWhen users visit a website through the [Clientless Web Isolation URL](#use-the-remote-browser), the traffic passes through Cloudflare Gateway. This allows you to [apply HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to control what websites the remote browser can connect to, even if the user's device does not have WARP installed.\n\nFor example, if you use a third-party Secure Web Gateway to block `example.com`, users can still access the page in the remote browser by visiting `https://<your-team-name>.cloudflareaccess.com/browser/https://www.example.com/`. To block `https://<your-team-name>.cloudflareaccess.com/browser/https://www.example.com/`, create a Cloudflare Gateway HTTP policy to block `example.com`:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Domain | in | `example.com` | Block |\n\n### Bypass TLS decryption\n\nIf [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/) is turned on, Gateway will decrypt all sites accessed through the Clientless Web Isolation URL. To connect to sites that are incompatible with TLS decryption, you will need to add a Do Not Inspect HTTP policy for the application or domain.\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Domain | is | `mysite.com` | Do Not Inspect |\n\nNote\n\nClientless Web Isolation can function without TLS decryption enabled. However, TLS decryption is required to apply [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to Clientless Web Isolation traffic.\n\n### Connect private networks\n\nWith Clientless Web Isolation, users can reach any internal web server you have connected through [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/). For more information, refer to [Connect private networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/).\n\nFor example, if you added `192.168.2.1` to your tunnel, users can connect to your application through the remote browser by going to `https://<your-team-name>.cloudflareaccess.com/browser/http://192.168.2.1`. Clientless Web Isolation also supports connecting over private ports, for example `https://<your-team-name>.cloudflareaccess.com/browser/http://192.168.2.1:7148`.\n\nNote\n\nAll users with access to your remote browser can access your Cloudflare Tunnel applications unless you create a Gateway HTTP policy to block them.\n\n### Disable remote browser controls\n\nYou can configure [remote browser controls](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#policy-settings) such as disabling copy/paste, printing, or keyboard input. These settings display in the Gateway [HTTP policy builder](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) when you select the Isolate action.\n\n### Sync cookies between local and remote browser\n\nThe Cloudflare One Chrome extension allows a user to seamlessly access isolated and non-isolated applications without needing to re-authenticate. The user can log in once to their identity provider (whether through a Clientless Web Isolation link or their local browser) and gain access to all applications behind the SSO login.\n\nNote\n\nThe Chrome extension is available in early access. To install, contact your account team.\n\n## Address bar\n\nClientless Web Isolation has an embedded address bar. This feature is designed to improve the user's experience while visiting isolated pages with prefixed URLs.\n\nThe clientless address bar has three views: hostname notch, full address bar and hidden. The user's selected view is remembered across domains and remote browsing sessions.\n\n### Hostname notch view\n\nBy default the isolated domain name appears in the notch positioned at the top and center of an isolated page.\n\n![Viewing hostname of an isolated page in the clientless remote browser](https://developers.cloudflare.com/_astro/rbi-address-bar-notch.BsghmuIS_Z2b4rgV.webp)\n\nSelecting **Expand** or the hostname text will expand the notch to the full address bar view. If isolated page content is obscured by the notch, expanding to the full address bar view will make the content accessible.\n\n### Full address bar view\n\nThe full address bar allows users to search and go to isolated websites. Users can jump to the address bar at any time by pressing `CTRL + L` on the keyboard.\n\n![Viewing full address of an isolated page in the clientless remote browser](https://developers.cloudflare.com/_astro/rbi-address-bar-full.BDXQJUgz_2udAzd.webp)\n\n### Hidden view\n\nTo turn on or off the address bar, users can right-click on any isolated page and select **Show / Hide address bar**.\n\n## Logs\n\n* **Authentication events**: User login events are available in [Access audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/).\n* **HTTP requests**: Traffic from the remote browser to the Internet is logged in [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/).\n* **DNS queries**: DNS queries from the remote browser are shown in [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/).\n* **User actions**: Track copy/paste, download/upload, and print actions initiated by users in the remote browser (only available in [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/)).\n\n## Redirect traffic to the remote browser\n\nIf you want to isolate a website without Cloudflare WARP installed, you will need to redirect traffic to the Clientless Web Isolation [prefixed URL](#use-the-remote-browser). One way to do this is through a third-party Secure Web Gateway. To redirect users to the remote browser, you can implement a custom block page similar to the example shown below.",
      "language": "unknown"
    },
    {
      "code": "## Troubleshooting\n\nReview troubleshooting guidance related to Clientless Web Isolation.\n\n* [Clientless Web Isolation is loading a blank screen on a Windows device](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#clientless-web-isolation-is-loading-with-a-blank-screen-on-a-windows-device)\n\n</page>\n\n<page>\n---\ntitle: Non-identity on-ramps  Cloudflare One docs\ndescription: With Cloudflare One, you can isolate HTTP traffic from on-ramps\n  such as proxy endpoints or Magic WAN. Since these on-ramps do not require\n  users to log in to Cloudflare WARP, identity-based policies are not supported.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/non-identity/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/non-identity/index.md\n---\n\nWith Cloudflare One, you can isolate HTTP traffic from on-ramps such as [proxy endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) or [Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/). Since these on-ramps do not require users to log in to Cloudflare WARP, [identity-based policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) are not supported.\n\nNote\n\nIf you want to apply Isolate policies based on user identity, you will need to either install the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) or manually redirect users to the [Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) URL.\n\n## Set up non-identity browser isolation\n\n1. [Install a Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on your devices.\n\n2. Connect your infrastructure to Gateway using one of the following on-ramps:\n\n   * Configure your browser to forward traffic to a Gateway proxy endpoint with [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/).\n   * Connect your enterprise site router to Gateway with the [anycast GRE or IPsec tunnel on-ramp to Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/).\n\n3. Enable non-identity browser isolation:\n\n   1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Browser isolation** > **Browser isolation settings**.\n   2. Turn on **Allow isolated HTTP traffic when user identity is unknown**.\n\n4. Build a non-identity [HTTP policy](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/) to isolate websites in a remote browser.\n\n</page>\n\n<page>\n---\ntitle: Access custom block pages  Cloudflare One docs\ndescription: You can customize the block page that displays when users fail to\n  authenticate to an Access application. Each application can have a different\n  block page.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/index.md\n---\n\nYou can customize the block page that displays when users fail to authenticate to an Access application. Each application can have a different block page.\n\nGateway block page\n\nTo customize the page that users see when they are blocked by a Gateway firewall policy, refer to [Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/).\n\n## Types of block pages\n\nCloudflare Access offers three different block page options:\n\n* **Default**: Displays a Cloudflare branded block page.\n* **Custom Redirect URL** - Redirects blocked requests to the specified URL. For example, you could redirect the user to a [dynamic Access Denied page](https://github.com/cloudflare/cf-identity-dynamic) that fetches their identity and shows the exact reason they were blocked.\n* **Custom Page Template** - (Only available on Pay-as-you-go and Enterprise plans) Displays a [custom HTML page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/#create-a-custom-block-page) hosted by Cloudflare.\n\n### Identity versus non-identity\n\nYou can display a different [type of block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/#types-of-block-pages) to users who fail an identity-based policy versus a non-identity policy.\n\n* **Identity failure block page**: Displays when the user is blocked by an identity-based Access policy (such as email, user group, or external evaluation rule), after logging in to their identity provider.\n* **Non-identity failure block page**: Displays when the user is blocked by a non-identity Access policy (such as country, IP, or device posture). Cloudflare checks non-identity attributes before prompting the user to login.\n\n## Create a custom block page\n\nNote\n\nOnly available on Pay-as-you-go and Enterprise plans.\n\nTo create a custom block page for Access:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Reusable components** > **Custom pages**.\n\n2. Find the **Access Custom Pages** setting and select **Manage**.\n\n3. Select **Add a page template**.\n\n4. Enter a unique name for the block page.\n\n5. In **Type**, select whether this is an [identity or non-identity block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/#identity-versus-non-identity).\n\n6. In **Custom HTML**, enter the HTML code for your custom page. For example,",
      "language": "unknown"
    },
    {
      "code": "7. To check the appearance of your custom page, select **Download** and open the HTML file in a browser.\n\n8. Once you are satisfied with your custom page, select **Save**.\n\nYou can now select this block page when you [configure an Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/).\n\n</page>\n\n<page>\n---\ntitle: Access login page  Cloudflare One docs\ndescription: You can customize the login page that is displayed to end users\n  when they go to an Access application.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/index.md\n---\n\nYou can customize the login page that is displayed to end users when they go to an Access application.\n\nTo change the appearance of your login page:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Reusable components** > **Custom pages**.\n\n2. Find the **Access login page** setting and select **Manage**.\n\n3. Give the login page the look and feel of your organization by adding:\n\n   * Your organization's name\n   * A logo\n   * A custom header and footer\n   * A preferred background color\n\n   Any changes you make will be reflected in real time in the **Preview** card.\n\n4. Once you are satisfied with your customization, select **Save**.\n\nThe login page is now updated for all of your Access applications.\n\n</page>\n\n<page>\n---\ntitle: App Launcher customization  Cloudflare One docs\ndescription: You can display your own branding, messages, and links to users\n  when they open the Access App Launcher.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/app-launcher-customization/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/app-launcher-customization/index.md\n---\n\nNote\n\nOnly available on Pay-as-you-go and Enterprise plans.\n\nYou can display your own branding, messages, and links to users when they open the [Access App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/).\n\nTo customize the App Launcher appearance:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Reusable components** > **Custom pages**.\n\n2. Find the **App Launcher customization** setting and select **Manage**.\n\n3. Give the App Launcher the look and feel of your organization by adding:\n\n   * Your organization's name\n   * A logo\n   * A preferred background color for the header\n   * A preferred background color for the page\n   * A custom footer with links to your organization's help desk or other internal resources.\n\nNote\n\nWe recommend lighter background colors because the font defaults to black.\n\n1. Next, customize the landing page that users will see when they login to the App Launcher. Available properties include:\n\n   * A custom title\n   * A custom subtitle\n   * An image\n   * A preferred color for the **Log in** button\n   * A preferred color for the **Log in** button text\n\n   All of the properties configured in Step 3 will also apply to the landing page.\n\n2. Once you are satisfied with your customization, select **Save**.\n\nThe App Launcher screens are now updated. To view your changes, select **Preview**.\n\n</page>\n\n<page>\n---\ntitle: Block page  Cloudflare One docs\ndescription: When Gateway blocks traffic with a DNS or HTTP Block policy, you\n  can configure a block page to display in your users' browsers. You can provide\n  a descriptive reason for blocking traffic and contact information, or you can\n  redirect your users' browsers to another page. You can apply these\n  customizations globally for every Block policy, or override the settings on a\n  per-policy basis.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/index.md\n---\n\nWhen Gateway blocks traffic with a [DNS](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#block) or [HTTP Block policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#block), you can configure a block page to display in your users' browsers. You can provide a descriptive reason for blocking traffic and contact information, or you can redirect your users' browsers to another page. You can apply these customizations globally for every Block policy, or override the settings on a per-policy basis.\n\n## Prerequisites\n\nIn order to display the block page as the URL of the blocked domain, your organization's devices must have a [Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/) installed. Enterprise users can also [deploy their own root CA certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/). If you do not install a certificate, the block page [will not display correctly](#certificate-error).\n\n## Configure the block page\n\nGateway will display a global block page in the browser of any user whose traffic is blocked. By default, Gateway will display the block page for any DNS Block policies you turn it on for and all HTTP Block policies. You can [turn on or override the global setting](#configure-policy-block-behavior) on a per-policy basis.\n\nTo configure the global block page:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Custom pages**.\n2. Under **Account Gateway block page**, Gateway will display the current block page setting. Select **Manage**.\n3. Choose whether to use the [default Gateway block page](#use-the-default-block-page), a [URL redirect](#redirect-to-a-block-page), or a [custom Gateway block page](#customize-the-block-page).\n4. Select **Save**.\n\n### Use the default block page\n\nWhen you choose **Default Gateway block page**, Gateway will display a [block page hosted by Cloudflare](https://blocked.teams.cloudflare.com/). This is the default option for all traffic blocked by Gateway.\n\n### Redirect to a block page\n\nInstead of displaying the Cloudflare block page, you can configure Gateway to return a `307` (Temporary Redirect) HTTP response code and redirect to a custom URL.\n\nTo redirect users to a non-Cloudflare block page:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Custom pages**.\n2. Under **Account Gateway block page**, select **Manage**.\n3. Choose **URL redirect**.\n4. Enter the URL you want to redirect blocked traffic to.\n5. (Optional) Turn on **Send policy context** to send [additional policy context](#policy-context) to the redirected URL.\n6. Select **Save**.\n\nGateway will now redirect users to a custom page when user traffic matches a Block policy with the block page configured.\n\nTo create an HTTP policy to redirect URLs, refer to the [Redirect action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#redirect).\n\n#### Policy context\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\n#### Redirect precedence\n\nPaths and queries in the redirect URL take precedence over the original URL. When you turn on **Send policy context**, Gateway will append context to the end of the redirected URL. For example, if the original URL is `example.com/path/to/page?querystring=X&k=1` and the redirect URL is `cloudflare.com/redirect-path?querystring=Y`, Gateway will redirect requests to:",
      "language": "unknown"
    },
    {
      "code": "### Customize the block page\n\nYou can customize the Cloudflare-hosted block page by making global changes that Gateway will display every time a user reaches your block page. Customizations will apply regardless of the type of policy (DNS or HTTP) that blocks the traffic.\n\nTo customize your block page:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Custom pages**.\n\n  2. Under **Account Gateway block page**, select **Customize**.\n\n  3. Choose **Custom Gateway block page**. Gateway will display a preview of your custom block page. Available customizations include:\n\n     * Your organization's name\n     * [Logo](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#add-a-logo-image)\n     * Header text\n     * Global block message, which will be displayed above the policy-specific block message\n     * [Mailto link](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#allow-users-to-email-an-administrator)\n     * Background color\n\n  4. Select **Save**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. In [`cloudflare_zero_trust_gateway_settings`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_gateway_settings), configure the `block_page` argument with your customizations:",
      "language": "unknown"
    },
    {
      "code": "Gateway will now display a custom Gateway block page when your users visit a blocked website.\n\n#### Add a logo image\n\nYou can include an external logo image to display on your custom block page. The block page resizes all images to 146x146 pixels. The URL must be valid and no longer than 2048 characters. Accepted file types include SVG, PNG, JPEG, and GIF.\n\n#### Allow users to email an administrator\n\nYou can add a Mailto link to your custom block page, which allows users to directly email you about the blocked site. When users select **Contact your Administrator** on your block page, an email template opens with the email address and subject line you configure, as well as the following diagnostic information:\n\n| Field | Description |\n| - | - |\n| Site URL | The URL of the blocked page. |\n| Rule ID | The ID of the Gateway policy that blocked the page. |\n| Source IP | The public source IP of the user device. |\n| Account ID | The Cloudflare account associated with the block policy. |\n| User ID | The ID of the user who visited the page. Currently, User IDs are not surfaced in the dashboard and can only be viewed by calling the [API](https://developers.cloudflare.com/api/resources/zero_trust/subresources/access/subresources/users/methods/list/). |\n| Device ID | The ID of the device that visited the page. This is generated by the WARP client. |\n| Block Reason | Your policy-specific block message. |\n\n## Configure policy block behavior\n\nFor DNS Block policies, you will need to turn on the block page for each policy you want to display it. For HTTP Block policies, Gateway automatically displays your global block page setting by default. You can override your global block page setting for both policy types within each policy's settings.\n\nTo turn on the block page or override your global block page setting for an individual policy:\n\n* DNS policy\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **DNS**.\n\n  2. Select **Add a policy** to create a new policy, or choose the policy you want to customize and select **Edit**. You can only edit the block page for policies with a Block action.\n\n  3. Under **Configure policy settings**, turn on **Modify Gateway block behavior**.\n\n  4. Choose your block behavior:\n\n     * **Use account-level block setting**: Use the global block page setting configured in your account settings. The global setting can be the default Gateway block page, an [HTTP redirect](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#redirect-to-a-block-page), or a [custom Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#customize-the-block-page).\n     * **Override account setting with URL redirect**: Redirect users with a `307` HTTP redirect to a URL you specify on a policy level.\n\n  5. (Optional) If your account-level block page setting uses a custom Gateway block page, you can turn on **Add an additional message to your custom block page when traffic matches this policy** to add a custom message to your custom block page when traffic is blocked by this policy. This option will replace the **Message** field.\n\n  6. Select **Save policy**.\n\n  Depending on your settings, Gateway will display a block page in your users' browsers or redirect them to a specified URL when they are blocked by this policy.\n\n* HTTP policy\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **HTTP**.\n\n  2. Select **Add a policy** to create a new policy, or choose the policy you want to customize and select **Edit**. You can only edit the block page for policies with a Block action.\n\n  3. Under **Configure policy settings**, go to **Modify Gateway block behavior**.\n\n  4. Choose your block behavior:\n\n     * **Use account-level block setting**: Use the global block page setting configured in your account settings. The global setting can be the default Gateway block page, an [HTTP redirect](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#redirect-to-a-block-page), or a [custom Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#customize-the-block-page).\n     * **Override account setting with URL redirect**: Redirect users with a `307` HTTP redirect to a URL you specify on a policy level.\n\n  5. (Optional) If your account-level block page setting uses a custom Gateway block page, you can turn on **Add an additional message to your custom block page when traffic matches this policy** to add a custom message to your custom block page when traffic is blocked by this policy. This option will replace the **Message** field.\n\n  6. Select **Save policy**.\n\n  Depending on your settings, Gateway will display a block page in your users' browsers or redirect them to a specified URL when they are blocked by this policy.\n\n## Limitations\n\n### Certificate error\n\nIf your users receive a security risk warning in their browser when visiting a blocked page, check that you have correctly [installed a certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/) on their devices. If a certificate is not installed or the installed certificate is invalid or expired, your user's browser may:\n\n* Display an **HTTP Response Code: 526** error page, indicating an insecure upstream.\n* Close the connection and fail to display any pages.\n\nFor more information on fixing certificate issues, refer to [Troubleshooting](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#as-of-february-2-2025-my-end-user-devices-browser-is-returning-a-your-connection-is-not-private-warning).\n\n### Incompatible DNS record types\n\nTo block the resolution of queries for DNS records with types other than `A` or `AAAA`, Gateway will respond with the `REFUSED (RCODE:5)` DNS return code. Gateway will block the request but will not display a block page.\n\n### Third-party filtering conflict\n\nGateway will not properly filter traffic sent through third-party VPNs or other Internet filtering software, such as [iCloud Private Relay](https://support.apple.com/102602) or [Google Chrome IP Protection](https://github.com/GoogleChrome/ip-protection#ip-protection). To ensure your DNS policies apply to your traffic, Cloudflare recommends turning off software that may interfere with Gateway.\n\nTo turn off iCloud Private Relay, refer to the Apple user guides for [macOS](https://support.apple.com/guide/mac-help/use-icloud-private-relay-mchlecadabe0/) or [iOS](https://support.apple.com/guide/iphone/protect-web-browsing-icloud-private-relay-iph499d287c2/).\n\n### Data center and IP address matching\n\nIf an HTTP request that matches a block policy does not arrive at the same Cloudflare data center as its DNS query, Gateway will display the default block page instead of your custom block page.\n\nThis applies to DNS queries sent to any Gateway resolver endpoint, including those over IPv4, IPv6, and encrypted protocols like DoH (DNS over HTTPS) and DoT (DNS over TLS). If a DNS query is routed to a different Cloudflare data center than the corresponding HTTP request (for example, if DoH traffic is sent outside the WARP tunnel), Gateway cannot correlate the two requests and will display the default block page instead of your custom block page.\n\nIf the HTTP request comes from a different IP address than the DNS request, Gateway may not display the rule ID, custom message, or other fields on the block page. This can happen when a recursive DNS resolver's source IP address differs from the user device's IP address.\n\n</page>\n\n<page>\n---\ntitle: Access integrations  Cloudflare One docs\ndescription: The following device posture checks do not require the WARP client\n  and can only be used in Cloudflare Access policies. They cannot be used in\n  Gateway network policies.\nlastUpdated: 2025-11-24T22:20:18.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/access-integrations/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/access-integrations/index.md\n---\n\nThe following device posture checks do not require the WARP client and can only be used in [Cloudflare Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). They cannot be used in Gateway network policies.\n\n## Supported operating systems\n\n| Device posture check | macOS | Windows | Linux | iOS | Android/ChromeOS |\n| - | - | - | - | - | - |\n| [Microsoft Entra ID Conditional Access](https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-conditional-access/) |  |  |  |  |  |\n| [Mutual TLS](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/) |  |  |  |  |  |\n\n</page>\n\n<page>\n---\ntitle: Service-to-service checks  Cloudflare One docs\nlastUpdated: 2025-11-24T22:20:18.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/service-to-service/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/service-to-service/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: WARP client checks  Cloudflare One docs\ndescription: These device posture checks are performed by the Cloudflare WARP\n  client. To use this feature, you must deploy the WARP client to your devices\n  and enable the desired posture checks.\nlastUpdated: 2025-10-28T21:24:57.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/index.md\n---\n\nThese device posture checks are performed by the [Cloudflare WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/). To use this feature, you must [deploy the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) to your devices and enable the desired posture checks.\n\n## Supported WARP modes\n\n* Gateway with WARP\n* Secure Web Gateway without DNS filtering\n* Device Information Only\n\n## Supported operating systems\n\n| Device posture check | macOS | Windows | Linux | iOS | Android/ChromeOS |\n| - | - | - | - | - | - |\n| [Application check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/application-check/) |  |  |  |  |  |\n| [Carbon Black](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/carbon-black/) |  |  |  |  |  |\n| [Client certificate](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/) |  |  |  |  |  |\n| [Device serial numbers](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/) |  |  |  |  |  |\n| [Device UUID](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/device-uuid/) |  |  |  |  |  |\n| [Disk encryption](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/disk-encryption/) |  |  |  |  |  |\n| [Domain joined](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/domain-joined/) |  |  |  |  |  |\n| [File check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/file-check/) |  |  |  |  |  |\n| [Firewall](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/firewall/) |  |  |  |  |  |\n| [OS version](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/) |  |  |  |  |  |\n| [Require Gateway](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-gateway/) |  |  |  |  |  |\n| [Require WARP](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-warp/) |  |  |  |  |  |\n| [SentinelOne](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/sentinel-one/) |  |  |  |  |  |\n| [Tanium (legacy)](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/tanium/) |  |  |  |  |  |\n\n</page>\n\n<page>\n---\ntitle: User-side certificates  Cloudflare One docs\ndescription: Advanced security features such as HTTPS traffic inspection, Data\n  Loss Prevention, anti-virus scanning, Access for Infrastructure, and Browser\n  Isolation require users to install and trust a root certificate on their\n  device. You can either install the certificate provided by Cloudflare (default\n  option), or generate your own custom certificate and upload it to Cloudflare.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/index.md\n---\n\nAdvanced security features such as [HTTPS traffic inspection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/), [Data Loss Prevention](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/), [anti-virus scanning](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/), [Access for Infrastructure](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/), and [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) require users to install and trust a root certificate on their device. You can either install the certificate provided by Cloudflare (default option), or generate your own custom certificate and upload it to Cloudflare.\n\nZero Trust [generates a unique root CA](#generate-a-cloudflare-root-certificate) for each account and deploys it across the Cloudflare global network. Alternatively, Enterprise users can upload and deploy their own [custom certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/).\n\nDefault certificate expired on 2025-02-02\n\nThe default Cloudflare certificate expired on 2025-02-02 at 16:05 UTC.\n\nReview how this change impacts certificate propagation to your end-user devices and how to address browser issues in [Troubleshooting](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#as-of-february-2-2025-my-end-user-devices-browser-is-returning-a-your-connection-is-not-private-warning).\n\n## Certificate status\n\nZero Trust will indicate if a certificate is ready for use in inspection based on its deployment status:\n\n| Deployment status | Description |\n| - | - |\n| Inactive | The certificate has been generated by or uploaded to Cloudflare but is not deployed across the global network. |\n| Pending | The certificate is being activated or deactivated for use. |\n| Available | The certificate is deployed across the Cloudflare global network and ready to be turned on. The WARP client will install the certificate on your users' devices. |\n| Available and In-Use | The certificate is turned on. Gateway will use the certificate for inspection. |\n\n## Generate a Cloudflare root certificate\n\nTo generate a new Cloudflare root certificate for your Zero Trust organization:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. Select **Certificates**.\n  3. Select **Generate certificate**.\n  4. Choose a duration of time before the certificate expires. Cloudflare recommends expiration after five years. Alternatively, choose *Custom* and enter a custom amount in days.\n  5. Select **Generate certificate**.\n\n* API\n\n  Send a `POST` request to the [Create Zero Trust certificate](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/certificates/methods/create/) endpoint.",
      "language": "unknown"
    },
    {
      "code": "The API will respond with the ID and contents of the new certificate.\n\nThe certificate will appear in your list of certificates as **Inactive**. To download a generated certificate, select it, then choose **Download .pem** and/or **Download .crt**. To deploy your certificate and turn it on for inspection, you need to [activate the certificate](#activate-a-root-certificate).\n\nEach Zero Trust account can generate a new root certificate a maximum of three times per day.\n\n## Activate a root certificate\n\nNote\n\nZero Trust accounts using the default Cloudflare certificate prior to 2024-10-17 will need to redeploy and activate the newly generated certificate. Zero Trust accounts created during or after 2024-10-17 will use an available certificate by default.\n\nOnce a certificate is generated in or uploaded to Zero Trust, you need to activate it. Activating a certificate deploys it across the Cloudflare network and sets its status to **Available**. You can have up to 10 available certificates at once.\n\nTo activate your root certificate:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. Select **Certificates**.\n  3. Select the certificate you want to activate.\n  4. Select **Activate**.\n\n* API\n\n  Send a `POST` request to the [Activate a Zero Trust certificate](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/certificates/methods/activate/) endpoint.",
      "language": "unknown"
    },
    {
      "code": "The status of the certificate will change to **Pending** while it deploys. Once the status of your certificate is **Available**, you can install it on your user's devices either [with WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/) or [manually](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/).\n\nOnce you deploy and install your certificate, you can turn it on for use in inspection:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. Select **Certificates**.\n  3. Select the certificate you want to turn on.\n  4. In **Basic information**, select **Confirm and turn on certificate**.\n\n* API\n\n  Send a `PUT` request to the [Update Zero Trust account configuration](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/configurations/methods/update/) endpoint. For example:",
      "language": "unknown"
    },
    {
      "code": "You can set multiple certificates to **Available**, but you can only turn on one certificate for use in inspection at a time. Setting a certificate as **In-Use** will set any other in-use certificates as **Available** only and prevent them from being used for inspection until turned on again.\n\n</page>\n\n<page>\n---\ntitle: About Cloudflare WARP  Cloudflare One docs\ndescription: The Cloudflare WARP client allows you to protect corporate devices\n  by securely and privately sending traffic from those devices to Cloudflare's\n  global network, where Cloudflare Gateway can apply advanced web filtering. The\n  WARP client also makes it possible to apply advanced Zero Trust policies that\n  check for a device's health before it connects to corporate applications.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/index.md\n---\n\n## About Cloudflare WARP\n\nThe Cloudflare WARP client allows you to protect corporate devices by securely and privately sending traffic from those devices to Cloudflare's global network, where [Cloudflare Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) can apply advanced web filtering. The WARP client also makes it possible to apply advanced [Zero Trust policies](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/) that check for a device's health before it connects to corporate applications.\n\n## How WARP works\n\nWARP is a device client that builds proxy tunnels using either Wireguard or MASQUE, and builds a DNS proxy using DNS-over-HTTPS. WARP supports all major operating systems, all common forms of endpoint management tooling, and has a robust series of management parameters and profiles to accurately scope the needs of a diverse user base.\n\nThe WARP client consists of:\n\n* Graphical User Interface (GUI): Control panel that allows end users to view WARP's [status](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/connectivity-status/) and perform actions such as turning WARP on or off.\n* WARP daemon (or service): Core background component responsible for establishing secure tunnels (using WireGuard or MASQUE) and handling all WARP functionality on your device.\n\nFor more information on how the WARP client routes traffic, refer to the [WARP architecture page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/warp-architecture/) and watch the video below.\n\n## WARP installation details\n\nThe GUI and daemon (or service) have different names and are stored in the following locations:\n\nWindows\n\n| | Windows |\n| - | - |\n| **Service / Daemon** | `C:\\Program Files\\Cloudflare\\Cloudflare WARP\\warp-svc.exe` |\n| **GUI application** | `C:\\Program Files\\Cloudflare\\Cloudflare WARP\\Cloudflare WARP.exe` |\n| **Logs Location** | Daemon`C:\\ProgramData\\Cloudflare\\` GUI Logs`C:\\Users\\<USER>.WARP\\AppData\\Local` or `%LOCALAPPDATA%\\Cloudflare` |\n\nmacOS\n\n| | macOS |\n| - | - |\n| **Service / Daemon** | `/Applications/Cloudflare WARP.app/Contents/Resources/CloudflareWARP` |\n| **GUI application** | `/Applications/Cloudflare WARP.app/Contents/MacOS/Cloudflare WARP` |\n| **Logs Location** | Daemon`/Library/Application Support/Cloudflare/`GUI Logs`~/Library/Logs/Cloudflare/` |\n\nLinux\n\n| | Linux |\n| - | - |\n| **Service / Daemon** | `/bin/warp-svc` |\n| **GUI application** | `/bin/warp-taskbar` |\n| **Logs Location** | `/var/log/cloudflare-warp/` `/var/lib/cloudflare-warp` |\n\nAlong with the WARP GUI and daemon, `warp-cli` and `warp-diag` are also [installed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/) on the machine and added to the system path for use from any terminal session.\n\n[`warp-diag`](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/) is a command-line diagnostics tool that collects logs, configuration details, and connectivity data from the WARP client to help troubleshoot issues.\n\n`warp-cli` is the command-line interface (CLI) for managing and configuring the Cloudflare WARP client, allowing users to connect, disconnect, and adjust settings programmatically.\n\n## Key benefits of using WARP\n\nDeploying the WARP client significantly enhances your organization's security and visibility within Cloudflare Zero Trust:\n\n* **Unified security policies everywhere**: With the WARP client deployed in the Gateway with WARP mode, [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) are not location-dependent  they can be enforced anywhere.\n\n* **Advanced web filtering and threat protection**: Activate Gateway features for your device traffic, including:\n\n  * [Anti-Virus scanning](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/)\n  * [HTTP filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/)\n  * [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#isolate)\n  * [Identity-based policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/)\n\n* **Application and device-specific insights**: With WARP installed on your corporate devices, you can view detailed application and user-level activity on the [Zero Trust Shadow IT Discovery](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) page, while also monitoring device and network performance with [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) to proactively detect and resolve issues.\n\n* **Device posture checks**: The WARP client provides advanced Zero Trust protection by making it possible to check for [device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/). By setting up device posture checks, you can build Zero Trust policies that check for a device's location, disk encryption status, OS version, and more.\n\n* **Secure private and infrastructure access**: WARP lets devices connect to [private networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/) over Cloudflare Tunnel and is required for [Access for Infrastructure](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/), enabling secure SSH with short-lived certificates and detailed logging.\n\n## WARP modes\n\nWARP offers flexible [operating modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) to suit your specific needs. WARP can control device traffic as a full proxy, manage only DNS traffic as a DNS proxy, or both. WARP is the most common method for sending user device traffic through Cloudflare Gateway for filtering and decryption.\n\n## Next steps\n\n* Review the [first-time setup](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/) guide to [install](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/) and [deploy](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) the WARP client on your corporate devices.\n* Review possible [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) and [settings](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/) to best suit your organization's needs.\n* Explore [Cloudflare Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) to enforce advanced DNS, network, HTTP, and egress policies with WARP.\n\n</page>\n\n<page>\n---\ntitle: User risk score  Cloudflare One docs\ndescription: Cloudflare One risk scoring detects user activity and behaviors\n  that could introduce risk to your organization's systems and data. Risk scores\n  add user and entity behavior analytics (UEBA) to the Cloudflare One platform.\nlastUpdated: 2025-10-30T12:11:12.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/index.md\n---\n\nNote\n\nOnly available on Enterprise plans.\n\nCloudflare One risk scoring detects user activity and behaviors that could introduce risk to your organization's systems and data. Risk scores add user and entity behavior analytics (UEBA) to the Cloudflare One platform.\n\n## User risk scoring\n\nCloudflare One assigns a risk score of Low, Medium, or High based on detections of users' activities, posture, and settings. A user's score is equal to the highest-level risk behavior they trigger.\n\n### View a user's risk score\n\nTo view a user's risk score:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Teams & Resources**.\n2. Select **Users**.\n3. Select **Risk score** > **Risk scoring**.\n4. Select a user's name to view their instances of risk behaviors, if any. You can select an instance of a risk behavior to view the log associated with the detection.\n\nUsers that have had their risk score [cleared](#clear-a-users-risk-score) will not appear in the table unless they trigger another risk behavior.\n\n### Clear a user's risk score\n\nIf required, you can reset risk scores for specific users. Once reset, users will not appear in the associated risk table until they trigger another risk behavior.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Teams & Resources**.\n2. Select **Risk score** > **Risk scoring**.\n3. Select the user you want to clear the risk score for.\n4. In **User risk overview**, select **Reset user risk**.\n5. Select **Confirm**.\n\n### Send risk score to Okta\n\nIn addition to controls in Cloudflare One, Okta users can send risk scores to Okta to apply SSO-level policies.\n\nFirst, configure Cloudflare One to send user risk scores to Okta.\n\n1. Set up the [Okta SSO integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/).\n2. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Integrations** > **Identity providers**.\n3. In **Your identity providers**, locate your Okta integration and select **Edit**.\n4. Turn on **Send risk score to Okta**.\n5. Select **Save**.\n6. Upon saving, Cloudflare One will display the well-known URL for your organization. Copy the value.\n\nNext, configure Okta to receive your risk scores.\n\n1. On your Okta admin dashboard, go to **Security** > **Device Integrations**.\n2. Go to **Receive shared signals**, then select **Create stream**.\n3. Name your integration. In **Set up integration with**, choose *Well-known URL*.\n4. In **Well-known URL**, enter the well-known URL value provided by Cloudflare One.\n5. Select **Create**.\n\nFor more information on configuring user risk score within Okta, refer to the [Okta documentation](https://help.okta.com/oie/en-us/content/topics/itp/overview.htm).\n\nWhile the Okta integration is turned on, Cloudflare One will send any user risk score updates to Okta, including score increases and resets. Score update events will appear in your [Access audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/).\n\n## Predefined risk behaviors\n\nBy default, all predefined behaviors are disabled. When a behavior is enabled, Cloudflare One will continuously evaluate all users within the organization for the behavior. You can [change the risk level](#change-risk-behavior-risk-levels) for predefined behaviors if the default assignment does not suit your environment.\n\n| Risk behaviors | Requirements | Description |\n| - | - | - |\n| Impossible travel | [A configured Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/) | User has a successful login from two different locations that they could not have traveled between in that period of time. Matches will appear in your [Access audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/). |\n| High number of DLP policies triggered | [A configured DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) | User has created a high number of DLP policy matches within a narrow frame of time. Matches will appear in your [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/). |\n| SentinelOne threat detected on machine | [SentinelOne service provider integration](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/) | SentinelOne returns one or more configured [device posture attributes](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/#device-posture-attributes) for a user. |\n\n## Manage risk behaviors\n\nTo toggle risk behaviors, go to **Risk score** > **Risk behaviors**.\n\n### Enable risk behaviors\n\nWhen a specific behavior is enabled, Cloudflare One will continuously monitor all users within the organization for any instances of that behavior.\n\nIf a user engages in an enabled risk behavior, their risk level is re-evaluated. Cloudflare One will update their risk score to the highest value between the current risk level and the risk level of the behavior they triggered.\n\n### Disable risk behaviors\n\nWhen a risk behavior is disabled, monitoring for future activity will cease. Previously detected risk behaviors will remain in the logs and associated with a user.\n\n### Change risk behavior risk levels\n\nYou can change the risk level for a behavior at any time.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Teams & Resources**.\n2. Go to **Users**.\n3. Select **Risk score** > **Risk behaviors**.\n4. Select the risk behavior you want to modify.\n5. In the drop-down menu, choose your desired risk level.\n6. Select **Save**.\n\n</page>\n\n<page>\n---\ntitle: SCIM provisioning  Cloudflare One docs\ndescription: System for Cross-domain Identity Management (SCIM) is an open\n  standard protocol that allows identity providers to synchronize user identity\n  information with cloud applications and services. After configuring SCIM, user\n  identities that you create, edit, or delete in the identity provider are\n  automatically updated across all supported applications. This makes it easier\n  for IT admins to onboard new users, update their groups and permissions, and\n  revoke access in the event of an employee termination or security breach.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/index.md\n---\n\nSystem for Cross-domain Identity Management (SCIM) is an open standard protocol that allows identity providers to synchronize user identity information with cloud applications and services. After configuring SCIM, user identities that you create, edit, or delete in the identity provider are automatically updated across all supported applications. This makes it easier for IT admins to onboard new users, update their groups and permissions, and revoke access in the event of an employee termination or security breach.\n\nNote\n\nThis section covers SCIM provisioning for Cloudflare Zero Trust only. To provision access to your Cloudflare account, you will need to set up a distinct [dashboard SSO SCIM integration](https://developers.cloudflare.com/fundamentals/account/account-security/scim-setup/) in your IdP. You can assign users and groups to this new SCIM application to define who can access the Cloudflare dashboard.\n\nUsers provisioned via the [Zero Trust SCIM integration](#sync-users-and-groups-in-zero-trust-policies) will not have access to your Cloudflare dashboard unless you have manually added them to your [Cloudflare dashboard SSO application](https://developers.cloudflare.com/fundamentals/manage-members/dashboard-sso/).\n\n## Supported identity providers\n\nCloudflare Access supports SCIM provisioning for all SAML and OIDC identity providers that use SCIM version `2.0`.\n\n## Sync users and groups in Zero Trust policies\n\nCloudflare Access can automatically deprovision users from Zero Trust after they are deactivated in the identity provider and display synchronized group names in the Access and Gateway policy builders. Cloudflare does not provision new users in Zero Trust when they are added to the identity provider -- users must first register a device with the WARP client or authenticate to an Access application.\n\nTo set up SCIM for Zero Trust, refer to our [SSO integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) guides.\n\n</page>\n\n<page>\n---\ntitle: Seat management  Cloudflare One docs\ndescription: Cloudflare One subscriptions consist of seats that active users in\n  your account consume. Active users are added to Cloudflare One through any\n  authentication event.\nlastUpdated: 2025-11-13T20:59:36.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/index.md\n---\n\nCloudflare One subscriptions consist of seats that active users in your account consume. Active users are added to Cloudflare One through any [authentication event](#authentication-events).\n\nThe amount of seats available in your Cloudflare One account depends on the amount of users you purchase. If you want to increase the number of seats available, you will have to purchase more users. Learn more about adding and removing seats from your account in the [Cloudflare One FAQ](https://developers.cloudflare.com/cloudflare-one/faq/getting-started-faq/#how-do-i-change-my-subscription-plan).\n\n## Authentication events\n\nA user consumes a seat when they perform an authentication event. For Access, this is any Cloudflare Access authentication event, such as a login to the [App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/) or an application. For Gateway, this is when any devices associated with the user connect to Cloudflare One within the [specified period](#enable-seat-expiration).\n\nIf either one of these events occurs, that user's identity is added as an Active user to Cloudflare One and consumes one seat from your plan. The user will occupy and consume a single seat regardless of the number of applications accessed or login events from their user account. Once the total amount of seats in the subscription has been consumed, additional users who attempt to log in are blocked.\n\nA user who authenticates will hold their seat until you [remove the user](#remove-a-user) from your account. By default, inactive users will not be [automatically removed](#enable-seat-expiration) from your account. You can remove a single user or all users at any time, and those users will immediately stop counting against the seat count defined in your subscription.\n\nIf you notice a number of accounts greater than the number of your users, you may need to configure an Access [bypass policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#bypass). Alternatively, you can use Access [service tokens](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/) to allow access to applications without consuming seats.\n\n## Manage users\n\n### Check number of seats used\n\nTo check the number of seats consumed by active users in your organization, log in to [Cloudflare One](https://one.dash.cloudflare.com). **Cloudflare One overview** will display the amount of seats consumed and the remaining amount available. For more details on your users, go to **Team & Resources** > **Users**.\n\n### Revoke a user\n\nWhen you revoke a user, this action will terminate active sessions, but will not remove the user's consumption of an active seat.\n\nTo revoke a user from your Zero Trust Organization:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Team & Resources** > **Users**.\n2. Select the checkbox next to a user with an **Active** status in the **Seat usage** column.\n3. Select **Action** > **Revoke**.\n4. Select **Revoke sessions**.\n\nRevoked users can still log in if your policies allow them.\n\n### Remove a user\n\nRemoving a user from your Zero Trust Organization will free up the seat the user consumed. The user will still appear in your list of users.\n\nTo remove a user from your Zero Trust Organization:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Team & Resources** > **Users**.\n2. Select the checkbox next to a user with an **Active** status in the **Seat usage** column.\n3. Select **Action** > **Remove users**.\n4. Select **Remove**.\n\nThe user will now show as **Inactive** and will no longer occupy a seat. If a user is removed but authenticates later, they will consume a seat again.\n\nTo automate the removal of users who have not logged in or triggered a device enrollment in a specific amount of time, turn on [seat expiration](#enable-seat-expiration) or utilize [SCIM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/) to remove users when they are deactivated in your identity provider.\n\nUser record persistence\n\nYou cannot delete or archive a user record. You can [remove a user](#remove-a-user) from a seat, but their user record will remain in your Zero Trust Organization. Inactive users do not count towards billing.\n\n### Enable seat expiration\n\nCloudflare One can automatically remove any user who does not log in to an Access application or whose device does not show any Gateway activity for the specified period (between one month and one year). To determine if a user will be removed, Cloudflare looks for any authentication events and checks the **Last seen** value for all of the user's devices. If both of those are outside the expiration window, the user will be removed and will no longer count against your number of seats. This process occurs once daily for an account.\n\nTo enable user seat expiration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Settings** > **Admin controls**.\n2. In **Remove inactive users from seats**, select **Edit**.\n3. Select an inactivity time from the dropdown menu.\n4. Select **Save**.\n\nIf a user is removed but authenticates later, they will consume a seat again.\n\nFor more information about removing a user for Access and Gateway, refer to the [FAQ](https://developers.cloudflare.com/cloudflare-one/faq/getting-started-faq/#removing-users).\n\n</page>\n\n<page>\n---\ntitle: User logs  Cloudflare One docs\ndescription: User logs show a list of all users who have authenticated to\n  Cloudflare One. For each user who has logged in, you can view their enrolled\n  devices, login history, seat usage, and identity used for policy enforcement.\nlastUpdated: 2025-10-30T12:11:12.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/index.md\n---\n\nUser logs show a list of all users who have authenticated to Cloudflare One. For each user who has logged in, you can view their enrolled devices, login history, seat usage, and identity used for policy enforcement.\n\n## View user logs\n\nIn [Cloudflare One](https://one.dash.cloudflare.com/), go to **Teams & Resources** > **Users**.\n\nThis page lists all users who have registered the WARP client or authenticated to a Cloudflare Access application. You can select a user's name to view detailed logs, [revoke their session](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#revoke-user-sessions), or [remove their seat](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/).\n\n### Available logs\n\n* **User Registry identity**: Select the user's name to view their last seen identity. This identity is used to evaluate Gateway policies and WARP [device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/). A refresh occurs when the user re-authenticates WARP, logs into an Access application, or has their IdP group membership updated via [SCIM provisioning](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/). To track how the user's identity has changed over time, go to the **Audit logs** tab.\n* **Session identities**: The user's active sessions, the identity used to authenticate each session, and when each session will [expire](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/).\n* **Devices**: Devices registered to the user via WARP.\n* **Recent activities**: The user's five most recent Access login attempts. For more details, refer to your [authentication audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/#authentication-audit-logs).\n\n</page>\n\n<page>\n---\ntitle: Common DNS policies  Cloudflare One docs\ndescription: The following policies are commonly used to secure DNS traffic.\nlastUpdated: 2025-12-10T23:21:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/common-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/common-policies/index.md\n---\n\nThe following policies are commonly used to secure DNS traffic.\n\nFor a baseline set of recommended policies, refer to [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/build-dns-policies/recommended-dns-policies/).\n\nRefer to the [DNS policies page](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/) for a comprehensive list of other selectors, operators, and actions.\n\n## Allow corporate domains\n\nThis policy allows users to access official corporate domains. By deploying the policy with high [order of precedence](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#order-of-precedence), you ensure that employees can access trusted domains even if they fall under a blocked category like *Newly seen domains* or *Login pages*.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action | Precedence |\n  | - | - | - | - | - |\n  | Domain | in list | *Allowed domains* | Allow | 1 |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your lists, use the [List Zero Trust lists](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/) endpoint.\n\n## Block security threats\n\nBlock [security categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) such as Command & Control, Botnet and Malware based on Cloudflare's threat intelligence.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Security Categories | in | *All security risks* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Block content categories\n\nThe categories included in this policy are not always a security threat, but blocking them can help minimize the risk that your organization is exposed to. For more information, refer to [domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/).\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *Questionable Content*, *Security Risks*, *Miscellaneous* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Block a dynamic list of categories\n\nYou can add a list of category IDs to the [EDNS header](https://datatracker.ietf.org/doc/html/rfc6891) of a request sent to Gateway as a JSON object using OPT code `65050`. For example:",
      "language": "unknown"
    },
    {
      "code": "With the [Request Context Categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#request-context-categories) selector, you can block the category IDs sent with EDNS. This is useful to filter by categories not known at the time of creating a policy, or to enforce device-specific DNS content filtering without reaching your account limit. When Gateway uses this selector to block a DNS query, the request will return an Extended DNS Error (EDE) Code 15 - Blocked error, along with a field containing an array of the matched categories.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Request Context Category | is | *Present* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Block unauthorized applications\n\nNote\n\nAfter seven days, view your [Shadow IT SaaS Analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) and block additional applications based on what your users are accessing.\n\nTo minimize the risk of [shadow IT](https://www.cloudflare.com/learning/access-management/what-is-shadow-it/), some organizations choose to limit their users' access to certain web-based tools and applications. For example, the following policy blocks known AI tools:\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application | in | *Artificial Intelligence* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Block banned countries\n\nYou can implement policies to block websites hosted in countries categorized as high risk. The designation of such countries may result from your organization's customers or through the implementation of regulations including [EAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries), [OFAC](https://orpa.princeton.edu/export-controls/sanctioned-countries), and [ITAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries).\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Resolved Country IP Geolocation | in | *Afghanistan*, *Belarus*, *Congo (Kinshasa)*, *Cuba*, *Iran*, *Iraq*, *Korea, North*, *Myanmar*, *Russian Federation*, *Sudan*, *Syria*, *Ukraine*, *Zimbabwe* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Block top-level domains\n\nBlocking [frequently misused](https://www.spamhaus.org/statistics/tlds/) top-level domains (TLDs) can reduce security risks, especially when there is no discernible advantage to be gained from allowing access. Similarly, restricting access to specific country-level TLDs may be necessary to comply with regulations like [ITAR](https://www.tradecompliance.pitt.edu/embargoed-and-sanctioned-countries) or [OFAC](https://orpa.princeton.edu/export-controls/sanctioned-countries).\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Domain | matches regex | `[.](cn\\|ru)$` | Or | Block |\n  | Domain | matches regex | `[.](rest\\|hair\\|top\\|live\\|cfd\\|boats\\|beauty\\|mom\\|skin\\|okinawa)$` | Or | |\n  | Domain | matches regex | `[.](zip\\|mobi)$` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Block phishing attacks\n\nTo protect against [sophisticated phishing attacks](https://blog.cloudflare.com/2022-07-sms-phishing-attacks/), you could prevent users from accessing phishing domains that are specifically targeting your organization. The following policy blocks specific keywords associated with an organization or its authentication services (such as *okta*, *2fa*, *cloudflare* or *sso*), while still allowing access to official corporate domains.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Domain | not in list | *Corporate Domains* | And | Block |\n  | Domain | matches regex | `.*okta.*\\|.*cloudflare.*\\|.*mfa.*\\|.sso.*` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your lists, use the [List Zero Trust lists](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/) endpoint.\n\n## Block online tracking\n\nTo safeguard user privacy, some organizations will block tracking domains such as `dig.whatsapp.com` as well as other tracking domains embedded at the OS level. This policy is implemented by creating a custom blocklist. Refer to [this repository](https://github.com/nextdns/native-tracking-domains/tree/28991a0d5b2ab6d35588a74af82162ea7caff420/domains) for a list of widespread tracking domains that you can add to your blocklist.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Domain | in list | *Top tracking domains* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your lists, use the [List Zero Trust lists](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/) endpoint.\n\n## Block malicious IPs\n\nBlock specific IP addresses that are known to be malicious or pose a threat to your organization. This policy is usually implemented by creating custom blocklists or by using blocklists provided by threat intelligence partners or regional Computer Emergency and Response Teams (CERTs).\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Resolved IP | in list | *DShield* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your lists, use the [List Zero Trust lists](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/) endpoint.\n\n## Turn on CIPA filter\n\nThe CIPA (Children's Internet Protection Act) Filter is a collection of subcategories that encompass a wide range of topics that could be harmful or inappropriate for minors. It is used as a part of [Project Cybersafe Schools](https://developers.cloudflare.com/fundamentals/reference/policies-compliances/cybersafe/) to block access to unwanted or harmful online content. Upon creating this policy, your organization will have minimum [CIPA compliance](https://www.fcc.gov/consumers/guides/childrens-internet-protection-act).\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *CIPA Filter* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Hide explicit search results\n\nSafeSearch is a feature of search engines that helps you filter explicit or offensive content. You can force SafeSearch on search engines like Google, Bing, Yandex, YouTube, and DuckDuckGo:\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *Search Engines* | Safe Search |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Check user identity\n\nConfigure access on a per user or group basis by adding [identity-based conditions](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) to your policies.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application | in | *Salesforce* | And | Block |\n  | User Group Names | in | `Contractors` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Restrict access to specific groups\n\nFilter DNS queries to allow only specific users access.\n\nThe following example includes two policies. The first policy allows the specified group, while the second policy blocks all other users. To ensure the policies are evaluated properly, place the Allow policy above the Block policy. For more information, refer to the [order of precedence](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#order-of-precedence).\n\n### 1. Allow a group\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Content Categories | in | *Social Networks* | And | Allow |\n  | User Group Names | in | `Marketing` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### 2. Block all other users\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *Social Networks* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Control IP version\n\nEnterprise users can pair these policies with an [egress policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/) to control which IP version is used to egress to the origin server.\n\nOptionally, you can use the Domain selector to control the IP version for specific sites.\n\nNote\n\nTo ensure traffic routes through your preferred IP version, turn off **Modify Gateway block behavior**.\n\n### Force IPv4\n\nForce users to connect with IPv4 by blocking IPv6 resolution.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Query Record Type | is | *AAAA* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Force IPv6\n\nForce users to connect with IPv6 by blocking IPv4 resolution.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Query Record Type | is | *A* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Test DNS filtering  Cloudflare One docs\ndescription: This section covers how to validate your Gateway DNS configuration.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/test-dns-filtering/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/test-dns-filtering/index.md\n---\n\nThis section covers how to validate your Gateway DNS configuration.\n\n## Prerequisites\n\nBefore you start, make sure you are connected to a network that is associated with the [DNS location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) where the policy is applied.\n\n## Test a DNS policy\n\nOnce you have created a DNS policy to block a domain, you can use either `dig` or `nslookup` to see if the policy is working as intended.\n\nFor example, if you created a policy to block `example.com`, you can do the following to see if Gateway is successfully blocking `example.com`:\n\n1. Open your terminal.\n\n2. Type `dig example.com` (`nslookup example.com` if you are using Windows) and press **Enter**.\n\n3. If the [block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) is turned off for the policy, you should see `REFUSED` in the answer section:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "If the [block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) is enabled for the policy, you should see `NOERROR` in the answer section with `162.159.36.12` and `162.159.46.12` as the answers:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### Test a security or content category\n\nIf you are blocking a [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#security-categories) or a [content category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#content-categories), you can test that the policy is working by using the [test domain](#common-test-domains) associated with each category.\n\nOnce you have configured your Gateway policy to block the category, the test domain will show a block page when you attempt to visit the domain in your browser, or will return `REFUSED` when you perform `dig` using the command-line interface.\n\n#### Test domain format\n\n* **One-word category**  For categories with one-word names (for example, *Malware*), the test domain uses the following format:",
      "language": "unknown"
    },
    {
      "code": "* **Multi-word category**  For categories with multiple words in the name (for example, *Parked & For Sale Domains*), the test domain uses the following format:\n\n  * Remove any spaces between the words\n  * Replace `&` with `and`\n  * Lowercase all letters\n\n#### Common test domains\n\n| Category | Test domain |\n| - | - |\n| *Anonymizer* | `anonymizer.testcategory.com` |\n| *Command and Control & Botnet* | `commandandcontrolandbotnet.testcategory.com` |\n| *compromised Domain* | `compromiseddomain.testcategory.com` |\n| *Cryptomining* | `cryptomining.testcategory.com` |\n| *Malware* | `malware.testcategory.com` |\n| *New Domains* | `newdomains.testcategory.com` |\n| *Parked & For Sale Domains* | `parkedandforsaledomains.testcategory.com` |\n| *Phishing* | `phishing.testcategory.com` |\n| *Potentially Unwanted Software* | `potentiallyunwantedsoftware.testcategory.com` |\n| *Private IP Address* | `privateipaddress.testcategory.com` |\n| *Spam* | `spam.testcategory.com` |\n| *Spyware* | `spyware.testcategory.com` |\n| *Unreachable* | `unreachable.testcategory.com` |\n\n## Test EDNS configuration\n\nIf you [enabled EDNS client subnet](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) for your DNS location, you can validate EDNS as follows:\n\n1. Obtain your DNS location's DOH subdomain:\n\n   1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Resolvers & Proxies** > **DNS locations**.\n   2. Select the DNS location you are testing.\n   3. Note the value of **DNS over HTTPS**.\n\n2. Open a terminal and run the following command:",
      "language": "unknown"
    },
    {
      "code": "The output should contain your EDNS client subnet:",
      "language": "unknown"
    },
    {
      "code": "3. To verify your EDNS client subnet, obtain your source IP address:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "The source IP address should fall within the /24 range specified by your EDNS client subnet.\n\n## Clear DNS cache\n\nModern web browsers and operating systems are designed to cache DNS records for a set amount of time. When a request is made for a DNS record, the browser cache is the first location checked for the requested record. A DNS policy may not appear to work if the response is already cached.\n\nTo clear your DNS cache:\n\nChromeOS\n\n1. Go to `chrome://net-internals/#dns`.\n2. Select **Clear host cache**.\n\nWindows\n\n1. Open the admin command prompt or PowerShell.\n2. Run the following command:",
      "language": "unknown"
    },
    {
      "code": "macOS\n\n1. Open Terminal.\n2. Run the following commands:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Timed DNS policies  Cloudflare One docs\ndescription: By default, Cloudflare Gateway policies apply at all times when\n  turned on. With timed DNS policies, you can control when DNS policies are\n  active. You can configure a policy to be active during specific time periods\n  or set the policy to expire after a certain duration.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/timed-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/timed-policies/index.md\n---\n\nBy default, Cloudflare Gateway policies apply at all times when turned on. With timed DNS policies, you can control when DNS policies are active. You can configure a policy to be active during specific time periods or set the policy to expire after a certain duration.\n\nThere are two timed DNS policy options:\n\n* [Policy duration](#policy-duration): The policy is active for a specific amount of time after being turned on (for example, 30 minutes).\n* [Policy schedule](#policy-schedule): The policy is active during a recurring weekly schedule (for example, weekdays from 9 AM to 5 PM).\n\n## Policy duration\n\nYou can use a time-based policy duration to set a specific time frame for the policy to turn on or configure an exact time for the policy to turn off.\n\nTo set a duration for a DNS policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **DNS**.\n\n2. Create a new DNS policy or choose an existing policy and select **Edit**.\n\n3. In **Apply durations and schedules**, turn on **Policy duration**.\n\n4. In **Input method**, choose the type of duration:\n\n   * Choose *Duration* and enter a specific amount of time until the policy turns off.\n   * Choose *Exact end date* and enter a specific date and time in your account's time zone for the policy to turn off.\n\n5. Select **Save policy**.\n\nWhen a policy turns off, it will remain off until you turn it back on.\n\nPolicies with a set duration will retain their duration when turned off or on. For example, you can create a policy at 12:00 PM and set it to turn off after six hours. If you turn the policy off at 3:00 PM and turn it back on 4:00 PM, the policy will still turn off at 6:00 PM, six hours after the original time.\n\n### Reset a policy's duration\n\nWhen a policy's time duration expires, you can turn the policy back on for the duration you originally configured. To reset a policy's duration, select the policy and choose **Reset policy duration**.\n\nFor policies with an exact end time, you can change the time before the policy turns off. Once the policy reaches its exact end time, you will need to edit the policy and set a new end time. To set a new exact end time:\n\n1. Select the policy.\n2. Choose **Edit**.\n3. Turn on **Set a policy duration**.\n4. In **Input method**, choose *Exact end date*. In **Date and time**, enter a new date and time for the policy to turn off.\n5. Select **Save policy**.\n\n## Policy schedule\n\nYou can use Gateway to create a new DNS policy with a schedule or add a schedule to an existing policy.\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **DNS**.\n  2. Create a new DNS policy or choose an existing policy and select **Edit**.\n  3. In **Apply durations and schedules**, turn on **Policy schedule**.\n  4. (Optional) In **Time Zone**, choose a time zone to apply the policy based on the time zone you select, regardless of the user's location. By default, Gateway will use the end user's time zone to apply the policy based on the local time of the user making the DNS query.\n  5. In **Schedule template**, choose a preset schedule, or choose *Custom schedule* to define a custom schedule. You can choose up to three non-overlapping time ranges of 15 minute intervals.\n  6. Select **Save policy**.\n\n* API\n\n  To schedule a policy with the API, use the [Create a Zero Trust Gateway rule endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/create/) with the `schedule` parameter set to your desired days of the week, times of day, and an optional time zone. For example:",
      "language": "unknown"
    },
    {
      "code": "The policy's schedule will appear in Cloudflare One under **Traffic policies** > **Firewall policies** > **DNS** when you select the policy.\n\n### How Gateway determines time zone\n\nIf you [assign a time zone](#example-fixed-time-zone) to your schedule, Gateway will always use the current time at that time zone regardless of the user's location. This allows you to enable a policy during a certain fixed time period.\n\nIf you [do not specify a time zone](#example-users-time-zone), Gateway will enable the DNS policy based on the user's local time zone. The user's time zone is inferred from the IP geolocation of their source IP address. If Gateway is unable to determine the time zone from the source IP, we will fall back to the time zone of the data center where the query was received.\n\n#### Example: Fixed time zone\n\nThe following command creates a DNS policy to block `facebook.com` only on weekdays from 8:00 AM - 12:30 PM and 1:30 PM - 5:00 PM in the Chicago, USA time zone.",
      "language": "unknown"
    },
    {
      "code": "Refer to [this table](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List) for a list of all time zone identifiers.\n\n#### Example: User's time zone\n\nThe following command creates a DNS policy to block `clockin.com` only on weekends in the time zone where the user is currently located.",
      "language": "unknown"
    },
    {
      "code": "Note\n\nGateway will not change the policy's `enabled` status when inside or outside of the time period specified. When enabled, Gateway activates or deactivates the policy according to its schedule. When disabled, the policy is always deactivated.\n\n</page>\n\n<page>\n---\ntitle: Dedicated egress IPs  Cloudflare One docs\ndescription: Dedicated egress IPs are static IP addresses that can be used to\n  allowlist traffic from your organization. These IPs are unique to your account\n  and are not used by any other customers routing traffic through Cloudflare's\n  network. Each dedicated egress IP consists of an IPv4 address and an IPv6\n  range that are assigned to a specific Cloudflare data center. At minimum,\n  Cloudflare will provision your account with two dedicated egress IPs\n  corresponding to data centers in two different cities.\nlastUpdated: 2025-12-19T23:24:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/index.md\n---\n\nNote\n\nOnly available as an add-on to Zero Trust Enterprise plans.\n\nDedicated egress IPs are static IP addresses that can be used to allowlist traffic from your organization. These IPs are unique to your account and are not used by any other customers routing traffic through Cloudflare's network. Each dedicated egress IP consists of an IPv4 address and an IPv6 range that are assigned to a specific Cloudflare data center. At minimum, Cloudflare will provision your account with two dedicated egress IPs corresponding to data centers in two different cities.\n\nAn account can have any number of additional dedicated egress IPs. To request additional dedicated egress IPs, contact your account team to schedule a service window.\n\n## Turn on egress IPs\n\nTo start routing traffic through dedicated egress IPs:\n\n1. Contact your account team to obtain a dedicated egress IP.\n2. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n3. Turn on **Allow Secure Web Gateway to proxy traffic**.\n4. Select **TCP**.\n5. (Optional) Select **UDP**. This will allow HTTP/3 traffic to egress with your dedicated IPs.\n\nDedicated egress IPs are now turned on for all network and HTTP traffic proxied by Gateway. To selectively turn on dedicated egress IPs for a subset of your traffic, refer to [egress policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/).\n\n## Verify egress IPs\n\nTo check if your device is using the correct dedicated egress IP:\n\n1. Verify that the device is connected to your Zero Trust organization through the WARP client.\n2. Determine the source IPv4 address of your device by going to `https://ipv4.icanhazip.com/`.\n3. Determine the source IPv6 address of your device by going to `https://ipv6.icanhazip.com/`.\n4. Verify that the source IPv4 and IPv6 addresses match your dedicated egress IP.\n\nWhen testing against another origin, you may see either an IPv4 or IPv6 address. Gateway has no control over whether connections are made over IPv4 or IPv6. Some origins are only available over IPv4, while others are only available over IPv6. When both protocols are supported, the decision is made by the operating system and browser on the client device. For example, Windows will by default [favor IPv6](https://learn.microsoft.com/troubleshoot/windows-server/networking/configure-ipv6-in-windows) over IPv4.\n\n## IPs\n\n### Bring your own IP address (BYOIP)\n\nEnterprise users can use their own authority-provided IPv4 and IPv6 addresses as dedicated egress IPs. Gateway supports bringing your own IPv4 and IPv6 addresses. To obtain an IPv6 range, refer to [American Registry for Internet Numbers (ARIN)](https://www.arin.net/resources/guide/ipv6/first_request/) or [Regional Internet Registry for Europe, Middle East and Central Asia (RIPE NCC)](https://www.ripe.net/manage-ips-and-asns/ipv6/request-ipv6/).\n\nAfter you onboard your IP addresses, the IP addresses will appear when you create a [egress policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/) and choose **Use dedicated egress IPs (Cloudflare or BYOIP)** as the [egress method](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#egress-methods). BYOIP dedicated egress IPs do not support [IP geolocation](#ip-geolocation).\n\nFor more information, refer to [Cloudflare BYOIP](https://developers.cloudflare.com/byoip/) or contact your account team.\n\n### Cloudflare IPs\n\nIf you do not have your own authority-provided IPv4 and IPv6 addresses, you can use dedicated egress IPs with a Cloudflare IP address.\n\nYou can find your leased Gateway dedicated egress IPs on the dashboard under [**IP addresses** > **Leased IPs**](https://dash.cloudflare.com/?to=/:account/ip-addresses/leased-ips).\n\n## Limitations\n\n### Concurrent connections\n\nEach dedicated egress IP assigned to your organization supports 40,000 concurrent connections per destination IP and destination port. You can configure multiple origins for each combination of dedicated egress IP and source port.\n\n### Unsupported traffic\n\nDedicated egress IPs do not apply to:\n\n* DNS queries resolved through Gateway\n* Private networks connected to Zero Trust via Cloudflare Tunnel\n* Traffic destined for private networks connected to Zero Trust via [Magic WAN](https://developers.cloudflare.com/magic-wan/)\n* ICMP traffic (such as `ping`)\n\nThese origins will see the default shared IPs instead of the dedicated egress IPs. This is because Cloudflare can filter traffic to these origins by identifiers other than source IP.\n\n### Traffic resilience\n\nTo improve traffic resilience, assign your dedicated egress IPs to different Cloudflare data center locations. If you have multiple IPs in the same city, choose different data centers within that city. For more information, contact your account team.\n\nWhen creating egress policies with dedicated egress IPs, you must set a secondary IPv4 address to ensure traffic resilience. You can set the secondary IPv4 address to `0.0.0.0` or a specific Cloudflare location different from your primary IPv4 address. If you set the secondary IPv4 address to `0.0.0.0`, Gateway will route traffic to the location closest to the user. If the physical location of your primary IPv4 address is not available, Gateway will route traffic to either the default Cloudflare egress range or the secondary location specified.\n\nFallback egress IPs\n\nIf the location for your primary egress IPs goes down and there is no secondary backup IP address configured in the egress policy, Gateway will not properly route your traffic. Cloudflare recommends you always configure a fallback egress IP for every egress policy.\n\n### IP geolocation\n\nNote\n\nIP geolocation will take at least six weeks to update across databases.\n\nYour egress traffic will geolocate to the city selected in your [egress policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/). If the traffic does not match an egress policy, IP geolocation defaults to the closest dedicated egress location to the user. We recommend you create a [catch-all egress policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#catch-all-policy) before dedicated egress IPs are assigned to your account. This will prevent incorrect geolocation for your users' traffic while geolocation databases update.\n\nWhen you turn on dedicated egress IPs, Gateway will update third-party IP geolocation databases. Other websites, such as Google Search, will check these databases to geolocate a user's source IP. For example, if your users are in India, Google will direct them to the United States Google landing page instead of the India landing page until Google recognizes the updated IP geolocation.\n\nTo verify that the IP geolocation has updated, check your dedicated egress IP in one of the supported databases:\n\nSupported IP geolocation databases\n\n* [Google](https://developers.google.com/maps/documentation/geolocation/overview)\n* [MaxMind GeoIP](https://www.maxmind.com/en/geoip-databases)\n* [TransUnion Neustar TruValidate IP Intelligence](https://www.transunion.com/solution/truvalidate/digital-insights/ip-intelligence)\n* [Abstract IP Geolocation API](https://www.abstractapi.com/ip-geolocation-api)\n* [DB-IP](https://db-ip.com/)\n* [Digital Element](https://www.digitalelement.com/)\n* [Geo Targetly](https://geotargetly.com/)\n* [IP-API.com](https://ip-api.com/)\n* [IP2Location](https://lite.ip2location.com/)\n* [IPinfo.io](https://ipinfo.io/)\n* [ip2c.org](https://ip2c.org/)\n* [ipapi](https://ipapi.com/)\n* [ipgeolocation.io](https://ipgeolocation.io/)\n* [ipify](https://www.ipify.org/)\n* [Ipstack](https://ipstack.com/)\n\n### Egress location\n\nYour users' physical egress location will vary depending on whether their connection is over IPv4 or IPv6.\n\n| Protocol | Destination proxied by Cloudflare | Physical egress location | IP geolocation |\n| - | - | - | - |\n| IPv4 | No | Data center with dedicated egress IP | Matches dedicated egress IP location |\n| IPv4 | Yes | Locally connected data center | Matches dedicated egress IP location |\n| IPv6 | No | Locally connected data center | Matches dedicated egress IP location |\n| IPv6 | Yes | Locally connected data center | Matches dedicated egress IP location |\n\n#### IPv4\n\nTo physically egress from a specific location, traffic must be proxied to Cloudflare via IPv4. The end user connects to the nearest Cloudflare data center, but Cloudflare will internally route their traffic to egress from the dedicated location configured in your [egress policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/). Therefore, the connected data center shown in the user's WARP client preferences may not match their actual egress location.\n\nWe are able to offer better IPv4 performance when users visit domains proxied by Cloudflare (also known as an [orange-clouded](https://developers.cloudflare.com/dns/proxy-status/) domain). In this scenario, IPv4 traffic will physically egress from the most performant data center in our network while still appearing to egress from your dedicated location.\n\nFor example, assume you have a primary dedicated egress IP in Los Angeles and a secondary dedicated egress IP in New York. A user in Las Vegas would see Las Vegas as their connected data center. If they go to a site not proxied by Cloudflare ([gray-clouded](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records)), such as `espn.com`, they will egress from Los Angeles (or whichever city is in the matching egress policy). If they go to an orange-clouded site such as `cloudflare.com`, they will physically egress from Las Vegas but use Los Angeles as their IP geolocation.\n\nIPv4 and IPv6 behavior\n\nIPv4 addresses are limited, so Cloudflare must physically route traffic to the data center where your dedicated IPv4 address is provisioned. IPv6 has virtually unlimited address space, so Cloudflare can assign IPv6 ranges from all geolocations to every data center. This means IPv6 traffic can egress locally while still appearing to originate from your configured geolocation.\n\n#### IPv6\n\nTraffic proxied via IPv6, unlike IPv4, will physically egress from the connected data center but logically egress with one of your dedicated IP geolocations. This is possible because IPv6 has significantly more address space available, allowing Cloudflare to assign IPv6 ranges from all possible geolocations to every data center. Each account receives a /64 IPv6 range, which provides ample space for this approach.\n\nIn the example above, the Las Vegas user would physically egress from Las Vegas but their traffic would IP geolocate to Los Angeles. This means:\n\n| Attribute | Value |\n| - | - |\n| Physical egress | User's closest Cloudflare data center (Las Vegas) |\n| IP geolocation | Dedicated egress IP location configured in your egress policy (Los Angeles) |\n| Logs | Correct IP geolocation (Los Angeles) even though the physical egress is from a different location (Las Vegas) |\n\n## Frequently asked questions (FAQ)\n\n### Can I provision the same egress IP address to multiple data centers?\n\nNo, egress IPs are limited to a single data center.\n\n### Can my users in different locations egress from their closest data center via a single egress IP?\n\nNo, traffic will only egress from the data center where the egress IP is provisioned. If you have users in locations far apart, we recommend reserving multiple egress IPs across different data centers and provisioning your users to their closest data centers.\n\n### Can I use dedicated egress IPs with traffic proxied via [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)?\n\nYes, your users will egress via their provisioned IP address.\n\n### What happens when I use dedicated egress IPs with [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/)?\n\nYour users will connect to the nearest data center, where the remote browser session will load. The remote browser will then egress via the data center with their provisioned egress IP.\n\n### Do dedicated egress IPs work on the [Cloudflare China Network](https://developers.cloudflare.com/china-network/)?\n\nNo, Gateway does not support dedicated egress IPs on the China Network.\n\n</page>\n\n<page>\n---\ntitle: Egress through Cloudflare Tunnel  Cloudflare One docs\ndescription: Cloudflare Tunnel can be used for source IP anchoring when you want\n  to use existing egress IPs instead of purchasing Cloudflare dedicated egress\n  IPs. Some third-party websites may have an Access Control List (ACL) that only\n  allow connections from certain source IPs. If you already a non-Cloudflare IP\n  on their allowlist (such an egress IP provided by an ISP or a cloud provider\n  like AWS), you can configure cloudflared to anchor user traffic to the same\n  IPs that you use today.\nlastUpdated: 2025-12-19T16:25:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/egress-cloudflared/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/egress-cloudflared/index.md\n---\n\nWARP feature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) |\n| - |\n| Gateway with WARP |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2025.4.929.0 |\n| macOS |  | 2025.4.929.0 |\n| Linux |  | 2025.4.929.0 |\n| iOS |  | 1.11 |\n| Android |  | 2.4.2 |\n| ChromeOS |  | 2.4.2 |\n\nCloudflare Tunnel can be used for source IP anchoring when you want to use existing egress IPs instead of purchasing [Cloudflare dedicated egress IPs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/). Some third-party websites may have an Access Control List (ACL) that only allow connections from certain source IPs. If you already a non-Cloudflare IP on their allowlist (such an egress IP provided by an ISP or a cloud provider like AWS), you can configure `cloudflared` to anchor user traffic to the same IPs that you use today.\n\nFor example, assume that your organization's banking service, `app.bank.com`, expects user traffic to come from an AWS IP. You can install `cloudflared` in your AWS environment and add a public hostname route pointing to `app.bank.com`. When users connect to `app.bank.com` using the WARP client, Gateway will apply your network policies and route the filtered traffic down the corresponding Cloudflare Tunnel to AWS. The traffic can then egress to the public Internet using your AWS egress IP.",
      "language": "unknown"
    },
    {
      "code": "To learn more about how Gateway applies hostname-based egress policies, refer to the [Cloudflare blog](https://blog.cloudflare.com/egress-policies-by-hostname/).\n\n## Prerequisites\n\nUser traffic is on-ramped to Gateway using one of the following methods:\n\n| On-ramp method | Compatibility |\n| - | - |\n| [WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) |  |\n| [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) |  |\n| [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) |  |\n| [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/) |  |\n| [Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/) | [1](#user-content-fn-1) |\n\nWARP feature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) |\n| - |\n| Gateway with WARP |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2025.4.929.0 |\n| macOS |  | 2025.4.929.0 |\n| Linux |  | 2025.4.929.0 |\n| iOS |  | 1.11 |\n| Android |  | 2.4.2 |\n| ChromeOS |  | 2.4.2 |\n\n## Footnotes\n\n1. Not compatible with [ECMP routing](https://developers.cloudflare.com/magic-wan/reference/traffic-steering/#equal-cost-multi-path-routing). For hostname-based routing to work, DNS queries and the resulting network traffic must reach Cloudflare over the same Magic WAN tunnel.\\\n   [](#user-content-fnref-1)\n\n## 1. Connect your private network\n\n[Connect your private network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/) to Cloudflare using `cloudflared`. For example, if you want traffic to egress from AWS, connect the private CIDR block of your AWS VPC.\n\nNote\n\nRequires `cloudflared` version 2025.7.0 or later.\n\n## 2. Add a public hostname route\n\nTo route a public hostname through Cloudflare Tunnel:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Routes** > **Hostname routes**.\n\n2. Select **Create hostname route**.\n\n3. In **Hostname**, enter the public hostname that represents the application (for example, `app.bank.com`). The hostname should be accessible from the public Internet.\n\n4. For **Tunnel**, select the Cloudflare Tunnel that is being used to connect the private network to Cloudflare.\n\n5. Select **Create route**.\n\n## 3. Route network traffic through WARP\n\nIn your WARP [Split Tunnels](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) configuration, route the following IP addresses through the WARP tunnel to Gateway.\n\n### Initial resolved IPs\n\nWhen users connect to a public hostname route, Gateway will assign an initial resolved IP to the DNS query from the following range:\n\nThe initial resolved IP is required because Gateway's network engine operates at L3/L4 and can only see IPs (not hostnames) when processing the connection. If a packet's destination IP falls within the initial resolved IP CGNAT range, Gateway knows that the IP maps to a public hostname route and sends the traffic down the corresponding Cloudflare Tunnel.\n\nTo route initial resolved IPs through WARP:\n\nIn your WARP [device profile](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/), configure [Split Tunnels](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) such that the initial resolved IPs route through the WARP tunnel. Refer to the steps below for your Split Tunnels mode:\n\n* Exclude IPs and domains\n\n  1. [Remove the route](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#remove-a-route) to the IP address `100.64.0.0/10` from your Split Tunnel exclude list.\n\n  2. We recommend [adding back the IPs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/#3-route-private-network-ips-through-warp) that are not being used for Zero Trust services. For example, if you are using initial resolved IPs alongside [WARP-to-WARP connectivity](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-to-warp/), add routes to exclude the following IP addresses:\n\n     * `100.64.0.0/12`\n     * `100.81.0.0/16`\n     * `100.82.0.0/15`\n     * `100.84.0.0/14`\n     * `100.88.0.0/13`\n     * `100.112.0.0/12`\n\n* Include IPs and domains\n\n  1. Add the required [Zero Trust domains](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-domains) or [IP addresses](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-ip-addresses) to your Split Tunnel include list.\n\n  2. [Add routes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#add-a-route) to include the following IP addresses:\n\n     * **IPv4**: `100.80.0.0/16`\n     * **IPv6**: `2606:4700:0cf1:4000::/64`\n\n### Private network IPs\n\nYour private network's CIDR block should also route through the WARP tunnel. For a detailed configuration example, refer to [Connect a private network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/#3-route-private-network-ips-through-warp).\n\n## 4. (Optional) Configure network policies\n\nYou can build [Gateway network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) to filter HTTPS traffic to your public hostname on port `443`. For example, suppose that you want to block all WARP users from accessing `app.bank.com` except for a specific set of users or groups. Additionally, those authorized users should only access `app.bank.com` using your AWS egress IP. You can accomplish this using two policies: the first allows specific users to reach `app.bank.com`, and the second blocks all other port `443` traffic to `app.bank.com`.\n\n1. Allow company employees:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | SNI | in | `app.bank.com` | And | Allow |\n   | User Email | matches regex | `.*@example.com` | | |\n\n2. Block everyone else on port `443`:\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | SNI | in | `app.bank.com` | Block |\n\nGateway does not currently support hostname-based filtering for traffic on non-`443` ports. To block traffic to `app.bank.com` on all ports, you will need to use the [Destination IP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#destination-ip) selector and specify the public IP space of `app.bank.com`.\n\n## 5. Test the connection\n\nFrom a WARP device, open a browser and go to `app.bank.com`.\n\nYou can search for `app.bank.com` in your [Gateway DNS logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/); the **DNS response details** section should show the public resolved IPs as well as an initial resolved IP. You can also check your [Cloudflare Tunnel logs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/monitor-tunnels/logs/) to confirm that requests are routing through the tunnel to the public resolved IPs.\n\n## Limitations\n\n### Google Chrome restricts local network access\n\nStarting with [Chrome 142](https://developer.chrome.com/release-notes/142), the browser restricts requests from websites to local IP addresses, including the Gateway initial resolved IP CGNAT range (`100.80.0.0/16`). When a website attempts to access a domain resolved through an initial resolved IP, the browser will display a prompt from the website asking to look for and connect to devices on the local network. Chrome will block requests to these domains until the user accepts this prompt.\n\nTo avoid this issue, choose one of the following options:\n\n* Disable the Chrome feature flag: Go to `chrome://flags` and set the **Local Network Access Checks** flag to *Disabled*.\n* Configure Chrome Enterprise policy: Use the **LocalNetworkAccessAllowedForUrls** policy to allow specific websites to make requests to these domains. For more information, refer to the [Chrome Enterprise documentation](https://chromeenterprise.google/policies/#LocalNetworkAccessAllowedForUrls).\n\n</page>\n\n<page>\n---\ntitle: Host selectors  Cloudflare One docs\ndescription: When Gateway receives a DNS query for hostname covered by the\n  Application, Content Categories, Domain, and Host selectors in an Egress\n  policy, Gateway initially resolves DNS to an IP in the 100.80.0.0/16 or\n  2606:4700:0cf1:4000::/64 range. This process allows Gateway to map a\n  destination IP with a hostname at layer 4 (where Gateway evaluates Egress\n  policies). The destination IP for a hostname is not usually known at layer 4.\n  Prior to evaluating Egress policies, the initially resolved IP is overwritten\n  with the correct destination IP.\nlastUpdated: 2025-12-19T16:25:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/host-selectors/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/host-selectors/index.md\n---\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/teams-pricing/) |\n| - | - |\n| Gateway with WARP | Enterprise |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2025.4.929.0 |\n| macOS |  | 2025.4.929.0 |\n| Linux |  | 2025.4.929.0 |\n| iOS |  | |\n| Android |  | |\n| ChromeOS |  | |\n\nWhen Gateway receives a DNS query for hostname covered by the [Application](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#application), [Content Categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#content-categories), [Domain](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#domain), and [Host](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#host) selectors in an Egress policy, Gateway initially resolves DNS to an IP in the `100.80.0.0/16` or `2606:4700:0cf1:4000::/64` range. This process allows Gateway to map a destination IP with a hostname at [layer 4](https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/) (where Gateway evaluates Egress policies). The destination IP for a hostname is not usually known at layer 4. Prior to evaluating Egress policies, the initially resolved IP is overwritten with the correct destination IP.\n\n![Example egress policy flow](https://developers.cloudflare.com/_astro/host-selector-diagram.MWSMsbT4_4QdTE.webp)\n\nAdditional configuration is required when using policies with these selectors.\n\n## Turn on Host selectors\n\nTo turn on the selectors for your account:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. In **Policy settings**, turn on **Allow egress policy host selectors**.\n\n* API\n\n  Use the [Patch Zero Trust account configuration](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/configurations/methods/edit/) endpoint to update your Zero Trust configuration. For example:",
      "language": "unknown"
    },
    {
      "code": "## Prerequisites\n\nTraffic must be on-ramped to Gateway with the following methods:\n\n| On-ramp method | Compatibility |\n| - | - |\n| [WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) |  |\n| [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) |  |\n| [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) |  |\n| [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/) |  |\n| [Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/) |  |\n\nUnsupported traffic will be resolved with your default Gateway settings. If you use DNS locations to send a DNS query to Gateway with IPv4, IPv6, DoT, or DoH, Gateway will not return the initial resolved IP for supported traffic nor resolve unsupported traffic.\n\n### Configuration changes\n\nWarning\n\nGateway will overwrite the DNS response for all supported traffic, even if you use identity or device posture selectors to limit which users or devices are affected by the policy. In these cases, while the DNS response is overwritten, Gateway will still apply the correct Egress policy. Therefore, the configuration changes below must be applied to all of your users and device profiles.\n\nTo configure your Zero Trust organization to use Host selectors with Egress policies:\n\n1. Ensure you have deployed [WARP version 2025.4.929.0](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/) or later on your users' desktop devices. If you need to apply your policies to mobile devices or devices running a version of WARP prior to 2025.4.929.0, add and deploy the following key-value pair to your devices' [WARP configuration file](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/) (`mdm.xml` on Windows and Linux or `com.cloudflare.warp.plist` on macOS):",
      "language": "unknown"
    },
    {
      "code": "1) In your WARP [device profile](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/), configure [Split Tunnels](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) such that the initial resolved IPs route through the WARP tunnel. Refer to the steps below for your Split Tunnels mode:\n\n   * Exclude IPs and domains\n\n     1. [Remove the route](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#remove-a-route) to the IP address `100.64.0.0/10` from your Split Tunnel exclude list.\n\n     2. We recommend [adding back the IPs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/#3-route-private-network-ips-through-warp) that are not being used for Zero Trust services. For example, if you are using initial resolved IPs alongside [WARP-to-WARP connectivity](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-to-warp/), add routes to exclude the following IP addresses:\n\n        * `100.64.0.0/12`\n        * `100.81.0.0/16`\n        * `100.82.0.0/15`\n        * `100.84.0.0/14`\n        * `100.88.0.0/13`\n        * `100.112.0.0/12`\n\n   * Include IPs and domains\n\n     1. Add the required [Zero Trust domains](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-domains) or [IP addresses](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-ip-addresses) to your Split Tunnel include list.\n\n     2. [Add routes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#add-a-route) to include the following IP addresses:\n\n        * **IPv4**: `100.80.0.0/16`\n        * **IPv6**: `2606:4700:0cf1:4000::/64`\n\nThe WARP client must be set to *Gateway with WARP* mode for traffic affected by these selectors to route correctly.\n\n## Known issues\n\n### Google Chrome restricts local network access\n\nStarting with [Chrome 142](https://developer.chrome.com/release-notes/142), the browser restricts requests from websites to local IP addresses, including the Gateway initial resolved IP CGNAT range (`100.80.0.0/16`). When a website attempts to access a domain resolved through an initial resolved IP, the browser will display a prompt from the website asking to look for and connect to devices on the local network. Chrome will block requests to these domains until the user accepts this prompt.\n\nTo avoid this issue, choose one of the following options:\n\n* Disable the Chrome feature flag: Go to `chrome://flags` and set the **Local Network Access Checks** flag to *Disabled*.\n* Configure Chrome Enterprise policy: Use the **LocalNetworkAccessAllowedForUrls** policy to allow specific websites to make requests to these domains. For more information, refer to the [Chrome Enterprise documentation](https://chromeenterprise.google/policies/#LocalNetworkAccessAllowedForUrls).\n\n</page>\n\n<page>\n---\ntitle: AV scanning  Cloudflare One docs\ndescription: Cloudflare Gateway protects users as they browse the Internet. When\n  users download or upload a file to an origin on the Internet, that file could\n  potentially contain malicious code that may cause their device to perform\n  undesired behavior. To prevent this, Cloudflare Gateway allows admins to turn\n  on anti-virus (AV) scanning of files that are uploaded or downloaded by users\n  as the file passes through Gateway.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/index.md\n---\n\nCloudflare Gateway protects users as they browse the Internet. When users download or upload a file to an origin on the Internet, that file could potentially contain malicious code that may cause their device to perform undesired behavior. To prevent this, Cloudflare Gateway allows admins to turn on anti-virus (AV) scanning of files that are uploaded or downloaded by users as the file passes through Gateway.\n\nIn addition to scanning files, Gateway can quarantine files as your users download them. Quarantining files helps protect organizations from zero-day vulnerabilities not yet available in anti-virus databases. For more information, refer to [File sandboxing](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/file-sandboxing/).\n\n## Get started\n\nTo turn on AV scanning:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. In **Policy settings**, turn on **Scan files for malware**.\n3. Choose whether to scan files for malicious payloads during uploads, downloads, or both. You can also block requests containing [non-scannable files](#non-scannable-files).\n4. (Optional) Turn on **Display AV block notification for WARP Client** to send [block notifications](#warp-client-block-notifications) to users connected to Gateway with the WARP Client when AV inspection blocks a file.\n\nWhen a request is blocked due to the presence of malware, Gateway will log the match as a Block decision in your [HTTP logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/#http-logs).\n\n### WARP client block notifications\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/plans/zero-trust-services/) |\n| - | - |\n| * Gateway with WARP\n* Secure Web Gateway without DNS filtering | Enterprise |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows |  | 2024.1.159.0 |\n| macOS |  | 2024.1.160.0 |\n| Linux |  | |\n| iOS |  | 1.7 |\n| Android |  | 1.4 |\n| ChromeOS |  | 1.4 |\n\nTurn on **Display AV block notification for WARP Client** to display notifications for Gateway block events. Blocked users will receive an operating system notification from the WARP client with a custom message you set. If you do not set a custom message, the WARP client will display a default message. Custom messages must be 100 characters or less. WARP will only display one notification per minute.\n\nUpon selecting the notification, WARP will direct your users to the [Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) you have configured. Optionally, you can direct users to a custom URL, such as an internal support form.\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\nEnsure that your operating system allows notifications for WARP. Your device may not display notifications if focus, do not disturb, or screen sharing settings are turned on. To turn on client notifications on macOS devices running DisplayLink software, you may have to allow system notifications when mirroring your display. For more information, refer to the [macOS documentation](https://support.apple.com/guide/mac-help/change-notifications-settings-mh40583/mac).\n\n## File scan criteria\n\nIf AV scanning is turned on, Gateway will use the following criteria to determine whether a file is present in a request or response, and whether to scan that file. The first match will result in the file being scanned.\n\n* If the `Content-Disposition` HTTP header is `Attachment`\n\n* If the byte signature of the body of the request matches a signature Gateway identifies as one of the following file type categories:\n\n  * **Executable** (for example, `.exe`, `.bat`, `.dll`, and `.wasm`)\n  * **Documents** (for example, `.doc`, `.docx`, `.pdf`, `.ppt`, and `.xls`)\n  * **Compressed** (for example, `.7z`, `.gz`, `.zip`, and `.rar`)\n\n* If the file name in the `Content-Disposition` header contains a file extension that indicates it is one of the file type categories above\n\nIf none of the above conditions trigger a file to be scanned, Gateway will use the origin's `Content-Type` header to determine whether or not to scan the file. Additionally, Gateway will not scan files it determines to be image, video, or audio files.\n\nIf a file does not trigger a scan based on the three methods above but also does not match criteria to be exempted from scanning, Gateway will default to scanning the file for malware.\n\n## Opt content out from scanning\n\nWhen an admin turns on AV scanning for uploads and/or downloads, Gateway will scan every supported file. Admins can selectively choose to disable scanning using HTTP policies. All [HTTP selectors](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#selectors) can opt HTTP traffic out from AV scanning using the **Do Not Scan** action. When traffic matches a Do Not Scan policy, nothing is scanned, regardless of file size or whether the file type is supported or not. For example, to prevent AV scanning of files uploaded to or downloaded from `example.com`, you can create the following policy:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Hostname | matches regex | `example.com` | Do Not Scan |\n\nOpting out of AV scanning applies to uploads and/or downloads of files, matching your account's global AV scanning setting. For example, if you have configured Gateway to globally scan uploads only, then opting out of AV scanning will only apply to uploads.\n\n## Compatibility\n\n### Supported compressed file types\n\nIn addition to standard object files like PDFs, Zero Trust supports AV scanning for the following archive types:\n\nSupported compressed file types\n\n* 7-Zip\n* 7-Zip SFX\n* ACE\n* ACE SFX\n* AutoHotkey\n* AutoIt\n* BASE64\n* BZ2\n* CHM Help Files\n* CPIO SVR4\n* Chrome Extension (CRX) Package Format\n* eXtensible ARchive format (XAR)\n* GZIP compressed files\n* ISO 9660\n* Inno Setup\n* Indigo Rose Setup Factory\n* Java ARchive\n* LZH/LHA\n* MacBinary\n* MIME base64\n* MSCOMPRESS\n* Microsoft CAB\n* Microsoft TNEF\n* NSIS Nullsoft Installer\n* Office Legacy XML\n* PGP signed message, document, etc.\n* RPM\n* RAR\n* SAPCar\n* Self-extracting ARJ\n* Self-extracting CA\n* Self-extracting LZH/LHA\n* Self-extracting RAR\n* Self-extracting ZIP\n* Smart Install Maker\n* TAR\n* UUE and XXE compressed files\n* Windows Imaging File (WIM)\n* XE compressed files (UUE and XXE)\n* XZ file format\n* ZIP\n* ZOO\n\nGateway cannot scan [certain archive files](#non-scannable-files) regardless of file type, such as large or encrypted files.\n\n### Non-scannable files\n\nGateway cannot scan all files for malware. When Gateway encounters a non-scannable file, you can configure AV scanning whether to fail open (allow the file to pass through unscanned) or to fail closed (deny the file transfer).\n\nGateway cannot scan requests containing the following files:\n\n* Files larger than:\n\n  * 15 MB on Free plans\n  * 25 MB on Pay-as-you-go plans\n  * 100 MB on Enterprise plans\n\n* PGP encrypted files\n\n* Password protected archives\n\n* Archives with more than three recursion levels\n\n* Archives with more than 300 files\n\n</page>\n\n<page>\n---\ntitle: Common HTTP policies  Cloudflare One docs\ndescription: The following policies are commonly used to secure HTTP traffic.\nlastUpdated: 2025-12-15T23:07:53.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/index.md\n---\n\nThe following policies are commonly used to secure HTTP traffic.\n\nFor a baseline set of recommended policies, refer to [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/build-http-policies/recommended-http-policies/).\n\nRefer to the [HTTP policies page](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) for a comprehensive list of other selectors, operators, and actions.\n\n## Block sites\n\nBlock attempts to reach sites by hostname or URL paths. Different approaches may be required based on how a site is organized.\n\n### Block sites by hostname\n\nBlock all subdomains that use a host.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Host | matches regex | `.*example\\.com` | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Block sites by URL\n\nBlock a section of a site without blocking the entire site. For example, you can block a specific subreddit, such as `reddit.com/r/gaming`, without blocking `reddit.com`.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | URL | matches regex | `/r/gaming` | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Block content categories\n\nBlock content categories which go against your organization's acceptable use policy.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *Questionable Content*, *Security Risks*, *Miscellaneous*, *Adult Themes*, *Gambling* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Block unauthorized applications\n\nNote\n\nAfter seven days, view your [Shadow IT SaaS Analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) and block additional applications based on what your users are accessing.\n\nTo minimize the risk of [shadow IT](https://www.cloudflare.com/learning/access-management/what-is-shadow-it/), some organizations choose to limit their users' access to certain web-based tools and applications. For example, the following policy blocks known AI tools:\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application | in | *Artificial Intelligence* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Check user identity\n\nConfigure access on a per user or group basis by adding [identity-based conditions](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) to your policies.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application | in | *Salesforce* | And | Block |\n  | User Group Names | in | *Contractors* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Skip inspection for groups of applications\n\nCertain client applications, such as Zoom or Apple services, rely on certificate pinning. The [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/) performed by Cloudflare Gateway will cause errors when users visit those applications. To avoid this behavior, you must add a Do Not Inspect HTTP policy.\n\nGateway [evaluates Do Not Inspect policies first](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#http-policies). We recommend moving your Do Not Inspect policies to the top of the list to reduce confusion.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application | in | *Do Not Inspect* | Do Not Inspect |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "Note\n\nYou can select either individual applications or the entire Do Not Inspect set, which will update as new applications are added.\n\n## Check device posture\n\nRequire devices to have certain software installed or other configuration attributes. For instructions on setting up a device posture check, refer to [Enforce device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/).\n\n### Enforce a minimum OS version\n\nPerform an [OS version check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/) to ensure users are running at least a minimum version.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Passed Device Posture Checks | in | *Minimum OS version* | Allow |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your device posture checks, use the [List device posture rules](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/methods/list/) endpoint.\n\n### Check for a specific file\n\nPerform a [file check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/file-check/) to ensure users have a certain file on their device.\n\nSince the file path will be different for each operating system, you can configure a file check for each system and use the **Or** logical operator to only require one of the checks to pass.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Passed Device Posture Checks | in | *macOS File Check* | Or | Allow |\n  | Passed Device Posture Checks | in | *Linux File Check* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your device posture checks, use the [List device posture rules](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/methods/list/) endpoint.\n\n## Enforce session duration\n\n[Require users to re-authenticate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/) after a certain amount of time has elapsed.\n\n## Isolate high risk sites in remote browser\n\nIf you are using the [Browser Isolation add-on](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/), refer to our list of [common Isolate policies](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#common-policies).\n\n## Bypass inspection for self-signed certificates\n\nWhen accessing origin servers with certificates not signed by a public certificate authority, you must bypass TLS decryption.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Domain | in | `internal.example.com` | Do Not Inspect |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Block file types\n\nBlock the upload or download of files based on their type.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Upload File Types | in | *Microsoft Office Word Document (docx)* | And | Block |\n  | Download File Types | in | *PDF (pdf)* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "For more information on supported file types, refer to [Download and Upload File Types](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#download-and-upload-file-types).\n\n## Isolate or block shadow IT applications\n\nIsolate shadow IT applications discovered by the [Application Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/) that have not been reviewed yet or are currently under review, and block applications that are not approved by your organization.\n\nFor more information on reviewing shadow IT applications, refer to [Review applications](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/#review-applications).\n\n### 1. Isolate unreviewed or in review applications\n\nIsolate applications if their approval status is *Unreviewed* or *In review*.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application Status | is | *Unreviewed* | Or | Isolate |\n  | Application Status | is | *In review* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### 2. Block unapproved applications\n\nBlock applications if their approval status is *Unapproved*.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application Status | is | *Unapproved* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Block Google services\n\nTo enable Gateway inspection for Google Drive traffic, you must [add a Cloudflare certificate to Google Drive](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#google-drive).\n\n### Block Google Drive downloads\n\nBlock file downloads from Google Drive.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application | in | *Google Drive* | And | Block |\n  | URL Path & Query | matches regex | `.*(e=download\\|export).*` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Block Google Drive uploads\n\nBlock file uploads from Google Drive.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application | in | *Google Drive* | And | Block |\n  | Upload Mime Type | matches regex | `.*` | And | |\n  | Host | is not | `drivefrontend-pa.clients6.google.com` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Block Gmail downloads\n\nBlock file downloads from Gmail.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Host | is | `mail-attachment.googleusercontent.com` | And | Block |\n  | URL Path & Query | is | `/attachment/u/0` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Block Google Translate proxy\n\nBlock use of Google Translate to translate entire webpages.\n\nWhen translating a website, Google Translate proxies webpages with the `translate.goog` domain. Your users may be able to use this service to bypass other Gateway policies. If you block `translate.goog`, users will still be able to access other Google Translate features.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Domain | matches regex | `^(.+\\.)?translate\\.goog$` | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Filter WebSocket traffic\n\nGateway does not inspect or log [WebSocket](https://datatracker.ietf.org/doc/html/rfc6455) traffic. Instead, Gateway will only log the HTTP details used to make the WebSocket connection, as well as [network session information](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/). To filter your WebSocket traffic, create a policy with the `101` HTTP response code.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | HTTP Response | is | *101 SWITCHING\\_PROTOCOLS* | Allow |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: File sandboxing  Cloudflare One docs\ndescription: In addition to anti-virus (AV) scanning, Gateway can quarantine\n  previously unseen files downloaded by your users into a sandbox and scan them\n  for malware.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/file-sandboxing/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/file-sandboxing/index.md\n---\n\nNote\n\nAvailable as an add-on to Zero Trust Enterprise plans. For more information, contact your account team.\n\nIn addition to [anti-virus (AV) scanning](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/), Gateway can quarantine previously unseen files downloaded by your users into a sandbox and scan them for malware.\n\nIf AV scanning does not detect malware in a file download, Gateway will quarantine the file in the [sandbox](#sandbox-environment). If the file has not been downloaded before, Gateway will monitor any actions taken by the file and compare them to known malware patterns. During this process, Gateway will display an interstitial page in the user's browser. If the sandbox does not detect malicious activity, Gateway will release the file from quarantine and download it to your user's device. If the sandbox detects malicious activity, Gateway will block the download. For any subsequent downloads of the file, Gateway will remember and apply its allow/block decision.\n\nGateway will log any file sandbox decisions in your [HTTP logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/#http-logs).",
      "language": "unknown"
    },
    {
      "code": "## Get started\n\nTo begin quarantining downloaded files, turn on file sandboxing:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. In **Policy settings**, turn on **Open previously unseen files in a sandbox environment**.\n3. (Optional) To block requests containing [non-scannable files](#non-scannable-files), select **Block requests for files that cannot be scanned**.\n\nYou can now create [Quarantine HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#quarantine) to determine what files to scan in the sandbox.\n\n## Create test policy\n\nTo test if file sandboxing is working, you can create a Quarantine policy that matches the [Cloudflare Sandbox Test](https://sandbox.cloudflaredemos.com/):\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies**, then select **HTTP**.\n\n2. Select **Add a policy**.\n\n3. Add the following expression:\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | Host | is | `sandbox.cloudflaredemos.com` | Quarantine |\n\n4. In **Sandbox file types**, select *ZIP Archive (zip)*.\n\n5. From a device [connected to your Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/), open a browser and go to the [Cloudflare Sandbox Test](https://sandbox.cloudflaredemos.com/).\n\n6. Select **Download Test File**.\n\nGateway will quarantine and scan the file, display an interstitial status page in the browser, then release the file for download.\n\n## Sandbox environment\n\nGateway executes quarantined files in a sandboxed Windows operating system environment. Using machine learning, the sandbox compares how files of a certain type behave compared to how these files should behave. The sandbox detects file actions down to the kernel level and compare these a real-time malware database. In addition, Gateway checks the sandbox's network activity for malicious behavior and data exfiltration.\n\n## Compatibility\n\n### Supported file types\n\nFile sandboxing supports scanning the following file types:\n\nSupported sandboxing file types\n\n* `.exe`\n* `.pdf`\n* `.doc`\n* `.docm`\n* `.docx`\n* `.rtf`\n* `.ppt`\n* `.pptx`\n* `.xls`\n* `.xlsm`\n* `.xlsx`\n* `.zip`\n* `.rar`\n\n### Non-scannable files\n\nGateway cannot scan requests containing the following files:\n\n* Files larger than 100 MB\n* PGP encrypted files\n\n</page>\n\n<page>\n---\ntitle: Application Granular Controls  Cloudflare One docs\ndescription: With Application Granular Controls, you can create Gateway HTTP\n  policies to control specific user actions within supported SaaS applications.\n  This allows you to give users access to an application while restricting the\n  actions that they can take within the application.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/granular-controls/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/granular-controls/index.md\n---\n\nWith Application Granular Controls, you can create [Gateway HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to control specific user actions within supported SaaS applications. This allows you to give users access to an application while restricting the actions that they can take within the application.\n\n## Prerequisites\n\nTo use Application Granular Controls, you must:\n\n* Install a [Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) or a [custom certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/) on your users' devices.\n* Turn on [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/).\n* Turn on the [Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/#turn-on-the-gateway-proxy).\n* (Optional) If an application uses HTTP/3, turn on the [Gateway proxy for UDP traffic](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/#enable-http3-inspection).\n* (Optional) To turn on [AI prompt logging](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#log-generative-ai-prompt-content), create a [DLP payload encryption public key](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#set-a-dlp-payload-encryption-public-key).\n\n## Create a policy with Application Granular Controls\n\nTo create a Gateway HTTP policy with Application Granular Controls:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies**. Select **HTTP**.\n\n  2. Select **Add a policy**.\n\n  3. Name the policy.\n\n  4. Under **Traffic**, build a logical expression that defines the traffic you want to allow or block. Because granular controls are specific to each application, you must use the *Application* selector with the *is* operator.\n\n  5. In **Value**, select your desired application.\n\n  6. In **Controls**, choose one or more Application Controls or individual Operations. For example, you can create a policy to block file uploads to ChatGPT:\n\n     | Selector | Operator | Value | Controls | Action |\n     | - | - | - | - | - |\n     | Application | is | *ChatGPT* | *Upload* | Block |\n\n  7. Select **Create policy**.\n\n* API\n\n  Use the [Create a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/create/) endpoint to create a policy. For example, you can create a policy to block file uploads to ChatGPT:",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/).\n\n## Control definitions\n\nGateway defines Application Granular Controls at different levels of granularity, including Application Controls and Operations.\n\n### Application Controls\n\nApplication Controls are pre-defined controls which represent user intent, such as uploads or downloads. Cloudflare defines and organizes sets of operations deemed related to specific intents in an application. Application Controls represent the most commonly used controls.\n\n### Operations\n\nOperations are the individual API-level actions that an application uses. Defining controls at operation level allows for more fine-grained policies to support use cases such as blocking only certain types of downloads. You can also define controls where there is not an existing application control that covers the required intent, such as blocking comments. However, because each SaaS application uses a unique set of operations with its own scope and behaviors, the use of operation level controls often requires analysis for each desired use case. You can also use operation-level controls in cases where you need variations to the Cloudflare-defined application controls, such as including or excluding certain operations.\n\nCloudflare provides Operations based on the [available APIs for an application](#application-apis). For more information on how Operations map to [Application Controls](#application-controls), refer to [Compatible applications](#compatible-applications).\n\n#### Operation Groups\n\nOperation Groups are groupings of operations defined by the application vendor. Operation Groups are typically based on a categorization of the different functional areas of the application, such as signature requests, or the entities that the application defines, such as files or folders. These definitions vary by application. Gateway groups operations into these operation groups to match the operations with the corresponding vendor API documentation.\n\n### DLP payloads\n\nYou can use Application Granular Controls with [Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) for operations that contain scannable content. This includes operations that contain the content of uploaded or downloaded files or AI prompts. For example, when a user performs a file upload, a sequence of API operations may result, such as setting up the file metadata, uploading the file content, and finalizing the upload. When applying DLP to your Zero Trust traffic, it can be helpful to specifically target an operation that contains file content.\n\n## Application APIs\n\nSaaS applications typically provide multiple APIs to interact with. For each application, Application Granular Controls may support the following API types:\n\n* Web Application API: These APIs are consumed by the web application that users interact with through their browser.\n* Platform API: These APIs are exposed to users to allow for programmatic interaction with the SaaS application. These are typically used by automations, scripts, or other applications.\n\n[Application Controls](#application-controls) include Operations of both API types. If both API types are available when creating HTTP policies using [Operations](#operations), you should select the Operations that align to the API being used, or include both for wider coverage.\n\n## Compatible applications\n\nApplication Granular Controls supports the following applications:\n\nAI\n\n* ChatGPT\n* Google Gemini\n* Perplexity\n* Claude\n\nFile sharing\n\n* Box\n* Dropbox\n* Google Drive\n* ShareFile\n* Hightail\n* Smash\n* WeTransfer\n\n</page>\n\n<page>\n---\ntitle: HTTP/3 inspection  Cloudflare One docs\ndescription: Gateway supports inspection of HTTP/3 traffic, which uses the QUIC\n  protocol over UDP.\nlastUpdated: 2025-11-21T16:14:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/index.md\n---\n\nGateway supports inspection of HTTP/3 traffic, which uses the QUIC protocol over UDP.\n\nGateway applies HTTP policies to HTTP/3 traffic last. For more information, refer to the [order of enforcement](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#http3-traffic).\n\n## Turn on HTTP/3 inspection\n\nBefore you can inspect any HTTPS traffic, you must deploy a [user-side certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) to your devices and turn on [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/). To inspect HTTP/3 traffic, you must also turn on the [Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/) for UDP.\n\nTo turn on the Gateway proxy for UDP and TLS decryption:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. In **Proxy and inspection**, turn on **Allow Secure Web Gateway to proxy traffic**.\n3. Select **TCP** and **UDP**.\n4. Turn on **TLS decryption**.\n\n### Application limitations\n\nGateway can inspect HTTP/3 traffic from Mozilla Firefox and Microsoft Edge by establishing an HTTP/3 proxy connection. Gateway will then terminate the HTTP/3 connection, decrypt and inspect the traffic, and connect to the destination server over HTTP/2. Gateway can also inspect other HTTP applications, such as cURL.\n\nIf both the UDP proxy and TLS decryption are turned on in Cloudflare One, Google Chrome will cancel all HTTP/3 connections and retry them with HTTP/2, allowing you to enforce your HTTP policies. If either the UDP proxy or TLS decryption is turned off, HTTP/3 traffic from Chrome will bypass inspection.\n\n## Exempt HTTP/3 traffic from inspection\n\nIf you require HTTP/3 traffic with end-to-end encryption from the client to the origin while still using the Gateway proxy, you can create a [Do Not Inspect HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) to match the desired traffic. Using a Do Not Inspect policy allows HTTP/3 traffic to preserve proxy performance and end-to-end encryption by bypassing Gateway's TLS decryption and inspection.\n\n## Force HTTP/2 traffic\n\nTo apply Gateway policies to HTTP traffic without turning on the UDP proxy, you must turn off QUIC in your users' browsers to ensure only HTTP/2 traffic reaches Gateway.\n\nGoogle Chrome\n\n1. Go to `chrome://flags`\n2. Set **Experimental QUIC protocol** to *Disabled*.\n3. Relaunch Chrome.\n\nSafari\n\nYou cannot turn off QUIC in Safari. All traffic will be sent over HTTP/3.\n\nFirefox\n\n1. Go to `about:config`.\n2. If you receive a warning, select **Accept the Risk and Continue**.\n3. Set **network.http.http3.enable** to *false*.\n4. Relaunch Firefox.\n\nMicrosoft Edge\n\n1. Go to `edge://flags`\n2. Set **Experimental QUIC protocol** to *Disabled*.\n3. Relaunch Edge.\n\n</page>\n\n<page>\n---\ntitle: Tenant control  Cloudflare One docs\ndescription: With Gateway tenant control, you can allow your users access to\n  corporate SaaS applications while blocking access to personal applications.\n  This helps prevent the loss of sensitive or confidential data from a corporate\n  network.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tenant-control/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tenant-control/index.md\n---\n\nWith Gateway tenant control, you can allow your users access to corporate SaaS applications while blocking access to personal applications. This helps prevent the loss of sensitive or confidential data from a corporate network.\n\nWhen creating an HTTP policy with an Allow action, you will have the option to configure custom headers. Gateway can use custom headers to control SaaS application access. If a user's HTTP request is headed to your organization's account for the SaaS application, Gateway will approve the request. If the request does not match the information in the header, Gateway will block the request.\n\n## Add custom headers for a SaaS application\n\nTo create an HTTP policy with custom headers:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies**. Select **HTTP**.\n2. Select **Add a policy**.\n3. Build an expression to match the SaaS traffic you want to control.\n4. In **Action**, select *Allow*. In **Untrusted certificate action**, select *Block*.\n5. Under **Add headers to matched requests**, select **Add a header**.\n6. Add any custom header names and values corresponding to your [SaaS application](#common-policy-configurations).\n7. Select **Create policy**.\n\nYour policy is now displayed in your list of HTTP policies. When your users attempt to authenticate your configured SaaS application with a personal account, authentication will fail.\n\n### Verify custom headers\n\nIf you save a HAR (HTTP Archive) file from a browser to analyze your web traffic, custom headers defined with Gateway will not appear in the file. This is because Gateway injects the header after the request leaves the browser.\n\nTo verify Gateway is applying a custom header:\n\n1. In your policy with custom headers, add a selector to match traffic for [HTTPBin](https://httpbin.org/), an open-source site for testing HTTP requests. For example:\n\n   | Selector | Operator | Value | Logic | Action | Untrusted certificate action |\n   | - | - | - | - | - | - |\n   | Application | in | *Google Workspace* | And | Allow | Block |\n   | Domain | in | `httpbin.org` | | | |\n\n2. On your device, go to [`httpbin.org/anything`](https://httpbin.org/anything). Your custom header will appear in the list of headers.\n\n3. (Optional) Remove the HTTPBin expression from your policy.\n\n## Common policy configurations\n\nDepending on which SaaS application your organization needs access to, different tenant control policies are required.\n\n### Microsoft 365\n\nMicrosoft 365 tenant control requires two policies. When you order your policies, make sure they follow [order of precedence](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#order-of-precedence).\n\n| Precedence | Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - | - |\n| 1 | Domain | is | `login.live.com` | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `Sec-Restrict-Tenant-Access-Policy` | `restrict-msa` |\n\n| Precedence | Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - | - |\n| 2 | Application | in | *Microsoft Office365* | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `Restrict-Access-To-Tenants`, `Restrict-Access-Context` | Your organization's domain |\n\nFor more information, refer to the [Microsoft Entra ID documentation](https://learn.microsoft.com/entra/identity/enterprise-apps/tenant-restrictions).\n\n### Google Workspace\n\n| Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - |\n| Application | in | *Google Workspace* | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `X-GooGApps-Allowed-Domains` | Your organization's domain |\n\nFor more information, refer to the [Google Workspace documentation](https://support.google.com/a/answer/1668854).\n\n### Slack\n\n| Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - |\n| Application | in | *Slack* | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `X-Slack-Allowed-Workspaces-Requester`, `X-Slack-Allowed-Workspaces` | Your organization's workspace |\n\nFor more information, refer to the [Slack documentation](https://slack.com/help/articles/360024821873-Approve-Slack-workspaces-for-your-network).\n\n### Dropbox\n\n| Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - |\n| Application | in | *Dropbox* | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `X-Dropbox-allowed-Team-Ids` | Your organization's ID |\n\nFor more information, refer to the [Dropbox documentation](https://help.dropbox.com/security/network-control).\n\n### ChatGPT\n\n| Selector | Operator | Value | Action | Untrusted certificate action |\n| - | - | - | - | - |\n| Application | in | *ChatGPT* | Allow | Block |\n\n| Custom header name | Custom header value |\n| - | - |\n| `Chatgpt-Allowed-Workspace-Id` | Your organization's workspace ID |\n\nFor more information, refer to the [OpenAI documentation](https://help.openai.com/articles/8798594-what-is-a-workspace-how-do-i-access-my-chatgpt-business-workspace).\n\n## Exempt users in Cloudflare WAF\n\nYou can include custom headers in an HTTP policy to allow your users through [Cloudflare WAF](https://developers.cloudflare.com/waf/). This is useful for allowing only WARP users through your WAF.\n\n1. Create an Allow policy for an internal domain behind your WAF with a custom header.\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | Domain | in | `internalapp.com` | Allow |\n\n   | Custom header name | Custom header value |\n   | - | - |\n   | `X-Example-Header` | `example-value` |\n\n2. In Cloudflare WAF, [create a custom rule](https://developers.cloudflare.com/waf/custom-rules/) to [require the same HTTP header](https://developers.cloudflare.com/waf/custom-rules/use-cases/require-specific-headers/#example-2-require-http-header-with-a-specific-value).\n\n## Use tenant control with Browser Isolation\n\nYou can configure [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) to send custom headers. This is useful for implementing tenant control for isolated SaaS applications or sending arbitrary custom request headers to isolated websites.\n\nTo use custom headers with Browser Isolation, create two HTTP policies targeting the same domain or application group. For example, you can create policies for [HTTPBin](https://httpbin.org/), an open-source site for testing HTTP requests:\n\n1. Create an Isolate policy for `httpbin.org`.\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | Domain | in | `httpbin.org` | Isolate |\n\n2. Create an Allow policy for `httpbin.org` with a custom header.\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | Domain | in | `httpbin.org` | Allow |\n\n   | Custom header name | Custom header value |\n   | - | - |\n   | `Example-Header` | `example-value` |\n\n3. Go to [`httpbin.org/anything`](https://httpbin.org/anything). Cloudflare will render the site in an isolated browser. Your custom header will appear in the list of headers.\n\n</page>\n\n<page>\n---\ntitle: TLS decryption  Cloudflare One docs\ndescription: Cloudflare Gateway can perform SSL/TLS decryption in order to\n  inspect HTTPS traffic for malware and other security risks.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/index.md\n---\n\nCloudflare Gateway can perform [SSL/TLS decryption](https://www.cloudflare.com/learning/security/what-is-https-inspection/) in order to inspect HTTPS traffic for malware and other security risks.\n\nWhen you turn on TLS decryption, Gateway will decrypt all traffic sent over HTTPS, apply your HTTP policies, and then re-encrypt the request with a [user-side certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/).\n\nCloudflare prevents traffic interference by decrypting, inspecting, and re-encrypting HTTPS requests in its data centers in memory only. Gateway only stores eligible cache content at rest. All cache disks are encrypted at rest. You can configure where TLS decryption takes place with [Regional Services](https://developers.cloudflare.com/data-localization/regional-services/) in the [Cloudflare Data Localization Suite (DLS)](https://developers.cloudflare.com/data-localization/). To further control what data centers traffic egresses from, you can use [dedicated egress IPs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/).\n\nCloudflare supports connections from users to Gateway over TLS 1.1, 1.2, and 1.3.\n\n## Turn on TLS decryption\n\nPrerequisite\n\nBefore you turn on TLS decryption, ensure you have installed either a [Cloudflare-generated certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) or [custom certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/) on your users' devices.\n\nTo turn on TLS decryption:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. In **Proxy and inspection**, turn on **Inspect HTTPS requests with TLS decryption**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. Configure the `tls_decrypt` argument in [`cloudflare_zero_trust_gateway_settings`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_gateway_settings):",
      "language": "unknown"
    },
    {
      "code": "## Inspection limitations\n\nGateway does not support TLS decryption for applications which use:\n\n* [Certificate pinning](#incompatible-certificates)\n* [Self-signed certificates](#incompatible-certificates)\n* [Mutual TLS (mTLS) authentication](#incompatible-certificates)\n* [ESNI and ECH handshake encryption](#esni-and-ech)\n* [Automatic HTTPS upgrades](#google-chrome-automatic-https-upgrades)\n\n### Inspect on all ports Beta\n\nBy default, Gateway will only inspect HTTP traffic through port `80`. Additionally, if you [turn on TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#turn-on-tls-decryption), Gateway will inspect HTTPS traffic through port `443`.\n\nTo detect and inspect HTTP and HTTPS traffic on ports in addition to `80` and `443`, you can turn on [protocol detection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/) and configure Gateway to [inspect traffic on all ports](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/#inspect-on-all-ports).\n\n### Incompatible certificates\n\nApplications that use certificate pinning and mTLS authentication do not trust Cloudflare certificates. For example, most mobile applications use [certificate pinning](https://developers.cloudflare.com/ssl/reference/certificate-pinning/). Cloudflare does not trust applications that use self-signed certificates instead of certificates signed by a public CA.\n\nIf you try to perform TLS decryption on an application with an incompatible certificate configuration, the application may return an SSL or trust error and/or fail to load. To resolve this issue, you can:\n\n* Add a [Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#add-the-certificate-to-applications) to supported applications.\n* Create a [Do Not Inspect policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) to exempt applications from inspection. The [Application selector](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application) provides a list of trusted applications that are known to use embedded certificates. Note that if you create a Do Not Inspect policy for an application or website, you will lose the ability to log or block HTTP requests, apply DLP policies, and perform AV scanning.\n* Configure a [Split Tunnel](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) in Include mode to ensure Gateway will only inspect traffic destined for your IPs or domains. This is useful for organizations that deploy Zero Trust on users' personal devices or otherwise expect personal applications to be used.\n\nAlternatively, to allow HTTP filtering while accessing a site with an insecure certificate, set your [Untrusted certificate action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#untrusted-certificates) to *Pass through*.\n\n### Google Chrome automatic HTTPS upgrades\n\nGoogle Chrome can automatically upgrade HTTP requests to HTTPS requests, even when you select a link that explicitly declares `http://`. When you use Gateway to proxy and filter your traffic, this upgrade can interrupt the connection between your Zero Trust users and Gateway.\n\nYou can turn off automatic HTTPS upgrades via a Gateway pass through policy, a Chrome browser flag, or a Chrome Enterprise policy.\n\n* Pass through policy\n\n  To disable automatic HTTPS upgrades for a URL across your Zero Trust organization, create a Gateway pass through policy.\n\n  1. Deploy a [custom root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/).\n\n  2. Create an [HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to match the domain of the URL being automatically upgraded. For example:\n\n     | Selector | Operator | Value | Action |\n     | - | - | - | - |\n     | URL | in | `example.com` | Allow |\n\n  3. In **Untrusted certificate action**, choose *Pass through*.\n\n  4. Select **Create policy**.\n\n  The pass through policy will bypass insecure connection upgrades for any device connected to your Zero Trust organization. For more information, refer to [Untrusted certificates](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#untrusted-certificates).\n\n* Chrome browser flag\n\n  To disable automatic HTTPS upgrades on a per-browser basis, go to [Chrome flags](chrome://flags/#https-upgrades) and turn off **HTTPS Upgrades**.\n\n* Chrome enterprise policy\n\n  Chrome Enterprise users can turn off automatic HTTPS upgrades for all URLs with a [`HttpsUpgradesEnabled` management policy](https://chromeenterprise.google/policies/#HttpsUpgradesEnabled).\n\n### Mutual TLS (mTLS)\n\nWhen decrypting TLS to inspect traffic, connections that use mutual TLS (mTLS) will fail because Gateway cannot return the necessary client certificate. To prevent connection failures, create a [Do Not Inspect policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) for this traffic.\n\n### ESNI and ECH\n\nWebsites that adhere to [ESNI or Encrypted Client Hello (ECH) standards](https://blog.cloudflare.com/encrypted-client-hello/) encrypt the Server Name Indicator (SNI) during the TLS handshake and are therefore incompatible with HTTP inspection. This is because Gateway relies on the SNI to match an HTTP request to a policy. If the ECH fails, browsers will retry the TLS handshake using the unencrypted SNI from the initial request. To avoid this behavior, you can disable ECH in your users' browsers.\n\nYou can still apply all [network policy filters](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#selectors) except for SNI and SNI Domain. To restrict ESNI and ECH traffic, an option is to filter out all port `80` and `443` traffic that does not include an SNI header.\n\n## Post-quantum support\n\nGateway supports post-quantum cryptography using a hybrid key exchange with X25519 and MLKEM768 over TLS 1.3. Once the key exchange is complete, Gateway uses AES-128-GCM to encrypt traffic.\n\nRefer to [Post-quantum cryptography](https://developers.cloudflare.com/ssl/post-quantum-cryptography/) to learn more.\n\n## FIPS compliance\n\nBy default, TLS decryption can use both TLS version 1.2 and 1.3. However, some environments such as FedRAMP may require cipher suites and TLS versions compliant with FIPS 140-2. FIPS compliance currently requires TLS version 1.2.\n\n### Enable FIPS compliance\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n  2. In **Proxy and inspection**, turn on **Inspect HTTPS requests with TLS decryption**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. Configure the `tls_decrypt` argument in [`cloudflare_zero_trust_gateway_settings`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_gateway_settings):",
      "language": "unknown"
    },
    {
      "code": "1. Select **Enable only cipher suites and TLS versions compliant with FIPS 140-2**.\n\n### Limitations\n\nWhen FIPS compliance is enabled, Gateway will only choose [FIPS-compliant cipher suites](#cipher-suites) when connecting to the origin. If the origin does not support FIPS-compliant ciphers, the request will fail.\n\nFIPS-compliant traffic defaults to [HTTP/3](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/). To enforce HTTP policies for UDP traffic, you must turn on the [Gateway proxy for UDP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/#enable-http3-inspection).\n\n## FedRAMP compliance\n\nWhen you use [Cloudflare Regional Services](https://developers.cloudflare.com/data-localization/regional-services/) in the United States and the WARP client to on-ramp TLS traffic to Gateway, traffic will egress from a Cloudflare data center within Cloudflare's FedRAMP boundary. If a user's closest data center is non-FedRAMP compliant, their traffic will still egress from a FedRAMP compliant data center, maintaining FedRAMP compliance for the traffic.",
      "language": "unknown"
    },
    {
      "code": "## Cipher suites\n\nA cipher suite is a set of encryption algorithms for establishing a secure communications connection. There are several cipher suites in wide use, and a client and server agree on the cipher suite to use when establishing the TLS connection. Support of multiple cipher suites allows compatibility across various clients.\n\nThe following table lists the default cipher suites Gateway uses for TLS decryption.\n\n| Name (OpenSSL) | Name (IANA) | FIPS-compliant |\n| - | - | - |\n| ECDHE-ECDSA-AES128-GCM-SHA256 | TLS\\_ECDHE\\_ECDSA\\_WITH\\_AES\\_128\\_GCM\\_SHA256 |  |\n| ECDHE-ECDSA-AES256-GCM-SHA384 | TLS\\_ECDHE\\_ECDSA\\_WITH\\_AES\\_256\\_GCM\\_SHA384 |  |\n| ECDHE-RSA-AES128-GCM-SHA256 | TLS\\_ECDHE\\_RSA\\_WITH\\_AES\\_128\\_GCM\\_SHA256 |  |\n| ECDHE-RSA-AES256-GCM-SHA384 | TLS\\_ECDHE\\_RSA\\_WITH\\_AES\\_256\\_GCM\\_SHA384 |  |\n| ECDHE-RSA-AES128-SHA | TLS\\_ECDHE\\_RSA\\_WITH\\_AES\\_128\\_CBC\\_SHA256 |  |\n| ECDHE-RSA-AES256-SHA384 | TLS\\_ECDHE\\_RSA\\_WITH\\_AES\\_256\\_CBC\\_SHA384 |  |\n| AES128-GCM-SHA256 | TLS\\_RSA\\_WITH\\_AES\\_128\\_GCM\\_SHA256 |  |\n| AES256-GCM-SHA384 | TLS\\_RSA\\_WITH\\_AES\\_256\\_GCM\\_SHA384 |  |\n| AES128-SHA | TLS\\_RSA\\_WITH\\_AES\\_128\\_CBC\\_SHA |  |\n| AES256-SHA | TLS\\_RSA\\_WITH\\_AES\\_256\\_CBC\\_SHA |  |\n\nFor more information on cipher suites, refer to [Cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/).\n\n</page>\n\n<page>\n---\ntitle: Set up DNS filtering  Cloudflare One docs\ndescription: Secure Web Gateway allows you to inspect DNS traffic and control\n  which websites users can visit.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/dns/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/dns/index.md\n---\n\nSecure Web Gateway allows you to inspect DNS traffic and control which websites users can visit.\n\nNote\n\nFor a more detailed guide to filtering DNS queries and other traffic for your organization, refer to the [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/concepts/) implementation guide.\n\n## 1. Connect to Gateway\n\n### Connect devices\n\nTo filter DNS requests from an individual device such as a laptop or phone:\n\n1. [Install the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on your device.\n2. In the WARP client Settings, log in to your organization's Zero Trust instance.\n3. (Optional) If you want to display a [custom block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/), [install a Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on your device.\n\n### Connect DNS locations\n\nTo filter DNS requests from a location such as an office or data center:\n\n1. [Add the location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) to your Cloudflare One settings.\n2. On your router, browser, or OS, forward DNS queries to the address shown in the location setup UI.\n\nNote\n\nGateway identifies locations differently depending on the DNS query protocol:\n\n* **IPv4 queries** match to the source IP address. Under **Networks** > **Resolvers & Proxies** > **DNS locations**, ensure that the **Source IPv4 Address** parameter is correct for the location you want to apply policies to.\n* **IPv6, DOT, or DOH queries** match to the unique DNS forwarding address assigned to the DNS location. Ensure that your DNS resolver is configured for the location you want to apply policies to.\n\n## 2. Verify device connectivity\n\nTo verify your device is connected to Cloudflare One:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. Under **Log traffic activity**, enable activity logging for all DNS logs.\n3. On your device, open a browser and go to any website.\n4. In Cloudflare One, go to **Insights** > **Logs** > **DNS**.\n5. Make sure DNS queries from your device appear.\n\n## 3. Create your first DNS policy\n\nTo create a new DNS policy:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies**.\n\n  2. In the **DNS** tab, select **Add a policy**.\n\n  3. Name the policy.\n\n  4. Under **Traffic**, build a logical expression that defines the traffic you want to allow or block.\n\n  5. Choose an **Action** to take when traffic matches the logical expression. For example, we recommend adding a policy to block all [security categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories):\n\n     | Selector | Operator | Value | Action |\n     | - | - | - | - |\n     | Security Categories | in | *All security risks* | Block |\n\n  6. Select **Create policy**.\n\n* API\n\n  1. [Create an API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) with the following permissions:\n\n     | Type | Item | Permission |\n     | - | - | - |\n     | Account | Zero Trust | Edit |\n\n  2. (Optional) Configure your API environment variables to include your [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) and API token.\n\n  3. Send a `POST` request to the [Create a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/create/) endpoint. For example, we recommend adding a policy to block all [security categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories):",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "The API will respond with a summary of the policy and the result of your request.\n\nFor more information, refer to [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/).\n\n## 4. Add optional policies\n\nRefer to our list of [common DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/common-policies) for other policies you may want to create.\n\n</page>\n\n<page>\n---\ntitle: Set up HTTP filtering  Cloudflare One docs\ndescription: Secure Web Gateway allows you to inspect HTTP traffic and control\n  which websites users can visit.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/index.md\n---\n\nSecure Web Gateway allows you to inspect HTTP traffic and control which websites users can visit.\n\nNote\n\nFor a more detailed guide to filtering HTTP requests and other traffic for your organization, refer to the [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/concepts/) implementation guide.\n\n## 1. Connect to Gateway\n\nTo filter HTTP requests from a device:\n\n1. [Install the Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on your device.\n2. [Install the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on your device.\n3. In the WARP client Settings, log in to your organization's Cloudflare One instance.\n4. [Enable the Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/#turn-on-the-gateway-proxy) for TCP. Optionally, you can enable the UDP proxy to inspect all port 443 UDP traffic.\n5. To inspect HTTPS traffic, [enable TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#turn-on-tls-decryption).\n6. (Optional) To scan file uploads and downloads for malware, [enable anti-virus scanning](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/antivirus-scanning/).\n\n## 2. Verify device connectivity\n\nTo verify your device is connected to Cloudflare One:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. Under **Log traffic activity**, enable activity logging for all HTTP logs.\n3. On your device, open a browser and go to any website.\n4. In Cloudflare One, go to **Insights** > **Logs** > **HTTP**.\n5. Make sure HTTP requests from your device appear.\n\n## 3. Create your first HTTP policy\n\nTo create a new HTTP policy:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies**.\n\n  2. In the **HTTP** tab, select **Add a policy**.\n\n  3. Name the policy.\n\n  4. Under **Traffic**, build a logical expression that defines the traffic you want to allow or block.\n\n  5. Choose an **Action** to take when traffic matches the logical expression. For example, if you have configured TLS decryption, some applications that use [embedded certificates](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#inspection-limitations) may not support HTTP inspection, such as some Google products. You can create a policy to bypass inspection for these applications:\n\n     | Selector | Operator | Value | Action |\n     | - | - | - | - |\n     | Application | in | *Do Not Inspect* | Do Not Inspect |\n\n     Cloudflare also recommends adding a policy to block [known threats](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) such as Command & Control, Botnet and Malware based on Cloudflare's threat intelligence:\n\n     | Selector | Operator | Value | Action |\n     | - | - | - | - |\n     | Security Categories | in | *All security risks* | Block |\n\n  6. Select **Create policy**.\n\n* API\n\n  1. [Create an API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) with the following permissions:\n\n     | Type | Item | Permission |\n     | - | - | - |\n     | Account | Zero Trust | Edit |\n\n  2. (Optional) Configure your API environment variables to include your [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) and API token.\n\n  3. Send a `POST` request to the [Create a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/create/) endpoint. For example, if you have configured TLS decryption, some applications that use [embedded certificates](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#inspection-limitations) may not support HTTP inspection, such as some Google products. You can create a policy to bypass inspection for these applications:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "The API will respond with a summary of the policy and the result of your request.\n\n     Cloudflare also recommends adding a policy to block [known threats](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) such as Command & Control, Botnet and Malware based on Cloudflare's threat intelligence:",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/).\n\n## 4. Add optional policies\n\nRefer to our list of [common HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies) for other policies you may want to create.\n\n</page>\n\n<page>\n---\ntitle: Set up network filtering  Cloudflare One docs\ndescription: Secure Web Gateway allows you to apply policies at the network\n  level (Layers 3 and 4) to control which websites and non-HTTP applications\n  users can access.\nlastUpdated: 2025-10-28T21:24:57.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/network/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/network/index.md\n---\n\nSecure Web Gateway allows you to apply policies at the network level (Layers 3 and 4) to control which websites and non-HTTP applications users can access.\n\nNote\n\nFor a more detailed guide to filtering network traffic and more for your organization, refer to the [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/concepts/) implementation guide.\n\n## 1. Connect to Gateway\n\n### Connect devices\n\nTo filter network traffic from a device such as a laptop or phone:\n\n1. [Install the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on your device.\n2. In the WARP client Settings, log in to your organization's Cloudflare One instance.\n3. (Optional) If you want to display a [custom block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/), [install the Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on your device .\n4. [Enable the Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/#turn-on-the-gateway-proxy) for TCP. Optionally, you can enable the UDP proxy to inspect all port 443 UDP traffic.\n\n### Connect private networks\n\nTo filter traffic from private networks, refer to the [Cloudflare Tunnel guide](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/).\n\n## 2. Verify device connectivity\n\nTo verify your device is connected to Cloudflare One:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n\n2. Under **Log traffic activity**, enable activity logging for all Network logs.\n\n3. On your WARP-enabled device, open a browser and visit any website.\n\n4. Determine the **Source IP** for your device:\n\n   1. Open the WARP client settings.\n   2. Go to **Preferences** > **General**.\n   3. Note the **Public IP**.\n\n5. In Cloudflare One, go to **Insights** > **Logs** > **Network logs**. Before building Network policies, make sure you see Network logs from the Source IP assigned to your device.\n\n## 3. Create your first network policy\n\nTo create a new network policy:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies**.\n\n  2. In the **Network** tab, select **Add a network policy**.\n\n  3. Name the policy.\n\n  4. Under **Traffic**, build a logical expression that defines the traffic you want to allow or block.\n\n  5. Choose an **Action** to take when traffic matches the logical expression. For example, you can use a list of [device serial numbers](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/) to ensure users can only access an application if they connect with the WARP client from a company device:\n\n     | Selector | Operator | Value | Logic | Action |\n     | - | - | - | - | - |\n     | SNI Domain | is | `internalapp.com` | And | Block |\n     | Passed Device Posture Checks | not in | *Device serial numbers* | | |\n\n  6. Select **Create policy**.\n\n* API\n\n  1. [Create an API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) with the following permissions:\n\n     | Type | Item | Permission |\n     | - | - | - |\n     | Account | Zero Trust | Edit |\n\n  2. (Optional) Configure your API environment variables to include your [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) and API token.\n\n  3. Send a `POST` request to the [Create a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/create/) endpoint. For example, you can use a list of [device serial numbers](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/) to ensure users can only access an application if they connect with the WARP client from a company device:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "The API will respond with a summary of the policy and the result of your request.\n\nFor more information, refer to [network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/).\n\n## 4. Add optional policies\n\nRefer to our list of [common network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies) for policies you may want to create.\n\n</page>\n\n<page>\n---\ntitle: Common network policies  Cloudflare One docs\ndescription: The following policies are commonly used to secure network traffic.\nlastUpdated: 2025-12-12T22:32:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/index.md\n---\n\nThe following policies are commonly used to secure network traffic.\n\nFor a baseline set of recommended policies, refer to [Secure your Internet traffic and SaaS apps](https://developers.cloudflare.com/learning-paths/secure-internet-traffic/build-network-policies/recommended-network-policies/).\n\nRefer to the [network policies page](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) for a comprehensive list of other selectors, operators, and actions.\n\n## Block unauthorized applications\n\nNote\n\nAfter seven days, view your [Shadow IT SaaS Analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) and block additional applications based on what your users are accessing.\n\nTo minimize the risk of [shadow IT](https://www.cloudflare.com/learning/access-management/what-is-shadow-it/), some organizations choose to limit their users' access to certain web-based tools and applications. For example, the following policy blocks known AI tools:\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application | in | *Artificial Intelligence* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Check user identity\n\nConfigure access on a per user or group basis by adding [identity-based conditions](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/) to your policies.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Application | in | *Salesforce* | And | Block |\n  | User Group Names | in | *Contractors* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Enforce device posture\n\nRequire devices to have certain software installed or other configuration attributes. For instructions on enabling a device posture check, refer to the [device posture section](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/). For example, you can use a list of [device serial numbers](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/) to ensure users can only access an application if they connect with the WARP client from a company device:\n\nIn the following example, you can use a list of [device serial numbers](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/) to ensure users can only access an application if they connect with the WARP client from a company device:\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | SNI Domain | is | `internalapp.com` | And | Block |\n  | Passed Device Posture Checks | not in | *Device serial numbers* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "To get the UUIDs of your device posture checks, use the [List device posture rules](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/methods/list/) endpoint.\n\n* Terraform",
      "language": "unknown"
    },
    {
      "code": "## Enforce session duration\n\nTo require users to re-authenticate after a certain amount of time has elapsed, configure [WARP sessions](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\n## Allow only approved traffic\n\nRestrict user access to only the specific sites or applications configured in your [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/).\n\n### 1. Allow HTTP and HTTPS traffic\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Detected Protocol | is | *TLS* | And | Allow |\n  | Destination Port | in | `80`, `443` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### 2. Block all other traffic\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Protocol | in | *TCP*, *UDP* | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Filter HTTPS traffic when inspecting on all ports\n\nIf your organization blocks traffic by default with a Network policy and you want to [inspect HTTP traffic on all ports](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/#inspect-on-all-ports), you need to explicitly allow HTTP and TLS traffic to filter it.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Detected Protocol | is | *TLS* | Or | Allow |\n  | Detected Protocol | is | *HTTP* | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Restrict private network access to proxy endpoint users\n\nWhen using proxy endpoints, by default all devices added to the proxy endpoint can access your internal applications and services connected through [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/). To restrict access and add an additional layer of security, create the following policies.\n\n### Source IP proxy endpoints\n\nWhen using [source IP proxy endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/#source-ip-endpoint), restrict access to only users connecting through the proxy endpoint from specific source IPs.\n\n#### 1. Allow proxy endpoint traffic from specific source IPs\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Proxy Endpoint | in | *Proxy Endpoint* | And | Allow |\n  | Source IP | in | `203.0.113.0/24` | And | |\n  | Destination IP | in | `10.0.0.0/8` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "Replace `<PROXY_ENDPOINT_ID>` with your proxy endpoint ID.\n\n#### 2. Block all other proxy endpoint traffic to private network\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Proxy Endpoint | in | *Proxy Endpoint* | And | Block |\n  | Destination IP | in | `10.0.0.0/8` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "Replace `<PROXY_ENDPOINT_ID>` with your proxy endpoint ID.\n\n### Authorization proxy endpoints\n\nWhen using [authorization proxy endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/#authorization-endpoint), add an additional layer of security by restricting access to only users connecting from specific source IPs. This prevents unauthorized access even if user credentials are compromised.\n\n#### 1. Allow proxy endpoint traffic from specific source IPs\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Proxy Endpoint | in | *Proxy Endpoint* | And | Allow |\n  | Source IP | in | `203.0.113.0/24` | And | |\n  | Destination IP | in | `10.0.0.0/8` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "Replace `<PROXY_ENDPOINT_ID>` with your proxy endpoint ID.\n\n#### 2. Block all other proxy endpoint traffic to private network\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Proxy Endpoint | in | *Proxy Endpoint* | And | Block |\n  | Destination IP | in | `10.0.0.0/8` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "Replace `<PROXY_ENDPOINT_ID>` with your proxy endpoint ID.\n\n## Restrict access to private networks\n\nRestrict access to resources which you have connected through [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/).\n\nThe following example consists of two policies: the first allows specific users to reach your application, and the second blocks all other traffic.\n\n### 1. Allow company employees\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Destination IP | in | `10.0.0.0/8` | And | Allow |\n  | User Email | matches regex | `.*@example.com` | | |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### 2. Block everyone else\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Destination IP | in | `10.0.0.0/8` | Block |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "## Override IP address\n\nOverride traffic directed toward a specific IP address with a different IP address.\n\n* Dashboard\n\n  | Selector | Operator | Value | Logic | Action |\n  | - | - | - | - | - |\n  | Destination IP | in | `203.0.113.17` | And | Network Override |\n  | Destination Port | is | `80` | | |\n\n  | Override IP | Override Port |\n  | - | - |\n  | `1.1.1.1` | `80` |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Protocol detection  Cloudflare One docs\ndescription: Gateway supports the detection, logging, and filtering of network\n  protocols using packet attributes.\nlastUpdated: 2025-12-02T16:19:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/index.md\n---\n\nGateway supports the detection, logging, and filtering of network protocols using packet attributes.\n\nProtocol detection only applies to devices connected to Cloudflare One via the WARP client in [Gateway with WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#gateway-with-warp-default) mode.\n\n## Turn on protocol detection\n\nTo turn on protocol detection:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings** > **Proxy and inspection settings**.\n2. Turn on **Allow protocol detection**.\n\nYou can now use *Detected Protocol* as a selector in a [Network policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#detected-protocol).\n\n### Inspect on all ports Beta\n\nBy default, Gateway will only inspect HTTP traffic through port `80`. Additionally, if you [turn on TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#turn-on-tls-decryption), Gateway will inspect HTTPS traffic through port `443`.\n\nTo detect and inspect HTTP and HTTPS traffic on ports in addition to `80` and `443`, under **Manage HTTP inspection by port**, choose *Inspect on all ports*.\n\n#### Important considerations\n\n**TLS interception on all ports**: When you turn on this setting, Gateway will attempt to intercept TLS traffic on every port, not just port `443`. This means all applications using TLS on non-standard ports will have their traffic intercepted by the Gateway proxy. If you only want to turn on SNI detection for Network policy filtering without full TLS interception, you will need to create [Do Not Inspect policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#do-not-inspect) for the specific applications or domains that use TLS on non-standard ports.\n\n**Filtering non-HTTPS protocols inside TLS**: Once a Network policy allows a TLS connection at the network level (Layer 4), the Gateway proxy will intercept and decrypt the TLS traffic. However, Gateway cannot filter based on non-HTTP protocols inside the TLS connection. All non-HTTPS traffic inside TLS (such as SSH over TLS, database protocols, or custom protocols) will be allowed by default, and no further filtering will be applied to it. This limitation means that if your organization uses a Network policy to block all traffic by default, the Gateway proxy will allow all non-HTTPS TLS traffic through, and you will not be able to filter this traffic with HTTP policies.\n\nTo use HTTP policies to filter all HTTPS traffic on all ports when using a default Block Network policy, [create a Network policy to explicitly allow HTTP and TLS traffic](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/#filter-https-traffic-when-inspecting-on-all-ports).\n\n## Supported protocols\n\nGateway supports detection and filtering of the following protocols:\n\n| Protocol | Notes |\n| - | - |\n| HTTP | The policy builder includes separate values for HTTP/1.1 and HTTP/2. |\n| SSH | |\n| TLS | Gateway detects TLS versions 1.1 through 1.3 with the *TLS* value. |\n| DCE/RPC | |\n| MQTT | |\n| TPKT | TPKT commonly initiates RDP sessions, so you can use it to identify and filter RDP traffic. |\n| DNP3 | |\n\n## Example network policy\n\nYou can create network policies that filter traffic based on protocol detections rather than common ports. For example, you can block all SSH traffic on your network without blocking port 22 or any other non-default ports:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Detected Protocol | in | *SSH* | Block |\n\n</page>\n\n<page>\n---\ntitle: SSH proxy and command logs (legacy)  Cloudflare One docs\ndescription: Cloudflare One supports SSH proxying and command logging using\n  Secure Web Gateway and the WARP client.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/ssh-logging/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/ssh-logging/index.md\n---\n\nNote\n\nNot recommended for new deployments. We recommend using [Access for Infrastructure](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/) to manage SSH sessions and log SSH commands.\n\nCloudflare One supports SSH proxying and command logging using Secure Web Gateway and the WARP client.\n\nYou can create network policies to manage and monitor SSH access to your applications. When a device connects to your origin server over SSH, a session log will be generated showing which user connected, the session duration, and optionally a full replay of all commands run during the session.\n\n## Prerequisites\n\n* [Install the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/) on end-user devices.\n* [Install the Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on end-user devices.\n\n## 1. Ensure Unix usernames match user SSO identities\n\nCloudflare Gateway will take the identity from a token and, using short-lived certificates, authorize the user on the target infrastructure.\n\nThe simplest setup is one where a user's Unix username matches their email address prefix. Issued short-lived certificates will be valid for the user's email address prefix. For example, if a user in your Okta or GSuite organization is registered as `jdoe@example.com`, they would log in to the SSH server as `jdoe`.\n\nFor testing purposes, you can run the following command to generate a Unix user on the machine:",
      "language": "unknown"
    },
    {
      "code": "Advanced setup: Differing usernames\n\nSSH certificates include one or more `principals` in their signature which indicate the Unix usernames the certificate is allowed to log in as. Cloudflare Access will always set the principal to the user's email address prefix. For example, when `jdoe@example.com` tries to connect, Access issues a short-lived certificate authorized for the principal `jdoe`.\n\nBy default, SSH servers authenticate the Unix username against the principals listed in the user's certificate. You can configure your SSH server to accept principals that do not match the Unix username.\n\nNote\n\nIf you would like to use short-lived certificates with the browser-based terminal, the user's email address prefix needs to matches their Unix username.\n\n**Username matches a different email**\n\nTo allow `jdoe@example.com` to log in as the user `johndoe`, add the following to the server's `/etc/ssh/sshd_config`:",
      "language": "unknown"
    },
    {
      "code": "This tells the SSH server that, when someone tries to authenticate as the user `johndoe`, check their certificate for the principal `jdoe`. This would allow the user `jdoe@example.com` to sign into the server with a command such as:",
      "language": "unknown"
    },
    {
      "code": "**Username matches multiple emails**\n\nTo allow multiple email addresses to log in as `vmuser`, add the following to the server's `/etc/ssh/sshd_config`:",
      "language": "unknown"
    },
    {
      "code": "This tells the SSH server to load a list of principles from a file. Then, in `/etc/ssh/vmusers-list.txt`, list the email prefixes that can log in as `vmuser`, one per line:",
      "language": "unknown"
    },
    {
      "code": "**Username matches all users**\n\nTo allow any Access user to log in as `vmuser`, add the following command to the server's `/etc/ssh/sshd_config`:",
      "language": "unknown"
    },
    {
      "code": "This command takes the certificate presented by the user and authorizes whatever principal is listed on it.\n\n**Allow all users**\n\nTo allow any Access user to log in with any username, add the following to the server's `/etc/ssh/sshd_config`:",
      "language": "unknown"
    },
    {
      "code": "Since this will put the security of your server entirely dependent on your Access configuration, make sure your [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/) are correctly configured.\n\n## 2. Generate a Gateway SSH proxy CA\n\nInstead of traditional SSH keys, Gateway uses short-lived certificates to authenticate traffic between Cloudflare and your origin.\n\nNote\n\nOther short-lived CAs, such as those used to [secure SSH servers behind Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/short-lived-certificates-legacy/), are incompatible with the Gateway SSH proxy. For SSH logging to work, you must create a new CA using the `gateway_ca` API endpoint.\n\nTo generate a Gateway SSH proxy CA and get its public key:\n\n1. [Create an API token](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/) with the following permissions:\n\n   | Type | Item | Permission |\n   | - | - | - |\n   | Account | Access: SSH Auditing | Edit |\n\n2. If you have not yet generated a Cloudflare SSH CA, make a `POST` request to the Cloudflare API:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: SSH Auditing Write`",
      "language": "unknown"
    },
    {
      "code": "1. If you have already created a Cloudflare SSH CA or receive the error message `access.api.error.gateway_ca_already_exists`, make a `GET` request instead:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: SSH Auditing Write`\n* `Access: SSH Auditing Read`",
      "language": "unknown"
    },
    {
      "code": "1. Copy the `public_key` value returned in the response.\n\n## 3. Save the public key\n\n1. Use the following command to change directories to the SSH configuration directory on the remote target machine:",
      "language": "unknown"
    },
    {
      "code": "2. Once there, you can use the following command to both generate the file and open a text editor to input/paste the public key.",
      "language": "unknown"
    },
    {
      "code": "3. In the `ca.pub` file, paste the public key without any modifications.",
      "language": "unknown"
    },
    {
      "code": "The `ca.pub` file can hold multiple keys, listed one per line. Empty lines and comments starting with `#` are also allowed.\n\n4. Save the `ca.pub` file. In some systems, you may need to use the following command to force the file to save depending on your permissions:",
      "language": "unknown"
    },
    {
      "code": "## 4. Modify your `sshd_config` file\n\nConfigure your SSH server to trust the Cloudflare SSH CA by updating the `sshd_config` file on the remote target machine.\n\n1. While in the `/etc/ssh` directory on the remote machine, open the `sshd_config` file.",
      "language": "unknown"
    },
    {
      "code": "2. Press `i` to enter insert mode, then add the following lines at the top of the file, above all other directives:",
      "language": "unknown"
    },
    {
      "code": "Be aware of your include statements\n\n   If there are any include statements below these lines, the configurations in those files will not take precedence.\n\n3. Press `esc` and then type `:x` and press `Enter` to save and exit.\n\n## 5. Check your SSH port number\n\nCloudflare's SSH proxy only works with servers running on the default port 22. Open the `sshd_config` file and verify that no other `Port` values are specified.",
      "language": "unknown"
    },
    {
      "code": "## 6. Restart your SSH server\n\nOnce you have modified your `sshd` configuration, reload the SSH service on the remote machine for the changes to take effect.\n\n* Debian/Ubuntu\n\n  For Debian/Ubuntu:",
      "language": "unknown"
    },
    {
      "code": "* CentOS/RHEL\n\n  For CentOS/RHEL 7 and newer:",
      "language": "unknown"
    },
    {
      "code": "## 7. Create an Audit SSH policy\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Network** > **Firewall policies**.\n\n2. In the **Network** tab, create a new network policy.\n\n3. Name the policy and specify the [Destination IP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#destination-ip) for your origin server.\n\n   You can enter either a public or private IP. To use a private IP, refer to [Connect private networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/).\n\n4. Add any other conditions to your policy. If a user does not meet the criteria, they will be blocked by default.\n\n5. In the **Action** dropdown, select *Audit SSH*.\n\n6. (Optional) Enable **SSH Command Logging**. If you have not already uploaded an SSH encryption public key, follow the steps in [Configure SSH Command Logging](#optional-configure-ssh-command-logging).\n\n7. Save the policy.\n\n## 8. Connect as a user\n\nUsers can use any SSH client to connect to the target resource, as long as they are logged into the WARP client on their device. Cloudflare One will authenticate, proxy, and optionally encrypt and record all SSH traffic through Gateway.\n\nUsers must specify their desired username to connect with as part of the SSH command:",
      "language": "unknown"
    },
    {
      "code": "Note\n\nIf the target resource is already in a user's `.ssh/known_hosts` file, the user must first remove existing SSH keys before attempting to connect:",
      "language": "unknown"
    },
    {
      "code": "## (Optional) Configure SSH Command Logging\n\nTo log SSH commands, you will need to generate an HPKE key pair and upload the public key to Cloudflare.\n\n1. [Download](https://github.com/cloudflare/ssh-log-cli/releases/latest/) the Cloudflare `ssh-log-cli` utility.\n\n2. Using the `ssh-log-cli` utility, generate a public and private key pair.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "This command outputs two files, an `sshkey.pub` public key and a matching `sshkey` private key.\n\n3. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n\n4. In **SSH log encryption public key**, paste the contents of `sshkey.pub` and select **Save**. Note that this a different public key from the `ca.pub` file you used to configure the SSH server.\n\nAll proxied SSH commands are immediately encrypted using this public key. The matching private key is required to view logs.\n\n## View SSH Logs\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Insights** >**Logs** > **SSH command logs**.\n\n2. If you enabled the **SSH Command Logging** feature, you can **Download** a session's command log.\n\n3. To decrypt the log, follow the instructions in the [SSH Logging CLI repository](https://github.com/cloudflare/ssh-log-cli/). In the following example, `sshkey` is the private key that matches the public key uploaded to Cloudflare.",
      "language": "unknown"
    },
    {
      "code": "This command outputs a `sshlog-decrypted.zip` file with the decrypted logs.\n\n## Limitations\n\nSSH Command Logging does not support SFTP since it cannot be inspected and logged.\n\n</page>\n\n<page>\n---\ntitle: Add rules  Cloudflare One docs\ndescription: You can check for an existing root ruleset from the dashboard or\n  via the Account rulesets API. If you are a new Magic Transit customer, you may\n  not have a root ruleset created for your account. To view examples for root\n  rulesets, review the Magic Firewall Terraform documentation.\nlastUpdated: 2025-12-23T12:15:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/index.md\n---\n\nYou can check for an existing root ruleset from the dashboard or via the [Account rulesets API](https://developers.cloudflare.com/api/resources/rulesets/methods/list/). If you are a new Magic Transit customer, you may not have a root ruleset created for your account. To view examples for root rulesets, review the [Magic Firewall Terraform documentation](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/magic_firewall_ruleset).\n\nBy default, you can create a maximum of 200 rules. We recommend you create lists of IP addresses to reference within rules to streamline rule management.\n\n## Add a rule\n\n1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies** > **Firewall policies**.\n2. In the **Packet Filtering** tab, select **Add a policy** > **Add custom policy**.\n3. Fill out the information for your new rule. All existing rules apply to IPv4. You can use a managed [IP list](https://www.cloudflare.com/en-gb/ips/) when populating the **Value**.\n4. When you are done, select **Add new rule**.\n\n## Create a disabled rule\n\nWhen you add a new rule, the rule is **Enabled** by default.\n\nTo create a **Disabled** rule, follow the steps in [Add a rule](#add-a-rule) above and toggle **Enabled** to off. When a rule is in the disabled state, the rule will not perform the action until is set to **Enabled**.\n\nTo disable an existing rule, from the **Magic Firewall Rules** page, set the **Enabled** toggle to off.\n\n## Update a rule\n\n1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies** > **Firewall policies**.\n2. In the **Packet Filtering** tab, locate the rule you want to edit and select the three dots > **Edit**.\n3. Update the rule with your changes and select **Save**.\n\n## Delete an existing rule\n\n1. Locate the rule you want to delete in the list.\n2. From the end of the row, select **Delete**.\n3. Select **Delete** again to confirm the deletion.\n\n## API\n\nBelow, you can find examples of how to use the API to perform certain actions.\n\nWarning\n\nThe examples on this page all use the `https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets` endpoint. This endpoint is intended to create rules from scratch and **might overwrite existing rules**.\n\nIf you have a ruleset already deployed, consider using the `https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/{ruleset_id}/rules` endpoint instead.\n\nRefer to [Add a rule to a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/add-rule/) and [Create an account ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) for more information.\n\n### Skip action\n\nThe example below blocks all TCP ports, but allows one port (`8080`) by using the skip action.",
      "language": "unknown"
    },
    {
      "code": "### Block a country\n\nThe example below blocks all packets with a source or destination IP address coming from Brazil by using its 2-letter country code in [ISO 3166-1 Alpha 2](https://www.iso.org/obp/ui/#search/code/) format.",
      "language": "unknown"
    },
    {
      "code": "### Use an IP list\n\nMagic Firewall supports [using lists in expressions](https://developers.cloudflare.com/waf/tools/lists/use-in-expressions/) for the `ip.src` and `ip.dst` fields. The supported lists are:\n\n* `$cf.anonymizer` - Anonymizer proxies\n* `$cf.botnetcc` - Botnet command and control channel\n* `$cf.malware` - Sources of malware\n* `$<IP_LIST_NAME>` - The name of an account-level IP list",
      "language": "unknown"
    },
    {
      "code": "## Next steps\n\nRefer to [Form expressions](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/form-expressions/) for more information on how to write rule expressions.\n\n</page>\n\n<page>\n---\ntitle: Best practices  Cloudflare One docs\ndescription: By default, Magic Firewall permits all ingress traffic that has\n  passed through Cloudflare's core DDoS mitigations. To proactively mitigate\n  attacks and minimize your attack surface and leakage of attack traffic into\n  your environment, we recommend implementing your Magic Firewall rules using\n  the following guidelines.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/index.md\n---\n\nBy default, Magic Firewall permits all ingress traffic that has passed through Cloudflare's core DDoS mitigations. To proactively mitigate attacks and minimize your attack surface and leakage of attack traffic into your environment, we recommend implementing your Magic Firewall rules using the following guidelines.\n\nThe best approach is to replicate your current ingress perimeter firewall rules in Magic Firewall. If you are unable to export your current perimeter firewall rules, contact your Implementation Manager for help translating the rules into Magic Firewall rules.\n\n* [Minimal ruleset](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/minimal-ruleset/)\n* [Extended ruleset](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/extended-ruleset/)\n* [Magic Transit egress](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/magic-transit-egress/)\n\n</page>\n\n<page>\n---\ntitle: Create Rate Limiting rules (beta)  Cloudflare One docs\ndescription: Rate limiting rules (beta) allow you to manage incoming traffic to\n  your network for specific locations.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/create-rate-limiting-rules/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/create-rate-limiting-rules/index.md\n---\n\nRate limiting rules (beta) allow you to manage incoming traffic to your network for specific locations.\n\nThis guide will teach you how to create a rule for when incoming packets match, and in cases where your rate exceeds a certain value (in packets or bits).\n\nNote\n\nFor Advanced Magic Firewall customers, rate limiting (beta) is available by request through the account team.\n\n## Add a rule\n\nTo add a rule:\n\n1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies** > **Packet filtering**.\n\n2. Select **Add a policy** > **Add rate limiting policy**.\n\n3. Fill out the information for your new rule:\n\n   * Select the **Field**: At the moment, you can only choose a [colo name](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/magic-firewall/).\n   * Select the **Operator**: Choose among **equals** or **is in**.\n   * Select the **Value**.\n\n4. When you are done, select **Add new rule**.\n\n## Edit an existing rule\n\nTo edit a rule:\n\n1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies** > **Packet filtering**.\n2. Locate the rule you want to edit in the list and select **View**.\n3. Edit the rule with your changes and select **Add new rule**.\n\n## Delete an existing rule\n\nTo delete an existing rule:\n\n1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies** > **Packet filtering**.\n2. Locate the rule you want to edit in the list and select **Delete**.\n3. Select **Delete** again to confirm deletion.\n\n</page>\n\n<page>\n---\ntitle: Enable Managed Rulesets  Cloudflare One docs\ndescription: With managed rulesets, you can quickly deploy rules maintained by\n  Cloudflare, and you can use Magic Firewall to control which rules are enabled.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/enable-managed-rulesets/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/enable-managed-rulesets/index.md\n---\n\nWith [managed rulesets](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/), you can quickly deploy rules maintained by Cloudflare, and you can use Magic Firewall to control which rules are enabled.\n\nNote:\n\nBefore you can begin using managed rulesets with Magic Firewall, your account must first be entitled to use managed rulesets. Contact your account team for access.\n\nTo enable or disable a rule, you can specify which properties should be overridden. The overrides occur in the Managed phase, root kind ruleset. Currently, you can only have one rule in the root ruleset, but a single rule can contain multiple overrides.\n\nYou have multiple options for enabling rules:\n\n* Select an individual rule and enable it.\n* Enable multiple rules by enabling by category in the `magic-transit-phase`.\n* Enable an entire ruleset.\n\n## API\n\n### 1. Create a Managed phase Managed kind ruleset\n\nTo create a managed ruleset, you must first build a request with the following:\n\n* `managed_ruleset_id`: The ID of the Managed phase Managed kind ruleset that contains the rule you want to enable.\n* `managed_rule_id`: The ID of the rule you want to enable.\n\nAdditionally, you need the properties you want to override. The properties you can override include:\n\n* `enabled`: This value can be set to `true` or `false`. When set to `true`, the rule matches packets and applies the rule's default action if the action is not overridden. When set to `false`, the rule is disabled and does not match any packets.\n* `action`: The value can be set to `log` so the rule only produces logs instead of applying the rule's default action.\n\nThe `enabled` and `action` properties for a rule are set in the Managed phase Managed kind ruleset. All rules in the Managed phase are currently disabled by default.\n\nThe example below contains a request for a Managed phase Managed Kind ruleset.",
      "language": "unknown"
    },
    {
      "code": "### 2. Patch a Managed phase Managed kind ruleset\n\nTo ensure a root kind ruleset only contains one rule, patch the rule to enable new managed rules.\n\nBuilding off the example from the previous step, the example below enables a category to select multiple rules instead of a single rule. The category will be set to `log` mode, which means the rule can produce logs but will not accept or drop packets.",
      "language": "unknown"
    },
    {
      "code": "### 3. Enable all rules\n\nTo enable the complete ruleset or enable all rules, send the request below.",
      "language": "unknown"
    },
    {
      "code": "### 4. Delete a ruleset\n\nTo delete a ruleset, refer to [Delete a rule in a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/delete-rule/).\n\n## Cloudflare One dashboard\n\n### Enable rules\n\nYou can also use the dashboard to enable managed rulesets:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies**.\n2. Select **Packet filtering** and go to **Managed**. This is where the dashboard lists all your managed rules.\n3. To enable a rule, turn **Status** on.\n\n### Edit rules\n\nTo edit a rule:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies**.\n2. Select **Packet filtering** and go to **Managed**. This is where the dashboard lists all your managed rules.\n3. Select the three dots > **Edit**.\n4. Make the necessary changes, then select **Save**.\n\n### View rules\n\nTo view basic information about your rules:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies**.\n2. Select **Packet filtering** and go to **Managed**. This is where the dashboard lists all your managed rules.\n3. Locate your managed rule, select the three dots > **View**.\n\n</page>\n\n<page>\n---\ntitle: Form an expression  Cloudflare One docs\ndescription: Rules are written as using the Cloudflare Rules language - a\n  domain-specific language (DSL) intended to mimic Wireshark semantics. For more\n  information, refer to the Rules language documentation.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/form-expressions/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/form-expressions/index.md\n---\n\nRules are written as using the Cloudflare Rules language - a domain-specific language (DSL) intended to mimic Wireshark semantics. For more information, refer to the [Rules language](https://developers.cloudflare.com/ruleset-engine/rules-language/) documentation.\n\nTo start with a simple case, review below how you would match a source IP:",
      "language": "unknown"
    },
    {
      "code": "Expressions can be more complex by joining multiple clauses via a logical operator:",
      "language": "unknown"
    },
    {
      "code": "## Capabilities\n\nYou can use Magic Firewall to skip or block packets based on source or destination IP, source or destination port, protocol, packet length, or bit field match.\n\n## Restrictions\n\nWirefilter comparisons support CIDR notation, but only inside sets. For example:",
      "language": "unknown"
    },
    {
      "code": "Expressions have a complexity limit that is easily reached when many joined or nested clauses are in the expression. Here's an example:",
      "language": "unknown"
    },
    {
      "code": "If the limit is reached, the response will have a `400` status code and an error message of `ruleset exceeds complexity constraints`. Split the expression into multiple rules and try again.\n\n</page>\n\n<page>\n---\ntitle: Overview  Cloudflare One docs\ndescription: Magic Firewall is a firewall-as-a-service (FWaaS) delivered from\n  the Cloudflare global network to protect office networks and cloud\n  infrastructure with advanced, scalable protection. With Magic Firewall, you\n  can apply filter rules on a variety of criteria, such as protocol and packet\n  length, to filter unwanted traffic before it reaches your network.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/magic-firewall-overview/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/magic-firewall-overview/index.md\n---\n\nProtect your cloud infrastructure or network offices with advanced, scalable firewall-as-a-service protection.\n\nEnterprise-only\n\nMagic Firewall is a firewall-as-a-service (FWaaS) delivered from the Cloudflare global network to protect office networks and cloud infrastructure with advanced, scalable protection. With Magic Firewall, you can apply filter rules on a variety of criteria, such as protocol and packet length, to filter unwanted traffic before it reaches your network.\n\nMagic Firewall uses Wireshark syntax, a domain-specific language (DSL) common in the networking world and the same syntax used across our other products. With this syntax, you can easily craft powerful rules to precisely allow or deny any traffic in or out of your network.\n\nMagic Firewall is available with the purchase of [Magic Transit](https://developers.cloudflare.com/magic-transit/) or [Magic WAN](https://developers.cloudflare.com/magic-wan/).\n\n***\n\n## Features\n\n### Intrusion Detection System (IDS)\n\nActively monitor for a wide range of known threat signatures in your traffic.\n\n[Use Intrusion Detection System (IDS)](https://developers.cloudflare.com/cloudflare-one/traffic-policies/ids/)\n\n***\n\n## Related products\n\n**[Cloudflare Magic Transit](https://developers.cloudflare.com/magic-transit/)**\n\nSecure your network from incoming Internet traffic, and improve performance at Cloudflare scale.\n\n**[Cloudflare Magic WAN](https://developers.cloudflare.com/magic-wan/)**\n\nImprove security and performance for your entire corporate networking, reducing cost and operation complexity.\n\n</page>\n\n<page>\n---\ntitle: Protocol validation rules  Cloudflare One docs\ndescription: Magic Firewall supports Session Initiation Protocol (SIP) to\n  inspect traffic validity and enforce a positive security model.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/protocol-validation-rules/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/protocol-validation-rules/index.md\n---\n\nMagic Firewall supports [Session Initiation Protocol (SIP)](https://datatracker.ietf.org/doc/html/rfc2543) to inspect traffic validity and enforce a positive security model.\n\nYou can use the `sip` field when creating a rule to determine if packets are valid SIP Layer 7 (L7) protocol. Refer to [Magic Firewall fields](https://developers.cloudflare.com/cloudflare-one/reusable-components/packet-filtering-fields/), specifically the `sip` field, for more information on this topic.\n\nContact your account manager if you need Magic Firewall to support additional protocols.\n\n</page>\n\n<page>\n---\ntitle: Ruleset logic  Cloudflare One docs\ndescription: Magic Firewall rules are performed after Cloudflare's DDoS\n  mitigations have been applied. The two systems are independent, and therefore,\n  permitting traffic inside Magic Firewall does not allow it within our DDoS\n  mitigations. Traffic can still be blocked by DDoS mitigations that are applied\n  first in the flow through Cloudflare's systems.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/ruleset-logic/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/ruleset-logic/index.md\n---\n\nMagic Firewall rules are performed after Cloudflare's DDoS mitigations have been applied. The two systems are independent, and therefore, permitting traffic inside Magic Firewall does not allow it within our DDoS mitigations. Traffic can still be blocked by DDoS mitigations that are applied first in the flow through Cloudflare's systems.\n\nBy default, Magic Firewall policies allow all traffic until explicitly blocked by a rule. If no policy is configured, all traffic is permitted after Cloudflare's DDoS mitigations have been applied.\n\n## Security policy\n\nYou have two options for configuring a security policy:\n\n* Enforce a positive security model and only permit required traffic and block everything else.\n* Begin with a minimal ruleset to block specific traffic and, by default, everything else is permitted.\n\nTraffic is matched in order of the configured rules. As soon as traffic is matched by an enabled rule, it is no longer validated against the later rules, and traffic will pass through disabled rules. In the dashboard under **Traffic policies** > **Magic Firewall**, rule order begins from the top and flows down your list of rules.\n\nFor example, permitting all TCP traffic in a rule #4 would mean all TCP traffic is permitted. A rule #5 to block traffic for IP address `x.x.x.x` would not be checked.\n\nFor best practices when configuring your security policy, refer to [Best practices](https://developers.cloudflare.com/magic-firewall/best-practices/).\n\n## Packet filtering policies and Magic Transit endpoint health checks\n\nCloudflare-sourced traffic is also subject to the Magic Firewall rules you configure. If you block all ICMP traffic, you will also block Cloudflare's [endpoint health checks](https://developers.cloudflare.com/magic-transit/reference/tunnel-health-checks/#endpoint-health-checks). When blocking ICMP traffic, ensure your rules first allow ICMP sourced from Cloudflare public IPs to your prefix endpoint IPs before applying a block ICMP rule.\n\nFor a list of Cloudflare's public IPs, refer to [IP Ranges](https://www.cloudflare.com/ips/).\n\n## Magic Firewall phases\n\nMagic Firewall processes traffic in two phases: in the first phase, Magic Firewall policies match packets against rules in the Custom phase. In the second phase, Magic Firewall match packets against rules in the Managed phase.\n\n### Custom phase ruleset\n\nCustom phase is a set of rules defined by the user. The expression, order, and actions of those rules can be customized by the user.\n\nAdditionally, users can add a rule in this custom phase to override the behavior of a rule in the Managed phase.\n\n### Managed phase ruleset\n\nManaged phase rulesets are updated and maintained by Cloudflare, and Cloudflare creates these rules based on best practices, known malicious patterns, and other criteria.\n\nCloudflare maintains the expressions and order of execution for rules in the Managed phase. Rules can be enabled, disabled, or made to log matching packets.\n\nRefer to [Enable managed rulesets](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/enable-managed-rulesets/) for more information.\n\n</page>\n\n<page>\n---\ntitle: Traffic types  Cloudflare One docs\ndescription: Magic Firewall enables you to allow or block traffic on a variety\n  of packet characteristics, such as source and destination IP, source and\n  destination port, protocol, packet length, and bit field match.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/traffic-types/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/traffic-types/index.md\n---\n\nMagic Firewall enables you to allow or block traffic on a variety of packet characteristics, such as source and destination IP, source and destination port, protocol, packet length, and bit field match.\n\nMagic Firewall supports layers three and four  network and transport  protocols such as TCP, UDP, and ICMP. Any type of layer three or four protocols can go through Magic Firewall and then be matched on those protocols.\n\nTo view the list of available fields, refer to [Magic Firewall fields](https://developers.cloudflare.com/magic-firewall/reference/magic-firewall-fields/).\n\n</page>\n\n<page>\n---\ntitle: Configure Advanced DNS Protection via API  Cloudflare DDoS Protection docs\ndescription: Use the Cloudflare API to configure Advanced DNS Protection via API.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/index.md\n---\n\nUse the [Cloudflare API](https://developers.cloudflare.com/api/) to configure Advanced DNS Protection via API.\n\nFor examples of API calls, refer to [Common API calls](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/examples/).\n\n## Endpoints\n\nTo obtain the complete endpoint, append the Advanced DNS Protection API endpoints listed below to the Cloudflare API base URL:",
      "language": "unknown"
    },
    {
      "code": "The `{account_id}` argument is the [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) (a hexadecimal string). You can find this value in the Cloudflare dashboard.\n\nThe following table summarizes the available operations.\n\n| Operation | Verb + Endpoint |\n| - | - |\n| List DNS protection rules | `GET accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules`Fetches all DNS protection rules in the account. |\n| Add a DNS protection rule | `POST accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules`Adds a DNS protection rule to the account. |\n| Get a DNS protection rule | `GET accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules/{rule_id}`Fetches the details of an existing DNS protection rule in the account. |\n| Update a DNS protection rule | `PATCH accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules/{rule_id}`Updates an existing DNS protection rule in the account. |\n| Delete a DNS protection rule | `DELETE accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules/{rule_id}`Deletes an existing DNS protection rule from the account. |\n| Delete all DNS protection rules | `DELETE accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules`Deletes all existing DNS protection rules from the account. |\n\n</page>\n\n<page>\n---\ntitle: Configure Advanced TCP Protection via API  Cloudflare DDoS Protection docs\ndescription: You can configure Advanced TCP Protection using the Advanced TCP\n  Protection API.\nlastUpdated: 2024-11-04T15:20:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/index.md\n---\n\nYou can configure Advanced TCP Protection using the Advanced TCP Protection API.\n\nThe Advanced TCP Protection API only supports [API token authentication](https://developers.cloudflare.com/fundamentals/api/get-started/create-token/).\n\nFor examples of API calls, refer to [Common API calls](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/examples/).\n\n## Endpoints\n\nTo obtain the complete endpoint, append the Advanced TCP Protection API endpoints listed below to the Cloudflare API base URL.\n\nThe Cloudflare API base URL is:",
      "language": "unknown"
    },
    {
      "code": "The `{account_id}` argument is the account ID (a hexadecimal string). You can find this value in the Cloudflare dashboard.\n\nThe tables in the following sections summarize the available operations.\n\n### General operations\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| Get Advanced TCP Protection status | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_protection_status`Gets the global Advanced TCP Protection status (enabled or disabled). |\n| Update Advanced TCP Protection status | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_protection_status`Enables or disables Advanced TCP Protection. |\n\n### Prefix operations\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List prefixes | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes`Fetches all Advanced TCP Protection prefixes in the account. |\n| Add prefixes in bulk | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes/bulk`Adds prefixes in bulk to the account (up to 300 prefixes per request). |\n| Get a prefix | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes/{prefix_id}`Fetches the details of an existing prefix. |\n| Update a prefix | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes/{prefix_id}`Updates an existing prefix. |\n| Delete a prefix | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes/{prefix_id}`Deletes an existing prefix. |\n| Delete all prefixes | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes`Deletes all existing prefixes from the account. |\n\n### Allowlist operations\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List allowlisted prefixes | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist`Fetches all prefixes in the account allowlist. |\n| Add an allowlisted prefix | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist`Adds a prefix to the allowlist. |\n| Get an allowlisted prefix | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist/{allowlist_id}`Fetches the details of an existing prefix in the allowlist. |\n| Update an allowlisted prefix | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist/{allowlist_id}`Updates an existing prefix in the allowlist. |\n| Delete an allowlisted prefix | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist/{allowlist_id}`Deletes an existing prefix from the allowlist. |\n| Delete all allowlisted prefixes | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist`Deletes all existing prefixes from the allowlist. |\n\n### SYN Flood Protection operations\n\n#### Rules\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List SYN flood rules | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules`Fetches all SYN flood rules in the account. |\n| Add a SYN flood rule | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules`Adds a SYN flood rule to the account. |\n| Get a SYN flood rule | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules/{rule_id}`Fetches the details of an existing SYN flood rule in the account. |\n| Update a SYN flood rule | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules/{rule_id}`Updates an existing SYN flood rule in the account. |\n| Delete a SYN flood rule | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules/{rule_id}`Deletes an existing SYN flood rule from the account. |\n| Delete all SYN flood rules | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules`Deletes all existing SYN flood rules from the account. |\n\n#### Filters\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List SYN flood filters | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters`Fetches all SYN flood filters in the account. |\n| Add a SYN flood filter | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters`Adds a SYN flood filter to the account. |\n| Get a SYN flood filter | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters/{filter_id}`Fetches the details of an existing SYN flood filter in the account. |\n| Update a SYN flood filter | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters/{filter_id}`Updates an existing SYN flood filter in the account. |\n| Delete a SYN flood filter | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters/{filter_id}`Deletes an existing SYN flood filter from the account. |\n| Delete all SYN flood filters | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters`Deletes all existing SYN flood filters from the account. |\n\n### Out-of-state TCP Protection operations\n\n#### Rules\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List out-of-state TCP rules | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules`Fetches all out-of-state TCP rules in the account. |\n| Add an out-of-state TCP rule | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules`Adds an out-of-state TCP rule to the account. |\n| Get an out-of-state TCP rule | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules/{rule_id}`Fetches the details of an existing out-of-state TCP rule in the account. |\n| Update an out-of-state TCP rule | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules/{rule_id}`Updates an existing out-of-state TCP rule in the account. |\n| Delete an out-of-state TCP rule | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules/{rule_id}`Deletes an existing out-of-state TCP rule from the account. |\n| Delete all out-of-state TCP rules | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules`Deletes all existing out-of-state TCP rules from the account. |\n\n#### Filters\n\n| Operation | Method and endpoint / Description |\n| - | - |\n| List out-of-state TCP filters | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters`Fetches all out-of-state TCP filters in the account. |\n| Add an out-of-state TCP filter | `POST accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters`Adds an out-of-state TCP filter to the account. |\n| Get an out-of-state TCP filter | `GET accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters/{filter_id}`Fetches the details of an existing out-of-state TCP filter in the account. |\n| Update an out-of-state TCP filter | `PATCH accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters/{filter_id}`Updates an existing out-of-state TCP filter in the account. |\n| Delete an out-of-state TCP filter | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters/{filter_id}`Deletes an existing out-of-state TCP filter from the account. |\n| Delete all out-of-state TCP filters | `DELETE accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters`Deletes all existing out-of-state TCP filters from the account. |\n\n## Pagination\n\nThe API operations that return a list of items use pagination. For more information on the available pagination query parameters, refer to [Pagination](https://developers.cloudflare.com/fundamentals/api/how-to/make-api-calls/#pagination).\n\n</page>\n\n<page>\n---\ntitle: Add a prefix to Advanced DDoS Protection  Cloudflare DDoS Protection docs\ndescription: \"To add a prefix to Advanced DDoS Protection:\"\nlastUpdated: 2025-09-03T18:12:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix/index.md\n---\n\nTo add a [prefix](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#prefixes) to Advanced DDoS Protection:\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection**.\n\n3. Under **General settings** > **Prefixes**, select **Edit**.\n\n4. Expand the **Add existing prefix** section and select **Add** next to the prefix you wish to add.\\\n   Alternatively, enter a prefix and (optionally) a description in **Prefix** and **Description**, respectively, and select **Add**.\n\nNote\n\nThe **Add existing prefix** list will not display leased prefixes, but you can add them manually in the Cloudflare dashboard or [using the API](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/). You cannot add [delegated prefixes](https://developers.cloudflare.com/byoip/concepts/prefix-delegations/) to Advanced TCP Protection.\n\n</page>\n\n<page>\n---\ntitle: Add an IP address/prefix to the Advanced DDoS Protection allowlist \n  Cloudflare DDoS Protection docs\ndescription: \"To add an IP address or prefix to the Advanced DDoS Protection allowlist:\"\nlastUpdated: 2025-12-12T22:28:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix-allowlist/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix-allowlist/index.md\n---\n\nTo add an IP address or prefix to the Advanced DDoS Protection [allowlist](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#allowlist):\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection**.\n\n3. Under **General settings** > **Allowlist**, select **Edit**.\n\n4. Enter a prefix and (optionally) a description in **Prefix** and **Description**, respectively.\n\n5. To exclude the current prefix from the allowlist instead of including it, uncheck the **Enabled** checkbox. 6. Select **Add**.\n\nAllowlists support approximately 200 IP addresses in a single expression for a rule.\n\nImportant\n\nPrefixes in the allowlist will be vulnerable to IP spoofing attacks. If an attacker can guess the source IP addresses you have allowlisted, their packets will be allowlisted.\n\n</page>\n\n<page>\n---\ntitle: Create a filter for Advanced TCP Protection  Cloudflare DDoS Protection docs\ndescription: A filter modifies Advanced TCP Protection's execution mode \n  monitoring, mitigation (enabled), or disabled  for all incoming packets\n  matching an expression.\nlastUpdated: 2025-09-03T18:12:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/create-filter/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/create-filter/index.md\n---\n\nA filter modifies Advanced TCP Protection's [execution mode](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#mode)  monitoring, mitigation (enabled), or disabled  for all incoming packets matching an expression.\n\nEach protection system component (SYN flood protection or out-of-state TCP protection) should have at least one [rule](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rule), but filters are optional.\n\nNote\n\nFilters only apply to Advanced TCP Protection.\n\n## Procedure\n\nTo create a [filter](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#filter) for one of the system components:\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection** > **Advanced TCP Protection**.\n\n3. Under the system component for which you are creating the filter (**SYN Flood Protection** or **Out-of-state TCP Protection**), select **Create** next to the type of filter you want to create:\n\n   * **Mitigation Filter**: The protection system will drop packets matching the filter expression. - **Monitoring Filter**: The protection system will log packets matching the filter expression.\n   * **Off Filter**: The protection system will ignore packets matching the filter expression.\n\n4. Under **When incoming packets match**, define a filter expression using the Expression Builder (specifying one or more values for **Field**, **Operator**, and **Value**), or manually enter an expression using the Expression Editor. For more information, refer to [Edit rule expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/).\n\n5. Select **Save**.\n\nNote\n\nFilters take precedence over rules. For details on how the execution mode is determined, refer to [Determining the execution mode](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#determining-the-execution-mode).\n\n</page>\n\n<page>\n---\ntitle: Create an Advanced DDoS Protection rule  Cloudflare DDoS Protection docs\ndescription: \"To create a SYN flood rule or an out-of-state TCP rule:\"\nlastUpdated: 2025-09-03T18:12:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/create-rule/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/create-rule/index.md\n---\n\n## Create an Advanced TCP Protection rule\n\nTo create a [SYN flood rule](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/#syn-flood-protection) or an [out-of-state TCP](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/#out-of-state-tcp-protection) rule:\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection** > **Advanced TCP Protection**.\n\n3. Depending on the rule you are creating, do one of the following:\n\n   * Under **SYN Flood Protection**, select **Create SYN flood rule**.\n   * Under **Out-of-state TCP Protection**, select **Create out-of-state TCP rule**.\n\n4. In **Mode**, select a [mode](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#mode) for the rule.\n\n5. Under **Set scope**, select a [scope](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#scope) for the rule. If you choose to apply the rule to a subset of incoming packets, select a region or a data center.\n\n6. Under **Sensitivity**, define the [burst sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#burst-sensitivity) and [rate sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rate-sensitivity) of the rule (by default, *Medium*). The sensitivity levels are based on the initially configured thresholds for your specific case.\n\n7. Select **Deploy**.\n\nNote\n\nFilters take precedence over rules. For details on how the execution mode is determined, refer to [Determining the execution mode](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#determining-the-execution-mode).\n\n## Create an Advanced DNS Protection rule\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection** > **General settings**.\n\n3. Add the prefixes you wish to onboard. Advanced DNS Protection will only be applied to the prefixes you onboard. If you already onboarded the desired prefixes when you configured Advanced TCP Protection, you do not need to take any other action.\n\n   Note\n\n   Currently, the list of onboarded prefixes is shared with Advanced TCP Protection. Any onboarded prefixes will be subject to both Advanced TCP Protection and Advanced DNS Protection, assuming that your account team has done the initial configuration of both systems. However, you can leave Advanced TCP Protection in monitoring mode.\n\n4. Go to **Advanced DNS Protection**.\n\n5. Select **Create Advanced DNS Protection rule**.\n\n6. In **Mode**, select a mode for the rule.\n\n7. Under **Set scope**, select a [scope](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#scope) to determine the range of packets that will be affected by the rule.\n\n8. Under **Sensitivity**, define the [burst sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#burst-sensitivity), [rate sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rate-sensitivity), and [profile sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#profile-sensitivity) to determine when to initiate mitigation. 9. Select **Deploy**.\n\n</page>\n\n<page>\n---\ntitle: Exclude a prefix  Cloudflare DDoS Protection docs\ndescription: \"To exclude a prefix or a prefix subset from Advanced DDoS Protection:\"\nlastUpdated: 2025-09-03T18:12:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/exclude-prefix/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/exclude-prefix/index.md\n---\n\nTo exclude a prefix or a prefix subset from Advanced DDoS Protection:\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n   [Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Advanced Protection**.\n\n3. [Add the prefix](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix/) you previously onboarded to Magic Transit to Advanced TCP Protection.\n\n4. [Add the prefix](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix/) (or subset) you wish to exclude as a new, separate prefix in Advanced TCP Protection.\n\n5. For the prefix you added in the previous step, select **Exclude Subset** in the **Enrolled Prefixes** list.\n\nNote\n\nPrefixes or subsets added as *Excluded* will not be protected by Advanced TCP Protection.\n\n</page>\n\n<page>\n---\ntitle: Cloudflare Advanced DNS Protection  Cloudflare DDoS Protection docs\ndescription: Cloudflare's Advanced DNS Protection, powered by flowtrackd,\n  provides stateful protection against DNS-based DDoS attacks, specifically\n  sophisticated and fully randomized DNS attacks such as random prefix attacks.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-dns-protection/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-dns-protection/index.md\n---\n\nCloudflare's Advanced DNS Protection, powered by [`flowtrackd`](https://blog.cloudflare.com/announcing-flowtrackd/), provides stateful protection against DNS-based DDoS attacks, specifically sophisticated and fully randomized DNS attacks such as [random prefix attacks](https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/about/).\n\nNote\n\nAdvanced TCP and DNS Protection systems are automatically enabled in `Monitor` mode with the default thresholds for new Magic Transit customers and their [authorized prefixes](https://developers.cloudflare.com/magic-transit/how-to/advertise-prefixes/).\n\nMagic Transit customers can also enable the Advanced DDoS systems when the prefixes are ready, change the sensitivity level, or adjust the thresholds by contacting their account team.\n\n## How it works\n\nCloudflare's Advanced DNS Protection works by first learning your traffic patterns and forming a baseline of the type of DNS queries you normally receive. Later, the system will be able to distinguish between legitimate and malicious queries, protecting your DNS infrastructure without impacting legitimate traffic.\n\nCurrently, the protection system only analyzes DNS over UDP (it does not include DNS over TCP).\n\nThe [Network Analytics dashboard](https://developers.cloudflare.com/analytics/network-analytics/) will display system-specific analytics for Advanced DNS Protection in the **DNS protection** tab, including the queried domains and record types.\n\n***\n\n## Setup\n\n[Create a rule](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/create-rule/#create-an-advanced-dns-protection-rule) to enable Advanced DNS Protection.\n\n***\n\n## Data collection\n\nCloudflare collects DNS-related data such as query type (for example, `A` record) and the queried domains. For details, refer to [Data collection](https://developers.cloudflare.com/analytics/network-analytics/reference/data-collection/).\n\nWarning\n\nCurrently, to disable this data collection you must remove your prefixes either in the Cloudflare dashboard or through the [Delete a prefix](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/#prefix-operations) API operation. However, this procedure will remove the prefixes from both Advanced DNS Protection and [Advanced TCP Protection](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/).\n\n***\n\n## Troubleshooting\n\n### No data about Advanced DNS Protection in Network Analytics\n\nIf you cannot find any data related to Advanced DNS Protection in the **DNS Protection** tab of Network Analytics, it could be because one of these reasons:\n\n* You did not [add your prefixes](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/how-to/add-prefix/) to Advanced L3/4 DDoS Protection.\n* Accounts that existed before January 2025 were not automatically provisioned. If you onboarded before January 2025, Advanced DNS Protection may not have been enabled for your account.\n* You do not have any DNS over UDP traffic.\n\n***\n\n## Related products\n\nAdvanced DNS Protection can protect you against volumetric DNS DDoS attacks. To perform DNS caching, proxying, and configuration, use the [Cloudflare DNS Firewall](https://developers.cloudflare.com/dns/dns-firewall/).\n\nCurrently, Advanced DNS Protection is not available for DNS Firewall.\n\n</page>\n\n<page>\n---\ntitle: Cloudflare Advanced TCP Protection  Cloudflare DDoS Protection docs\ndescription: Cloudflare's Advanced TCP Protection, powered by flowtrackd, is a\n  stateful TCP inspection engine used to detect and mitigate sophisticated\n  out-of-state TCP attacks such as randomized and spoofed ACK floods or SYN and\n  SYN-ACK floods.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/index.md\n---\n\nCloudflare's Advanced TCP Protection, powered by [`flowtrackd`](https://blog.cloudflare.com/announcing-flowtrackd/), is a stateful TCP inspection engine used to detect and mitigate sophisticated out-of-state TCP attacks such as randomized and spoofed ACK floods or SYN and SYN-ACK floods.\n\nNote\n\nAdvanced TCP and DNS Protection systems are automatically enabled in `Monitor` mode with the default thresholds for new Magic Transit customers and their [authorized prefixes](https://developers.cloudflare.com/magic-transit/how-to/advertise-prefixes/).\n\nMagic Transit customers can also enable the Advanced DDoS systems when the prefixes are ready, change the sensitivity level, or adjust the thresholds by contacting their account team.\n\n## How it works\n\nAdvanced TCP Protection can simultaneously protect against different kinds of attacks:\n\n* Pinpointed attacks targeting a specific destination IP/port combination.\n* Broad attacks targeting multiple IP addresses of an IP prefix at the same time.\n\nAdvanced TCP Protection can track TCP connections even when they move between Cloudflare data centers.\n\nThe feature offers two types of protection:\n\n* [SYN Flood Protection](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/#syn-flood-protection): Protects against attacks such as fully randomized SYN and SYN-ACK floods.\n* [Out-of-state TCP Protection](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/advanced-tcp-protection/#out-of-state-tcp-protection): Protects against out-of-state TCP DDoS attacks such as fully randomized ACK floods and RST floods.\n\nEach protection type is configured independently using rules and (optionally) filters. You should configure at least one rule for each type of protection before enabling Advanced TCP Protection.\n\n### SYN Flood Protection\n\nThis system protects against attacks such as fully randomized SYN and SYN-ACK floods. You should configure at least one SYN flood rule before enabling Advanced TCP Protection.\n\nIn mitigation mode, SYN flood rules will challenge new connection initiation requests (SYN, SYN-ACK) if they exceed the configured packet-per-second thresholds. The threshold should be higher than the normal rate of legitimate SYN and SYN-ACK packets that your network receives. Packets below the threshold will not be challenged. Using the [rate sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rate-sensitivity) and [burst sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#burst-sensitivity) settings you can increase or decrease the tolerance of SYN and SYN-ACK packets.\n\nFor more information on the configuration settings of SYN flood rules, refer to [Rule settings](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rule-settings).\n\n### Out-of-state TCP Protection\n\nThis system protects against out-of-state TCP DDoS attacks such as fully randomized ACK floods and RST floods. You should configure one out-of-state TCP rule before enabling Advanced TCP Protection.\n\nIn mitigation mode, out-of-state TCP rules will drop out-of-state packets that do not belong to existing (and tracked) TCP connections if their rates exceed the configured thresholds. The threshold should be higher than the normal rate of non SYN or SYN-ACK TCP packets that your network receives. Packets below the threshold will not be evaluated. Using the [rate sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rate-sensitivity) and [burst sensitivity](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#burst-sensitivity) settings you can increase or decrease the tolerance of out-of-state TCP packets.\n\nFor more information on the configuration settings of out-of-state TCP rules, refer to [Rule settings](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rule-settings).\n\n***\n\n## Setup\n\n[Create a global configuration](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/#rules) to set up SYN Flood and Out-of-state TCP rules and filters for Advanced TCP Protection.\n\n</page>\n\n<page>\n---\ntitle: 2022-04-12  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-04-12/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-04-12/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...89e250ce | IPv4 GRE encapsulated IP or PPP (Inner protocol 0x0800 or 0x880B) | ddos\\_dynamic | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2022-09-16  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-09-16/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-09-16/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...11456494 | IPv6 GRE miscellaneous inner protocols (Inner protocols other than 0x0800 or 0x880B) | block | N/A | |\n| ...800534de | IPv6 GRE encapsulated IP or PPP (Inner protocol 0x0800 or 0x880B) | ddos\\_dynamic | N/A | |\n\n</page>\n\n<page>\n---\ntitle: 2022-09-21  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-09-21/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-09-21/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...58e4914a | Adaptive DDoS Protection for UDP (Available only to Enterprise accounts). | log | log | Update UDP profiling rule tag and threshold |\n| ...76d5e15c | Adaptive DDoS Protection for Other IPv6 Protocols (Available only to Enterprise accounts). | log | log | Update other IPv6 protos profiling rule tag and threshold |\n| ...8de83ef6 | Adaptive DDoS Protection for IPv6 GRE (Available only to Enterprise accounts). | log | log | Update IPv6 GRE profiling rule tag and threshold |\n| ...938e978c | Adaptive DDoS Protection for IPv6 ESP (Available only to Enterprise accounts). | log | log | Update IPv6 ESP profiling rule tag and threshold |\n| ...9c173480 | Adaptive DDoS Protection for ICMP (Available only to Enterprise accounts). | log | log | Update ICMP profiling rule tag and threshold |\n| ...ad8078b8 | Adaptive DDoS Protection for IPv4 GRE (Available only to Enterprise accounts). | log | log | Update IPv4 GRE profiling rule tag and threshold |\n| ...ae3f5e4e | Adaptive DDoS Protection for ICMPv6 (Available only to Enterprise accounts). | log | log | Update ICMPv6 profiling rule tag and threshold |\n| ...c7dc52df | Adaptive DDoS Protection for Other IPv4 Protocols (Available only to Enterprise accounts). | log | log | Update other IPv4 protos profiling rule tag and threshold |\n| ...e4e7541c | Adaptive DDoS Protection for IPv4 ESP (Available only to Enterprise accounts). | log | log | Update IPv4 ESP profiling rule tag and threshold |\n\n</page>\n\n<page>\n---\ntitle: 2022-10-06  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-10-06/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-10-06/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...34228119 | IPv4 UDP SIP traffic | log | N/A | |\n| ...58e4914a | Adaptive DDoS Protection for UDP (Available only to Enterprise accounts). | log | N/A | |\n| ...76d5e15c | Adaptive DDoS Protection for Other IPv6 Protocols (Available only to Enterprise accounts). | log | N/A | |\n| ...8de83ef6 | Adaptive DDoS Protection for IPv6 GRE (Available only to Enterprise accounts). | log | N/A | |\n| ...938e978c | Adaptive DDoS Protection for IPv6 ESP (Available only to Enterprise accounts). | log | N/A | |\n| ...9c173480 | Adaptive DDoS Protection for ICMP (Available only to Enterprise accounts). | log | N/A | |\n| ...ad8078b8 | Adaptive DDoS Protection for IPv4 GRE (Available only to Enterprise accounts). | log | N/A | |\n| ...ae3f5e4e | Adaptive DDoS Protection for ICMPv6 (Available only to Enterprise accounts). | log | N/A | |\n| ...c7dc52df | Adaptive DDoS Protection for Other IPv4 Protocols (Available only to Enterprise accounts). | log | N/A | |\n| ...e4e7541c | Adaptive DDoS Protection for IPv4 ESP (Available only to Enterprise accounts). | log | N/A | |\n| ...ea9e05c3 | IPv6 UDP SIP traffic | log | N/A | |\n\n</page>\n\n<page>\n---\ntitle: 2022-10-24  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-10-24/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-10-24/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...e4e7541c | Adaptive DDoS Protection for IPv4 ESP (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n\n</page>\n\n<page>\n---\ntitle: 2023-04-17  Cloudflare DDoS Protection docs\ndescription: Previously, only a subset of rules were exposed publicly. In rare\n  situations, these rules can cause false positives. When this happens, you can\n  customize their behavior using overrides.\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2023-04-17/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2023-04-17/index.md\n---\n\nPreviously, only a subset of rules were exposed publicly. In rare situations, these rules can cause false positives. When this happens, you can customize their behavior using overrides.\n\nBesides these rules, the DDoS managed rules contain other rules that do not cause issues. Until now, these rules were not shown in the dashboard or referenced in the documentation.\n\nCloudflare now shows all rules in the dashboard, including these high-confidence rules. This means that packets matching these rules will now have the correct rule identifier. The newly published rules are read-only and you cannot disable them.\n\n</page>\n\n<page>\n---\ntitle: 2022-12-02  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-12-02/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2022-12-02/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...58e4914a | Adaptive DDoS Protection for UDP (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...76d5e15c | Adaptive DDoS Protection for Other IPv6 Protocols (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...8de83ef6 | Adaptive DDoS Protection for IPv6 GRE (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...938e978c | Adaptive DDoS Protection for IPv6 ESP (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...9c173480 | Adaptive DDoS Protection for ICMP (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...ad8078b8 | Adaptive DDoS Protection for IPv4 GRE (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...ae3f5e4e | Adaptive DDoS Protection for ICMPv6 (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...c7dc52df | Adaptive DDoS Protection for Other IPv4 Protocols (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n| ...e4e7541c | Adaptive DDoS Protection for IPv4 ESP (Available only to Enterprise accounts). | log | log | Lower sensitivity to avoid false positives |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-31  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2023-07-31/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2023-07-31/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...aa772b5c | Adaptive DDoS Protection for Location-Based UDP (Available only to Enterprise accounts). | N/A | log | Enable UDP geolocation Adaptive DDoS rule |\n\n</page>\n\n<page>\n---\ntitle: 2024-03-12  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/2024-03-12/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/2024-03-12/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...85fa2e98 | Adaptive DDoS Protection for UDP Destination Ports (Available only to Enterprise accounts). | N/A | log | Enable rule that uses a customer's UDP destination port profile to mitigate traffic (log mode by default). |\n\n</page>\n\n<page>\n---\ntitle: Scheduled changes  Network-layer DDoS  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/network/scheduled-changes/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/network/scheduled-changes/index.md\n---\n\n| Announcement Date | Change Date | Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - | - | - |\n| N/A | N/A | N/A | N/A | N/A | N/A | N/A |\n\n</page>\n\n<page>\n---\ntitle: 2022-04-07  Cloudflare DDoS Protection docs\nlastUpdated: 2025-08-18T14:27:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-07/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-07/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...8ed59b32 | Global L7 attack mitigations | ddos\\_dynamic | ddos\\_dynamic | Some attack patterns will be detected more consistently. |\n\n</page>\n\n<page>\n---\ntitle: 2022-04-12  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-12/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-12/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...61b90333 | HTTP requests with unusual HTTP headers or URI path (signature #15). | N/A | managed\\_challenge | This rule is detecting floods of requests impersonating a browser. |\n| ...81b13394 | HTTP requests with unusual HTTP headers or URI path (signature #2). | block | block | Updated the filter to detect attacks more easily |\n\n</page>\n\n<page>\n---\ntitle: 2022-05-03  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-05-03/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-05-03/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...4cc1fcb6 | BETA - HTTP requests with unusual HTTP headers or URI path (signature #2). | log | N/A | |\n| ...81b13394 | HTTP requests with unusual HTTP headers or URI path (signature #2). | block | block | Update the rule to catch more attacks than before. |\n| ...863134d5 | HTTP requests from known bad user agents. | log | block | |\n\n</page>\n\n<page>\n---\ntitle: 2022-04-21  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-21/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-04-21/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...e7dccda4 | HTTP requests from known botnet (signature #7). | block | block | Remove false positives. |\n\n</page>\n\n<page>\n---\ntitle: 2022-05-12  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-05-12/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-05-12/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...ad07ec62 | HTTP requests with unusual HTTP headers or URI path (signature #6). | log | block | |\n\n</page>\n\n<page>\n---\ntitle: 2022-06-01  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-06-01/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-06-01/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | managed\\_challenge | ddos\\_dynamic | Pick different actions depending on attack characteristics. |\n\n</page>\n\n<page>\n---\ntitle: 2022-06-08  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-06-08/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-06-08/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Expanded the filter to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2022-07-06  Cloudflare DDoS Protection docs\nlastUpdated: 2025-08-19T15:06:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-06/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-06/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...444be2c3 | Location-Aware DDoS Protection (Available only to Enterprise zones with Advanced DDoS service). | N/A | log | Added new Location-Aware DDoS Protection for Enterprise accounts that are subscribed to the Advanced DDoS service. Location Aware DDoS Protection constantly learns a zone's traffic levels per country and region over time, creates a traffic profile and then flags or mitigates traffic that deviates from the profile. |\n| ...863134d5 | HTTP requests from known bad user agents. | block | block | Requests matching this rule will not match any other. |\n\n</page>\n\n<page>\n---\ntitle: 2022-07-08  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-08/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-08/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...7d4f6798 | HTTP requests causing a high request rate to authentication endpoints. | block | block | Update thresholds for lower sensitivity levels to align with other rules. |\n| ...ecd68c61 | HTTP requests causing a high request rate to search endpoints. | ddos\\_dynamic | ddos\\_dynamic | Update thresholds for lower sensitivity levels to align with other rules. |\n\n</page>\n\n<page>\n---\ntitle: 2022-07-18  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-18/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-07-18/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1712a123 | HTTP requests with unusual HTTP headers or URI path (signature #16). | log | block | Enable the rule as scheduled. |\n\n</page>\n\n<page>\n---\ntitle: 2022-08-02  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-02/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-02/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1712a123 | HTTP requests with unusual HTTP headers or URI path (signature #16). | log | block | Allow requests matching this rule to match other rules too in order to catch more attacks. |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Extend the scope of this filter to match a wider set of requests. |\n\n</page>\n\n<page>\n---\ntitle: 2022-08-10  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-10/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-10/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Remove false positives. |\n\n</page>\n\n<page>\n---\ntitle: 2022-08-16  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-16/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-08-16/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1712a123 | HTTP requests with unusual HTTP headers or URI path (signature #16). | block | block | Modify the rule to catch more attacks. |\n| ...b757316c | BETA - HTTP requests with unusual HTTP headers or URI path (signature #16). | log | N/A | Observation filter removed, rule is now merged with ...1712a123 |\n\n</page>\n\n<page>\n---\ntitle: 2022-09-13  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-13/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-13/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...e4fe8e55 | User-Agent-aware DDoS Protection (Available only to Enterprise zones with Advanced DDoS service). | log | managed\\_challenge | |\n\n</page>\n\n<page>\n---\ntitle: 2022-09-14  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-14/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-14/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...e4fe8e55 | User-Agent-aware DDoS Protection (Available only to Enterprise zones with Advanced DDoS service). | managed\\_challenge | log | This rule is causing false positive in some rare occurrences, we are reverting it back to log by default (opt-in). |\n\n</page>\n\n<page>\n---\ntitle: 2022-09-19 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-19-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-09-19-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...c4bef55c | HTTP requests from known botnet (signature #5). | ddos\\_dynamic | ddos\\_dynamic | Update the rule to target previously missed attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2022-10-06 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-10-06-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-10-06-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6fa59d23 | HTTP requests that are very likely coming from bots. | managed\\_challenge | ddos\\_dynamic | Block very large attacks instead of challenging them. |\n| ...91b2849e | HTTP requests with unusual HTTP headers (signature #13). | block | block | Some attacks were only partially mitigated. Now the rule should stop attacks completely. |\n\n</page>\n\n<page>\n---\ntitle: 2022-10-14  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-10-14/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-10-14/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6fa59d23 | HTTP requests that are very likely coming from bots. | ddos\\_dynamic | ddos\\_dynamic | Block more large attacks instead of challenging. |\n\n</page>\n\n<page>\n---\ntitle: 2022-11-02 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-11-02-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-11-02-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...06a46ce3 | HTTP requests with unusual HTTP headers or URI path (signature #18). | N/A | block | N/A |\n| ...81b5405c | HTTP requests from known botnet (signature #3). | block | block | Extend the rule to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2022-12-07 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-12-07-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2022-12-07-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Remove a small probability of false positive with worker subrequests. |\n\n</page>\n\n<page>\n---\ntitle: 2023-01-30  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-01-30/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-01-30/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...291a3fc7 | HTTP requests with unusual HTTP headers or URI path (signature #19). | log | block | New rule blocking requests with unusual attributes. |\n\n</page>\n\n<page>\n---\ntitle: 2023-02-20  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-02-20/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-02-20/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...863134d5 | HTTP requests from known bad user agents. | block | block | Detect more load testing tools as bad |\n\n</page>\n\n<page>\n---\ntitle: 2023-02-28 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-02-28-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-02-28-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...97003a74 | HTTP requests with unusual HTTP headers or URI path (signature #17). | log | ddos\\_dynamic | Enable mitigation on a subset of this rule that is known to only match attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-03-10  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-03-10/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-03-10/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...97003a74 | HTTP requests with unusual HTTP headers or URI path (signature #17). | ddos\\_dynamic | block | Detect new attacks with unusual HTTP attributes. |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Expand the filter to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-03-22  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-03-22/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-03-22/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Mitigate more attacks (action is managed-challenge for smaller attacks, block for large ones). |\n\n</page>\n\n<page>\n---\ntitle: 2023-04-03  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-03/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-03/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...cedf44f8 | HTTP requests with non-standard HTTP methods. | log | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-04-17  Cloudflare DDoS Protection docs\ndescription: Previously, only a subset of rules were exposed publicly. In rare\n  situations, these rules can cause false positives. When this happens, you can\n  customize their behavior using overrides.\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-17/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-17/index.md\n---\n\nPreviously, only a subset of rules were exposed publicly. In rare situations, these rules can cause false positives. When this happens, you can customize their behavior using overrides.\n\nBesides these rules, the DDoS managed rules contain other rules that do not cause issues. Until now, these rules were not shown in the dashboard or referenced in the documentation.\n\nCloudflare now shows all rules in the dashboard, including these high-confidence rules. This means that requests matching these rules will now have the correct rule identifier. The newly published rules are read-only and you cannot disable them.\n\n</page>\n\n<page>\n---\ntitle: 2023-04-21 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-21-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-21-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Remove some rare false positives. |\n| ...d3fb9259 | HTTP requests from known botnet (signature #51). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-04-27 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-27-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-04-27-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...f2494447 | HTTP requests attempting to bypass the cache. | N/A | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-05-02 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-02-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-02-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Improve our capability to efficiently identify some attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-05-15 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-15-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-15-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1fc1e601 | HTTP requests with unusual HTTP headers or URI path (signature #31). | N/A | block | |\n| ...863134d5 | HTTP requests from known bad user agents. | block | block | Widen detection scope. |\n| ...bb3cefd0 | HTTP requests with unusual HTTP headers or URI path (signature #53). | N/A | block | |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Extend the rule to catch attacks across multiple subdomains. |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Expand the filter to catch more attacks. |\n| ...f2494447 | HTTP requests attempting to bypass the cache. | ddos\\_dynamic | ddos\\_dynamic | Make rule more accurate when blocking attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-05-16 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-16-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-16-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...311e414e | HTTP requests with unusual HTTP headers or URI path (signature #33). | N/A | ddos\\_dynamic | Stop attacks from an active botnet. |\n| ...ad16b3fb | HTTP requests from known botnet (signature #54). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-05-22  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-22/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-22/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...4a95ba67 | HTTP requests with unusual HTTP headers or URI path (signature #32). | log | log | Improve the rule accuracy. |\n| ...fd5045ff | HTTP requests from known botnet (signature #55). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-05-26  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-26/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-05-26/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...4a95ba67 | HTTP requests with unusual HTTP headers or URI path (signature #32). | log | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-05 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-05-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-05-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6831bff1 | HTTP requests with unusual HTTP headers or URI path (signature #35). | N/A | block | Stop attacks from an active botnet. |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-06  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-06/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-06/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6831bff1 | HTTP requests with unusual HTTP headers or URI path (signature #35). | N/A | block | |\n| ...72bb7bfd | HTTP requests with unusual HTTP headers or URI path (signature #34). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-14 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-14-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-14-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6fa59d23 | HTTP requests that are very likely coming from bots. | ddos\\_dynamic | ddos\\_dynamic | Expand the filter to match more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-16  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-16/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-16/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...21e99dcf | HTTP requests from known botnet (signature #58). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-19  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-19/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-19/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...de244156 | HTTP requests from known botnet (signature #59). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-06-28  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-28/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-06-28/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...95f78bf0 | HTTP requests trying to impersonate browsers (pattern #2). | log | ddos\\_dynamic | |\n| ...c86adf25 | HTTP requests with unusual HTTP headers or URI path (signature #38). Only for zones on PRO plan and above. | log | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-06  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-06/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-06/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | log | managed\\_challenge | |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-07  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-07/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-07/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | log | managed\\_challenge | |\n| ...83dc0d58 | HTTP requests from known botnet (signature #60). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-12 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-12-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-12-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...0d5872e3 | HTTP requests with unusual HTTP headers or URI path (signature #40). | N/A | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-17  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-17/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-17/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6831bff1 | HTTP requests with unusual HTTP headers or URI path (signature #35). | ddos\\_dynamic | block | Improve the filter to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-07-31  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-31/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-07-31/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...9aec0913 | HTTP requests from known botnet (signature #52). | block | block | Expose existing read-only filter publicly as it might cause false positives in rare cases. |\n| ...c5f479f0 | HTTP requests from known botnet (signature #62). | N/A | block | |\n| ...d0e36f9c | HTTP requests from known botnet (signature #63). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-11 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-11-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-11-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1de9523e | HTTP requests with unusual HTTP headers or URI path (signature #41). | N/A | block | |\n| ...22807318 | HTTP requests from known botnets. | managed\\_challenge | ddos\\_dynamic | |\n| ...aa03a345 | HTTP requests from known botnet (signature #68). | N/A | block | |\n| ...efca86eb | HTTP requests from known botnet (signature #66). | N/A | block | |\n| ...f93fb5d6 | HTTP requests from known botnet (signature #67). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-14  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-14/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-14/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | managed\\_challenge | Expand the filter to catch more attacks. |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Expand the filter to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-16 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-16-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-16-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...9721fd20 | HTTP requests trying to impersonate browsers (pattern #3). | N/A | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-25 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-25-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-25-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...20c5afb5 | HTTP requests with unusual HTTP headers or URI path (signature #36). | block | block | This rule was previously readonly, but can cause false positives in rare cases. It is now possible to override it. |\n| ...cb26e2e2 | HTTP requests from known botnet (signature #69). | N/A | block | |\n| ...ebff5ef1 | HTTP requests with unusual HTTP headers or URI path (signature #43). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-29 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-29-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-29-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | managed\\_challenge | ddos\\_dynamic | |\n| ...3fe55678 | HTTP requests with unusual HTTP headers or URI path (signature #44). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-08-30 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-30-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-08-30-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | ddos\\_dynamic | |\n| ...46082508 | HTTP requests with unusual HTTP headers or URI path (signature #45). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-09-05 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-05-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-05-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | ddos\\_dynamic | Expand filter to catch attacks more comprehensively. |\n| ...4346874d | HTTP requests with unusual HTTP headers or URI path (signature #46). | N/A | block | |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | N/A | block | Expand filter to catch more attacks. It is now configurable. |\n\n</page>\n\n<page>\n---\ntitle: 2023-09-21 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-21-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-21-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1d73128d | HTTP requests from known botnet (signature #56). | block | block | Make the rule customizable as it might cause false positive in rare cases. |\n| ...4a95ba67 | HTTP requests with unusual HTTP headers or URI path (signature #32). | ddos\\_dynamic | ddos\\_dynamic | Expand the scope of the rule to catch more attacks. |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | block | block | Update the rule to remove some rare false positives. |\n\n</page>\n\n<page>\n---\ntitle: 2023-09-24 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-24-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-09-24-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...0fb54442 | HTTP requests with unusual HTTP headers or URI path (signature #49). | N/A | block | |\n| ...3dd5f188 | HTTP requests from known botnet (signature #71). | N/A | block | |\n| ...97003a74 | HTTP requests with unusual HTTP headers or URI path (signature #17). | block | block | Expand rule to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2023-10-09 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-09-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-09-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...02bbdce1 | HTTP requests with unusual HTTP headers or URI path (signature #47). | N/A | block | |\n| ...493cb8a8 | HTTP requests with unusual HTTP headers or URI path (signature #52). | N/A | block | |\n| ...5c344623 | HTTP requests from uncommon clients | N/A | block | |\n| ...6363bb1b | HTTP requests with unusual HTTP headers or URI path (signature #48). | N/A | block | |\n| ...c1fbd175 | HTTP requests trying to impersonate browsers (pattern #4). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-10-11  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-11/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-11/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...35675e08 | HTTP requests with unusual HTTP headers or URI path (signature #24). | block | block | This rule can cause rare false positives with custom apps sending invalid headers. |\n\n</page>\n\n<page>\n---\ntitle: 2023-10-19  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-19/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-10-19/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...61bc58d5 | HTTP requests with unusual HTTP headers or URI path (signature #55). | ddos\\_dynamic | ddos\\_dynamic | Requests will be challenged by default, larger attacks are blocked. |\n\n</page>\n\n<page>\n---\ntitle: 2023-11-10 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-10-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-10-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...7d0f1e5f | HTTP requests from known botnet (signature #72). | N/A | block | |\n| ...94547a95 | HTTP requests with unusual HTTP headers or URI path (signature #59). | N/A | ddos\\_dynamic | |\n| ...e269dfd6 | HTTP requests with unusual HTTP headers or URI path (signature #56). | log | block | Enable filter early to mitigate widespread impact. |\n| ...f35a42a0 | HTTP requests with unusual HTTP headers or URI path (signature #57). | log | block | Enable filter early to mitigate widespread impact. |\n\n</page>\n\n<page>\n---\ntitle: 2023-11-13 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-13-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-13-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | ddos\\_dynamic | Improve this filter to catch more attacks. |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | block | block | |\n| ...7c7a2f25 | HTTP requests from known botnet (signature #74). | N/A | block | |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | |\n\n</page>\n\n<page>\n---\ntitle: 2023-11-22  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-22/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-22/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...254da96a | HTTP requests with unusual HTTP headers or URI path (signature #58). | log | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-11-29  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-29/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-11-29/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...8ed59b32 | HTTP requests with unusual HTTP headers or URI path (signature #61). | ddos\\_dynamic | ddos\\_dynamic | Rename rule to avoid confusion. |\n| ...61e8d513 | Global L7 WordPress attack mitigations (Deprecated) | ddos\\_dynamic | ddos\\_dynamic | Mark rule as deprecated. |\n\n</page>\n\n<page>\n---\ntitle: 2023-12-08 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-08-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-08-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | block | block | Updated the rule to avoid false positives in some rare circumstances. |\n| ...e7a37252 | HTTP requests from known botnet (signature #75). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2023-12-14 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-14-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-14-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | block | block | Tweak the rule to avoid false positives in some rare cases. |\n\n</page>\n\n<page>\n---\ntitle: 2023-12-19 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-19-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2023-12-19-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1fc1e601 | HTTP requests with unusual HTTP headers or URI path (signature #31). | block | block | Add more characteristics to the unusual HTTP headers or URI path. |\n| ...22807318 | HTTP requests from known botnets. | log | ddos\\_dynamic | Extend the rule to catch more attacks. |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Change the rule to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2024-01-05  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-05/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-05/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...2de94fb2 | HTTP requests with unusual HTTP headers or URI path (signature #3). | block | block | Fine-tune the characteristics of the unusual requests. |\n| ...177059f1 | HTTP requests from known botnet (signature #31). | block | N/A | Removed due to false positives. |\n| ...6fe7a312 | HTTP requests from known botnet (signature #70). | block | N/A | Removed due to false positives. |\n| ...82c0ed5f | HTTP requests from known botnet (signature #77). | N/A | block | |\n| ...e4f3ea4d | HTTP requests from known botnet (signature #76). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2024-01-23  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-23/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-23/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1fc1e601 | HTTP requests with unusual HTTP headers or URI path (signature #31). | block | block | Add more characteristics to the unusual HTTP headers or URI path. |\n| ...2de94fb2 | HTTP requests with unusual HTTP headers or URI path (signature #3). | ddos\\_dynamic | block | Expand rule scope to catch more attacks. |\n| ...2f8d9a4f | HTTP requests from known botnet (signature #78). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2024-01-25  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-25/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-25/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1fc1e601 | HTTP requests with unusual HTTP headers or URI path (signature #31). | block | block | Add more characteristics to the unusual HTTP headers or URI path. |\n\n</page>\n\n<page>\n---\ntitle: 2024-01-26 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-26-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-01-26-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...3ad719cd | HTTP requests from known botnet (signature #79). | N/A | ddos\\_dynamic | |\n| ...61bc58d5 | HTTP requests with unusual HTTP headers or URI path (signature #55). | managed\\_challenge | managed\\_challenge | Expanded the scope of the rule to catch attacks more consistently. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-05 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-05-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-05-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | ddos\\_dynamic | Extend the rule to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-06 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-06-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-06-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...1fc1e601 | HTTP requests with unusual HTTP headers or URI path (signature #31). | block | block | Modify characteristics of the unusual HTTP headers or URI path. |\n| ...3a679c52 | Requests coming from known bad sources. | N/A | ddos\\_dynamic | |\n| ...3ad719cd | HTTP requests from known botnet (signature #79). | ddos\\_dynamic | ddos\\_dynamic | Expand the scope of the rule to match more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-08 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-08-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-08-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...3a679c52 | Requests coming from known bad sources. | ddos\\_dynamic | managed\\_challenge | Expand the rule to mitigate on all zones. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-12  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-12/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-12/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...c47bdca6 | HTTP requests with unusual HTTP headers or URI path (signature #62). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-19  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-19/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-19/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...0fbfd5ae | HTTP requests from known botnet (signature #32). | block | ddos\\_dynamic | |\n| ...22807318 | HTTP requests from known botnets. | ddos\\_dynamic | ddos\\_dynamic | Expand rule logic to catch more attacks. |\n| ...3ad719cd | HTTP requests from known botnet (signature #79). | ddos\\_dynamic | ddos\\_dynamic | Expand the rule scope to catch more attacks. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-26 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-26-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-26-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...6831bff1 | HTTP requests with unusual HTTP headers or URI path (signature #35). | block | block | Extend the rule to catch attacks more comprehensively. |\n| ...e269dfd6 | HTTP requests with unusual HTTP headers or URI path (signature #56). | block | block | Extend the rule to catch attacks more comprehensively. |\n\n</page>\n\n<page>\n---\ntitle: 2024-02-27  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-27/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-02-27/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...0c9175b8 | HTTP requests from known botnet (signature #47). | block | N/A | Rule removed due to inactivity. |\n| ...0fb54442 | HTTP requests with unusual HTTP headers or URI path (signature #49). | block | N/A | Rule removed due to inactivity. |\n| ...1b60260f | HTTP requests from known botnet (signature #45). | block | N/A | Rule removed due to inactivity. |\n| ...21e99dcf | HTTP requests from known botnet (signature #58). | block | N/A | Rule removed due to inactivity. |\n| ...3f7952da | HTTP requests from known botnet (signature #21). | block | N/A | Rule removed due to inactivity. |\n| ...5a158253 | HTTP requests from known botnet (signature #27). | block | N/A | Rule removed due to inactivity. |\n| ...5f1469cb | HTTP requests with unusual HTTP headers or URI path (signature #28). | block | N/A | Rule removed due to inactivity. |\n| ...71cb9bea | HTTP requests from known botnet (signature #39). | block | N/A | Rule removed due to inactivity. |\n| ...72d115bd | HTTP requests from known botnet (signature #23). | block | N/A | Rule removed due to inactivity. |\n| ...8586375f | HTTP requests with unusual HTTP headers or URI path (signature #22). | block | N/A | Rule removed due to inactivity. |\n| ...8857b788 | HTTP requests from known botnet (signature #30). | block | N/A | Rule removed due to inactivity. |\n| ...8bf63869 | HTTP requests from known botnet (signature #50). | block | N/A | Rule removed due to inactivity. |\n| ...9630955e | HTTP requests from known botnet (signature #64). | block | N/A | Rule removed due to inactivity. |\n| ...9641efe0 | HTTP requests with unusual HTTP headers or URI path (signature #29). | block | N/A | Rule removed due to inactivity. |\n| ...aa03a345 | HTTP requests from known botnet (signature #68). | block | N/A | Rule removed due to inactivity. |\n| ...b60b2bc0 | HTTP requests from known botnet (signature #28). | block | N/A | Rule removed due to inactivity. |\n| ...bbf0073e | HTTP requests from known botnet (signature #25). | block | N/A | Rule removed due to inactivity. |\n| ...c5f479f0 | HTTP requests from known botnet (signature #62). | block | N/A | Rule removed due to inactivity. |\n| ...c92eba7c | HTTP requests from known botnet (signature #65). | block | N/A | Rule removed due to inactivity. |\n| ...dea7a346 | HTTP requests from known botnet (signature #35). | block | N/A | Rule removed due to inactivity. |\n| ...e4fe8e55 | Adaptive DDoS Protection based on User-Agents (Available only to Enterprise zones with Advanced DDoS service). | ddos\\_dynamic | ddos\\_dynamic | Mitigate attacks by default instead of only logging. |\n| ...ea99fbb6 | HTTP requests from known botnet (signature #46). | block | N/A | Rule removed due to inactivity. |\n| ...f6120981 | HTTP requests from known botnet (signature #20). | block | N/A | Rule removed due to inactivity. |\n| ...f9da654a | HTTP requests from known botnet (signature #26). | block | N/A | Rule removed due to inactivity. |\n| ...fd5045ff | HTTP requests from known botnet (signature #55). | block | N/A | Rule removed due to inactivity. |\n| ...fd551e2b | HTTP requests from known botnet (signature #41). | block | N/A | Rule removed due to inactivity. |\n\n</page>\n\n<page>\n---\ntitle: 2024-04-02  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-02/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-02/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...d2f294d7 | HTTP requests trying to impersonate browsers. | ddos\\_dynamic | ddos\\_dynamic | Update the rule to match to block attacks more consistently. |\n\n</page>\n\n<page>\n---\ntitle: 2024-04-04 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-04-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-04-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| ...177059f1 | HTTP requests from known botnet (signature #31). | log | N/A | |\n| ...7b231fb2 | HTTP requests from known botnet (signature #81). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2024-04-16 - Emergency  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-16-emergency/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-16-emergency/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| 767bd3e188fc46f79827e95e05ad9070 | HTTP requests with unusual HTTP headers or URI path (signature #64). | N/A | block | |\n| 8655dc40759f43b9878b775d890b8f4e | HTTP requests with unusual HTTP headers or URI path (signature #65). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: 2024-04-19  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-19/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/2024-04-19/index.md\n---\n\n| Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - |\n| 4dc034ab293145e4b0b27e20154b29a0 | HTTP requests with unusual HTTP headers or URI path (signature #66). | N/A | block | |\n\n</page>\n\n<page>\n---\ntitle: Scheduled changes  HTTP DDoS  Cloudflare DDoS Protection docs\nlastUpdated: 2025-02-18T19:39:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/change-log/http/scheduled-changes/\n  md: https://developers.cloudflare.com/ddos-protection/change-log/http/scheduled-changes/index.md\n---\n\n| Announcement Date | Change Date | Rule ID | Description | Previous Action | New Action | Notes |\n| - | - | - | - | - | - | - |\n| N/A | N/A | N/A | N/A | N/A | N/A | N/A |\n\n</page>\n\n<page>\n---\ntitle: Network DDoS Attack Protection override rules  Cloudflare DDoS Protection docs\ndescription: When Cloudflare's DDoS Protection systems detect an attack, an\n  ephemeral mitigation rule is created and installed in-line to mitigate the\n  attack. A mitigation rule is generated based on the logic of the DDoS\n  Protection managed ruleset. Each mitigation rule is generated from a single\n  managed rule.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/index.md\n---\n\nWhen Cloudflare's DDoS Protection systems detect an attack, an ephemeral mitigation rule is created and installed in-line to mitigate the attack. A mitigation rule is generated based on the logic of the DDoS Protection managed ruleset. Each mitigation rule is generated from a single managed rule.\n\nAll mitigations and its associated managed rules are evaluated in order by the DDoS systems one by one. Cloudflare will go through all of the rule overrides defined in the ruleset overrides until one matches the managed rule, and apply the action and stop at that point. Otherwise, the evaluation will continue in order until a rule matches.\n\nYou can create only one ruleset override that can contain one or multiple rule overrides.\n\nNote\n\nEnterprise customers with the [Advanced DDoS Protection](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/) add-on can create up to 10 ruleset overrides.\n\nA rule override instructs the DDoS system on the action it should take against the attack according to its matching managed rule.\n\nHowever, within a rule override, specificity matters and the DDoS system will choose the more specific configuration. A rule override takes precedence over the ruleset override.\n\n## Example\n\nA DDoS managed ruleset contains the following managed rules:\n\n* **Managed rule 1**\n* **Managed rule 2**\n* **Managed rule 3**\n\nThe following ruleset overrides have been configured:\n\n* **Ruleset override A**\n  * **Managed rule 1** is set to `block`\n\n* **Ruleset override B**\n\n  * The action of the entire ruleset (or *all managed rules*) is set to `Managed Challenge`\n  * **Managed rule 1** is set to `log`\n  * **Managed rule 2** is set to `log`\n\n* **Ruleset override C**\n  * **Managed rule 3** is set to `log`\n\n### Use case\n\nA DDoS attack was detected on **managed rules 1**, **2**, and **3**, and has generated a mitigation rule.\n\n* Since **managed rule 1** matches **ruleset override A**, Cloudflare will `block` the attacks and not proceed with the rest of the rules.\n\n* **Managed rule 2** does not match **ruleset override A**, so Cloudflare proceeds to **ruleset override B**.\\\n  **Ruleset override B** matches both all managed rules and **managed rule 2**, but specificity takes precedence. It does not `challenge` and instead proceeds with `log` since it matches the most specific managed rule.\n\n* **Managed rule 3** does not match **ruleset override A**, so Cloudflare proceeds to **rule override B**. Since **ruleset override B** sets *all managed rules* to `challenge`, then Cloudflare does not proceed to **ruleset override C**.\n\nAn additional dimension to take into account is Cloudflares DDoS systems will apply a given rule override only if its conditions are met  which includes the Sensitivity level. So, while it needs to match and modify the correct managed rule (or everything in the case of all managed rules above), it also has to meet the specified Sensitivity level of the rule.\n\n* **Rule override A**\n\n  * *All managed rules* are set to `challenge` at low sensitivity\n\n* **Rule override B**\n\n  * **Managed rule 1** is set to `log` at default sensitivity\n\nYou receive a small attack below the threshold for low sensitivity, but above the threshold for high sensitivity on **managed rule 1**.\n\n* **Rule override A** does not meet the low sensitivity threshold. Therefore, we do not match the override and do not mitigate the attack, but proceed to evaluate the next managed rule in case the rule override instructs DoS to mitigate.\n* **Rule override B** sets `log` at default visibility, which matches the condition. So, the defined action is applied and attack traffic is logged.\n\n</page>\n\n<page>\n---\ntitle: Network-layer DDoS Attack Protection parameters  Cloudflare DDoS\n  Protection docs\ndescription: Define overrides for the Network-layer DDoS Attack Protection\n  managed ruleset to change the action applied to a given attack or modify the\n  sensitivity level of the detection mechanism. You can define overrides in the\n  Cloudflare dashboard or define overrides via Rulesets API.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/index.md\n---\n\nDefine overrides for the Network-layer DDoS Attack Protection managed ruleset to change the action applied to a given attack or modify the sensitivity level of the detection mechanism. You can [define overrides in the Cloudflare dashboard](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-dashboard/) or [define overrides via Rulesets API](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-api/).\n\nThe available parameters are the following:\n\n* Action\n* Sensitivity Level\n\n## Action\n\nAPI property name: `\"action\"`.\n\nThe action performed for packets that match specific rules of Cloudflare's DDoS mitigation services. The available actions are:\n\n* **Log**\n\n  * API value: `\"log\"`.\n\n  * Only available on Enterprise plans. Logs requests that match the expression of a rule detecting network layer DDoS attacks. Recommended for validating a rule before committing to a more severe action.\n\n    Refer to the [Analytics documentation](https://developers.cloudflare.com/analytics/network-analytics/configure/displayed-data/#view-logged-or-monitored-traffic) for more information on how to view logged or monitored traffic.\n\n* **Block**\n\n  * API value: `\"block\"`.\n  * Blocks IP packets that match the rule expression given the sensitivity levels.\n\n* **DDoS Dynamic**\n\n  * API value: *N/A* (internal rule action that you cannot use in overrides).\n  * Performs a specific action according to a set of internal guidelines defined by Cloudflare. The executed action can be *Block* or an undisclosed mitigation action.\n\n## Sensitivity Level\n\nAPI property name: `\"sensitivity_level\"`.\n\nDefines how sensitive a rule is. Affects the thresholds used to determine if an attack should be mitigated. A higher sensitivity level means having a lower threshold, while a lower sensitivity level means having a higher threshold.\n\nThe available sensitivity levels are:\n\n| UI value | API value |\n| - | - |\n| *High* | `\"default\"` |\n| *Medium* | `\"medium\"` |\n| *Low* | `\"low\"` |\n| *Essentially Off* | `\"eoff\"` |\n\nThe default sensitivity level is *High*.\n\nIn most cases, when you select the *Essentially Off* sensitivity level the rule will not trigger for any of the selected actions, including *Log*. However, if the attack is extremely large, Cloudflare's protection systems will still trigger the rule's mitigation action to protect Cloudflare's network.\n\n*Essentially Off* means that we have set an exceptionally low sensitivity level so in most cases traffic will not be mitigated for you. However, attack traffic will be mitigated at exceptional levels to ensure the safety and stability of the Cloudflare network.\n\n**Log** means that requests will not be mitigated but only logged and shown on the dashboard. However, attack traffic will be mitigated at exceptional levels to ensure the safety and stability of the Cloudflare network.\n\n</page>\n\n<page>\n---\ntitle: Rule categories  Network-layer DDoS  Cloudflare DDoS Protection docs\ndescription: \"The main categories (or tags) of Network-layer DDoS Attack\n  Protection managed rules are the following:\"\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/rule-categories/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/rule-categories/index.md\n---\n\nThe main categories (or tags) of Network-layer DDoS Attack Protection managed rules are the following:\n\n| Name | Description |\n| - | - |\n| `gre` | Rules for DDoS attacks over Generic Routing Encapsulation (GRE) that usually target GRE endpoints. |\n| `esp` | Rules for DDoS attacks related to the Encapsulating Security Payload (ESP) protocol, which is part of the IPsec secure network protocol suite. |\n| `advanced` | Rules related to features available to Enterprise customers, such as [Adaptive DDoS Protection](https://developers.cloudflare.com/ddos-protection/managed-rulesets/adaptive-protection/). |\n| `generic` | Rules for detecting and mitigating floods of packets. These rules are useful for mitigating attacks that have no known signatures, but they may also trigger on unusually high volumes of legitimate traffic. To reduce the risk of false positives, their packet per second (pps) activation threshold is higher. These rules rate-limit traffic by default, but you can override them to block traffic if necessary. |\n| `read-only` | Highly targeted rules for mitigating DDoS attacks with a high confidence rate. These rules are read-only  you cannot override their sensitivity level or action. |\n| `test` | Rules used for testing the detection, mitigation, and alerting capabilities of Cloudflare's DDoS protection products. |\n\nThere are other rule categories based on the attack vector/protocol, such as `dns`, `quic`, and `sip`. The categories list is dynamic and may change over time.\n\n</page>\n\n<page>\n---\ntitle: HTTP DDoS Attack Protection override rules  Cloudflare DDoS Protection docs\ndescription: When Cloudflare's DDoS Protection systems detect an attack, an\n  ephemeral mitigation rule is created and installed in-line to mitigate the\n  attack. A mitigation rule is generated based on the logic of the DDoS\n  Protection managed ruleset. Each mitigation rule is generated from a single\n  managed rule.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/index.md\n---\n\nWhen Cloudflare's DDoS Protection systems detect an attack, an ephemeral mitigation rule is created and installed in-line to mitigate the attack. A mitigation rule is generated based on the logic of the DDoS Protection managed ruleset. Each mitigation rule is generated from a single managed rule.\n\nAll mitigations and its associated managed rules are evaluated in order by the DDoS systems one by one. Cloudflare will go through all of the rule overrides defined in the ruleset overrides until one matches the managed rule, and apply the action and stop at that point. Otherwise, the evaluation will continue in order until a rule matches.\n\nYou can create only one ruleset override that can contain one or multiple rule overrides.\n\nNote\n\nEnterprise customers with the [Advanced DDoS Protection](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/overview/) add-on can create up to 10 ruleset overrides.\n\nA rule override instructs the DDoS system on the action it should take against the attack according to its matching managed rule.\n\nHowever, within a rule override, specificity matters and the DDoS system will choose the more specific configuration. A rule override takes precedence over the ruleset override.\n\n## Example\n\nA DDoS managed ruleset contains the following managed rules:\n\n* **Managed rule 1**\n* **Managed rule 2**\n* **Managed rule 3**\n\nThe following ruleset overrides have been configured:\n\n* **Ruleset override A**\n  * **Managed rule 1** is set to `block`\n\n* **Ruleset override B**\n\n  * The action of the entire ruleset (or *all managed rules*) is set to `Managed Challenge`\n  * **Managed rule 1** is set to `log`\n  * **Managed rule 2** is set to `log`\n\n* **Ruleset override C**\n  * **Managed rule 3** is set to `log`\n\n### Use case\n\nA DDoS attack was detected on **managed rules 1**, **2**, and **3**, and has generated a mitigation rule.\n\n* Since **managed rule 1** matches **ruleset override A**, Cloudflare will `block` the attacks and not proceed with the rest of the rules.\n\n* **Managed rule 2** does not match **ruleset override A**, so Cloudflare proceeds to **ruleset override B**.\\\n  **Ruleset override B** matches both all managed rules and **managed rule 2**, but specificity takes precedence. It does not `challenge` and instead proceeds with `log` since it matches the most specific managed rule.\n\n* **Managed rule 3** does not match **ruleset override A**, so Cloudflare proceeds to **rule override B**. Since **ruleset override B** sets *all managed rules* to `challenge`, then Cloudflare does not proceed to **ruleset override C**.\n\nAn additional dimension to take into account is Cloudflares DDoS systems will apply a given rule override only if its conditions are met  which includes the Sensitivity level. So, while it needs to match and modify the correct managed rule (or everything in the case of all managed rules above), it also has to meet the specified Sensitivity level of the rule.\n\n* **Rule override A**\n\n  * *All managed rules* are set to `challenge` at low sensitivity\n\n* **Rule override B**\n\n  * **Managed rule 1** is set to `log` at default sensitivity\n\nYou receive a small attack below the threshold for low sensitivity, but above the threshold for high sensitivity on **managed rule 1**.\n\n* **Rule override A** does not meet the low sensitivity threshold. Therefore, we do not match the override and do not mitigate the attack, but proceed to evaluate the next managed rule in case the rule override instructs DoS to mitigate.\n* **Rule override B** sets `log` at default visibility, which matches the condition. So, the defined action is applied and attack traffic is logged.\n\n</page>\n\n<page>\n---\ntitle: HTTP DDoS Attack Protection parameters  Cloudflare DDoS Protection docs\ndescription: Configure the HTTP DDoS Attack Protection managed ruleset to change\n  the action applied to a given attack or modify the sensitivity level of the\n  detection mechanism. You can configure the managed ruleset in the Cloudflare\n  dashboard or define overrides via Rulesets API.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/index.md\n---\n\nConfigure the HTTP DDoS Attack Protection managed ruleset to change the action applied to a given attack or modify the sensitivity level of the detection mechanism. You can [configure the managed ruleset in the Cloudflare dashboard](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-dashboard/) or [define overrides via Rulesets API](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-api/).\n\nThe available parameters are the following:\n\n* [Action](#action)\n* [Sensitivity Level](#sensitivity-level)\n\n## Action\n\nAPI property name: `\"action\"`.\n\nThe action that will be performed for requests that match specific rules of Cloudflare's DDoS mitigation services. The available actions are:\n\n* **Block**\n\n  * API value: `\"block\"`.\n  * Blocks HTTP requests that match the rule expression.\n\n* **Managed Challenge**\n\n  * API value: `\"managed_challenge\"`.\n  * [Managed Challenges](https://developers.cloudflare.com/cloudflare-challenges/challenge-types/challenge-pages/#managed-challenge-recommended) help reduce the lifetimes of human time spent solving Captchas across the Internet. Depending on the characteristics of a request, Cloudflare will dynamically choose the appropriate type of challenge based on specific criteria.\n\n* **Interactive Challenge**\n\n  * API value: `\"challenge\"`.\n  * Presents an interactive challenge to the clients making HTTP requests that match a rule expression.\n\n* **Log**\n\n  * API value: `\"log\"`.\n  * Only available on Enterprise plans with the Advanced DDoS Protection subscription. Logs requests that match the expression of a rule detecting HTTP DDoS attacks. Recommended for validating a rule before committing to a more severe action.\n\n* **Connection Close**\n\n  * API value: *N/A* (internal rule action that you cannot use in overrides).\n  * The client is instructed to establish a new connection (by disabling `keep-alive`) instead of reusing the existing connection. Existing requests are not affected.\n\n* **Force Connection Close**\n\n  * API value: *N/A* (internal rule action that you cannot use in overrides).\n\n  * Closes ongoing HTTP connections. This action does not block a request, but it forces the client to reconnect. For HTTP/2 and HTTP/3 connections, the connection will be closed even if it breaks other requests running on the same connection.\n\n  * The performed action depends on the HTTP version:\n\n    * HTTP/1: set the [`Connection` header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Connection#directives) to `close`.\n    * HTTP/2: send a [`GOAWAY` frame](https://datatracker.ietf.org/doc/html/rfc7540#section-6.8) to the client.\n\n* **DDoS Dynamic**\n\n  * API value: *N/A* (internal rule action that you cannot use in overrides).\n  * Performs a specific action according to a set of internal guidelines defined by Cloudflare. The executed action can be one of the above or an undisclosed mitigation action.\n\n## Sensitivity Level\n\nAPI property name: `\"sensitivity_level\"`.\n\nDefines how sensitive a rule is. Affects the thresholds used to determine if an attack should be mitigated. A higher sensitivity level means having a lower threshold, while a lower sensitivity level means having a higher threshold.\n\nThe available sensitivity levels are:\n\n| UI value | API value |\n| - | - |\n| *High* | `\"default\"` |\n| *Medium* | `\"medium\"` |\n| *Low* | `\"low\"` |\n| *Essentially Off* | `\"eoff\"` |\n\nThe default sensitivity level is *High*.\n\nIn most cases, when you select the *Essentially Off* sensitivity level the rule will not trigger for any of the selected actions, including *Log*. However, if the attack is extremely large, Cloudflare's protection systems will still trigger the rule's mitigation action to protect Cloudflare's network.\n\n*Essentially Off* means that we have set an exceptionally low sensitivity level so in most cases traffic will not be mitigated for you. However, attack traffic will be mitigated at exceptional levels to ensure the safety and stability of the Cloudflare network.\n\n**Log** means that requests will not be mitigated but only logged and shown on the dashboard. However, attack traffic will be mitigated at exceptional levels to ensure the safety and stability of the Cloudflare network.\n\n</page>\n\n<page>\n---\ntitle: Rule categories  HTTP DDoS  Cloudflare DDoS Protection docs\ndescription: \"The main categories (or tags) of HTTP DDoS Attack Protection\n  managed rules are the following:\"\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/rule-categories/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/rule-categories/index.md\n---\n\nThe main categories (or tags) of HTTP DDoS Attack Protection managed rules are the following:\n\n| Name | Description |\n| - | - |\n| `botnets` | Rules for requests from known botnets, with very high accuracy and low risk of false positives. It is recommended that you keep these rules enabled. |\n| `unusual-requests` | Rules for requests with suspicious characteristics that are not usually seen in legitimate traffic. |\n| `advanced` | Rules related to features available to Advanced DDoS Protection customers, such as [Adaptive DDoS Protection](https://developers.cloudflare.com/ddos-protection/managed-rulesets/adaptive-protection/). |\n| `generic` | Rules for detecting and mitigating floods of requests. These rules are useful for mitigating attacks that have no known signatures, but they may also trigger on unusually high volumes of legitimate traffic. To reduce the risk of false positives, their request per second (rps) activation threshold is higher. These rules either rate-limit or challenge traffic by default, but you can override them to block traffic if necessary. |\n| `read-only` | Highly targeted rules for mitigating DDoS attacks with a high confidence rate. These rules are read-only  you cannot override their sensitivity level or action. |\n| `test` | Rules used for testing the detection, mitigation, and alerting capabilities of Cloudflare's DDoS protection products. |\n\n</page>\n\n<page>\n---\ntitle: About random prefix attacks - DNS Firewall  Cloudflare DNS docs\ndescription: Learn about random prefix attacks. As part of DNS Firewall,\n  Cloudflare can protect your upstream authoritative nameservers from these\n  attacks.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/about/\n  md: https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/about/index.md\n---\n\nRandom prefix attacks are when someone sends a lot of traffic to subdomains that are highly unlikely to exist (`12345.example.com`, `abcdefg.example.com`), but are still associated with your main domain (`example.com`).\n\nUsually, a DNS query to each random subdomain (or prefix) is not repeated, so it cannot be cached by resolvers or any other proxies and always reaches the authoritative nameservers. Rate limiting or blocking queries based on source IP can introduce a high amount of false positives, since random prefix attacks commonly are conducted via public resolvers. This makes these attacks particularly effective and hard to mitigate.\n\n\n\n## Attack characteristics\n\n### Queries for nonexistent domains\n\nIf the request only involved nonexistent domains, the `NXDOMAIN` errors would only be served by the top-level domain (TLD) nameservers for `com.`. This means that the queries never reach the authoritative nameservers.",
      "language": "unknown"
    },
    {
      "code": "### Queries for nonexistent subdomains\n\nThese attacks are successful because they target subdomains, which require a response from a domain's authoritative nameservers.",
      "language": "unknown"
    },
    {
      "code": "With an attack against a subdomain of an existing domain, the resolver is forced to fully resolve it against the authoritative nameservers since these random subdomains are likely not cached by the resolver or any other proxy. If an attacker sends enough of these queries, and the authoritative nameservers cannot handle the query load, it will become unresponsive or even fall over, taking all zones it is hosting down, not just the attacked zone.\n\nThis attack is difficult to mitigate for a few reasons. From the perspective of the authoritative nameservers, the attacker appears to be Cloudflare (`1.1.1.1`) since that is the source of the queries. Blocking Cloudflare is not an option since that will block legitimate traffic.\n\n## Solution\n\nWhen you [enable random prefix attack mitigations](https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/setup/), Cloudflare monitors incoming queries for potential random prefix attacks.\n\nWhen we detect an attack, we will temporarily stop querying your upstream nameservers for subdomains, sub-subdomains, and more. Cloudflare will then respond with cached responses (if their TTL has not yet expired).\n\n</page>\n\n<page>\n---\ntitle: Protect against random prefix attacks  Cloudflare DNS docs\ndescription: \"In order to enable automatic mitigation of random prefix attacks:\"\nlastUpdated: 2025-05-12T14:31:11.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/setup/\n  md: https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/setup/index.md\n---\n\nIn order to enable automatic mitigation of [random prefix attacks](https://developers.cloudflare.com/dns/dns-firewall/random-prefix-attacks/about/):\n\n1. Set up [DNS Firewall](https://developers.cloudflare.com/dns/dns-firewall/setup/).\n\n2. Send a [`PATCH` request](https://developers.cloudflare.com/api/resources/dns_firewall/methods/edit/) to update your DNS Firewall cluster.\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `DNS Firewall Write`",
      "language": "unknown"
    },
    {
      "code": "Once you receive a `200` success response from the API, queries identified as being part of a random prefix attack will receive a `REFUSED` response.\n\nNote\n\nIf you do not specify otherwise in your API call, Cloudflare automatically sets the `\"only_when_upstream_unhealthy\"` parameter to true, which means that Cloudflare will only mitigate attacks when we detect that the upstream is unresponsive (possibly as a result of an attack). This setting can also be changed via the API, using a request similar to the ones shown above.\n\n</page>\n\n<page>\n---\ntitle: About multi-signer DNSSEC  Cloudflare DNS docs\ndescription: Multi-signer DNSSEC consists of two models that allow different\n  authoritative DNS providers to serve the same zone and have DNSSEC enabled at\n  the same time.\nlastUpdated: 2024-09-20T08:42:16.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/about/\n  md: https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/about/index.md\n---\n\nMulti-signer DNSSEC consists of two models that allow different authoritative DNS providers to serve the same zone and have DNSSEC enabled at the same time.\n\nThis means better compatibility with DNS features that require live-signing of DNS records (at query time), and also allows you to [migrate zones to Cloudflare without having to disable DNSSEC](https://developers.cloudflare.com/dns/dnssec/dnssec-active-migration/).\n\nYou can [set up multi-signer DNSSEC](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/) using either one of the models described in [RFC 8901](https://www.rfc-editor.org/rfc/rfc8901.html).\n\n## How it works\n\nNote\n\nThis is a simplified explanation to give you context and clarify what is involved in a [multi-signer DNSSEC setup](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/). For technical details refer to [RFC 8901](https://www.rfc-editor.org/rfc/rfc8901.html). To read more about DNSSEC, refer to [How DNSSEC works](https://www.cloudflare.com/dns/dnssec/how-dnssec-works/).\n\nMulti-signer DNSSEC looks into the chain of trust that is necessary for DNSSEC validation and leverages that to guarantee that validation is completed even when multiple providers are involved.\n\nAn example case where validation would otherwise be an issue is if a resolver has cached a [DNSKEY record set](https://www.cloudflare.com/learning/dns/dns-records/dnskey-ds-records/) from one provider but receives a response signed by another provider.\n\nTo avoid issues in that case, when you set up multi-signer DNSSEC, you adjust:\n\n1. The Zone Signing Keys (ZSK) that your DNS providers have in their DNSKEY record sets.\n2. Who is responsible for the Secure Entry Point (SEP), Key Signing Keys (KSK), and Delegation Signer (DS) record.\n\nWhen these configurations are adjusted in a way that (a) all involved providers have each other's public Zone Signing Keys (ZSK), and that (b) Delegation Signer (DS) records reference the necessary Key Signing Keys (KSK), then live-signing of zones by multiple providers is no longer a problem.\n\n### Model 1\n\nWhereas in both models all providers have each other's Zone Signing Keys (ZSK) added to their DNSKEY record set, in model 1, only one Key Signing Key (KSK) is used to sign such DNSKEY record sets. Management of this KSK and its reference by the DS record (that is, the Secure Entry Point) is the responsibility of the zone owner or only one provider (designated by the zone owner).\n\n### Model 2\n\nIn model 2, on the other hand, each provider uses its own KSK to sign its own DNSKEY record set, and these KSKs are then referenced by the DS record (Secure Entry Point).\n\n</page>\n\n<page>\n---\ntitle: Set up multi-signer DNSSEC  Cloudflare DNS docs\ndescription: This page explains how you can enable multi-signer DNSSEC with\n  Cloudflare, using the model 2 as described in RFC 8901.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/\n  md: https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/index.md\n---\n\nThis page explains how you can enable [multi-signer DNSSEC](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/about/) with Cloudflare, using the [model 2](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/about/#model-2) as described in [RFC 8901](https://www.rfc-editor.org/rfc/rfc8901.html).\n\n## Before you begin\n\nNote that:\n\n* This process requires that your other DNS provider(s) also support multi-signer DNSSEC.\n* Although you can complete a few steps via the dashboard, currently the whole process can only be completed using the API.\n* Enabling **DNSSEC** and **Multi-signer DNSSEC** on the [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) page only replaces the first step in [1. Set up Cloudflare zone](#1-set-up-cloudflare-zone). You still have to follow the rest of this tutorial to complete the setup.\n\n## 1. Set up Cloudflare zone\n\n### Cloudflare as Primary (full setup)\n\nIf you use Cloudflare as a primary DNS provider, meaning that you manage your DNS records in Cloudflare, do the following:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n  2. Select **Enable DNSSEC** and **Confirm**.\n\n  Note\n\n  For the purpose of this tutorial, you will update your registrar with the DS record later, in [Step 3](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/#3-set-up-registrar).\n\n  1. Also enable **Multi-signer DNSSEC** and **Multi-provider DNS**.\n\n  2. Go to the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page and create the following records at your zone apex (meaning you should use `@` in the record **Name** field):\n\n     * A [DNSKEY record](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ds-and-dnskey) with the zone signing key(s) (ZSKs) of your external provider(s).\n     * An [NS record](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ns) with your external provider nameservers.\n\n* API\n\n  1. Use the [Edit DNSSEC Status endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/edit/) to enable DNSSEC and activate multi-signer DNSSEC for your zone. Set `status` to `active` and `dnssec_multi_signer` to `true`, as in the following example.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "1. Add the ZSK(s) of your external provider(s) to Cloudflare by creating a DNSKEY record on your zone.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "1. Add your external provider(s) nameservers as NS records on your zone apex.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "1. Enable the usage of the nameservers you added in the previous step by using the API request below.\n\n  Warning\n\n  This step is required. Without turning on this setting, Cloudflare will ignore any `NS` records created on the zone apex. This means that responses to DNS queries made to the zone apex and requesting `NS` records will only contain Cloudflare nameservers.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Zone DNS Settings Write`\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "### Cloudflare as Secondary\n\nIf you use Cloudflare as a secondary DNS provider, do the following:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n  2. For **DNSSEC with Secondary DNS** select **Live signing**.\n\n  Note\n\n  For the purpose of this tutorial, you will update your registrar with the DS record later, in [Step 3](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/#3-set-up-registrar).\n\n  1. Also enable **Multi-signer DNSSEC**.\n  2. Add the zone signing key(s) (ZSKs) of your external provider(s) to a DNSKEY record at your primary DNS provider. This record should be transferred successfully to Cloudflare.\n  3. Add your external provider(s) nameservers as NS records on your zone apex at your primary DNS provider. These records should be transferred successfully to Cloudflare.\n\n* API\n\n  1. Use the [Edit DNSSEC Status endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/edit/) to enable DNSSEC and activate multi-signer DNSSEC for your zone. Set `status` to `active` and `dnssec_multi_signer` to `true`, as in the following example.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "1. Add the ZSK(s) of your external provider(s) to a DNSKEY record at your primary DNS provider. This record should be transferred successfully to Cloudflare.\n\n  2. Add your external provider(s) nameservers as NS records on your zone apex at your primary DNS provider. These records should be transferred successfully to Cloudflare.\n\n## 2. Set up external provider\n\n1. Get Cloudflare's ZSK using either the API or a query from one of the assigned Cloudflare nameservers.\n\nAPI example:",
      "language": "unknown"
    },
    {
      "code": "Command line query example:",
      "language": "unknown"
    },
    {
      "code": "1. Add Cloudflare's ZSK that you fetched in the previous step to the DNSKEY record set of your external provider(s).\n2. Add Cloudflare's nameservers to the NS record set at your external provider(s).\n\n## 3. Set up registrar\n\n1. Add DS records to your registrar, one for each provider. You can see your Cloudflare DS record on the [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) page, under **DS Record**.\n\n2. Update the nameserver settings at your registrar to include the nameservers of all providers you will be using for your multi-signer DNSSEC setup.\n\n</page>\n\n<page>\n---\ntitle: Manage internal DNS records  Cloudflare DNS docs\ndescription: Manage internal DNS records in Cloudflare. Learn about supported\n  DNS record types and CNAME flattening.\nlastUpdated: 2025-06-06T12:18:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/internal-dns/internal-zones/internal-dns-records/\n  md: https://developers.cloudflare.com/dns/internal-dns/internal-zones/internal-dns-records/index.md\n---\n\nInternal zones can contain the same [DNS record types](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/) that Cloudflare supports for public zones.\n\nYou can manage internal DNS records in the same way as you would manage public DNS records, with the difference that [proxy status](https://developers.cloudflare.com/dns/proxy-status/) does not apply to internal DNS records.\n\nRefer to [Manage DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) or to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/) for further guidance.\n\n## CNAME flattening in Internal DNS\n\nWith [CNAME flattening](https://developers.cloudflare.com/dns/cname-flattening/), Cloudflare finds the final target content that a CNAME points to and then returns this content instead of a CNAME record. With Internal DNS, CNAME flattening is applied by default and cannot be turned off.\n\nCloudflare will try to flatten the CNAME record considering both the specified [DNS view](https://developers.cloudflare.com/dns/internal-dns/dns-views/) and any existing [reference zones](https://developers.cloudflare.com/dns/internal-dns/internal-zones/reference-zones/). If the reference zone then has another CNAME, the record will again be considered from the perspective of the original view.\n\nExample\n\n* Query for the `A` record on `abc.example.local` with view ID 111.\n* Zone 600 references zone 700, which is not linked to any view.",
      "language": "unknown"
    },
    {
      "code": "After finding the CNAME record that points to `xyz.net`, Cloudflare cannot resolve it within zone 600. However, since this zone is referencing zone 700, this will be considered in the resolution.\n\nThe record in zone 700 points to `def.example.local`, which Cloudflare will then try to resolve in the original view. As an `A` record can be found for `def.example.local`, Cloudflare will return the corresponding IP address - in this example, `192.0.2.9`.\n\nIf it is not possible to flatten the CNAME record, the following will happen:\n\n1. The CNAME record is returned to [Gateway resolver](https://developers.cloudflare.com/dns/internal-dns/#architecture-overview) as-is.\n\n2. Gateway resolver will process the returned record, depending on the **Fallback through public DNS** configuration:\n\n   * On: Gateway will try to resolve the query by sending it to Cloudflare's public DNS resolver ([1.1.1.1](https://developers.cloudflare.com/1.1.1.1/)).\n   * Off: Gateway will return the response as-is to the client.\n\n</page>\n\n<page>\n---\ntitle: Reference zones  Cloudflare DNS docs\ndescription: Learn about reference zones. Cloudflare Internal DNS allows zones\n  to reference others for query resolution when no direct record is found.\nlastUpdated: 2025-09-04T07:27:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/internal-dns/internal-zones/reference-zones/\n  md: https://developers.cloudflare.com/dns/internal-dns/internal-zones/reference-zones/index.md\n---\n\nDuring an [internal DNS query resolution](https://developers.cloudflare.com/dns/internal-dns/#architecture-overview), if no internal record is found within a matching internal zone, Cloudflare will check if the matching internal zone is referencing another internal zone. Successive references can be followed with a maximum of five references in a chain.\n\nNote\n\nA wildcard record (`*.example.local`) in the matching internal zone will take precedence over an exact match in a reference zone.\n\n## Configuration conditions\n\n* Each internal zone can only reference one other zone.\n* The same zone can be referenced by multiple internal zones.\n* Public zones cannot be used as reference zones.\n* Reference zones do not have to be linked to the same [DNS view](https://developers.cloudflare.com/dns/internal-dns/dns-views/) as the zone referencing them. They may also not be linked to any view at all.\n\n## Set up\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Internal DNS** page.\n\n     [Go to **Internal DNS**](https://dash.cloudflare.com/?to=/:account/internal-dns)\n\n  2. Select a zone.\n\n  3. Within the selected zone, go to **Reference zone**.\n\n  4. Select **Add reference zone**. If your zone already has a reference zone set up, you must first remove it. As explained in the [configuration conditions](#configuration-conditions), each internal zone can only reference one other zone at a time.\n\n  5. Find the zone you want to use as reference and choose **Select** in the respective row.\n\n* API\n\n  Use the [Update DNS settings](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) endpoint. In `--json`, specify the `internal_dns` object with the parameter `reference_zone_id`.\n\n  In the following example, internal zone A (ID `8a904aeb565c42cfa207d98f6edea2f3`) is referencing internal zone B (ID `8e64c6fb4b514f3faf64de81efc11e51`).\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Zone DNS Settings Write`\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "A third zone (C) could also point to zone B as a reference, but zone A cannot add another zone as a reference while also having zone B configured as its reference zone.\n\n</page>\n\n<page>\n---\ntitle: Manage internal zones  Cloudflare DNS docs\ndescription: Understand how to set up and manage internal DNS zones with\n  Cloudflare. Explore configuration conditions, zone creation, and available API\n  endpoints.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/internal-dns/internal-zones/setup/\n  md: https://developers.cloudflare.com/dns/internal-dns/internal-zones/setup/index.md\n---\n\nRefer to the following sections to learn how to manage your [internal DNS zones](https://developers.cloudflare.com/dns/internal-dns/internal-zones/).\n\n## Configuration conditions\n\nWhen setting up internal zones, observe the following conditions:\n\n* Internal zones can contain the same [DNS record types](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/) that Cloudflare supports for public zones.\n* An internal zone can have the same name as a public zone in the same account.\n* Each internal zone can be linked to multiple [views](https://developers.cloudflare.com/dns/internal-dns/dns-views/)[1](#user-content-fn-20).\n* There can be several internal zones with the same name in one account. However, two internal zones with the same name cannot be linked to the same view.\n* Internal zones are not subject to any top-level domain (TLD) restrictions. This means that an internal zone can be created if its TLD is not registered publicly (for example, `xyz.local`), if it is created on the TLD itself (`local`), or even if on the root (`.`).\n\n## Footnotes\n\n1. Logical groupings of internal DNS zones that are referenced by Gateway resolver policies to define how a specific query should be resolved. [](#user-content-fnref-20)\n\n## Create an internal zone\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Internal DNS** page.\n\n     [Go to **Internal DNS**](https://dash.cloudflare.com/?to=/:account/internal-dns)\n\n  2. Select **Create an internal zone**.\n\n  3. Give your internal zone a name.\n\n  1) Add DNS records to your internal zone using your preferred option:\n\n  * [Import](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/) a formatted BIND file.\n  * Select **Add a record** and choose **Create** under the record type you want to add. Refer to [DNS record types](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/) for details.\n\n  1. Repeat this process for each internal zone you wish to add.\n\n  Note\n\n  Creating multiple internal DNS records in batch is currently only supported via API.\n\n* API\n\n  1. Use the [Create Zone](https://developers.cloudflare.com/api/resources/zones/methods/create/) endpoint to create an [internal zone](https://developers.cloudflare.com/dns/internal-dns/internal-zones/). Specify your account ID and set the `type` to `internal`.\n\n  Example\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Zone Zone Edit`\n  * `Zone DNS Edit`",
      "language": "unknown"
    },
    {
      "code": "1. Add DNS records to your internal zone using your preferred option:\n\n  * [Import](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/import/) a formatted BIND file. Refer to the [DNS records how-to](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/) for guidance.\n  * Use other API endpoints, such as [`/batch`](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/batch/), to manage DNS records. Refer to [Batch record changes](https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/#use-the-api) for details.\n\n  1. Repeat this process for each internal zone you wish to add.\n\n## Other API actions\n\nThe API endpoints to manage internal zones are the same as for managing public zones. The main difference is that the zone type must be set to `internal`. Refer to the API documentation below for details:\n\n* [Update an internal zone](https://developers.cloudflare.com/api/resources/zones/methods/edit/) (`PATCH`)\n* [Get internal zone details](https://developers.cloudflare.com/api/resources/zones/methods/get/) (`GET`)\n* [List internal zones](https://developers.cloudflare.com/api/resources/zones/methods/list/) (`GET`)\n* [Delete an internal zone](https://developers.cloudflare.com/api/resources/zones/methods/delete/) (`DELETE`)\n\n</page>\n\n<page>\n---\ntitle: Batch record changes  Cloudflare DNS docs\ndescription: Cloudflare allows you to apply several changes to your zone records\n  in just one action. You can use the dashboard to delete DNS records or update\n  their proxy status in bulk, or use the API to perform further batched\n  operations.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/index.md\n---\n\nCloudflare allows you to apply several changes to your zone records in just one action. You can [use the dashboard](#use-the-dashboard) to delete DNS records or update their proxy status in bulk, or [use the API](#use-the-api) to perform further batched operations.\n\nPropagation through the Cloudflare network\n\nAlthough Cloudflare will execute the batched operations in a single [database transaction](https://en.wikipedia.org/wiki/Database_transaction), Cloudflare's distributed KV store must treat each record change as a single key-value pair. This means that the propagation of changes is not atomic. Refer to our [blog post](https://blog.cloudflare.com/batched-dns-changes/) for details.\n\n## Availability and limits\n\nBatch DNS record changes is available on all plans.\n\nThe number of records that you can operate with in one action depends on your zone plan:\n\n* Free: 200\n* Pro: 3,500\n* Business: 3,500\n* Enterprise: 3,500\n\n***\n\n## Use the dashboard\n\n### Edit proxy status in bulk\n\n`A`,`AAAA`, and `CNAME` records can be [proxied](https://developers.cloudflare.com/dns/proxy-status/). The **Proxy status** of a DNS record affects [how Cloudflare responds to DNS queries](https://developers.cloudflare.com/fundamentals/concepts/how-cloudflare-works/) to that record.\n\nNote\n\nIf you have multiple `A/AAAA` records on the same name and at least one of them is proxied, Cloudflare will treat all `A/AAAA` records on this name as being proxied.\n\n1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n   [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n2. Select the DNS records you want to set the proxy status for. Note that only `A`, `AAAA`, and `CNAME` records can be proxied.\n\n3. Select **Edit records**.\n\n4. Choose the proxy status you want to apply to the selected records.\n\n5. Select **Save** to confirm.\n\nYou can only set records to either **Proxied** or **DNS only** in bulk. This means that if your selection includes both proxied and DNS-only records, some of them will have the proxy status updated while others will keep their original value:\n\nFor example, if you select the following records and then edit their proxy status in bulk, choosing **Proxied** in [step 4 above](#edit-proxy-status-in-bulk), the outcome will be:\n\n| Selected records | Original proxy status | Resulting proxy status |\n| - | - | - |\n| `www` | DNS only | Proxied |\n| `blog` | DNS only | Proxied |\n| `docs` | Proxied | Proxied |\n\n### Delete records in bulk\n\nWarning\n\nDeleting DNS records can cause downtime and cannot be reverted. Make sure you only select DNS records that you can safely delete.\n\n1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n   [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n2. Select the DNS records you want to delete.\n\n3. Select **Delete records**.\n\n4. In the **Delete DNS records** prompt, type in `DELETE` and select **Delete** to confirm.\n\n## Use the API\n\nNote\n\nThis option requires familiarity with API usage and concepts. For further information about the Cloudflare API, refer to [Fundamentals](https://developers.cloudflare.com/fundamentals/api/get-started/).\n\nThe [Batched DNS record changes](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/batch/) endpoint allows you to trigger the execution of `DELETES`, `PATCHES`, `PUTS`, and `POSTS` in a single request.\n\n[Tags and comments](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/) are also supported with batch changes.\n\nThe operations you specify within the `/batch` request body are always executed in the following order:\n\n1. Deletes\n2. Patches\n3. Puts\n4. Posts\n\nWithin each of these four lists, each individual action is executed following the DNS records order you provide. If any of the individual action fails, no changes are applied and the API returns the first error it encountered.\n\n### Aspects to consider\n\nPropagation through the Cloudflare network\n\nAlthough Cloudflare will execute the batched operations in a single [database transaction](https://en.wikipedia.org/wiki/Database_transaction), Cloudflare's distributed KV store must treat each record change as a single key-value pair. This means that the propagation of changes is not atomic. Refer to our [blog post](https://blog.cloudflare.com/batched-dns-changes/) for details.\n\nFor each operation that you list in the `/batch` request body, consider the required information and how unspecified fields will behave:\n\n* **`deletes`**: only the `id` is required for each record object. You can keep additional parameters such as `name` for readability, but any other fields aside from `id` will be ignored in this case.\n* **`patches`**: aside from each record `id`, you should specify the fields you want to update. All unspecified fields will remain as they are.\n* **`puts`**: you must specify each record `id`, `content`, `name`, and `type`. You should also specify any other fields you want to set to a value that is not the default. Any unspecified fields will assume their default value for each [record type](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/). This operation works as an overwrite, so all fields in a given record are always affected.\n* **`posts`**: since you are creating a new record, `id` is not required. For field definitions, refer to the [Create DNS Record](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) endpoint and select the desired record type under the request body specification.\n\n### Example request\n\nIn this example, the `proxied` field for the first record listed under `\"puts\"` will assume the default value (`false`).",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Manage DNS records  Cloudflare DNS docs\ndescription: Consider the sections below for step-by-step instructions on\n  managing DNS records at Cloudflare.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/index.md\n---\n\nConsider the sections below for step-by-step instructions on managing DNS records at Cloudflare.\n\nTo better understand what DNS records are, refer to [Overview](https://developers.cloudflare.com/dns/manage-dns-records/). For context around common records you want to review when getting started at Cloudflare, refer to [review DNS records](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#review-dns-records).\n\nNote\n\nIf your domain is added to Cloudflare by a hosting partner, manage your DNS records via the hosting partner.\n\n## Create DNS records\n\n* Dashboard\n\n  To create a DNS record in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. Select **Add record**.\n\n  3. Choose a record [**Type**](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/).\n\n  4. Complete the required fields, which vary per record. Particularly important fields (for some records) include:\n\n     * **Proxy status**: For `A`, `AAAA`, and `CNAME` records, decide whether hostname traffic is [proxied through Cloudflare](https://developers.cloudflare.com/dns/proxy-status/).\n     * **TTL**: Short for [*Time to Live*](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/), this field controls how long each record is valid and  as a result  how long it takes for record updates to reach your end users.\n     * **Comment** and **Tag**: [Record attributes](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/) meant for your reference.\n\n  5. Select **Save**.\n\n* API\n\n  To create records with the API, use a [POST request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/). For field definitions, select a record type under the request body specification.\n\n  For specific API examples, refer to [DNS record types](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/).\n\n***\n\n## Edit DNS records\n\n* Dashboard\n\n  To edit DNS records in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. On a specific record, select **Edit**.\n\n  3. Make any necessary changes.\n\n  4. Select **Save**.\n\n* API\n\n  To update part of a record with the API, use a [PATCH request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/edit/). If you want to overwrite the entire existing record, use a [PUT request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/update/).\n\n***\n\n## Delete DNS records\n\n* Dashboard\n\n  To delete DNS records in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. On a specific record, select **Edit**.\n\n  3. Select **Delete**.\n\n  4. Select **Delete** again to confirm.\n\n* API\n\n  To delete records with the API, use a [DELETE request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/delete/).\n\n***\n\n## Batch record changes\n\nFor guidance on how to apply several changes to your zone records in just one action, refer to [Batch record changes](https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/).\n\n</page>\n\n<page>\n---\ntitle: Create subdomain records  Cloudflare DNS docs\ndescription: Most subdomains serve a specific purpose within the overall context\n  of your website. For example, blog.example.com might be your blog,\n  support.example.com could be your customer help portal, and store.example.com\n  would be your e-commerce site.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-subdomain/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-subdomain/index.md\n---\n\nMost subdomains serve a specific purpose within the overall context of your website. For example, `blog.example.com` might be your blog, `support.example.com` could be your customer help portal, and `store.example.com` would be your e-commerce site.\n\nEven if you do not require specific subdomains, you might want to set up at least a subdomain record on `www`. It will usually point to the same content as what you have on the apex domain (`example.com`) or use a [redirect](https://developers.cloudflare.com/fundamentals/manage-domains/manage-subdomains/#redirect-a-subdomain-to-the-apex-domain). Having a subdomain DNS record on `www` helps guarantee that a visitor who types `www.` in front of your domain address can still find your website or application.\n\n## Subdomain records\n\nTo host content on a subdomain of your domain, first ensure that your [hosting provider](https://developers.cloudflare.com/fundamentals/manage-domains/#host-your-domain) can serve content for the given hostname (`<subdomain>.example.com`).\n\nThen, you would create a corresponding [IP address resolution record](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ip-address-resolution) (`A`, `AAAA`, or `CNAME`), specifying the label for your subdomain (`blog`, `www`, or `store`, for example) as the record **Name**.\n\n| Type | Name | IPv4 address | Proxy status |\n| - | - | - | - |\n| A | `blog` | `192.0.2.1` | Proxied |\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. Select **Add record**.\n\n  3. Select `A`, `AAAA`, or `CNAME` as the record **Type**, according to your needs:\n\n     * To point to an IPv4 address, select `A`, use your subdomain (`blog`) for the record **Name**, and insert the IPv4 address in the respective field.\n     * To point to an IPv6 address, select `AAAA`, use your subdomain (`blog`) for the record **Name**, and insert the IPv6 address in the respective field.\n     * To point to a [fully qualified domain name (FQDN)](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) (such as `your-site.host.example.com`), select `CNAME`, use your subdomain (`blog`) for the record **Name**, and insert the fully qualified domain name in the **Target** field.\n\n  4. Specify the [**Proxy status**](https://developers.cloudflare.com/dns/proxy-status/) and [**TTL**](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/) according to your needs.\n\n  5. Select **Save** to confirm.\n\n* API\n\n  Use the [Create DNS Record API endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/).\n\n  For field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n  * To point to an IPv4 address, select **A Record**, use your subdomain (`blog`) for the field `name`, and use the IPv4 address for the field `content`.\n  * To point to an IPv6 address, select **AAAA Record**, use your subdomain (`blog`) for the field `name`, and use the IPv6 address for the field `content`.\n  * To point to a [fully qualified domain name (FQDN)](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) (such as `your-site.host.example.com`), select **CNAME Record**, use your subdomain (`blog`) for the field `name`, and use the fully qualified domain name for the field `content`.\n\n## Subdomain redirects\n\nFor more guidance on redirecting a subdomain  either to your main domain or another location  refer to [Set up subdomain redirects](https://developers.cloudflare.com/fundamentals/manage-domains/manage-subdomains/#set-up-redirects).\n\n## SSL/TLS for subdomains\n\nWhile DNS is what communicates where your website or application can be reached, SSL/TLS is what enables websites and applications to establish connections in a secure way.\n\nIf your subdomains are not correctly covered by an SSL/TLS certificate, your visitors will find a warning on their browser stating that your website or application is not secure.\n\nIf your main domain is using Cloudflare's [Universal SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/), that certificate also covers all first-level subdomains (`blog.example.com`).\n\nFor deeper subdomains (`dev.blog.example.com`), use a [different type of certificate](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/limitations/#full-setup).\n\nProxy status\n\nCloudflare can only serve an SSL/TLS certificate for a DNS record when you set the record's [proxy status](https://developers.cloudflare.com/dns/proxy-status/) to **Proxied**. If you do not do this, the origin server your record points to will be responsible for supporting SSL/TLS connections.\n\n## Customize subdomain behavior\n\nIf you want to customize Cloudflare settings for individual subdomains, your approach will vary depending on your plan.\n\nEnterprise customers can set up custom settings and access for a specific subdomain within Cloudflare with [Subdomain support](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/).\n\nAll other customers can set up subdomain-specific [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/) or [Page Rules](https://developers.cloudflare.com/rules/page-rules/) to alter Cloudflare settings.\n\nIf you want a subdomain's DNS settings managed totally outside of Cloudflare  meaning this subdomain can be managed by individuals without access to your Cloudflare account  refer to [Delegating subdomains outside of Cloudflare](https://developers.cloudflare.com/dns/manage-dns-records/how-to/subdomains-outside-cloudflare/).\n\n</page>\n\n<page>\n---\ntitle: Create zone apex record  Cloudflare DNS docs\ndescription: When you add a domain to Cloudflare, you may also need to create or\n  review the DNS record on your zone apex. Zone apex refers to the domain\n  (example.com) or subdomain (blog.example.com) that you are adding to\n  Cloudflare.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-zone-apex/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-zone-apex/index.md\n---\n\nWhen you add a domain to Cloudflare, you may also need to create or review the DNS record on your zone apex. Zone apex refers to the domain (`example.com`) or subdomain (`blog.example.com`) that you are [adding to Cloudflare](https://developers.cloudflare.com/dns/concepts/#zone).\n\nUsually, the zone apex record makes your domain accessible by visitors. In this case, the necessary record type ([A, AAAA, or CNAME](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ip-address-resolution)) and its content will depend on the provider that [hosts](https://developers.cloudflare.com/fundamentals/manage-domains/#host-your-domain) your website or application. If you are using Cloudflare Pages, refer to [Custom domains](https://developers.cloudflare.com/pages/configuration/custom-domains/). If you are using other providers, look for their guidance on how to connect domains managed on external DNS services.\n\n### ANAME or ALIAS\n\nANAME or ALIAS are DNS records used by specific DNS providers. If your previous provider was using ANAME or ALIAS, you can recreate these records on Cloudflare as CNAME records. Cloudflare's [CNAME flattening](https://developers.cloudflare.com/dns/cname-flattening/)[1](#user-content-fn-1) allows you to create CNAME records at your [zone apex](https://developers.cloudflare.com/dns/concepts/#zone-apex), removing the need for those other record types.\n\n## Footnotes\n\n1. A process in which Cloudflare returns an IP address instead of the target hostname that a CNAME record points to. [](#user-content-fnref-1)\n\n## Zone apex record\n\nTo create a zone apex record, use `@` for the record **Name**, as in the following example.\n\n| Type | Name | IPv4 address | Proxy status |\n| - | - | - | - |\n| A | `@` | `192.0.2.1` | Proxied |\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. Select **Add record**.\n\n  3. Select `A`, `AAAA`, or `CNAME` as the record **Type**, according to your needs:\n\n     * To point to an IPv4 address, select `A`, use your zone apex (`@`) for the record **Name**, and insert the IPv4 address in the respective field.\n     * To point to an IPv6 address, select `AAAA`, use your zone apex (`@`) for the record **Name**, and insert the IPv6 address in the respective field.\n     * To point to a [fully qualified domain name (FQDN)](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) (such as `your-site.host.example.com`), select `CNAME`, use your zone apex (`@`) for the record **Name**, and insert the fully qualified domain name in the **Target** field.\n\n  4. Specify the [**Proxy status**](https://developers.cloudflare.com/dns/proxy-status/) and [**TTL**](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/) according to your needs.\n\n  5. Select **Save** to confirm.\n\n* API\n\n  Use the [Create DNS Record API endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/).\n\n  For field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n  * To point to an IPv4 address, select **A Record**, use your zone apex (`@`) for the field `name`, and use the IPv4 address for the field `content`.\n  * To point to an IPv6 address, select **AAAA Record**, use your zone apex (`@`) for the field `name`, and use the IPv6 address for the field `content`.\n  * To point to a [fully qualified domain name (FQDN)](https://en.wikipedia.org/wiki/Fully_qualified_domain_name) (such as `your-site.host.example.com`), select **CNAME Record**, use your zone apex (`@`) for the field `name`, and use the fully qualified domain name for the field `content`.\n\n## Domain redirects\n\nOnce you create a domain, you may want to route that traffic to other places.\n\nFor more guidance, refer to [Redirect domain to subdomain](https://developers.cloudflare.com/fundamentals/manage-domains/manage-subdomains/#redirect-the-apex-domain-to-a-subdomain) or [Redirect one domain to another](https://developers.cloudflare.com/fundamentals/manage-domains/redirect-domain/).\n\n## Get free SSL certificates\n\nWhile DNS is what communicates where your website or application can be reached, SSL/TLS is what enables websites and applications to establish connections in a secure way.\n\nIf your domain is not correctly covered by an SSL/TLS certificate, your visitors will find a warning on their browser stating that your website or application is not secure.\n\nCloudflare offers free, unshared, publicy trusted [Universal SSL certificates](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) to all Cloudflare domains.\n\n</page>\n\n<page>\n---\ntitle: Set up email records  Cloudflare DNS docs\ndescription: \"There are three reasons to set up email records for your domain:\"\nlastUpdated: 2025-01-10T11:24:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/index.md\n---\n\nThere are three reasons to set up email records for your domain:\n\n* To make sure your domain can [receive email](#receive-email).\n* To make sure your domain can [send and receive email](#send-and-receive-email).\n* To prevent other email senders from [spoofing your domain](#prevent-domain-spoofing).\n\nThe exact values for your DNS mail records depend on your email provider. If you have issues, review the [Troubleshooting](https://developers.cloudflare.com/dns/troubleshooting/email-issues/) and contact your email service provider to confirm your DNS records are correct.\n\n***\n\n## Receive email\n\nIf you only need to **receive** emails, Cloudflare offers [Email Routing](https://developers.cloudflare.com/email-routing/) for free email forwarding to custom email addresses.\n\n## Send and receive email\n\nTo **send and receive** emails from your domain, you need an SMTP provider. Then, create two DNS records within Cloudflare, following the steps below:\n\n1. Get the IP address and MX record details from your SMTP provider ([vendor-specific guidelines](https://developers.cloudflare.com/dns/manage-dns-records/reference/vendor-specific-records/)).\n\n2. [Add an `A` or `AAAA` record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) for your mail subdomain that points to the IP address of your mail server.\n\n   | **Type** | **Name** | **IPv4 address** | **Proxy status** |\n   | - | - | - | - |\n   | A | `mail` | `192.0.2.1` | DNS only |\n\n   API example\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "3. [Add an `MX` record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) that points to that subdomain.\n\n   | **Type** | **Name** | **Mail server** | **TTL** | **Priority** |\n   | - | - | - | - | - |\n   | MX | `@` | `mail.example.com` | Auto | 5 |\n\n   API example\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "Note\n\nIf you encounter issues with your email setup, refer to our [troubleshooting guide](https://developers.cloudflare.com/dns/troubleshooting/email-issues/).\n\n***\n\n## Prevent domain spoofing\n\nThere are several DNS mechanisms to prevent others from sending emails on behalf of your domain. These all work as TXT records that need to be added on your domain:\n\n* [Sender Policy Framework (SPF)](https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/): List authorized IP addresses and domains that can send email on behalf of your domain.\n* [DomainKeys Identified Mail (DKIM)](https://www.cloudflare.com/learning/dns/dns-records/dns-dkim-record/): Ensure email authenticity by cryptographically signing emails.\n* [Domain-based Message Authentication Reporting and Conformance (DMARC)](https://www.cloudflare.com/learning/dns/dns-records/dns-dmarc-record/): Receive aggregate reports about your email traffic and provide clear instructions for how email receivers should treat non-conforming emails.\n\nNote\n\nFor additional background on email security records, refer to the [introductory blog post](https://blog.cloudflare.com/tackling-email-spoofing/).\n\n### Configure email security records\n\nRefer to [Security records](https://developers.cloudflare.com/dmarc-management/security-records/) to learn how to set up your email security records.\n\n## Proxy SMTP traffic\n\nBy default, Cloudflare does not proxy email traffic on port 25 (SMTP). You can only proxy outgoing email if you have [Spectrum](https://developers.cloudflare.com/spectrum/) configured for [SMTP](https://developers.cloudflare.com/spectrum/reference/configuration-options/#smtp).\n\n</page>\n\n<page>\n---\ntitle: Import and export records  Cloudflare DNS docs\ndescription: Use import and export to have more control over your DNS records\n  and make processes like migrating a domain or bulk editing record comments\n  easier.\nlastUpdated: 2025-11-21T10:02:30.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/index.md\n---\n\nUse import and export to have more control over your DNS records and make processes like migrating a domain or bulk editing [record comments](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/) easier.\n\n## Import records\n\n### Limits\n\n* The zone file size limit is 256 KiB (262144 bytes).\n\n* The API rate limit is three requests per minute per user.\n\n### Format your zone file\n\nCreate a [BIND zone file](https://en.wikipedia.org/wiki/Zone_file) for your domain. If you need help, use a [third-party tool](https://pgl.yoyo.org/as/bind-zone-file-creator.php).\n\nIf you are using certain record types  for example, `CNAME`, `DNAME`, `MX`, `NS`, `PTR`, or `SRV` records  make sure that the **content** of those records contains fully qualified domain names ending in a trailing period (as in `example.com.`). For more details, refer to [RFC 1035](https://www.rfc-editor.org/rfc/rfc1035#section-5.1) or this [post on Stack Exchange](https://superuser.com/questions/348282/fqdn-format-in-bind-zone#348284).\n\n### Import zone file to Cloudflare\n\n* Dashboard\n\n  To import a zone file using the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. Select **Import and Export**.\n\n  3. For **Import DNS records**, select your [formatted file](#format-your-zone-file).\n\n  4. If you do not want [applicable records](https://developers.cloudflare.com/dns/proxy-status/) proxied, unselect **Proxy imported DNS records**.\n\n* API\n\n  To import records using the API, send a [POST request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/import/) with a properly [formatted file](#format-your-zone-file).\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Export records\n\nYou can also bulk export records from Cloudflare.\n\n* Dashboard\n\n  To export records using the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. Select **Import and Export**.\n\n  3. Select **Export**.\n\n* API\n\n  To export records using the API, send a [GET request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/export/).\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `DNS Read`\n  * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "***\n\n## DNS record attributes\n\nWhen exporting or importing a zone file, Cloudflare formats [comments and tags](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/) using the following structure, appending the attributes as inline comment using the `;` character after each record in accordance with [RFC 1035 section 5](https://datatracker.ietf.org/doc/html/rfc1035#section-5-1):\n\n| Combination | Description |\n| - | - |\n| **Only tags** | Tag names contain a [small set](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/#tags) of characters. Additionally, tag values must be contained by a double quote (`\"`) if they contain `\"`, `=`, `,`, or `\\`. When enclosed within double quotes (`\"`), tag values are represented as JSON strings, so other quotes within the value can be escaped as `\\\"`. A tag with an empty value can be represented either as `my-tag-name:\"\"`, `my-tag-name:`, or `my-tag-name`. |\n| **Only a comment** | Comments have [fewer limitations](https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/#comments) on characters, meaning that the comment is included verbatim. If the comment includes the string `cf_tags=`, you need to include an additional `cf_tags=` at the end of the line. |\n| **Comment and tags** | The zone file comment would be of the form ; `<comment>` cf\\_tags=`<tags>`, as described above. Note the added space character before `cf_tags=`. |\n| **Neither attribute** | The comment in the zone file may be empty or omitted entirely. Comments in the zone file that do not immediately follow a record are also ignored. |",
      "language": "unknown"
    },
    {
      "code": "### Reserved cf- tags\n\nWhen exporting and importing, special tags starting by `cf-` allow you to control specific Cloudflare configurations. On export, these tags are automatically added to reflect the current configuration for each record on your zone.",
      "language": "unknown"
    },
    {
      "code": "#### cf-proxied\n\nOn export, [proxied DNS records](https://developers.cloudflare.com/dns/proxy-status/) will present a tag `cf-proxied:true` while DNS-only records will have this tag set to `cf-proxied:false`.\n\nWhen importing zone files, the value in the `cf-proxied` tag will take precedence in determining whether a record should be proxied. This means that:\n\n* If the tag is present, its value will be considered for the respective record regardless of the **Proxy imported DNS records** option being selected (via dashboard), or the `proxied` parameter being generally set to `true` or `false` (via API).\n* If the tag is absent, the proxied status will fall back to the general import option, meaning **Proxy imported DNS records** selected or not (via dashboard) or the `proxied` parameter set to `true` or `false` (via API).\n\n#### cf-flatten-cname\n\nIf you are on a paid zone and want to use [Per-record CNAME flattening](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#per-record), use the tag `cf-flatten-cname` next to each flattened CNAME record in your zone file. On export, this tag is automatically added to reflect the record configuration that you have on your zone.\n\n## DNS zone file directives\n\nA DNS zone file can be constructed using directives in addition to resource records (RRs). Directives start with `$` and are standardized - `$ORIGIN` and `$INCLUDE` are defined in [RFC 1035](https://www.rfc-editor.org/rfc/rfc1035#section-5.1), and `$TTL` is defined in [RFC 2308](https://www.rfc-editor.org/rfc/rfc2308). Additionally, BIND provides the [non-standard](https://bind9.readthedocs.io/en/latest/chapter3.html#bind-primary-file-extension-the-generate-directive) `$GENERATE` directive.\n\nCloudflare supports `$ORIGIN`, `$TTL`, and `$GENERATE` directives.\n\n`$INCLUDE` is not supported. When a zone file contains a `$INCLUDE` directive, Cloudflare responds with a parsing error `$INCLUDE directive not allowed`.\n\n</page>\n\n<page>\n---\ntitle: Dynamically update DNS records  Cloudflare DNS docs\ndescription: Most Internet service providers and some hosting providers\n  dynamically update their customer's IP addresses. If this situation applies to\n  you, you need an automated solution to dynamically update your DNS records in\n  Cloudflare.\nlastUpdated: 2025-03-24T19:39:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/managing-dynamic-ip-addresses/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/managing-dynamic-ip-addresses/index.md\n---\n\nMost Internet service providers and some hosting providers dynamically update their customer's IP addresses. If this situation applies to you, you need an automated solution to dynamically update your DNS records in Cloudflare.\n\n## Cloudflare API\n\nCreate a script to monitor IP address changes and then have that script push changes to the [Cloudflare API](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/update/).\n\n## ddclient\n\n[ddclient](https://github.com/ddclient/ddclient) is a third-party Perl client used to update dynamic DNS entries for accounts on various DNS providers.\n\n</page>\n\n<page>\n---\ntitle: Round-robin DNS  Cloudflare DNS docs\ndescription: To randomly distribute traffic across multiple servers, set up\n  multiple DNS A or AAAA records for the same hostname.\nlastUpdated: 2025-10-30T14:30:02.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/round-robin-dns/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/round-robin-dns/index.md\n---\n\nTo randomly distribute traffic across multiple servers, set up multiple DNS `A` or `AAAA` records for the same hostname.\n\nUse this setup for simple, [round-robin load balancing](https://www.cloudflare.com/learning/dns/glossary/round-robin-dns/). If you need more fine-grained control over traffic distribution  including automatic failover, intelligent routing, and more  set up our [add-on load balancing service](https://developers.cloudflare.com/load-balancing/).\n\n## Example scenario\n\nThe following example illustrates how you would distribute traffic intended for `www.example.com`. Though the example uses `A` records, you could also use `AAAA` records.\n\nAfter [creating an account](https://developers.cloudflare.com/fundamentals/account/create-account/) and [updating your nameservers](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/) for `example.com`, you might [create multiple subdomain DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) for `www`:\n\n| Type | Name | IPv4 address |\n| - | - | - |\n| A | `www` | `192.0.2.1` |\n| A | `www` | `192.0.2.2` |\n| A | `www` | `192.0.2.3` |\n\nThe exact behavior of your DNS routing would depend on the [proxy status](https://developers.cloudflare.com/dns/proxy-status/) of each record.\n\n### All records unproxied\n\nIf all associated records were unproxied, any request to Cloudflare's nameservers would return the three `A` records you previously added.\n\nEach client (oftentimes a browser), would decide which IP address to send the request to. If one IP address fails, the client would choose another option. All requests would be sent directly to the origin server (either `192.0.2.1`, `192.0.2.2`, or `192.0.2.3`, using the example above).\n\n### All records proxied (recommended)\n\nIf all associated records were proxied, any request to Cloudflare's nameservers would return two `A` records from Cloudflare's list of IP addresses.\n\nEach client (oftentimes a browser) would decide which Cloudflare IP address to send the request to. Cloudflare would then receive that request and  if Cloudflare needed to contact your origin server  we would pick one of the three IP addresses specified in your DNS records (either `192.0.2.1`, `192.0.2.2`, or `192.0.2.3`, using the example above).\n\nBeyond reducing requests to your origin server, this setup allows your application to take advantage of Cloudflare's [Zero downtime failover](https://developers.cloudflare.com/fundamentals/security/protect-your-origin-server/#zero-downtime-failover). When a request to one IP address fails, Cloudflare automatically retries the request to other IP addresses associated with the same hostname. This behavior prevents end users from experiencing downtime.\n\n### Unproxied and proxied records\n\nIf you have a mix of proxied and unproxied records associated with the same hostname, requests happen as if you had [all proxied records](#all-records-proxied-recommended).\n\nThis approach is not typically recommended because it can lead to unexpected behavior. For example, if you had two unproxied records and one proxied record, Cloudflare would treat all records as proxied. However, if you deleted the single proxied record, your remaining two unproxied records would immediately be treated as unproxied.\n\nWe recommend either using all proxied or all unproxied records to avoid surprises when you make changes to your DNS records.\n\n</page>\n\n<page>\n---\ntitle: Delegate subdomains  Cloudflare DNS docs\ndescription: Subdomain delegation allows different individuals, teams, or\n  organizations to manage different subdomains of a site.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/how-to/subdomains-outside-cloudflare/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/how-to/subdomains-outside-cloudflare/index.md\n---\n\nSubdomain delegation allows different individuals, teams, or organizations to manage different subdomains of a site.\n\nNote\n\nDNS delegation is not possible for Cloudflare domains using a [partial setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup).\n\nFor instance, consider`example.com`as a Cloudflare domain with `www.example.com`managed in Cloudflare's**DNS**app and`internal.example.com`delegated to nameservers outside of Cloudflare. In this example,`internal.example.com`can now be managed by individuals who do not have access to Cloudflare credentials for the`example.com`domain.\n\nWarning\n\nCloudflare's CDN and security services are not applied to delegated subdomains.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n***\n\n## Delegate a subdomain (outgoing)\n\nTo delegate a subdomain such as*internal.example.com*, tell DNS resolvers where to find the zone file:\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com) and select your account.\n\n2. Select the domain that contains the subdomain to be delegated.\n\n3. Go to [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records).\n\n4. Create `NS` records for the subdomain. For example:\n\n   * `internal.example.comNS ns1.externalhost.com`\n   * `internal.example.comNS ns2.externalhost.com`\n   * `internal.example.comNS ns3.externalhost.com`\n\n   Note\n\n   The `A` records for the subdomain are only required as glue records for nameservers that are located in the subdomain of the current zone that is being delegated.\n\n5. (Optional) If the delegated nameserver has DNSSEC enabled, [add the `DS` record](https://developers.cloudflare.com/dns/dnssec/#1-activate-dnssec-in-cloudflare) in Cloudflare.\n\n## Delegate a subdomain (incoming)\n\nTo delegate a subdomain from an external DNS provider to Cloudflare, refer to [subdomain setups](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/).\n\n</page>\n\n<page>\n---\ntitle: DNS record types  Cloudflare DNS docs\ndescription: This page provides information about some of the different types of\n  DNS records that you can manage on Cloudflare. For guidance on how to add,\n  edit, or delete DNS records, refer to Manage DNS records.\nlastUpdated: 2025-12-12T11:59:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/index.md\n---\n\nThis page provides information about some of the different types of DNS records that you can manage on Cloudflare. For guidance on how to add, edit, or delete DNS records, refer to [Manage DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\n***\n\n## IP address resolution\n\nAt least one **IP address resolution** record is required for each domain on Cloudflare. These records are the only ones you can [proxy](https://developers.cloudflare.com/dns/proxy-status/) through Cloudflare.\n\n### A and AAAA\n\n[A and AAAA records](https://www.cloudflare.com/learning/dns/dns-records/dns-a-record/) map a domain name to one or multiple IPv4 or IPv6 address(es).\n\nThese records include the following fields:\n\n* **Name**: A subdomain or the zone apex (`@`), which must:\n\n  * Be composed of labels of 63 characters or less (`label1.label2.label3`), where the fully qualified domain name (`label1.label2.label3.example.com`) does not exceed 255 characters.\n  * Start with a letter and end with a letter or digit\n  * Only contain letters, digits, or hyphens (underscores allowed but discouraged)\n\n* **IPv4/IPv6 address**: Your origin server address (cannot be a [Cloudflare IP](https://www.cloudflare.com/ips))\n\n  Note\n\n  Cloudflare uses the [canonical notation](https://www.rfc-editor.org/rfc/rfc5952.html#section-4.2) to store DNS records. This means that an AAAA record with content `fe80::0:0:1` is stored and returned as `fe80::1`, for example.\n\n  Alternative notations of IPv4 addresses (`1.1` for `1.0.0.1`, for example) are not supported for A records.\n\n* **TTL**: Time to live, which controls how long DNS resolvers should cache a response before revalidating it.\n\n  * If the **Proxy Status** is **Proxied**, this value defaults to **Auto**, which is 300 seconds.\n  * If the **Proxy Status** is **DNS Only**, you can customize the value.\n\n* **Proxy status**: For more details, refer to [Proxied DNS records](https://developers.cloudflare.com/dns/proxy-status/).\n\n#### Example API call\n\nWhen creating A or AAAA records [using the API](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records):\n\n* The `content` of the records is an IP address (IPv4 for A or IPv6 for AAAA).\n* The `proxied` field affects the record's [proxy status](https://developers.cloudflare.com/dns/proxy-status/).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### CNAME\n\n[CNAME records](https://www.cloudflare.com/learning/dns/dns-records/dns-cname-record/) map a domain name to another (canonical) domain name. They can be used to resolve other record types present on the target domain name.\n\nThese records include the following fields:\n\n* **Name**: A subdomain or the zone apex (`@`), which must:\n\n  * Be composed of labels of 63 characters or less (`label1.label2.label3`), where the fully qualified domain name (`label1.label2.label3.example.com`) does not exceed 255 characters.\n  * Start with a letter and end with a letter or digit\n  * Only contain letters, digits, or hyphens (underscores are allowed but discouraged)\n\n* **Target**: The hostname where traffic should be directed (`example.com`).\n\n* **TTL**: Time to live, which controls how long DNS resolvers should cache a response before revalidating it.\n\n  * If the **Proxy Status** is **Proxied**, this value defaults to **Auto**, which is 300 seconds.\n  * If the **Proxy Status** is **DNS Only**, you can customize the value.\n\n* **Proxy status**: For more details, refer to [Proxied DNS records](https://developers.cloudflare.com/dns/proxy-status/).\n\n#### Proxied CNAME records\n\nObserve the following aspects, especially before changing a CNAME record from [proxied](https://developers.cloudflare.com/dns/proxy-status/) to DNS-only or vice versa:\n\n* If a hostname is meant to proxy traffic, you can use CNAME records to point to other CNAME records (`www.example2.com` --> `www.example1.com` --> `www.example.com`), but the final record must point to a hostname with a valid IP address (and therefore a valid A or AAAA record). Also, queries for other record types on the same name are not supported.\n\nExample\n\nDNS management for **example.com**:\n\n| Type | Name | Content | Proxy status |\n| - | - | - | - |\n| CNAME | abc | `target.external.test` | Proxied |\n\nDNS management for **external.test**:\n\n| Type | Name | Content |\n| - | - | - |\n| A | target | `192.0.2.1` |\n| TXT | target | `\"some TXT content\"` |\n\nIn this example, a query for TXT in `abc.example.com` will **not** return the TXT content in the target zone.\n\n* Cloudflare uses a process called CNAME flattening to deliver better performance. This process supports a few features and can interact with [different setups that depend on CNAME records](https://developers.cloudflare.com/dns/cname-flattening/#aspects-to-keep-in-mind). Refer to the [CNAME flattening section](https://developers.cloudflare.com/dns/cname-flattening/) to learn more about this.\n\n* If you encounter a CNAME record that you cannot proxy  usually associated with another CDN provider  a proxied version of that record will cause connectivity errors. Cloudflare is purposely preventing that record from being proxied to protect you from a misconfiguration. Refer to [proxying limitations](https://developers.cloudflare.com/dns/proxy-status/limitations/#proxy-eligibility) for details.\n\nNote\n\nSpecific CNAME record values with traffic proxied through Cloudflare will enable Orange-to-Orange (O2O) routing for the Shopify SaaS provider. Refer to the [Shopify provider guide](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/provider-guides/shopify/) for more information.\n\n#### Example API call\n\nWhen creating CNAME records [using the API](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records):\n\n* The `content` of the records is a [fully qualified domain name](https://en.wikipedia.org/wiki/Fully_qualified_domain_name).\n* The `proxied` field affects the record's [proxy status](https://developers.cloudflare.com/dns/proxy-status/).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Email authentication\n\nThese records are recommended regardless of whether your domain sends email messages. Creating [secure email records](https://blog.cloudflare.com/tackling-email-spoofing/) can help protect your domain against email spoofing.\n\nIf your domain is not used to send email messages, learn more about creating recommended [restrictive records](https://www.cloudflare.com/learning/dns/dns-records/protect-domains-without-email/).\n\n### MX\n\nA mail exchange (MX) record is required to deliver email to a mail server.\n\n* [MX record syntax](https://www.cloudflare.com/learning/dns/dns-records/dns-mx-record/)\n* [Create an MX record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/#send-and-receive-email)\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n### DKIM\n\nA DomainKeys Identified Mail (DKIM) record ensures email authenticity by cryptographically signing emails:\n\n* [DKIM record syntax](https://www.cloudflare.com/learning/dns/dns-records/dns-dkim-record/)\n* [Create a DKIM record](https://developers.cloudflare.com/dmarc-management/security-records/#create-security-records)\n\n### SPF\n\nA Sender Policy Framework (SPF) record lists authorized IP addresses and domains that can send email on behalf of your domain.\n\n* [SPF record syntax](https://www.cloudflare.com/learning/dns/dns-records/dns-spf-record/)\n* [Create an SPF record](https://developers.cloudflare.com/dmarc-management/security-records/#create-security-records)\n\n### DMARC\n\nA Domain-based Message Authentication Reporting and Conformance (DMARC) record helps generate aggregate reports about your email traffic and provide clear instructions for how email receivers should treat non-conforming emails.\n\n* [DMARC record syntax](https://www.cloudflare.com/learning/dns/dns-records/dns-dmarc-record/)\n* [Create a DMARC record](https://developers.cloudflare.com/dmarc-management/security-records/#create-security-records)\n\n***\n\n## Specialized records\n\n### TXT\n\nA [text (TXT) record](https://www.cloudflare.com/learning/dns/dns-records/dns-txt-record/) lets you enter text into the DNS system.\n\nAs the content of TXT records consist of one or more text strings delimited by double quotes (`\"`), you might find a validation error if you add inconsistent quotation marks (for example, `\"this` or `\"these\" ones\"`). For new records, if you save your TXT content without any quotes, Cloudflare will automatically add double quotes. For details, refer to [What is a DNS TXT record](https://www.cloudflare.com/learning/dns/dns-records/dns-txt-record/).\n\nAt Cloudflare, TXT records are most commonly used to demonstrate domain ownership prior to issuing SSL/TLS certificates for [your domain](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/) or a [Cloudflare for SaaS domain](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/issue-and-validate/).\n\nYou could also use TXT to create email authentication records, but we recommend that you use our [Email security Wizard](https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/#prevent-domain-spoofing) instead.\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\nNote\n\nThe **Content** for each TXT record must be 2,048 characters or less.\n\nIf you have multiple TXT records with the same **Name**, there is also a limit for the sum of their **Content** characters, which must be 8,192 or less.\n\n### CAA\n\nA [Certificate Authority Authorization (CAA) record](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) specifies which Certificate Authorities (CAs) are allowed to issue certificates for a domain.\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n### SRV\n\nA [service record (SRV)](https://www.cloudflare.com/learning/dns/dns-records/dns-srv-record/) specifies a host and port for specific services like voice over IP (VOIP), instant messaging, and more.\n\n#### Example API call\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### SVCB and HTTPS\n\nService Binding (SVCB) and HTTPS Service (HTTPS) records allow you to provide a client with information about how it should connect to a server upfront, without the need of an initial plaintext HTTP connection.\n\nIf your domain has [HTTP/2 or HTTP/3 enabled](https://developers.cloudflare.com/speed/optimization/protocol/), [proxied DNS records](https://developers.cloudflare.com/dns/proxy-status/), and is also using [Universal SSL](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/), Cloudflare automatically generates HTTPS records on the fly, to advertise to clients how they should connect to your server.\n\nFor more details and context, refer to the [announcement blog post](https://blog.cloudflare.com/speeding-up-https-and-http-3-negotiation-with-dns/) and [RFC 9460](https://www.rfc-editor.org/rfc/rfc9460.html).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n### PTR\n\nA [pointer (PTR) record](https://www.cloudflare.com/learning/dns/dns-records/dns-ptr-record/) specifies the allowed hosts for a given IP address.\n\nWithin Cloudflare, PTR records are used for reverse DNS lookups and should preferably be added to [reverse zones](https://developers.cloudflare.com/dns/additional-options/reverse-zones/).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n### SOA\n\nA start of authority (SOA) record stores information about your domain such as admin email address, when the domain was last updated, and more. Refer to [What is a DNS SOA record](https://www.cloudflare.com/learning/dns/dns-records/dns-soa-record/) for an example.\n\nIf you are using Cloudflare for your [authoritative DNS](https://developers.cloudflare.com/dns/zone-setups/full-setup/), you do not need to create an SOA record. Cloudflare creates this record automatically when you start using Cloudflare's authoritative nameservers.\n\nWith Enterprise accounts, you also have the option to change the SOA record values that Cloudflare will use:\n\n* As a DNS zone default: Define the SOA record values that Cloudflare will use for all new zones added to your account. Refer to [Configure DNS zone defaults](https://developers.cloudflare.com/dns/additional-options/dns-zone-defaults/) for step-by-step guidance.\n* For existing zones: Override the defaults or Cloudflare-generated values under **DNS record options** on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page.\n\nNote\n\nIf you are an Enterprise customer and these options are not displayed on your Cloudflare dashboard, reach out to your account team.\n\nRefer to the following list for information about each SOA record field:\n\nSOA record fields\n\n* **`MNAME`**: The primary nameserver for the zone. Secondary nameservers receive zone updates from the nameserver specified in this field.\n\n* **`RNAME`**: The email address of the administrator responsible for the zone.\n\n  The `@` symbol is replaced by the first dot. If an email address contains a dot before `@`, this should be represented as `\\.`.\n\n  | Email | `RNAME` |\n  | - | - |\n  | `john@example.com` | `john.example.com` |\n  | `john.doe@example.com` | `john\\.doe.example.com` |\n\n* **`Serial`**: The serial number for the zone. Secondary nameservers initiate zone transfers if this number increases.\n\n* **`Refresh`**: Time (in seconds) after which a secondary nameserver should query the primary for the `SOA` record, to detect zone changes. Only relevant if DNS NOTIFY ([RFC 1996](https://www.rfc-editor.org/rfc/rfc1996.html)) is not configured.\n\n  | Default | Minimum | Maximum |\n  | - | - | - |\n  | `10000` | `600` | `86400` |\n\n* **`Retry`**: Time (in seconds) after which a secondary nameserver should retry getting the serial number from the primary nameserver after a failed attempt. Any specified values must not be greater than `Refresh`.\n\n  | Default | Minimum | Maximum |\n  | - | - | - |\n  | `2400` | `600` | `3600` |\n\n* **`Expire`**: Time (in seconds) after which a secondary nameserver should stop answering queries for a zone if the primary does not respond. Any specified values must not be smaller than `Refresh`.\n\n  | Default | Minimum | Maximum |\n  | - | - | - |\n  | `604800` | `86400` | `2419200` |\n\n* **`Record TTL`**: The [time to live](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/) of the SOA record.\n\n  | Default | Minimum | Maximum |\n  | - | - | - |\n  | `3600` | `1800` | `3600` |\n\n* **`Minimum TTL`**: The TTL for caching negative responses. Refer to [RFC 2308](https://www.rfc-editor.org/rfc/rfc2308.html#section-4) for details.\n\n  | Default | Minimum | Maximum |\n  | - | - | - |\n  | `1800` | `60` | `86400` |\n\n### NS\n\nA [nameserver (NS) record](https://www.cloudflare.com/learning/dns/dns-records/dns-ns-record/) indicates which server should be used for authoritative DNS.\n\nYou only need to add NS records to your DNS records table in Cloudflare when you are using [subdomain setup](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/) or [delegating subdomains outside of Cloudflare](https://developers.cloudflare.com/dns/manage-dns-records/how-to/subdomains-outside-cloudflare/).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\nNote\n\nYour assigned Cloudflare nameservers, custom nameservers, and their corresponding [nameserver TTLs](https://developers.cloudflare.com/dns/nameservers/nameserver-options/#nameserver-ttl) are controlled via dedicated sections on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page. For details, refer to [Nameservers](https://developers.cloudflare.com/dns/nameservers/).\n\n### DS and DNSKEY\n\n[DS and DNSKEY](https://www.cloudflare.com/learning/dns/dns-records/dnskey-ds-records/) records help implement DNSSEC, which cryptographically signs DNS records to prevent domain spoofing.\n\nMost Cloudflare domains do not need to add these records and should instead follow our [DNSSEC setup guide](https://developers.cloudflare.com/dns/dnssec/).\n\nFor field definitions, refer to the [API documentation](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) (visible once you select the record type under the request body specification).\n\n### Other\n\nCloudflare also supports other record types that are less common, such as URI, NAPTR, and certificate-related record types (SSHFP, TLSA, SMIMEA, and CERT). Refer to our [blog post](https://blog.cloudflare.com/additional-record-types-available-with-cloudflare-dns/) for more information.\n\n</page>\n\n<page>\n---\ntitle: DNS record comments and tags  Cloudflare DNS docs\ndescription: Use DNS record comments and tags to categorize and clarify the\n  purpose of DNS records within Cloudflare.\nlastUpdated: 2025-05-29T18:16:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/reference/record-attributes/index.md\n---\n\nUse DNS record comments and tags to categorize and clarify the purpose of DNS records within Cloudflare.\n\nComments provide a unique descriptions for specific records, whereas tags group similar records into categories.\n\nThese attributes are particularly useful when:\n\n* Multiple teams are managing DNS records within the same zone.\n* Your zone contains a large number of DNS records.\n* You want to filter your DNS records based on matching attributes (for example, when they are managed by the same team or used for the same application).\n\nNote\n\nThe information in record attributes will not impact DNS record resolution or propagation timing and is only meant for your private reference. This information is only visible to [members](https://developers.cloudflare.com/fundamentals/manage-members/manage/) of your Cloudflare account and is not visible publicly.\n\n***\n\n## Availability\n\nComments and tags are only supported for [full](https://developers.cloudflare.com/dns/zone-setups/full-setup/) and [partial zones](https://developers.cloudflare.com/dns/zone-setups/partial-setup/).\n\n### Record comments\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n| Character limit | 100 | 500 | 500 | 500 |\n| Comments per record | 1 | 1 | 1 | 1 |\n\n### Record tags\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | Yes | Yes | Yes |\n| Name character limit(everything before the colon) | N/A | 32 | 32 | 32 |\n| Value character limit(everything after the colon) | N/A | 100 | 100 | 100 |\n| Tags per record | N/A | 20 | 20 | 20 |\n\n***\n\n## Add or edit record attributes\n\nCreate or edit record attributes just like any other aspect of DNS records, whether through the [dashboard](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) or [API](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/).\n\nYou can also add or edit attributes by [exporting and re-importing](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#dns-record-attributes) your records, or using the [Batch record changes API](https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/#use-the-api).\n\nWhen exporting and importing, special tags starting by `cf-` allow you to control specific Cloudflare configurations. On export, these tags are automatically added to reflect the current configuration for each record on your zone. Refer to [reserved cf- tags](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#reserved-cf--tags) for details.\n\n***\n\n## Reference\n\n### Comments\n\nComments are treated as [graphic Unicode characters](https://en.wikipedia.org/wiki/Graphic_character), meaning that they are case-sensitive and do not have any character limitations. However, comments do not support newline (`\\n`) or carriage return (`\\r`) characters.\n\n### Tags\n\nTags are treated as an array of `name:value` pairs, meaning that tag names are not case-sensitive and can only contain letters, numbers, `-`, and `_`. For tag values, the same character restrictions apply as for comments.\n\n</page>\n\n<page>\n---\ntitle: Time to Live (TTL)  Cloudflare DNS docs\ndescription: Time to Live (TTL) is a field on DNS records that controls how long\n  each record is cached and  as a result  how long it takes for record updates\n  to reach your end users.\nlastUpdated: 2025-02-11T10:50:09.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/index.md\n---\n\n**Time to Live (TTL)** is a field on [DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) that controls how long each record is cached and  as a result  how long it takes for record updates to reach your end users.\n\nLonger TTLs speed up [DNS lookups](https://www.cloudflare.com/learning/dns/what-is-dns/) by increasing the chance of cached results, but a longer TTL also means that updates to your records take longer to go into effect.\n\n## Proxied records\n\nBy default, all [proxied records](https://developers.cloudflare.com/dns/proxy-status/) have a TTL of **Auto**, which is set to 300 seconds. This value cannot be edited.\n\nSince only [records used for IP address resolution](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ip-address-resolution) can be proxied, this setting ensures that potential changes to the assigned [anycast IP address](https://developers.cloudflare.com/fundamentals/concepts/cloudflare-ip-addresses/) will take effect quickly, as recursive resolvers will not cache them for longer than 300 seconds (five minutes).\n\nNote\n\nIt may take longer than 5 minutes for you to actually experience record changes, as your local DNS cache may take longer to update.\n\n## Unproxied records\n\nFor **DNS only** records, you can choose a TTL between **30 seconds** (Enterprise) or **60 seconds** (non-Enterprise) and **1 day**.\n\nA TTL of **Auto** is set to 300 seconds (five minutes).\n\n## Nameserver TTL\n\n[Nameserver TTL](https://developers.cloudflare.com/dns/nameservers/nameserver-options/#nameserver-ttl) is a separate feature and only affects Cloudflare nameservers and custom nameservers. For other [NS records](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ns) on your DNS records table, TTL is controlled by their respective TTL fields.\n\n</page>\n\n<page>\n---\ntitle: Vendor-specific DNS records  Cloudflare DNS docs\ndescription: This article requires prior knowledge of DNS record management via\n  the Cloudflare dashboard. To learn more, refer to Cloudflare's article on\n  managing DNS records.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/reference/vendor-specific-records/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/reference/vendor-specific-records/index.md\n---\n\nThis article requires prior knowledge of DNS record management via the Cloudflare dashboard. To learn more, refer to Cloudflare's article on [managing DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\n## Google\n\n### Google Workspace MX records\n\nGoogle Workspace requires [specific MX records](https://support.google.com/a/answer/174125) added to your DNS provider.\n\nOnce you [add these records to Cloudflare](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/):\n\n* [Test the configuration](https://toolbox.googleapps.com/apps/checkmx/check)\n* Do not add other `MX` records other than those provided by Google.\n\n### Google Workspace service URLs\n\nIf you want to customize the service addresses URLs associated with Google Workspace, refer to [Google's documentation](https://support.google.com/a/answer/53340).\n\nWarning\n\nGoogle enforces HTTPS on its services. If you find errors about redirect loops when browsing to your site through Cloudflare, use Cloudflare's [Full encryption mode](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/full/).\n\n### Google site verification\n\nTo add a site verification record in Cloudflare, follow [Google's documentation](https://support.google.com/a/answer/7173990).\n\n***\n\n## Amazon\n\n### Amazon Route53\n\nAWS customers must [update their domain's nameservers](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-name-servers-glue-records.html) to point to their new Cloudflare nameservers.\n\n### Amazon S3 bucket\n\nFind the [URL](https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-bucket-intro.html) for your bucket.\n\nThen, [create a `CNAME` record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) in Cloudflare. For example, if the full host URL of the bucket is `files.example.com.s3.amazonaws.com`, you would add a `CNAME` record similar to the following:",
      "language": "unknown"
    },
    {
      "code": "Warning\n\nAWS states in their [documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html#VirtualHostingCustomURLs) that the CNAME and the bucket name must be the same. To avoid potential compromise if you set it up differently, use a [host header origin rule](https://developers.cloudflare.com/rules/origin-rules/features/#host-header) to explicitly route all requests to the correct bucket.\n\n### Amazon Simple Email Service (SES)\n\nFor help setting up DKIM in SES, refer to the [Amazon documentation](https://docs.aws.amazon.com/ses/latest/dg/creating-identities.html).\n\n### Amazon ELB configuration\n\nRefer to [Amazon's ELB help content](http://docs.amazonwebservices.com/ElasticLoadBalancing/latest/DeveloperGuide/using-domain-names-with-elb.html) for guidance on ELB configuration at Amazon, but generally you should:\n\nAdd a [`CNAME` record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) to Cloudflare for the hostname you receive from AWS, for example:\n\n| Type | Name | Target | Proxy status |\n| - | - | - | - |\n| `CNAME` | `elb` | `<AWS_HOSTNAME>.<REGION>._elb.amazonaws.com` | Proxied |\n\n### Amazon Amplify\n\nTo use Cloudflare DNS with AWS Amplify, refer to the [Amplify help content](https://docs.aws.amazon.com/amplify/latest/userguide/to-add-a-custom-domain-managed-by-a-third-party-dns-provider.html) and follow the instructions for **manual configuration**.\n\nAt Cloudflare, you will need at least two `CNAME` records:\n\n* A DNS-only `CNAME` to validate your domain ownership, which should look like the following:\n\n| Type | Name | Target | Proxy status |\n| - | - | - | - |\n| `CNAME` | `<UNIQUE_STRING>` | `<UNIQUE_STRING>.mhbtsbpdnt.acm-validation.aws` | DNS only |\n\nCNAME flattening\n\nIf your Cloudflare zone is on a paid plan, also make sure that the **Flatten** option turned off for the validation `CNAME` record, and that you zone is **not** using [CNAME flattening for all CNAME records](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#for-all-cname-records).\n\n* One `CNAME` for the apex domain (`example.com`) and/or for each of the subdomains (`blog.example.com`) that you want to manage on Cloudflare. For details refer to [Manage DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/). These records can be proxied.\n\n| Type | Name | Target |\n| - | - | - |\n| `CNAME` | `@` | `<AMPLIFY_HOSTNAME>.cloudfront.net` |\n\n| Type | Name | Target |\n| - | - | - |\n| `CNAME` | `blog` | `<AMPLIFY_HOSTNAME>.cloudfront.net` |\n\n***\n\n## Microsoft\n\n### Microsoft 365\n\nFor information about the records to Microsoft 365, refer to [Microsoft's documentation](https://learn.microsoft.com/en-us/microsoft-365/admin/get-help-with-domains/information-for-dns-records).\n\n### Microsoft Azure\n\nFollow Microsoft's instructions on [configuring Azure DNS settings](https://learn.microsoft.com/en-us/azure/app-service/app-service-web-tutorial-custom-domain).\n\nThen, add Azure's required records to [Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\n***\n\n## Miscellaneous vendors\n\n### ClickFunnels\n\nYou can configure Cloudflare to work with ClickFunnels.The process requires updating your Cloudflare DNS settings.\n\n* [Adding a Cloudflare subdomain](https://help.clickfunnels.com/hc/en-us/articles/360005906774-Adding-A-Cloudflare-Subdomain-)\n* [Adding a Cloudflare domain](https://help.clickfunnels.com/hc/en-us/articles/360005906094-Cloudflare-CNAME-Record)\n\n### Discourse\n\nTo use Discourse with Cloudflare, refer to [Using Discourse with Cloudflare: Best Practices](https://community.cloudflare.com/t/using-discourse-with-cloudflare-best-practices/602890).\n\n### Forward Email\n\nTo use Cloudflare with Forward Email, refer to [Forward Email configuration with Cloudflare](https://forwardemail.net/guides/cloudflare).\n\n### Mailchimp\n\nFor help with Mailchimp, refer to [Use a custom domain with Mailchimp](https://mailchimp.com/help/connect-domain/).\n\nNote\n\nWhen you [add records to Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/), those records should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records) until Mailchimp verifies your domain. Then, you can switch your DNS records to **Proxied**.\n\n### Ning custom domain\n\nFor help with Ning, refer to [Use a custom domain with Ning](https://www.ning.com/help/use-your-own-domain-e-g-example-com-for-your-ning-network/).\n\nNote\n\nWhen you [add records to Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/), those records should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records) until Ning verifies your domain. Then, you can switch your DNS records to **Proxied**.\n\n### Rackspace CloudFiles\n\nConfigure Rackspace CloudFiles via*CNAME record*. Consult the [Rackspace documentation](https://docs.rackspace.com/support/how-to/using-cnames-with-cloud-files-containers/).\n\nRefer to Rackspace CloudFiles's documentation to [get a `CNAME` value](https://docs.rackspace.com/support/how-to/using-cnames-with-cloud-files-containers/), then [add that record within Cloudflare](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\nWarning\n\nThe `CNAME` record needs to be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records) since rackcdn.com is not compatible with Cloudflare.\n\n### SendGrid\n\nRefer to SendGrid's documentation for how to [make SendGrid compatible with Cloudflare](https://docs.sendgrid.com/ui/sending-email/content-delivery-networks#using-cloudflare).\n\nNote\n\nYou may need to refer to Cloudflare's documentation for updated navigation instructions regarding [adding DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) and creating [Configuration rules](https://developers.cloudflare.com/rules/configuration-rules/create-dashboard/).\n\n### SmugMug\n\nFor help with SmugMug, refer to [Use a custom domain with SmugMug](https://www.smugmughelp.com/en/articles/363-use-a-custom-domain).\n\nNote\n\nWhen you [add records to Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/), those records should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records) until SmugMug verifies your domain. Then, you can switch your DNS records to **Proxied**.\n\n### Squarespace\n\nFirst, make sure you [update your nameservers](https://developers.cloudflare.com/dns/zone-setups/full-setup/) and your domain is [active](https://developers.cloudflare.com/dns/zone-setups/reference/domain-status/).\n\nThen, set up your Squarespace DNS records:\n\n1. Get your Squarespace DNS information by following [these instructions](https://support.squarespace.com/hc/articles/213469948).\n\n2. In Cloudflare, [add those records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/):\n\n   * All `A` records should be [Proxied](https://developers.cloudflare.com/dns/proxy-status/)\n   * The `CNAME` record for `www` should also be **Proxied**.\n   * The `CNAME` record for `verify.squarespace.com` should be **DNS-only**.\n\n3. If set up properly, your Squarespace DNS Settings page will now indicate that your 'Settings contain problems.'**This is the expected behavior**.\n\n![Screenshot of error warnings in squarespace](https://developers.cloudflare.com/_astro/hc-import-squarespace_dns_settings-test-2.9_-CHey0_Z2gNHzU.webp)\n\n#### Pending domain owner verification\n\nThe `CNAME` record you added for `verify.squarespace.com` should be **DNS-only**.\n\nIf you proxy this record, Squarespace will not be able to verify your domain ownership and show you a `This website is pending domain owner verification` error. To fix the issue, [edit](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#edit-dns-records) the `CNAME` record and change the **Proxy status** to **DNS-only**.\n\n### Tumblr custom domain\n\nRefer to Tumblr's documentation to [get DNS record values](https://help.tumblr.com/hc/en-us/articles/231256548-Custom-Domains). Then, [add records to Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\nNote\n\nWhen you [add records to Cloudflare DNS](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/), those records should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records) until Tumblr verifies your domain. Then, you can switch your DNS records to **Proxied**.\n\n### Unbounce\n\nRefer to Unbounce's documentation to [get a `CNAME` value](https://documentation.unbounce.com/hc/en-us/articles/204011950), then [add that record within Cloudflare](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/).\n\nWarning\n\nIf Cloudflare is activated via one of our hosting partners, your `CNAME` record should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records).\n\n### Wix\n\nYou can use Cloudflare with [Wix websites](https://www.wix.com/), though your setup needs to be different than with most website builders.\n\nThis is because Wix [does not support](https://support.wix.com/en/article/request-cloudflare-support) using Cloudflare nameservers (which is the normal part of a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/) or with domains bought through [Cloudflare Registrar](https://developers.cloudflare.com/registrar/)).\n\n#### Using domain pointing\n\nIf you want to manage your DNS through Cloudflare or you bought a domain through [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), you can connect that domain to Wix through [domain pointing](https://support.wix.com/en/article/connecting-a-domain-to-wix-using-the-pointing-method).\n\nThis method means your website is using Cloudflare for DNS only, so all your DNS records should be [DNS-only (unproxied)](https://developers.cloudflare.com/dns/proxy-status/#dns-only-records).\n\n### WPEngine\n\nFor help configuring WPEngine sites, refer to:\n\n* [Configuring DNS with WPEngine](https://wpengine.com/support/wordpress-best-practice-configuring-dns-for-wp-engine/)\n* [Cloudflare best practices](https://wpengine.com/support/cloudflare-best-practices/)\n\n### Zoho\n\nTo use Cloudflare with Zoho, refer to [Zoho configuration with Cloudflare](https://www.zoho.com/mail/help/adminconsole/cloudflare.html).\n\n</page>\n\n<page>\n---\ntitle: Wildcard DNS records  Cloudflare DNS docs\ndescription: Normal DNS records map a domain name to one or multiple IP\n  addresses or other associated resources to a specific domain name (a\n  one-to-many mapping). Wildcard DNS records allow you to have a many-to-many\n  mapping, for example if you had hundreds or thousands of subdomains you wanted\n  to point to the same resources.\nlastUpdated: 2025-10-29T09:55:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/reference/wildcard-dns-records/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/reference/wildcard-dns-records/index.md\n---\n\nNormal DNS records map a domain name to one or multiple IP addresses or other associated resources to a specific domain name (a one-to-many mapping). Wildcard DNS records allow you to have a many-to-many mapping, for example if you had hundreds or thousands of subdomains you wanted to point to the same resources.\n\nWithin Cloudflare, wildcard DNS records can be either [proxied or DNS-only](https://developers.cloudflare.com/dns/proxy-status/).\n\n## Create a Wildcard record\n\nTo create a wildcard DNS record, [create a DNS record](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) with an `*` in the **Name** field.\n\n| Type | Name | IPv4 address | Proxy status |\n| - | - | - | - |\n| `A` | `*` | `192.0.2.1` | Proxied |\n\nWarning\n\nIf your project is on [Cloudflare Pages](https://developers.cloudflare.com/pages/), note that wildcard custom domains are not supported. Refer to [known issues](https://developers.cloudflare.com/pages/platform/known-issues/#custom-domains) for details.\n\nYou can also create a wildcard DNS record specifically for a deeper subdomain. For example, if you wanted to create a wildcard record on `*.www.example.com`, you would create a record with `*.www` in the name field.\n\n| Type | Name | IPv4 address | Proxy status |\n| - | - | - | - |\n| `CNAME` | `*.www` | `example.com` | Proxied |\n\n### Aspects to consider\n\n#### Wildcards are only supported on the first label\n\nThis means that a hostname such as `subdomain.*.example.com` is not a wildcard on the level of the asterisk character. If you create a DNS record with that name, the asterisk is interpreted as the literal character `*` and not as the wildcard operator.\n\n#### Wildcards are multi-level by default\n\nIf you create a DNS record on `*.*.example.com`, only the first asterisk is interpreted as a wildcard while the second one is interpreted as the literal `*` character. A record `*.example.com` is already multi-level by default, meaning it would cover `abc.example.com` as well as `123.abc.example.com`, as long as there are no [specific DNS records](#specific-dns-records-take-precedence-over-wildcard-records) that would take precedence.\n\n#### Specific DNS records take precedence over wildcard records\n\nA wildcard record applies only when no exact record exists at the queried name. If a record or delegation exists, the wildcard does not apply.\n\nExample 1 - specific or below\n\nIf you have only these two records on your domain:\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `*` | `192.0.2.1` |\n| `TXT` | `abc` | `<some_text>` |\n\nThe `A` wildcard record will be used for queries going to any subdomain of `example.com` except `abc.example.com` or anything below that specific label (`123.abc.example.com` or `deeper.label.abc.example.com`, and so on).\n\nThe wildcard will still be used for deeper labels that are not below the specific record on `abc.example.com`  for example, `deeper.label.xyz.example.com`.\n\nExample 2 - implicit parent\n\nIf you have only these two records on your domain:\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `*` | `192.0.2.1` |\n| `TXT` | `123.abc` | `<some_text>` |\n\nIn this example, `123.abc.example.com` is a descendant of `abc.example.com`, and `abc.example.com` has no records associated with it. The behavior will depend on the type of nameservers you are using:\n\n* Standard nameservers: The wildcard `*.example.com` will still apply to `abc.example.com`.\n* [Advanced nameservers](https://developers.cloudflare.com/dns/foundation-dns/setup/)[1](#user-content-fn-1): In compliance with [RFC 4592](https://www.rfc-editor.org/rfc/rfc4592.html), the wildcard `*.example.com` will not apply to `abc.example.com`.\n\n## Availability\n\nCustomers on all plans can create and proxy wildcard DNS records.\n\n## Limitations\n\nIf you are using a [partial (CNAME) setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup/) for your DNS, Cloudflare does not automatically provision SSL/TLS certificates for your wildcard record.\n\nFor wildcard hostname certificates, certificate issuance and renewal varies based on the type of certificate you are using:\n\n* **Universal**: Perform DCV using [TXT validation method](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/txt/).\n* **Advanced**: In most cases, you can opt for [Delegated DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/delegated-dcv/), which greatly simplifies certificate management.\n\nIf you cannot use Delegated DCV, you need to use [TXT based DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/txt/) for certificate issuance and renewal. This means you will need to place one TXT DCV token for every hostname on the certificate. If one or more of the hostnames on the certificate fails to validate, the certificate will not be issued or renewed.\n\nThis means that a wildcard certificate covering `example.com` and `*.example.com` will require two DCV tokens to be placed at the authoritative DNS provider. Similarly, a certificate with five hostnames in the SAN (including a wildcard) will require five DCV tokens to be placed at the authoritative DNS provider.\n\n## Additional information\n\nFor more information on wildcard records  as well as more details about their limitations  refer to the [introductory blog post](https://blog.cloudflare.com/wildcard-proxy-for-everyone/).\n\n## Footnotes\n\n1. An opt-in configuration available for Enterprise customers. [](#user-content-fnref-1)\n\n</page>\n\n<page>\n---\ntitle: Unexpected _acme-challenge TXT records  Cloudflare DNS docs\ndescription: You might notice TXT records like _acme-challenge.<hostname> are\n  returned by your domain but cannot be found on the DNS tab of your Cloudflare\n  dashboard.\nlastUpdated: 2025-07-03T09:48:32.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/acme-challenge-txt-record/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/acme-challenge-txt-record/index.md\n---\n\nYou might notice TXT records like `_acme-challenge.<hostname>` are returned by your domain but cannot be found on the DNS tab of your Cloudflare dashboard.\n\n## Causes\n\nThese records are automatically created to allow Cloudflare edge certificates ([universal](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/), [advanced](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/), and [backup](https://developers.cloudflare.com/ssl/edge-certificates/backup-certificates/)) to be provisioned. `_acme-challenge` records are required by certificate authorities (CAs) so that they can verify your domain ownership before issuing the SSL/TLS certificate. For details, refer to [Domain control validation (DCV)](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/).\n\n## Solution\n\nAs these records are tied to the certificates, they cannot be deleted from the DNS tab of your Cloudflare dashboard.\n\nIf you need more `_acme-challenge.<hostname>` TXT records in order to provision certificates on your side, you can [manually add them](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) under [DNS records](https://dash.cloudflare.com/?to=/:account/:zone/dns/records).\n\nIf you want to remove these records:\n\n* [Disable Universal SSL](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/disable-universal-ssl/) to remove the records related to universal and backup certificates.\n* [Delete advanced certificates](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/#delete-a-certificate) to remove the records related to advanced certificates.\n\n</page>\n\n<page>\n---\ntitle: Cannot verify a domain with CNAME  Cloudflare DNS docs\ndescription: \"When configuring services from external providers - such as email\n  services, for example - it is possible that they require you to verify your\n  domain by placing a CNAME record at your zone, similar to the following:\"\nlastUpdated: 2025-09-19T15:07:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/cname-domain-verification/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/cname-domain-verification/index.md\n---\n\nWhen configuring services from external providers - such as email services, for example - it is possible that they require you to verify your domain by placing a CNAME record at your zone, similar to the following:",
      "language": "unknown"
    },
    {
      "code": "Consider the sections below if this is not working correctly for you.\n\n## Causes\n\nYou may find issues if you have one of the following:\n\n* The CNAME record you created for domain verification is set to [**Proxied**](https://developers.cloudflare.com/dns/proxy-status/).\n* The CNAME record is correctly set to DNS only (not proxied) but, in your [zone settings](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings), [**CNAME flattening for all CNAME records**](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#for-all-cname-records) is enabled.\n* The CNAME record is correctly set to DNS only (not proxied) but CNAME flattening is [enabled for that record specifically](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#per-record).\n* An [NS record](https://www.cloudflare.com/learning/dns/dns-records/dns-ns-record/) exists, causing a different DNS provider to be authoritative for the subdomain.\n\n## Solution\n\nMake sure that:\n\n* In your zone DNS settings: [**CNAME flattening for all CNAME records**](https://developers.cloudflare.com/dns/cname-flattening/) is disabled.\n\n* On the DNS records table: you have filled in the CNAME record fields correctly, proxy status is set to **DNS only**, and **Flatten** is disabled.\n\n* You have the correct NS configuration, and either:\n\n  * Make sure that the CNAME record is set as expected with the DNS provider that the NS record points to.\n  * Review your configuration for other DNS records that may be affected by the NS record. Once you are aware of any consequences or have made any necessary adjustments, remove the NS record so that the CNAME is resolved to the target you configured on Cloudflare.\n\n</page>\n\n<page>\n---\ntitle: Existing NS records block new record creation  Cloudflare DNS docs\ndescription: \"As you try to create a new DNS record, Cloudflare displays the\n  following error:\"\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/existing-ns-record/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/existing-ns-record/index.md\n---\n\nAs you try to create a new DNS record, Cloudflare displays the following error:",
      "language": "unknown"
    },
    {
      "code": "## Causes\n\nWhen a child domain (`blog.example.com`) of your domain (`example.com`) has been set up as a separate [subdomain zone](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/), corresponding `NS` records must have been placed within the parent zone.\n\nWhen you are managing DNS records for the parent zone (in this example, `example.com`), you cannot create IP address resolution records (`A`, `AAAA`, or `CNAME`) with a name that specifies the same subdomain that already exists as a separate subdomain zone.\n\n| Type | Name | Content | TTL |\n| - | - | - | - |\n| `A` | `blog` | `192.0.2.0` | `Auto` |\n\n## Solution\n\nBefore creating such records, remove any `NS` records with the same name.\n\nImportant\n\nThis action might be reverting an existing subdomain setup and may incur in downtime. Refer to [Rollback subdomain setup](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/rollback/) for more guidance.\n\n</page>\n\n<page>\n---\ntitle: Exposed IP addresses  Cloudflare DNS docs\ndescription: When your DNS records are proxied, Cloudflare speeds up and protects your site.\nlastUpdated: 2025-02-11T10:50:09.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/exposed-ip-address/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/exposed-ip-address/index.md\n---\n\nWhen your DNS records are [proxied](https://developers.cloudflare.com/dns/proxy-status/), Cloudflare speeds up and protects your site.\n\nA`dig`query against your proxied apex domain returns a Cloudflare IP address. This way, your origin servers IP address remains concealed from the public. Remember that orange cloud benefits only apply to HTTP traffic.\n\nUnder certain circumstances, the**DNS Records**panel in the Cloudflare dashboard**DNS**app displays a warning whenever you have DNS-only records that may expose your origin servers IP address. This warning does not block, or in any way affect, traffic destined to your site.\n\nWhen your servers IP address is exposed, your server is more vulnerable to direct attacks.Itis still possible (but more difficult) for attackers to determine your origin server IP address when proxying traffic to Cloudflare.\n\nBelow are two cases where you might receive an IP exposure warning from Cloudflare.\n\n***\n\n## DNS records that should be proxied\n\nIf you receive the following warning:\n\n`This record is exposing your origin servers IP address. To hide your origin IP address, and increase your server security, click on the grey cloud to change it to orange.`\n\nCloudflare recommends [proxying](https://developers.cloudflare.com/dns/proxy-status/) the record so that any `dig` query against that record returns a Cloudflare IP address and your origin server IP address remains concealed from the public.\n\nTo take advantage of Cloudflares performance and security benefits, we recommend you proxy DNS records that handle HTTP traffic, including `A`, `AAAA`, and `CNAME` records.\n\n***\n\n## DNS records that should be DNS-only\n\nWhen you have a DNS-only`A`,`AAAA`, `CNAME`, or`MX`record pointing to the same origin server hosting your site, Cloudflare displays one of the following warnings:\n\n`An A, AAAA, CNAME, or MX record is pointed to your origin server exposing your origin IP.`\n\n`This record is exposing your origin servers IP address, potentially exposing it to denial of service.`\n\nA`dig`query against these records reveals your origin servers IP address. This information makes it easier for potential attackers to target your origin server directly.\n\nHowever, there are times when some of your DNS records need to remain DNS-only. For example, you may have to host multiple services (for example, a website and email) on the same physical server.\n\nTo mitigate this risk, we recommend that you:\n\n* Analyze the impact of hosting multiple services on the same origin server in cases when you cannot avoid having DNS-only records.\n* Proxy all records that share the same origin IP address as your apex domain and can be safely proxied through Cloudflare.\n\n</page>\n\n<page>\n---\ntitle: Cannot add DNS records with the same name  Cloudflare DNS docs\ndescription: Occasionally, Cloudflare will not allow you to create new DNS\n  records with the same value in the Name field.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/records-with-same-name/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/records-with-same-name/index.md\n---\n\nOccasionally, Cloudflare will not allow you to [create new DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records) with the same value in the **Name** field.\n\nThis error can occur due to the special requirements of CNAME records[1](#user-content-fn-1).\n\n## Causes\n\nYou will encounter this error if you try to do one of the following:\n\n* Create a CNAME record with a **Name** matching the name of an existing A/AAAA[2](#user-content-fn-2) or CNAME record.\n* Create an A/AAAA record with a **Name** matching the name of an existing CNAME record.\n\nCloudflare prevents you from creating this combination of records because if a CNAME record is provided for a hostname DNS servers expect only that CNAME record to provide DNS information for that hostname.\n\nAdding additional records would send conflicting information to DNS servers. For a technical explanation of the mechanism behind this, refer to [RFC 1034](https://www.rfc-editor.org/rfc/rfc1034).\n\n## Solution\n\nReview your existing DNS records to find the matching value in the **Name** field. Then, decide whether you want to keep the current record or delete it and make a new one.\n\nNote\n\nCNAME records are the only IP resolution record with this type of limitation. You can have more than one A/AAAA record per hostname, which is a way some domains do [simple load balancing](https://developers.cloudflare.com/dns/manage-dns-records/how-to/round-robin-dns/) for incoming requests.\n\n## Footnotes\n\n1. [CNAME records](https://www.cloudflare.com/learning/dns/dns-records/dns-cname-record/) map a domain name to another (canonical) domain name. They can be used to resolve other record types present on the target domain name.\n\n   [](#user-content-fnref-1)\n\n2. [A and AAAA records](https://www.cloudflare.com/learning/dns/dns-records/dns-a-record/) map a domain name to one or multiple IPv4 or IPv6 address(es).\n\n   [](#user-content-fnref-2)\n\n</page>\n\n<page>\n---\ntitle: Stale response for upstream DNS resolution  Cloudflare DNS docs\ndescription: In one of the scenarios below, you notice that stale DNS responses\n  are used. Depending on the scenario and other aspects of your configuration,\n  this can cause wrong content or no content to be returned.\nlastUpdated: 2025-04-10T11:00:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/stale-response/\n  md: https://developers.cloudflare.com/dns/manage-dns-records/troubleshooting/stale-response/index.md\n---\n\nIn one of the scenarios below, you notice that stale DNS responses are used. Depending on the scenario and other aspects of your configuration, this can cause wrong content or no content to be returned.\n\n* A proxied CNAME record ([flattened by default](https://developers.cloudflare.com/dns/cname-flattening/)).\n* A DNS-only CNAME record that has flattening enabled. This can happen either via the specific record configuration or as a consequence of the [zone settings](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/).\n* A [Workers](https://developers.cloudflare.com/workers/) script making a subrequest to an external hostname[1](#user-content-fn-1).\n\n## Cause\n\nIn the event that an upstream DNS server takes too long to respond, or the upstream returns a SERVFAIL, Cloudflare will use the expired DNS response from the cache and then attempt to update that cache asynchronously.\n\n## Solutions\n\n* If possible, temporarily replace the proxied CNAME with a proxied A record. This may not always be possible, especially if the upstream target is a load balancer or if it returns dynamic responses.\n\n* Report the issues to the zone owner or DNS provider for the upstream target that is unresponsive.\n\n* You can also raise the issue through the DNS Operations Analysis and Research Center (DNS OARC). Consider its [chat platform](https://www.dns-oarc.net/oarc/services/chat) or [email lists](https://www.dns-oarc.net/oarc/lists).\n\n## Footnotes\n\n1. A hostname that is not using Cloudflare as its [authoritative DNS provider](https://developers.cloudflare.com/dns/concepts/#authoritative-dns). [](#user-content-fnref-1)\n\n</page>\n\n<page>\n---\ntitle: Account custom nameservers  Cloudflare DNS docs\ndescription: With account-level custom nameservers, you can use the same custom\n  nameservers for different zones in the account. The domain or domains that\n  provide the nameservers names do not have to exist as zones in Cloudflare.\nlastUpdated: 2025-11-11T08:44:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/account-custom-nameservers/\n  md: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/account-custom-nameservers/index.md\n---\n\nAccount custom nameservers (ACNS) allow you to define account-level custom nameservers and use them for different zones within a Cloudflare account.\n\nACNS are organized in different sets (`ns_set`) and ACNS names can be provided by any domain, even if the domain does not exist as a zone in Cloudflare.\n\nFor instance, if the ACNS are `ns1.example.com` and `ns2.vanity.test`, the domains `example.com` and `vanity.test` are not required to be zones in Cloudflare.\n\n## Availability\n\nAccount custom nameservers are available for customers on Business (after [contacting Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/)) or Enterprise plans. Once configured, account custom nameservers can be used by all zones in the account, regardless of the zone plan. Via API or on the dashboard.\n\nNote\n\nThe advantages that come with Foundation DNS [advanced nameservers](https://developers.cloudflare.com/dns/foundation-dns/advanced-nameservers/) are currently not available for [custom nameservers](https://developers.cloudflare.com/dns/nameservers/custom-nameservers/). Make sure you only use one at a time.\n\n## Configuration conditions\n\nFor this configuration to be possible, a few conditions apply:\n\n* You can create up to five different account custom nameserver sets. Each nameserver set must have between two and five different nameserver names (`ns_name`), and each name cannot belong to more than one set. For example, if `ns1.example.com` is part of `ns_set 1` it cannot be part of `ns_set 2` or vice versa.\n* [Subdomain setup](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/) or [reverse zones](https://developers.cloudflare.com/dns/additional-options/reverse-zones/) can use account custom nameservers as long as they use a different nameserver set (`ns_set`) than their parent, child, or any other zone in their direct hierarchy tree.\n\nNote\n\nAccount owners that want to [use their own IP prefix](https://developers.cloudflare.com/byoip/) for the account custom nameservers should contact their account team.\n\n* Choosing a set from `ns_set 1` through `ns_set 5` will influence how Cloudflare assigns nameservers to your new zones if you configure [DNS zone defaults](https://developers.cloudflare.com/dns/nameservers/nameserver-options/#dns-zone-defaults).\n\n## Enable account custom nameservers\n\n### 1. Set up ACNS names and sets\n\n1. Create ACNS names and sets:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n  2. Go to **DNS Settings**.\n\n  3. For **Account custom nameservers**, select **Configure custom nameservers**.\n\n  4. Insert a fully qualified domain name for **Nameserver name** and choose a **Nameserver set**. Follow the [configuration conditions](#configuration-conditions).\n\n* API\n\n  Use the [Add account custom nameserver endpoint](https://developers.cloudflare.com/api/resources/custom_nameservers/methods/create/) to create account custom nameservers. Follow the [conditions](#configuration-conditions) for `ns_name` and `ns_set`.\n\n  Note\n\n  If the parameter `ns_set` is omitted, the default set `1` will be assigned.\n\nCloudflare will assign an IPv4 and an IPv6 address to each ACNS name, and these nameservers will be listed as options that you can [use on existing zones](#2-use-acns-on-existing-zones) or [set up as default for new zones in the account](#3-optional-make-acns-default-for-new-zones).\n\n1. Make sure `A/AAAA` records with the assigned IPv4 and IPv6 exist at the authoritative DNS of the domain that provides the ACNS names.\n\n   * If the domain uses Cloudflare DNS, the respective `A` and `AAAA` records are automatically created.\n\n   * If the domain or domains that are used for the account custom nameservers do not exist within the same account, you must manually create the `A/AAAA` records on the configured nameserver names (for example, `ns1.example.com`) at the authoritative DNS provider.\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `ns1.example.com` | `<IPv4>` |\n\n1. Update the registrar of the domain that provides the ACNS names. This step depends on whether you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/):\n\n   * If you are using Cloudflare Registrar for the domain that provides the ACNS names, [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to add the account custom nameservers and IP addresses as glue records to the domain.\n\n   * If you are not using Cloudflare Registrar for the domain that provides the ACNS names, add the account custom nameservers and IP addresses to your domain's registrar as glue records ([RFC 1912](https://www.rfc-editor.org/rfc/rfc1912.html)). If you do not add these records, DNS lookups for your domain will fail.\n\n### 2. Use ACNS on existing zones\n\n1. Choose an ACNS set as custom nameservers for a zone:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. For **Custom nameservers**, select **Configure**.\n\n  3. Select **Use your account custom nameservers** and choose a nameserver set from the list.\n\n  4. Select **Save** to confirm.\n\n* API\n\n  Use the endpoint [Update DNS Settings for a Zone](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) and configure the `nameservers` object accordingly for each zone.\n\n1. Make sure the nameservers are updated:\n\n* If your domain uses [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to update your nameservers.\n* If your domain uses a different registrar, update the nameservers at your registrar to use the account custom nameservers.\n* If your zone is delegated to a parent zone, update the corresponding `NS` record at the parent zone.\n\n### 3. (Optional) Make ACNS default for new zones\n\nTo make ACNS the default option for all new zones added to your account from now on:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n  2. Go to **DNS Settings**.\n\n  3. For **DNS zone defaults**, select **Configure defaults**.\n\n  4. Change the **Nameserver assignment method** to **Account custom nameservers**.\n\n  Refer to [DNS zone defaults](https://developers.cloudflare.com/dns/nameservers/nameserver-options/#dns-zone-defaults) for details.\n\n* API\n\n  Use the endpoint [Update DNS Settings for an Account](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/account/methods/edit/). Within the `zone_defaults` object, set the following:",
      "language": "unknown"
    },
    {
      "code": "## Disable account custom nameservers\n\n### 1. Remove ACNS assignment from zones\n\nTo remove ACNS from a zone, first update your nameservers to stop using ACNS:\n\n* Dashboard\n\n  * If you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to set your nameservers back to the regular Cloudflare branded nameservers.\n  * If you are not using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), modify the domain's registrar to use your regular Cloudflare branded nameservers.\n\n* API\n\n  * If you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), use the [Update DNS settings endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) to set the `type` parameter in the `nameservers` object to `\"cloudflare.standard\"`. Then, [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to set your nameservers back to the regular Cloudflare branded nameservers.\n  * If you are not using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), modify the domain's registrar to use your regular Cloudflare branded nameservers and then use the [Update DNS settings endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) to set the `type` parameter in the `nameservers` object to `\"cloudflare.standard\"`.\n\n### 2. Delete ACNS names or sets\n\nFollowing the [configuration conditions](#configuration-conditions), each set must have between two and five different nameserver names. When you delete all names or leave a set with only one nameserver name, the set will no longer be listed as an option for the zones in your account.\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n  2. Go to **DNS Settings**.\n\n  3. For **Account custom nameservers**, select **Delete** next to the ACNS name.\n\n* API\n\n  Use the [Delete account custom nameserver endpoint](https://developers.cloudflare.com/api/resources/custom_nameservers/methods/delete/) to delete a specific ACNS.\n\n</page>\n\n<page>\n---\ntitle: Tenant custom nameservers  Cloudflare DNS docs\ndescription: With tenant-level custom nameservers, you can use the same custom\n  nameservers for different zones and across different accounts, as long as the\n  accounts are part of the [tenant](/tenant/). The domain or domains that\n  provide the nameservers names do not have to exist as zones in Cloudflare.\nlastUpdated: 2025-11-21T12:02:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/tenant-custom-nameservers/\n  md: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/tenant-custom-nameservers/index.md\n---\n\nTenant custom nameservers (TCNS) allow you to define tenant-level custom nameservers and use them for different accounts within a Cloudflare tenant.\n\nTCNS are organized in different sets (`ns_set`) and TCNS names can be provided by any domain, even if the domain does not exist as a zone in Cloudflare.\n\nFor instance, if the TCNS are `ns1.example.com` and `ns2.vanity.test`, the domains `example.com` and `vanity.test` are not required to be zones in Cloudflare.\n\n## Availability\n\nTenant custom nameservers, if created by the tenant owner, will be available to all zones belonging to any account that is part of the tenant. Via API only.\n\n## Configuration conditions\n\nFor this configuration to be possible, a few conditions apply:\n\n* Tenant owners can create up to five different tenant custom nameserver sets. Each nameserver set must have between two and five different nameserver names (`ns_name`), and each name cannot belong to more than one set. For example, if `ns1.example.com` is part of `ns_set 1` it cannot be part of `ns_set 2` or vice versa.\n* [Subdomain setup](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/) or [reverse zones](https://developers.cloudflare.com/dns/additional-options/reverse-zones/) can use tenant custom nameservers as long as they use a different nameserver set (`ns_set`) than their parent, child, or any other zone in their direct hierarchy tree.\n\nNote\n\nTenant owners that want to [use their own IP prefix](https://developers.cloudflare.com/byoip/) for the tenant custom nameservers should contact their account team.\n\n## For account owners\n\n### Enable tenant custom nameservers on a zone\n\nIf you are an account owner and your account is part of a tenant that has custom nameservers, do the following:\n\n1. Use the endpoint [Update DNS Settings for a Zone](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) and configure the `nameservers` object accordingly.",
      "language": "unknown"
    },
    {
      "code": "Note\n\n   If the parameter `ns_set` is omitted, the default set `1` will be assigned.\n\n2. If you are **not** using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), update the nameservers at your registrar to use the TCNS names. If you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), no further action is needed.\n\nTo make these TCNS the default namerservers for all new zones added to your account from now on, use the endpoint [Update DNS Settings for an Account](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/account/methods/edit/). Within the `zone_defaults` object, set the following:",
      "language": "unknown"
    },
    {
      "code": "### Disable tenant custom nameservers on a zone\n\n* If you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/), use the [Update DNS settings endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) to set the `type` parameter in the `nameservers` object to a different value. Then, [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to set your nameservers back to the nameservers you chose to use.\n\n* If you are not using Cloudflare Registrar, use the [Update DNS settings endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) to choose a different nameserver type, and also remove the TCNS at your domain's registrar.\n\n## For tenant owners\n\n### Create tenant custom nameservers\n\nIf you are a tenant owner and you want to make TCNS available for accounts within your tenant, do the following:\n\n1. Observe the [conditions](#configuration-conditions) for `ns_name` and `ns_set`, and create TCNS in your tenant by using the following POST command:",
      "language": "unknown"
    },
    {
      "code": "Note\n\nIf the parameter `ns_set` is omitted, the default set `1` will be assigned.\n\n1. Add the account custom nameservers and IP addresses to your domain's registrar as glue (A and AAAA) records ([RFC 1912](https://www.rfc-editor.org/rfc/rfc1912.html)).\n\n2. If the domain or domains that are used for the tenant custom nameservers do not exist within the same account, you must create the `A/AAAA` records on the configured nameserver names (for example, `ns1.example.com`) at the authoritative DNS provider.\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `ns1.example.com` | `<IPv4>` |\n\n### Get a list of all TCNS names\n\nTo get a list of all TCNS names in your tenant account, use the following API request:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Zone custom nameservers  Cloudflare DNS docs\ndescription: With zone-level custom nameservers, each custom nameserver name\n  must be a subdomain of the zone where the custom nameservers are configured.\n  These custom nameservers can only be used within the respective zone.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/zone-custom-nameservers/\n  md: https://developers.cloudflare.com/dns/nameservers/custom-nameservers/zone-custom-nameservers/index.md\n---\n\nWith zone custom nameservers (ZCNS), each custom nameserver name must be a subdomain of the zone where the custom nameservers are configured.\n\nFor example, for a zone `domain.test`, the ZCNS can be `ns1.domain.test` and `ns2.domain.test` but they cannot use a different TLD (`ns1.domain.org`) nor a different domain (`ns1.example.com`).\n\n## Availability\n\nZone custom nameservers are available for zones on Business or Enterprise plans. Via API or on the dashboard.\n\n## Use zone custom nameservers\n\n### Primary (full setup) zones\n\nTo create zone custom nameservers:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. On **Custom nameservers**, select **Configure**.\n\n  3. Select **Create custom nameservers just for `your-domain.com`** and enter the subdomains used for the ZCNS names (for example, `ns1`, `ns2`, `ns3`).\n\n  4. Select **Save** to confirm.\n\n* API\n\n  Use the [Edit zone endpoint](https://developers.cloudflare.com/api/resources/zones/methods/edit/) and specify the custom nameservers in the payload:",
      "language": "unknown"
    },
    {
      "code": "Cloudflare will assign an IPv4 and an IPv6 address to each ZCNS name and automatically create the associated `A` or `AAAA` records.\n\nThe next step depends on whether you are using [Cloudflare Registrar](https://developers.cloudflare.com/registrar/) for your domain:\n\n* If you are using Cloudflare Registrar for your domain, [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) to add the custom nameservers and IP addresses as glue records to the domain.\n* If you are not using Cloudflare Registrar for your domain, add the zone custom nameservers at your registrar as your authoritative nameservers and as glue (A and AAAA) records ([RFC 1912](https://www.rfc-editor.org/rfc/rfc1912.html)). If you do not add these records, DNS lookups for your domain will fail.\n\n### Secondary zones\n\nIf you are using [Cloudflare as a secondary DNS provider](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/), you can still set up zone custom nameservers. After following the [steps above](https://developers.cloudflare.com/dns/nameservers/custom-nameservers/zone-custom-nameservers/#primary-full-setup-zones) to create zone custom nameservers, do the following:\n\n1. Get the ZCNS IPs. You can find them on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page or you can use the [Zone details endpoint](https://developers.cloudflare.com/api/resources/zones/methods/get/) to get the `vanity_name_servers_ips`.\n2. At your primary DNS provider, add [`NS` records](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ns) and, on the subdomains that you used as ZCNS names, add `A/AAAA` records.\n3. At your registrar, add the zone custom nameservers as your authoritative nameservers and as glue (A and AAAA) records ([RFC 1912](https://www.rfc-editor.org/rfc/rfc1912.html)).\n\n## Remove zone custom nameservers\n\nTo remove zone custom nameservers (and their associated, read-only DNS records):\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n     [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n  2. On **Custom nameservers**, select **Disable**.\n\n* API\n\n  Use the [Edit zone endpoint](https://developers.cloudflare.com/api/resources/zones/methods/edit/) and include an empty array in the payload:",
      "language": "unknown"
    },
    {
      "code": "Cloudflare will remove your ZCNS and their associated read-only `A` or `AAAA` records.\n\nIf you are not using Cloudflare Registrar for your domain, make sure to adjust your nameservers at the registrar, parent zone, or Primary DNS provider accordingly.\n\n</page>\n\n<page>\n---\ntitle: Convert full setup to partial setup  Cloudflare DNS docs\ndescription: If you initially configured a full setup, you can later convert\n  your zone to use a partial setup (also known as CNAME setup).\nlastUpdated: 2025-11-21T10:02:30.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-full-to-partial/\n  md: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-full-to-partial/index.md\n---\n\nIf you initially configured a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/), you can later convert your zone to use a partial setup (also known as CNAME setup).\n\nA partial setup allows you to use [Cloudflare's reverse proxy](https://developers.cloudflare.com/fundamentals/concepts/how-cloudflare-works/) on individual subdomains while using a different authoritative DNS provider.\n\n## Before you begin\n\nMake sure you consider the following:\n\n* It will not be possible to use Cloudflare's reverse proxy on the zone apex (`example.com`), only on subdomains.\n* On the dashboard, you will only be able to create A, AAAA, and CNAME records, which are the DNS record types that can be [proxied](https://developers.cloudflare.com/dns/proxy-status/).\n* You should plan for SSL/TLS certificates. If you are only using [Universal SSL](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) prior to converting your zone, a certificate will be provisioned for your subdomains only after each of the respective DNS records are proxied. If your domain is sensitive to downtime, instead of using Universal SSL, consider using an [advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) with [delegated DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/delegated-dcv/#setup).\n\n## 1. Prepare DNS records\n\n1. Export a zone file\n\n   * Dashboard\n\n     To export records using the dashboard:\n\n     1. In the Cloudflare dashboard, go to the **DNS Records** page.\n\n        [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n     2. Select **Import and Export**.\n\n     3. Select **Export**.\n\n   * API\n\n     To export records using the API, send a [GET request](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/export/).\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `DNS Read`\n     * `DNS Write`",
      "language": "unknown"
    },
    {
      "code": "2. Import the zone file into your new primary DNS provider.\n\n3. Create or update your records so that you have CNAME records pointing to `{your-hostname}.cdn.cloudflare.net` for every hostname you wish to proxy through Cloudflare.\n\n   Example CNAME record at authoritative DNS provider\n\n   The CNAME record for `www.example.com` would be:",
      "language": "unknown"
    },
    {
      "code": "4. Remove any previously existing A, AAAA, or CNAME records referencing the hostnames you want to proxy through Cloudflare. For these hostnames, leave only the records pointing to `{your-hostname}.cdn.cloudflare.net`.\n\n5. Confirm you have the correct record for every subdomain that should be proxied through Cloudflare.\n\n## 2. Convert the zone\n\n* Dashboard\n\n  1. On the Cloudflare dashboard, go to the zone's **Overview** page.\n  2. Select **Convert to CNAME DNS Setup** and then **Convert** to confirm.\n  3. Save the information from the **Verification TXT Record**. If you lose the information, you can also access it on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, under **Verification TXT Record**.\n\n* API\n\n  1. Use the [Edit Zone endpoint](https://developers.cloudflare.com/api/resources/zones/methods/edit/) with `type` set to `partial` to convert the zone type.\n  2. Take note of the value returned under `verification_key` in the API response. This will be used in the next step.\n\n## 3. Verify ownership\n\nAdd the **Verification TXT Record** at your authoritative DNS provider. Cloudflare will verify the TXT record and send a confirmation email. This can take up to a few hours.\n\nExample verification record\n\nA verification record for `example.com` might be:\n\n| Type | Name | Content |\n| - | - | - |\n| TXT | `cloudflare-verify.example.com` | 966215192-518620144 |\n\nNote\n\nIf your authoritative DNS provider automatically appends DNS record `name` fields with your domain, make sure to only insert `cloudflare-verify` as the record name. Otherwise, it may result in an incorrect record name, such as `cloudflare-verify.example.com.example.com`.\n\nAfter creating the record, you can use this [Dig Web Interface link](https://digwebinterface.com/?type=TXT\\&ns=auth\\&nameservers=) to search (`dig`) for `cloudflare-verify.<YOUR DOMAIN>` and validate if it is working.\n\nThe verification record must remain in place for as long as your domain is active on the partial setup on Cloudflare.\n\nIf your organization has multiple Cloudflare accounts, also consider using zone holds to have more control over [domain ownership](https://developers.cloudflare.com/dns/zone-setups/partial-setup/#domain-ownership).\n\n## 4. Update your nameservers\n\nOnce verification is complete, update the nameservers at your domain registrar to point to your new authoritative DNS provider. Make sure to remove the Cloudflare nameservers.\n\n</page>\n\n<page>\n---\ntitle: Convert full setup to secondary setup  Cloudflare DNS docs\ndescription: If you initially configured a full setup you can later convert your\n  zone to use incoming zone transfers (Cloudflare as secondary).\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-full-to-secondary/\n  md: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-full-to-secondary/index.md\n---\n\nIf you initially configured a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/), you can later convert your zone to use [incoming zone transfers (Cloudflare as secondary)](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/).\n\nSubdomain setup\n\nIf you also use subdomain setup[1](#user-content-fn-1), consider the [available combinations](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/#available-setups) and whether your zone conversion could have any implications.\n\n## Footnotes\n\n1. Meaning you have one or more subdomains (`sub.example.com`) added to Cloudflare as their own zone, separate from your apex domain (`example.com`). [](#user-content-fnref-1)\n\nFollow the steps below to achieve this conversion.\n\n## 1. Prepare DNS records\n\n1. [Export a zone file](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#export-records).\n\n2. Import the zone file into your new primary DNS provider.\n\n3. At your Cloudflare zone, use the [Update DNS Settings](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) endpoint to enable [secondary DNS overrides](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/). Set the value for `secondary_overrides` to `true`.\n\n   Note\n\n   Enabling secondary DNS overrides is necessary in case you have DNS records that you wish to keep [proxied](https://developers.cloudflare.com/dns/proxy-status/).\n\n## 2. Prepare the zone transfers\n\n1. Make adjustments to DNSSEC according to your option for [DNSSEC with secondary setup](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/).\n\n2. (Optional) Create a Transaction Signature (TSIG).\n\n   A Transaction Signature (TSIG) authenticates communication between a primary and secondary DNS server.\n\n   Note\n\n   The TSIG names configured at your primary and secondary DNS providers have to be exactly the same. Any differences in TSIG names will cause zone transfers to fail.\n\n   While optional, this step is highly recommended.\n\n   * Dashboard\n\n     To create a TSIG using the dashboard:\n\n     1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n        [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n     2. Go to **DNS Settings**.\n\n     3. Under **DNS Zone Transfers**, for **TSIG**, select **Create**.\n\n     4. Enter the following information:\n\n        * **TSIG name**: The name of the TSIG object using domain name syntax (more details in [RFC 8945 section 4.2](https://datatracker.ietf.org/doc/html/rfc8945#section-4.2)).\n        * **Secret (optional)**: Get a shared secret to add to your third-party nameservers. If left blank, this field generates a random secret.\n        * **Algorithm**: Choose a TSIG signing algorithm.\n\n     5. Select **Create**.\n\n   * API\n\n     To create a TSIG using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/tsigs/methods/create/) request.\n\n3. Create a peer server.\n\n   * Dashboard\n\n     To create a peer server using the dashboard:\n\n     1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n        [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n     2. Go to **DNS Settings**.\n\n     3. Under **DNS Zone Transfers**, for **Peer DNS servers**, select **Create**.\n\n     4. Enter the following information, paying particular attention to:\n\n        * **IP**: Specifies where Cloudflare sends transfer requests to.\n        * **Port**: Specifies the IP Port for the transfer IP.\n        * **Enable incremental (IXFR) zone transfers**: Specifies if Cloudflare sends IXFR requests in addition to the default AXFR requests.\n        * **Link an existing TSIG**: If desired, link the TSIG you [previously created](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/#1-create-tsig-optional).\n\n     5. Select **Create**.\n\n   * API\n\n     To create a peer DNS server using the API, send a [POST request](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/peers/).\n\n## 3. Convert the zone and initiate zone transfers\n\n1. Use the [Edit Zone endpoint](https://developers.cloudflare.com/api/resources/zones/methods/edit/) with `type` set to `secondary` to convert the zone type. The existing records will remain in place.\n\n2. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n3. Select **Manage linked peers** under **DNS Zone Transfers**.\n\n4. Link the peer server you created in the previous steps and select **Save**.\n\n5. Back to the the [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) page, select **Initiate zone transfer**.\n\n6. Confirm the DNS records are transferring as expected.\n\n7. Go to the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page and take note of your new **Cloudflare Nameservers**.\n\n8. At your domain registrar (or parent zone), [update your nameservers](https://developers.cloudflare.com/dns/nameservers/update-nameservers/) to include the `secondary.cloudflare.com` nameservers.\n\n</page>\n\n<page>\n---\ntitle: Convert partial setup to full setup  Cloudflare DNS docs\ndescription: If you initially set up a partial domain on Cloudflare, you can\n  later migrate it to a full setup.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-partial-to-full/\n  md: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-partial-to-full/index.md\n---\n\nIf you initially set up a partial domain on Cloudflare, you can later migrate it to a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/).\n\nSubdomain setup\n\nIf you also use subdomain setup[1](#user-content-fn-1), consider the [available combinations](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/#available-setups) and whether your zone conversion could have any implications.\n\n## Footnotes\n\n1. Meaning you have one or more subdomains (`sub.example.com`) added to Cloudflare as their own zone, separate from your apex domain (`example.com`). [](#user-content-fnref-1)\n\n## 1. Prepare Cloudflare SSL/TLS\n\nIn the Cloudflare dashboard, either order an [advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/) or [upload a custom SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/) for your website or application.\n\nYou should also verify that the [status](https://developers.cloudflare.com/ssl/reference/certificate-statuses/) of your SSL certificate is **Active**.\n\nNote\n\nIt is possible to use [Universal SSL](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) instead, but you should consider the following:\n\n* Universal certificates can take at least [15 minutes](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/enable-universal-ssl/#full-dns-setup) to be issued.\n* You should make sure to add Cloudflare nameservers to your registrar within 72 hours of the conversion process.\n* Universal SSL only supports first-level subdomains. You can use [Advanced certificates](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) with the [Total TLS](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/) option to automatically issue certificates for any proxied hostname.\n* To minimize downtime, it is recommended having a certificate in place beforehand.\n\n## 2. Update settings in authoritative DNS\n\nAt least 24 hours prior to converting your zone, disable DNSSEC at your authoritative DNS provider.\n\nNote\n\nAs a best practice, you should also delete the previous [zone activation TXT record](https://developers.cloudflare.com/dns/zone-setups/partial-setup/setup/#1-convert-your-zone-and-review-dns-records) at your authoritative DNS provider. To locate this value in the Cloudflare dashboard, go to the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page and find the **Verification TXT Record**.\n\n## 3. Convert to full setup\n\nIn the Cloudflare dashboard:\n\n1. In the Cloudflare dashboard, select your partial zone and go to the **DNS Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. Select **Convert to Primary DNS** (this will not affect how your traffic is proxied).\n\n3. Import your records into Cloudflare DNS and verify that they have been configured correctly. Usually, you will want to import [unproxied records](https://developers.cloudflare.com/dns/proxy-status/).\n\n## 4. Activate full setup\n\nGet your assigned Cloudflare nameservers from the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page and [update your nameservers](https://developers.cloudflare.com/dns/nameservers/update-nameservers/) at your registrar.\n\nWarning\n\nIf you are counting on Universal SSL certificates to cover your website or application, make sure to add Cloudflare nameservers to your registrar within 72 hours of the conversion process.\n\nCloudflare recommends that you also [enable DNSSEC](https://developers.cloudflare.com/dns/dnssec/) from the [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) page and add the DS record to your registrar.\n\nOnce all the DNS TTLs expire, all your DNS queries will be answered by the Cloudflare global network.\n\nStart proxying additional hostnames by enabling the [proxy status](https://developers.cloudflare.com/dns/proxy-status/) (also known as orange-clouding) for specific DNS records. Previously proxied subdomains will continue to be proxied without any interruption.\n\n</page>\n\n<page>\n---\ntitle: Convert partial setup to secondary setup  Cloudflare DNS docs\ndescription: If you initially set up a partial zone on Cloudflare, you can later\n  convert it to use a secondary setup.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-partial-to-secondary/\n  md: https://developers.cloudflare.com/dns/zone-setups/conversions/convert-partial-to-secondary/index.md\n---\n\nIf you initially set up a [partial zone](https://developers.cloudflare.com/dns/zone-setups/partial-setup/) on Cloudflare, you can later convert it to use a [secondary setup](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/).\n\nSubdomain setup\n\nIf you also use subdomain setup[1](#user-content-fn-1), consider the [available combinations](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/#available-setups) and whether your zone conversion could have any implications.\n\n## Footnotes\n\n1. Meaning you have one or more subdomains (`sub.example.com`) added to Cloudflare as their own zone, separate from your apex domain (`example.com`). [](#user-content-fnref-1)\n\nThis page will guide you through this conversion using [export and import](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/) and API calls.\n\n## Before you begin\n\nMake sure you consider the following:\n\n* Proxying traffic with secondary zones requires a setting that is not turned on by default. Refer to [Secondary DNS override](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/) to learn more. The steps below include enabling this setting.\n* There are a few options for [DNSSEC with incoming zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/). If you want to use DNSSEC, plan for which option you will configure and confirm that your other DNS provider(s) support the setup.\n* You can prepare SSL/TLS in advance by either ordering an [advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/) or [uploading a custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/). You should confirm that the certificate covers all your proxied hostnames and that the [status of your SSL certificate](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) is **Active**.\n\n## 1. Prepare a zone file\n\n1. Export a zone file from the authoritative DNS provider you were using with your partial (CNAME) setup.\n2. Edit the zone file to remove any occurrences of the `cdn.cloudflare.net` suffix.\n\n* If the `CNAME` target is only appending the Cloudflare suffix to the same hostname at which it is created, replace it by the records on the Cloudflare partial zone.\n\nExample\n\nOriginal record in authoritative DNS provider:\n\n| Type | Name | Content |\n| - | - | - |\n| `CNAME` | `www.example.com` | `www.example.com.cdn.cloudflare.net` |\n\nRecords in the Cloudflare partial zone:\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `www.example.com` | `<IPv4>` |\n| `A` | `www.example.com` | `<IPv4>` |\n\nFinal records adjusted in the zone file:\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `www.example.com` | `<IPv4>` |\n| `A` | `www.example.com` | `<IPv4>` |\n\n* If the `CNAME` record points to a different hostname, keep this record but remove the `cdn.cloudflare.net` suffix, and also bring the records from the Cloudflare partial zone.\n\nExample\n\nOriginal record in authoritative DNS provider:\n\n| Type | Name | Content |\n| - | - | - |\n| `CNAME` | `www.example.com` | `other-hostname.example.com.cdn.cloudflare.net` |\n\nRecords in the Cloudflare partial zone:\n\n| Type | Name | Content |\n| - | - | - |\n| `A` | `other-hostname.example.com` | `<IPv4>` |\n| `A` | `other-hostname.example.com` | `<IPv4>` |\n\nFinal records adjusted in the zone file:\n\n| Type | Name | Content |\n| - | - | - |\n| `CNAME` | `www.example.com` | `other-hostname.example.com` |\n| `A` | `other-hostname.example.com` | `<IPv4>` |\n| `A` | `other-hostname.example.com` | `<IPv4>` |\n\n## 2. Configure the Cloudflare zone\n\n1. Use the [Import DNS Records endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/import/) with a properly [formatted zone file](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#format-your-zone-file) to import the records into your partial zone.\n\n   The zone file size limit is 256 KiB (262144 bytes).\n\n   Existing and already proxied records will not be overwritten by the import.\n\n2. Use the [Update DNS Settings endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/settings/subresources/zone/methods/edit/) with `secondary_overrides` set to `true`, to enable Secondary DNS Override.\n\nWarning\n\nThis step is essential so that Cloudflare can keep the proxy status of the records after the conversion.\n\n1. Use the [Edit Zone endpoint](https://developers.cloudflare.com/api/resources/zones/methods/edit/) with `type` set to `secondary`, to convert the zone type.\n\n   You can verify if it answers as expected by querying the new assigned secondary nameservers. You can find your nameservers on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, and they should follow a format like `ns0123.secondary.cloudflare.com`.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Set Browser Cache TTL",
      "id": "set-browser-cache-ttl"
    },
    {
      "level": "h2",
      "text": "Resulting cache status",
      "id": "resulting-cache-status"
    },
    {
      "level": "h2",
      "text": "Resulting cache status",
      "id": "resulting-cache-status"
    },
    {
      "level": "h2",
      "text": "General workflow for cache-tags",
      "id": "general-workflow-for-cache-tags"
    },
    {
      "level": "h2",
      "text": "Add Cache-Tag HTTP response headers",
      "id": "add-cache-tag-http-response-headers"
    },
    {
      "level": "h2",
      "text": "A few things to remember",
      "id": "a-few-things-to-remember"
    },
    {
      "level": "h2",
      "text": "Purge using cache-tags",
      "id": "purge-using-cache-tags"
    },
    {
      "level": "h2",
      "text": "Resulting cache status",
      "id": "resulting-cache-status"
    },
    {
      "level": "h2",
      "text": "Purge by device type",
      "id": "purge-by-device-type"
    },
    {
      "level": "h2",
      "text": "Purge by geo",
      "id": "purge-by-geo"
    },
    {
      "level": "h2",
      "text": "Purge by language",
      "id": "purge-by-language"
    },
    {
      "level": "h2",
      "text": "Resulting cache status",
      "id": "resulting-cache-status"
    },
    {
      "level": "h2",
      "text": "Step 1: Retrieve the environment ID",
      "id": "step-1:-retrieve-the-environment-id"
    },
    {
      "level": "h2",
      "text": "Step 2: Purge cache per environment",
      "id": "step-2:-purge-cache-per-environment"
    },
    {
      "level": "h2",
      "text": "Resulting cache status",
      "id": "resulting-cache-status"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Purge by prefix normalization",
      "id": "purge-by-prefix-normalization"
    },
    {
      "level": "h3",
      "text": "How does URL Normalization work",
      "id": "how-does-url-normalization-work"
    },
    {
      "level": "h2",
      "text": "Multi-language support",
      "id": "multi-language-support"
    },
    {
      "level": "h2",
      "text": "Favicon customization",
      "id": "favicon-customization"
    },
    {
      "level": "h2",
      "text": "Custom Content Security Policy (CSP) and error pages",
      "id": "custom-content-security-policy-(csp)-and-error-pages"
    },
    {
      "level": "h3",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h3",
      "text": "Customize the Challenge Passage",
      "id": "customize-the-challenge-passage"
    },
    {
      "level": "h3",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Hostnames over 64 characters",
      "id": "hostnames-over-64-characters"
    },
    {
      "level": "h2",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h2",
      "text": "Submitting custom metadata",
      "id": "submitting-custom-metadata"
    },
    {
      "level": "h2",
      "text": "Accessing custom metadata from a Cloudflare Worker",
      "id": "accessing-custom-metadata-from-a-cloudflare-worker"
    },
    {
      "level": "h2",
      "text": "Accessing custom metadata in a rule expression",
      "id": "accessing-custom-metadata-in-a-rule-expression"
    },
    {
      "level": "h2",
      "text": "Best practices",
      "id": "best-practices"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Terraform support",
      "id": "terraform-support"
    },
    {
      "level": "h2",
      "text": "Options",
      "id": "options"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "CNAME",
      "id": "cname"
    },
    {
      "level": "h2",
      "text": "A record",
      "id": "a-record"
    },
    {
      "level": "h2",
      "text": "Wildcard certificate",
      "id": "wildcard-certificate"
    },
    {
      "level": "h2",
      "text": "Domains using Cloudflare",
      "id": "domains-using-cloudflare"
    },
    {
      "level": "h2",
      "text": "Domains not using Cloudflare",
      "id": "domains-not-using-cloudflare"
    },
    {
      "level": "h2",
      "text": "For end customers",
      "id": "for-end-customers"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable Early Hints per custom hostname via the API",
      "id": "enable-early-hints-per-custom-hostname-via-the-api"
    },
    {
      "level": "h2",
      "text": "Host header",
      "id": "host-header"
    },
    {
      "level": "h2",
      "text": "SNI",
      "id": "sni"
    },
    {
      "level": "h2",
      "text": "Rate limits",
      "id": "rate-limits"
    },
    {
      "level": "h2",
      "text": "Purge cache",
      "id": "purge-cache"
    },
    {
      "level": "h2",
      "text": "Resolution error 1016 (Origin DNS error) when accessing the custom hostname",
      "id": "resolution-error-1016-(origin-dns-error)-when-accessing-the-custom-hostname"
    },
    {
      "level": "h2",
      "text": "Custom hostname in Moved status",
      "id": "custom-hostname-in-moved-status"
    },
    {
      "level": "h2",
      "text": "CAA Errors",
      "id": "caa-errors"
    },
    {
      "level": "h2",
      "text": "Custom hostname matches zone name (403 Forbidden)",
      "id": "custom-hostname-matches-zone-name-(403-forbidden)"
    },
    {
      "level": "h2",
      "text": "Older devices have issues connecting",
      "id": "older-devices-have-issues-connecting"
    },
    {
      "level": "h2",
      "text": "Custom hostname fails to verify because the zone is held",
      "id": "custom-hostname-fails-to-verify-because-the-zone-is-held"
    },
    {
      "level": "h2",
      "text": "Hostnames over 64 characters",
      "id": "hostnames-over-64-characters"
    },
    {
      "level": "h2",
      "text": "Why is SSL for SaaS changing?",
      "id": "why-is-ssl-for-saas-changing?"
    },
    {
      "level": "h2",
      "text": "What action is needed?",
      "id": "what-action-is-needed?"
    },
    {
      "level": "h3",
      "text": "Recommended validation methods",
      "id": "recommended-validation-methods"
    },
    {
      "level": "h3",
      "text": "Other validation methods",
      "id": "other-validation-methods"
    },
    {
      "level": "h2",
      "text": "If you are using BYOIP or Apex Proxying:",
      "id": "if-you-are-using-byoip-or-apex-proxying:"
    },
    {
      "level": "h2",
      "text": "What is available in the new version of SSL for SaaS?",
      "id": "what-is-available-in-the-new-version-of-ssl-for-saas?"
    },
    {
      "level": "h2",
      "text": "What happens during the migration?",
      "id": "what-happens-during-the-migration?"
    },
    {
      "level": "h3",
      "text": "Before the migration",
      "id": "before-the-migration"
    },
    {
      "level": "h2",
      "text": "During the migration",
      "id": "during-the-migration"
    },
    {
      "level": "h2",
      "text": "When is the migration?",
      "id": "when-is-the-migration?"
    },
    {
      "level": "h2",
      "text": "What if I have additional questions?",
      "id": "what-if-i-have-additional-questions?"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "With O2O",
      "id": "with-o2o"
    },
    {
      "level": "h2",
      "text": "Without O2O",
      "id": "without-o2o"
    },
    {
      "level": "h2",
      "text": "Resources",
      "id": "resources"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Associate custom metadata to a custom hostname",
      "id": "1.-associate-custom-metadata-to-a-custom-hostname"
    },
    {
      "level": "h2",
      "text": "2. Trigger security products based on tags",
      "id": "2.-trigger-security-products-based-on-tags"
    },
    {
      "level": "h2",
      "text": "Custom hostnames",
      "id": "custom-hostnames"
    },
    {
      "level": "h2",
      "text": "Fallback origins",
      "id": "fallback-origins"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Initial setup",
      "id": "initial-setup"
    },
    {
      "level": "h3",
      "text": "1. Create fallback origin",
      "id": "1.-create-fallback-origin"
    },
    {
      "level": "h3",
      "text": "2. (Optional) Create CNAME target",
      "id": "2.-(optional)-create-cname-target"
    },
    {
      "level": "h2",
      "text": "Per-hostname setup",
      "id": "per-hostname-setup"
    },
    {
      "level": "h3",
      "text": "1. Plan for validation",
      "id": "1.-plan-for-validation"
    },
    {
      "level": "h3",
      "text": "2. Create custom hostname",
      "id": "2.-create-custom-hostname"
    },
    {
      "level": "h3",
      "text": "3. Have customer create CNAME record",
      "id": "3.-have-customer-create-cname-record"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Adding a KV Namespace to a User Worker",
      "id": "adding-a-kv-namespace-to-a-user-worker"
    },
    {
      "level": "h3",
      "text": "1. Create a KV namespace",
      "id": "1.-create-a-kv-namespace"
    },
    {
      "level": "h3",
      "text": "2. Attach the KV namespace to the User Worker",
      "id": "2.-attach-the-kv-namespace-to-the-user-worker"
    },
    {
      "level": "h2",
      "text": "Set Custom limits",
      "id": "set-custom-limits"
    },
    {
      "level": "h3",
      "text": "Configure the dispatch namespace binding",
      "id": "configure-the-dispatch-namespace-binding"
    },
    {
      "level": "h3",
      "text": "Routing examples",
      "id": "routing-examples"
    },
    {
      "level": "h3",
      "text": "Enforce custom limits",
      "id": "enforce-custom-limits"
    },
    {
      "level": "h2",
      "text": "(Recommended) Wildcard route with a dispatch Worker",
      "id": "(recommended)-wildcard-route-with-a-dispatch-worker"
    },
    {
      "level": "h3",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h2",
      "text": "Subdomain routing",
      "id": "subdomain-routing"
    },
    {
      "level": "h3",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h3",
      "text": "Orange-to-Orange (o2o) Behavior",
      "id": "orange-to-orange-(o2o)-behavior"
    },
    {
      "level": "h2",
      "text": "Logs",
      "id": "logs"
    },
    {
      "level": "h3",
      "text": "Workers Trace Events Logpush",
      "id": "workers-trace-events-logpush"
    },
    {
      "level": "h3",
      "text": "Tail Workers",
      "id": "tail-workers"
    },
    {
      "level": "h2",
      "text": "Analytics",
      "id": "analytics"
    },
    {
      "level": "h3",
      "text": "Workers Analytics Engine",
      "id": "workers-analytics-engine"
    },
    {
      "level": "h3",
      "text": "GraphQL Analytics API",
      "id": "graphql-analytics-api"
    },
    {
      "level": "h2",
      "text": "General Use Cases",
      "id": "general-use-cases"
    },
    {
      "level": "h2",
      "text": "Use Outbound Workers",
      "id": "use-outbound-workers"
    },
    {
      "level": "h3",
      "text": "What you can build",
      "id": "what-you-can-build"
    },
    {
      "level": "h3",
      "text": "Benefits",
      "id": "benefits"
    },
    {
      "level": "h2",
      "text": "Deploy static assets to User Workers",
      "id": "deploy-static-assets-to-user-workers"
    },
    {
      "level": "h3",
      "text": "1. Create an Upload Session",
      "id": "1.-create-an-upload-session"
    },
    {
      "level": "h3",
      "text": "2. Upload File Contents",
      "id": "2.-upload-file-contents"
    },
    {
      "level": "h3",
      "text": "3. Deploy the User Worker with static assets",
      "id": "3.-deploy-the-user-worker-with-static-assets"
    },
    {
      "level": "h2",
      "text": "Deploying static assets with Wrangler",
      "id": "deploying-static-assets-with-wrangler"
    },
    {
      "level": "h3",
      "text": "1. Organize your files",
      "id": "1.-organize-your-files"
    },
    {
      "level": "h3",
      "text": "2. Deploy the User Worker with the static assets",
      "id": "2.-deploy-the-user-worker-with-the-static-assets"
    },
    {
      "level": "h2",
      "text": "Add tags via dashboard",
      "id": "add-tags-via-dashboard"
    },
    {
      "level": "h2",
      "text": "Tags API reference",
      "id": "tags-api-reference"
    },
    {
      "level": "h3",
      "text": "Get script tags",
      "id": "get-script-tags"
    },
    {
      "level": "h3",
      "text": "Set script tags",
      "id": "set-script-tags"
    },
    {
      "level": "h3",
      "text": "Add a single tag",
      "id": "add-a-single-tag"
    },
    {
      "level": "h3",
      "text": "Delete a single tag",
      "id": "delete-a-single-tag"
    },
    {
      "level": "h3",
      "text": "Filter Workers by tag",
      "id": "filter-workers-by-tag"
    },
    {
      "level": "h3",
      "text": "Delete Workers by tag",
      "id": "delete-workers-by-tag"
    },
    {
      "level": "h2",
      "text": "Script limits",
      "id": "script-limits"
    },
    {
      "level": "h2",
      "text": "`cf` object",
      "id": "`cf`-object"
    },
    {
      "level": "h2",
      "text": "Durable Object namespace limits",
      "id": "durable-object-namespace-limits"
    },
    {
      "level": "h2",
      "text": "Cache API",
      "id": "cache-api"
    },
    {
      "level": "h2",
      "text": "Tags",
      "id": "tags"
    },
    {
      "level": "h2",
      "text": "Gradual Deployments",
      "id": "gradual-deployments"
    },
    {
      "level": "h2",
      "text": "API Rate Limits",
      "id": "api-rate-limits"
    },
    {
      "level": "h3",
      "text": "How to use remote dispatch namespaces",
      "id": "how-to-use-remote-dispatch-namespaces"
    },
    {
      "level": "h2",
      "text": "API examples",
      "id": "api-examples"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Deploy a user Worker",
      "id": "deploy-a-user-worker"
    },
    {
      "level": "h3",
      "text": "Deploy with bindings and tags",
      "id": "deploy-with-bindings-and-tags"
    },
    {
      "level": "h3",
      "text": "Deploy a Worker with static assets",
      "id": "deploy-a-worker-with-static-assets"
    },
    {
      "level": "h3",
      "text": "List Workers in a namespace",
      "id": "list-workers-in-a-namespace"
    },
    {
      "level": "h3",
      "text": "Delete Workers by tag",
      "id": "delete-workers-by-tag"
    },
    {
      "level": "h3",
      "text": "Delete a single Worker",
      "id": "delete-a-single-worker"
    },
    {
      "level": "h2",
      "text": "Example pricing:",
      "id": "example-pricing:"
    },
    {
      "level": "h3",
      "text": "Untrusted Mode (Default)",
      "id": "untrusted-mode-(default)"
    },
    {
      "level": "h3",
      "text": "Trusted Mode",
      "id": "trusted-mode"
    },
    {
      "level": "h3",
      "text": "Maintaining cache isolation in trusted mode",
      "id": "maintaining-cache-isolation-in-trusted-mode"
    },
    {
      "level": "h2",
      "text": "Related Resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Enable the App Launcher",
      "id": "enable-the-app-launcher"
    },
    {
      "level": "h2",
      "text": "Add a tile to the App Launcher",
      "id": "add-a-tile-to-the-app-launcher"
    },
    {
      "level": "h2",
      "text": "Customize App Launcher appearance",
      "id": "customize-app-launcher-appearance"
    },
    {
      "level": "h2",
      "text": "Session durations",
      "id": "session-durations"
    },
    {
      "level": "h3",
      "text": "Global session duration",
      "id": "global-session-duration"
    },
    {
      "level": "h3",
      "text": "Policy session duration",
      "id": "policy-session-duration"
    },
    {
      "level": "h3",
      "text": "Application session duration",
      "id": "application-session-duration"
    },
    {
      "level": "h3",
      "text": "WARP session duration",
      "id": "warp-session-duration"
    },
    {
      "level": "h3",
      "text": "Order of enforcement",
      "id": "order-of-enforcement"
    },
    {
      "level": "h2",
      "text": "Revoke user sessions",
      "id": "revoke-user-sessions"
    },
    {
      "level": "h3",
      "text": "Per-Application",
      "id": "per-application"
    },
    {
      "level": "h3",
      "text": "Per-User",
      "id": "per-user"
    },
    {
      "level": "h3",
      "text": "Subsequent Logins",
      "id": "subsequent-logins"
    },
    {
      "level": "h2",
      "text": "Log out as a user",
      "id": "log-out-as-a-user"
    },
    {
      "level": "h2",
      "text": "AJAX",
      "id": "ajax"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Add an MCP server",
      "id": "add-an-mcp-server"
    },
    {
      "level": "h3",
      "text": "Server status",
      "id": "server-status"
    },
    {
      "level": "h3",
      "text": "Reauthenticate the MCP server",
      "id": "reauthenticate-the-mcp-server"
    },
    {
      "level": "h3",
      "text": "Synchronize the MCP server",
      "id": "synchronize-the-mcp-server"
    },
    {
      "level": "h2",
      "text": "Create a portal",
      "id": "create-a-portal"
    },
    {
      "level": "h3",
      "text": "Customize login settings",
      "id": "customize-login-settings"
    },
    {
      "level": "h2",
      "text": "Connect to a portal",
      "id": "connect-to-a-portal"
    },
    {
      "level": "h2",
      "text": "View portal logs",
      "id": "view-portal-logs"
    },
    {
      "level": "h3",
      "text": "Log fields",
      "id": "log-fields"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "After authenticating to the portal, my user receives the error `No allowed servers available, check your Zero Trust Policies`.",
      "id": "after-authenticating-to-the-portal,-my-user-receives-the-error-`no-allowed-servers-available,-check-your-zero-trust-policies`."
    },
    {
      "level": "h3",
      "text": "The portal URL does not prompt for authentication when it is added to an MCP client.",
      "id": "the-portal-url-does-not-prompt-for-authentication-when-it-is-added-to-an-mcp-client."
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Secure the MCP server with Access for SaaS",
      "id": "1.-secure-the-mcp-server-with-access-for-saas"
    },
    {
      "level": "h2",
      "text": "2. Create an Access policy with a Linked App Token",
      "id": "2.-create-an-access-policy-with-a-linked-app-token"
    },
    {
      "level": "h2",
      "text": "3. Update the self-hosted application",
      "id": "3.-update-the-self-hosted-application"
    },
    {
      "level": "h2",
      "text": "4. Configure the MCP server",
      "id": "4.-configure-the-mcp-server"
    },
    {
      "level": "h2",
      "text": "Known limitations",
      "id": "known-limitations"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Deploy an example MCP server",
      "id": "1.-deploy-an-example-mcp-server"
    },
    {
      "level": "h2",
      "text": "2. Create an Access for SaaS app",
      "id": "2.-create-an-access-for-saas-app"
    },
    {
      "level": "h2",
      "text": "3. Configure your MCP server",
      "id": "3.-configure-your-mcp-server"
    },
    {
      "level": "h2",
      "text": "4. Test the connection",
      "id": "4.-test-the-connection"
    },
    {
      "level": "h2",
      "text": "WARP client",
      "id": "warp-client"
    },
    {
      "level": "h2",
      "text": "Clientless access",
      "id": "clientless-access"
    },
    {
      "level": "h3",
      "text": "Browser-rendered terminal",
      "id": "browser-rendered-terminal"
    },
    {
      "level": "h3",
      "text": "Client-side cloudflared (legacy)",
      "id": "client-side-cloudflared-(legacy)"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Policy inheritance",
      "id": "policy-inheritance"
    },
    {
      "level": "h2",
      "text": "Wildcards",
      "id": "wildcards"
    },
    {
      "level": "h3",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h3",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Subdomain setups",
      "id": "subdomain-setups"
    },
    {
      "level": "h2",
      "text": "Unsupported URLs",
      "id": "unsupported-urls"
    },
    {
      "level": "h3",
      "text": "Port numbers",
      "id": "port-numbers"
    },
    {
      "level": "h3",
      "text": "Query strings",
      "id": "query-strings"
    },
    {
      "level": "h3",
      "text": "Anchor links",
      "id": "anchor-links"
    },
    {
      "level": "h2",
      "text": "Set up external API and key with Cloudflare Workers",
      "id": "set-up-external-api-and-key-with-cloudflare-workers"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "1. Create a new Worker",
      "id": "1.-create-a-new-worker"
    },
    {
      "level": "h3",
      "text": "2. Program your business logic",
      "id": "2.-program-your-business-logic"
    },
    {
      "level": "h3",
      "text": "3. Generate a key",
      "id": "3.-generate-a-key"
    },
    {
      "level": "h3",
      "text": "4. Create an External Evaluation rule",
      "id": "4.-create-an-external-evaluation-rule"
    },
    {
      "level": "h3",
      "text": "Troubleshooting the Worker",
      "id": "troubleshooting-the-worker"
    },
    {
      "level": "h2",
      "text": "Create a rule group",
      "id": "create-a-rule-group"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "IP-based rules",
      "id": "ip-based-rules"
    },
    {
      "level": "h3",
      "text": "Country requirements",
      "id": "country-requirements"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable Browser Isolation",
      "id": "enable-browser-isolation"
    },
    {
      "level": "h2",
      "text": "Policies for isolated applications",
      "id": "policies-for-isolated-applications"
    },
    {
      "level": "h2",
      "text": "Product compatibility",
      "id": "product-compatibility"
    },
    {
      "level": "h2",
      "text": "Adding authentication methods into the JWT",
      "id": "adding-authentication-methods-into-the-jwt"
    },
    {
      "level": "h2",
      "text": "Create a policy",
      "id": "create-a-policy"
    },
    {
      "level": "h2",
      "text": "Edit a policy",
      "id": "edit-a-policy"
    },
    {
      "level": "h2",
      "text": "Delete a policy",
      "id": "delete-a-policy"
    },
    {
      "level": "h2",
      "text": "Test your policies",
      "id": "test-your-policies"
    },
    {
      "level": "h3",
      "text": "Test a single policy",
      "id": "test-a-single-policy"
    },
    {
      "level": "h3",
      "text": "Test all policies in an application",
      "id": "test-all-policies-in-an-application"
    },
    {
      "level": "h2",
      "text": "Legacy policies",
      "id": "legacy-policies"
    },
    {
      "level": "h3",
      "text": "Migrate to reusable policies",
      "id": "migrate-to-reusable-policies"
    },
    {
      "level": "h3",
      "text": "Convert a legacy policy",
      "id": "convert-a-legacy-policy"
    },
    {
      "level": "h2",
      "text": "Set up temporary authentication",
      "id": "set-up-temporary-authentication"
    },
    {
      "level": "h2",
      "text": "Temporary authentication requests",
      "id": "temporary-authentication-requests"
    },
    {
      "level": "h2",
      "text": "Enforce mTLS authentication",
      "id": "enforce-mtls-authentication"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Add mTLS to your Access application",
      "id": "add-mtls-to-your-access-application"
    },
    {
      "level": "h2",
      "text": "Test mTLS",
      "id": "test-mtls"
    },
    {
      "level": "h3",
      "text": "Test using cURL",
      "id": "test-using-curl"
    },
    {
      "level": "h3",
      "text": "Test in a browser",
      "id": "test-in-a-browser"
    },
    {
      "level": "h2",
      "text": "Generate mTLS certificates",
      "id": "generate-mtls-certificates"
    },
    {
      "level": "h3",
      "text": "OpenSSL",
      "id": "openssl"
    },
    {
      "level": "h3",
      "text": "Cloudflare PKI",
      "id": "cloudflare-pki"
    },
    {
      "level": "h2",
      "text": "Forward a client certificate",
      "id": "forward-a-client-certificate"
    },
    {
      "level": "h3",
      "text": "Cloudflare API",
      "id": "cloudflare-api"
    },
    {
      "level": "h3",
      "text": "Managed Transforms",
      "id": "managed-transforms"
    },
    {
      "level": "h3",
      "text": "Cloudflare Workers",
      "id": "cloudflare-workers"
    },
    {
      "level": "h2",
      "text": "Known limitations",
      "id": "known-limitations"
    },
    {
      "level": "h2",
      "text": "Notifications for mutual TLS certificates",
      "id": "notifications-for-mutual-tls-certificates"
    },
    {
      "level": "h2",
      "text": "Create a service token",
      "id": "create-a-service-token"
    },
    {
      "level": "h2",
      "text": "Connect your service to Access",
      "id": "connect-your-service-to-access"
    },
    {
      "level": "h3",
      "text": "Initial request",
      "id": "initial-request"
    },
    {
      "level": "h3",
      "text": "Subsequent requests",
      "id": "subsequent-requests"
    },
    {
      "level": "h2",
      "text": "Renew service tokens",
      "id": "renew-service-tokens"
    },
    {
      "level": "h2",
      "text": "Revoke service tokens",
      "id": "revoke-service-tokens"
    },
    {
      "level": "h2",
      "text": "Set a token expiration alert",
      "id": "set-a-token-expiration-alert"
    },
    {
      "level": "h2",
      "text": "Log uploads/downloads",
      "id": "log-uploads/downloads"
    },
    {
      "level": "h2",
      "text": "Block file types",
      "id": "block-file-types"
    },
    {
      "level": "h2",
      "text": "Block uploads/downloads for specific users",
      "id": "block-uploads/downloads-for-specific-users"
    },
    {
      "level": "h2",
      "text": "Exclude Android applications",
      "id": "exclude-android-applications"
    },
    {
      "level": "h2",
      "text": "Exclude specific sites",
      "id": "exclude-specific-sites"
    },
    {
      "level": "h2",
      "text": "Set a DLP payload encryption public key",
      "id": "set-a-dlp-payload-encryption-public-key"
    },
    {
      "level": "h3",
      "text": "Generate a key pair",
      "id": "generate-a-key-pair"
    },
    {
      "level": "h3",
      "text": "Upload the public key to Cloudflare",
      "id": "upload-the-public-key-to-cloudflare"
    },
    {
      "level": "h2",
      "text": "Log the payload of matched rules",
      "id": "log-the-payload-of-matched-rules"
    },
    {
      "level": "h3",
      "text": "Turn on payload logging for a DLP policy",
      "id": "turn-on-payload-logging-for-a-dlp-policy"
    },
    {
      "level": "h3",
      "text": "View payload logs",
      "id": "view-payload-logs"
    },
    {
      "level": "h3",
      "text": "Report false and true positives to AI context analysis",
      "id": "report-false-and-true-positives-to-ai-context-analysis"
    },
    {
      "level": "h3",
      "text": "Data privacy",
      "id": "data-privacy"
    },
    {
      "level": "h2",
      "text": "Log generative AI prompt content",
      "id": "log-generative-ai-prompt-content"
    },
    {
      "level": "h3",
      "text": "Turn on AI prompt content logging for a DLP policy",
      "id": "turn-on-ai-prompt-content-logging-for-a-dlp-policy"
    },
    {
      "level": "h3",
      "text": "View prompt logs",
      "id": "view-prompt-logs"
    },
    {
      "level": "h2",
      "text": "Send DLP forensic copies to Logpush destination",
      "id": "send-dlp-forensic-copies-to-logpush-destination"
    },
    {
      "level": "h2",
      "text": "Edit profile settings",
      "id": "edit-profile-settings"
    },
    {
      "level": "h2",
      "text": "Available settings",
      "id": "available-settings"
    },
    {
      "level": "h3",
      "text": "Match count",
      "id": "match-count"
    },
    {
      "level": "h3",
      "text": "Optical Character Recognition (OCR)",
      "id": "optical-character-recognition-(ocr)"
    },
    {
      "level": "h3",
      "text": "AI context analysis Beta",
      "id": "ai-context-analysis-beta"
    },
    {
      "level": "h3",
      "text": "Confidence thresholds",
      "id": "confidence-thresholds"
    },
    {
      "level": "h2",
      "text": "Microsoft Purview Information Protection (MIP) sensitivity labels",
      "id": "microsoft-purview-information-protection-(mip)-sensitivity-labels"
    },
    {
      "level": "h3",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h3",
      "text": "Syncing",
      "id": "syncing"
    },
    {
      "level": "h2",
      "text": "AI Prompt",
      "id": "ai-prompt"
    },
    {
      "level": "h2",
      "text": "Credentials and Secrets",
      "id": "credentials-and-secrets"
    },
    {
      "level": "h2",
      "text": "Financial Information",
      "id": "financial-information"
    },
    {
      "level": "h2",
      "text": "Health Information",
      "id": "health-information"
    },
    {
      "level": "h2",
      "text": "Social Security, Insurance, Tax, and Identifier Numbers",
      "id": "social-security,-insurance,-tax,-and-identifier-numbers"
    },
    {
      "level": "h2",
      "text": "Source Code",
      "id": "source-code"
    },
    {
      "level": "h2",
      "text": "Add a user",
      "id": "add-a-user"
    },
    {
      "level": "h2",
      "text": "Edit a user",
      "id": "edit-a-user"
    },
    {
      "level": "h2",
      "text": "Delete a user",
      "id": "delete-a-user"
    },
    {
      "level": "h2",
      "text": "Screen criteria",
      "id": "screen-criteria"
    },
    {
      "level": "h3",
      "text": "Popular screen",
      "id": "popular-screen"
    },
    {
      "level": "h3",
      "text": "Regular screen",
      "id": "regular-screen"
    },
    {
      "level": "h3",
      "text": "Advanced screen",
      "id": "advanced-screen"
    },
    {
      "level": "h2",
      "text": "Move messages",
      "id": "move-messages"
    },
    {
      "level": "h2",
      "text": "Find similar emails",
      "id": "find-similar-emails"
    },
    {
      "level": "h2",
      "text": "Export messages",
      "id": "export-messages"
    },
    {
      "level": "h2",
      "text": "Email status",
      "id": "email-status"
    },
    {
      "level": "h2",
      "text": "Email details",
      "id": "email-details"
    },
    {
      "level": "h3",
      "text": "Details",
      "id": "details"
    },
    {
      "level": "h3",
      "text": "Action log",
      "id": "action-log"
    },
    {
      "level": "h3",
      "text": "Raw message",
      "id": "raw-message"
    },
    {
      "level": "h3",
      "text": "Mail trace",
      "id": "mail-trace"
    },
    {
      "level": "h2",
      "text": "Download a disposition report",
      "id": "download-a-disposition-report"
    },
    {
      "level": "h2",
      "text": "Download a retro scan report",
      "id": "download-a-retro-scan-report"
    },
    {
      "level": "h2",
      "text": "Download a security report",
      "id": "download-a-security-report"
    },
    {
      "level": "h2",
      "text": "Dispositions",
      "id": "dispositions"
    },
    {
      "level": "h3",
      "text": "Available values",
      "id": "available-values"
    },
    {
      "level": "h3",
      "text": "Header structure",
      "id": "header-structure"
    },
    {
      "level": "h2",
      "text": "Attributes",
      "id": "attributes"
    },
    {
      "level": "h3",
      "text": "Available values",
      "id": "available-values"
    },
    {
      "level": "h3",
      "text": "Header structure",
      "id": "header-structure"
    },
    {
      "level": "h2",
      "text": "Sample attack types and detections",
      "id": "sample-attack-types-and-detections"
    },
    {
      "level": "h3",
      "text": "Malicious payload attached to the message",
      "id": "malicious-payload-attached-to-the-message"
    },
    {
      "level": "h3",
      "text": "Encrypted malicious payload attached to the message, with password in message body as text",
      "id": "encrypted-malicious-payload-attached-to-the-message,-with-password-in-message-body-as-text"
    },
    {
      "level": "h3",
      "text": "Encrypted malicious payload attached to the message, with password in message body as an image",
      "id": "encrypted-malicious-payload-attached-to-the-message,-with-password-in-message-body-as-an-image"
    },
    {
      "level": "h3",
      "text": "Malicious payload within an archive attached to the message",
      "id": "malicious-payload-within-an-archive-attached-to-the-message"
    },
    {
      "level": "h3",
      "text": "Malicious URLs within message body",
      "id": "malicious-urls-within-message-body"
    },
    {
      "level": "h3",
      "text": "Malicious payload linked through a URL in a message",
      "id": "malicious-payload-linked-through-a-url-in-a-message"
    },
    {
      "level": "h3",
      "text": "Blind URL campaigns",
      "id": "blind-url-campaigns"
    },
    {
      "level": "h3",
      "text": "Malicious URLs within a benign attachment in the message",
      "id": "malicious-urls-within-a-benign-attachment-in-the-message"
    },
    {
      "level": "h3",
      "text": "Malicious URLs within an archive attached to the message",
      "id": "malicious-urls-within-an-archive-attached-to-the-message"
    },
    {
      "level": "h3",
      "text": "Malicious URLs behind URL shortening services",
      "id": "malicious-urls-behind-url-shortening-services"
    },
    {
      "level": "h3",
      "text": "Malicious URLs associated with QR codes (QR Code Phishing Attacks, Quishing)",
      "id": "malicious-urls-associated-with-qr-codes-(qr-code-phishing-attacks,-quishing)"
    },
    {
      "level": "h3",
      "text": "Instant crawl of URLs within message body",
      "id": "instant-crawl-of-urls-within-message-body"
    },
    {
      "level": "h3",
      "text": "Credential Harvesters",
      "id": "credential-harvesters"
    },
    {
      "level": "h3",
      "text": "Domain Spoof Attacks",
      "id": "domain-spoof-attacks"
    },
    {
      "level": "h3",
      "text": "Domain proximity attacks",
      "id": "domain-proximity-attacks"
    },
    {
      "level": "h3",
      "text": "Email Auth violations",
      "id": "email-auth-violations"
    },
    {
      "level": "h3",
      "text": "Name Spoof Attacks / Executive Attacks (BEC)",
      "id": "name-spoof-attacks-/-executive-attacks-(bec)"
    },
    {
      "level": "h3",
      "text": "Fileless / Linkless campaigns (BEC)",
      "id": "fileless-/-linkless-campaigns-(bec)"
    },
    {
      "level": "h3",
      "text": "Deferred campaign attacks",
      "id": "deferred-campaign-attacks"
    },
    {
      "level": "h3",
      "text": "IP-based spam",
      "id": "ip-based-spam"
    },
    {
      "level": "h3",
      "text": "Content-based spam",
      "id": "content-based-spam"
    },
    {
      "level": "h3",
      "text": "Web phishing",
      "id": "web-phishing"
    },
    {
      "level": "h3",
      "text": "Mobile phishing",
      "id": "mobile-phishing"
    },
    {
      "level": "h3",
      "text": "Network phishing",
      "id": "network-phishing"
    },
    {
      "level": "h2",
      "text": "Reclassify an email",
      "id": "reclassify-an-email"
    },
    {
      "level": "h2",
      "text": "Filter domains",
      "id": "filter-domains"
    },
    {
      "level": "h2",
      "text": "Edit domains",
      "id": "edit-domains"
    },
    {
      "level": "h2",
      "text": "Prevent Cloudflare from scanning a domain",
      "id": "prevent-cloudflare-from-scanning-a-domain"
    },
    {
      "level": "h2",
      "text": "Enable notifications",
      "id": "enable-notifications"
    },
    {
      "level": "h2",
      "text": "View team submissions",
      "id": "view-team-submissions"
    },
    {
      "level": "h2",
      "text": "Filter team submissions",
      "id": "filter-team-submissions"
    },
    {
      "level": "h2",
      "text": "View submission details",
      "id": "view-submission-details"
    },
    {
      "level": "h2",
      "text": "View user submissions",
      "id": "view-user-submissions"
    },
    {
      "level": "h2",
      "text": "Filter user submissions",
      "id": "filter-user-submissions"
    },
    {
      "level": "h2",
      "text": "View submission details",
      "id": "view-submission-details"
    },
    {
      "level": "h2",
      "text": "Escalate a submission",
      "id": "escalate-a-submission"
    },
    {
      "level": "h2",
      "text": "Available insights",
      "id": "available-insights"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Available insights",
      "id": "available-insights"
    },
    {
      "level": "h3",
      "text": "Top 5 visited AI applications by user count",
      "id": "top-5-visited-ai-applications-by-user-count"
    },
    {
      "level": "h3",
      "text": "Statuses applied to AI applications by application count",
      "id": "statuses-applied-to-ai-applications-by-application-count"
    },
    {
      "level": "h3",
      "text": "Data uploaded to Artificial Intelligence applications by status",
      "id": "data-uploaded-to-artificial-intelligence-applications-by-status"
    },
    {
      "level": "h3",
      "text": "MCP servers behind Access over time",
      "id": "mcp-servers-behind-access-over-time"
    },
    {
      "level": "h3",
      "text": "Access login events to MCP servers",
      "id": "access-login-events-to-mcp-servers"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Available insights",
      "id": "available-insights"
    },
    {
      "level": "h3",
      "text": "Summary of Access activity",
      "id": "summary-of-access-activity"
    },
    {
      "level": "h3",
      "text": "Access events",
      "id": "access-events"
    },
    {
      "level": "h3",
      "text": "Access decisions by event count",
      "id": "access-decisions-by-event-count"
    },
    {
      "level": "h3",
      "text": "Access applications by event count",
      "id": "access-applications-by-event-count"
    },
    {
      "level": "h3",
      "text": "Access events by type",
      "id": "access-events-by-type"
    },
    {
      "level": "h3",
      "text": "Top counts of event details",
      "id": "top-counts-of-event-details"
    },
    {
      "level": "h3",
      "text": "Access admin metrics",
      "id": "access-admin-metrics"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Available insights",
      "id": "available-insights"
    },
    {
      "level": "h3",
      "text": "SaaS and Cloud findings by count",
      "id": "saas-and-cloud-findings-by-count"
    },
    {
      "level": "h3",
      "text": "Posture findings by Severity",
      "id": "posture-findings-by-severity"
    },
    {
      "level": "h3",
      "text": "DLP matches in HTTP requests over time",
      "id": "dlp-matches-in-http-requests-over-time"
    },
    {
      "level": "h2",
      "text": "HTTP request analytics",
      "id": "http-request-analytics"
    },
    {
      "level": "h3",
      "text": "Provided analytics",
      "id": "provided-analytics"
    },
    {
      "level": "h2",
      "text": "DNS query analytics",
      "id": "dns-query-analytics"
    },
    {
      "level": "h3",
      "text": "Provided analytics",
      "id": "provided-analytics"
    },
    {
      "level": "h2",
      "text": "Network session analytics",
      "id": "network-session-analytics"
    },
    {
      "level": "h3",
      "text": "Provided analytics",
      "id": "provided-analytics"
    },
    {
      "level": "h2",
      "text": "GraphQL queries",
      "id": "graphql-queries"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Use Shadow IT SaaS analytics",
      "id": "use-shadow-it-saas-analytics"
    },
    {
      "level": "h3",
      "text": "1. Review applications",
      "id": "1.-review-applications"
    },
    {
      "level": "h3",
      "text": "2. Monitor usage",
      "id": "2.-monitor-usage"
    },
    {
      "level": "h3",
      "text": "3. Create policies",
      "id": "3.-create-policies"
    },
    {
      "level": "h2",
      "text": "Available insights",
      "id": "available-insights"
    },
    {
      "level": "h2",
      "text": "View a device's IP information",
      "id": "view-a-device's-ip-information"
    },
    {
      "level": "h2",
      "text": "View a device's IP history",
      "id": "view-a-device's-ip-history"
    },
    {
      "level": "h2",
      "text": "Troubleshoot with IP visibility",
      "id": "troubleshoot-with-ip-visibility"
    },
    {
      "level": "h2",
      "text": "Cloudflare AI Playground",
      "id": "cloudflare-ai-playground"
    },
    {
      "level": "h2",
      "text": "AI Assistant",
      "id": "ai-assistant"
    },
    {
      "level": "h3",
      "text": "Claude",
      "id": "claude"
    },
    {
      "level": "h3",
      "text": "Gemini CLI",
      "id": "gemini-cli"
    },
    {
      "level": "h3",
      "text": "ChatGPT",
      "id": "chatgpt"
    },
    {
      "level": "h2",
      "text": "Device overview",
      "id": "device-overview"
    },
    {
      "level": "h3",
      "text": "View metrics",
      "id": "view-metrics"
    },
    {
      "level": "h3",
      "text": "Available metrics",
      "id": "available-metrics"
    },
    {
      "level": "h2",
      "text": "Device monitoring",
      "id": "device-monitoring"
    },
    {
      "level": "h3",
      "text": "View a device's performance",
      "id": "view-a-device's-performance"
    },
    {
      "level": "h3",
      "text": "Network and device performance metrics",
      "id": "network-and-device-performance-metrics"
    },
    {
      "level": "h2",
      "text": "Export DEX device state event logs",
      "id": "export-dex-device-state-event-logs"
    },
    {
      "level": "h2",
      "text": "Manage notifications",
      "id": "manage-notifications"
    },
    {
      "level": "h2",
      "text": "Available notifications",
      "id": "available-notifications"
    },
    {
      "level": "h2",
      "text": "Alert logic",
      "id": "alert-logic"
    },
    {
      "level": "h3",
      "text": "Z-score",
      "id": "z-score"
    },
    {
      "level": "h3",
      "text": "SLO",
      "id": "slo"
    },
    {
      "level": "h2",
      "text": "Start a remote capture",
      "id": "start-a-remote-capture"
    },
    {
      "level": "h2",
      "text": "Check remote capture status",
      "id": "check-remote-capture-status"
    },
    {
      "level": "h2",
      "text": "Download remote captures",
      "id": "download-remote-captures"
    },
    {
      "level": "h3",
      "text": "Device PCAP contents",
      "id": "device-pcap-contents"
    },
    {
      "level": "h3",
      "text": "WARP Diag contents",
      "id": "warp-diag-contents"
    },
    {
      "level": "h2",
      "text": "WARP diagnostics analyzer (beta)",
      "id": "warp-diagnostics-analyzer-(beta)"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Create a rule",
      "id": "create-a-rule"
    },
    {
      "level": "h3",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h2",
      "text": "Add a rule to a test",
      "id": "add-a-rule-to-a-test"
    },
    {
      "level": "h2",
      "text": "Create a test using a rule",
      "id": "create-a-test-using-a-rule"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Export DEX application test logs",
      "id": "export-dex-application-test-logs"
    },
    {
      "level": "h2",
      "text": "Authentication logs",
      "id": "authentication-logs"
    },
    {
      "level": "h3",
      "text": "Identity-based authentication",
      "id": "identity-based-authentication"
    },
    {
      "level": "h3",
      "text": "Non-identity authentication",
      "id": "non-identity-authentication"
    },
    {
      "level": "h2",
      "text": "Per-request logs",
      "id": "per-request-logs"
    },
    {
      "level": "h3",
      "text": "Using Cloudflare Logs",
      "id": "using-cloudflare-logs"
    },
    {
      "level": "h3",
      "text": "Using the `cf-access-user` field",
      "id": "using-the-`cf-access-user`-field"
    },
    {
      "level": "h2",
      "text": "Filter by enabled or disabled rules",
      "id": "filter-by-enabled-or-disabled-rules"
    },
    {
      "level": "h2",
      "text": "Filter by allowed or blocked traffic",
      "id": "filter-by-allowed-or-blocked-traffic"
    },
    {
      "level": "h2",
      "text": "Filter by relevant fields to Magic Firewall",
      "id": "filter-by-relevant-fields-to-magic-firewall"
    },
    {
      "level": "h2",
      "text": "Enable detection logs",
      "id": "enable-detection-logs"
    },
    {
      "level": "h2",
      "text": "Enable user action logs",
      "id": "enable-user-action-logs"
    },
    {
      "level": "h2",
      "text": "Selective logging",
      "id": "selective-logging"
    },
    {
      "level": "h2",
      "text": "DNS logs",
      "id": "dns-logs"
    },
    {
      "level": "h3",
      "text": "Explanation of the fields",
      "id": "explanation-of-the-fields"
    },
    {
      "level": "h3",
      "text": "Resolver decisions",
      "id": "resolver-decisions"
    },
    {
      "level": "h2",
      "text": "Network logs",
      "id": "network-logs"
    },
    {
      "level": "h3",
      "text": "Explanation of the fields",
      "id": "explanation-of-the-fields"
    },
    {
      "level": "h2",
      "text": "HTTP logs",
      "id": "http-logs"
    },
    {
      "level": "h3",
      "text": "Explanation of the fields",
      "id": "explanation-of-the-fields"
    },
    {
      "level": "h3",
      "text": "Enhanced file detection",
      "id": "enhanced-file-detection"
    },
    {
      "level": "h3",
      "text": "Isolate requests",
      "id": "isolate-requests"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Export Zero Trust logs with Logpush",
      "id": "export-zero-trust-logs-with-logpush"
    },
    {
      "level": "h2",
      "text": "Zero Trust datasets",
      "id": "zero-trust-datasets"
    },
    {
      "level": "h2",
      "text": "Verify regional map application",
      "id": "verify-regional-map-application"
    },
    {
      "level": "h2",
      "text": "Parse DNS logs",
      "id": "parse-dns-logs"
    },
    {
      "level": "h2",
      "text": "Explanation of the fields",
      "id": "explanation-of-the-fields"
    },
    {
      "level": "h3",
      "text": "Device details",
      "id": "device-details"
    },
    {
      "level": "h3",
      "text": "User details",
      "id": "user-details"
    },
    {
      "level": "h3",
      "text": "Posture details",
      "id": "posture-details"
    },
    {
      "level": "h2",
      "text": "View SCIM logs",
      "id": "view-scim-logs"
    },
    {
      "level": "h2",
      "text": "Log fields",
      "id": "log-fields"
    },
    {
      "level": "h2",
      "text": "Notes on using Logpush with IDS",
      "id": "notes-on-using-logpush-with-ids"
    },
    {
      "level": "h2",
      "text": "Sample packet captures",
      "id": "sample-packet-captures"
    },
    {
      "level": "h2",
      "text": "Full packet captures",
      "id": "full-packet-captures"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "API key hygiene",
      "id": "api-key-hygiene"
    },
    {
      "level": "h3",
      "text": "Access security",
      "id": "access-security"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Access security",
      "id": "access-security"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Access security",
      "id": "access-security"
    },
    {
      "level": "h3",
      "text": "File security",
      "id": "file-security"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Compute account",
      "id": "compute-account"
    },
    {
      "level": "h3",
      "text": "Add a compute account",
      "id": "add-a-compute-account"
    },
    {
      "level": "h3",
      "text": "Configure compute account scanning",
      "id": "configure-compute-account-scanning"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "S3 Bucket security",
      "id": "s3-bucket-security"
    },
    {
      "level": "h3",
      "text": "IAM Policies",
      "id": "iam-policies"
    },
    {
      "level": "h3",
      "text": "Root User Management",
      "id": "root-user-management"
    },
    {
      "level": "h3",
      "text": "Certificates",
      "id": "certificates"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Repository security",
      "id": "repository-security"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "File and folder sharing",
      "id": "file-and-folder-sharing"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h3",
      "text": "Suspicious applications",
      "id": "suspicious-applications"
    },
    {
      "level": "h3",
      "text": "User access and account misconfigurations",
      "id": "user-access-and-account-misconfigurations"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h3",
      "text": "User access",
      "id": "user-access"
    },
    {
      "level": "h3",
      "text": "Account misconfigurations",
      "id": "account-misconfigurations"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Compute account",
      "id": "compute-account"
    },
    {
      "level": "h3",
      "text": "Add a compute account",
      "id": "add-a-compute-account"
    },
    {
      "level": "h3",
      "text": "Configure compute account scanning",
      "id": "configure-compute-account-scanning"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Cloud Storage Bucket security",
      "id": "cloud-storage-bucket-security"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Branches and merges",
      "id": "branches-and-merges"
    },
    {
      "level": "h3",
      "text": "User accounts",
      "id": "user-accounts"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "User account settings",
      "id": "user-account-settings"
    },
    {
      "level": "h3",
      "text": "Inactive or suspended users",
      "id": "inactive-or-suspended-users"
    },
    {
      "level": "h3",
      "text": "Gemini licensing",
      "id": "gemini-licensing"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h3",
      "text": "Calendar sharing",
      "id": "calendar-sharing"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h3",
      "text": "Third-party apps",
      "id": "third-party-apps"
    },
    {
      "level": "h3",
      "text": "Gmail administrator settings",
      "id": "gmail-administrator-settings"
    },
    {
      "level": "h3",
      "text": "Email forwarding",
      "id": "email-forwarding"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h3",
      "text": "Enable Compliance API access",
      "id": "enable-compliance-api-access"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Model and tool governance",
      "id": "model-and-tool-governance"
    },
    {
      "level": "h3",
      "text": "Publishing and sharing",
      "id": "publishing-and-sharing"
    },
    {
      "level": "h3",
      "text": "API key hygiene",
      "id": "api-key-hygiene"
    },
    {
      "level": "h3",
      "text": "Access security",
      "id": "access-security"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "User account settings",
      "id": "user-account-settings"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h3",
      "text": "Data Loss Prevention (optional)",
      "id": "data-loss-prevention-(optional)"
    },
    {
      "level": "h3",
      "text": "Third-party apps",
      "id": "third-party-apps"
    },
    {
      "level": "h3",
      "text": "Calendar sharing",
      "id": "calendar-sharing"
    },
    {
      "level": "h3",
      "text": "Email administrator settings",
      "id": "email-administrator-settings"
    },
    {
      "level": "h3",
      "text": "Email forwarding",
      "id": "email-forwarding"
    },
    {
      "level": "h2",
      "text": "Microsoft Information Protection (MIP) sensitivity labels",
      "id": "microsoft-information-protection-(mip)-sensitivity-labels"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h3",
      "text": "Account misconfigurations",
      "id": "account-misconfigurations"
    },
    {
      "level": "h3",
      "text": "User access",
      "id": "user-access"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h3",
      "text": "Account misconfigurations",
      "id": "account-misconfigurations"
    },
    {
      "level": "h3",
      "text": "User access",
      "id": "user-access"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Instance security",
      "id": "instance-security"
    },
    {
      "level": "h3",
      "text": "User security",
      "id": "user-security"
    },
    {
      "level": "h3",
      "text": "Incident management",
      "id": "incident-management"
    },
    {
      "level": "h3",
      "text": "Knowledge management",
      "id": "knowledge-management"
    },
    {
      "level": "h3",
      "text": "Integration and access",
      "id": "integration-and-access"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "Instance security",
      "id": "instance-security"
    },
    {
      "level": "h3",
      "text": "User security",
      "id": "user-security"
    },
    {
      "level": "h3",
      "text": "Incident management",
      "id": "incident-management"
    },
    {
      "level": "h3",
      "text": "Knowledge management",
      "id": "knowledge-management"
    },
    {
      "level": "h3",
      "text": "Integration and access",
      "id": "integration-and-access"
    },
    {
      "level": "h2",
      "text": "Integration prerequisites",
      "id": "integration-prerequisites"
    },
    {
      "level": "h2",
      "text": "Integration permissions",
      "id": "integration-permissions"
    },
    {
      "level": "h2",
      "text": "Security findings",
      "id": "security-findings"
    },
    {
      "level": "h3",
      "text": "User account settings",
      "id": "user-account-settings"
    },
    {
      "level": "h3",
      "text": "Channel sharing",
      "id": "channel-sharing"
    },
    {
      "level": "h3",
      "text": "File sharing",
      "id": "file-sharing"
    },
    {
      "level": "h2",
      "text": "Before you start",
      "id": "before-you-start"
    },
    {
      "level": "h2",
      "text": "Create a Relying Party Trust",
      "id": "create-a-relying-party-trust"
    },
    {
      "level": "h2",
      "text": "Create claim rules",
      "id": "create-claim-rules"
    },
    {
      "level": "h2",
      "text": "Export the certificate",
      "id": "export-the-certificate"
    },
    {
      "level": "h2",
      "text": "Configure AD FS to sign SAML responses",
      "id": "configure-ad-fs-to-sign-saml-responses"
    },
    {
      "level": "h2",
      "text": "Configure Cloudflare One",
      "id": "configure-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Download SP metadata (optional)",
      "id": "download-sp-metadata-(optional)"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up AWS IAM as a SAML provider",
      "id": "set-up-aws-iam-as-a-saml-provider"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up Amazon Cognito (OIDC)",
      "id": "set-up-amazon-cognito-(oidc)"
    },
    {
      "level": "h3",
      "text": "1. Obtain Amazon Cognito settings",
      "id": "1.-obtain-amazon-cognito-settings"
    },
    {
      "level": "h3",
      "text": "2. Add Amazon Cognito as an identity provider",
      "id": "2.-add-amazon-cognito-as-an-identity-provider"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up Centrify as an OIDC provider",
      "id": "set-up-centrify-as-an-oidc-provider"
    },
    {
      "level": "h3",
      "text": "1. Create an application in Centrify",
      "id": "1.-create-an-application-in-centrify"
    },
    {
      "level": "h3",
      "text": "2. Add Centrify to Cloudflare One",
      "id": "2.-add-centrify-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Example API Config",
      "id": "example-api-config"
    },
    {
      "level": "h2",
      "text": "Set up Centrify as a SAML provider",
      "id": "set-up-centrify-as-a-saml-provider"
    },
    {
      "level": "h2",
      "text": "1. Create an application in Centrify",
      "id": "1.-create-an-application-in-centrify"
    },
    {
      "level": "h3",
      "text": "2. Add Centrify to Cloudflare One",
      "id": "2.-add-centrify-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Download SP metadata (optional)",
      "id": "download-sp-metadata-(optional)"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up Citrix ADC (SAML)",
      "id": "set-up-citrix-adc-(saml)"
    },
    {
      "level": "h2",
      "text": "Add a new profile",
      "id": "add-a-new-profile"
    },
    {
      "level": "h2",
      "text": "Set up Entra ID as an identity provider",
      "id": "set-up-entra-id-as-an-identity-provider"
    },
    {
      "level": "h3",
      "text": "1. Obtain Entra ID settings",
      "id": "1.-obtain-entra-id-settings"
    },
    {
      "level": "h3",
      "text": "2. Configure API permissions in Entra ID",
      "id": "2.-configure-api-permissions-in-entra-id"
    },
    {
      "level": "h3",
      "text": "3. Add Entra ID as an identity provider",
      "id": "3.-add-entra-id-as-an-identity-provider"
    },
    {
      "level": "h2",
      "text": "Synchronize users and groups",
      "id": "synchronize-users-and-groups"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "1. Enable SCIM in Cloudflare One",
      "id": "1.-enable-scim-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "2. Configure SCIM in Entra ID",
      "id": "2.-configure-scim-in-entra-id"
    },
    {
      "level": "h3",
      "text": "Provisioning attributes",
      "id": "provisioning-attributes"
    },
    {
      "level": "h2",
      "text": "Entra groups in Zero Trust policies",
      "id": "entra-groups-in-zero-trust-policies"
    },
    {
      "level": "h3",
      "text": "Automatic entry",
      "id": "automatic-entry"
    },
    {
      "level": "h3",
      "text": "Manual entry",
      "id": "manual-entry"
    },
    {
      "level": "h3",
      "text": "Nested groups",
      "id": "nested-groups"
    },
    {
      "level": "h2",
      "text": "Force user interaction during WARP reauthentication",
      "id": "force-user-interaction-during-warp-reauthentication"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "1. Create an application in your identity provider",
      "id": "1.-create-an-application-in-your-identity-provider"
    },
    {
      "level": "h2",
      "text": "2. Add an OIDC provider to Cloudflare One",
      "id": "2.-add-an-oidc-provider-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "3. Test the connection",
      "id": "3.-test-the-connection"
    },
    {
      "level": "h2",
      "text": "Synchronize users and groups",
      "id": "synchronize-users-and-groups"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "1. Enable SCIM in Cloudflare One",
      "id": "1.-enable-scim-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "2. Configure SCIM in the IdP",
      "id": "2.-configure-scim-in-the-idp"
    },
    {
      "level": "h3",
      "text": "3. Verify SCIM provisioning",
      "id": "3.-verify-scim-provisioning"
    },
    {
      "level": "h2",
      "text": "Optional configurations",
      "id": "optional-configurations"
    },
    {
      "level": "h3",
      "text": "Custom OIDC claims",
      "id": "custom-oidc-claims"
    },
    {
      "level": "h2",
      "text": "Supported algorithms for generic OIDC tokens",
      "id": "supported-algorithms-for-generic-oidc-tokens"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Create an application in your identity provider",
      "id": "1.-create-an-application-in-your-identity-provider"
    },
    {
      "level": "h3",
      "text": "(Optional) Upload SAML metadata",
      "id": "(optional)-upload-saml-metadata"
    },
    {
      "level": "h2",
      "text": "2. Add a SAML identity provider to Cloudflare One",
      "id": "2.-add-a-saml-identity-provider-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "3. Test the connection",
      "id": "3.-test-the-connection"
    },
    {
      "level": "h2",
      "text": "Synchronize users and groups",
      "id": "synchronize-users-and-groups"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "1. Enable SCIM in Cloudflare One",
      "id": "1.-enable-scim-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "2. Configure SCIM in the IdP",
      "id": "2.-configure-scim-in-the-idp"
    },
    {
      "level": "h3",
      "text": "3. Verify SCIM provisioning",
      "id": "3.-verify-scim-provisioning"
    },
    {
      "level": "h2",
      "text": "Optional configurations",
      "id": "optional-configurations"
    },
    {
      "level": "h3",
      "text": "Sign SAML authentication request",
      "id": "sign-saml-authentication-request"
    },
    {
      "level": "h3",
      "text": "Email attribute name",
      "id": "email-attribute-name"
    },
    {
      "level": "h3",
      "text": "SAML headers and attributes",
      "id": "saml-headers-and-attributes"
    },
    {
      "level": "h2",
      "text": "Set up GitHub Access",
      "id": "set-up-github-access"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up Google as an identity provider",
      "id": "set-up-google-as-an-identity-provider"
    },
    {
      "level": "h2",
      "text": "Test your connection",
      "id": "test-your-connection"
    },
    {
      "level": "h2",
      "text": "Example API Config",
      "id": "example-api-config"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "`Error 401: deleted_client`",
      "id": "`error-401:-deleted_client`"
    },
    {
      "level": "h2",
      "text": "Set up Jumpcloud as a SAML provider",
      "id": "set-up-jumpcloud-as-a-saml-provider"
    },
    {
      "level": "h3",
      "text": "1. Create an SSO application in JumpCloud",
      "id": "1.-create-an-sso-application-in-jumpcloud"
    },
    {
      "level": "h3",
      "text": "2. Add JumpCloud to Cloudflare One",
      "id": "2.-add-jumpcloud-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Synchronize users and groups",
      "id": "synchronize-users-and-groups"
    },
    {
      "level": "h3",
      "text": "1. Enable SCIM in Cloudflare One",
      "id": "1.-enable-scim-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "2. Configure SCIM in JumpCloud",
      "id": "2.-configure-scim-in-jumpcloud"
    },
    {
      "level": "h3",
      "text": "Provisioning attributes",
      "id": "provisioning-attributes"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up Google Workspace as an identity provider",
      "id": "set-up-google-workspace-as-an-identity-provider"
    },
    {
      "level": "h3",
      "text": "1. Configure Google Workspace",
      "id": "1.-configure-google-workspace"
    },
    {
      "level": "h3",
      "text": "2. Add Google Workspace to Cloudflare One",
      "id": "2.-add-google-workspace-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "`Error 401: deleted_client`",
      "id": "`error-401:-deleted_client`"
    },
    {
      "level": "h2",
      "text": "Set up Keycloak (SAML)",
      "id": "set-up-keycloak-(saml)"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up LinkedIn as an IdP",
      "id": "set-up-linkedin-as-an-idp"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Supported features",
      "id": "supported-features"
    },
    {
      "level": "h2",
      "text": "Set up Okta as an OIDC provider (Okta App Catalog)",
      "id": "set-up-okta-as-an-oidc-provider-(okta-app-catalog)"
    },
    {
      "level": "h2",
      "text": "Set up Okta as an OIDC provider (Custom App Integration)",
      "id": "set-up-okta-as-an-oidc-provider-(custom-app-integration)"
    },
    {
      "level": "h2",
      "text": "Synchronize users and groups",
      "id": "synchronize-users-and-groups"
    },
    {
      "level": "h3",
      "text": "1. Enable SCIM in Cloudflare One",
      "id": "1.-enable-scim-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "2. Configure SCIM in Okta",
      "id": "2.-configure-scim-in-okta"
    },
    {
      "level": "h2",
      "text": "Example API Configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "Failed to fetch user/group information from the identity",
      "id": "failed-to-fetch-user/group-information-from-the-identity"
    },
    {
      "level": "h2",
      "text": "Set up Okta as a SAML provider",
      "id": "set-up-okta-as-a-saml-provider"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up OTP",
      "id": "set-up-otp"
    },
    {
      "level": "h2",
      "text": "Log in with OTP",
      "id": "log-in-with-otp"
    },
    {
      "level": "h2",
      "text": "Set up OneLogin as an OIDC provider",
      "id": "set-up-onelogin-as-an-oidc-provider"
    },
    {
      "level": "h3",
      "text": "1. Create an application in OneLogin",
      "id": "1.-create-an-application-in-onelogin"
    },
    {
      "level": "h3",
      "text": "2. Add OneLogin to Cloudflare One",
      "id": "2.-add-onelogin-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Example API Config",
      "id": "example-api-config"
    },
    {
      "level": "h2",
      "text": "Set up OneLogin as a SAML provider",
      "id": "set-up-onelogin-as-a-saml-provider"
    },
    {
      "level": "h2",
      "text": "1. Create an application in OneLogin",
      "id": "1.-create-an-application-in-onelogin"
    },
    {
      "level": "h3",
      "text": "2. Add OneLogin to Cloudflare One",
      "id": "2.-add-onelogin-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Download SP metadata (optional)",
      "id": "download-sp-metadata-(optional)"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up PingFederate as an identity provider",
      "id": "set-up-pingfederate-as-an-identity-provider"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up PingOne as an OIDC provider",
      "id": "set-up-pingone-as-an-oidc-provider"
    },
    {
      "level": "h3",
      "text": "1. Create an application in PingOne",
      "id": "1.-create-an-application-in-pingone"
    },
    {
      "level": "h3",
      "text": "2. Add PingOne to Cloudflare One",
      "id": "2.-add-pingone-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Example API configuration",
      "id": "example-api-configuration"
    },
    {
      "level": "h2",
      "text": "Set up PingOne as a SAML provider",
      "id": "set-up-pingone-as-a-saml-provider"
    },
    {
      "level": "h2",
      "text": "1. Create an application in PingOne",
      "id": "1.-create-an-application-in-pingone"
    },
    {
      "level": "h3",
      "text": "2. Add PingOne to Cloudflare One",
      "id": "2.-add-pingone-to-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Set up Signed AuthN requests",
      "id": "set-up-signed-authn-requests"
    },
    {
      "level": "h2",
      "text": "Set up Yandex",
      "id": "set-up-yandex"
    },
    {
      "level": "h2",
      "text": "Example API Config",
      "id": "example-api-config"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up CrowdStrike as a service provider",
      "id": "set-up-crowdstrike-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "1. Obtain CrowdStrike settings",
      "id": "1.-obtain-crowdstrike-settings"
    },
    {
      "level": "h3",
      "text": "2. Add CrowdStrike as a service provider",
      "id": "2.-add-crowdstrike-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up Kolide as a service provider",
      "id": "set-up-kolide-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "1. Create a Client Secret in Kolide",
      "id": "1.-create-a-client-secret-in-kolide"
    },
    {
      "level": "h3",
      "text": "2. Add Kolide as a service provider",
      "id": "2.-add-kolide-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "External API requirements",
      "id": "external-api-requirements"
    },
    {
      "level": "h3",
      "text": "Authentication",
      "id": "authentication"
    },
    {
      "level": "h3",
      "text": "Data passed to external API",
      "id": "data-passed-to-external-api"
    },
    {
      "level": "h3",
      "text": "Expected response from external API",
      "id": "expected-response-from-external-api"
    },
    {
      "level": "h2",
      "text": "Set up custom device posture checks",
      "id": "set-up-custom-device-posture-checks"
    },
    {
      "level": "h3",
      "text": "1. Create a service token",
      "id": "1.-create-a-service-token"
    },
    {
      "level": "h3",
      "text": "2. Create an Access application",
      "id": "2.-create-an-access-application"
    },
    {
      "level": "h3",
      "text": "3. Add a service provider integration",
      "id": "3.-add-a-service-provider-integration"
    },
    {
      "level": "h3",
      "text": "4. Configure the posture check",
      "id": "4.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Obtain Microsoft Graph settings",
      "id": "1.-obtain-microsoft-graph-settings"
    },
    {
      "level": "h2",
      "text": "2. Add Intune as a service provider",
      "id": "2.-add-intune-as-a-service-provider"
    },
    {
      "level": "h2",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up SentinelOne as a service provider",
      "id": "set-up-sentinelone-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "1. Obtain SentinelOne settings",
      "id": "1.-obtain-sentinelone-settings"
    },
    {
      "level": "h3",
      "text": "2. Add SentinelOne as a service provider",
      "id": "2.-add-sentinelone-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h3",
      "text": "Detect user risk behavior",
      "id": "detect-user-risk-behavior"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up Tanium as a service provider",
      "id": "set-up-tanium-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "1. Get Tanium settings",
      "id": "1.-get-tanium-settings"
    },
    {
      "level": "h3",
      "text": "2. Add Tanium as a service provider",
      "id": "2.-add-tanium-as-a-service-provider"
    },
    {
      "level": "h3",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Obtain Uptycs Settings",
      "id": "1.-obtain-uptycs-settings"
    },
    {
      "level": "h2",
      "text": "2. Add Uptycs as a service provider",
      "id": "2.-add-uptycs-as-a-service-provider"
    },
    {
      "level": "h2",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Obtain Workspace ONE Settings",
      "id": "1.-obtain-workspace-one-settings"
    },
    {
      "level": "h2",
      "text": "2. Add Workspace ONE as a service provider",
      "id": "2.-add-workspace-one-as-a-service-provider"
    },
    {
      "level": "h2",
      "text": "3. Configure the posture check",
      "id": "3.-configure-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Device posture attributes",
      "id": "device-posture-attributes"
    },
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h2",
      "text": "Outbound-only connection",
      "id": "outbound-only-connection"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "Features",
      "id": "features"
    },
    {
      "level": "h3",
      "text": "Connect your network automatically",
      "id": "connect-your-network-automatically"
    },
    {
      "level": "h3",
      "text": "Connect your network manually",
      "id": "connect-your-network-manually"
    },
    {
      "level": "h3",
      "text": "Zero Trust integration",
      "id": "zero-trust-integration"
    },
    {
      "level": "h3",
      "text": "BGP peering",
      "id": "bgp-peering"
    },
    {
      "level": "h2",
      "text": "Related products",
      "id": "related-products"
    },
    {
      "level": "h2",
      "text": "More resources",
      "id": "more-resources"
    },
    {
      "level": "h2",
      "text": "Types of proxy endpoints",
      "id": "types-of-proxy-endpoints"
    },
    {
      "level": "h3",
      "text": "Authorization endpoint Beta",
      "id": "authorization-endpoint-beta"
    },
    {
      "level": "h3",
      "text": "Source IP endpoint",
      "id": "source-ip-endpoint"
    },
    {
      "level": "h2",
      "text": "1. Create a proxy endpoint",
      "id": "1.-create-a-proxy-endpoint"
    },
    {
      "level": "h2",
      "text": "2. Create a PAC file",
      "id": "2.-create-a-pac-file"
    },
    {
      "level": "h3",
      "text": "Create a hosted PAC file Beta",
      "id": "create-a-hosted-pac-file-beta"
    },
    {
      "level": "h3",
      "text": "Self-hosting PAC files",
      "id": "self-hosting-pac-files"
    },
    {
      "level": "h2",
      "text": "3. Configure your devices",
      "id": "3.-configure-your-devices"
    },
    {
      "level": "h3",
      "text": "3a. Install Cloudflare certificate",
      "id": "3a.-install-cloudflare-certificate"
    },
    {
      "level": "h3",
      "text": "3b. Configure browser to use PAC file",
      "id": "3b.-configure-browser-to-use-pac-file"
    },
    {
      "level": "h2",
      "text": "4. Test your HTTP policy",
      "id": "4.-test-your-http-policy"
    },
    {
      "level": "h2",
      "text": "5. (Optional) Configure firewall",
      "id": "5.-(optional)-configure-firewall"
    },
    {
      "level": "h2",
      "text": "Edit proxy endpoints",
      "id": "edit-proxy-endpoints"
    },
    {
      "level": "h3",
      "text": "Edit authorization endpoint",
      "id": "edit-authorization-endpoint"
    },
    {
      "level": "h3",
      "text": "Edit source IP endpoint",
      "id": "edit-source-ip-endpoint"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Traffic limitations",
      "id": "traffic-limitations"
    },
    {
      "level": "h3",
      "text": "Session duration",
      "id": "session-duration"
    },
    {
      "level": "h3",
      "text": "Gateway DNS and resolver policies",
      "id": "gateway-dns-and-resolver-policies"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Set up Clientless Web Isolation",
      "id": "set-up-clientless-web-isolation"
    },
    {
      "level": "h3",
      "text": "Open links in Browser Isolation",
      "id": "open-links-in-browser-isolation"
    },
    {
      "level": "h2",
      "text": "Filter DNS queries",
      "id": "filter-dns-queries"
    },
    {
      "level": "h2",
      "text": "Use the remote browser",
      "id": "use-the-remote-browser"
    },
    {
      "level": "h2",
      "text": "Optional configurations",
      "id": "optional-configurations"
    },
    {
      "level": "h3",
      "text": "Allow or block websites",
      "id": "allow-or-block-websites"
    },
    {
      "level": "h3",
      "text": "Bypass TLS decryption",
      "id": "bypass-tls-decryption"
    },
    {
      "level": "h3",
      "text": "Connect private networks",
      "id": "connect-private-networks"
    },
    {
      "level": "h3",
      "text": "Disable remote browser controls",
      "id": "disable-remote-browser-controls"
    },
    {
      "level": "h3",
      "text": "Sync cookies between local and remote browser",
      "id": "sync-cookies-between-local-and-remote-browser"
    },
    {
      "level": "h2",
      "text": "Address bar",
      "id": "address-bar"
    },
    {
      "level": "h3",
      "text": "Hostname notch view",
      "id": "hostname-notch-view"
    },
    {
      "level": "h3",
      "text": "Full address bar view",
      "id": "full-address-bar-view"
    },
    {
      "level": "h3",
      "text": "Hidden view",
      "id": "hidden-view"
    },
    {
      "level": "h2",
      "text": "Logs",
      "id": "logs"
    },
    {
      "level": "h2",
      "text": "Redirect traffic to the remote browser",
      "id": "redirect-traffic-to-the-remote-browser"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Set up non-identity browser isolation",
      "id": "set-up-non-identity-browser-isolation"
    },
    {
      "level": "h2",
      "text": "Types of block pages",
      "id": "types-of-block-pages"
    },
    {
      "level": "h3",
      "text": "Identity versus non-identity",
      "id": "identity-versus-non-identity"
    },
    {
      "level": "h2",
      "text": "Create a custom block page",
      "id": "create-a-custom-block-page"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure the block page",
      "id": "configure-the-block-page"
    },
    {
      "level": "h3",
      "text": "Use the default block page",
      "id": "use-the-default-block-page"
    },
    {
      "level": "h3",
      "text": "Redirect to a block page",
      "id": "redirect-to-a-block-page"
    },
    {
      "level": "h3",
      "text": "Customize the block page",
      "id": "customize-the-block-page"
    },
    {
      "level": "h2",
      "text": "Configure policy block behavior",
      "id": "configure-policy-block-behavior"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Certificate error",
      "id": "certificate-error"
    },
    {
      "level": "h3",
      "text": "Incompatible DNS record types",
      "id": "incompatible-dns-record-types"
    },
    {
      "level": "h3",
      "text": "Third-party filtering conflict",
      "id": "third-party-filtering-conflict"
    },
    {
      "level": "h3",
      "text": "Data center and IP address matching",
      "id": "data-center-and-ip-address-matching"
    },
    {
      "level": "h2",
      "text": "Supported operating systems",
      "id": "supported-operating-systems"
    },
    {
      "level": "h2",
      "text": "Supported WARP modes",
      "id": "supported-warp-modes"
    },
    {
      "level": "h2",
      "text": "Supported operating systems",
      "id": "supported-operating-systems"
    },
    {
      "level": "h2",
      "text": "Certificate status",
      "id": "certificate-status"
    },
    {
      "level": "h2",
      "text": "Generate a Cloudflare root certificate",
      "id": "generate-a-cloudflare-root-certificate"
    },
    {
      "level": "h2",
      "text": "Activate a root certificate",
      "id": "activate-a-root-certificate"
    },
    {
      "level": "h2",
      "text": "About Cloudflare WARP",
      "id": "about-cloudflare-warp"
    },
    {
      "level": "h2",
      "text": "How WARP works",
      "id": "how-warp-works"
    },
    {
      "level": "h2",
      "text": "WARP installation details",
      "id": "warp-installation-details"
    },
    {
      "level": "h2",
      "text": "Key benefits of using WARP",
      "id": "key-benefits-of-using-warp"
    },
    {
      "level": "h2",
      "text": "WARP modes",
      "id": "warp-modes"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "User risk scoring",
      "id": "user-risk-scoring"
    },
    {
      "level": "h3",
      "text": "View a user's risk score",
      "id": "view-a-user's-risk-score"
    },
    {
      "level": "h3",
      "text": "Clear a user's risk score",
      "id": "clear-a-user's-risk-score"
    },
    {
      "level": "h3",
      "text": "Send risk score to Okta",
      "id": "send-risk-score-to-okta"
    },
    {
      "level": "h2",
      "text": "Predefined risk behaviors",
      "id": "predefined-risk-behaviors"
    },
    {
      "level": "h2",
      "text": "Manage risk behaviors",
      "id": "manage-risk-behaviors"
    },
    {
      "level": "h3",
      "text": "Enable risk behaviors",
      "id": "enable-risk-behaviors"
    },
    {
      "level": "h3",
      "text": "Disable risk behaviors",
      "id": "disable-risk-behaviors"
    },
    {
      "level": "h3",
      "text": "Change risk behavior risk levels",
      "id": "change-risk-behavior-risk-levels"
    },
    {
      "level": "h2",
      "text": "Supported identity providers",
      "id": "supported-identity-providers"
    },
    {
      "level": "h2",
      "text": "Sync users and groups in Zero Trust policies",
      "id": "sync-users-and-groups-in-zero-trust-policies"
    },
    {
      "level": "h2",
      "text": "Authentication events",
      "id": "authentication-events"
    },
    {
      "level": "h2",
      "text": "Manage users",
      "id": "manage-users"
    },
    {
      "level": "h3",
      "text": "Check number of seats used",
      "id": "check-number-of-seats-used"
    },
    {
      "level": "h3",
      "text": "Revoke a user",
      "id": "revoke-a-user"
    },
    {
      "level": "h3",
      "text": "Remove a user",
      "id": "remove-a-user"
    },
    {
      "level": "h3",
      "text": "Enable seat expiration",
      "id": "enable-seat-expiration"
    },
    {
      "level": "h2",
      "text": "View user logs",
      "id": "view-user-logs"
    },
    {
      "level": "h3",
      "text": "Available logs",
      "id": "available-logs"
    },
    {
      "level": "h2",
      "text": "Allow corporate domains",
      "id": "allow-corporate-domains"
    },
    {
      "level": "h2",
      "text": "Block security threats",
      "id": "block-security-threats"
    },
    {
      "level": "h2",
      "text": "Block content categories",
      "id": "block-content-categories"
    },
    {
      "level": "h2",
      "text": "Block a dynamic list of categories",
      "id": "block-a-dynamic-list-of-categories"
    },
    {
      "level": "h2",
      "text": "Block unauthorized applications",
      "id": "block-unauthorized-applications"
    },
    {
      "level": "h2",
      "text": "Block banned countries",
      "id": "block-banned-countries"
    },
    {
      "level": "h2",
      "text": "Block top-level domains",
      "id": "block-top-level-domains"
    },
    {
      "level": "h2",
      "text": "Block phishing attacks",
      "id": "block-phishing-attacks"
    },
    {
      "level": "h2",
      "text": "Block online tracking",
      "id": "block-online-tracking"
    },
    {
      "level": "h2",
      "text": "Block malicious IPs",
      "id": "block-malicious-ips"
    },
    {
      "level": "h2",
      "text": "Turn on CIPA filter",
      "id": "turn-on-cipa-filter"
    },
    {
      "level": "h2",
      "text": "Hide explicit search results",
      "id": "hide-explicit-search-results"
    },
    {
      "level": "h2",
      "text": "Check user identity",
      "id": "check-user-identity"
    },
    {
      "level": "h2",
      "text": "Restrict access to specific groups",
      "id": "restrict-access-to-specific-groups"
    },
    {
      "level": "h3",
      "text": "1. Allow a group",
      "id": "1.-allow-a-group"
    },
    {
      "level": "h3",
      "text": "2. Block all other users",
      "id": "2.-block-all-other-users"
    },
    {
      "level": "h2",
      "text": "Control IP version",
      "id": "control-ip-version"
    },
    {
      "level": "h3",
      "text": "Force IPv4",
      "id": "force-ipv4"
    },
    {
      "level": "h3",
      "text": "Force IPv6",
      "id": "force-ipv6"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Test a DNS policy",
      "id": "test-a-dns-policy"
    },
    {
      "level": "h3",
      "text": "Test a security or content category",
      "id": "test-a-security-or-content-category"
    },
    {
      "level": "h2",
      "text": "Test EDNS configuration",
      "id": "test-edns-configuration"
    },
    {
      "level": "h2",
      "text": "Clear DNS cache",
      "id": "clear-dns-cache"
    },
    {
      "level": "h2",
      "text": "Policy duration",
      "id": "policy-duration"
    },
    {
      "level": "h3",
      "text": "Reset a policy's duration",
      "id": "reset-a-policy's-duration"
    },
    {
      "level": "h2",
      "text": "Policy schedule",
      "id": "policy-schedule"
    },
    {
      "level": "h3",
      "text": "How Gateway determines time zone",
      "id": "how-gateway-determines-time-zone"
    },
    {
      "level": "h2",
      "text": "Turn on egress IPs",
      "id": "turn-on-egress-ips"
    },
    {
      "level": "h2",
      "text": "Verify egress IPs",
      "id": "verify-egress-ips"
    },
    {
      "level": "h2",
      "text": "IPs",
      "id": "ips"
    },
    {
      "level": "h3",
      "text": "Bring your own IP address (BYOIP)",
      "id": "bring-your-own-ip-address-(byoip)"
    },
    {
      "level": "h3",
      "text": "Cloudflare IPs",
      "id": "cloudflare-ips"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Concurrent connections",
      "id": "concurrent-connections"
    },
    {
      "level": "h3",
      "text": "Unsupported traffic",
      "id": "unsupported-traffic"
    },
    {
      "level": "h3",
      "text": "Traffic resilience",
      "id": "traffic-resilience"
    },
    {
      "level": "h3",
      "text": "IP geolocation",
      "id": "ip-geolocation"
    },
    {
      "level": "h3",
      "text": "Egress location",
      "id": "egress-location"
    },
    {
      "level": "h2",
      "text": "Frequently asked questions (FAQ)",
      "id": "frequently-asked-questions-(faq)"
    },
    {
      "level": "h3",
      "text": "Can I provision the same egress IP address to multiple data centers?",
      "id": "can-i-provision-the-same-egress-ip-address-to-multiple-data-centers?"
    },
    {
      "level": "h3",
      "text": "Can my users in different locations egress from their closest data center via a single egress IP?",
      "id": "can-my-users-in-different-locations-egress-from-their-closest-data-center-via-a-single-egress-ip?"
    },
    {
      "level": "h3",
      "text": "Can I use dedicated egress IPs with traffic proxied via [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)?",
      "id": "can-i-use-dedicated-egress-ips-with-traffic-proxied-via-[pac-files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)?"
    },
    {
      "level": "h3",
      "text": "What happens when I use dedicated egress IPs with [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/)?",
      "id": "what-happens-when-i-use-dedicated-egress-ips-with-[cloudflare-browser-isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/)?"
    },
    {
      "level": "h3",
      "text": "Do dedicated egress IPs work on the [Cloudflare China Network](https://developers.cloudflare.com/china-network/)?",
      "id": "do-dedicated-egress-ips-work-on-the-[cloudflare-china-network](https://developers.cloudflare.com/china-network/)?"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "1. Connect your private network",
      "id": "1.-connect-your-private-network"
    },
    {
      "level": "h2",
      "text": "2. Add a public hostname route",
      "id": "2.-add-a-public-hostname-route"
    },
    {
      "level": "h2",
      "text": "3. Route network traffic through WARP",
      "id": "3.-route-network-traffic-through-warp"
    },
    {
      "level": "h3",
      "text": "Initial resolved IPs",
      "id": "initial-resolved-ips"
    },
    {
      "level": "h3",
      "text": "Private network IPs",
      "id": "private-network-ips"
    },
    {
      "level": "h2",
      "text": "4. (Optional) Configure network policies",
      "id": "4.-(optional)-configure-network-policies"
    },
    {
      "level": "h2",
      "text": "5. Test the connection",
      "id": "5.-test-the-connection"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Google Chrome restricts local network access",
      "id": "google-chrome-restricts-local-network-access"
    },
    {
      "level": "h2",
      "text": "Turn on Host selectors",
      "id": "turn-on-host-selectors"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Configuration changes",
      "id": "configuration-changes"
    },
    {
      "level": "h2",
      "text": "Known issues",
      "id": "known-issues"
    },
    {
      "level": "h3",
      "text": "Google Chrome restricts local network access",
      "id": "google-chrome-restricts-local-network-access"
    },
    {
      "level": "h2",
      "text": "Get started",
      "id": "get-started"
    },
    {
      "level": "h3",
      "text": "WARP client block notifications",
      "id": "warp-client-block-notifications"
    },
    {
      "level": "h2",
      "text": "File scan criteria",
      "id": "file-scan-criteria"
    },
    {
      "level": "h2",
      "text": "Opt content out from scanning",
      "id": "opt-content-out-from-scanning"
    },
    {
      "level": "h2",
      "text": "Compatibility",
      "id": "compatibility"
    },
    {
      "level": "h3",
      "text": "Supported compressed file types",
      "id": "supported-compressed-file-types"
    },
    {
      "level": "h3",
      "text": "Non-scannable files",
      "id": "non-scannable-files"
    },
    {
      "level": "h2",
      "text": "Block sites",
      "id": "block-sites"
    },
    {
      "level": "h3",
      "text": "Block sites by hostname",
      "id": "block-sites-by-hostname"
    },
    {
      "level": "h3",
      "text": "Block sites by URL",
      "id": "block-sites-by-url"
    },
    {
      "level": "h2",
      "text": "Block content categories",
      "id": "block-content-categories"
    },
    {
      "level": "h2",
      "text": "Block unauthorized applications",
      "id": "block-unauthorized-applications"
    },
    {
      "level": "h2",
      "text": "Check user identity",
      "id": "check-user-identity"
    },
    {
      "level": "h2",
      "text": "Skip inspection for groups of applications",
      "id": "skip-inspection-for-groups-of-applications"
    },
    {
      "level": "h2",
      "text": "Check device posture",
      "id": "check-device-posture"
    },
    {
      "level": "h3",
      "text": "Enforce a minimum OS version",
      "id": "enforce-a-minimum-os-version"
    },
    {
      "level": "h3",
      "text": "Check for a specific file",
      "id": "check-for-a-specific-file"
    },
    {
      "level": "h2",
      "text": "Enforce session duration",
      "id": "enforce-session-duration"
    },
    {
      "level": "h2",
      "text": "Isolate high risk sites in remote browser",
      "id": "isolate-high-risk-sites-in-remote-browser"
    },
    {
      "level": "h2",
      "text": "Bypass inspection for self-signed certificates",
      "id": "bypass-inspection-for-self-signed-certificates"
    },
    {
      "level": "h2",
      "text": "Block file types",
      "id": "block-file-types"
    },
    {
      "level": "h2",
      "text": "Isolate or block shadow IT applications",
      "id": "isolate-or-block-shadow-it-applications"
    },
    {
      "level": "h3",
      "text": "1. Isolate unreviewed or in review applications",
      "id": "1.-isolate-unreviewed-or-in-review-applications"
    },
    {
      "level": "h3",
      "text": "2. Block unapproved applications",
      "id": "2.-block-unapproved-applications"
    },
    {
      "level": "h2",
      "text": "Block Google services",
      "id": "block-google-services"
    },
    {
      "level": "h3",
      "text": "Block Google Drive downloads",
      "id": "block-google-drive-downloads"
    },
    {
      "level": "h3",
      "text": "Block Google Drive uploads",
      "id": "block-google-drive-uploads"
    },
    {
      "level": "h3",
      "text": "Block Gmail downloads",
      "id": "block-gmail-downloads"
    },
    {
      "level": "h3",
      "text": "Block Google Translate proxy",
      "id": "block-google-translate-proxy"
    },
    {
      "level": "h2",
      "text": "Filter WebSocket traffic",
      "id": "filter-websocket-traffic"
    },
    {
      "level": "h2",
      "text": "Get started",
      "id": "get-started"
    },
    {
      "level": "h2",
      "text": "Create test policy",
      "id": "create-test-policy"
    },
    {
      "level": "h2",
      "text": "Sandbox environment",
      "id": "sandbox-environment"
    },
    {
      "level": "h2",
      "text": "Compatibility",
      "id": "compatibility"
    },
    {
      "level": "h3",
      "text": "Supported file types",
      "id": "supported-file-types"
    },
    {
      "level": "h3",
      "text": "Non-scannable files",
      "id": "non-scannable-files"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Create a policy with Application Granular Controls",
      "id": "create-a-policy-with-application-granular-controls"
    },
    {
      "level": "h2",
      "text": "Control definitions",
      "id": "control-definitions"
    },
    {
      "level": "h3",
      "text": "Application Controls",
      "id": "application-controls"
    },
    {
      "level": "h3",
      "text": "Operations",
      "id": "operations"
    },
    {
      "level": "h3",
      "text": "DLP payloads",
      "id": "dlp-payloads"
    },
    {
      "level": "h2",
      "text": "Application APIs",
      "id": "application-apis"
    },
    {
      "level": "h2",
      "text": "Compatible applications",
      "id": "compatible-applications"
    },
    {
      "level": "h2",
      "text": "Turn on HTTP/3 inspection",
      "id": "turn-on-http/3-inspection"
    },
    {
      "level": "h3",
      "text": "Application limitations",
      "id": "application-limitations"
    },
    {
      "level": "h2",
      "text": "Exempt HTTP/3 traffic from inspection",
      "id": "exempt-http/3-traffic-from-inspection"
    },
    {
      "level": "h2",
      "text": "Force HTTP/2 traffic",
      "id": "force-http/2-traffic"
    },
    {
      "level": "h2",
      "text": "Add custom headers for a SaaS application",
      "id": "add-custom-headers-for-a-saas-application"
    },
    {
      "level": "h3",
      "text": "Verify custom headers",
      "id": "verify-custom-headers"
    },
    {
      "level": "h2",
      "text": "Common policy configurations",
      "id": "common-policy-configurations"
    },
    {
      "level": "h3",
      "text": "Microsoft 365",
      "id": "microsoft-365"
    },
    {
      "level": "h3",
      "text": "Google Workspace",
      "id": "google-workspace"
    },
    {
      "level": "h3",
      "text": "Slack",
      "id": "slack"
    },
    {
      "level": "h3",
      "text": "Dropbox",
      "id": "dropbox"
    },
    {
      "level": "h3",
      "text": "ChatGPT",
      "id": "chatgpt"
    },
    {
      "level": "h2",
      "text": "Exempt users in Cloudflare WAF",
      "id": "exempt-users-in-cloudflare-waf"
    },
    {
      "level": "h2",
      "text": "Use tenant control with Browser Isolation",
      "id": "use-tenant-control-with-browser-isolation"
    },
    {
      "level": "h2",
      "text": "Turn on TLS decryption",
      "id": "turn-on-tls-decryption"
    },
    {
      "level": "h2",
      "text": "Inspection limitations",
      "id": "inspection-limitations"
    },
    {
      "level": "h3",
      "text": "Inspect on all ports Beta",
      "id": "inspect-on-all-ports-beta"
    },
    {
      "level": "h3",
      "text": "Incompatible certificates",
      "id": "incompatible-certificates"
    },
    {
      "level": "h3",
      "text": "Google Chrome automatic HTTPS upgrades",
      "id": "google-chrome-automatic-https-upgrades"
    },
    {
      "level": "h3",
      "text": "Mutual TLS (mTLS)",
      "id": "mutual-tls-(mtls)"
    },
    {
      "level": "h3",
      "text": "ESNI and ECH",
      "id": "esni-and-ech"
    },
    {
      "level": "h2",
      "text": "Post-quantum support",
      "id": "post-quantum-support"
    },
    {
      "level": "h2",
      "text": "FIPS compliance",
      "id": "fips-compliance"
    },
    {
      "level": "h3",
      "text": "Enable FIPS compliance",
      "id": "enable-fips-compliance"
    },
    {
      "level": "h3",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "FedRAMP compliance",
      "id": "fedramp-compliance"
    },
    {
      "level": "h2",
      "text": "Cipher suites",
      "id": "cipher-suites"
    },
    {
      "level": "h2",
      "text": "1. Connect to Gateway",
      "id": "1.-connect-to-gateway"
    },
    {
      "level": "h3",
      "text": "Connect devices",
      "id": "connect-devices"
    },
    {
      "level": "h3",
      "text": "Connect DNS locations",
      "id": "connect-dns-locations"
    },
    {
      "level": "h2",
      "text": "2. Verify device connectivity",
      "id": "2.-verify-device-connectivity"
    },
    {
      "level": "h2",
      "text": "3. Create your first DNS policy",
      "id": "3.-create-your-first-dns-policy"
    },
    {
      "level": "h2",
      "text": "4. Add optional policies",
      "id": "4.-add-optional-policies"
    },
    {
      "level": "h2",
      "text": "1. Connect to Gateway",
      "id": "1.-connect-to-gateway"
    },
    {
      "level": "h2",
      "text": "2. Verify device connectivity",
      "id": "2.-verify-device-connectivity"
    },
    {
      "level": "h2",
      "text": "3. Create your first HTTP policy",
      "id": "3.-create-your-first-http-policy"
    },
    {
      "level": "h2",
      "text": "4. Add optional policies",
      "id": "4.-add-optional-policies"
    },
    {
      "level": "h2",
      "text": "1. Connect to Gateway",
      "id": "1.-connect-to-gateway"
    },
    {
      "level": "h3",
      "text": "Connect devices",
      "id": "connect-devices"
    },
    {
      "level": "h3",
      "text": "Connect private networks",
      "id": "connect-private-networks"
    },
    {
      "level": "h2",
      "text": "2. Verify device connectivity",
      "id": "2.-verify-device-connectivity"
    },
    {
      "level": "h2",
      "text": "3. Create your first network policy",
      "id": "3.-create-your-first-network-policy"
    },
    {
      "level": "h2",
      "text": "4. Add optional policies",
      "id": "4.-add-optional-policies"
    },
    {
      "level": "h2",
      "text": "Block unauthorized applications",
      "id": "block-unauthorized-applications"
    },
    {
      "level": "h2",
      "text": "Check user identity",
      "id": "check-user-identity"
    },
    {
      "level": "h2",
      "text": "Enforce device posture",
      "id": "enforce-device-posture"
    },
    {
      "level": "h2",
      "text": "Enforce session duration",
      "id": "enforce-session-duration"
    },
    {
      "level": "h2",
      "text": "Allow only approved traffic",
      "id": "allow-only-approved-traffic"
    },
    {
      "level": "h3",
      "text": "1. Allow HTTP and HTTPS traffic",
      "id": "1.-allow-http-and-https-traffic"
    },
    {
      "level": "h3",
      "text": "2. Block all other traffic",
      "id": "2.-block-all-other-traffic"
    },
    {
      "level": "h2",
      "text": "Filter HTTPS traffic when inspecting on all ports",
      "id": "filter-https-traffic-when-inspecting-on-all-ports"
    },
    {
      "level": "h2",
      "text": "Restrict private network access to proxy endpoint users",
      "id": "restrict-private-network-access-to-proxy-endpoint-users"
    },
    {
      "level": "h3",
      "text": "Source IP proxy endpoints",
      "id": "source-ip-proxy-endpoints"
    },
    {
      "level": "h3",
      "text": "Authorization proxy endpoints",
      "id": "authorization-proxy-endpoints"
    },
    {
      "level": "h2",
      "text": "Restrict access to private networks",
      "id": "restrict-access-to-private-networks"
    },
    {
      "level": "h3",
      "text": "1. Allow company employees",
      "id": "1.-allow-company-employees"
    },
    {
      "level": "h3",
      "text": "2. Block everyone else",
      "id": "2.-block-everyone-else"
    },
    {
      "level": "h2",
      "text": "Override IP address",
      "id": "override-ip-address"
    },
    {
      "level": "h2",
      "text": "Turn on protocol detection",
      "id": "turn-on-protocol-detection"
    },
    {
      "level": "h3",
      "text": "Inspect on all ports Beta",
      "id": "inspect-on-all-ports-beta"
    },
    {
      "level": "h2",
      "text": "Supported protocols",
      "id": "supported-protocols"
    },
    {
      "level": "h2",
      "text": "Example network policy",
      "id": "example-network-policy"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Ensure Unix usernames match user SSO identities",
      "id": "1.-ensure-unix-usernames-match-user-sso-identities"
    },
    {
      "level": "h2",
      "text": "2. Generate a Gateway SSH proxy CA",
      "id": "2.-generate-a-gateway-ssh-proxy-ca"
    },
    {
      "level": "h2",
      "text": "3. Save the public key",
      "id": "3.-save-the-public-key"
    },
    {
      "level": "h2",
      "text": "4. Modify your `sshd_config` file",
      "id": "4.-modify-your-`sshd_config`-file"
    },
    {
      "level": "h2",
      "text": "5. Check your SSH port number",
      "id": "5.-check-your-ssh-port-number"
    },
    {
      "level": "h2",
      "text": "6. Restart your SSH server",
      "id": "6.-restart-your-ssh-server"
    },
    {
      "level": "h2",
      "text": "7. Create an Audit SSH policy",
      "id": "7.-create-an-audit-ssh-policy"
    },
    {
      "level": "h2",
      "text": "8. Connect as a user",
      "id": "8.-connect-as-a-user"
    },
    {
      "level": "h2",
      "text": "(Optional) Configure SSH Command Logging",
      "id": "(optional)-configure-ssh-command-logging"
    },
    {
      "level": "h2",
      "text": "View SSH Logs",
      "id": "view-ssh-logs"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Add a rule",
      "id": "add-a-rule"
    },
    {
      "level": "h2",
      "text": "Create a disabled rule",
      "id": "create-a-disabled-rule"
    },
    {
      "level": "h2",
      "text": "Update a rule",
      "id": "update-a-rule"
    },
    {
      "level": "h2",
      "text": "Delete an existing rule",
      "id": "delete-an-existing-rule"
    },
    {
      "level": "h2",
      "text": "API",
      "id": "api"
    },
    {
      "level": "h3",
      "text": "Skip action",
      "id": "skip-action"
    },
    {
      "level": "h3",
      "text": "Block a country",
      "id": "block-a-country"
    },
    {
      "level": "h3",
      "text": "Use an IP list",
      "id": "use-an-ip-list"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "Add a rule",
      "id": "add-a-rule"
    },
    {
      "level": "h2",
      "text": "Edit an existing rule",
      "id": "edit-an-existing-rule"
    },
    {
      "level": "h2",
      "text": "Delete an existing rule",
      "id": "delete-an-existing-rule"
    },
    {
      "level": "h2",
      "text": "API",
      "id": "api"
    },
    {
      "level": "h3",
      "text": "1. Create a Managed phase Managed kind ruleset",
      "id": "1.-create-a-managed-phase-managed-kind-ruleset"
    },
    {
      "level": "h3",
      "text": "2. Patch a Managed phase Managed kind ruleset",
      "id": "2.-patch-a-managed-phase-managed-kind-ruleset"
    },
    {
      "level": "h3",
      "text": "3. Enable all rules",
      "id": "3.-enable-all-rules"
    },
    {
      "level": "h3",
      "text": "4. Delete a ruleset",
      "id": "4.-delete-a-ruleset"
    },
    {
      "level": "h2",
      "text": "Cloudflare One dashboard",
      "id": "cloudflare-one-dashboard"
    },
    {
      "level": "h3",
      "text": "Enable rules",
      "id": "enable-rules"
    },
    {
      "level": "h3",
      "text": "Edit rules",
      "id": "edit-rules"
    },
    {
      "level": "h3",
      "text": "View rules",
      "id": "view-rules"
    },
    {
      "level": "h2",
      "text": "Capabilities",
      "id": "capabilities"
    },
    {
      "level": "h2",
      "text": "Restrictions",
      "id": "restrictions"
    },
    {
      "level": "h2",
      "text": "Features",
      "id": "features"
    },
    {
      "level": "h3",
      "text": "Intrusion Detection System (IDS)",
      "id": "intrusion-detection-system-(ids)"
    },
    {
      "level": "h2",
      "text": "Related products",
      "id": "related-products"
    },
    {
      "level": "h2",
      "text": "Security policy",
      "id": "security-policy"
    },
    {
      "level": "h2",
      "text": "Packet filtering policies and Magic Transit endpoint health checks",
      "id": "packet-filtering-policies-and-magic-transit-endpoint-health-checks"
    },
    {
      "level": "h2",
      "text": "Magic Firewall phases",
      "id": "magic-firewall-phases"
    },
    {
      "level": "h3",
      "text": "Custom phase ruleset",
      "id": "custom-phase-ruleset"
    },
    {
      "level": "h3",
      "text": "Managed phase ruleset",
      "id": "managed-phase-ruleset"
    },
    {
      "level": "h2",
      "text": "Endpoints",
      "id": "endpoints"
    },
    {
      "level": "h2",
      "text": "Endpoints",
      "id": "endpoints"
    },
    {
      "level": "h3",
      "text": "General operations",
      "id": "general-operations"
    },
    {
      "level": "h3",
      "text": "Prefix operations",
      "id": "prefix-operations"
    },
    {
      "level": "h3",
      "text": "Allowlist operations",
      "id": "allowlist-operations"
    },
    {
      "level": "h3",
      "text": "SYN Flood Protection operations",
      "id": "syn-flood-protection-operations"
    },
    {
      "level": "h3",
      "text": "Out-of-state TCP Protection operations",
      "id": "out-of-state-tcp-protection-operations"
    },
    {
      "level": "h2",
      "text": "Pagination",
      "id": "pagination"
    },
    {
      "level": "h2",
      "text": "Procedure",
      "id": "procedure"
    },
    {
      "level": "h2",
      "text": "Create an Advanced TCP Protection rule",
      "id": "create-an-advanced-tcp-protection-rule"
    },
    {
      "level": "h2",
      "text": "Create an Advanced DNS Protection rule",
      "id": "create-an-advanced-dns-protection-rule"
    },
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h2",
      "text": "Data collection",
      "id": "data-collection"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "No data about Advanced DNS Protection in Network Analytics",
      "id": "no-data-about-advanced-dns-protection-in-network-analytics"
    },
    {
      "level": "h2",
      "text": "Related products",
      "id": "related-products"
    },
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h3",
      "text": "SYN Flood Protection",
      "id": "syn-flood-protection"
    },
    {
      "level": "h3",
      "text": "Out-of-state TCP Protection",
      "id": "out-of-state-tcp-protection"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h3",
      "text": "Use case",
      "id": "use-case"
    },
    {
      "level": "h2",
      "text": "Action",
      "id": "action"
    },
    {
      "level": "h2",
      "text": "Sensitivity Level",
      "id": "sensitivity-level"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h3",
      "text": "Use case",
      "id": "use-case"
    },
    {
      "level": "h2",
      "text": "Action",
      "id": "action"
    },
    {
      "level": "h2",
      "text": "Sensitivity Level",
      "id": "sensitivity-level"
    },
    {
      "level": "h2",
      "text": "Attack characteristics",
      "id": "attack-characteristics"
    },
    {
      "level": "h3",
      "text": "Queries for nonexistent domains",
      "id": "queries-for-nonexistent-domains"
    },
    {
      "level": "h3",
      "text": "Queries for nonexistent subdomains",
      "id": "queries-for-nonexistent-subdomains"
    },
    {
      "level": "h2",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h3",
      "text": "Model 1",
      "id": "model-1"
    },
    {
      "level": "h3",
      "text": "Model 2",
      "id": "model-2"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Set up Cloudflare zone",
      "id": "1.-set-up-cloudflare-zone"
    },
    {
      "level": "h3",
      "text": "Cloudflare as Primary (full setup)",
      "id": "cloudflare-as-primary-(full-setup)"
    },
    {
      "level": "h3",
      "text": "Cloudflare as Secondary",
      "id": "cloudflare-as-secondary"
    },
    {
      "level": "h2",
      "text": "2. Set up external provider",
      "id": "2.-set-up-external-provider"
    },
    {
      "level": "h2",
      "text": "3. Set up registrar",
      "id": "3.-set-up-registrar"
    },
    {
      "level": "h2",
      "text": "CNAME flattening in Internal DNS",
      "id": "cname-flattening-in-internal-dns"
    },
    {
      "level": "h2",
      "text": "Configuration conditions",
      "id": "configuration-conditions"
    },
    {
      "level": "h2",
      "text": "Set up",
      "id": "set-up"
    },
    {
      "level": "h2",
      "text": "Configuration conditions",
      "id": "configuration-conditions"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Create an internal zone",
      "id": "create-an-internal-zone"
    },
    {
      "level": "h2",
      "text": "Other API actions",
      "id": "other-api-actions"
    },
    {
      "level": "h2",
      "text": "Availability and limits",
      "id": "availability-and-limits"
    },
    {
      "level": "h2",
      "text": "Use the dashboard",
      "id": "use-the-dashboard"
    },
    {
      "level": "h3",
      "text": "Edit proxy status in bulk",
      "id": "edit-proxy-status-in-bulk"
    },
    {
      "level": "h3",
      "text": "Delete records in bulk",
      "id": "delete-records-in-bulk"
    },
    {
      "level": "h2",
      "text": "Use the API",
      "id": "use-the-api"
    },
    {
      "level": "h3",
      "text": "Aspects to consider",
      "id": "aspects-to-consider"
    },
    {
      "level": "h3",
      "text": "Example request",
      "id": "example-request"
    },
    {
      "level": "h2",
      "text": "Create DNS records",
      "id": "create-dns-records"
    },
    {
      "level": "h2",
      "text": "Edit DNS records",
      "id": "edit-dns-records"
    },
    {
      "level": "h2",
      "text": "Delete DNS records",
      "id": "delete-dns-records"
    },
    {
      "level": "h2",
      "text": "Batch record changes",
      "id": "batch-record-changes"
    },
    {
      "level": "h2",
      "text": "Subdomain records",
      "id": "subdomain-records"
    },
    {
      "level": "h2",
      "text": "Subdomain redirects",
      "id": "subdomain-redirects"
    },
    {
      "level": "h2",
      "text": "SSL/TLS for subdomains",
      "id": "ssl/tls-for-subdomains"
    },
    {
      "level": "h2",
      "text": "Customize subdomain behavior",
      "id": "customize-subdomain-behavior"
    },
    {
      "level": "h3",
      "text": "ANAME or ALIAS",
      "id": "aname-or-alias"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Zone apex record",
      "id": "zone-apex-record"
    },
    {
      "level": "h2",
      "text": "Domain redirects",
      "id": "domain-redirects"
    },
    {
      "level": "h2",
      "text": "Get free SSL certificates",
      "id": "get-free-ssl-certificates"
    },
    {
      "level": "h2",
      "text": "Receive email",
      "id": "receive-email"
    },
    {
      "level": "h2",
      "text": "Send and receive email",
      "id": "send-and-receive-email"
    },
    {
      "level": "h2",
      "text": "Prevent domain spoofing",
      "id": "prevent-domain-spoofing"
    },
    {
      "level": "h3",
      "text": "Configure email security records",
      "id": "configure-email-security-records"
    },
    {
      "level": "h2",
      "text": "Proxy SMTP traffic",
      "id": "proxy-smtp-traffic"
    },
    {
      "level": "h2",
      "text": "Import records",
      "id": "import-records"
    },
    {
      "level": "h3",
      "text": "Limits",
      "id": "limits"
    },
    {
      "level": "h3",
      "text": "Format your zone file",
      "id": "format-your-zone-file"
    },
    {
      "level": "h3",
      "text": "Import zone file to Cloudflare",
      "id": "import-zone-file-to-cloudflare"
    },
    {
      "level": "h2",
      "text": "Export records",
      "id": "export-records"
    },
    {
      "level": "h2",
      "text": "DNS record attributes",
      "id": "dns-record-attributes"
    },
    {
      "level": "h3",
      "text": "Reserved cf- tags",
      "id": "reserved-cf--tags"
    },
    {
      "level": "h2",
      "text": "DNS zone file directives",
      "id": "dns-zone-file-directives"
    },
    {
      "level": "h2",
      "text": "Cloudflare API",
      "id": "cloudflare-api"
    },
    {
      "level": "h2",
      "text": "ddclient",
      "id": "ddclient"
    },
    {
      "level": "h2",
      "text": "Example scenario",
      "id": "example-scenario"
    },
    {
      "level": "h3",
      "text": "All records unproxied",
      "id": "all-records-unproxied"
    },
    {
      "level": "h3",
      "text": "All records proxied (recommended)",
      "id": "all-records-proxied-(recommended)"
    },
    {
      "level": "h3",
      "text": "Unproxied and proxied records",
      "id": "unproxied-and-proxied-records"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Delegate a subdomain (outgoing)",
      "id": "delegate-a-subdomain-(outgoing)"
    },
    {
      "level": "h2",
      "text": "Delegate a subdomain (incoming)",
      "id": "delegate-a-subdomain-(incoming)"
    },
    {
      "level": "h2",
      "text": "IP address resolution",
      "id": "ip-address-resolution"
    },
    {
      "level": "h3",
      "text": "A and AAAA",
      "id": "a-and-aaaa"
    },
    {
      "level": "h3",
      "text": "CNAME",
      "id": "cname"
    },
    {
      "level": "h2",
      "text": "Email authentication",
      "id": "email-authentication"
    },
    {
      "level": "h3",
      "text": "MX",
      "id": "mx"
    },
    {
      "level": "h3",
      "text": "DKIM",
      "id": "dkim"
    },
    {
      "level": "h3",
      "text": "SPF",
      "id": "spf"
    },
    {
      "level": "h3",
      "text": "DMARC",
      "id": "dmarc"
    },
    {
      "level": "h2",
      "text": "Specialized records",
      "id": "specialized-records"
    },
    {
      "level": "h3",
      "text": "TXT",
      "id": "txt"
    },
    {
      "level": "h3",
      "text": "CAA",
      "id": "caa"
    },
    {
      "level": "h3",
      "text": "SRV",
      "id": "srv"
    },
    {
      "level": "h3",
      "text": "SVCB and HTTPS",
      "id": "svcb-and-https"
    },
    {
      "level": "h3",
      "text": "PTR",
      "id": "ptr"
    },
    {
      "level": "h3",
      "text": "SOA",
      "id": "soa"
    },
    {
      "level": "h3",
      "text": "NS",
      "id": "ns"
    },
    {
      "level": "h3",
      "text": "DS and DNSKEY",
      "id": "ds-and-dnskey"
    },
    {
      "level": "h3",
      "text": "Other",
      "id": "other"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h3",
      "text": "Record comments",
      "id": "record-comments"
    },
    {
      "level": "h3",
      "text": "Record tags",
      "id": "record-tags"
    },
    {
      "level": "h2",
      "text": "Add or edit record attributes",
      "id": "add-or-edit-record-attributes"
    },
    {
      "level": "h2",
      "text": "Reference",
      "id": "reference"
    },
    {
      "level": "h3",
      "text": "Comments",
      "id": "comments"
    },
    {
      "level": "h3",
      "text": "Tags",
      "id": "tags"
    },
    {
      "level": "h2",
      "text": "Proxied records",
      "id": "proxied-records"
    },
    {
      "level": "h2",
      "text": "Unproxied records",
      "id": "unproxied-records"
    },
    {
      "level": "h2",
      "text": "Nameserver TTL",
      "id": "nameserver-ttl"
    },
    {
      "level": "h2",
      "text": "Google",
      "id": "google"
    },
    {
      "level": "h3",
      "text": "Google Workspace MX records",
      "id": "google-workspace-mx-records"
    },
    {
      "level": "h3",
      "text": "Google Workspace service URLs",
      "id": "google-workspace-service-urls"
    },
    {
      "level": "h3",
      "text": "Google site verification",
      "id": "google-site-verification"
    },
    {
      "level": "h2",
      "text": "Amazon",
      "id": "amazon"
    },
    {
      "level": "h3",
      "text": "Amazon Route53",
      "id": "amazon-route53"
    },
    {
      "level": "h3",
      "text": "Amazon S3 bucket",
      "id": "amazon-s3-bucket"
    },
    {
      "level": "h3",
      "text": "Amazon Simple Email Service (SES)",
      "id": "amazon-simple-email-service-(ses)"
    },
    {
      "level": "h3",
      "text": "Amazon ELB configuration",
      "id": "amazon-elb-configuration"
    },
    {
      "level": "h3",
      "text": "Amazon Amplify",
      "id": "amazon-amplify"
    },
    {
      "level": "h2",
      "text": "Microsoft",
      "id": "microsoft"
    },
    {
      "level": "h3",
      "text": "Microsoft 365",
      "id": "microsoft-365"
    },
    {
      "level": "h3",
      "text": "Microsoft Azure",
      "id": "microsoft-azure"
    },
    {
      "level": "h2",
      "text": "Miscellaneous vendors",
      "id": "miscellaneous-vendors"
    },
    {
      "level": "h3",
      "text": "ClickFunnels",
      "id": "clickfunnels"
    },
    {
      "level": "h3",
      "text": "Discourse",
      "id": "discourse"
    },
    {
      "level": "h3",
      "text": "Forward Email",
      "id": "forward-email"
    },
    {
      "level": "h3",
      "text": "Mailchimp",
      "id": "mailchimp"
    },
    {
      "level": "h3",
      "text": "Ning custom domain",
      "id": "ning-custom-domain"
    },
    {
      "level": "h3",
      "text": "Rackspace CloudFiles",
      "id": "rackspace-cloudfiles"
    },
    {
      "level": "h3",
      "text": "SendGrid",
      "id": "sendgrid"
    },
    {
      "level": "h3",
      "text": "SmugMug",
      "id": "smugmug"
    },
    {
      "level": "h3",
      "text": "Squarespace",
      "id": "squarespace"
    },
    {
      "level": "h3",
      "text": "Tumblr custom domain",
      "id": "tumblr-custom-domain"
    },
    {
      "level": "h3",
      "text": "Unbounce",
      "id": "unbounce"
    },
    {
      "level": "h3",
      "text": "Wix",
      "id": "wix"
    },
    {
      "level": "h3",
      "text": "WPEngine",
      "id": "wpengine"
    },
    {
      "level": "h3",
      "text": "Zoho",
      "id": "zoho"
    },
    {
      "level": "h2",
      "text": "Create a Wildcard record",
      "id": "create-a-wildcard-record"
    },
    {
      "level": "h3",
      "text": "Aspects to consider",
      "id": "aspects-to-consider"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Additional information",
      "id": "additional-information"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Causes",
      "id": "causes"
    },
    {
      "level": "h2",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "Causes",
      "id": "causes"
    },
    {
      "level": "h2",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "Causes",
      "id": "causes"
    },
    {
      "level": "h2",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "DNS records that should be proxied",
      "id": "dns-records-that-should-be-proxied"
    },
    {
      "level": "h2",
      "text": "DNS records that should be DNS-only",
      "id": "dns-records-that-should-be-dns-only"
    },
    {
      "level": "h2",
      "text": "Causes",
      "id": "causes"
    },
    {
      "level": "h2",
      "text": "Solution",
      "id": "solution"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Cause",
      "id": "cause"
    },
    {
      "level": "h2",
      "text": "Solutions",
      "id": "solutions"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Configuration conditions",
      "id": "configuration-conditions"
    },
    {
      "level": "h2",
      "text": "Enable account custom nameservers",
      "id": "enable-account-custom-nameservers"
    },
    {
      "level": "h3",
      "text": "1. Set up ACNS names and sets",
      "id": "1.-set-up-acns-names-and-sets"
    },
    {
      "level": "h3",
      "text": "2. Use ACNS on existing zones",
      "id": "2.-use-acns-on-existing-zones"
    },
    {
      "level": "h3",
      "text": "3. (Optional) Make ACNS default for new zones",
      "id": "3.-(optional)-make-acns-default-for-new-zones"
    },
    {
      "level": "h2",
      "text": "Disable account custom nameservers",
      "id": "disable-account-custom-nameservers"
    },
    {
      "level": "h3",
      "text": "1. Remove ACNS assignment from zones",
      "id": "1.-remove-acns-assignment-from-zones"
    },
    {
      "level": "h3",
      "text": "2. Delete ACNS names or sets",
      "id": "2.-delete-acns-names-or-sets"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Configuration conditions",
      "id": "configuration-conditions"
    },
    {
      "level": "h2",
      "text": "For account owners",
      "id": "for-account-owners"
    },
    {
      "level": "h3",
      "text": "Enable tenant custom nameservers on a zone",
      "id": "enable-tenant-custom-nameservers-on-a-zone"
    },
    {
      "level": "h3",
      "text": "Disable tenant custom nameservers on a zone",
      "id": "disable-tenant-custom-nameservers-on-a-zone"
    },
    {
      "level": "h2",
      "text": "For tenant owners",
      "id": "for-tenant-owners"
    },
    {
      "level": "h3",
      "text": "Create tenant custom nameservers",
      "id": "create-tenant-custom-nameservers"
    },
    {
      "level": "h3",
      "text": "Get a list of all TCNS names",
      "id": "get-a-list-of-all-tcns-names"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Use zone custom nameservers",
      "id": "use-zone-custom-nameservers"
    },
    {
      "level": "h3",
      "text": "Primary (full setup) zones",
      "id": "primary-(full-setup)-zones"
    },
    {
      "level": "h3",
      "text": "Secondary zones",
      "id": "secondary-zones"
    },
    {
      "level": "h2",
      "text": "Remove zone custom nameservers",
      "id": "remove-zone-custom-nameservers"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Prepare DNS records",
      "id": "1.-prepare-dns-records"
    },
    {
      "level": "h2",
      "text": "2. Convert the zone",
      "id": "2.-convert-the-zone"
    },
    {
      "level": "h2",
      "text": "3. Verify ownership",
      "id": "3.-verify-ownership"
    },
    {
      "level": "h2",
      "text": "4. Update your nameservers",
      "id": "4.-update-your-nameservers"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "1. Prepare DNS records",
      "id": "1.-prepare-dns-records"
    },
    {
      "level": "h2",
      "text": "2. Prepare the zone transfers",
      "id": "2.-prepare-the-zone-transfers"
    },
    {
      "level": "h2",
      "text": "3. Convert the zone and initiate zone transfers",
      "id": "3.-convert-the-zone-and-initiate-zone-transfers"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "1. Prepare Cloudflare SSL/TLS",
      "id": "1.-prepare-cloudflare-ssl/tls"
    },
    {
      "level": "h2",
      "text": "2. Update settings in authoritative DNS",
      "id": "2.-update-settings-in-authoritative-dns"
    },
    {
      "level": "h2",
      "text": "3. Convert to full setup",
      "id": "3.-convert-to-full-setup"
    },
    {
      "level": "h2",
      "text": "4. Activate full setup",
      "id": "4.-activate-full-setup"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Prepare a zone file",
      "id": "1.-prepare-a-zone-file"
    },
    {
      "level": "h2",
      "text": "2. Configure the Cloudflare zone",
      "id": "2.-configure-the-cloudflare-zone"
    }
  ],
  "url": "llms-txt#cache-rule-configuring-cache-settings-and-defining-custom-cache-keys",
  "links": []
}