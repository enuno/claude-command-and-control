{
  "title": "This can be done with a loop over all tables in the namespace",
  "content": "tables = spark.sql(\"SHOW TABLES IN r2dc.namespace_name\").collect()\nfor row in tables:\n  table_name = row['tableName']\n  spark.sql(f\"DROP TABLE r2dc.namespace_name.{table_name} PURGE\")\nspark.sql(\"DROP NAMESPACE r2dc.namespace_name CASCADE\")\npy",
  "code_samples": [
    {
      "code": "Data loss warning\n\n`DROP TABLE ... PURGE` permanently deletes all data files from R2 storage. This operation cannot be undone and bypasses time-travel capabilities.\n\n### Manual maintenance operations",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "Manual maintenance operations",
      "id": "manual-maintenance-operations"
    }
  ],
  "url": "llms-txt#this-can-be-done-with-a-loop-over-all-tables-in-the-namespace",
  "links": []
}