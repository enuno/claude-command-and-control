{
  "title": "You must still escape the '.' character in the following raw string because it has a special meaning in regular expressions (\"any character\")",
  "content": "http.request.uri.path matches r\"/api/login\\.aspx$\"\nsql\nssl\nsql\nnot ssl\ntxt\n<MAP_FIELD>[<KEY>]\ntxt\nhttp.request.headers[\"accept\"]     # ==> [\"application/json\"]\nhttp.request.headers[\"accept\"][0]  # ==> \"application/json\"\n\nany(http.request.headers[\"accept\"][*] == \"application/json\") # ==> true\nany(http.request.headers[\"accept\"][*] == \"text/plain\")       # ==> false\ntxt",
  "code_samples": [
    {
      "code": "### Case sensitivity in string comparisons\n\nSince the evaluation of string literal values in expressions is case-sensitive, consider one of the following options to capture capitalization variants in your expression:\n\n* Use the [`wildcard`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) operator, which is case-insensitive, to match a string literal.\n* Use the [`lower()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#lower) function to convert the string to lowercase before comparison.\n* Use the [`matches`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#regular-expression-matching) operator (only available in Business and Enterprise plans) with a regular expression that matches different variants.\n* Write several sub-expressions with the [`eq`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators) or [`contains`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators) operator, joined with the [`or`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#supported-logical-operators) operator, to capture different variations of the string literal (for example, `<field> eq \"a\" or <field> eq \"A\"`).\n\n### Regular expression limits\n\nCloudflare has a few limits in place regarding regular expressions. One of those limits is that each rule supports a maximum of 64 regular expressions (regexes), regardless of your domain's plan.\n\nYou can use the following strategies to reduce the number of regular expressions in a rule:\n\n* Use the [`contains`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#comparison-operators) operator.\n* Use the [`wildcard`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) / [`strict wildcard`](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) operators.\n* Use the [`starts_with()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#starts_with) and [`ends_with()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#ends_with) functions.\n\n## Boolean values\n\nSimple expressions using boolean fields do not require operator notations or values. You only need to insert the field on its own, as shown in the `ssl` example below.",
      "language": "unknown"
    },
    {
      "code": "This simple expression matches requests where the value of the `ssl` field is `true`.\n\nTo match requests where `ssl` is `false`, use the boolean `not` operator :",
      "language": "unknown"
    },
    {
      "code": "## Arrays\n\nThe Cloudflare Rules language includes [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/) of `Array` type and [functions](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/) with `Array` arguments and return values.\n\nYou can access individual array elements using an index (a non-negative value) between square brackets (`[]`). Array indexes start at `0` (zero).\n\nUse the special notation `[*]` when specifying an expression that will be evaluated for each array element (like the [`map` high-order function](https://wikipedia.org/wiki/Map_\\(higher-order_function\\))). This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.\n\n### Examples\n\nConsider the `http.request.headers.names` field with type `Array<String>` in the following examples:\n\n* Obtain the first element in the array:\\\n  `http.request.headers.names[0]`\n\n* Check if the first array element is equal to `Content-Type` (case sensitive):\\\n  `http.request.headers.names[0] == \"Content-Type\"`\n\n* Check if any array element is equal to `Content-Type` (case sensitive):\\\n  `any(http.request.headers.names[*] == \"Content-Type\")`\n\n* Check if any array element is equal to `Content-Type`, ignoring the case:\\\n  `any(lower(http.request.headers.names[*])[*] == \"content-type\")`\n\nIn the last example, the `lower()` function includes the `[*]` notation so that the function is evaluated for each array element. This function, used along `[*]`, returns a new array where each element of the input array is converted to lowercase. Then, the string comparison uses `[*]` to transform the array resulting from applying `lower()` to each header name into an array of boolean values. Finally, `any()` evaluates to true if at least one of these array elements is true.\n\n### Notes\n\nIt is not possible to define your own arrays. You can only use arrays returned by fields, either directly or modified by functions.\n\nAccessing an out-of-bounds array index produces a \"missing value\". A missing value has the following behavior:\n\n* Any comparison `<expr> <op> <literal>` where `<expr>` evaluates to a missing value will evaluate to false.\n* Function calls like `function(<expr>)`, where `<expr>` evaluates to a missing value, will return a missing value in most cases, but the exact behavior can vary per function.\n\nYou can only use `[*]` multiple times in the same expression if applied to the same array. Also, you can only use `[*]` in the first argument of a function call.\n\nThe Rules language [operators](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/) do not directly support arrays or the `[*]` operator — however, they support indexed array elements like `array_value[0]`. For example, you cannot use `[*]` with the `==` operator outside the context of an enclosing function call:\n\n* `http.request.headers.names[*] == \"Content-Type\"` — **Invalid** expression\n* `any(http.request.headers.names[*] == \"Content-Type\")` — **Valid** expression\n\n## Maps\n\nA map, also called associative array, is a data structure that stores a collection of key-value pairs, where the key must be a `String` and the value can be of any type (for example, a `String` or an array of values). All values in a map must have the same type.\n\nThe Cloudflare Rules language includes several [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/) of `Map` data type. The type notation for map fields, for example `Map<Array<String>>`, indicates the data type of the values associated with keys (an `Array` of `String` elements). This means that when you access the value of key `\"foo\"` you will get either an array of `String` elements or a [missing value](#notes-1).\n\nTo access a value in a map, enter the key between square brackets (`[]`):",
      "language": "unknown"
    },
    {
      "code": "For maps where the values have an `Array` type, you cannot directly use [operators](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/) with the obtained (array) value, since these operators do not support arrays directly. To use an operator on an item of the array, use the special notation `[*]` when specifying an expression. This special index notation will unpack the array, call the enclosing function for all its elements individually, and return a new array containing all the individual return values.\n\n### Examples\n\nThe following example is based on the [`http.request.headers`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers/) field with a data type of `Map<Array<String>>`, where array elements are of `String` data type.\n\nIf an incoming HTTP request included a single `Accept: application/json` HTTP header, the following expressions would evaluate to the indicated values:",
      "language": "unknown"
    },
    {
      "code": "The following example is based on the [`http.request.uri.args`](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args/) field with a data type of `Map<Array<String>>`, where array elements are of `String` data type.\n\nIf an HTTP request included three `filter` URI arguments `waf`, `botm`, and `cdn`, the following expressions would evaluate to the indicated values:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "Case sensitivity in string comparisons",
      "id": "case-sensitivity-in-string-comparisons"
    },
    {
      "level": "h3",
      "text": "Regular expression limits",
      "id": "regular-expression-limits"
    },
    {
      "level": "h2",
      "text": "Boolean values",
      "id": "boolean-values"
    },
    {
      "level": "h2",
      "text": "Arrays",
      "id": "arrays"
    },
    {
      "level": "h3",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h3",
      "text": "Notes",
      "id": "notes"
    },
    {
      "level": "h2",
      "text": "Maps",
      "id": "maps"
    },
    {
      "level": "h3",
      "text": "Examples",
      "id": "examples"
    }
  ],
  "url": "llms-txt#you-must-still-escape-the-'.'-character-in-the-following-raw-string-because-it-has-a-special-meaning-in-regular-expressions-(\"any-character\")",
  "links": []
}