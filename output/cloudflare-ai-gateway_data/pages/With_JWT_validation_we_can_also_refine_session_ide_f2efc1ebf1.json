{
  "title": "With JWT validation, we can also refine session identifiers to use claims from the JWT",
  "content": "resource \"cloudflare_api_shield\" \"session_identifiers\" {\n  zone_id = var.zone_id\n  auth_id_characteristics = [{\n    # select the JWT's `sub` claim as an extremly stable session identifier\n    # this is \"<token_config_id:json_path>\" format\n    name = \"${cloudflare_token_validation_config.example_es256_config.id}:$.sub\"\n    type = \"jwt\"\n  }]\n}\nplaintext\n/api/login/{customer_identifier}\n/api/auth\n/api/account/{customer_identifier}\n/api/password_reset\n/api/logout\ntxt\nus-api.example.com/api/v1/users/{var1}\nde-api.example.com/api/v1/users/{var1}\nfr-api.example.com/api/v1/users/{var1}\njp-api.example.com/api/v1/users/{var1}\ntxt\n(http.request.method eq \"GET\" and\nhttp.host eq \"<YOUR_DOMAIN>\" and\nhttp.request.uri.path matches \"</EXAMPLE_PATH>\" and\nlookup_json_string(http.request.jwt.claims[\"<JWT_TOKEN_CONFIGURATION_ID>\"][0], \"aud\") eq \"free-tier\"\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/api_gateway/operations/$OPERATION_ID\" \\\n  --request GET \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\ntxt\n(http.request.method eq \"GET\" and\nhttp.host eq \"<YOUR_DOMAIN>\" and\nhttp.request.uri.path matches \"</EXAMPLE_PATH>\" and\nlookup_json_string(http.request.jwt.claims[\"<JWT_TOKEN_CONFIGURATION_ID>\"][0], \"aud\") eq \"free-tier\"\nsh\ncurl -svo /dev/null -A \"CF\" 'https://example.com/' -H 'accept: text/html' 2>&1 | grep 'cf-cache-status\\|cf-edge\\|cf-apo-via'\nsh\n< cf-cache-status: HIT\n< cf-apo-via: cache\n< cf-edge-cache: cache,platform=wordpress\njs\nexport default {\n  async fetch(request, env, ctx) {\n    const originalResponse = await fetch(request);\n\n// Response properties are immutable. To change them, construct a new Response object.\n    const response = new Response(originalResponse.body, originalResponse);\n\n// Response headers can be modified through the headers `set` method.\n    response.headers.set(\"cf-edge-cache\", \"no-cache\");\n\nreturn response;\n  },\n};\nsh\ncurl --silent --verbose --output /dev/null https://example.com/ --header 'Accept: text/html' 2>&1 | grep cache-control\nsh\n< cache-control: max-age=86400, stale-while-revalidate=86400, stale-if-error=86400\njs\nany(cf.bot_management.detection_ids[*] eq 3355446)\nand not cf.bot_management.verified_bot\nand http.request.uri.path eq \"/login\"\nand http.request.method eq \"POST\"\njs\ncf.bot_management.score lt 30\nand not cf.bot_management.verified_bot\nand http.request.uri.path eq \"/login\"\nand http.request.method eq \"POST\"\nand not any(cf.bot_management.detection_ids[*] in {3355446 12577893})\njson\n{\n  \"ja4Signals\": {\n    \"h2h3_ratio_1h\": 0.98826485872269,\n    \"heuristic_ratio_1h\": 7.288895722013e-05,\n    \"reqs_quantile_1h\": 0.99905741214752,\n    \"uas_rank_1h\": 901,\n    \"browser_ratio_1h\": 0.93640440702438,\n    \"paths_rank_1h\": 655,\n    \"reqs_rank_1h\": 850,\n    \"cache_ratio_1h\": 0.18918327987194,\n    \"ips_rank_1h\": 662,\n    \"ips_quantile_1h\": 0.99926590919495\n  },\n  \"jaSignalsParsed\": {\n    \"ratios\": {\n      \"h2h3_ratio_1h\": 0.98826485872269,\n      \"heuristic_ratio_1h\": 7.288895722013e-05,\n      \"browser_ratio_1h\": 0.93640440702438,\n      \"cache_ratio_1h\": 0.18918327987194\n    },\n    \"ranks\": {\n      \"uas_rank_1h\": 901,\n      \"paths_rank_1h\": 655,\n      \"reqs_rank_1h\": 850,\n      \"ips_rank_1h\": 662\n    },\n    \"quantiles\": {\n      \"reqs_quantile_1h\": 0.99905741214752,\n      \"ips_quantile_1h\": 0.99926590919495\n    }\n  }\n}\njson\n{\n  \"ja4Signals\": {},\n  \"jaSignalsParsed\": {\n    \"ratios\": {},\n    \"ranks\": {},\n    \"quantiles\": {}\n  }\n}\ntxt\nUser-agent: *\nDisallow: /lp\nDisallow: /feedback\nDisallow: /langtest\n\nSitemap: https://www.crawlstop.com/sitemap.xml\ntxt",
  "code_samples": [
    {
      "code": "</page>\n\n<page>\n---\ntitle: API Discovery · Cloudflare API Shield docs\ndescription: Most development teams struggle to keep track of their APIs.\n  Cloudflare API Discovery helps you map out and understand your attack surface\n  area.\nlastUpdated: 2025-11-07T16:57:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/api-discovery/\n  md: https://developers.cloudflare.com/api-shield/security/api-discovery/index.md\n---\n\nMost development teams struggle to keep track of their APIs. Cloudflare API Discovery helps you map out and understand your attack surface area.\n\n## Process\n\nCloudflare produces a simple, trustworthy map of API endpoints through a process of path normalization.\n\nFor example, you might have thousands of APIs, but a lot of the calls look similar, such as:\n\n* `api.example.com/profile/238`\n* `api.example.com/profile/392`\n\nBoth paths serve a similar purpose — allowing users to log in to their accounts — but they are not identical. To simplify your endpoints, these examples might both map to `api.example.com/profile/*`.\n\nAPI Discovery runs this process across all your traffic, generating a simple map of endpoints that might look like:",
      "language": "unknown"
    },
    {
      "code": "Similarly, if you have multiple subdomains that share the same set of endpoints, Cloudflare will consolidate subdomains:",
      "language": "unknown"
    },
    {
      "code": "We will consolidate to `{hostVar1}.example.com/api/v1/users/{var1}`.\n\nFor more technical details, see our [blog post](https://blog.cloudflare.com/ml-api-discovery-and-schema-learning/).\n\n### Inbox view\n\nAPI Shield first catalogs your discovered API endpoints in an email inbox-style view. From API Discovery, you can save endpoints to [Endpoint Management](https://developers.cloudflare.com/api-shield/management-and-monitoring/) or ignore endpoints to remove them from view.\n\nYou should save all discovered API endpoints to Endpoint Management while ignoring any potential false positives in the API Discovery results by selecting **Save** or **Ignore** on each line. Alternatively, you can bulk-select endpoints to save or ignore. You can get started with saving endpoints by saving all endpoints with a variable. Search for `var1` in the search box and add all the resulting endpoints. You can examine endpoints without path variables for accuracy later on.\n\nBy adding endpoints to Endpoint Management, you will unlock further [security](https://developers.cloudflare.com/api-shield/security/), [visibility](https://developers.cloudflare.com/api-shield/management-and-monitoring/#endpoint-analysis), and [management](https://developers.cloudflare.com/api-shield/management-and-monitoring/) features of the platform. Endpoint Management monitors the health of your API endpoints by saving, updating, and monitoring performance metrics.\n\nTo restore any errantly ignored endpoints, you can filter by **Ignored** and select **Restore**.\n\nAPI Discovery is an ongoing process. Check back regularly for new API Discovery results. A badge with the number of endpoints needing review will show in the API Shield dashboard. You may see the quantities in the **Needs Review** and **Ignored** metrics change over time. As your actual API or traffic patterns to your APIs change, API Discovery results that are not saved can disappear.\n\nNote\n\nCloudflare will use your feedback on the ignored endpoints to better train the API Discovery Machine Learning model in a future release.\n\n### Machine Learning-based Discovery\n\nYour API endpoints are discovered with both the Session Identifier-based Discovery and the Machine Learning-based Discovery.\n\nTo access Machine Learning-based Discovery:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **API Shield** > **Discovery**.\n  3. Filter the source results by `Session Identifier` or `Machine Learning` to view results from each Discovery method.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Discovery** tab.\n\n  3. Filter the source results by `Session Identifier` or `Machine Learning` to view results from each Discovery method.\n\nIf all of your zone’s API traffic contains the session identifier that you have configured, both sources may deliver the same results due to similarities between their underlying methodology. We expect Machine Learning-based Discovery to excel in discovering API traffic regardless of whether your API uses a session identifier.\n\nYou can direct any feedback about your API Discovery results to your account team.\n\n## Requirements\n\nTo ensure your API endpoints are successfully discovered and mapped by Cloudflare, traffic to the endpoint must meet specific operational criteria.\n\nIf an endpoint does not appear in the Discovery inbox, it is typically because the system has not observed enough valid requests over a continuous period. API Discovery only processes requests that satisfy all of the following requirements:\n\n* The request must return a `2xx` response code from the Cloudflare edge.\n* The request must not come directly from Cloudflare Workers.\n* The endpoint must receive at least 500 requests within a 10-day period.\n\nEndpoints discovered using session identifiers will be labeled as such in the Cloudflare dashboard. If the endpoints are not discovered through session identifiers, they will be discovered using our machine learning-based [API Discovery](https://developers.cloudflare.com/api-shield/security/api-discovery/).\n\n## Availability\n\nAPI Discovery is only available for Enterprise customers. If you are an Enterprise customer interested in this product, contact your account team.\n\n</page>\n\n<page>\n---\ntitle: Authentication Posture · Cloudflare API Shield docs\ndescription: Authentication Posture helps users identify authentication\n  misconfigurations for APIs and alerts of their presence.\nlastUpdated: 2025-11-07T16:57:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/authentication-posture/\n  md: https://developers.cloudflare.com/api-shield/security/authentication-posture/index.md\n---\n\nAuthentication Posture helps users identify authentication misconfigurations for APIs and alerts of their presence.\n\nFor example, a security team member may believe that their API hosted at `/api/v1/users` and `/api/v1/orders` are guarded by the fact that only authenticated users can interact with the endpoints. However, bugs in origin API authentication policies may lead to broken authentication vulnerabilities. Authentication Posture with API Shield details the authentication status of successful requests to your API endpoints, alerting to potential misconfigurations.\n\nConsider a typical e-commerce application. Users can browse items and prices without being logged in. However, to retrieve order details with the `GET /api/v1/orders/{order_id}` endpoint, this example application requires users to log in to their account and pass the subsequent Authorization HTTP header in all requests. Cloudflare will alert via [Security Center Insights](https://developers.cloudflare.com/security-center/security-insights/) and [Endpoint labels](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-labels/) if successful requests are sent to the `GET /api/v1/orders/{order_id}` endpoint or any other endpoint without authentication when session identifiers are configured.\n\n## Process\n\nAfter configuring [session identifiers](https://developers.cloudflare.com/api-shield/get-started/#session-identifiers), API Shield continuously scans your traffic for successful requests without authentication and labels your endpoints on a daily basis. Refer to the table below for our labeling methodology.\n\n| Description | 2xx response codes | 4xx, 5xx response codes |\n| - | - | - |\n| If all requests are missing authentication, Cloudflare will apply the label: | `cf-missing-auth` | Without successful responses, no label will be added. |\n| If only some requests are missing authentication, Cloudflare will apply the label: | `cf-mixed-auth` | Without successful responses, no label will be added. |\n\n### Examine an endpoint's authentication details\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **API Shield** > **Endpoint Management**.\n  3. Filter Endpoint Management by the `cf-risk-missing-auth` or `cf-risk-mixed-auth` labels.\n  4. Select an endpoint to see its authentication posture details on the endpoint details page.\n  5. Choose between the 24-hour and 7-day view options, and note any authentication changes over time.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Endpoints** tab.\n\n  3. Filter your endpoints by the `cf-risk-missing-auth` or `cf-risk-mixed-auth` labels.\n\n  4. Select an endpoint to see its authentication posture details on the endpoint details page.\n\n  5. Choose between the 24-hour and 7-day view options, and note any authentication changes over time.\n\nThe main authentication widget displays how many successful requests over the last seven days had session identifiers included with them, and which identifiers were included with the traffic.\n\nThe authentication-over-time chart shows a detailed breakdown over time of how clients successfully interacted with your API and which identifiers were used. A large increase in unauthenticated traffic may signal a security incident. Similarly, any successful unauthenticated traffic on an endpoint that is expected to be 100% authenticated can be a cause for concern.\n\nWork with your development team to understand which authentication policies may need to be corrected on your API to stop unauthenticated traffic.\n\n### Stop unauthenticated traffic with Cloudflare\n\nYou can use the `cf.api_gateway.auth_id_present` field in [custom rules](https://developers.cloudflare.com/waf/custom-rules/) to trigger when the API Shield configured session identifiers are present or absent on a request. Since this rule would cover your entire zone, Cloudflare recommends adding a host and path match in the rule to pinpoint the protection to exactly what is needed.\n\n## Limitations\n\nAuthentication Posture can only apply when customers accurately set up session identifiers in API Shield. As a reminder, session identifiers are meant to uniquely identify authenticated users of your API. If you are unsure of your API's session identifier, consult with your development team.\n\n## Availability\n\nAuthentication Posture is available for all Enterprise customers with an API Shield subscription.\n\n</page>\n\n<page>\n---\ntitle: Broken Object Level Authorization vulnerability detection · Cloudflare\n  API Shield docs\ndescription: A Broken Object Level Authorization (BOLA) vulnerability is where\n  an application or API fails to properly verify if a user has permission to\n  access specific data.\nlastUpdated: 2025-11-07T16:57:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/bola-vulnerability-detection/\n  md: https://developers.cloudflare.com/api-shield/security/bola-vulnerability-detection/index.md\n---\n\nA Broken Object Level Authorization (BOLA) vulnerability is where an application or API fails to properly verify if a user has permission to access specific data.\n\nBugs in the application or API allow attackers to bypass authorization checks and access potentially sensitive information by manipulating and iterating through object identifiers.\n\nVulnerabilities can occur at any time, including in the original application's deployment. However, changes or upgrades to authentication and authorization policies can also introduce these bugs.\n\nBOLA vulnerabilities are as dangerous as an account takeover. Successfully exploiting a BOLA vulnerability allows the attacker to access or change data that they should not have ownership over.\n\nCloudflare labels endpoints with BOLA risk when we detect two distinct signals common with attacks exploiting BOLA: **Parameter pollution** and **Enumeration**.\n\n## Enumeration\n\nCloudflare continually profiles all sessions on a per-endpoint basis and detects anomalous sessions that successfully request many unique data points from an API endpoint against what is normal.\n\nNote\n\nSessions that have more random behavior or repetition have a higher chance of triggering an alert.\n\nThe BOLA enumeration label requires an endpoint to have seen at least 10,000 sessions before being eligible for outlier detection.\n\nEnumeration example\n\n**Endpoint**: `GET /api/v1/users/{userId}/credit-cards`\n\n* **Normal behavior**: Users request credit cards using only their own `userId`.\n* **Attack behavior**: Attackers request hundreds of `userId` values per session by brute-force iterating through `userIds` found via other methods.\n* **Result**: If the origin authorization policy is broken for this endpoint, the attacker gains credit card information on every user account they request it for.\n\n## Parameter pollution\n\nCloudflare detects anomalies where one or more successful requests containing a value in an expected path, query string, header, or cookie have that value duplicated in an unexpected, similar location.\n\nThis behavior may be indicative of attackers trying to confuse the API's authorization system and bypass security controls.\n\nParameter pollution example\n\n**Endpoint**: `GET /api/v1/orders/{orderId}`\n\n* **Normal behavior**: `orderId` sent in a path variable like `GET /api/v1/orders/12345`\n* **Attacker behavior**: `orderId` is also sent as a query parameter, triggering old, undocumented code that looks for orders in the query parameter and happens to lack an authorization check: `GET /api/v1/orders/12345?orderId=67890`\n* **Result**: By passing in a fake order or an order that the attacker owns (`12345`), they are able to trigger the old, undocumented code and access an order that they do not own (`67890`)\n\n## Process\n\nAPI Shield searches for and highlights BOLA attacks on your APIs. Cloudflare learns visitor traffic patterns over time to know when API access to specific objects is likely a BOLA enumeration attack. We inform you what API endpoints are being targeted by automatically labeling them using the following [risk labels](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-labels/#risk-labels):\n\n`cf-risk-bola-enumeration`: Automatically added when an endpoint experiences successful responses with drastic differences in the number of unique elements requested by different user sessions.\n\n`cf-risk-bola-pollution`: Automatically added when an endpoint experiences successful responses where parameters are found in multiple places in the request, as opposed to what is expected from the API's schema.\n\nIf you see one of these labels on your API endpoints, check its authorization policy with your developer team to find any authorization bugs. Additionally, you can reach out to Cloudflare for a customized report about the behavior, including attacker identifiers that you can use to confirm attack reach and impact.\n\nBOLA attack information can be found in your [Security Overview](#security-overview), [Security Analytics](#security-analytics), and [Endpoint details](#endpoint-details).\n\n### Security Overview\n\nIf BOLA vulnerabilities have been detected on your endpoints, you can view a summary of the attack and suggestions to mitigate it via the Cloudflare dashboard.\n\n1. In the Cloudflare dashboard, go to the **Security** page.\n\n   [Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/security/overview)\n\n2. Go to **API abuse** or **All suggestions**.\n\n3. Depending on the type of attack, select **Review traffic from potential BOLA enumeration attack** or **Review traffic from potential parameter pollution attack** to view details of the attack and suggested actions.\n\n4. Select **View all affected endpoints** or **View details** on a specific endpoint to review suspicious sessions in [Web Assets](#endpoint-details).\n\nCloudflare evaluates your session requests for both enumeration and parameter pollution attacks and provides you with a list of at-risk endpoints and the number of anomalous sessions where an attack was detected. You can follow the suggested actions to address your BOLA vulnerabilities and prevent future attacks against your endpoints.\n\nNote\n\nIf the insight has been archived but attacks are still present, you can filter by **Show archived**.\n\n### Security Analytics\n\nYou can view analytics of your zone's traffic profile and suspicious requests associated with enumeration or parameter pollution attacks in the Cloudflare dashboard.\n\n[Go to **Analytics**](https://dash.cloudflare.com/?to=/:account/:zone/security/analytics)\n\nFilter requests depending on the type of attack detected in your zone, including the hashed session IDs found in the attack and the corresponding BOLA vulnerability risk label, to see an analysis of your request activity from the past seven days. This filter includes all traffic from suspected attacker sessions, so you can evaluate other actions that they are taking against your zone.\n\nThis does not filter by specific endpoints.\n\nReview the top statistics and details of managed API endpoints, paths and values targeted by the attack, source IPs, source user agents, and source fingerprints.\n\nCloudflare recommends that you observe your traffic profile for any anomalies in its normal behavior.\n\n### Endpoint details\n\nYou can expand the endpoint details in Web Assets to access information on suspicious sessions' activity on the endpoint, including both enumeration attack and parameter pollution attack details.\n\n[Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\nUnder **Security overview**, select **View attack** to review affected sessions with its associated IP addresses and JA4 fingerprints.\n\nYou can export the `.csv` file containing all the IP addresses and JA4 fingerprints for all or only a specific session.\n\nNote\n\nThe hashed session ID is used for privacy purposes and only as a unique identifier for a specific session. It cannot be un-hashed. It will not match your customer values in your application or database.\n\nThe details specify the parameter that was affected, the number of sessions involved in the attack, and how far their behavior deviated from baseline.\n\nIf unauthorized access to the parameter was obtained, consider the potential impact to your application, users, and data. As a best practice, consult with your application and API developers to confirm unauthorized access by reviewing your API origin logs for the IP address and JA4 fingerprint of the abusive sessions.\n\nYou can view attack data in [Security Analytics](#security-analytics).\n\n[Go to **Analytics**](https://dash.cloudflare.com/?to=/:account/:zone/security/analytics)\n\nThe managed endpoint will be automatically filtered in the request activity from the past seven days. You can also filter by suspicious IP addresses and fingerprints found in the attack details.\n\n***\n\n## Availability\n\nBroken Object Level Authorization vulnerability detection is only available for Enterprise customers. If you are an Enterprise customer interested in this product, contact your account team.\n\n</page>\n\n<page>\n---\ntitle: GraphQL malicious query protection · Cloudflare API Shield docs\ndescription: GraphQL is a query language for APIs. In addition to protecting\n  RESTful APIs, Cloudflare can also protect GraphQL APIs.\nlastUpdated: 2025-11-05T17:30:04.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/graphql-protection/\n  md: https://developers.cloudflare.com/api-shield/security/graphql-protection/index.md\n---\n\nGraphQL is a query language for APIs. In addition to protecting RESTful APIs, Cloudflare can also protect GraphQL APIs.\n\nGraphQL malicious query protection scans your GraphQL traffic for queries that could overload your origin and result in a denial of service. You can build rules that limit the query depth and size of incoming GraphQL queries in order to block suspiciously large or complex queries.\n\n## Availability\n\nGraphQL malicious query protection is available for all API Shield customers. Enterprise customers who have not purchased API Shield can preview [API Shield as a non-contract service](https://dash.cloudflare.com/?to=/:account/:zone/security/api-shield) in the Cloudflare dashboard or by contacting your account team.\n\n## Limitations\n\nOur initial release is limited to parsing GraphQL `POST` bodies smaller than 20 KB. This limit will be lifted in a future release. Additionally, we currently inspect only `POST` requests with `content-types` of `application/json` or `application/graphql` where the queries do not contain fragments or multiple operations. Parsing and rules are limited to paths ending in `/graphql`.\n\n</page>\n\n<page>\n---\ntitle: JSON Web Tokens validation · Cloudflare API Shield docs\ndescription: JSON web tokens (JWT) are often used as part of an authentication\n  component on many web applications today. Since JWTs are crucial to\n  identifying users and their access, ensuring the token’s integrity is\n  important.\nlastUpdated: 2025-09-26T21:09:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/jwt-validation/\n  md: https://developers.cloudflare.com/api-shield/security/jwt-validation/index.md\n---\n\nJSON web tokens (JWT) are often used as part of an authentication component on many web applications today. Since JWTs are crucial to identifying users and their access, ensuring the token’s integrity is important.\n\nAPI Shield’s JWT validation stops JWT replay attacks and JWT tampering by cryptographically verifying incoming JWTs before they are passed to your API origin. JWT validation will also stop requests with expired tokens or tokens that are not yet valid.\n\n## Process\n\nEndpoints must be added to [Endpoint Management](https://developers.cloudflare.com/api-shield/management-and-monitoring/) for JWT validation to protect them.\n\nA JWT validation configuration consists of creating a token validation configuration by adding your JWT signer's public JSON Web Key Set (JWKS) and a JWT validation rule by specifying which hostnames and endpoints should be included for validation.\n\n### Add a token validation configuration\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login), and select your account and domain.\n  2. Go to **Security** > **API Shield** > **Settings**.\n  3. Under **JSON Web Token Settings**, select **Add configuration**.\n  4. Add a name for your configuration.\n  5. Choose where Cloudflare can locate the JWT for this configuration on incoming requests, such as a header or cookie and its name.\n  6. Copy and paste your JWT issuer's public key(s) (JWKS).\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/security/settings)\n\n  2. Filter by **API abuse**.\n\n  3. On **Token configurations**, select **Configure tokens**.\n\n  4. Add a name for your configuration.\n\n  5. Choose where Cloudflare can locate the JWT for this configuration on incoming requests, such as a header or cookie and its name.\n\n  6. Copy and paste your JWT issuer's public key(s) (JWKS).\n\nEach JWT issuer typically publishes public keys (JWKS) for verification at a known URL on the Internet. If you do not know where to get them, contact your identity administrator.\n\nTo automatically keep your JWKS up to date when your identity provider refreshes them, you can use a Worker. Refer to [Configure Workers to automatically update keys](https://developers.cloudflare.com/api-shield/security/jwt-validation/jwt-worker/) to learn more about setting up the Worker.\n\n### Add a JWT validation rule\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login), and select your account and domain.\n\n  2. Go to **Security** > **API Shield** > **API Rules**.\n\n  3. Add a name for your rule.\n\n  4. Select a hostname to protect requests with saved endpoints using the rule.\n\n  5. Deselect any endpoints that you want JWT validation to ignore (for example, an endpoint used to generate a JWT).\n\n  6. Select the token validation configuration that corresponds to the incoming requests.\n\n  7. Choose whether to strictly enforce token presence on these endpoints.\n\n     * You may not expect 100% of clients to send in JWTs with their requests. If this is the case, choose *Ignore*. JWT validation will still validate JWTs that are present.\n     * You may otherwise expect all requests to the selected hostname and endpoints to contain JWTs. If this is the case, choose *Mark as non-compliant*.\n\n  8. Choose an action to take for non-compliant requests. For example, JWTs that do not pass validation (expired, tampered with, or bad signature tokens) or requests with missing JWTs when *Mark as non-compliant* is selected in the previous step.\n\n  9. Select **Save**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n     [Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n  2. On API JWT validation rules, select **Create rule**.\n\n  3. Add a name for your rule.\n\n  4. Select a hostname to protect requests with saved endpoints using the rule.\n\n  5. Deselect any endpoints that you want JWT validation to ignore (for example, an endpoint used to generate a JWT).\n\n  6. Select the token validation configuration that corresponds to the incoming requests.\n\n  7. Choose whether to strictly enforce token presence on these endpoints.\n\n     * You may not expect 100% of clients to send in JWTs with their requests. If this is the case, choose *Ignore*. JWT validation will still validate JWTs that are present.\n     * You may otherwise expect all requests to the selected hostname and endpoints to contain JWTs. If this is the case, choose *Mark as non-compliant*.\n\n  8. Choose an action to take for non-compliant requests. For example, JWTs that do not pass validation (expired, tampered with, or bad signature tokens) or requests with missing JWTs when *Mark as non-compliant* is selected in the previous step.\n\n  9. Select **Save**.\n\nNote\n\nToken configuration rules will automatically apply to new endpoints added to Endpoint Management if those endpoints also match the rule.\n\n## Special cases\n\n### Validate two JWTs with different identity providers on a single request\n\nIf you expect that two different JWTs should be present in a request and you want to validate both, you must create two different token configurations. When selecting the two configurations in your validation rule, select *Validate all configurations* under **Validation behavior for multiple configurations**.\n\n### Support a migration from one identity provider to another\n\nIf you expect to migrate between two different identity providers, you must create two different token configurations and two different validation rules, each corresponding to its own configuration. With this setup, you can change the action for different validation rules depending on the state of your migration.\n\n### JSON Web Tokens with the `Bearer` prefix\n\nAPI Shield will verify JSON Web Tokens regardless of whether or not they have the `Bearer` prefix.\n\n### Rate limit by user (JWT claim)\n\nYou can rate limit requests based on any claim inside of a JSON Web Token (JWT), such as:\n\n* Registered claims like `aud` or `sub`\n* Custom claims like `userEmail`, including nested custom claims like `user.email`\n\nRate limiting based on JWT claim values will only work on valid JSON Web Tokens. If you do not block invalid JSON Web Tokens on your path, the [JWT claims will all be counted and possibly blocked](https://developers.cloudflare.com/waf/rate-limiting-rules/parameters/#missing-field-versus-empty-value) if high traffic is detected in the Point of Presence (PoP).\n\nYou must also count the JWT claim that uniquely identifies the user. If you select a claim that is the same for many of your users, their rate limits will all be counted together.\n\n### Rate limit by user tier\n\nIf you offer multiple tiers on your website or application and you want to enforce rate limiting based on the tiers, such as:\n\n* If `\"aud\": \"free-tier\"`, rate limit to five requests per minute.\n* If `\"aud\": \"premium-tier\"`, rate limit to 50 requests per minute.\n\nYou can follow the rate limiting rule example below:",
      "language": "unknown"
    },
    {
      "code": "## Availability\n\nJWT validation is available for all API Shield customers. Enterprise customers who have not purchased API Shield can preview [API Shield as a non-contract service](https://dash.cloudflare.com/?to=/:account/:zone/security/api-shield) in the Cloudflare dashboard or by contacting your account team.\n\n## Limitations\n\nCurrently, the following known limitations exist:\n\n1. JWT validation only operates on JWTs sent in client request headers or cookies. If your clients send in JWTs in a `POST` body, direct that feedback to your account team.\n2. JWT validation only operates for endpoints (host, method, and path) added to Endpoint Management. You can add all of your endpoints to endpoint management through [API Discovery](https://developers.cloudflare.com/api-shield/management-and-monitoring/#add-endpoints-from-api-discovery), [Schema validation](https://developers.cloudflare.com/api-shield/management-and-monitoring/#add-endpoints-from-schema-validation), [manually via the Cloudflare dashboard](https://developers.cloudflare.com/api-shield/management-and-monitoring/#add-endpoints-manually), or via the [API](https://developers.cloudflare.com/api/resources/api_gateway/subresources/operations/methods/create/).\n\n</page>\n\n<page>\n---\ntitle: Mutual TLS (mTLS) · Cloudflare API Shield docs\ndescription: Mutual TLS (mTLS) authentication is a common security practice that\n  uses client certificates to ensure traffic between client and server is\n  bidirectionally secure and trusted. mTLS also allows requests that do not\n  authenticate via an identity provider — such as Internet-of-things (IoT)\n  devices — to demonstrate they can reach a given resource.\nlastUpdated: 2025-08-20T18:25:25.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/mtls/\n  md: https://developers.cloudflare.com/api-shield/security/mtls/index.md\n---\n\nNote\n\nWhile API Shield is not required to use mTLS, many teams may use mTLS to protect their APIs.\n\n[Mutual TLS (mTLS)](https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/) authentication is a common security practice that uses client certificates to ensure traffic between client and server is bidirectionally secure and trusted. mTLS also allows requests that do not authenticate via an identity provider — such as Internet-of-things (IoT) devices — to demonstrate they can reach a given resource.\n\n![mTLS sequence diagram](https://developers.cloudflare.com/_astro/api-shield-call-sequence.DjXyNgan_ZJ06pk.webp)\n\nSupport includes [gRPC](https://grpc.io/docs/what-is-grpc/introduction/)-based APIs, which use binary formats such as protocol buffers rather than JSON.\n\n## Setup\n\nTo set up mTLS for one or more hosts using the dashboard, refer to [Configure mTLS](https://developers.cloudflare.com/api-shield/security/mtls/configure/).\n\n## Availability\n\nAll Cloudflare plans can set up mTLS with a Cloudflare-managed certificate authority (CA). Enterprise customers can [upload up to five non-Cloudflare CAs](https://developers.cloudflare.com/ssl/client-certificates/byo-ca/). For higher limits, contact your account team.\n\n## Limitations\n\nWhen using Yubikeys, the browser may prompt for unlocking the key due to a problem in Yubikey's PKCS#11 library.\n\n</page>\n\n<page>\n---\ntitle: Schema validation · Cloudflare API Shield docs\ndescription: The API schema defines which API requests are valid based on\n  several request properties like target endpoint, path or query variable\n  format, and HTTP method.\nlastUpdated: 2025-11-14T21:16:16.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/schema-validation/\n  md: https://developers.cloudflare.com/api-shield/security/schema-validation/index.md\n---\n\nAvailable on all plans\n\nThe API schema defines which API requests are valid based on several request properties like target endpoint, path or query variable format, and HTTP method.\n\nSchema validation allows you to check if incoming traffic complies with a previously supplied API schema. When you provide an API schema or select from a list of learned schema, API Shield creates rules for incoming traffic from the schema definitions. These rules define which traffic is allowed and which traffic gets logged or blocked.\n\nCloudflare has launched Schema validation 2.0. For help configuring the previous version of Schema validation for one or more hosts using the dashboard, refer to [Configure Classic Schema validation](https://developers.cloudflare.com/api-shield/reference/classic-schema-validation/). You can make changes to your Classic Schema validation settings but you cannot add any new schemas.\n\nYou can migrate to Schema validation 2.0 manually by uploading your schemas to the new system.\n\n***\n\n## Process\n\nEndpoints must be added to [Endpoint Management](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/) for Schema validation to protect them. Uploading a schema via the Cloudflare dashboard will automatically add endpoints, or you can manually add them from [API Discovery](https://developers.cloudflare.com/api-shield/security/api-discovery/).\n\nIf you are uploading a schema via the API or Terraform, you must parse the schema and add your endpoints manually.\n\nThe API endpoint is the location where API calls or requests are fulfilled. API Shield defines endpoints as a host, method, and path tuple.\n\nNote\n\nTo view the contents in your learned schema, refer to [Export a schema](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/schema-learning/#export-a-schema) in Endpoint Management.\n\n***\n\n### Add validation by uploading a schema\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to **Schema validation** and select **Add validation**.\n  4. Select your schema file for upload.\n  5. Observe the listed endpoints, their host, method, and path. Any new endpoints will automatically be added to Endpoint Management.\n  6. Choose an action for the non-compliant requests to your endpoints.\n  7. Select **Add schema and endpoints**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Add validation**.\n\n  4. Upload a schema file.\n\n  5. Select **Add schema and endpoints**.\n\nNote\n\nChanges may take a few minutes to process depending on the number of added endpoints.\n\n### Add validation by applying a learned schema to a single endpoint\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to **Schema validation** and filter by the learned schema available.\n  4. Select **Apply learned schema**.\n  5. Choose an action and select **Apply schema**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Add validation**.\n\n  4. Select **Apply learned schema**.\n\n  5. Choose an action and select **Apply schema**.\n\n### Add validation by applying a learned schema to an entire hostname\n\nAt this time, learned schemas will not overwrite customer-uploaded schemas. If an endpoint is covered by a customer-uploaded schema and also appears in a learned schema, the **Changes** field is set to `Unaffected`.\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to **Schema validation** and select **Add validation**.\n  4. Select **Apply learned schema**.\n  5. Choose a hostname and review the endpoints that will be protected by the learned schema.\n  6. (Optional) Change the action if a request does not match the schema.\n  7. Select **Apply schema**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Add validation**.\n\n  4. Select **Apply learned schema**.\n\n  5. Choose a hostname and review the endpoints that will be protected by the learned schema.\n\n  6. (Optional) Change the action if a request does not match the schema.\n\n  7. Select **Apply schema**.\n\nNote\n\nIf an endpoint is currently protected by a learned schema, the date of the last applied learned schema will be shown in the current schema field.\n\n### Add validation by adding a fallthrough rule\n\nA fallthrough rule acts as a catch-all for requests that do not match endpoints in [Endpoint Management](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/).\n\nBy ensuring that all your endpoints in a schema are added to Endpoint Management, the fallthrough action can protect you against legacy or zombie endpoints that your team may be unaware of.\n\nTo set up a fallthrough action:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **API Shield**.\n  3. Under **Settings**, go to **Fallthrough settings**.\n  4. Select **Use Template**.\n  5. Choose one or more hostnames from the drop down menu. The fallthrough rule will act on all traffic that does not match an existing endpoint in Endpoint Management to the selected hostnames.\n  6. Select **Continue to custom rule**.\n  7. Name your rule and select your action.\n  8. Select **Save as draft** to deploy later, or **Deploy** to deploy now.\n\n  Your current fallthrough rules can be viewed in the custom rules list.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n     [Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n  2. Select **Templates**.\n\n  3. Search for the template named `Mitigate API requests to unidentified endpoints` and select **Preview template**.\n\n  4. Give your rule a descriptive name.\n\n  5. Choose one or more hostnames from the dropdown menu and select your action.\n\n  6. Select **Save as draft** to deploy later, or **Deploy** to deploy now.\n\n  Your current fallthrough rules can be viewed in the security rules list.\n\nNote\n\nYou can use the `cf.api_gateway.fallthrough_triggered` syntax in your own custom rule for a more customized logic check. This detection will evaluate as `true` when a request does not match an endpoint in Endpoint Management, so it is important to check against your API's hostname or root path to ensure that you are not blocking any non-API traffic on your zone.\n\n### Change the action of an entire schema\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to **Schema validation** and select the schema in the Schema list.\n  4. Check the multi-select box to select the endpoints shown on the current page.\n  5. Choose **Select all endpoints**.\n  6. Select **Change action**.\n  7. Choose an action from the dropdown menu.\n  8. Select **Set action**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Check the multi-select box to select all endpoints associated with the schema.\n\n  4. Select **Change action**.\n\n  5. Choose an action from the dropdown menu.\n\n  6. Select **Set action**.\n\n### Change the global default action of Schema validation\n\nSchema validation’s default action is visible on the main Schema validation page. This action applies to any endpoint with its action set to `Default`.\n\n* `Log` action: logs events to [Firewall Events](https://developers.cloudflare.com/firewall/).\n* `Block` action: blocks requests that fail the schema for an endpoint and logs events to [Firewall Events](https://developers.cloudflare.com/firewall/).\n* `None` action: non-compliant requests are neither logged nor blocked.\n\nTo change the default action:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **API Shield**.\n  3. Select **Schema validation**.\n  4. Under the default `Log` action, select **Change**.\n  5. Choose a new action from the dropdown menu.\n  6. Observe the current action and accept the change by selecting **Change default action** in the popup window.\n\n  Alternatively, you can modify the global action via **Security** > **API Shield** > **Settings**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/security/settings)\n\n  2. Filter by **API abuse**.\n\n  3. Under **Schema validation** > **Configurations**, select the edit icon next to **Default action**.\n\n  4. Choose a new action from the dropdown menu.\n\n  5. Select **Save**.\n\n### Change the action of a single endpoint\n\nYou can change individual endpoint actions separately from the default action in Schema validation.\n\nThis allows you to be stricter on blocking non-compliant requests on certain endpoints when the default action is `Log`. It can also be used to relax constraints on non-compliant requests on certain endpoints when the default action is set to `Block`. You may want to silence known false positives on an endpoint by setting the action to `None`.\n\nTo change the action on an individual endpoint:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **API Shield**.\n  3. Select **Schema validation** and filter the selected endpoint.\n  4. Select the ellipses on the endpoint's row.\n  5. Select **Change action**.\n  6. Choose a new action from the dropdown menu and select **Set action**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Search for the endpoint to change.\n\n  4. Select the three dots on the endpoint's row > **Change action**.\n\n  5. Choose a new action from the dropdown menu and select **Set action**.\n\n### Disable Schema validation without changing actions\n\nYou can disable Schema validation entirely for temporary troubleshooting. You can override all actions at once, preventing Schema validation from taking any action while you complete your troubleshooting.\n\nTo disable Schema validation without changing actions:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to the **Schema validation** settings.\n  4. Select **Disable**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Schema settings**.\n\n  4. Filter by **API abuse**.\n\n  5. Turn **Schema validation** off.\n\nYour per-endpoint configurations will be saved when modifying the setting, so that you do not lose your configuration. To re-enable your configurations after troubleshooting, navigate back to the settings and select **Enable**.\n\n### View active schemas\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to your **Schema validation** settings.\n  4. View your schemas under **Uploaded Schemas** and **Learned schemas**.\n  5. Select **Filter** on the endpoints in either schema.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Schema settings**.\n\n  4. Filter by **API abuse**.\n\n  5. View your schemas on **Schema validation** > **Active schemas**.\n\n### Delete active schemas\n\nDeleting the schema will remove validation from the currently associated endpoints, but it will not delete the endpoints from Endpoint Management.\n\nTo delete currently uploaded or learned schemas:\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Select **Security** > **API Shield**.\n  3. Go to your **Schema validation** settings.\n  4. View your schemas under **Uploaded Schemas** and **Learned schemas**.\n  5. Select the ellipses to access the menu and download or delete the listed schema.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Web Assets** page.\n\n     [Go to **Web assets**](https://dash.cloudflare.com/?to=/:account/:zone/security/web-assets)\n\n  2. Go to the **Schema validation** tab.\n\n  3. Select **Schema settings**.\n\n  4. Filter by **API abuse**.\n\n  5. View your schemas on **Schema validation** > **Active schemas**.\n\n  6. Select the ellipses to access the menu and download or delete the listed schema.\n\n***\n\n## Specifications\n\nCloudflare currently only accepts [OpenAPI v3 schemas](https://spec.openapis.org/oas/v3.0.3.html). The accepted file formats are YAML (`.yml` or `.yaml` file extension) and JSON (`.json` file extension).\n\nOpenAPI schemas generated by different tooling may not be specific enough to import to Schema validation. We recommend using a third-party tool such as [Swagger Editor](https://swagger.io/tools/swagger-editor/) to ensure that schemas are compliant to the OpenAPI specification.\n\n***\n\n## Limitations\n\nCloudflare API Shield's Schema validation (importing) and [Schema learning](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/schema-learning/) (exporting) capabilities rely on the [OpenAPI Specification (OAS) v3.0](https://spec.openapis.org/oas/v3.0.3).\n\nThis support includes all patch versions, such as OAS v3.0.x. We do not currently support OAS v3.1 and do not plan to expand support for OpenAPI 2.0.\n\nNote\n\nCloudflare recommends using a third-party tool like [Swagger Editor](https://editor.swagger.io/) to ensure that all schemas are fully compliant with the OAS v3.0 specification before upload.\n\nCurrently, API Shield does not support some features of API schemas, including the following: all responses, external references, non-basic path templating, or unique items.\n\nThere is a limit of 10,000 total operations for enabled schemas for Enterprise customers subscribed to [API Shield](https://developers.cloudflare.com/api-shield/). To raise this limit, contact your account team.\n\nFor limits on Free, Pro, Business, or Enterprise customers not subscribed to API Shield, refer to [Plans](https://developers.cloudflare.com/api-shield/plans/).\n\n### Required fields\n\nAlthough not strictly required by the OpenAPI specification, Schema validation strictly requires these fields.\n\n#### `schema`\n\n* [`type`](https://spec.openapis.org/oas/v3.0.3#schema-object)\n  * All schemas require a type to be set. If the specific type is not supported by Schema validation, it is usually best to simply set the type to `string` instead.\n\n#### `parameter`\n\n* [`schema`](https://spec.openapis.org/oas/v3.0.3#schema-object)\n  * Schema validation does not support the content field in parameters. For more details, refer to the [notes on validated and supported fields](#notes-on-validated-and-supported-fields) below. Instead, a schema is strictly required on all parameters objects.\n\n### Notes on validated and supported fields\n\nRefer to the information below for more details on Schema validation's current support for various OpenAPI specification (OAS) objects and fields.\n\n#### `servers`\n\n* [`url`](https://spec.openapis.org/oas/v3.0.3#server-object)\n  * Schema validation does not support relative URLs.\n* [`variables`](https://spec.openapis.org/oas/v3.0.3#server-variable-object)\n  * Server variables are not validated.\n\n#### `parameter`\n\n* [`style`](https://spec.openapis.org/oas/v3.0.3#parameter-object)\n  * Only the default values are supported: `\"simple\"` (path or header parameters) and `\"form\"` (query or cookie parameters).\n* [`explode`](https://spec.openapis.org/oas/v3.0.3#parameter-object)\n  * Only the default values are supported: `true` (for form) and `false` (for simple).\n* [`content`](https://spec.openapis.org/oas/v3.0.3#parameter-object)\n  * The content field is not supported in parameters. Use the schema field instead.\n* [`type`](https://spec.openapis.org/oas/v3.0.3#parameter-object)\n  * Cloudflare currently does not validate object type parameters.\n\n#### `reference`\n\n* [`$ref`](https://spec.openapis.org/oas/v3.0.3#reference-object)\n  * External or relative references are not supported.\n\n#### `requestBody`\n\n* `content`\n\n  * [Request Body Object](https://spec.openapis.org/oas/v3.0.3#request-body-object)\n  * [Media Type Object](https://spec.openapis.org/oas/v3.0.3#media-type-object)\n    * Schema validation is able to validate `application/json` documents. If a given schema allows other content types, Schema validation will accept those requests without validation.\n\n#### `parameter/schema`\n\n* `anyOf`\n\n  * [Parameter Object](https://spec.openapis.org/oas/v3.0.3#parameter-object)\n  * [Schema Object](https://spec.openapis.org/oas/v3.0.3#schema-object)\n    * `anyOf` schemas are currently not supported in parameter schemas.\n\n#### `schema`\n\n* [`format`](https://spec.openapis.org/oas/v3.0.3#schema-object)\n\n  * Validated formats:\n\n    * `date-time`\n    * `time`\n    * `date`\n    * `email`\n    * `hostname`\n    * `ipv4`\n    * `ipv6`\n    * `uri`\n    * `uri-reference`\n    * `iri`\n    * `iri-reference`\n    * `int32`\n    * `int64`\n    * `float`\n    * `double`\n    * `password`\n    * `uuid`\n    * `byte`\n    * `uint64`\n\n* [`uniqueItems`](https://spec.openapis.org/oas/v3.0.3#schema-object)\n\n  * This field is currently not validated by Schema validation.\n\n***\n\n## Body inspection\n\nAPI Shield has the ability to identify body specifications contained in uploaded schemas and validate that the data of incoming API requests adheres to them.\n\nSchema validation currently supports validating requests with content-type `application/json`.\n\nWithin the OpenAPI specification, request body schemas are associated to media-ranges (such as `application/*`, `application/xml` or `application/json`).\n\nWhen Cloudflare validates incoming requests, Cloudflare checks that the request's `content-type` matches the OpenAPI-specified media-range.\n\nFor example, when the OpenAPI file specifies `application/*` as part of the request body content map, Cloudflare will accept requests with the content-types `application/xml` and `application/json`. However, only `application/json` bodies will be validated with the supplied schema.\n\nCloudflare generally recommends keeping the media-ranges as tight as possible. We suggest setting them to an individual media-type. If you need to support multiple content-types on an API endpoint, you can utilize wildcard media-ranges.\n\nCare should also be taken if the origin is configured to perform [MIME sniffing](https://mimesniff.spec.whatwg.org/). For example, when a request carrying a JSON body is deliberately carrying an `application/malicous` content-type and Cloudflare was configured to allow `application/*` media-ranges, the request would be passed along to the origin without validating the JSON body contents. However, an origin that ignores the content-type and either trial deserializes or sniffs the MIME type may deserialize the JSON body with a wrong assumption of having passed schema body validation.\n\nAs such, if you need to support `application/json` and `application/xml` on the same endpoint, you can use `application/*`. Cloudflare will validate the provided schema for request bodies where the content-type is set to `application/json`. Requests with content-type `application/xml` (and others matching `application/*`) will be let through. It is still strongly advised to disable content-type sniffing on your origin.\n\nCloudflare allows specifying the following media-ranges in the OpenAPI request body content map:\n\n* `*/*`\n* `application/*`\n* `application/json`.\n\nMedia-ranges can also be configured to enforce a `charset` parameter. For this, Cloudflare only accepts the `charset` parameter with a static value of `utf-8` as part of the media-range specification and when configured, we will similarly require the request's content-type to carry this charset.\n\n***\n\n## Troubleshooting\n\nThis section addresses common issues you may encounter when using schema validation.\n\n### `OneOf` constraint error schema violation in the Security Events\n\nA `OneOf` constraint error means an API request failed schema validation because its body did not match exactly one of the options defined in a [`oneOf`](https://swagger.io/docs/specification/v3_0/data-models/oneof-anyof-allof-not/) list within your uploaded schema.\n\nThe request was invalid for one of two reasons:\n\n* **Matches Zero**: The payload did not correctly match any of the available subschemas. This is common when a discriminator field is set, but the payload is missing other required fields for that type.\n* **Matches Multiple**: The payload was ambiguous and matched more than one subschema. This happens with generic schemas (for example, if a payload includes both an `email` and a `phone` field, it might match both an `email` and a `phone` schema definition, violating the \"exactly one\" rule).\n\nTo fix this, check the failing request body against the API schema definition. It will either be missing required fields for the intended type or include properties from multiple different, conflicting types that make it ambiguous.\n\n***\n\n## Availability\n\nSchema validation is available for all customers. Refer to [Plans](https://developers.cloudflare.com/api-shield/plans/) for more information based on your plan type.\n\n[Schema learning](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/schema-learning/) is only available for customers subscribed to API Shield.\n\n</page>\n\n<page>\n---\ntitle: Sequence Analytics · Cloudflare API Shield docs\ndescription: Sequence Analytics tracks the order of API endpoint requests over\n  time, allowing you to discover how users interact with your API. Sequence\n  Analytics groups and highlights important user journeys (sequences) across\n  your API. You can enforce preferred sequences using Sequence mitigation.\nlastUpdated: 2025-08-20T16:33:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/sequence-analytics/\n  md: https://developers.cloudflare.com/api-shield/security/sequence-analytics/index.md\n---\n\nSequence Analytics tracks the order of API endpoint requests over time, allowing you to discover how users interact with your API. Sequence Analytics groups and highlights important user journeys (sequences) across your API. You can enforce preferred sequences using [Sequence mitigation](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/).\n\n## Process\n\n### Sequence building\n\nA sequence is a time-ordered list of HTTP API requests made by a specific visitor as they browse a website, use a mobile app, or interact with a B2B partner via API.\n\nFor example, a portion of a sequence made during a bank funds transfer could look like:\n\n| Order | Method | Path | Description |\n| - | - | - | - |\n| 1 | `GET` | `/api/v1/users/{user_id}/accounts` | `user_id` is the active user. |\n| 2 | `GET` | `/api/v1/accounts/{account_id}/balance` | `account_id` is one of the user’s accounts. |\n| 3 | `GET` | `/api/v1/accounts/{account_id}/balance` | `account_id` is a different account belonging to the user. |\n| 4 | `POST` | `/api/v1/transferFunds` | This contains a request body detailing an account to transfer funds from, an account to transfer funds to, and an amount of money to transfer. |\n\nAPI Shield uses your configured session identifier and your saved endpoints to build a set of ordered API operations (HTTP host, method, and path) requested per session. We may surface sequences in various lengths depending how API Shield scores the sequences.\n\n### Sequence scoring\n\nAPI Shield scores sequences by a metric called precedence score. Sequence Analytics displays sequences by the highest precedence score. High-scoring sequences contain API requests which are likely to occur together in order.\n\nUsing the example above, a high score means that the last operation in the sequence `POST /api/v1/transferFunds` is highly likely to be preceded by the other operations in sequence `GET /api/v1/users/{user_id}/accounts` followed by `GET /api/v1/accounts/{account_id}/balance`. The scores are probabilities, which API Shield estimates using data from the last 24 hours.\n\n### Secure your API\n\nTo proactively secure your API, you should inspect your highest-scoring sequences. For each high-scoring sequence, you should confirm with your development team if the final operation in the sequence must legitimately always be preceded by the other operations in the sequence.\n\nUsing the above example, if `POST /api/v1/transferFunds` must legitimately always be preceded by `GET /api/v1/users/{user_id}/accounts` and `GET /api/v1/accounts/{account_id}/balance?`, you should create an **Allow** rule in sequence mitigation on the final operation of the sequence.\n\nYou should also consider applying other API Shield protections to these endpoints ([rate limiting suggestions](https://developers.cloudflare.com/api-shield/security/volumetric-abuse-detection/), [Schema validation](https://developers.cloudflare.com/api-shield/security/schema-validation/), [JWT validation](https://developers.cloudflare.com/api-shield/security/jwt-validation/), and [mTLS](https://developers.cloudflare.com/api-shield/security/mtls/)).\n\nFor more information, refer to our [blog post](https://blog.cloudflare.com/api-sequence-analytics).\n\n### Repeated sequences\n\nTrue API usage shows many successively repeated operations. To facilitate exploration, Sequence Analytics collapses successively repeated operations into one.\n\n## Availability\n\nSequence Analytics is available for all API Shield customers. Pro, Business, and Enterprise customers who have not purchased API Shield can get started by [enabling the API Shield trial](https://dash.cloudflare.com/?to=/:account/:zone/security/api-shield) in the Cloudflare dashboard or contacting your account manager.\n\n## Limitations\n\nSequence Analytics currently requires a session identifier and saved endpoints in order to build and track sequences made by an API consumer. Ensure that you have [set up your session identifier(s)](https://developers.cloudflare.com/api-shield/get-started/#session-identifiers) and [saved your endpoints](https://developers.cloudflare.com/api-shield/management-and-monitoring/endpoint-management/).\n\nSequences are currently limited to nine operations in length.\n\n</page>\n\n<page>\n---\ntitle: Sequence mitigation · Cloudflare API Shield docs\ndescription: Sequence mitigation allows you to enforce request patterns for\n  authenticated clients communicating with your API.\nlastUpdated: 2025-12-03T15:21:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/sequence-mitigation/\n  md: https://developers.cloudflare.com/api-shield/security/sequence-mitigation/index.md\n---\n\nSequence mitigation allows you to enforce request patterns for authenticated clients communicating with your API.\n\nYou can use sequence rules to establish a set of known behavior for API clients or detect and mitigate malicious behavior.\n\nFor example, you may expect that API requests made during a bank funds transfer could conform to the following order in time:\n\n| Order | Method | Path | Description |\n| - | - | - | - |\n| 1 | `GET` | `/api/v1/users/{user_id}/accounts` | `user_id` is the active user. |\n| 2 | `GET` | `/api/v1/accounts/{account_id}/balance` | `account_id` is one of the user’s accounts. |\n| 3 | `GET` | `/api/v1/accounts/{account_id}/balance` | `account_id` is a different account belonging to the user. |\n| 4 | `POST` | `/api/v1/transferFunds` | This contains a request body detailing an account to transfer funds from, an account to transfer funds to, and an amount of money to transfer. |\n\nYou may want to enforce that an API user requests `GET /api/v1/users/{user_id}/accounts` before `GET /api/v1/accounts/{account_id}/balance` and that you request `GET /api/v1/accounts/{account_id}/balance` before `POST /api/v1/transferFunds`.\n\nUsing sequence mitigation, you can enforce that request pattern with two new sequence mitigation rules.\n\nNote\n\nYou can create sequence mitigation rules for a sequence even if the sequence is not listed in [Sequence Analytics](https://developers.cloudflare.com/api-shield/security/sequence-analytics/).\n\n## Process\n\nYou can [create a sequence rule](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/manage-sequence-rules/) to enforce behavior on your API over time in two different ways. Sequence rules can either protect an endpoint from users performing a known specific sequence of API calls (otherwise known as a negative security model) or from users making API requests outside of your expectations (otherwise known as a positive security model).\n\nSequence rules built via the Cloudflare dashboard using API Shield rules utilize a lookback window to match endpoints in the sequence. The rule will match as long as both endpoints are found within [10 requests](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/#request-limitations) (to endpoints within Endpoint Management) of each other and made within [10 minutes](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/#time-limitations) of each other.\n\nNote\n\nContact your account team if the default lookback window is not sufficient for you.\n\nIf you want to add multiple endpoints, ignore the lookback window, and configure time-based constraints, refer to [Sequence mitigation custom rules](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/custom-rules/).\n\nIn the bank funds transfer example, enforcing that a user requests `GET /api/v1/accounts/{account_id}/balance` before `POST /api/v1/transferFunds` is considered a positive security model, since a user may only perform a funds transfer after listing an account balance.\n\nA negative security model may be useful if you see abusive behavior that is outside the norm of your application and you need to stop the requests while researching the correct positive security model to implement.\n\nFor example, if there was an authorization bug that allowed users to iterate through other users' profiles that contain account numbers via `GET /api/v1/users/{var1}/profile` and then a user tries to make fradulent funds transfers, you could create up a rule to block or log the sequence `GET /api/v1/users/{var1}/profile` to `POST /api/v1/transferFunds`.\n\n## Limitations\n\n### Endpoint Management\n\nTo track requests to API endpoints, they must be added to [Endpoint Management](https://developers.cloudflare.com/api-shield/management-and-monitoring/). Add your endpoints to endpoint management via [API Discovery](https://developers.cloudflare.com/api-shield/security/api-discovery/), [Schema validation](https://developers.cloudflare.com/api-shield/security/schema-validation/), or [manually](https://developers.cloudflare.com/api-shield/management-and-monitoring/#add-endpoints-manually) through the Cloudflare dashboard.\n\n### Session Identifiers\n\nAPI Shield uses your configured session identifier to track sessions. You must configure a session identifier that is unique per end user of your API in order for sequence mitigation to function as expected.\n\n### Request limitations\n\nBy default, API Shield stores the current and previous nine requested endpoints by each individual API user identified through the session identifier. Contact your account team if the default lookback window is not sufficient for you.\n\nSequence mitigation further de-duplicates requests to the same endpoint while building the sequence.\n\nTo illustrate, in the original [sequence example](https://developers.cloudflare.com/api-shield/security/sequence-mitigation/) listed above, sequence mitigation would store the following sequence:\n\n1. `GET /api/v1/users/{user_id}/accounts`\n2. `GET /api/v1/accounts/{account_id}/balance`\n3. `POST /api/v1/transferFunds`\n\nSequence mitigation de-duplicated the two requests to `GET /api/v1/accounts/{account_id}/balance` and stored them as a single request.\n\n### Time limitations\n\nSequence mitigation rules have a lookback period of 10 minutes, which means that any two requests using the same session identifier will extend the sequence if they happen no further than 10 minutes apart. A request for a session identifier that happens 10 minutes after the last one will start recording a new sequence. For example, if you create a rule that one endpoint must be requested before another endpoint, and more than 10 minutes elapses between a user requesting each endpoint, the rule will not match.\n\n## Availability\n\nSequence mitigation is currently in a closed beta and is only available for Enterprise customers. If you would like to be included in the beta, contact your account team.\n\n</page>\n\n<page>\n---\ntitle: Volumetric Abuse Detection · Cloudflare API Shield docs\ndescription: Cloudflare Volumetric Abuse Detection helps you set up a system of\n  adaptive rate limiting.\nlastUpdated: 2025-11-07T16:57:24.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/api-shield/security/volumetric-abuse-detection/\n  md: https://developers.cloudflare.com/api-shield/security/volumetric-abuse-detection/index.md\n---\n\nCloudflare Volumetric Abuse Detection helps you set up a system of adaptive rate limiting.\n\nCloudflare looks for endpoint abuse based on user traffic to individual endpoints.\n\nFor example, your API might see different levels of traffic to a `/reset-password` endpoint than a `/login` endpoint. Additionally, your `/login` endpoint might see higher than average traffic after a successful marketing campaign.\n\nThese two scenarios speak to the limitations of traditional rate limiting. Not only does traffic vary between endpoints, but it also can vary over time for the same endpoint. Volumetric Abuse Detection solves these problems with unsupervised learning to develop separate baselines for each API and better adjust to changes in user behavior.\n\nVolumetric Abuse Detection rate limits are generated on a per-session basis. Unlike traditional rate limits, which are based on IP addresses, Volumetric Abuse Detection rate limits are not as susceptible to false positives when traffic to your API increases.\n\nVolumetric Abuse Detection rate limits are a way to prevent blatant volumetric abuse while minimizing false positives. If you are trying to prevent abusive bot traffic altogether, refer to Cloudflare’s [Bot solutions](https://developers.cloudflare.com/bots/).\n\n## Process\n\nVolumetric Abuse Detection analyzes your API's individual session traffic statistics to recommend per-endpoint, per-session rate limits.\n\nTo access your endpoints:\n\nOld dashboard: **Security** > **API Shield** > **Endpoint Management**\n\nNew dashboard: **Security** > **Web Assets** > **Endpoints**\n\nRecommendations will continue to update if your traffic pattern changes.\n\n### Requirements\n\nVolumetric Abuse Detection generates rate limit thresholds only after collecting sufficient, statistically safe traffic data for an endpoint. If recommendations are missing for a discovered endpoint, the traffic likely failed to meet the necessary criteria.\n\nThresholds are suggested only for endpoints that satisfy all of the following requirements within the last seven days (or since initial discovery):\n\n* The endpoint must receive sufficient valid traffic (traffic that meets the [API Discovery](https://developers.cloudflare.com/api-shield/security/api-discovery/#requirements) criteria). Intermittent or erratic traffic may prevent suggestions.\n* The endpoint must be accessed by at least 50 distinct sessions in any 24-hour period during the last seven days.\n* [Session identifiers](https://developers.cloudflare.com/api-shield/get-started/#to-set-up-session-identifiers), such as an authorization token available as a request header or cookie, must be configured to allow Cloudflare to accurately detect individual sessions and perform the required per-session rate analysis.\n\nAfter adding a session identifier, allow 24 hours for rate limit recommendations to appear on endpoints in the Cloudflare dashboard.\n\n### Rate limiting recommendation calculation\n\nOnce rate limit recommendations appear in **Endpoints**, select the endpoint row to view more detail about the recommendation. You will see the overall recommended rate limit value, as well as p99, p90, and p50 rate limit values.\n\nWe calculate the recommended rate limit value throughout the day, and the new calculation may equal the existing recommendation due to similar traffic profiles existing on your API. When we recalculate, we look at requests that happened in the last 24 hours.\n\nCloudflare recommends choosing the overall rate limit recommendation, as our analysis includes the variance of the request rate distribution across your API sessions. Choosing a single p-value may cause false positives due to a high number of outliers.\n\np-values\n\np-values describe what percentile of your traffic fits below the value. For example, if your p90 value is `83`, then 90% of your sessions had maximum request rates less than 83 requests per 10 minutes.\n\nIn **Endpoints**, you can review our confidence in the recommendation and how many unique sessions we have seen over the last seven (7) days. In general, endpoints with fewer unique sessions and high variability of user behavior will have lower confidence scores.\n\nImplementing low confidence rate limits can still be helpful to prevent API abuse. If you are hesitant due to the recommendation’s confidence, we suggest starting your rate limit rule in `log` mode and observing violations of the rule for false positives.\n\n### Create rate limits\n\nRefer to the [Rules documentation](https://developers.cloudflare.com/waf/rate-limiting-rules/create-zone-dashboard/) for more information on how to create an Advanced Rate Limiting rule.\n\n## API\n\n[Rate limit recommendations are available via the API](https://developers.cloudflare.com/api/resources/api_gateway/subresources/operations/methods/get/) if you would like to dynamically update rate limits over time.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Account API Gateway`\n* `Account API Gateway Read`\n* `Domain API Gateway`\n* `Domain API Gateway Read`",
      "language": "unknown"
    },
    {
      "code": "## Special cases\n\n### Rate limit by user (JWT claim)\n\nYou can rate limit requests based on any claim inside of a JSON Web Token (JWT), such as:\n\n* Registered claims like `aud` or `sub`\n* Custom claims like `userEmail`, including nested custom claims like `user.email`\n\nRate limiting based on JWT claim values will only work on valid JSON Web Tokens. If you do not block invalid JSON Web Tokens on your path, the [JWT claims will all be counted and possibly blocked](https://developers.cloudflare.com/waf/rate-limiting-rules/parameters/#missing-field-versus-empty-value) if high traffic is detected in the Point of Presence (PoP).\n\nYou must also count the JWT claim that uniquely identifies the user. If you select a claim that is the same for many of your users, their rate limits will all be counted together.\n\n### Rate limit by user tier\n\nIf you offer multiple tiers on your website or application and you want to enforce rate limiting based on the tiers, such as:\n\n* If `\"aud\": \"free-tier\"`, rate limit to five requests per minute.\n* If `\"aud\": \"premium-tier\"`, rate limit to 50 requests per minute.\n\nYou can follow the rate limiting rule example below:",
      "language": "unknown"
    },
    {
      "code": "## Limitations\n\nAPI Shield will always calculate recommendations when session identifiers are configured. To enable session-based rate limits, [subscribe to Advanced Rate Limiting](https://developers.cloudflare.com/waf/rate-limiting-rules/#availability).\n\n## Availability\n\nVolumetric Abuse Detection is only available for Enterprise customers. If you are an Enterprise customer interested in this product, contact your account team.\n\n</page>\n\n<page>\n---\ntitle: Plugin compatibility · Cloudflare Automatic Platform Optimization docs\ndescription: Currently, WordPress offers over 50,000 plugins for download. As a\n  result, testing the compatibility between APO and every available plugin is\n  impossible. However, Cloudflare has a list of officially supported plugins and\n  a list of plugins known to cause issues when APO is enabled.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/about/plugin-compatibility/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/about/plugin-compatibility/index.md\n---\n\nCurrently, WordPress offers over 50,000 plugins for download. As a result, testing the compatibility between APO and every available plugin is impossible. However, Cloudflare has a list of officially supported plugins and a list of plugins known to cause issues when APO is enabled.\n\nFor questions about a specific plugin not shown in the list, create a thread in the [Cloudflare Community](https://community.cloudflare.com/) to begin the conversation.\n\nNote\n\nThe Cloudflare APO WordPress plugin does not support multisite WordPress installation.\n\n## Compatible plugins\n\n* [NitroPack](https://nitropack.io/)\n* [FlyingPress](https://flyingpress.com/)\n* [WP Rocket](https://community.cloudflare.com/t/cloudflares-apo-with-wp-rockets-minified-css/225906/3?u=yevgen) **version 3.8.6 or later**\n* [BigCommerce](https://wordpress.org/plugins/bigcommerce/)\n* [Easy Digital Downloads](https://wordpress.org/plugins/easy-digital-downloads/)\n* [WooCommerce](https://wordpress.org/plugins/woocommerce/)\n* [Redis Object Cache](https://wordpress.org/plugins/redis-cache/)\n* [Object Cache Pro](https://objectcache.pro)\n* [YITH WooCommerce Wishlist](https://wordpress.org/plugins/yith-woocommerce-wishlist/)\n* [WP EasyCart](https://wordpress.org/plugins/wp-easycart/)\n* [Ecwid Ecommerce Shopping Cart](https://wordpress.org/plugins/ecwid-shopping-cart/)\n* [WP ECommerce](https://wordpress.org/plugins/wp-e-commerce/)\n* [Bookly](https://wordpress.org/plugins/bookly-responsive-appointment-booking-tool/)\n* [WPTouch](https://wordpress.org/plugins/wptouch/)\n* [Mobile Detect](https://wordpress.org/plugins/tinywp-mobile-detect/)\n* [WordPress Mobile Pack](https://wordpress.org/plugins/wordpress-mobile-pack/)\n* [WP-Mobilizer](https://wordpress.org/plugins/wp-mobilizer/)\n* [Any Mobile Theme Switcher](https://wordpress.org/plugins/any-mobile-theme-switcher/)\n* [Easy Social Share Buttons](https://codecanyon.net/item/easy-social-share-buttons-for-wordpress/6394476)\n* [Jetpack (Mobile Theme)](https://wordpress.org/plugins/jetpack/)\n* [WPML](https://wpml.org/)\n* [Hummingbird](https://wordpress.org/plugins/hummingbird-performance/)\n* [Imunify360](https://docs.imunify360.com/features/#webshield)\n* [Perfmatters](https://perfmatters.io/docs/cloudflare-wordpress-settings/)\n\n</page>\n\n<page>\n---\ntitle: Test current speed · Cloudflare Automatic Platform Optimization docs\ndescription: Before you begin using APO, we recommend testing your current site\n  speed. Your site speed results give your website a letter grade and\n  performance rating.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/about/test-current-speed/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/about/test-current-speed/index.md\n---\n\nBefore you begin using APO, we recommend testing your current site speed. Your site speed results give your website a letter grade and performance rating.\n\n1. Visit [GTmetrix](https://gtmetrix.com/).\n2. In the text field, enter your website's URL.\n3. Click **Test your site**.\n\nAfter the test runs, you can view your site's grade, performance rating, and other performance metrics.\n\n</page>\n\n<page>\n---\ntitle: Activate the Cloudflare WordPress plugin · Cloudflare Automatic Platform\n  Optimization docs\ndescription: The easiest way to begin using APO is directly from Cloudflare’s\n  WordPress plugin. Before you can use APO, you must first install and activate\n  the plugin and then activate APO.\nlastUpdated: 2025-10-22T09:10:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/get-started/activate-cf-wp-plugin/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/get-started/activate-cf-wp-plugin/index.md\n---\n\nAfter you [change your nameservers](https://developers.cloudflare.com/automatic-platform-optimization/get-started/change-nameservers/), activate the Cloudflare WordPress plugin.\n\n## Prerequisites\n\nBefore activating the Cloudflare WordPress plugin, review the following prerequisites.\n\n### Plan type\n\nFor users on the free plan, [purchase APO](#purchase-apo) before installing the WordPress plugin.\n\nFor users on a Pro plan or higher, continue to [Install and activate](#install-and-activate-the-cloudflare-wordpress-plugin) the Cloudflare WordPress plugin.\n\n### Plugin compatibility\n\nCloudflare recommends turning off plugins such as WP Rocket Cache Plugin, W3 Total Cache, or similar plugins when first setting up APO. After confirming APO is working, we recommend testing whether turning on the plugins listed above improves results or causes unexpected behavior. In many cases, using APO along with other caching plugins can cause unexpected results.\n\nWe also recommend clearing the server cache for the WP Rocket Cache plugin, W3 Total Cache, or similar plugins after APO activation.\n\nFor more details, refer to [Plugin compatibility](https://developers.cloudflare.com/automatic-platform-optimization/about/plugin-compatibility/).\n\n### Limitations\n\nThe Cloudflare APO WordPress plugin does not support multisite WordPress installation.\n\n## Purchase APO\n\n1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n2. Go to **Content Optimization**.\n\n3. For **Automatic Platform Optimization for WordPress**, select **Purchase**.\n\n4. Enter your payment information and select **Confirm payment**.\n\n## Install and activate the Cloudflare WordPress plugin\n\nThe easiest way to begin using APO is directly from Cloudflare’s WordPress plugin. Before you can use APO, you must first install and activate the plugin and then activate APO.\n\n1. Navigate and log in to your WordPress account.\n2. Select **Plugins** > **Add new**.\n3. In the search field, enter `Cloudflare`.\n4. Locate the Cloudflare plugin and select **Install now**.\n5. After the plugin finishes installing, select **Activate**. The Cloudflare plugin now displays in your Plugins list.\n\n## Activate APO\n\nTo create the connection between WordPress and Cloudflare, you will create an API token from your Cloudflare dashboard and add it to WordPress. To set up APO on a subdomain, refer to [Subdomains and subdirectories](https://developers.cloudflare.com/automatic-platform-optimization/reference/subdomain-subdirectories/).\n\n## Create the API token from Cloudflare\n\n1. In the Cloudflare dashboard, go to the **Account API tokens** page.\n\n   [Go to **Account API tokens**](https://dash.cloudflare.com/?to=/:account/api-tokens)\n\n2. Select **Create Token**.\n\n3. Locate **WordPress** from the list and select **Use template**.\n\n4. Select **Continue to summary** at the bottom of the page.\n\n5. On the **WordPress API token summary** page, select **Create Token**. Your API token displays.\n\n6. Select the **Copy** button to copy your token. You will need to paste the token in the next section.\n\nNote\n\nCopy and paste your API token into a document saved on your computer to easily reference it again.\n\n## Add your API token to WordPress\n\n1. Open your WordPress account and navigate to Plugins.\n2. Locate the Cloudflare plugin and select **Settings**.\n3. Select the option to sign in with an existing account.\n4. Enter your email address and paste the token you copied in Step 7 of Create the API token from Cloudflare.\n5. Select **Save API Credentials**.\n6. For **Apply Recommended Cloudflare Settings for WordPress**, select **Apply**.\n7. For **Automatic Platform Optimization**, switch the toggle to **On** to enable APO.\n\nTo verify APO is working, see [Verify APO works](https://developers.cloudflare.com/automatic-platform-optimization/get-started/verify-apo-works/).\n\n</page>\n\n<page>\n---\ntitle: Change nameservers · Cloudflare Automatic Platform Optimization docs\ndescription: After you confirm your DNS records, change your nameservers.\nlastUpdated: 2024-10-16T15:56:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/get-started/change-nameservers/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/get-started/change-nameservers/index.md\n---\n\nAfter you [confirm your DNS records](https://developers.cloudflare.com/automatic-platform-optimization/get-started/confirm-dns-records/), change your nameservers.\n\nUpdating your domain to use Cloudflare's nameservers is a critical step to ensure Cloudflare can optimize and protect your site. Nameservers are your primary DNS controller and identify the location of your domain on the Internet.\n\nDomain registrars can take up to 24 hours to process the nameserver updates. You will receive an email from Cloudflare once your site is activated.\n\n## Lookup domain name registration\n\n1. Visit [WHOIS](https://lookup.icann.org/) to look up your domain name registration.\n2. In the text field, enter your domain name without `https://www.` and select **Lookup**.\n3. From **Domain Information**, make note of the nameserver information that displays. You will update those nameservers to point to Cloudflare.\n\nWe recommend keeping this browser tab or window open and opening a new tab or window for the next section.\n\n## Update your nameserver with your domain registrar\n\n1. Log in to the administrator account for your domain registrar.\n2. Navigate to DNS Management.\n3. Locate your nameserver information. Your nameservers should match the information from Step 3 of Lookup domain name registration.\n4. Replace the existing nameserver information with the Cloudflare nameservers from Step 4 of Create the custom nameserver with Cloudflare.\n\nNote\n\nYou may be prompted to confirm the nameserver change with your domain registrar. Confirm or continue after making the update.\n\n</page>\n\n<page>\n---\ntitle: Confirm DNS records · Cloudflare Automatic Platform Optimization docs\ndescription: Before you change your nameservers, confirm your DNS records are\n  displaying correctly.\nlastUpdated: 2025-10-22T09:10:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/get-started/confirm-dns-records/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/get-started/confirm-dns-records/index.md\n---\n\nBefore you change your nameservers, confirm your DNS records are displaying correctly.\n\n1. In the Cloudflare dashboard, go to the DNS **Records** page.\n\n   [Go to **Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records)\n\n2. To add a record, select **Add record**.\n\n3. To edit an existing record, select **Edit** for the appropriate record.\n\n4. After making your changes, select **Save**.\n\nAfter you confirm your DNS records, [change your nameservers](https://developers.cloudflare.com/automatic-platform-optimization/get-started/change-nameservers/).\n\n</page>\n\n<page>\n---\ntitle: Verify APO works · Cloudflare Automatic Platform Optimization docs\ndescription: \"When APO is working, three headers are present:  CF-Cache-Status,\n  cf-apo-via,cf-edge-cache. APO works correctly when the headers exactly match\n  the headers below.\"\nlastUpdated: 2025-10-22T09:10:43.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/get-started/verify-apo-works/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/get-started/verify-apo-works/index.md\n---\n\nYou can check whether or not APO is working by verifying APO headers are present. When APO is working, three headers are present: `CF-Cache-Status`, `cf-apo-via`, `cf-edge-cache`.\n\n1. Visit [Uptrends.com](https://www.uptrends.com/tools/http-response-header-check).\n2. In the text field, enter the URL for your WordPress homepage including the `https://www.`.\n3. Select **Start test**. The **Response Headers** table displays.\n4. Locate the three header responses and their description. APO is working correctly when the headers exactly match the headers below.\n\n* `CF-Cache-Status` | `HIT`\n  * The `cf-cache-status` header displays if the asset is served from the cache or was considered dynamic and served from the origin.\n* `cf-apo-via` | `tcache`\n  * The `cf-apo-via` header returns the APO status for the given request.\n* `cf-edge-cache` | `cache, platform=wordpress`\n  * The `cf-edge-cache` headers confirms the WordPress plugin is installed and enabled.\n\nIn a terminal, use the following cURL. The header `'accept: text/html'` is important.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "As always, `cf-cache-status` displays if the asset hit the cache or was considered dynamic and served from the origin.\n\n* `cf-apo-via` | `tcache`\n  * The `cf-apo-via` header returns the APO status for the given request.\n* `cf-edge-cache` | `cache, platform=wordpress`\n  * The `cf-edge-cache` headers confirms the WordPress plugin is installed and enabled.\n\n## Verify the APO integration and WordPress integration work\n\nOpen your WordPress site and publish a change. When the integration is working, the page is cached with `cf-cache-status: HIT` and `cf-apo-via: tcache`.\n\n</page>\n\n<page>\n---\ntitle: Cache by device type · Cloudflare Automatic Platform Optimization docs\ndescription: \"APO cache by device type provides all of the same benefits of\n  Cloudflare's cache while targeting visitors with content appropriate to their\n  device. Cloudflare evaluates the User-Agent header in the HTTP request to\n  identify the device type. Cloudflare then identifies each device type with a\n  case insensitive match to the regex below:\"\nlastUpdated: 2024-09-25T18:55:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/reference/cache-device-type/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/reference/cache-device-type/index.md\n---\n\nAPO cache by device type provides all of the same benefits of Cloudflare's cache while targeting visitors with content appropriate to their device. Cloudflare evaluates the `User-Agent` header in the HTTP request to identify the device type. Cloudflare then identifies each device type with a case insensitive match to the regex below:\n\n* **Mobile**: `(?:phone|windows\\s+phone|ipod|blackberry|(?:android|bb\\d+|meego|silk|googlebot) .+? mobile|palm|windows\\s+ce|opera mini|avantgo|mobilesafari|docomo|kaios)`\n* **Tablet**: `(?:ipad|playbook|(?:android|bb\\d+|meego|silk)(?! .+? mobile))`\n* **Desktop**: Everything else not matched above.\n\nTo enable caching by device type, enable the setting from the Cloudflare dashboard's APO card or from the WordPress plugin version 4.4.0 or later.\n\nOnce enabled, Cloudflare sends a `CF-Device-Type` HTTP header to your origin with a value of either `mobile`, `tablet`, `desktop` for every request to specify the visitor’s device type. If your origin responds with the appropriate content for that device type, Cloudflare only caches the resource for that specific device type.\n\nNote\n\nChanging Cache By Device Type setting will invalidate Cache.\n\nThe Cloudflare for WordPress plugin automatically purges all cache variations for updated pages.\n\nCloudflare recommends that you use plugins that support cache by device type, which you may have to enable on the plugin. You will still need to test your plugins to make sure they behave as expected.\n\n</page>\n\n<page>\n---\ntitle: Page Rule integration with APO · Cloudflare Automatic Platform\n  Optimization docs\ndescription: The following Page Rules can control APO. Any changes to caching\n  via Page Rules require purging the cache for the changes to take effect.\nlastUpdated: 2024-11-04T10:01:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/reference/page-rule-integration/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/reference/page-rule-integration/index.md\n---\n\nThe following Page Rules can control APO. Any changes to caching via Page Rules require purging the cache for the changes to take effect.\n\nWarning\n\nConsider using [Cache Rules](https://developers.cloudflare.com/cache/how-to/cache-rules/) instead to control APO due to their enhanced configurability.\n\n* **Cache Level: Bypass** — APO bypasses pages with response header `cf-apo-via: origin,page-rules`\n\n* **Cache Level: Ignore Query String** — APO ignores all query strings when serving from Cache.\n\n* **Cache Level: Cache Everything** — APO caches pages with all query strings.\n\n  Warning\n\n  Automatic page purge via the WordPress plugin won’t clean all cached pages, only pages without query strings. Cached responses will be returned even with request header `cache-control: no-cache`.\n\n* **Bypass Cache on Cookie (Business and Enterprise plans only)** — APO applies custom bypass cookies in addition to the default list.\n\n* **Edge Cache TTL** — APO applies custom Edge TTL instead of 30 days. This page rule is helpful for pages that can generate Captchas or nonces.\n\n* **Browser Cache TTL** — APO applies custom Browser TTL.\n\n* `CDN-Cache-Control` and `Cloudflare-CDN-Cache-Control` – Enables users to have detailed control over cache TTLs without using a page rule. For more information on the `CDN-Cache-Control` and `Cloudflare-CDN-Cache-Control` headers, refer to [CDN-Cache-Control](https://developers.cloudflare.com/cache/concepts/cache-control/).\n\n</page>\n\n<page>\n---\ntitle: Query parameters and cached responses · Cloudflare Automatic Platform\n  Optimization docs\ndescription: Query parameters often signal the presence of dynamic content. As a\n  result, if there are query parameters in the URL, APO bypasses the cache and\n  attempts to get a new version of the page from the origin by default. Because\n  query parameters are also often used for marketing attribution, like UTMs,\n  quick loading times are especially important for users.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/reference/query-parameters/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/reference/query-parameters/index.md\n---\n\nQuery parameters often signal the presence of dynamic content. As a result, if there are query parameters in the URL, APO bypasses the cache and attempts to get a new version of the page from the origin by default. Because query parameters are also often used for marketing attribution, like UTMs, quick loading times are especially important for users.\n\nTo add a query parameter to our allowlist, [create a post in the community](https://community.cloudflare.com/) for consideration.\n\nAPO serves cached content as long as the query parameters in the URL are one of the following:\n\n* `ref`\n* `utm_source`\n* `utm_medium`\n* `utm_campaign`\n* `utm_term`\n* `utm_content`\n* `utm_expid`\n* `fbclid`\n* `fb_action_ids`\n* `fb_action_types`\n* `fb_source`\n* `mc_cid`\n* `mc_eid`\n* `gclid`\n* `dclid`\n* `_ga`\n* `campaignid`\n* `adgroupid`\n* `_ke`\n* `cn-reloaded`\n* `age-verified`\n* `ao_noptimize`\n* `usqp`\n* `mkt_tok`\n* `epik`\n* `ck_subscriber_id`\n\n## Cookies prefixes that always bypass cache\n\n* `wp-`\n* `wordpress`\n* `comment_`\n* `woocommerce_`\n* `xf_`\n* `edd_`\n* `jetpack`\n* `yith_wcwl_session_`\n* `yith_wrvp_`\n* `wpsc_`\n* `ecwid`\n* `ec_`\n* `bookly_`\n* `bookly`\n\n</page>\n\n<page>\n---\ntitle: Subdomains and subdirectories · Cloudflare Automatic Platform Optimization docs\ndescription: After you enable APO, you configure it to run on the subdomain that\n  uses WordPress. For example, if you have a website called www.mysite.com which\n  includes a subdomain running WordPress called shop.mysite.com, you would\n  configure APO to run on the shop.mysite.com subdomain.\nlastUpdated: 2024-11-14T17:22:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/reference/subdomain-subdirectories/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/reference/subdomain-subdirectories/index.md\n---\n\n## Run APO on a subdomain\n\nAfter you enable APO, you configure it to run on the subdomain that uses WordPress. For example, if you have a website called `www.mysite.com` which includes a subdomain running WordPress called `shop.mysite.com`, you would configure APO to run on the `shop.mysite.com` subdomain.\n\n1. Install version 4.4.0 or later of the Cloudflare WordPress plugin.\n2. Log in using Cloudflare **API token** or **Global key**.\n3. Enable APO. The subdomain displays in the list of hostnames in the card.\n4. Repeat the process for each subdomain to enable APO.\n\nBy default, APO runs on the apex domain (also known as \"root domain\" or \"naked domain\"). If you choose to run APO on a subdomain, the apex domain is automatically disabled. To run APO on a subdomain and the apex domain, upgrade the WordPress plugin to version 4.4.0 or later on the apex domain and re-enable APO.\n\n## Run APO on a subdirectory\n\nAfter you enable APO, you configure it to run on the subdirectory that uses WordPress. For example, if you have a website called `www.mysite.com` which includes a subdirectory running WordPress called `mysite.com/shop`, you would configure APO to run on the `mysite.com` domain.\n\n1. Install the Cloudflare WordPress plugin.\n2. Add your Cloudflare API Token.\n3. Activate APO.\n\nRepeat steps 1 and 2 for each subdirectory to activate the WordPress plugin for automatic cache purging.\n\n## Run APO only on a subdirectory\n\nIf you choose to run APO only on a subdirectory, the rest of the domain should be configured to bypass APO. You can bypass APO in one of two ways.\n\n### Use the `cf-edge-cache` response header\n\nThe `cf-edge-cache: no-cache` instructs the APO service to bypass caching for non-WordPress parts of the site. You can implement this option with Cloudflare Workers using the example below.",
      "language": "unknown"
    },
    {
      "code": "### Use Cache Rules\n\nCreate a [cache rule](https://developers.cloudflare.com/cache/how-to/cache-rules/) to exclude non-WordPress portions of the site from caching using **Cache eligibility: Bypass cache**. This option disables all caching, including static assets for those paths. As a result, we recommend disabling APO via the response header.\n\n</page>\n\n<page>\n---\ntitle: FAQs · Cloudflare Automatic Platform Optimization docs\ndescription: No, you do not need create Edge Cache TTL page rules. When the\n  WordPress plugin is installed, APO automatically caches content for 30 days\n  and invalidates on change within 30 seconds. However, because APO now supports\n  cache-related page rules, make sure existing page rules do not affect the\n  resources served by APO.\nlastUpdated: 2025-08-11T21:16:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/automatic-platform-optimization/troubleshooting/faq/\n  md: https://developers.cloudflare.com/automatic-platform-optimization/troubleshooting/faq/index.md\n---\n\n## Do I still need to create \"Edge Cache TTL\" page rules with \"Cache Level: Cache Everything\"?\n\nNo, you do not need create Edge Cache TTL page rules. When the WordPress plugin is installed, APO automatically caches content for 30 days and invalidates on change within 30 seconds. However, because APO now supports cache-related page rules, make sure existing page rules do not affect the resources served by APO.\n\n## Does Origin Cache Control override APO?\n\nNo. APO ignores Origin Cache Control for caching on the Edge, but APO serves original Origin Cache Control to the client.\n\n## Why are my browser cache control headers missing with APO?\n\nThe browser cache control headers may be missing with APO if you set your **Browser Cache TTL** to **Respect Existing Headers**. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "## Is the stale-if-error directive still needed with APO?\n\nNo, the `stale-if-error` directive is not needed because the feature is built into APO.\n\n## When I check the posts and homepage cache status, the response header shows `cf-cache-status: BYPASS`. Is APO working?\n\nWhen Chrome DevTools is open, Chrome sends `Cache-Control: no-cache` by default. You can uncheck the **Disable cache (while DevTools is open)** setting and see that `cf-cache-status: HIT` and `cf-apo-via: cache` headers will be returned.\n\n## When I check `cf-cache-status` via cURL, `MISS` and `DYNAMIC` are always returned. In my browser, I see `HIT` but other tools return `DYNAMIC`. Is this expected behavior?\n\nYes, this is expected behavior because the requests must contain `accept: \"text/html\"`.\n\n## Are Google Fonts optimized when APO is activated?\n\nYes, Google Fonts are also optimized when APO is activated. You can confirm the optimization by checking the font URLs. For example, the URL will change from `https://fonts.gstatic.com/s/...` to `https://example.com/fonts.gstatic.com/s/...` when the site loads. For proxied fonts, the `cf-apo-via:proxy` header is returned.\n\n## Can I customize query string caching with APO?\n\nFor more information on query parameters, see [Query parameters and cached responses](https://developers.cloudflare.com/automatic-platform-optimization/reference/query-parameters/).\n\n## Why are my font URLs not being transformed?\n\nAPO will skip URL font transformation when the `content-security-policy` response header is present but missing the values described below.\n\nTo fix the problem, the `content-security-policy` header value must allow for `unsafe-inline` on either the `style-src` or `default-src` directive. For example, `Content-Security-Policy: style-src unsafe-inline;`.\n\nThe header must allow for `self` on either the `font-src` or `default-src` directive. For example, `Content-Security-Policy: font-src self;`.\n\n## Why do I see Worker subrequests in my zone logs when using APO?\n\nAPO uses Cloudflare Workers internally to optimize content delivery, which results in Worker subrequests. These subrequests may appear in your zone logs (for example, via Logpush).\n\n## For the APO plugin why do I see: This plugin hasn’t been tested with the latest 3 major releases of WordPress. It may no longer be maintained or supported and may have compatibility issues when used with more recent versions of WordPress.\n\nIt is not uncommon for mature plugins to see no updates for longer periods than it takes to trigger the WordPress not tested warning. The warning is for notification purposes and is not an indication that a plugin no longer works. It is still maintained.\n\n</page>\n\n<page>\n---\ntitle: AI Labyrinth · Cloudflare bot solutions docs\ndescription: The AI Labyrinth adds invisible links on your webpage with specific\n  Nofollow tags to block AI crawlers that do not adhere to the recommended\n  guidelines and crawl without permission. AI crawlers that scrape your website\n  content without permission will be stuck in a maze of never-ending links, and\n  their details are recorded and used by all Cloudflare customers who choose to\n  block AI bots.\nlastUpdated: 2025-09-26T21:09:24.000Z\nchatbotDeprioritize: false\ntags: AI\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/ai-labyrinth/\n  md: https://developers.cloudflare.com/bots/additional-configurations/ai-labyrinth/index.md\n---\n\nThe AI Labyrinth adds invisible links on your webpage with specific `Nofollow` tags to block AI crawlers that do not adhere to the recommended guidelines and crawl without permission. AI crawlers that scrape your website content without permission will be stuck in a maze of never-ending links, and their details are recorded and used by all Cloudflare customers who choose to block [AI bots](https://developers.cloudflare.com/bots/concepts/bot/#ai-bots).\n\nThese links do not impact your search engine optimization (SEO) or your website's appearance, and are only seen by bots. AI bots that respect no-crawl instructions will safely ignore this honeypot.\n\nTo enable [AI Labyrinth](https://developers.cloudflare.com/bots/additional-configurations/ai-labyrinth):\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **Bots**.\n  3. Select **Configure Bot Fight Mode**.\n  4. Enable **AI Labyrinth**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/security/settings)\n\n  2. Filter by **Bot traffic**.\n\n  3. Go to **AI Labyrinth**.\n\n  4. Turn **AI Labyrinth** on.\n\n</page>\n\n<page>\n---\ntitle: Block AI Bots · Cloudflare bot solutions docs\ndescription: You can choose to block AI bots by activating Block AI bots.\n  Activating this setting will block verified bots that are classified as AI\n  crawlers, as well as a number of unverified bots that behave similarly.\nlastUpdated: 2025-09-26T21:09:24.000Z\nchatbotDeprioritize: false\ntags: AI\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/block-ai-bots/\n  md: https://developers.cloudflare.com/bots/additional-configurations/block-ai-bots/index.md\n---\n\nBlock AI bots availability\n\nThe **Block AI bots** feature is only available in the new [application security dashboard](https://developers.cloudflare.com/security/).\n\nYou can choose to block AI bots by activating **Block AI bots**. Activating this setting will block [verified bots](https://developers.cloudflare.com/bots/concepts/bot/verified-bots/) that are classified as AI crawlers, as well as a number of unverified bots that behave similarly.\n\nTo block [AI bots](https://developers.cloudflare.com/bots/concepts/bot/#ai-bots):\n\n1. In the Cloudflare dashboard, go to the **Security Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/security/settings)\n\n2. Filter by **Bot traffic**.\n\n3. Go to **Block AI bots**.\n\n4. Under **Configurations**, select the edit icon. Choose from:\n\n   * **Only block on hostnames with ads**: Use this option if you wish to block AI bots only on portions of your site that show ads. Cloudflare automatically detects whether ads are present on a subdomain, and only block on hostnames that contain those ad units.\n   * **Block on all pages**: Use this option if you wish to block AI bots on all your pages.\n   * **Do not block (off)**: Use this option if you wish to allow AI bots on all your pages.\n\n5. Select **Save** to save your configuration.\n\nTo block individual AI crawlers (rather than blocking all crawlers), use [AI Crawl Control](https://developers.cloudflare.com/ai-crawl-control/).\n\n</page>\n\n<page>\n---\ntitle: Detection IDs · Cloudflare bot solutions docs\ndescription: Detection IDs are static rules used to detect predictable bot\n  behavior with no overlap with human traffic. Detection IDs refer to the\n  precise detection used to identify a bot, which could be from heuristics,\n  verified bot detections, or anomaly detections. For example, a detection ID\n  can identify if you sent your headers in a different order than what was\n  expected of your browser.\nlastUpdated: 2025-11-05T15:19:42.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/detection-ids/\n  md: https://developers.cloudflare.com/bots/additional-configurations/detection-ids/index.md\n---\n\nDetection IDs are static rules used to detect predictable bot behavior with no overlap with human traffic. Detection IDs refer to the precise [detection](https://developers.cloudflare.com/bots/concepts/bot-detection-engines/) used to identify a bot, which could be from heuristics, verified bot detections, or anomaly detections. For example, a detection ID can identify if you sent your headers in a different order than what was expected of your browser.\n\nIf you are having an issue with one of our heuristics, detection IDs allow you to decide which heuristics to enforce on your zones using customer configurable heuristics. You can choose unique actions for different bots, detected through Cloudflare’s heuristics engine. You can block, allow, or serve alternate content to specific bots to meet the unique needs of your site’s traffic.\n\nNote\n\nA request can trigger multiple detection IDs.\n\nYou can use `cf.bot_management.detection_ids` fields in tools such as:\n\n* [Custom rules](https://developers.cloudflare.com/waf/custom-rules/)\n* [Advanced Rate Limiting](https://developers.cloudflare.com/waf/rate-limiting-rules/)\n* [Transform Rules](https://developers.cloudflare.com/rules/transform/)\n* [Workers](https://developers.cloudflare.com/workers/) (as `request.cf.botManagement.detectionIds`)\n\nBot Detection IDs and tags are also available in [Bot Analytics](https://developers.cloudflare.com/bots/bot-analytics/) and [Security Analytics](https://developers.cloudflare.com/waf/analytics/security-analytics/).\n\n***\n\n## Detection tags\n\nDetection tags refer to the category associated with the detection ID at the time that Cloudflare has fingerprinted a bot. For example, if a detection tag is `go`, this means that Cloudflare has observed traffic from that detection ID from a Go programming language bot.\n\nNote\n\nDetection tags are available in Security Analytics, but not in the Security Events.\n\n***\n\n## Create or edit an expression\n\n* Old dashboard\n\n  1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **Bots**, apply filters and select **Create custom rule** to create a [custom rule](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/) based on those filters. Alternatively, if you already created a custom rule, go to **Security** > **WAF** > **Custom rules** and edit the expression of an existing custom rule.\n  3. Use the `cf.bot_management.detection_ids` field in the rule expression.\n  4. Select **Save**.\n\n* New dashboard\n\n  1. In the Cloudflare dashboard, go to the **Security Analytics** page.\n\n     [Go to **Analytics**](https://dash.cloudflare.com/?to=/:account/:zone/security/analytics)\n\n  2. Apply filters and select **Create custom security rule** to create a custom rule based on your filters.\n\n     Alternatively, if you have already created a custom rule, you can go to the existing rule in **Security rules** and edit the expression based on your filters.\n\n     [Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n  3. Use the `cf.bot_management.detection_ids` field in the rule expression.\n\n  4. Select **Deploy**.\n\n***\n\n## Use cases\n\n### Block requests that match a specific detection ID",
      "language": "unknown"
    },
    {
      "code": "### Run Bot Management without specific detection IDs",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Bot Detection IDs via Logpush\n\nYou can create or edit existing Logpush jobs to include the new Bot Detection IDs field which will provide an array of IDs for each request that has heuristics match on it. The `BotDetectionIDs` field is available as part of the HTTP Requests dataset and you can add it to new or existing jobs via the Logpush API or on the Cloudflare dashboard. This is the primary method to discover Detection IDs.\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Logpush** page.\n\n     [Go to **Logpush**](https://dash.cloudflare.com/?to=/:account/logs)\n\n  2. Select **Create a Logpush Job**.\n\n  3. Select and enter the destination information.\n\n  4. Select **HTTP Requests** as the dataset.\n\n  5. Select **BotDetectionIDs** under the General data field category.\n\n  6. Prove the ownership.\n\n  7. Select **Save**.\n\n* API\n\n  [Update your logpush job](https://developers.cloudflare.com/logs/logpush/logpush-job/log-output-options/) by adding `BotDetectionIDs` to the `output_options:` parameters.\n\n***\n\n## Availability\n\nDetection IDs are available for Enterprise Bot Management customers.\n\n</page>\n\n<page>\n---\ntitle: JA3/JA4 fingerprint · Cloudflare bot solutions docs\ndescription: JA3 and JA4 fingerprints help you profile specific SSL/TLS clients\n  across different destination IPs, Ports, and X509 certificates.\nlastUpdated: 2025-08-20T18:25:25.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/ja3-ja4-fingerprint/\n  md: https://developers.cloudflare.com/bots/additional-configurations/ja3-ja4-fingerprint/index.md\n---\n\n[**JA3**](https://github.com/salesforce/ja3) and [**JA4**](https://github.com/FoxIO-LLC/ja4) **fingerprints** help you profile specific SSL/TLS clients across different destination IPs, Ports, and X509 certificates.\n\nJA4 fingerprint adds new functionality by sorting ClientHello extensions and reducing the total number of unique fingerprints for modern browsers.\n\nNote\n\nJA3 and JA4 fingerprints are only available to Enterprise customers who have purchased Bot Management.\n\nIf you want to use JA4 fingerprints and Signals Intelligence, your Workers script must be able to handle the absence of any field in the array, including:\n\n* The possibility that the JA4 fingerprint could be missing.\n* The possibility that the `ja4Signals` array could be missing.\n* Results with `NaN` or `Infinity` values will be excluded from the array.",
      "language": "unknown"
    },
    {
      "code": "When JA4 Signals are missing, the output appears as follows:",
      "language": "unknown"
    },
    {
      "code": "Note\n\nThis sample was generated using [Workers' Cloudflare Object script](https://developers.cloudflare.com/workers/examples/accessing-the-cloudflare-object/).\n\nThe JA3 or JA4 fingerprint is an SSL/TLS-based identifier and can be null or empty in logs under specific circumstances:\n\n* Since JA3 and JA4 are calculated during the TLS (SSL) handshake, they will not be present for non-encrypted HTTP traffic.\n* The field may be empty when a [Worker](https://developers.cloudflare.com/workers/) sends a request to a zone that is either internal to Cloudflare's network (Orange-to-Orange traffic that is not proxied) or to a third-party origin, or when a Worker is routing traffic to the target zone.\n* The fingerprints may be absent when Bot Management itself is skipped for a request, as the feature is responsible for calculating and populating these values.\n\nGenerally, [Orange to Orange (O2O) traffic](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/saas-customers/) should include JA3 or JA4 fingerprints unless a Worker is used to route traffic from the eyeball (client-facing) zone to the target zone.\n\n## Analytics\n\nTo get more information about potential bot requests, use these JA3 and JA4 fingerprints in:\n\n* [Bot Analytics](https://developers.cloudflare.com/bots/bot-analytics/#enterprise-bot-management)\n* [Security Events](https://developers.cloudflare.com/waf/analytics/security-events/) and [Security Analytics](https://developers.cloudflare.com/waf/analytics/security-analytics/)\n* [Analytics GraphQL API](https://developers.cloudflare.com/analytics/graphql-api/), specifically the **HTTP Requests** dataset\n* [Logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/zone/http_requests/)\n\n## Actions\n\nTo adjust how your application responds to specific fingerprints, use them with:\n\n* [WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/)\n* [Transform Rules](https://developers.cloudflare.com/rules/transform/)\n* [Cloudflare Workers](https://developers.cloudflare.com/workers/runtime-apis/request/#incomingrequestcfproperties)\n\n## Use cases\n\n### Block or allow certain traffic\n\nA group of similar requests may share the same JA3 fingerprint. For this reason, JA3 may be useful in blocking an incoming threat. For example, if you notice that a bot attack is not caught by existing defenses, create a [custom rule](https://developers.cloudflare.com/waf/custom-rules/) that blocks or challenges the JA3 used for the attack.\n\nAlternatively, if existing defenses are blocking traffic that is actually legitimate, create a [custom rule](https://developers.cloudflare.com/waf/custom-rules/) with the *Skip* action allowing the JA3 seen across good requests.\n\nJA3 may also be useful if you want to immediately remedy false positives or false negatives with Bot Management.\n\n### Allow mobile traffic\n\nOften, mobile application traffic will produce the same JA3 fingerprint across devices and users. This means you can identify your mobile application traffic by its JA3 fingerprint.\n\nUse the JA3 fingerprint to [allow traffic](https://developers.cloudflare.com/waf/custom-rules/use-cases/challenge-bad-bots/#adjust-for-mobile-traffic) from your mobile application, but block or challenge remaining traffic.\n\n</page>\n\n<page>\n---\ntitle: JavaScript detections · Cloudflare bot solutions docs\nlastUpdated: 2025-05-09T16:23:54.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/javascript-detections/\n  md: https://developers.cloudflare.com/bots/additional-configurations/javascript-detections/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: robots.txt setting · Cloudflare bot solutions docs\ndescription: Protect your website or application from AI crawlers by\n  implementing a robots.txt file on your domain to direct AI bot operators on\n  what content they can and cannot scrape for AI model training.\nlastUpdated: 2025-09-30T15:37:49.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/bots/additional-configurations/managed-robots-txt/\n  md: https://developers.cloudflare.com/bots/additional-configurations/managed-robots-txt/index.md\n---\n\nProtect your website or application from AI crawlers by implementing a `robots.txt` file on your domain to direct AI bot operators on what content they can and cannot scrape for AI model training.\n\nAI bots are expected to follow the `robots.txt` directives.\n\n`robots.txt` files express your preferences. They do not prevent crawler operators from crawling your content at a technical level. Some crawler operators may disregard your `robots.txt` preferences and crawl your content regardless of what your `robots.txt` file says.\n\nNote\n\nRespecting `robots.txt` is voluntary. If you want to prevent crawling, use AI Crawl Control's [manage AI crawlers](https://developers.cloudflare.com/ai-crawl-control/features/manage-ai-crawlers/) feature.\n\n## Compatibility with existing `robots.txt` files\n\nCloudflare will independently check whether your website has an existing `robots.txt` file and update the behavior of this feature based on your website.\n\n### Existing robots.txt file\n\nIf your website already has a `robots.txt` file — verified by a HTTP `200` response — Cloudflare will prepend our managed `robots.txt` before your existing `robots.txt`, combining both into a single response.\n\nFor example, without this feature enabled, the `robots.txt` content of `crawlstop.com` would be:",
      "language": "unknown"
    },
    {
      "code": "With the managed `robots.txt` enabled, Cloudflare will prepend our managed content before your original content, resulting in what you can view at <https://www.crawlstop.com/robots.txt>.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Inbox view",
      "id": "inbox-view"
    },
    {
      "level": "h3",
      "text": "Machine Learning-based Discovery",
      "id": "machine-learning-based-discovery"
    },
    {
      "level": "h2",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Examine an endpoint's authentication details",
      "id": "examine-an-endpoint's-authentication-details"
    },
    {
      "level": "h3",
      "text": "Stop unauthenticated traffic with Cloudflare",
      "id": "stop-unauthenticated-traffic-with-cloudflare"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enumeration",
      "id": "enumeration"
    },
    {
      "level": "h2",
      "text": "Parameter pollution",
      "id": "parameter-pollution"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Security Overview",
      "id": "security-overview"
    },
    {
      "level": "h3",
      "text": "Security Analytics",
      "id": "security-analytics"
    },
    {
      "level": "h3",
      "text": "Endpoint details",
      "id": "endpoint-details"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Add a token validation configuration",
      "id": "add-a-token-validation-configuration"
    },
    {
      "level": "h3",
      "text": "Add a JWT validation rule",
      "id": "add-a-jwt-validation-rule"
    },
    {
      "level": "h2",
      "text": "Special cases",
      "id": "special-cases"
    },
    {
      "level": "h3",
      "text": "Validate two JWTs with different identity providers on a single request",
      "id": "validate-two-jwts-with-different-identity-providers-on-a-single-request"
    },
    {
      "level": "h3",
      "text": "Support a migration from one identity provider to another",
      "id": "support-a-migration-from-one-identity-provider-to-another"
    },
    {
      "level": "h3",
      "text": "JSON Web Tokens with the `Bearer` prefix",
      "id": "json-web-tokens-with-the-`bearer`-prefix"
    },
    {
      "level": "h3",
      "text": "Rate limit by user (JWT claim)",
      "id": "rate-limit-by-user-(jwt-claim)"
    },
    {
      "level": "h3",
      "text": "Rate limit by user tier",
      "id": "rate-limit-by-user-tier"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Add validation by uploading a schema",
      "id": "add-validation-by-uploading-a-schema"
    },
    {
      "level": "h3",
      "text": "Add validation by applying a learned schema to a single endpoint",
      "id": "add-validation-by-applying-a-learned-schema-to-a-single-endpoint"
    },
    {
      "level": "h3",
      "text": "Add validation by applying a learned schema to an entire hostname",
      "id": "add-validation-by-applying-a-learned-schema-to-an-entire-hostname"
    },
    {
      "level": "h3",
      "text": "Add validation by adding a fallthrough rule",
      "id": "add-validation-by-adding-a-fallthrough-rule"
    },
    {
      "level": "h3",
      "text": "Change the action of an entire schema",
      "id": "change-the-action-of-an-entire-schema"
    },
    {
      "level": "h3",
      "text": "Change the global default action of Schema validation",
      "id": "change-the-global-default-action-of-schema-validation"
    },
    {
      "level": "h3",
      "text": "Change the action of a single endpoint",
      "id": "change-the-action-of-a-single-endpoint"
    },
    {
      "level": "h3",
      "text": "Disable Schema validation without changing actions",
      "id": "disable-schema-validation-without-changing-actions"
    },
    {
      "level": "h3",
      "text": "View active schemas",
      "id": "view-active-schemas"
    },
    {
      "level": "h3",
      "text": "Delete active schemas",
      "id": "delete-active-schemas"
    },
    {
      "level": "h2",
      "text": "Specifications",
      "id": "specifications"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Required fields",
      "id": "required-fields"
    },
    {
      "level": "h3",
      "text": "Notes on validated and supported fields",
      "id": "notes-on-validated-and-supported-fields"
    },
    {
      "level": "h2",
      "text": "Body inspection",
      "id": "body-inspection"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "`OneOf` constraint error schema violation in the Security Events",
      "id": "`oneof`-constraint-error-schema-violation-in-the-security-events"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Sequence building",
      "id": "sequence-building"
    },
    {
      "level": "h3",
      "text": "Sequence scoring",
      "id": "sequence-scoring"
    },
    {
      "level": "h3",
      "text": "Secure your API",
      "id": "secure-your-api"
    },
    {
      "level": "h3",
      "text": "Repeated sequences",
      "id": "repeated-sequences"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Endpoint Management",
      "id": "endpoint-management"
    },
    {
      "level": "h3",
      "text": "Session Identifiers",
      "id": "session-identifiers"
    },
    {
      "level": "h3",
      "text": "Request limitations",
      "id": "request-limitations"
    },
    {
      "level": "h3",
      "text": "Time limitations",
      "id": "time-limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Process",
      "id": "process"
    },
    {
      "level": "h3",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h3",
      "text": "Rate limiting recommendation calculation",
      "id": "rate-limiting-recommendation-calculation"
    },
    {
      "level": "h3",
      "text": "Create rate limits",
      "id": "create-rate-limits"
    },
    {
      "level": "h2",
      "text": "API",
      "id": "api"
    },
    {
      "level": "h2",
      "text": "Special cases",
      "id": "special-cases"
    },
    {
      "level": "h3",
      "text": "Rate limit by user (JWT claim)",
      "id": "rate-limit-by-user-(jwt-claim)"
    },
    {
      "level": "h3",
      "text": "Rate limit by user tier",
      "id": "rate-limit-by-user-tier"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Compatible plugins",
      "id": "compatible-plugins"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Plan type",
      "id": "plan-type"
    },
    {
      "level": "h3",
      "text": "Plugin compatibility",
      "id": "plugin-compatibility"
    },
    {
      "level": "h3",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Purchase APO",
      "id": "purchase-apo"
    },
    {
      "level": "h2",
      "text": "Install and activate the Cloudflare WordPress plugin",
      "id": "install-and-activate-the-cloudflare-wordpress-plugin"
    },
    {
      "level": "h2",
      "text": "Activate APO",
      "id": "activate-apo"
    },
    {
      "level": "h2",
      "text": "Create the API token from Cloudflare",
      "id": "create-the-api-token-from-cloudflare"
    },
    {
      "level": "h2",
      "text": "Add your API token to WordPress",
      "id": "add-your-api-token-to-wordpress"
    },
    {
      "level": "h2",
      "text": "Lookup domain name registration",
      "id": "lookup-domain-name-registration"
    },
    {
      "level": "h2",
      "text": "Update your nameserver with your domain registrar",
      "id": "update-your-nameserver-with-your-domain-registrar"
    },
    {
      "level": "h2",
      "text": "Verify the APO integration and WordPress integration work",
      "id": "verify-the-apo-integration-and-wordpress-integration-work"
    },
    {
      "level": "h2",
      "text": "Cookies prefixes that always bypass cache",
      "id": "cookies-prefixes-that-always-bypass-cache"
    },
    {
      "level": "h2",
      "text": "Run APO on a subdomain",
      "id": "run-apo-on-a-subdomain"
    },
    {
      "level": "h2",
      "text": "Run APO on a subdirectory",
      "id": "run-apo-on-a-subdirectory"
    },
    {
      "level": "h2",
      "text": "Run APO only on a subdirectory",
      "id": "run-apo-only-on-a-subdirectory"
    },
    {
      "level": "h3",
      "text": "Use the `cf-edge-cache` response header",
      "id": "use-the-`cf-edge-cache`-response-header"
    },
    {
      "level": "h3",
      "text": "Use Cache Rules",
      "id": "use-cache-rules"
    },
    {
      "level": "h2",
      "text": "Do I still need to create \"Edge Cache TTL\" page rules with \"Cache Level: Cache Everything\"?",
      "id": "do-i-still-need-to-create-\"edge-cache-ttl\"-page-rules-with-\"cache-level:-cache-everything\"?"
    },
    {
      "level": "h2",
      "text": "Does Origin Cache Control override APO?",
      "id": "does-origin-cache-control-override-apo?"
    },
    {
      "level": "h2",
      "text": "Why are my browser cache control headers missing with APO?",
      "id": "why-are-my-browser-cache-control-headers-missing-with-apo?"
    },
    {
      "level": "h2",
      "text": "Is the stale-if-error directive still needed with APO?",
      "id": "is-the-stale-if-error-directive-still-needed-with-apo?"
    },
    {
      "level": "h2",
      "text": "When I check the posts and homepage cache status, the response header shows `cf-cache-status: BYPASS`. Is APO working?",
      "id": "when-i-check-the-posts-and-homepage-cache-status,-the-response-header-shows-`cf-cache-status:-bypass`.-is-apo-working?"
    },
    {
      "level": "h2",
      "text": "When I check `cf-cache-status` via cURL, `MISS` and `DYNAMIC` are always returned. In my browser, I see `HIT` but other tools return `DYNAMIC`. Is this expected behavior?",
      "id": "when-i-check-`cf-cache-status`-via-curl,-`miss`-and-`dynamic`-are-always-returned.-in-my-browser,-i-see-`hit`-but-other-tools-return-`dynamic`.-is-this-expected-behavior?"
    },
    {
      "level": "h2",
      "text": "Are Google Fonts optimized when APO is activated?",
      "id": "are-google-fonts-optimized-when-apo-is-activated?"
    },
    {
      "level": "h2",
      "text": "Can I customize query string caching with APO?",
      "id": "can-i-customize-query-string-caching-with-apo?"
    },
    {
      "level": "h2",
      "text": "Why are my font URLs not being transformed?",
      "id": "why-are-my-font-urls-not-being-transformed?"
    },
    {
      "level": "h2",
      "text": "Why do I see Worker subrequests in my zone logs when using APO?",
      "id": "why-do-i-see-worker-subrequests-in-my-zone-logs-when-using-apo?"
    },
    {
      "level": "h2",
      "text": "For the APO plugin why do I see: This plugin hasn’t been tested with the latest 3 major releases of WordPress. It may no longer be maintained or supported and may have compatibility issues when used with more recent versions of WordPress.",
      "id": "for-the-apo-plugin-why-do-i-see:-this-plugin-hasn’t-been-tested-with-the-latest-3-major-releases-of-wordpress.-it-may-no-longer-be-maintained-or-supported-and-may-have-compatibility-issues-when-used-with-more-recent-versions-of-wordpress."
    },
    {
      "level": "h2",
      "text": "Detection tags",
      "id": "detection-tags"
    },
    {
      "level": "h2",
      "text": "Create or edit an expression",
      "id": "create-or-edit-an-expression"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "Block requests that match a specific detection ID",
      "id": "block-requests-that-match-a-specific-detection-id"
    },
    {
      "level": "h3",
      "text": "Run Bot Management without specific detection IDs",
      "id": "run-bot-management-without-specific-detection-ids"
    },
    {
      "level": "h2",
      "text": "Bot Detection IDs via Logpush",
      "id": "bot-detection-ids-via-logpush"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Analytics",
      "id": "analytics"
    },
    {
      "level": "h2",
      "text": "Actions",
      "id": "actions"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "Block or allow certain traffic",
      "id": "block-or-allow-certain-traffic"
    },
    {
      "level": "h3",
      "text": "Allow mobile traffic",
      "id": "allow-mobile-traffic"
    },
    {
      "level": "h2",
      "text": "Compatibility with existing `robots.txt` files",
      "id": "compatibility-with-existing-`robots.txt`-files"
    },
    {
      "level": "h3",
      "text": "Existing robots.txt file",
      "id": "existing-robots.txt-file"
    }
  ],
  "url": "llms-txt#with-jwt-validation,-we-can-also-refine-session-identifiers-to-use-claims-from-the-jwt",
  "links": []
}