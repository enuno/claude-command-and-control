{
  "title": "Test orders service requests",
  "content": "curl https://api-gateway.workers.dev/api/orders\nbash\nnpx wrangler vpc service create s3-storage \\\n  --type http \\\n  --tunnel-id <YOUR_TUNNEL_ID> \\\n  --hostname s3.us-west-2.amazonaws.com\nbash\nnpx wrangler vpc service create s3-storage \\\n  --type http \\\n  --tunnel-id <YOUR_TUNNEL_ID> \\\n  --ipv4 10.0.1.60 \\\n  --http-port 9000\njson\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowAnonymousAccessFromVPCE\",\n      \"Effect\": \"Allow\",\n      \"Principal\": \"*\",\n      \"Action\": [\"s3:GetObject\", \"s3:ListBucket\"],\n      \"Resource\": [\n        \"arn:aws:s3:::your-bucket-name\",\n        \"arn:aws:s3:::your-bucket-name/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:sourceVpce\": \"vpce-your-endpoint-id\"\n        }\n      }\n    }\n  ]\n}\nbash",
  "code_samples": [
    {
      "code": "## Next steps\n\n* Add [authentication and authorization](https://developers.cloudflare.com/workers/examples/auth-with-headers/)\n* Implement [rate limiting](https://developers.cloudflare.com/durable-objects/api/)\n* Set up [monitoring and alerting](https://developers.cloudflare.com/analytics/analytics-engine/)\n* Explore [other examples](https://developers.cloudflare.com/workers-vpc/examples/)\n\n</page>\n\n<page>\n---\ntitle: Access a private S3 bucket Â· Cloudflare Workers VPC\ndescription: This example demonstrates how to access a private S3 bucket that is\n  not exposed to the public internet. In this guide, we will configure a Workers\n  VPC Service for an internal S3-compatible storage service, create a Worker\n  that makes requests to that bucket, and deploy the Worker to validate our\n  changes.\nlastUpdated: 2025-11-04T21:03:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/workers-vpc/examples/private-s3-bucket/\n  md: https://developers.cloudflare.com/workers-vpc/examples/private-s3-bucket/index.md\n---\n\nThis example demonstrates how to access a private S3 bucket that is not exposed to the public internet. In this guide, we will configure a Workers VPC Service for an internal S3-compatible storage service, create a Worker that makes requests to that bucket, and deploy the Worker to validate our changes.\n\n## Prerequisites\n\n* A private S3-compatible storage service running in your VPC/virtual network (such as AWS S3 VPC endpoint, MinIO, or similar)\n* A virtual machine/EC2 instance running in the same VPC as your S3 VPC endpoint\n* Workers account with Workers VPC access\n\n## 1. Set up Cloudflare Tunnel\n\nA Cloudflare Tunnel creates a secure connection from your private network to Cloudflare. This tunnel will allow Workers to securely access your private resources.\n\n1. Navigate to the [Workers VPC dashboard](https://dash.cloudflare.com/?to=/:account/workers/vpc/tunnels) and select the **Tunnels** tab.\n\n2. Select **Create** to create a new tunnel.\n\n3. Enter a name for your tunnel (for example, `s3-tunnel`) and select **Save tunnel**.\n\n4. Choose your operating system and architecture. The dashboard will provide specific installation instructions for your environment.\n\n5. Follow the provided commands to download and install `cloudflared` on your VM, and execute the service installation command with your unique token.\n\nThe dashboard will confirm when your tunnel is successfully connected. Note the tunnel ID for the next step.\n\n## 2. Create the Workers VPC Service\n\nFirst, create a Workers VPC Service for your internal S3 storage:",
      "language": "unknown"
    },
    {
      "code": "You can also create a Workers VPC Service using an IP address (for example, if using MinIO):",
      "language": "unknown"
    },
    {
      "code": "Note the service ID returned for the next step.\n\n## 3. Configure S3 bucket policy\n\nConfigure your S3 bucket to allow anonymous access from your VPC endpoint. This works for unencrypted S3 objects:",
      "language": "unknown"
    },
    {
      "code": "### Testing S3 access directly\n\nYou can test S3 access directly from the VM where your Cloudflare Tunnel is running to verify the bucket policy is working correctly. These commands should work without any AWS credentials:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Set up Cloudflare Tunnel",
      "id": "1.-set-up-cloudflare-tunnel"
    },
    {
      "level": "h2",
      "text": "2. Create the Workers VPC Service",
      "id": "2.-create-the-workers-vpc-service"
    },
    {
      "level": "h2",
      "text": "3. Configure S3 bucket policy",
      "id": "3.-configure-s3-bucket-policy"
    },
    {
      "level": "h3",
      "text": "Testing S3 access directly",
      "id": "testing-s3-access-directly"
    }
  ],
  "url": "llms-txt#test-orders-service-requests",
  "links": []
}