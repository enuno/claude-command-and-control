{
  "title": "JSON object",
  "content": "This page contains an example of the DNS protection rule JSON object used in the API.\n\nThe `scope` field value must be one of `global`, `region`, or `datacenter`. You must provide a region code (or data center code) in the `name` field when specifying a `region` (or `datacenter`) scope.\n\nThe `mode` value must be one of `enabled`, `disabled`, or `monitoring`.\n\nThe `profile_sensitivity` field value must be one of `low` (default), `medium`, `high`, or `very_high`.\n\nThe `rate_sensitivity` and `burst_sensitivity` field values must be one of `low`, `medium`, or `high`.\n\nFor more information on the rule settings, refer to [Rule settings](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#rule-settings).\n\n<page>\n---\ntitle: Advanced TCP Protection API - JSON objects · Cloudflare DDoS Protection docs\ndescription: This page contains an example of the TCP protection rule JSON\n  object used in the API.\nlastUpdated: 2025-02-12T17:05:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/index.md\n---\n\nThis page contains an example of the TCP protection rule JSON object used in the API.\n\n## Prefix in allowlist\n\nThe `prefix` field can contain an IP address or a CIDR range.\n\n## SYN flood rule or out-of-state TCP rule\n\nThe `scope` field value must be one of `global`, `region`, or `datacenter`. You must provide a region code (or data center code) in the `name` field when specifying a `region` (or `datacenter`) scope.\n\nThe `rate_sensitivity` and `burst_sensitivity` field values must be one of `low`, `medium`, or `high`.\n\nThe `expression` field is a [Rules language expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/) up to 8,192 characters that can include the following fields:\n\n* `ip.src`\n* `ip.dst`\n* `tcp.srcport`\n* `tcp.dstport`\n\nExpressions of SYN flood protection and out-of-state TCP protection filters do not currently support functions.\n\nThe `mode` value must be one of `enabled`, `disabled`, or `monitoring`.\n\n<page>\n---\ntitle: Common API calls · Cloudflare DDoS Protection docs\ndescription: The following sections contain example requests for common API\n  calls. For a list of available API endpoints, refer to Endpoints.\nlastUpdated: 2024-11-04T15:20:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/examples/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/examples/index.md\n---\n\nThe following sections contain example requests for common API calls. For a list of available API endpoints, refer to [Endpoints](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/#endpoints).\n\n## Get Advanced TCP Protection status\n\nThis example obtains the current status of Advanced TCP Protection (enabled or disabled).\n\n## Enable Advanced TCP Protection\n\nThis example enables Advanced TCP Protection.\n\n## Get existing prefixes\n\nThis example fetches all existing prefixes in Advanced TCP Protection.\n\nThis example `POST` request adds two prefixes. The second prefix excludes a subset of the first prefix from Advanced TCP Protection.\n\n## Get all prefixes in allowlist\n\nThis example fetches all the prefixes in the allowlist.\n\n## Add a prefix to the allowlist\n\nThis example `POST` request adds a prefix to the allowlist of the account.\n\n## Create a SYN flood rule\n\nThis example `POST` request creates a SYN flood rule with a regional scope (Western Europe) in monitoring mode.\n\nRefer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/) for more information on the fields in the JSON body.\n\n## Create an out-of-state TCP rule\n\nThis example `POST` request creates an out-of-state TCP rule in monitoring mode, with a regional scope, and with low rate and burst sensitivities.\n\nRefer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/) for more information on the fields in the JSON body.\n\n## Create a SYN flood filter\n\nThis example `POST` request creates a SYN flood [filter](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#filter), setting SYN flood protection to monitoring mode for a specific range of destination IP addresses.\n\nRefer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/) for more information on the fields in the JSON body.\n\n## Create an out-of-state TCP filter\n\nThis example `POST` request creates an out-of-state TCP [filter](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/concepts/#filter), disabling out-of-state TCP protection for a specific range of destination IP addresses and ports.\n\nRefer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/tcp-protection/json-objects/) for more information on the fields in the JSON body.\n\n<page>\n---\ntitle: Configure HTTP DDoS Attack Protection via API · Cloudflare DDoS Protection docs\ndescription: Configure the HTTP DDoS Attack Protection managed ruleset by\n  defining overrides using the Rulesets API.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-api/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-api/index.md\n---\n\nConfigure the HTTP DDoS Attack Protection managed ruleset by defining overrides using the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\nEach zone has the HTTP DDoS Attack Protection managed ruleset enabled by default. This means that you do not need to deploy the managed ruleset to the `ddos_l7` phase ruleset explicitly. You only have to create a rule in the phase ruleset to deploy the managed ruleset if you need to configure overrides.\n\nIf you are using Terraform, refer to [DDoS managed rulesets configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/ddos-managed-rulesets/#example-configure-http-ddos-attack-protection).\n\n## Configure an override for the HTTP DDoS Attack Protection managed ruleset\n\nUse overrides to configure the HTTP DDoS Attack Protection managed ruleset. Overrides allow you to define a different action or sensitivity level from the default values. For more information on the available action and sensitivity level values, refer to [Ruleset parameters](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/).\n\nOverrides can have a ruleset, tag, or rule scope. Tag and rule configurations have greater priority than ruleset configurations.\n\nYou can create overrides at the zone level and at the account level. Account-level overrides allow you to apply the same override to several zones in your account with a single rule. For example, you can use an account-level override to lower the sensitivity of a specific managed ruleset rule or exclude an [IP list](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists) for multiple zones. However, if a given zone has overrides for the HTTP DDoS Attack Protection managed ruleset, the account-level overrides will not be evaluated for that zone.\n\n* The HTTP DDoS Attack Protection managed ruleset is always enabled — you cannot disable its rules using an override with `\"enabled\": false`.\n\n* The managed ruleset includes some read-only rules that you cannot override.\n\n* If you configure both account-level and zone-level overrides, only the zone-level overrides (the most specific ones) will be evaluated.\n\n* Currently, account-level overrides for the HTTP DDoS Attack Protection managed ruleset are only available via API.\n\n### Creating multiple rules\n\nOnly available to Enterprise customers with the Advanced DDoS Protection subscription, which can create up to 10 rules.\n\nCreate multiple rules in the `ddos_l7` phase entry point ruleset to define different overrides for different sets of incoming requests. Set each rule expression according to the traffic whose HTTP DDoS protection you wish to customize.\n\nRules in the phase entry point ruleset, where you create overrides, are evaluated in order until there is a match for a rule expression and sensitivity level, and Cloudflare will apply the first rule that matches the request. Therefore, the rule order in the entry point ruleset is very important.\n\n### Zone-level configuration example\n\nThe following `PUT` example creates a new phase ruleset (or updates the existing one) for the `ddos_l7` phase at the zone level. The request includes several overrides to adjust the default behavior of the HTTP DDoS Attack Protection managed ruleset. These overrides are the following:\n\n* All rules of the managed ruleset will use the `managed_challenge` action and have a sensitivity level of `medium`.\n* All rules tagged with `<TAG_NAME>` will have a sensitivity level of `low`.\n* The rule with ID `<MANAGED_RULESET_RULE_ID>` will use the `block` action.\n\nThe response returns the created (or updated) phase entry point ruleset.\n\nFor more information on defining overrides for managed rulesets using the Rulesets API, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) in the Ruleset Engine documentation.\n\n### Account-level configuration example\n\nThe following `PUT` example creates a new phase ruleset (or updates the existing one) for the `ddos_l7` phase at the account level. The example defines a single rule override for requests coming from IP addresses in the `allowlisted_ips` [IP list](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists), with the following configuration:\n\n* The rule with ID `<MANAGED_RULESET_RULE_ID>`, belonging to the HTTP DDoS Attack Protection managed ruleset (with ID `<MANAGED_RULESET_ID>`), will have an `eoff` (*Essentially Off*) sensitivity level and it will perform a `log` action.\n\nCustom rule expressions (different from `\"true\"`) and the `log` action require an Enterprise plan with the Advanced DDoS Protection subscription.\n\nThe response returns the created (or updated) phase entry point ruleset.\n\nFor more information on defining overrides for managed rulesets using the Rulesets API, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) in the Ruleset Engine documentation.\n\n<page>\n---\ntitle: Configure HTTP DDoS Attack Protection in the dashboard · Cloudflare DDoS\n  Protection docs\ndescription: Configure the HTTP DDoS Attack Protection managed ruleset by\n  defining overrides in the Cloudflare dashboard. DDoS overrides allow you to\n  customize the action and sensitivity of one or more rules in the managed\n  ruleset.\nlastUpdated: 2025-10-27T21:51:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-dashboard/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/configure-dashboard/index.md\n---\n\nConfigure the HTTP DDoS Attack Protection managed ruleset by defining [overrides](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) in the Cloudflare dashboard. DDoS overrides allow you to customize the **action** and **sensitivity** of one or more rules in the managed ruleset.\n\nFor more information on the available parameters and allowed values, refer to [Ruleset parameters](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/).\n\nNumber of available overrides\n\nIf you are an Enterprise customer with the Advanced DDoS Protection subscription, you can define up to 10 overrides. These overrides can have a custom expression so that the override only applies to a subset of incoming requests. If you do not have the Advanced DDoS Protection subscription, you can only deploy one override which will always apply to all incoming requests.\n\nIf you cannot deploy any additional overrides, consider editing an existing override to adjust rule configuration.\n\nCreate multiple rules in the `ddos_l7` phase entry point ruleset to define different overrides for different sets of incoming requests. Set each rule expression according to the traffic whose HTTP DDoS protection you wish to customize.\n\nRules in the phase entry point ruleset, where you create overrides, are evaluated in order until there is a match for a rule expression and sensitivity level, and Cloudflare will apply the first rule that matches the request. Therefore, the rule order in the entry point ruleset is very important.\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and website.\n  2. Go to **Security** > **DDoS**.\n  3. Next to **HTTP DDoS attack protection**, select **Deploy a DDoS override**.\n\n1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n[Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n2. Go to the **DDoS protection** tab.\n\n3. On **HTTP DDoS attack protection**, select **Create override**.\n\n### Create a DDoS override\n\n1. Enter a descriptive name for the override in **Override name**.\n\n2. If you are an Enterprise customer with the Advanced DDoS Protection subscription:\n\n1. Under **Override scope**, review the scope of the override — by default, all incoming requests for the current zone.\n   2. If necessary, select **Edit scope** and configure the [custom filter expression](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/override-expressions/) that will determine the override scope.\n\n3. Depending on what you wish to override, refer to the following sections (you can perform both configurations on the same override):\n\nConfigure all the rules in the ruleset (ruleset override)\n\n1. To always apply a given action for all the rules in the ruleset, select an action in **Ruleset action**.\n   2. To set the sensitivity level for all the rules in the ruleset, select a value in **Ruleset sensitivity**.\n\nConfigure one or more rules\n\n1. Under **Rule configuration**, select **Browse rules**.\n   2. Search for the rules you wish to configure using the available filters. You can search by [tag](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/rule-categories/) (also known as category).\n   3. To configure a single rule, select the desired value for a field in the displayed dropdowns next to the rule. To configure more than one rule, select the rules using the row checkboxes and update the fields for the selected rules using the dropdowns displayed before the table. You can also configure all the rules with a given tag. For more information, refer to [Configure rules in bulk in a managed ruleset](https://developers.cloudflare.com/waf/managed-rules/deploy-zone-dashboard/#configure-rules-in-bulk-in-a-managed-ruleset).\n   4. Select **Next**.\n\n* Tag and rule overrides have priority over ruleset overrides.\n\n* The managed ruleset includes some read-only rules that you cannot override.\n\n### Delete a DDoS override\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account and domain.\n  2. Go to **Security** > **DDoS**.\n  3. Next to the DDoS override you wish to delete, select **Delete**.\n  4. Select **Delete** to confirm the operation.\n\n1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n[Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n2. Go to the **DDoS protection** tab.\n\n3. Select the override.\n\n4. Select **Delete deployment**.\n\n<page>\n---\ntitle: Configure using Terraform · Cloudflare DDoS Protection docs\nlastUpdated: 2025-06-30T19:31:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/link-configure-terraform/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/link-configure-terraform/index.md\n---\n\n<page>\n---\ntitle: Override examples for HTTP DDoS Attack Protection · Cloudflare DDoS\n  Protection docs\ndescription: The following scenarios detail how you can make use of override\n  rules as a solution to common HTTP DDoS Protection issues.\nlastUpdated: 2025-12-23T20:53:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/override-examples/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/override-examples/index.md\n---\n\nThe following scenarios detail how you can make use of override rules as a solution to common HTTP DDoS Protection issues.\n\n### Traffic from your mobile application is blocked by a DDoS Managed Rule\n\nThe traffic from your mobile application may have appeared suspicious, causing a DDoS Managed Rule to block it.\n\nYou should identify the Managed Rule blocking the traffic and change the sensitivity level to `Medium`. If traffic continues to be blocked by the managed rule, set the sensitivity level to `Low` or `Essentially off`.\n\nIf you have access to filter expressions, you can create an override to target the specific affected traffic.\n\n### Traffic is flagged by an adaptive rule based on the location and may be an attack\n\nIf you recognize that the traffic flagged by an adaptive rule may be considered an attack, you can create an override rule to enable the adaptive rule in mitigation mode to `challenge` (if it is browser traffic) or `block` (for other suspicious traffic).\n\n### Legitimate traffic is incorrectly identified as an attack and causes a false positive\n\nA false positive is an incorrect identification. In the case of DDoS protection, there is a false positive when legitimate traffic is mistakenly classified as attack traffic. This can occur when legacy applications, Internet services, or faulty client applications generate legitimate traffic that appears suspicious, has odd traffic patterns, deviates from best practices, or violates protocols.\n\nIn these cases, Cloudflare's DDoS Protection systems may flag that traffic as malicious and apply mitigation actions. If the traffic is in fact legitimate and not part of an attack, the mitigation actions can cause service disruptions and outages to your Internet properties.\n\nTo remedy a false positive:\n\n1. In the Cloudflare dashboard, go to the Network analytics page.\n\n[Go to **Network analytics**](https://dash.cloudflare.com/?to=/:account/network-analytics)\n\n2. Apply filters to the displayed data.\n\nFor WAF/CDN customers\n\n1. Select the zone that is experiencing DDoS attack false positives.\n  2. Go to **Security** > **Events**.\n  3. Select **Add filter** and filter by `Service equals HTTP DDoS`.\n\nFor Magic Transit and Spectrum customers\n\n1. Go to Account Home > **Analytics & Logs** > **Network Analytics**.\n  2. Identify the legitimate traffic that is causing the false positives. Use the Attack ID number included in the DDoS alert (if you received one), or apply dashboard filters such as destination IP address and port.\n\n1) Scroll down to **Top events by source** > **HTTP DDoS rules**.\n  2) Copy the rule name.\n  3) Go to your zone > **Security** > **DDoS** and select **Deploy a DDoS override**. If you cannot deploy any additional overrides, edit an existing override to adjust rule configuration.\n  4) Select **Browse rules** and paste the rule name in the search field.\n  5) Decrease the rule's **Sensitivity Level** to *Essentially Off* or change the rule action to *Log* (if supported by your current plan and subscriptions).\n  6) Select **Next** and then select **Save**.\n\n1. In the Cloudflare dashboard, go to the Network analytics page.\n\n[Go to **Network analytics**](https://dash.cloudflare.com/?to=/:account/network-analytics)\n\n2. Apply filters to the displayed data.\n\nFor WAF/CDN customers\n\n1. Select the zone that is experiencing DDoS attack false positives.\n  2. Go to **Security** > **Analytics** > **Events** tab.\n  3. Select **Add filter** and filter by `Service equals HTTP DDoS`.\n\nFor Magic Transit and Spectrum customers\n\n1. Go to Account Home > **Analytics & Logs** > **Network Analytics**.\n  2. Identify the legitimate traffic that is causing the false positives. Use the Attack ID number included in the DDoS alert (if you received one), or apply dashboard filters such as destination IP address and port.\n\n1) Scroll down to **Top events by source** > **HTTP DDoS rules**.\n  2) Copy the rule name.\n  3) Go to your zone > **Security** > **Security rules** > **DDoS protection** tab and select **Create override**. If you cannot deploy any additional overrides, edit an existing override to adjust rule configuration.\n  4) Select **Browse rules** and paste the rule name in the search field.\n  5) Decrease the rule's **Sensitivity Level** to *Essentially Off* or change the rule action to *Log* (if supported by your current plan and subscriptions).\n  6) Select **Next** and then select **Save**.\n\nOnce saved, the rule takes effect within one or two minutes. The rule adjustment should provide immediate remedy, which you can view in the [analytics dashboard](https://developers.cloudflare.com/ddos-protection/reference/analytics/).\n\n#### Update the adjusted rules later\n\nLater, you can change the [sensitivity level](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/#sensitivity-level) of the rule causing the false positives to avoid future issues, and change the rule action back to its default value.\n\nRecommendation: Enable DDoS alerts\n\nCloudflare recommends that you create notifications for [DDoS alerts](https://developers.cloudflare.com/ddos-protection/reference/alerts/) to get real-time notifications on detected and mitigated attacks automatically performed by Cloudflare's systems. When you receive these notifications, you can review if it is in fact a real DDoS attack, or if it is a false positive, and then take action to remedy it.\n\n#### Avoid false positives while retaining protection and visibility\n\nTo see what DDoS Managed Rules do in a high sensitivity level while remaining protected by blocking attacks at a low sensitivity level, Advanced DDoS protection customers can [create a first override](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-dashboard/#create-a-ddos-override) that blocks attacks at a low sensitivity and a second override to log at a high sensitivity.\n\nThe overrides must be set in that order. Otherwise, it will not work. This is because overrides are evaluated in order and will stop at the first override that matches both expression and sensitivity. Setting the overrides in the wrong order would cause the `Log` override at a high sensitivity to match all instances. As a result, Cloudflare will never evaluate the `Block` override that would be placed behind it, causing all rules to be set in `Log` mode.\n\nIf an override without an expression matches, Cloudflare will not evaluate the expressions that follow it.\n\n### An attack is incorrectly identified as legitimate traffic and causes a false negative\n\nA false negative is a lack of identification. In the case of DDoS protection, there is a false negative when attack traffic is mistakenly classified as legitimate traffic and is not mitigated. This can occur when the attack traffic is not sufficiently high to trigger mitigation actions or if there are no rules matching the attack.\n\nTo address a false negative:\n\n* If you are a WAF/CDN customer, follow the steps in the [Proactive DDoS defense](https://developers.cloudflare.com/ddos-protection/best-practices/proactive-defense/) page, which guides you on enabling the *Under Attack* mode and creating rate limiting rules and WAF custom rules as needed.\n* If you are a Magic Transit customer, [use Magic Firewall rules](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/) to help mitigate the attack.\n\n### Incomplete mitigations\n\nAn incomplete mitigation is a case when the DDoS protection systems have applied mitigation, but not all the attack was mitigated. This can happen when Cloudflare's systems apply a mitigation action that is less strict than what the attack requires.\n\nThe system chooses the mitigation action based on the logic and the DDoS protection system's confidence that the traffic is indeed part of an attack:\n\n* For high-confidence rules, the system will apply a strict mitigation action such as the *Block* action.\n* For low-confidence rules, the system will apply a less strict mitigation rule such as *Challenge* or *Force Connection Close*.\n\nIf you are experiencing a DDoS attack detected by Cloudflare and the applied mitigation action is not sufficiently strict, change the rule action to *Block*:\n\n1. In the Cloudflare dashboard, go to the Network analytics page. [Go to **Network analytics**](https://dash.cloudflare.com/?to=/:account/network-analytics)\n  2. Apply filters to the displayed data.\n\nFor WAF/CDN customers\n\n1. Select the zone that is experiencing an incomplete mitigation of a DDoS attack.\n  2. Go to **Security** > **Events**.\n  3. Select **Add filter** and filter by `Service equals HTTP DDoS`.\n\nFor Magic Transit and Spectrum customers\n\n1. Go to Account Home > **Analytics & Logs** > **Network Analytics**.\n  2. Identify the DDoS attack that is having incomplete mitigations. Use the Attack ID number included in the DDoS alert (if you received one), or apply dashboard filters such as destination IP address and port.\n\n1) Scroll down to **Top events by source** > **HTTP DDoS rules**.\n  2) Copy the rule name.\n  3) Go to your zone > **Security** > **DDoS** and select **Deploy a DDoS override**. If you cannot deploy any additional overrides, edit an existing override to adjust rule configuration.\n  4) Select **Browse rules** and paste the rule name in the search field.\n  5) Change the rule's **Action** to *Block*.\n  6) Select **Next** and then select **Save**.\n\n1. In the Cloudflare dashboard, go to the Network analytics page. [Go to **Network analytics**](https://dash.cloudflare.com/?to=/:account/network-analytics)\n  2. Apply filters to the displayed data.\n\nFor WAF/CDN customers\n\n1. Select the zone that is experiencing an incomplete mitigation of a DDoS attack.\n  2. Go to **Security** > **Analytics** > **Events** tab.\n  3. Select **Add filter** and filter by `Service equals HTTP DDoS`.\n\nFor Magic Transit and Spectrum customers\n\n1. Go to Account Home > **Analytics & Logs** > **Network Analytics**.\n  2. Identify the DDoS attack that is having incomplete mitigations. Use the Attack ID number included in the DDoS alert (if you received one), or apply dashboard filters such as destination IP address and port.\n\n1) Scroll down to **Top events by source** > **HTTP DDoS rules**.\n  2) Copy the rule name.\n  3) Go to your zone > **Security** > **Security rules** > **DDoS protection** tab and select **Create override**. If you cannot deploy any additional overrides, edit an existing override to adjust rule configuration.\n  4) Select **Browse rules** and paste the rule name in the search field.\n  5) Change the rule's **Action** to *Block*.\n  6) Select **Next** and then select **Save**.\n\nOnce saved, the rule takes effect within one or two minutes. The rule adjustment should provide immediate remedy, which you can view in the [analytics dashboard](https://developers.cloudflare.com/ddos-protection/reference/analytics/).\n\n#### Alternate procedure\n\nIf you cannot stop an attack from overloading your origin web server using the above steps, [contact Cloudflare Support](https://developers.cloudflare.com/support/contacting-cloudflare-support/) for assistance, providing the following details:\n\n* Time period of the attack (UTC timestamp)\n* Domain/path being targeted (zone name/ID)\n* Attack frequency\n* Steps to reproduce the issue, with actual results versus expected results\n* Any relevant additional information such as site URLs, error messages, screenshots, or relevant logs from your origin web server\n\n<page>\n---\ntitle: Override expressions for HTTP DDoS Attack Protection · Cloudflare DDoS\n  Protection docs\ndescription: Set an override expression for the HTTP DDoS Attack Protection\n  managed ruleset to define a specific scope for sensitivity level or action\n  adjustments.\nlastUpdated: 2025-06-30T19:31:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/override-expressions/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/http-overrides/override-expressions/index.md\n---\n\nOnly available to Enterprise customers with the Advanced DDoS Protection subscription.\n\nSet an override expression for the HTTP DDoS Attack Protection managed ruleset to define a specific scope for [sensitivity level](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/#sensitivity-level) or [action](https://developers.cloudflare.com/ddos-protection/managed-rulesets/http/override-parameters/#action) adjustments.\n\nFor example, you can set different sensitivity levels for different request URI paths: a medium sensitivity level for URI path `A` and a low sensitivity level for URI path `B`.\n\n## Available expression fields\n\nYou can use the following fields in override expressions:\n\n* `cf.bot_management.ja3_hash`\n* `cf.bot_management.ja4`\n* `cf.client.bot`\n* `cf.threat_score`\n* `cf.tls_cipher`\n* `cf.tls_client_auth.cert_verified`\n* `cf.tls_version`\n* `cf.verified_bot_category`\n* `http.cookie`\n* `http.host`\n* `http.referer`\n* `http.request.headers`\n* `http.request.headers.names`\n* `http.request.headers.truncated`\n* `http.request.headers.values`\n* `http.request.uri`\n* `http.request.uri.path`\n* `http.request.uri.path.extension`\n* `http.request.uri.query`\n* `http.request.full_uri`\n* `http.request.method`\n* `http.request.version`\n* `http.request.cookies`\n* `http.user_agent`\n* `http.x_forwarded_for`\n* `ip.geoip.asnum`\n* `ip.geoip.continent`\n* `ip.geoip.country`\n* `ip.geoip.is_in_european_union`\n* `ip.src`\n* `ip.src.asnum`\n* `ip.src.continent`\n* `ip.src.country`\n* `ip.src.is_in_european_union`\n* `ssl`\n\nRefer to the [Fields reference](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/) in the Rules language documentation for more information.\n\n<page>\n---\ntitle: Configure Network-layer DDoS Attack Protection via API · Cloudflare DDoS\n  Protection docs\ndescription: Configure the Cloudflare Network-layer DDoS Attack Protection\n  managed ruleset by defining overrides at the account level using the Rulesets\n  API.\nlastUpdated: 2025-08-20T21:45:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-api/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-api/index.md\n---\n\nConfigure the Cloudflare Network-layer DDoS Attack Protection managed ruleset by defining overrides at the account level using the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/).\n\nEach account has the Network-layer DDoS Attack Protection managed ruleset enabled by default. This means that you do not need to deploy the managed ruleset to the `ddos_l4` phase entry point ruleset explicitly. You only have to create a rule in the phase entry point to deploy the managed ruleset if you need to configure overrides.\n\nIf you are using Terraform, refer to [DDoS managed rulesets configuration using Terraform](https://developers.cloudflare.com/terraform/additional-configurations/ddos-managed-rulesets/#example-configure-network-layer-ddos-attack-protection).\n\n## Configure an override for the Network-layer DDoS Attack Protection managed ruleset\n\nYou can define overrides at the ruleset, tag, and rule level for all managed rulesets.\n\nWhen configuring the Network-layer DDoS Attack Protection managed ruleset, use overrides to define a different **action** or **sensitivity** from the default values. For more information on these rule parameters and the allowed values, refer to [Managed ruleset parameters](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/).\n\n* The Network-layer DDoS Attack Protection managed ruleset is always enabled. You cannot disable its rules using an override with `\"enabled\": false`.\n\n* The managed ruleset includes some read-only rules that you cannot override.\n\n* You can only define overrides for the Network-layer DDoS Attack Protection managed ruleset at the account level.\n\nThe following `PUT` example creates a new phase ruleset (or updates the existing one) for the `ddos_l4` phase at the account level. The request includes several overrides to adjust the default behavior of the Network-layer DDoS Attack Protection managed ruleset. These overrides are the following:\n\n* All rules of the Network-layer DDoS Attack Protection managed ruleset will have their sensitivity set to `medium`.\n* All rules tagged with `<TAG_NAME>` will have their sensitivity set to `low`.\n* The rule with ID `<MANAGED_RULESET_RULE_ID>` will use the `block` action.\n\nThe overrides apply to all packets matching the rule expression: `ip.dst in { 1.1.1.0/24 }`.\n\nThe response returns the created (or updated) phase entry point ruleset.\n\nFor more information on defining overrides for managed rulesets using the Rulesets API, refer to [Override a managed ruleset](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/).\n\n<page>\n---\ntitle: Configure Network-layer DDoS Attack Protection in the dashboard ·\n  Cloudflare DDoS Protection docs\ndescription: Configure the Network-layer DDoS Attack Protection managed ruleset\n  by defining overrides in the Cloudflare dashboard. DDoS overrides allow you to\n  customize the action and sensitivity of one or more rules in the managed\n  ruleset.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-dashboard/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/configure-dashboard/index.md\n---\n\nConfigure the Network-layer DDoS Attack Protection managed ruleset by defining [overrides](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) in the Cloudflare dashboard. DDoS overrides allow you to customize the **action** and **sensitivity** of one or more rules in the managed ruleset.\n\nYou define overrides for the Network-layer DDoS Attack Protection managed ruleset at the account level.\n\nFor more information on the available parameters and allowed values, refer to [Ruleset parameters](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/).\n\n## Create a DDoS override\n\n1. In the Cloudflare dashboard, go to the **L3/4 DDoS protection** page.\n\n[Go to **DDoS Managed Rules**](https://dash.cloudflare.com/?to=/:account/network-security/ddos)\n\n2. Go to **Network-layer DDoS Protection**.\n\n3. Select **Deploy a DDoS override**.\n\n4. In **Set scope**, specify if you wish to apply the override to all incoming packets or to a subset of the packets.\n\n5. If you are creating an override for a subset of the incoming packets, define the [custom expression](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-expressions/) that matches the incoming packets you wish to target in the override, using either the Rule Builder or the Expression Editor.\n\n7. Depending on what you wish to override, refer to the following sections (you can perform both configurations on the same override):\n\nConfigure all the rules in the ruleset (ruleset override)\n\n1. Select **Next**.\n   2. Enter a name for your override in **Execution name**.\n   3. To always apply a given action for all the rules in the ruleset, select an action in **Ruleset action**.\n   4. To set the sensitivity level for all the rules in the ruleset, select a value in **Ruleset sensitivity**.\n\nConfigure one or more rules\n\n1. Search for the rules you wish to override using the available filters. You can search for tags.\n   2. To override a single rule, select the desired value for a field in the displayed dropdowns next to the rule.\n\nTo configure more than one rule, select the rules using the row checkboxes and update the fields for the selected rules using the dropdowns displayed before the table. You can also configure all the rules with a given tag. For more information, refer to [Configure rules in bulk in a managed ruleset](https://developers.cloudflare.com/waf/managed-rules/deploy-zone-dashboard/#configure-rules-in-bulk-in-a-managed-ruleset). 14. Select **Next**. 15. Enter a name for your override in **Execution name**.\n\n* Tag and rule overrides have priority over ruleset overrides.\n\n* The managed ruleset includes some read-only rules that you cannot override.\n\n8. To save and deploy the override, select **Deploy**. If you are not ready to deploy your override, select **Save as Draft**.\n\n### Delete a DDoS override\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/), and select your account.\n  2. Go to **Security** > **DDoS**.\n  3. Next to the DDoS override you wish to delete, select **Delete**.\n  4. Select **Delete** to confirm the operation.\n\n1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n[Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n2. Go to the **DDoS protection** tab.\n\n3. Select the override.\n\n4. Select **Delete deployment**.\n\n<page>\n---\ntitle: Configure using Terraform · Cloudflare DDoS Protection docs\nlastUpdated: 2025-06-30T19:31:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/link-configure-terraform/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/link-configure-terraform/index.md\n---\n\n<page>\n---\ntitle: Override examples for Network-layer DDoS Attack Protection · Cloudflare\n  DDoS Protection docs\ndescription: The following scenarios detail how you can make use of override\n  rules as a solution to common Network DDoS Protection issues.\nlastUpdated: 2025-12-19T19:54:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-examples/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-examples/index.md\n---\n\nThe following scenarios detail how you can make use of override rules as a solution to common Network DDoS Protection issues.\n\n### VPN traffic is blocked by a UDP rule\n\nIf you have VPN traffic concentrated to a single or a few single destination IP addresses and the traffic is being blocked by a UDP rule, you can create an override rule for the UDP rule to the destination IPs or ranges.\n\nThe override only applies to the detection and not the fingerprint generated and used for mitigation. Refer to [Important remarks](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-expressions/#important-remarks) for more information.\n\n### Attack traffic is flagged by the adaptive rule based on UDP and destination port\n\nIf you recognize that the traffic flagged by the adaptive rule based on UDP and destination port is an attack, you create an override rule to enable the adaptive rule in mitigation mode, setting the action to block the traffic.\n\n### Minimize the risk of false positives impacting production traffic\n\nTo avoid disruptions during initial deployment, you can create a *Log* only – *Essentially Off* ruleset override that allows all traffic while logging detection results. This lets you safely observe and analyze DDoS activity before enabling enforcement.\n\n1. In the Cloudflare dashboard, go to the **Security rules** page.\n\n[Go to **Security rules**](https://dash.cloudflare.com/?to=/:account/:zone/security/security-rules)\n\n2. Go to the **DDoS protection** tab.\n\n3. On **HTTP DDoS attack protection**, select **Create override**.\n\n4. Set the **Scope** to *Apply to all incoming packets*.\n\n5. Under **Ruleset configuration**:\n\n* Set the **Ruleset action** to *Log*.\n   * Set the **Ruleset sensitivity** to *Essentially Off*.\n\n<page>\n---\ntitle: Override expressions for Network-layer DDoS Attack Protection ·\n  Cloudflare DDoS Protection docs\ndescription: Set an override expression for the Network-layer DDoS Attack\n  Protection managed ruleset to define a specific scope for sensitivity level or\n  action adjustments.\nlastUpdated: 2025-12-19T19:54:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-expressions/\n  md: https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/override-expressions/index.md\n---\n\nSet an override expression for the Network-layer DDoS Attack Protection managed ruleset to define a specific scope for [sensitivity level](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/#sensitivity-level) or [action](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/override-parameters/#action) adjustments.\n\nWhen considering which, if any, expressions you should utilize, think of expressions as a tool to scope overrides to the specific service that the Network-layer DDoS Attack Protection managed ruleset is protecting. That is to say that most services are defined by their destination ports and IPs as opposed to source ports or IPs. Refer to [Imporant remarks](https://developers.cloudflare.com/ddos-protection/managed-rulesets/network/network-overrides/#important-remarks) for more information.\n\nFor example, you can set different sensitivity levels for different destination IP addresses or ports: a medium sensitivity level for destination IP address `A` and a low sensitivity level for destination IP address `B`.\n\n## Available expression fields\n\nThe following fields are made available for use in override expressions.\n\nThe list of fields we recommend using in expressions:\n\n* `ip.dst`\n* `ip.proto.num`\n* `tcp.dstport`\n* `tcp.flags`\n* `tcp.flags.ack`\n* `tcp.flags.fin`\n* `tcp.flags.push`\n* `tcp.flags.reset`\n* `tcp.flags.syn`\n* `tcp.flags.urg`\n* `udp.dstport`\n\nThe list of fields we do not recommend to be used in expressions:\n\n* `ip.src`\n* `ip.len`\n* `ip.ttl`\n* `tcp.srcport`\n* `udp.srcport`\n\nRefer to the [Fields reference](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/) in the Rules language documentation for more information.\n\n### Recommended vs. non-recommended fields\n\nOverride expressions are not allowlists. Overrides are applied to the detection, and are not applied to the resulting mitigation. This means an override only takes effect if the attack fingerprint, as generated by the DDoS managed rules, includes the same fields specified in your expression. Thus, it makes the use of source fields like `ip.src`, `ip.len`, `ip.ttl`, `tcp.srcport`, and `udp.srcport` unreliable.\n\nThe use of non-recommended fields in an expression may result in unexpected behavior. While you may be inclined to utilize source properties, the expressions are not allowlists and including source traffic properties may result in false positives.\n\nFor example, if you create an override with sensitivity set to `Essentially Off` for `ip.src eq 192.0.2.1`, it only applies if the fingerprint includes `ip.src`. However, because DDoS attacks are often distributed across many source IPs, the fingerprint may not include `ip.src` at all. In such cases, your override is not applied.\n\nIn a common scenario, an attack originating from thousands of IPs can target a single destination IP and port. The fingerprint would focus on the shared attributes, such as the destination IP, port, and additional packet fields that represent strong signals of the attack pattern. Even if your override matches a specific source IP, it will not apply if that field is not present in the fingerprint. As a result, the system will mitigate the attack using the default high sensitivity, and traffic from your specified IP could still be blocked. It is recommended to use more stable expressions such as protocol, destination IP, and destination port.\n\nEach expression is limited to 4,000 characters, which means you can enter approximately a maximum of 200 IP addresses in a single expression. However, you can enter IP addresses in CIDR format, which allows you to include a larger number of IP addresses. For example, you can use `192.0.0.0/24` to match IP addresses from `192.0.0.0` to `192.0.0.255`.\n\n<page>\n---\ntitle: Set up a child zone in Cloudflare with parent on full setup · Cloudflare\n  DNS docs\ndescription: When the parent zone is using a full setup1, the steps to set up\n  your child zone depend on whether the subdomain already exists in the parent\n  domain.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/parent-on-full/\n  md: https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/parent-on-full/index.md\n---\n\nWhen the parent zone is using a [full setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/)[1](#user-content-fn-1), the steps to set up your child zone depend on whether the subdomain already exists in the parent domain.\n\nThe following steps are similar if your Cloudflare parent zone is in a secondary setup, with the only difference that you will use your external primary DNS provider to make any necessary adjustments to DNS records.\n\n## Subdomain does not exist\n\nIf you have not yet created DNS records covering your subdomain in the parent zone:\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n\n2. Complete the configuration accordingly for [full](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/) or [secondary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) setup.\n\n3. Get the nameserver names for the subdomain. These can be found within your newly created child zone on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, and will **not** be the same nameservers as the ones used in the parent zone.\n\n4. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page of the parent zone, [add](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) two `NS` records for the subdomain you want to delegate.\n\nFor example, if you delegated `www.example.com`, you might add the following records to `example.com`:\n\n| **Type** | **Name** | **Content** |\n   | - | - | - |\n   | `NS` | www | john.ns.cloudflare.com |\n   | `NS` | www | melinda.ns.cloudflare.com |\n\n5. After a few minutes, the child zone will be active.\n\n6. Create the various DNS records needed for your child zone.\n\n7. (Optional) [Enable DNSSEC](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/dnssec/) on the child zone.\n\n## Subdomain already exists\n\nIf you have already created DNS records covering your subdomain in the parent zone:\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n\n2. Complete the configuration accordingly for [full](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/) or [secondary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) setup.\n\n3. In your child zone, make sure you have all DNS records that relate to the subdomain. This includes all DNS records deeper than the delegated subdomain. For example, if you are delegating `www.example.com`, you should also move over records for `api.www.example.com`.\n\nIf your child zone is on a full setup, consider [exporting](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#export-records) records from the parent zone, deleting all unnecessary records, and then [importing](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#import-records) the records into your new zone.\n\n4. If the parent zone is on Cloudflare, make sure that you migrate over any settings ([WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/), [Rules](https://developers.cloudflare.com/rules/), [Workers](https://developers.cloudflare.com/workers/), and more) that might be needed for the child zone.\n\n5. In the child zone, [order an advanced SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) that covers the child subdomain and any deeper subdomains (if present).\n\n6. Get the nameserver names for the subdomain. These can be found within your newly created child zone on the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, and will **not** be the same nameservers as the ones used in the parent zone.\n\nIf the parent zone is on Cloudflare, steps 7 and 9 below can be achieved via API. Use the [Batch DNS records](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/batch/) endpoint to delete and create or update DNS records within a single request. Refer to [Batch record changes](https://developers.cloudflare.com/dns/manage-dns-records/how-to/batch-record-changes/) for further guidance.\n\n7. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page of the parent zone, update existing address records (`A/AAAA`) on your subdomain to `NS` records. If you only have one address record, update the existing one and add a new `NS` record. If you have multiple address records, update any two of them.\n\nFor example, to delegate the subdomain `www.example.com`, the updated records in the parent zone `example.com` should contain `NS` records similar to the following:\n\n| **Type** | **Name** | **Content** |\n   | - | - | - |\n   | `NS` | www | john.ns.cloudflare.com |\n   | `NS` | www | adam.ns.cloudflare.com |\n\nIn this example, `john.ns.cloudflare.com` and `adam.ns.cloudflare.com` represent the subdomain nameservers that you got from step 6.\n\n8. Flush the address records of your subdomain in public resolvers ([1.1.1.1](https://1.1.1.1/purge-cache/) and [8.8.8.8](https://developers.google.com/speed/public-dns/cache)).\n\n9. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page of the parent zone, [delete](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#delete-dns-records) all the remaining records on the delegated subdomain, except the `NS` records that you created in step 7.\n\nAlso delete all DNS records deeper than the delegated subdomain. For example, if you are delegating `www.example.com`, records for `api.www.example.com` should only exist in the new child zone.\n\n10. Within a short period of time, the child zone should be active.\n\n11. (Optional) [Enable DNSSEC](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/dnssec/) on the child zone.\n\n1. Meaning that Cloudflare is your Authoritative DNS provider. [↩](#user-content-fnref-1)\n\n<page>\n---\ntitle: Set up a child zone in Cloudflare with parent on partial setup ·\n  Cloudflare DNS docs\ndescription: When the parent zone is using a partial setup1, the steps to set up\n  your child zone depend on whether the subdomain already exists in the parent\n  domain.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/parent-on-partial/\n  md: https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/setup/parent-on-partial/index.md\n---\n\nWhen the parent zone is using a [partial setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup/)[1](#user-content-fn-2), the steps to set up your child zone depend on whether the subdomain already exists in the parent domain.\n\n## Subdomain does not exist\n\nIf you have not yet created a DNS record covering your subdomain in the parent zone:\n\n* child is full or secondary\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n  2. Complete the configuration accordingly for [full](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/) or [secondary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) setup.\n  3. After creating the DNS records on the child zone, add the Cloudflare nameservers as `NS` records at your external DNS provider.\n  4. Within a short period of time, the child zone should be active.\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n  2. Select either Business or Enterprise as your zone plan and complete the onboarding flow according to your needs.\n  3. On the [Overview page](https://dash.cloudflare.com/?to=/:account/:zone), select **Convert to CNAME DNS Setup**.\n  4. Confirm that you have created all the [DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) needed for your child zone.\n  5. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, get the **Verification TXT Record** and add it at your authoritative DNS provider.\n\nExample verification record\n\nA verification record for `sub.example.com` might be:\n\n| Type | Name | Content |\n  | - | - | - |\n  | TXT | `cloudflare-verify.sub.example.com` | 966215192-518620144 |\n\nIf your authoritative DNS provider automatically appends DNS record `name` fields with your domain, make sure to only insert `cloudflare-verify` as the record name. Otherwise, it may result in an incorrect record name, such as `cloudflare-verify.sub.example.com.sub.example.com`.\n\nAfter creating the record, you can use this [Dig Web Interface link](https://digwebinterface.com/?type=TXT\\&ns=auth\\&nameservers=) to search (`dig`) for `cloudflare-verify.<YOUR DOMAIN>` and validate if it is working.\n\nThat record must remain in place for as long as your subdomain is active on the partial setup on Cloudflare.\n\n1. Within a short period of time, the child zone should be active.\n  2. At your authoritative DNS provider, add `CNAME` records pointing to `{your-hostname}.cdn.cloudflare.net` for the subdomain you have added and any deeper subdomain records you want to proxy through Cloudflare.\n\nExample CNAME record at authoritative DNS provider\n\nThe `CNAME` record for `sub.example.com` would be:\n\n## Subdomain already exists\n\nIf you have already created a DNS record covering your subdomain in the parent zone:\n\n* child is full or secondary\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n\n2. Complete the configuration accordingly for [full](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/) or [secondary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) setup.\n\n3. In your child zone, [re-create all DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) that relate to your subdomain. This includes all DNS records deeper than the delegated subdomain, meaning that if you are delegating `www.example.com`, you should also move over records for `api.www.example.com`.\n\nIf your child zone is on a full setup, consider [exporting](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#export-records) records from the parent zone, deleting all unnecessary records, and then [importing](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#import-records) the records into your new zone.\n\n4. Make sure that you migrate over any settings ([WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/), [Rules](https://developers.cloudflare.com/rules/), [Workers](https://developers.cloudflare.com/workers/), and more) that might be needed for the child zone.\n\n5. In the child zone, [order an advanced SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) that covers the child subdomain and any deeper subdomains.\n\n6. Get the Cloudflare nameservers for the subdomain and add them as `NS` records at your external DNS provider.\n\n7. Within a short period of time, the child zone should be active.\n\n8. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page of the parent zone, [delete](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#delete-dns-records) any `A`, `AAAA`, or `CNAME` records referencing the subdomain or any of its deeper subdomains.\n\n1. Add the subdomain to a Cloudflare account as a new zone. It can be the same account where the parent zone exists or a different one.\n\n2. Select either Business or Enterprise as your zone plan and complete the onboarding flow according to your needs.\n\n3. On the [Overview page](https://dash.cloudflare.com/?to=/:account/:zone), select **Convert to CNAME DNS Setup**.\n\n4. In your child zone, [re-create all DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) that relate to your subdomain. This includes all DNS records deeper than the subdomain you used to create the zone - if you are creating a zone for `www.example.com`, you should also move over records for `api.www.example.com`.\n\nCloudflare recommends [exporting](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#export-records) records from the parent zone, deleting all unnecessary records, and then [importing](https://developers.cloudflare.com/dns/manage-dns-records/how-to/import-and-export/#import-records) the records into your new zone.\n\n5. Make sure that you migrate over any settings ([WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/), [Rules](https://developers.cloudflare.com/rules/), [Workers](https://developers.cloudflare.com/workers/), and more) that might be needed for the child zone.\n\n6. In the child zone, [order an advanced SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) that covers the child subdomain and any deeper subdomains.\n\n7. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, get the **Verification TXT Record** and add it at your authoritative DNS provider.\n\nExample verification record\n\nA verification record for `sub.example.com` might be:\n\n| Type | Name | Content |\n  | - | - | - |\n  | TXT | `cloudflare-verify.sub.example.com` | 966215192-518620144 |\n\nIf your authoritative DNS provider automatically appends DNS record `name` fields with your domain, make sure to only insert `cloudflare-verify` as the record name. Otherwise, it may result in an incorrect record name, such as `cloudflare-verify.sub.example.com.sub.example.com`.\n\nAfter creating the record, you can use this [Dig Web Interface link](https://digwebinterface.com/?type=TXT\\&ns=auth\\&nameservers=) to search (`dig`) for `cloudflare-verify.<YOUR DOMAIN>` and validate if it is working.\n\nThat record must remain in place for as long as your subdomain is active on the partial setup on Cloudflare.\n\n1. Within a short period of time, the child zone should be active.\n  2. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page of the parent zone, [delete](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#delete-dns-records) any previous `A`, `AAAA`, or `CNAME` records referencing the subdomain or any of its deeper subdomains.\n  3. At your authoritative DNS provider, confirm you have `CNAME` records pointing to `{your-hostname}.cdn.cloudflare.net` for the subdomain you have added and any deeper subdomain records you want to proxy through Cloudflare.\n\nExample CNAME record at authoritative DNS provider\n\nThe `CNAME` record for `sub.example.com` would be:\n\n1. Meaning that another DNS provider - not Cloudflare - maintains your Authoritative DNS. [↩](#user-content-fnref-2)\n\n<page>\n---\ntitle: Cloudflare IP addresses - Access Control Lists (ACLs) · Cloudflare DNS docs\ndescription: Access Control Lists (ACLs) define allowed source IP addresses from\n  where servers accept incoming data or control messages.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/index.md\n---\n\nAccess Control Lists (ACLs) define allowed source IP addresses from where servers accept incoming data or control messages.\n\nWhen setting up new DNS zone transfers (incoming or outgoing), you will need to update the ACLs at your other DNS provider to prevent communication from Cloudflare from being blocked.\n\nDepending on the setup ([Cloudflare as Primary](#cloudflare-as-primary) or [Cloudflare as Secondary](#cloudflare-as-secondary)), you need to configure slightly different Cloudflare IP addresses at your other DNS provider.\n\n## Cloudflare as Primary\n\nIf you are using Cloudflare for Primary DNS — meaning that you are setting up Cloudflare to send [outgoing zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/) — you need to update the following settings at your secondary DNS provider.\n\nCloudflare's NOTIFY messages originate from the following IP prefixes. These ranges need to be allowed at your Secondary DNS servers.\n\nCloudflare will listen to AXFR/IXFR zone transfer requests and SOA queries from your Secondary DNS server on this IP address.\n\n## Cloudflare as Secondary\n\nIf you are using Cloudflare for Secondary DNS — meaning that you are setting up Cloudflare to receive [incoming zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/) — you need to update the following settings at your primary DNS provider.\n\nCloudflare's AXFR/IXFR zone transfer requests originate from the following IP prefixes. These ranges need to be allowed at your Primary DNS servers.\n\nNotify IPs are the IP addresses where you notify Cloudflare's Secondary DNS to initiate a pull of new zone information from your Primary DNS servers:\n\n### Bind server configuration\n\nTo run a BIND server as a primary, add the following statements to your zone file:\n\n<page>\n---\ntitle: Create a new Access Control List · Cloudflare DNS docs\ndescription: You need to create an Access Control List (ACL) if Cloudflare is\n  your secondary DNS provider. The ACL will specify additional NOTIFY IPs that\n  Cloudflare should listen to.\nlastUpdated: 2025-09-04T10:36:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/create-new-list/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/create-new-list/index.md\n---\n\nYou need to create an Access Control List (ACL) if Cloudflare is your [secondary DNS provider](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/). The ACL will specify additional NOTIFY IPs that Cloudflare should listen to.\n\nAn ACL is configured at the account level, which means that it will apply to every primary and secondary zone in your account.\n\nTo create a new ACL using the dashboard:\n\n1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **DNS Settings**.\n\n3. Under **DNS Zone Transfers**, for **ACL**, select **Create**.\n\n4. Enter the following information:\n\n* **ACL name**: Provide a descriptive name.\n     * **IP range**: Enter a range of IPv4 or IPv6 addresses (limited to a maximum of /24 for IPv4 and /64 for IPv6).\n\n5. Select **Create**.\n\nTo create a new ACL using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/acls/methods/create/) request.\n\n<page>\n---\ntitle: Set up multi-signer DNSSEC with outgoing zone transfers · Cloudflare DNS docs\ndescription: With outgoing zone transfers, you keep Cloudflare as your primary\n  DNS provider and use one or more secondary providers for increased\n  availability and fault tolerance.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/dnssec-for-primary/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/dnssec-for-primary/index.md\n---\n\nWith [outgoing zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/), you keep Cloudflare as your primary DNS provider and use one or more secondary providers for increased availability and fault tolerance.\n\nIf you want to use DNSSEC with outgoing zone transfers, you should configure [multi-signer DNSSEC](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/). After setting up [Cloudflare as primary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/setup/), follow the steps below to enable DNSSEC.\n\n* This process requires that your other DNS provider(s) also support multi-signer DNSSEC.\n* Although you can complete a few steps via the dashboard, currently the whole process can only be completed using the API.\n* Enabling **DNSSEC** and **Multi-signer DNSSEC** in [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) only replaces the first step below. You still have to follow the rest of this tutorial to complete the setup.\n\n1. Use the [Edit DNSSEC Status endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/edit/) to enable DNSSEC and activate multi-signer DNSSEC for your zone. This is done by setting `status` to `active` and `dnssec_multi_signer` to `true`, as in the following example.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n1. Add the ZSK(s) of your external provider(s) to Cloudflare by creating a DNSKEY record on your zone.\n\n1. Once the DNSKEY record is transferred out from Cloudflare to your secondary provider, get Cloudflare's ZSK and manually add it to the DNSKEY record.\n\nCurrently, the ZSK is not automatically transferred out. You can use either the API or a query from one of the assigned Cloudflare nameservers to obtain it.\n\nCommand line query example:\n\n1. Add DS records to your registrar, one for each provider. You can see your Cloudflare DS record on the [**DNS Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings) page, under **DS Record**.\n\nThe nameserver settings at your registrar should include the nameservers of all providers you will be using for your multi-signer DNSSEC setup.\n\n<page>\n---\ntitle: Set up outgoing zone transfers (Cloudflare as Primary) · Cloudflare DNS docs\ndescription: With outgoing zone transfers, you can keep Cloudflare as your\n  primary DNS provider and use one or more secondary providers for increased\n  availability.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/setup/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/setup/index.md\n---\n\nWith [outgoing zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/), you can keep Cloudflare as your primary DNS provider and use one or more secondary providers for increased availability and fault tolerance.\n\nMake sure your account team has enabled your zone for outgoing zone transfers.\n\nConsider the [expected behaviors](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/transfer-criteria/) for different record types, and review your [existing DNS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/) to make sure all of them have the desired **Proxy status**.\n\nIf using the API, you may also want to [locate your Zone and Account IDs](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/).\n\n## 1. Create TSIG (optional)\n\nA Transaction Signature (TSIG) authenticates communication between a primary and secondary DNS server.\n\nThe TSIG names configured at your primary and secondary DNS providers have to be exactly the same. Any differences in TSIG names will cause zone transfers to fail.\n\nWhile optional, this step is highly recommended.\n\nTo create a TSIG using the dashboard:\n\n1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **DNS Settings**.\n\n3. Under **DNS Zone Transfers**, for **TSIG**, select **Create**.\n\n4. Enter the following information:\n\n* **TSIG name**: The name of the TSIG object using domain name syntax (more details in [RFC 8945 section 4.2](https://datatracker.ietf.org/doc/html/rfc8945#section-4.2)).\n     * **Secret (optional)**: Get a shared secret to add to your third-party nameservers. If left blank, this field generates a random secret.\n     * **Algorithm**: Choose a TSIG signing algorithm.\n\n5. Select **Create**.\n\nTo create a TSIG using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/tsigs/methods/create/) request.\n\n## 2. Create Peer DNS Server (optional)\n\nYou only need to create a peer DNS server if you want:\n\n* Your secondary nameservers to receive **NOTIFYs** for changes to your Cloudflare DNS records.\n* A **TSIG** to sign zone transfer requests and **NOTIFYs**.\n\nTo create a peer using the dashboard:\n\n1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **DNS Settings**.\n\n3. Under **DNS Zone Transfers**, for **Peer DNS servers**, select **Create**.\n\n4. Enter the following information, paying particular attention to:\n\n* **IP**: If configured, specifies where Cloudflare sends NOTIFY requests to.\n     * **Port**: Specifies the IP Port for the NOTIFY IP.\n     * **Enable incremental (IXFR) zone transfers**: Does not apply when you are using Cloudflare as your primary DNS provider (Cloudflare zones always accept IXFR requests).\n     * **Link an existing TSIG**: If desired, link the TSIG you [previously created](#1-create-tsig-optional).\n\n5. Select **Create**.\n\nTo create a peer DNS server using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/peers/methods/create/) request.\n\n## 3. Link peer to primary zone (optional)\n\nIf you previously [created a peer DNS server](#2-create-peer-dns-server-optional), you should link it to your primary zone.\n\nThe maximum number of linked peers per zone is 30.\n\nTo link a primary zone to a peer using the dashboard:\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. For **DNS Zone Transfers**, select **Manage linked peers**.\n\nTo link a primary zone to a peer using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/incoming/methods/create/) request with the ID of the peer you [previously created](#2-create-peer-dns-server-optional).\n\nMultiple peers and TSIG\n\nIf you link more than one peer to a zone and at least one of them has TSIG configured, all peers are expected to also use the same TSIG.\n\n## 4. Update your secondary DNS provider\n\nYour secondary DNS provider should send zone transfer requests (via AXFR or IXFR) to [this IP](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/#transfer-ip) on port 53 and from the IP address specified in your [peer configuration](#2-create-peer-dns-server-optional).\n\nIt should also have updated [Access Control Lists (ACLs)](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/#allow-range) to prevent NOTIFY messages sent from Cloudflare IP ranges from being blocked.\n\n## 5. Add secondary nameservers within Cloudflare\n\nUsing the information from your secondary DNS provider, [create NS records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/create-dns-records/#create-dns-records) on your zone apex listing your secondary nameservers.\n\nBy default, Cloudflare ignores NS records added to the zone apex. To modify this behavior, enable [multi-provider DNS](https://developers.cloudflare.com/dns/nameservers/nameserver-options/#multi-provider-dns).\n\nIf your account [zone defaults](https://developers.cloudflare.com/dns/additional-options/dns-zone-defaults/) are already defined to have **Multi-provider DNS** enabled, this step may not be necessary.\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. Enable **Multi-provider DNS**.\n\nSend the following `PATCH` request replacing the placeholders with your zone ID and authentication information:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Zone DNS Settings Write`\n  * `DNS Write`\n\nIn case you want to keep Cloudflare as the only authoritative DNS provider, do not enable multi-provider DNS. In this way, your secondary DNS is kept hidden and up-to-date with the Cloudflare primary, as a backup option for disaster recovery scenarios.\n\n## 6. Enable outgoing zone transfers\n\nWhen you enable outgoing zone transfers, this will send a DNS NOTIFY message to your secondary DNS provider.\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. For **Outgoing Zone Transfers**, switch the toggle to **On**.\n\nTo enable outgoing zone transfers using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/outgoing/methods/enable/) request.\n\n## 7. Add secondary nameservers to registrar\n\nAt your registrar, add the nameservers of your secondary DNS provider.\n\n<page>\n---\ntitle: Records transfer · Cloudflare DNS docs\ndescription: Consider the sections below to understand the expected behaviors,\n  depending on DNS record type and proxied status.\nlastUpdated: 2025-10-14T09:05:34.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/transfer-criteria/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-primary/transfer-criteria/index.md\n---\n\nConsider the sections below to understand the expected behaviors, depending on DNS record type and proxied status.\n\nFor each [proxied DNS record](https://developers.cloudflare.com/dns/proxy-status/) in your zone, Cloudflare will transfer out two `A` and two `AAAA` records.\n\nThese records correspond to the [Cloudflare IP addresses](https://www.cloudflare.com/ips) used for proxying traffic.\n\n## DNS-only CNAME records\n\nAs explained in [DNS record types](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#cname), Cloudflare uses a process called [CNAME flattening](https://developers.cloudflare.com/dns/cname-flattening/) to return the final IP address instead of the CNAME target. CNAME flattening improves performance and is also what allows you to set a CNAME record on the zone apex.\n\nDepending on the [settings](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/) you have, when you use DNS-only CNAME records with outgoing zone transfers, you can expect the following:\n\n* For DNS-only CNAME records on the zone apex, Cloudflare will always transfer out the flattened IP addresses.\n* For DNS-only CNAME records on subdomains, Cloudflare will only transfer out flattened IP addresses if the setting [**CNAME flattening for all CNAME records**](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#for-all-cname-records) is enabled.\n\nPer-record CNAME flattening\n\nFor records using [per-record CNAME flattening](https://developers.cloudflare.com/dns/cname-flattening/set-up-cname-flattening/#per-record) (meaning **CNAME flattening for all CNAME records** is disabled), Cloudflare will transfer out the CNAME, not the flattened IP address.\n\n## Records that are not transferred\n\nThe following records are not transferred out when you use Cloudflare as primary:\n\n* [CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/)\n* TXT records used for TLS certificate validation\n* DNS-only [Load Balancing](https://developers.cloudflare.com/load-balancing/load-balancers/dns-records/) records\n\nProxied Load Balancing records are transferred as explained in [Proxied records](#proxied-records).\n\n<page>\n---\ntitle: Alerts for Secondary DNS · Cloudflare DNS docs\ndescription: You can configure alerts to receive notifications for changes in\n  your secondary DNS.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/alerts/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/alerts/index.md\n---\n\nYou can configure alerts to receive notifications for changes in your secondary DNS.\n\nSecondary DNS all Primaries Failing\n\nEnterprise customers who have at least one secondary zone in their account and want to receive a notification if all of their primary nameservers are failing.\n\n**Other options / filters**\n\nPurchase of Secondary DNS\n\n**What should you do if you receive one?**\n\n1. Confirm that your primary nameservers are up and running.\n2. Confirm that the [Access Control Lists (ACLs)](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/) on your primary nameservers are configured correctly.\n3. Confirm that your primary nameservers are configured correctly in your Cloudflare account (correct IP, port, TSIG).\n\nSecondary DNS Primaries Failing\n\nEnterprise customers who have at least one secondary zone and want to receive a notification if at least one of their primary nameservers is failing while transfers from at least one other primary are still successful.\n\n**Other options / filters**\n\nPurchase of Secondary DNS.\n\n**What should you do if you receive one?**\n\n1. Confirm that your primary nameservers are up and running.\n2. Confirm that the [Access Control Lists (ACLs)](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/) on your primary nameservers are configured correctly.\n3. Confirm that your primary nameservers are configured correctly in your Cloudflare account (correct IP, port, TSIG).\n\nSecondary DNS Successfully Updated\n\nEnterprise customers who have at least one secondary zone in their account and want to receive a notification on successful zone transfers.\n\n**Other options / filters**\n\nPurchase of Secondary DNS.\n\n**What should you do if you receive one?**\n\nNo action needed. Everything is working correctly.\n\nSecondary DNS Warning\n\nCustomers who are using Cloudflare for Secondary DNS and want to receive notifications about warnings issued by the transferred zone.\n\n**Other options / filters**\n\n**What should you do if you receive one?**\n\nActions for failure notifications will depend on the type of failure.\n\nRefer to [Cloudflare Notifications](https://developers.cloudflare.com/notifications/get-started/) for more information on how to set up an alert.\n\n<page>\n---\ntitle: DNSSEC for Secondary DNS · Cloudflare DNS docs\ndescription: DNS Security Extensions (DNSSEC) increase security by adding\n  cryptographic signatures to DNS records. When you use multiple providers and\n  Cloudflare is secondary, you have a few options to enable DNSSEC for records\n  served by Cloudflare.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/index.md\n---\n\n[DNS Security Extensions (DNSSEC)](https://www.cloudflare.com/learning/dns/dns-security/) increase security by adding cryptographic signatures to DNS records. When you use multiple providers and Cloudflare is secondary, you have a few options to enable DNSSEC for records served by Cloudflare.\n\n* **[Multi-signer DNSSEC](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/)**: Both Cloudflare and your primary DNS provider know the signing keys of each other and perform their own live-signing of DNS records, in accordance with [RFC 8901](https://www.rfc-editor.org/rfc/rfc8901.html).\n* **[Live signing](#set-up-live-signing-dnssec)**: If your domain is not delegated to your primary provider's nameservers and Cloudflare secondary nameservers are the only nameservers authoritatively responding to DNS queries (hidden primary setup), you can choose this option to allow Cloudflare to perform live-signing of your DNS records.\n* **[Pre-signed](#set-up-pre-signed-dnssec)**: Your primary DNS provider signs records and transfers out the signatures. Cloudflare then serves these records and signatures as is, without doing any signing. By default, Cloudflare uses [NSEC records](https://www.cloudflare.com/dns/dnssec/how-dnssec-works/) and not NSEC3 - refer to [NSEC3 support](https://developers.cloudflare.com/dns/dnssec/enable-nsec3/) if needed. Also, Pre-signed DNSSEC does not support [Secondary DNS Overrides](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/) nor [Load Balancing](https://developers.cloudflare.com/load-balancing/).\n\n## Set up multi-signer DNSSEC\n\nRefer to [Set up multi-signer DNSSEC](https://developers.cloudflare.com/dns/dnssec/multi-signer-dnssec/setup/) and follow the instructions, considering the note about Cloudflare as Secondary.\n\n## Set up live signing DNSSEC\n\nIf you use Cloudflare secondary nameservers as the only nameservers authoritatively responding to DNS queries (hidden primary setup), you can enable live signing DNSSEC to have Cloudflare sign the records for your zone.\n\nIn this setup, DNSSEC on your pirmary DNS provider does not need to be enabled.\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. Under **DNSSEC with Secondary DNS** select **Live signing**. You will then have access to several necessary values to create a **DS** record at your registrar.\n\n3. Add the **DS** record to your registrar. If Algorithm 13 - Cloudflare's preferred cipher choice - is not listed by your registrar, it may also be called *ECDSA Curve P-256 with SHA-256*.\n\nProvider-specific instructions\n\nThis is not an exhaustive list of how to update DS records in other providers, but the following links may be helpful:\n\n* [DNSimple](https://support.dnsimple.com/articles/cloudflare-ds-record/)\n     * [Domaindiscount24](https://support.domaindiscount24.com/hc/articles/4409759478161)\n     * [DreamHost](https://help.dreamhost.com/hc/en-us/articles/219539467)\n     * [Dynadot](https://www.dynadot.com/help/question/set-DNSSEC)\n     * [Enom](https://support.enom.com/support/solutions/articles/201000065386)\n     * [Gandi](https://docs.gandi.net/en/domain_names/advanced_users/dnssec.html)\n     * [GoDaddy](https://www.godaddy.com/en-ph/help/add-a-ds-record-23865)\n     * [Hostinger](https://www.hostinger.com/support/3667267-how-to-use-dnssec-records-at-hostinger/)\n     * [Hover](https://support.hover.com/support/solutions/articles/201000064716)\n     * [InMotion Hosting](https://www.inmotionhosting.com/support/edu/cpanel/enable-dnssec-cloudflare/)\n     * [INWX](https://kb.inwx.com/en-us/3-nameserver/131)\n     * [Joker.com](https://joker.com/faq/books/jokercom-faq-en/page/dnssec)\n     * [Name.com](https://www.name.com/support/articles/205439058-managing-dnssec)\n     * [Namecheap](https://www.namecheap.com/support/knowledgebase/article.aspx/9722/2232/managing-dnssec-for-domains-pointed-to-custom-dns/)\n     * [NameISP](https://support.nameisp.com/knowledgebase/dns)\n     * [Namesilo](https://www.namesilo.com/support/v2/articles/domain-manager/ds-records)\n     * [OVH](https://help.ovhcloud.com/csm/en-dns-secure-domain-dnssec?id=kb_article_view\\&sysparm_article=KB0051637)\n     * [Squarespace](https://support.squarespace.com/hc/articles/4404183898125-Nameservers-and-DNSSEC-for-Squarespace-managed-domains#toc-dnssec)\n     * [Registro.br](https://registro.br/tecnologia/dnssec/?secao=tutoriais-dns)\n     * [Porkbun](https://kb.porkbun.com/article/93-how-to-install-dnssec) (do not fill out **keyData**)\n     * [TransIP](https://www.transip.eu/knowledgebase/150-secure-domains-custom-nameservers-dnssec/)\n\n1. Use the [Edit DNSSEC Status endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/edit/) and set a `status` of `active` for your zone.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n1. Use the [DNSSEC Details endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/get/) to get the necessary values to create a **DS** record at your registrar.\n\n2. Add the **DS** record to your registrar. If Algorithm 13 - Cloudflare's preferred cipher choice - is not listed by your registrar, it may also be called *ECDSA Curve P-256 with SHA-256*.\n\nProvider-specific instructions\n\nThis is not an exhaustive list of how to update DS records in other providers, but the following links may be helpful:\n\n* [DNSimple](https://support.dnsimple.com/articles/cloudflare-ds-record/)\n     * [Domaindiscount24](https://support.domaindiscount24.com/hc/articles/4409759478161)\n     * [DreamHost](https://help.dreamhost.com/hc/en-us/articles/219539467)\n     * [Dynadot](https://www.dynadot.com/help/question/set-DNSSEC)\n     * [Enom](https://support.enom.com/support/solutions/articles/201000065386)\n     * [Gandi](https://docs.gandi.net/en/domain_names/advanced_users/dnssec.html)\n     * [GoDaddy](https://www.godaddy.com/en-ph/help/add-a-ds-record-23865)\n     * [Hostinger](https://www.hostinger.com/support/3667267-how-to-use-dnssec-records-at-hostinger/)\n     * [Hover](https://support.hover.com/support/solutions/articles/201000064716)\n     * [InMotion Hosting](https://www.inmotionhosting.com/support/edu/cpanel/enable-dnssec-cloudflare/)\n     * [INWX](https://kb.inwx.com/en-us/3-nameserver/131)\n     * [Joker.com](https://joker.com/faq/books/jokercom-faq-en/page/dnssec)\n     * [Name.com](https://www.name.com/support/articles/205439058-managing-dnssec)\n     * [Namecheap](https://www.namecheap.com/support/knowledgebase/article.aspx/9722/2232/managing-dnssec-for-domains-pointed-to-custom-dns/)\n     * [NameISP](https://support.nameisp.com/knowledgebase/dns)\n     * [Namesilo](https://www.namesilo.com/support/v2/articles/domain-manager/ds-records)\n     * [OVH](https://help.ovhcloud.com/csm/en-dns-secure-domain-dnssec?id=kb_article_view\\&sysparm_article=KB0051637)\n     * [Squarespace](https://support.squarespace.com/hc/articles/4404183898125-Nameservers-and-DNSSEC-for-Squarespace-managed-domains#toc-dnssec)\n     * [Registro.br](https://registro.br/tecnologia/dnssec/?secao=tutoriais-dns)\n     * [Porkbun](https://kb.porkbun.com/article/93-how-to-install-dnssec) (do not fill out **keyData**)\n     * [TransIP](https://www.transip.eu/knowledgebase/150-secure-domains-custom-nameservers-dnssec/)\n\n## Set up pre-signed DNSSEC\n\n* Your secondary zone in Cloudflare already exists and zone transfers from your primary DNS provider are working correctly.\n* You have considered whether your primary DNS provider uses NSEC or NSEC3, and have enabled [NSEC3 support](https://developers.cloudflare.com/dns/dnssec/enable-nsec3/) if needed.\n* Your primary DNS provider transfers out DNSSEC related records, such as RRSIG, DNSKEY, and NSEC.\n\n1. Enable DNSSEC at your primary DNS provider.\n2. Enable DNSSEC for your zone at Cloudflare, using either the Dashboard or the API.\n\nPre-signed DNSSEC does not support [Secondary DNS Overrides](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/) nor [Load Balancing](https://developers.cloudflare.com/load-balancing/). Once you enable pre-signed DNSSEC, Cloudflare will treat all your DNS records as DNS-only.\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. Under **DNSSEC with Secondary DNS** select **Pre-signed**.\n\nUse the [Edit DNSSEC Status endpoint](https://developers.cloudflare.com/api/resources/dns/subresources/dnssec/methods/edit/) and set the `dnssec_presigned` value to `true`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n1. Make sure Cloudflare nameservers are added at your registrar. You can see your Cloudflare nameservers on the dashboard by going to the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page.\n\n2. Make sure there is a DS record added at your registrar. The DS record is obtained from your primary DNS provider (the signer of the zone) and is what indicates to DNS resolvers that your zone has DNSSEC enabled.\n\n<page>\n---\ntitle: Set up incoming zone transfers (Cloudflare as Secondary) · Cloudflare DNS docs\ndescription: With incoming zone transfers, you can keep your primary DNS\n  provider and use Cloudflare as a secondary DNS provider.\nlastUpdated: 2025-10-30T14:49:02.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/index.md\n---\n\nWith [incoming zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/), you can keep your primary DNS provider and use Cloudflare as a secondary DNS provider.\n\nNormal incoming zone transfers only provide DNS resolution. If you also want your traffic to benefit from Cloudflare's performance and security features, you need to [set up Secondary DNS Override](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/).\n\n* You should already have a registered domain, set up with your primary DNS provider.\n* Review the available options and plan for how you will use [DNSSEC with Cloudflare as secondary](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/).\n* Make sure you have completed the following tasks at your primary DNS provider and at Cloudflare.\n\n### At your primary DNS provider\n\nYour primary DNS provider should allow traffic from the IP address and port specified in your [peer server configuration](#2-create-peer-server).\n\nIt should also have updated [Access Control Lists (ACLs)](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/#cloudflare-as-secondary) to prevent zone transfers from being blocked.\n\nWe strongly recommend configuring [DNS NOTIFY](https://datatracker.ietf.org/doc/html/rfc1996) at your primary DNS provider to ensure your secondary zone on Cloudflare is updated with the most recent changes as quickly as possible. In order to do so, set up [Cloudflare NOTIFY IPs](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/#notify-ips) at your primary DNS provider.\n\nYou will also need the following information from your Primary DNS provider:\n\n* **Primary IP address**: The IP address that Cloudflare sends zone transfer requests to (via AXFR or IXFR).\n\n* **Zone transfer type**: Will zone transfers be full (AXFR) or incremental (IXFR)?\n\n* **TSIG name** (optional): A descriptive name of the TSIG following domain name syntax ([RFC 8945 section 4.2](https://datatracker.ietf.org/doc/html/rfc8945#section-4.2)).\n\nThe TSIG names configured at your primary and secondary DNS providers have to be exactly the same. Any differences in TSIG names will cause zone transfers to fail.\n\n* **TSIG secret** (optional): The secret string used to authenticate zone transfers.\n\n* **TSIG algorithm** (optional): The algorithm used to authenticate zone transfers.\n\nMake sure your account team has enabled your zone for Secondary DNS.\n\nGet the following values from your Cloudflare account:\n\n* [Account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/)\n* [Zone ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/)\n* [Nameserver names](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#get-nameserver-names), which should have **secondary** in the name.\n\n## 1. Create TSIG (optional)\n\nA Transaction Signature (TSIG) authenticates communication between a primary and secondary DNS server.\n\nThe TSIG names configured at your primary and secondary DNS providers have to be exactly the same. Any differences in TSIG names will cause zone transfers to fail.\n\nWhile optional, this step is highly recommended.\n\nTo create a TSIG using the dashboard:\n\n1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **DNS Settings**.\n\n3. Under **DNS Zone Transfers**, for **TSIG**, select **Create**.\n\n4. Enter the following information:\n\n* **TSIG name**: The name of the TSIG object using domain name syntax (more details in [RFC 8945 section 4.2](https://datatracker.ietf.org/doc/html/rfc8945#section-4.2)).\n     * **Secret (optional)**: Get a shared secret to add to your third-party nameservers. If left blank, this field generates a random secret.\n     * **Algorithm**: Choose a TSIG signing algorithm.\n\n5. Select **Create**.\n\nTo create a TSIG using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/tsigs/methods/create/) request.\n\n## 2. Create Peer Server\n\nTo create a peer server using the dashboard:\n\n1. In the Cloudflare dashboard, go to the account **Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/configurations)\n\n2. Go to **DNS Settings**.\n\n3. Under **DNS Zone Transfers**, for **Peer DNS servers**, select **Create**.\n\n4. Enter the following information, paying particular attention to:\n\n* **IP**: Specifies where Cloudflare sends transfer requests to.\n     * **Port**: Specifies the IP Port for the transfer IP.\n     * **Enable incremental (IXFR) zone transfers**: Specifies if Cloudflare sends IXFR requests in addition to the default AXFR requests.\n     * **Link an existing TSIG**: If desired, link the TSIG you [previously created](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/#1-create-tsig-optional).\n\n5. Select **Create**.\n\nTo create a peer DNS server using the API, send a [POST request](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/peers/).\n\n## 3. Create the Secondary Zone\n\nTo create a secondary zone using the dashboard:\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login) and select your account.\n\n2. Select **Onboard a domain**.\n\n3. Enter your zone name and choose **Secondary DNS** (if this option is not available, contact your account team).\n\n4. Select **Continue**.\n\n5. Select your plan type.\n\n6. Choose a value for **Zone refresh**, which controls the number of seconds between zone updates from your primary DNS server.\n\nCloudflare will not use the REFRESH value inside the SOA record that is served by your primary provider. Instead the value of zone refresh configured for your secondary zone on Cloudflare will be used to determine the interval after which the SOA serial of the primary zone will be checked for changes.\n\n7. Select the peer server you [previously created](#2-create-peer-server). If needed, you can link more than one peer server to a zone.\n\nThe maximum number of linked peers per zone is 30.\n\n8. Select **Continue**.\n\n9. Review the list of transferred records and select **Continue**.\n\nIf no records appear, you may have misconfigured the TSIG or the IP address of the peer server or the [Access Control List](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/access-control-lists/cloudflare-ip-addresses/#cloudflare-as-secondary) was improperly configured at your primary DNS provider.\n\n10. Select **Initiate zone transfer**.\n\nTo create a secondary zone using the API, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/zone_transfers/subresources/incoming/methods/create/) request with the `type` parameter set to `\"secondary\"`.\n\n## 4. Update registrar\n\nAt your registrar, add the secondary nameservers [specified in the Cloudflare dashboard](https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/#get-nameserver-names). Do not remove your primary DNS provider's nameservers.\n\nWhen you have added the Cloudflare nameservers, go into your new secondary zone and select **Done, check nameservers**.\n\n## 5. Create notifications (optional)\n\nTo increase the reliability of your incoming zone transfers, [set up notifications](https://developers.cloudflare.com/notifications/get-started/#create-a-notification) to be notified when your primaries are failing, when records are updated, [and more](https://developers.cloudflare.com/notifications/notification-available/#dns).\n\n## 6. Proxy traffic through Cloudflare (optional)\n\nNormal incoming zone transfers only provide DNS resolution. If you also want your traffic to benefit from Cloudflare's performance and security features, you need to [set up Secondary DNS Override](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/).\n\n<page>\n---\ntitle: Proxy traffic with Secondary DNS override · Cloudflare DNS docs\ndescription: When you set up incoming zone transfers on a secondary zone, you\n  cannot enable the proxy on any transferred DNS records by default.\nlastUpdated: 2025-10-23T07:57:47.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/\n  md: https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/proxy-traffic/index.md\n---\n\nWhen you set up [incoming zone transfers](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) on a secondary zone, you cannot enable the proxy on any transferred DNS records by default.\n\nWith Secondary DNS override, you can use Cloudflare as your secondary DNS provider but still get the [performance and security benefits](https://developers.cloudflare.com/fundamentals/concepts/how-cloudflare-works/#cloudflare-as-a-reverse-proxy) of Cloudflare's proxy. Additionally it lets you override any A and AAAA records on your zone apex with a CNAME record.\n\nOnly A, AAAA, and CNAME records can be proxied.\n\nBefore you set up Secondary DNS override, make sure that you have:\n\n* [Set up a secondary DNS zone](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/setup/) and confirmed your DNS records are transferred correctly.\n\n* Set your [DNSSEC with Secondary DNS](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings/) option to either **Unsigned** or **Live Signing**. If set to [Pre-signed](https://developers.cloudflare.com/dns/zone-setups/zone-transfers/cloudflare-as-secondary/dnssec-for-secondary/#set-up-pre-signed-dnssec), Cloudflare will treat all your DNS records as unproxied (DNS only).\n\n* Removed all nameservers from your registrar except for those provided by Cloudflare (highly recommended).\n\nIf you use Secondary DNS override and keep other nameservers at your registrar, DNS responses will be inconsistent across DNS providers, which goes against [official standards](https://www.iana.org/help/nameserver-requirements).\n\n## Set up Secondary DNS override\n\n1. In the Cloudflare dashboard, go to the **DNS Settings** page.\n\n[Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/dns/settings)\n\n2. Enable **Secondary DNS override**.\n\n3. On the [**DNS Records**](https://dash.cloudflare.com/?to=/:account/:zone/dns/records) page, for specific A, AAAA, or CNAME records, select the grey cloud icon to set their **Proxy status** to **Proxied**.\n\n1. To enable Secondary DNS override on a zone, use the following PATCH request:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Zone DNS Settings Write`\n  * `DNS Write`\n\n1. For specific A, AAAA, or CNAME records, send a [POST](https://developers.cloudflare.com/api/resources/dns/subresources/records/methods/create/) request with the `proxied` status as `true`.\n     * Make sure the added record has the same name as the transferred record you intend to proxy. Cloudflare only looks at the name and the proxy status, so the record content does not matter.\n\n## Proxied A and AAAA records\n\nAfter proxying (orange clouding) a Secondary DNS record, any additional records under that hostname transferred from the primary DNS provider are automatically proxied. This applies to all A and AAAA records under that domain.\n\n## CNAME record on the zone apex\n\nYou can also add a CNAME record on the zone apex (supported through [CNAME Flattening](https://developers.cloudflare.com/dns/cname-flattening/)) and either proxy that record or keep it on DNS Only.\n\nOnce you create a CNAME record at the apex, existing A or AAAA records on the zone apex will be deactivated. You can view those deactivated records by clicking **View Inactive Records**. To re-activate the A or AAAA records at the root, remove the CNAME record.\n\n## Verify that your records are proxied\n\nQuery DNS at your assigned Secondary DNS nameserver to confirm the DNS response Cloudflare returns. Records proxied by Cloudflare return [Cloudflare IPs](https://www.cloudflare.com/ips/).\n\n<page>\n---\ntitle: Email Retro Scan · Cloudflare Email security (formerly Area 1) docs\ndescription: Email Retro Scan allows you to scan up to 14 days of old messages\n  in your Office 365 (O365) inboxes and check if your current email security\n  solution missed any threats. Contact your account manager to enable this\n  feature.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/api/setup/email-retro-scan/\n  md: https://developers.cloudflare.com/email-security/deployment/api/setup/email-retro-scan/index.md\n---\n\nEmail Retro Scan allows you to scan up to 14 days of old messages in your Office 365 (O365) inboxes and check if your current email security solution missed any threats. Contact your account manager to enable this feature.\n\nEmail Security (formerly Area 1) supports Microsoft Office 365 Government Community Cloud (GCC). Refer to [Microsoft 365 Government Community Cloud](https://developers.cloudflare.com/email-security/reference/office365-gcc/) for more information.\n\nTo scan for threats in your Office 365 inbox:\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login), and select your account and domain.\n2. Go to **Email security** > **Retro Scan**.\n3. Select **Generate report**.\n4. Cloudflare needs authorization to access your O365 messages. Select **Authenticate with Microsoft**, and give Cloudflare the required permissions.\n5. Back to Cloudflare dashboard, select **Grant mail access**. Then, select your account and give Cloudflare the required permissions.\n6. Select **Grant directory sync access**.\n7. Select your account and give Cloudflare the required permissions.\n8. Select **Continue**.\n9. In **Configure your report**, choose one or more domains to scan.\n10. Under **Scan date range**, select the date range to perform the scan from the drop-down menu.\n11. Choose your current email security system, from **Current email security system**.\n12. Select **Continue**.\n13. Select **Done**. Cloudflare will begin the task of analyzing all your emails for the chosen domains. This might take some time depending on the size of the inbox and number of domains chosen. You do not need to wait for the scan to complete. Cloudflare will send you an email alert when the scan is complete. If you decide to wait, select **View report** when the scan finishes.\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login), and select your account and domain.\n2. Go to **Email security** > **Retro Scan**.\n3. Select **Scan report**. This tab shows the total number of emails scanned, a breakdown of the [threat types](https://developers.cloudflare.com/email-security/reference/dispositions-and-attributes/) found within the domains selected, the [top targeted employees](https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/business-email-compromise/), and the most common places where threats originate from.\n4. To create an offline copy of the threat report, select **Download Report**.\n5. Select **View detections** to inspect emails found by Retro Scan. You can filter emails by threat type (for example, malicious).\n\n<page>\n---\ntitle: Setup phishing risk assessment for Microsoft Exchange with Email Security\n  (formerly Area 1) · Cloudflare Email security (formerly Area 1) docs\ndescription: \"For customers using Microsoft Exchange, setting up Email security\n  via BCC is quick and easy. You need to configure an inbound rule to send\n  emails to Email security via BCC for processing and detection of potential\n  phishing attacks. The following email flow shows how this works:\"\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/api/setup/exchange-bcc-setup/\n  md: https://developers.cloudflare.com/email-security/deployment/api/setup/exchange-bcc-setup/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\nFor customers using Microsoft Exchange, setting up Email security via BCC is quick and easy. You need to configure an inbound rule to send emails to Email security via BCC for processing and detection of potential phishing attacks. The following email flow shows how this works:\n\n![Email flow when setting up a phishing assessment risk for Microsoft Exchange with Email security.](https://developers.cloudflare.com/_astro/bcc-exchange-flow.0rQkIXIG_1AzEWs.webp)\n\n## Configure Inbound Rule\n\n1. Access Exchange's **Management Console**, and go to **Organization Configuration** > **Hub Transport**.\n\n![Access Hub transport](https://developers.cloudflare.com/_astro/step1.Cr53r8C4_Z5ydXG.webp)\n\n2. On the **Actions** pane, select **New Transport Rule**.\n\n3. Give the transport rule a name and a description and select **Next**.\n\n![Give transport rule a name and description](https://developers.cloudflare.com/_astro/step3.Bo-0qS8t_Z2sg8Aj.webp)\n\n4. In the **Condition** configuration panel, select the option **from users that are inside or outside the organization** option. In the dropdown that opens, select **Outside the organization**.\n\n![Select scope of transport rule](https://developers.cloudflare.com/_astro/step4.CxndsEWe_Z2oMkGp.webp)\n\n5. Still in the same **Condition** configuration panel, add a second condition to the transport rule. Select **sent to users that are inside or outside the organization, or partners**. Keep the default value of **Inside the organization**.\n\n![Select where to send emails](https://developers.cloudflare.com/_astro/step5.CFjU-V5M_ZAp0uJ.webp)\n\n7. In the **Action** configuration panel, select **Blind carbon copy (Bcc) the message to addresses**. Edit the **addresses** variable to add the addresses you want to copy as BCC.\n\n![Select BCC and edit email addresses](https://developers.cloudflare.com/_astro/step7.DJeDn5tj_1h2CAV.webp)\n\n8. In **Specify Recipient**, select the **down arrow** next to the **Add** button > **External E-Mail Address**.\n\n![Select external e-mail address](https://developers.cloudflare.com/_astro/step8.D1wRFlWS_Z13foj2.webp)\n\n9. Enter the BCC address provided by Area 1. This address is specific to your account.\n\n![Enter the BCC address provided by Area 1](https://developers.cloudflare.com/_astro/step9.DnJuKcbu_16p1ca.webp)\n\n10. Select **OK** > **OK** to return to the main configuration page of the transport rule.\n\n11. At the main configuration page of the transport rule, select **Next** to continue to the Exception configuration panel.\n\n12. You do not need to configure an exception rule. Select **Next**.\n\n![You do not need to configure an exception rule](https://developers.cloudflare.com/_astro/step12.CubH_6Qs_2atp1F.webp)\n\n13. In **Create Rule**, select the **New** button.\n\n![Select the new button](https://developers.cloudflare.com/_astro/step13.Bk-qDQZk_I2FaW.webp)\n\n14. Select **Finish** to close the transport rule configuration panel. This will return you to the Exchange Management Console.\n\n![Select finish](https://developers.cloudflare.com/_astro/step14.FJuX6pFq_1KjQwl.webp)\n\nIf you have multiple rules, you may need to change the order of the BCC rule and move it to the right location in your rule sequence. This is needed so you can send BCC messages to Email security (formerly Area 1). Usually, the Email security BCC rule will be at the top of the ruleset. The configured conditions of the Email security BCC rule will only trigger for inbound messages.\n\n## Email processing and reports\n\nIn BCC mode, all emails are put through automated phishing detections by Email security. Emails that trigger phishing detections are logged for reporting via product portal, email and Slack. Emails that do not trigger any detections are deleted.\n\n<page>\n---\ntitle: Setup Gmail with Email security (formerly Area 1) · Cloudflare Email\n  security (formerly Area 1) docs\ndescription: \"For customers using Gmail, setting up Email security via BCC is\n  quick and easy. All you need to do is create a content compliance filter to\n  send emails to Email security through BCC. The following email flow shows how\n  this works:\"\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/\n  md: https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\nFor customers using Gmail, setting up Email security via BCC is quick and easy. All you need to do is create a content compliance filter to send emails to Email security through BCC. The following email flow shows how this works:\n\n![Email flow when setting up a phishing assessment risk for Gmail with Email security.](https://developers.cloudflare.com/_astro/gmail-bcc-flow.CbpHVmdE_Z10qL1c.webp)\n\nTo set up Gmail with Email security:\n\n1. [Find your BCC address and add a domain](https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/add-domain/).\n2. [Add BCC rules](https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/bcc-rules-to-area1/).\n3. [Create a project on Google Cloud Console](https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/create-project-gcp/).\n4. [Create a service account](https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/create-service-account/).\n5. [Add retraction](https://developers.cloudflare.com/email-security/deployment/api/setup/gsuite-bcc-setup/add-retraction/).\n\n<page>\n---\ntitle: Office 365 Graph API setup · Cloudflare Email security (formerly Area 1) docs\ndescription: Learn how to scan and protect Office 365 emails with Email security\n  (formerly Area 1) via a Microsoft Graph API setup.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/api/setup/office365-graph-api/\n  md: https://developers.cloudflare.com/email-security/deployment/api/setup/office365-graph-api/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\nFor customers using Microsoft Office 365, setting up Email security via Microsoft Graph API is quick and easy. The following email flow shows how this works:\n\n![Email flow when setting up Email security with the Microsoft Graph API](https://developers.cloudflare.com/_astro/ms-graph.BO5Mv0lT_1RFh6u.webp)\n\nEmail Security (formerly Area 1) supports Microsoft Office 365 Government Community Cloud (GCC). Refer to [Microsoft 365 Government Community Cloud](https://developers.cloudflare.com/email-security/reference/office365-gcc/) for more information.\n\nEmail security uses two roles for retraction and directory integration purposes:\n\n* **Privileged authentication administrator**: Users with this role can view the current authentication method information and set or reset non-password credentials for all users, including global administrators. Privileged authentication administrators can force users to re-register against existing non-password credentials (like MFA or FIDO) and revoke the `remember MFA on the device` message prompting for MFA on the next login of all users.\n* **Privileged role administrator**: Users with this role can manage role assignments in Azure Active Directory, as well as within Privileged Identity Management. In addition, this role allows management of all aspects of Privileged Identity Management.\n\nDirectory Integration requires the use of both roles mentioned above. Email retraction only requires the **Privileged role administrator**. Any Azure administrator with a membership in the required role can perform these authorizations. The authorization process grants the Email security dashboard access to the Azure environment. This access is performed with the least applicable privileges required to function, as shown in the [table below](#azure-applications).\n\nThe Enterprise Applications that Email security registers are not tied to any administrator account. Inside of the Azure Active Directory admin center you can review the permissions granted to each application in the Enterprise Application section. Refer to [Application management documentation](https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/) for more information.\n\n## Set up Microsoft Graph API\n\n1. Log in to the [Email security dashboard](https://horizon.area1security.com/).\n\n2. Go to **Settings** (the gear icon).\n\n3. In **Email Configuration** > **Domains & Routing** > **Domains**, select **New Domain**.\n\n4. In **Domain**, enter the domain you want to onboard.\n\n5. In **Authorize Mail Access**, select **Authorize Access**.\n\n![Select Authorize access to give the correct permissions to Email security](https://developers.cloudflare.com/_astro/step5.DCb-P1xf_Z2qyrRg.webp)\n\n6. In the new tab that opens, choose an Office 365 account you want to authorize, or enter your credentials.\n\n7. Read the permissions, and select **Accept** to continue. You will be directed back to the Email security dashboard.\n\n8. In **Directory Scanning**, select **Authorize Access**.\n\n9. In the new tab that opens, choose an Office 365 account you want to authorize, or enter your credentials.\n\n10. Read the permissions, and select **Accept** to continue. You will be directed back to the Email security dashboard.\n\n11. In **Protection Scope**, choose if Email security should scan only the inbox or all folders. Scanning all folders is useful for situations where the email is automatically routed to other folders that users still have access to:\n\n1. **Protect Inbox only**: Email security will only scan the user's inbox.\n    2. **Protect all folders**: Email security will scan all non-hidden email folders.\n\n12. Now that both types of authorizations have been complete, select **Publish Domain**.\n\nYour authorized domain will show up in **Email Configuration** > **Domains & Routing** > **Domains**, with messages about the progress of directory syncing between Office 365 and Email security.\n\n![Now that both authorizations are complete, select Publish domain](https://developers.cloudflare.com/_astro/domain-sync-state.C1Rlg1tg_Z2qcfQU.webp)\n\n## Azure applications\n\n### Directory Integration\n\nThe following table shows API permissions required for Directory Integration as it appears in Azure Enterprise applications.\n\nThe following table shows retractions as they appear in Azure Enterprise applications.\n\n<page>\n---\ntitle: Setup phishing risk assessment for Office 365 with Email security\n  (formerly Area 1) · Cloudflare Email security (formerly Area 1) docs\ndescription: \"For customers using Microsoft Office 365, setting up Email\n  security via journaling is quick and easy. The following email flow shows how\n  this works:\"\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/api/setup/office365-journaling/\n  md: https://developers.cloudflare.com/email-security/deployment/api/setup/office365-journaling/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\nFor customers using Microsoft Office 365, setting up Email security via journaling is quick and easy. The following email flow shows how this works:\n\n![Email flow when setting up a phishing assessment risk for Office 365 with Email security.](https://developers.cloudflare.com/_astro/office365-journaling-flow.rlt8bVLi_ZaIAc8.webp)\n\nEmail Security (formerly Area 1) supports Microsoft Office 365 Government Community Cloud (GCC). Refer to [Microsoft 365 Government Community Cloud](https://developers.cloudflare.com/email-security/reference/office365-gcc/) for more information.\n\n### 1. Configure connector for delivery to Email security (formerly Area 1) (if required)\n\nEmail security only scans inbound emails.\n\nIf your email architecture does not include an outbound gateway, you can skip this step and [proceed to the next one](#2-configure-journal-rule).\n\nOn the other hand, if your email architecture requires outbound messages to traverse your email gateway, you may want to consider configuring a connector to send the journal messages directly to Email security.\n\n1. Log in to the [Exchange admin center](https://admin.exchange.microsoft.com), and go to **Mail flow** > **Connectors**.\n\n![Go to the connectors area](https://developers.cloudflare.com/_astro/step1-connector.GHhUwTxU_1f5oSg.webp)\n\n2. Select **Add a connector**.\n\n3. Configure the new connector as follows:\n\n* **Connection From**: Office 365\n   * **Connection to**: Partner Organization\n\n![Configure the connector](https://developers.cloudflare.com/_astro/step3-configure-connector.RocOY8nI_Z1vCf79.webp)\n\n5. Configure the connector as follows:\n\n* **Name**: `Deliver journal directly to Area 1`\n   * **Description**: `Deliver journal directly to Area 1`\n   * **Turn it on**: Enabled.\n\n![Name the connector and give it a description](https://developers.cloudflare.com/_astro/step5-name-connector.DNWbIeO__idrD1.webp)\n\n7. Configure the **Use of connector** setting as follows:\n\n* Select **Only when email messages are sent to these domains**.\n   * In the text field, enter `journaling.mxrecord.io` as the host address, and select **+** to add the domain.\n\n![Configure use of connector](https://developers.cloudflare.com/_astro/step7-use-of-connector.PKXxl3_L_13GqTt.webp)\n\n9. Configure the **Routing** setting as follows:\n\n* Select **Route email through these smart hosts**.\n   * In the text field, enter `journaling.mxrecord.io` as the [smart host](https://en.wikipedia.org/wiki/Smart_host) address, and select **+** to add the domain.\n\n![Configure the routing setting](https://developers.cloudflare.com/_astro/step9-routing.CavgMOZT_Z261WIc.webp)\n\n11. In **Security restrictions**, you need to keep the default TLS configuration. Review the following settings:\n\n* Make sure the **Always use Transport Layer Security (TLS) to secure the connection (recommended)** checkbox is selected.\n    * In **Connect only if the recipients email server certificate matches this criteria** select **Issued by a trusted certificate authority (CA)**.\n\n![Configure security restrictions](https://developers.cloudflare.com/_astro/step11-security.DeBlzdPS_1PMLgw.webp)\n\n13. You need to validate the connector by using your tenant’s specific journaling address. To find this address, go to the [Email security dashboard](https://horizon.area1security.com/support/service-addresses) > **Support** > **Service Addresses page**.\n\n![Validate the connector](https://developers.cloudflare.com/_astro/step13-validate-email.BJ8ELGKR_1NIABs.webp)\n\n14. Add the address and select **Validate**.\n\n15. Once the validation completes, you should receive a **Succeed** status for all the tasks. Select **Next**.\n\n![Validation success if all goes well](https://developers.cloudflare.com/_astro/step15-validation-success.C5eGCdwd_2kOP8t.webp)\n\n16. Review the configuration and select **Create connector**.\n\n![Review your connector](https://developers.cloudflare.com/_astro/step16-review-connector.BrDPEYnr_Zh1Unp.webp)\n\nYour connector is now active. You can find it in **Exchange admin center** > **Mail flow** > **Connectors**.\n\n![Connector active](https://developers.cloudflare.com/_astro/connector-active.CSWoF3B__Z1IraTj.webp)\n\n### 2. Configure journal rule\n\n1. Log in to the [Microsoft Purview compliance portal](https://compliance.microsoft.com/homepage).\n\n2. Go to **Data lifecycle management** > **Exchange (legacy)**.\n\n3. Select **Settings** (the gear icon).\n\n4. In **Send undeliverable journal reports to** enter the email address of a valid user account. Note that you cannot use a team or group address.\n\n![Configure undeliverable emails](https://developers.cloudflare.com/_astro/step4-undeliverable.BIHyokWn_1uokha.webp)\n\n6. Still in the Exchange (legacy) screen, select **Journal Rules**.\n\n![Select journal rules](https://developers.cloudflare.com/_astro/step6-journal-rules.C9jnQb2-_2n0CP6.webp)\n\n7. Select **New rule** to configure a journaling rule, and configure it as follows:\n\n* **Send journal reports to**: This address is specific to each customer tenant, and can be found in your [Email security dashboard](https://horizon.area1security.com/support/service-addresses). For example, `<customer_name>@journaling.mxrecord.io`.\n   * **Journal Rule Name**: `Journal Messages to CloudflareArea 1`\n   * **Journal messages sent or received from**: *Everyone*\n   * **Type of message to journal**: *External messages only*\n\n9. Verify the information is correct, and select **Submit** > **Done**.\n\n![Verify the journal rule information](https://developers.cloudflare.com/_astro/step9-verify-journal-rules.CX-hBGCL_xtr37.webp)\n\nOnce saved, the rule is automatically active. However, it may take a few minutes for the configuration to propagate and start pushing messages to Cloudflare Email security. After it propagates, you can access the Cloudflare Email security dashboard to check the number of messages processed. This number will grow as journaled messages are sent to Cloudflare Email security from your Exchange server.\n\n#### Create Office 365 distribution lists\n\nFor compliance purposes, you might be required to process emails in certain geographic regions such as India or the EU. If that is your case, you should [create Office 365 distribution lists](https://learn.microsoft.com/en-us/microsoft-365/admin/setup/create-distribution-lists?view=o365-worldwide#create-a-distribution-group-list) for each geographic region where you need to process your emails, before configuring your journal rule.\n\n#### Configure journal rule\n\nAfter creating the distribution lists based on regions for your users, configure your journal rule:\n\n1. Log in to the [Microsoft Purview compliance portal](https://compliance.microsoft.com/homepage).\n\n2. Go to **Data lifecycle management** > **Exchange (legacy)**.\n\n3. Select **Settings** (the gear icon).\n\n4. In **Send undeliverable journal reports to** enter the email address of a valid user account. Note that you cannot use a team or group address.\n\n![Configure undeliverable emails](https://developers.cloudflare.com/_astro/step4-undeliverable.BIHyokWn_1uokha.webp)\n\n6. Still in the Exchange (legacy) screen, select **Journal Rules**.\n\n![Select journal rules](https://developers.cloudflare.com/_astro/step6-journal-rules.C9jnQb2-_2n0CP6.webp)\n\n7. Select **New rule** to configure a journaling rule, and configure it as follows:\n\n* **Send journal reports to**: This address is specific to each customer tenant, and can be found in your [Email security dashboard](https://horizon.area1security.com/support/service-addresses). If you need to process emails in certain geographic regions, refer to the [Geographic locations](#geographic-locations) table for more information on what address you should use.\n   * **Journal Rule Name**: `Journal Messages to CloudflareArea 1`\n   * **Journal messages sent or received from**: *A specific user or group* and select the user group you [created above](#3-compliance).\n   * **Type of message to journal**: *External messages only*\n\n9. Verify the information is correct, and select **Submit** > **Done**.\n\n![Verify the journal rule information](https://developers.cloudflare.com/_astro/step9-verify-journal-rules.CX-hBGCL_xtr37.webp)\n\nOnce saved, the rule is automatically active. However, it may take a few minutes for the configuration to propagate and start pushing messages to Cloudflare Email security. After it propagates, you can access the Cloudflare Email security dashboard to check the number of messages processed. This number will grow as journaled messages are sent to Cloudflare Email security from your Exchange server.\n\n## Geographic locations\n\nSelect from the following BCC addresses to process email in the correct geographic location.\n\n| Host | Location | Note |\n| - | - | - |\n| `<customer_name>@journaling.mxrecord.io` | US | Best option to ensure all email traffic processing happens US data centers. |\n| `<customer_name>@journaling.mailstream-eu-primary.mxrecord.io` | EU | Best option to ensure all email traffic processing happens in Germany, with backup to US data centers. |\n| `<customer_name>@journaling.mailstream-eu1.mxrecord.io` | EU | Best option to ensure all email traffic processing happens within the EU without backup to US data centers. |\n| `<customer_name>@journaling.mailstream-bom.mxrecord.mx` | India | Best option to ensure all email traffic processing happens within India. |\n| `<customer_name>@journaling.mailstream-india-primary.mxrecord.mx` | India | Same as `mailstream-bom.mxrecord.mx`, with backup to US data centers. |\n| `<customer_name>@journaling.mailstream-asia.mxrecord.mx` | India | Best option to ensure all email traffic processing happens in India, with Australia data centers as backup. |\n| `<customer_name>@journaling.mailstream-syd.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens within Australia. |\n| `<customer_name>@journaling.mailstream-australia.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens in Australia, with India and US data centers as backup. |\n\n<page>\n---\ntitle: Egress IPs · Cloudflare Email security (formerly Area 1) docs\ndescription: When you set up Email security (formerly Area 1) using an inline\n  deployment, you need to tell your existing email providers to accept messages\n  coming from Email security's egress IP addresses.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/\n  md: https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/index.md\n---\n\nWhen you set up Email security (formerly Area 1) using an [inline deployment](https://developers.cloudflare.com/email-security/deployment/inline/), you need to tell your existing email providers to accept messages coming from Email security's egress IP addresses.\n\nRefer to this page for reference on what IP subnet mask ranges to use.\n\nAdditional information for O365\n\nOffice 365 does not support IPv6 addresses nor the following IPv4 subnet mask ranges:\n\n* `104.30.32.0/19`\n* `134.195.26.0/23`\n\nIf you use Office 365, you will have to use the broken down `/24` subnet mask IP addresses. Refer to [Office 365 `/24` addresses](#office-365-24-addresses) for a list of supported IPv4 addresses.\n\nFor customers in the United States, enter the following IP addresses:\n\nFor customers in Europe, add all our US IP addresses. Additionally, you need to add the following IP addresses for our European data centers:\n\nFor customers in India, add all our US IP addresses.\n\n## Australia / New Zealand\n\nFor customers in Australia and New Zealand, add all our US IP addresses.\n\n## Office 365 `/24` addresses\n\nUse these IPv4 addresses for Office 365, instead of the `/19` and `/23` subnets:\n\n<page>\n---\ntitle: Deploy and configure Cisco IronPort with Email security (formerly Area 1)\n  as MX Record · Cloudflare Email security (formerly Area 1) docs\ndescription: In this tutorial, you will learn how to configure Cisco IronPort\n  with Email security as MX record. This tutorial is broken down into several\n  steps.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/inline/setup/cisco-area1-mx/\n  md: https://developers.cloudflare.com/email-security/deployment/inline/setup/cisco-area1-mx/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\n![A schematic showing where Email security security is in the life cycle of an email received](https://developers.cloudflare.com/_astro/cisco-area1-mx.OaAYsQTw_QwQGX.webp)\n\nIn this tutorial, you will learn how to configure Cisco IronPort with Email security as MX record. This tutorial is broken down into several steps.\n\nTo ensure changes made in this tutorial take effect quickly, update the Time to Live (TTL) value of the existing MX records on your domains to five minutes. Do this on all the domains you will be deploying.\n\nChanging the TTL value instructs DNS servers on how long to cache this value before requesting an update from the responsible nameserver. You need to change the TTL value before changing your MX records to Cloudflare Email Security (formerly Area 1). This will ensure that changes take effect quickly and can also be reverted quickly if needed. If your DNS manager does not allow for a TTL of five minutes, set it to the lowest possible setting.\n\nTo check your existing TTL, open a terminal window and run the following command against your domain:\n\nIn the above example, TTL is shown in seconds as `300` (or five minutes).\n\nIf you are using Cloudflare for DNS, you can leave the [TTL setting as **Auto**](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/).\n\nBelow is a list with instructions on how to edit MX records for some popular services:\n\n* **Cloudflare**: [Set up email records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/)\n* **GoDaddy**: [Edit an MX Record](https://www.godaddy.com/help/edit-an-mx-record-19235)\n* **AWS**: [Creating records by using the Amazon Route 53 console](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html)\n* **Azure**: [Create DNS records in a custom domain for a web app](https://learn.microsoft.com/en-us/azure/dns/dns-web-sites-custom-domain)\n\n## 1. Add a Sender Group for Email security Email Protection IPs\n\nTo add a new Sender Group:\n\n1. Go to **Mail Policies** > **HAT Overview**.\n\n2. Select **Add Sender Group**.\n\n3. Configure the new Sender Group as follows:\n\n* **Name**: `Area1`.\n   * **Order**: Order above the existing **WHITELIST** sender group.\n   * **Comment**: `Area 1 Email Protection egress IP Addresses`.\n   * **Policy**: `TRUSTED` (by default, spam detection is disabled for this mail flow policy).\n   * **SBRS**: Leave blank.\n   * **DNS Lists**: Leave blank.\n   * **Connecting Host DNS Verification**: Leave all options unchecked.\n\n4. Select **Submit and Add Senders** and add the IP addresses mentioned in [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/).\n\n![Sender group](https://developers.cloudflare.com/_astro/step1.DXTfpSGb_Z2oESHO.webp)\n\n## 2. Configure Incoming Relays\n\nYou need to configure the Incoming Relays section to tell IronPort to ignore upstream hops, since all the connections are now coming from Email security. This step is needed so the IronPort can retrieve the original IPs to calculate IP reputation. IronPort also uses this information in the Anti-Spam (IPAS) scoring of messages.\n\n1. To enable the Incoming Relays Feature, select **Network** > **Incoming Relays**.\n2. Select **Enable** and commit your changes.\n3. Now, you will have to add an Incoming Relay. Select **Network** > **Incoming Relays**.\n4. Select **Add Relay** and give your relay a name.\n5. Enter the IP address of the MTA, MX, or other machine that connects to the email gateway to relay incoming messages. You can use IPv4 or IPv6 addresses.\n6. Specify the `Received:` header that will identify the IP address of the original external sender.\n7. Commit your changes.\n\n## 3. Disable SPF checks\n\nMake sure you disable Sender Policy Framework (SPF) checks in IronPort. Because Email security is acting as the MX record, if you do not disable SPF checks, IronPort will block emails due to an SPF failure.\n\nRefer to [Cisco's documentation](https://www.cisco.com/c/en/us/support/docs/security/email-security-appliance/117973-faq-esa-00.html) for more information on how to disable SPF checks.\n\n## 4. Update your domain MX records\n\nInstructions to update your MX records will depend on the DNS provider you are using. In your domain DNS zone, you need to replace your current MX records with the Email security hosts. This will have to be done for every domain where Email security will be the primary MX. For example:\n\n| MX Priority | Host |\n| - | - |\n| `5` | `mailstream-eu1.mxrecord.io` |\n| `10` | `mailstream-central.mxrecord.mx` |\n| `20` | `mailstream-east.mxrecord.io` |\n| `20` | `mailstream-west.mxrecord.io` |\n\nWhen configuring the Email Security (formerly Area 1) MX records, it is important to configure hosts with the correct MX priority. This will allow mail flows to the preferred hosts and fail over as needed.\n\nChoose from the following Email Security MX hosts, and order them by priority. For example, if you are located outside the US and want to prioritize email processing in the EU, add `mailstream-eu1.mxrecord.io` as your first host, and then the US servers.\n\n| Host | Location | Note |\n| - | - | - |\n| | US | Best option to ensure all email traffic processing happens in the US. |\n| `mailstream-eu1.mxrecord.io` | EU | Best option to ensure all email traffic processing happens in Germany, with backup to US data centers. |\n| `mailstream-bom.mxrecord.mx` | India | Best option to ensure all email traffic processing happens within India. |\n| `mailstream-india-primary.mxrecord.mx` | India | Same as `mailstream-bom.mxrecord.mx`, with backup to US data centers. |\n| `mailstream-asia.mxrecord.mx` | India | Best option to ensure all email traffic processing happens in India, with Australia data centers as backup. |\n| `mailstream-syd.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens within Australia. |\n| `mailstream-australia-primary.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens in Australia, with India and US data centers as backup. |\n\nDNS changes will reach the major DNS servers in about an hour or follow the TTL value as described in the [Prerequisites section](#prerequisites).\n\n<page>\n---\ntitle: Deploy and configure Email security (formerly Area 1) with with Cisco as\n  MX record · Cloudflare Email security (formerly Area 1) docs\ndescription: In this tutorial, you will learn how to configure Email security\n  with Cisco as MX record. This tutorial is broken down into several steps.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/inline/setup/cisco-cisco-mx/\n  md: https://developers.cloudflare.com/email-security/deployment/inline/setup/cisco-cisco-mx/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\n![A schematic showing where Email security is in the life cycle of an email received](https://developers.cloudflare.com/_astro/cisco-mx.CUUww6p5_Z11qukx.webp)\n\nIn this tutorial, you will learn how to configure Email security with Cisco as MX record. This tutorial is broken down into several steps.\n\n## 1. Add a Sender Group for Email security Email Protection IPs\n\nTo add a new Sender Group:\n\n1. Go to **Mail Policies** > **HAT Overview**.\n\n2. Select the **Add Sender Group** button.\n\n3. Configure the new Sender Group as follows:\n\n* **Name**: `Area1`.\n   * **Order**: Order above the existing **WHITELIST** sender group.\n   * **Comment**: `Email security Email Protection egress IP Addresses`.\n   * **Policy**: `TRUSTED` (by default, spam detection is disabled for this mail flow policy).\n   * **SBRS**: Leave blank.\n   * **DNS Lists**: Leave blank.\n   * **Connecting Host DNS Verification**: Leave all options unchecked.\n\n4. Select **Submit and Add Senders**, and add the IP addresses mentioned in [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/). If you need to process emails in the EU or India regions for compliance purposes, add those IP addresses as well.\n\n![Sender group](https://developers.cloudflare.com/_astro/step1.DXTfpSGb_Z2oESHO.webp)\n\n## 2. Add SMTP route for the Email security Email Protection Hosts\n\nTo add a new SMTP Route:\n\n1. Go to **Network** > **SMTP Routes**.\n\n2. Select **Add Route**.\n\n3. Configure the new SMTP Route as follows:\n\n* **Receiving Domain**: `a1s.mailstream`\n   * In **Destination Hosts**, select **Add Row**, and add the Email security MX hosts. Refer to the [Geographic locations](#5-geographic-locations) table for more information on what MX hosts to use.\n\n![Edit SMTP route](https://developers.cloudflare.com/_astro/step2.CI8fF8qw_1SxSz7.webp)\n\n## 3. Create Incoming Content Filters\n\nTo manage the mail flow between Email security and Cisco ESA, you need two filters:\n\n* One to direct all incoming messages to Email security.\n* One to recognize messages coming back from Email security to route for normal delivery.\n\n### Incoming Content Filter - To Email security\n\nTo create a new Content Filter:\n\n1. Go to **Mail Policies** > **Incoming Content Filters**.\n\n2. Select **Add Filter** to create a new filter.\n\n3. Configure the new Incoming Content Filter as follows:\n\n* **Name**: `ESA_to_A1S`\n\n* **Description**: `Redirect messages to Email security for anti-phishing inspection`\n\n* **Order**: This will depend on your other filters.\n\n* **Condition**: No conditions.\n\n* For **Action** select **Send to Alternate Destination Host**.\n     * For **Mail Host** input `a1s.mailstream` (the SMTP route configured in step 2).\n\n![Content filter](https://developers.cloudflare.com/_astro/step3-to-area1.gKCbmtPN_Z2qedy3.webp)\n\n### Incoming Content Filter - From Email security\n\nTo create a new Content Filter:\n\n1. Go to **Mail Policies** > **Incoming Content Filters**.\n\n2. Select the **Add Filter** button to create a new filter.\n\n3. Configure the new Incoming Content Filter as follows:\n\n* **Name**: `A1S_to_ESA`\n   * **Description**: `Email security inspected messages for final delivery`\n   * **Order**: This filter must come before the previously created filter.\n   * **Conditions**: Add conditions of type **Remote IP/Hostname** with all the IP addresses mentioned in [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/). For example:\n\n| Order | Condition | Rule |\n   | - | - | - |\n   | `1` | `Remote IP/Hostname` | `Remote IP/Hostname` |\n   | `2` | `Remote IP/Hostname` | `52.89.255.11` |\n   | `3` | `Remote IP/Hostname` | `52.0.67.109` |\n   | `4` | `Remote IP/Hostname` | `54.173.50.115` |\n   | `5` | `Remote IP/Hostname` | `104.30.32.0/19` |\n   | `6` | `Remote IP/Hostname` | `158.51.64.0/26` |\n   | `7` | `Remote IP/Hostname` | `158.51.65.0/26` |\n\n* Ensure that the *Apply rule:* dropdown is set to **If one or more conditions match**.\n\n* **Actions**: Select **Add Action**, and add the following:\n\n| Order | Action | Rule |\n     | - | - | - |\n     | --1 | `Skip Remaining Content Filters (Final Action)` | `skip-filters()` |\n\n![Content filter](https://developers.cloudflare.com/_astro/step3-from-area1.Boxw-o5P_1fdtIk.webp)\n\n## 4. Add the Incoming Content Filter to the Inbound Policy table\n\nAssign the Incoming Content Filters created in [step 3](#3-create-incoming-content-filters) to your primary mail policy in the Incoming Mail Policy table. Then, commit your changes to activate the email redirection.\n\n## 5. Geographic locations\n\nWhen configuring the Email Security (formerly Area 1) MX records, it is important to configure hosts with the correct MX priority. This will allow mail flows to the preferred hosts and fail over as needed.\n\nChoose from the following Email Security MX hosts, and order them by priority. For example, if you are located outside the US and want to prioritize email processing in the EU, add `mailstream-eu1.mxrecord.io` as your first host, and then the US servers.\n\n| Host | Location | Note |\n| - | - | - |\n| | US | Best option to ensure all email traffic processing happens in the US. |\n| `mailstream-eu1.mxrecord.io` | EU | Best option to ensure all email traffic processing happens in Germany, with backup to US data centers. |\n| `mailstream-bom.mxrecord.mx` | India | Best option to ensure all email traffic processing happens within India. |\n| `mailstream-india-primary.mxrecord.mx` | India | Same as `mailstream-bom.mxrecord.mx`, with backup to US data centers. |\n| `mailstream-asia.mxrecord.mx` | India | Best option to ensure all email traffic processing happens in India, with Australia data centers as backup. |\n| `mailstream-syd.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens within Australia. |\n| `mailstream-australia-primary.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens in Australia, with India and US data centers as backup. |\n\n<page>\n---\ntitle: Deploy and configure Google Workspace with Email security (formerly Area\n  1) as MX Record · Cloudflare Email security (formerly Area 1) docs\ndescription: In this tutorial, you will learn how to configure Google Workspace\n  with Email security as MX record. This tutorial is broken down into several\n  steps.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/inline/setup/gsuite-area1-mx/\n  md: https://developers.cloudflare.com/email-security/deployment/inline/setup/gsuite-area1-mx/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\n![A schematic showing where Email security is in the life cycle of an email received](https://developers.cloudflare.com/_astro/gsuite-area1-mx.CQEikhes_uu3vd.webp)\n\nIn this tutorial, you will learn how to configure Google Workspace with Email security as MX record. This tutorial is broken down into several steps.\n\nEmail Security (formerly Area 1) does not currently manage outbound email. If you intend to remove other existing services that manage outbound email, you will have to plan accordingly on migrating outbound functions back to your email services (such as Office 365 / Google Workspace).\n\n* Provisioned Email security account.\n* Access to the Google administrator console ([**Google administrator console**](https://admin.google.com) > **Apps** > **Google Workspace** > **Gmail**).\n* Access to the domain nameserver hosting the MX records for the domains that will be processed by Email security.\n\nTo ensure changes made in this tutorial take effect quickly, update the Time to Live (TTL) value of the existing MX records on your domains to five minutes. Do this on all the domains you will be deploying.\n\nChanging the TTL value instructs DNS servers on how long to cache this value before requesting an update from the responsible nameserver. You need to change the TTL value before changing your MX records to Cloudflare Email Security (formerly Area 1). This will ensure that changes take effect quickly and can also be reverted quickly if needed. If your DNS manager does not allow for a TTL of five minutes, set it to the lowest possible setting.\n\nTo check your existing TTL, open a terminal window and run the following command against your domain:\n\nIn the above example, TTL is shown in seconds as `300` (or five minutes).\n\nIf you are using Cloudflare for DNS, you can leave the [TTL setting as **Auto**](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/).\n\nBelow is a list with instructions on how to edit MX records for some popular services:\n\n* **Cloudflare**: [Set up email records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/)\n* **GoDaddy**: [Edit an MX Record](https://www.godaddy.com/help/edit-an-mx-record-19235)\n* **AWS**: [Creating records by using the Amazon Route 53 console](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html)\n* **Azure**: [Create DNS records in a custom domain for a web app](https://learn.microsoft.com/en-us/azure/dns/dns-web-sites-custom-domain)\n\n## 1. Add Email security IP addresses to the Inbound gateway configuration\n\nWhen Email security is deployed as the MX record for Google Workspace, the Inbound gateway needs to be configured such that Google Workspace is aware that it is no longer the MX record for the domain. This is a critical step as it will allow Google Workspace to accept messages from Email security.\n\n1. Go to the [Google Administrative Console](https://admin.google.com/).\n\n2. Go to **Apps** > **Google Workspace** > **Gmail**.\n\n![Access Gmail](https://developers.cloudflare.com/_astro/step2-gmail.D8N71eim_ZBe3Am.webp)\n\n3. Select **Spam, Phishing, and Malware** and scroll to **Inbound Gateway configuration**.\n\n![Access the spam, phishing and malware setting](https://developers.cloudflare.com/_astro/step3-spam.TRV_ctWA_2awhMk.webp)\n\n4. Enable **Inbound Gateway**, and configure it with the following details:\n\n![Enable inbound gateway](https://developers.cloudflare.com/_astro/step4-inbound-gateway.DwLu0Jgk_Zsksf2.webp)\n\n* In **Gateway IPs**, select the **Add** link, and add the IPs mentioned in [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/).\n   * Select **Automatically detect external IP (recommended)**.\n   * Select **Require TLS for connections from the email gateways listed above**.\n\n![Inbound gateway settings](https://developers.cloudflare.com/_astro/step4-inbound-gateway-settings.UnL9joHq_14gWw8.webp)\n\nDo not select **Reject all mail not from gateway IPs** until the MX records have fully propagated. [Refer to step 5](#5-secure-your-email-flow) for more details.\n\n1. Select the **Save** button at the bottom of the dialog box to save the configuration once the details have been entered. Once saved, the administrator console will show the Inbound Gateway as **enabled**.\n\n![Inbound gateway on](https://developers.cloudflare.com/_astro/step5-inbound-on.DPCrYf9H_ZhpDon.webp)\n\n## 2. Quarantine malicious detections\n\nThis optional step is highly recommended to prevent users from being exposed to malicious messages.\n\nWhen messages are identified as malicious, Email security will insert the X-header `X-Area1Security-Disposition` into the message with the corresponding disposition. Based on the value of the `X-Area1Security-Disposition`, a content compliance filter can be configured to send malicious detections to an administrative quarantine. This section will outline the steps required to:\n\n* Create an Email security Malicious quarantine.\n* Create the content compliance filter to send malicious messages to quarantine.\n\n### Create Email security Malicious Quarantine\n\nIf you would like to send Email security malicious detection to a separate quarantine other than the default quarantine, you will need to create a new quarantine.\n\n1. In [Google's administrative console](https://admin.google.com), select the **Manage quarantines** panel.\n\n![Select the manage quarantines panel](https://developers.cloudflare.com/_astro/step1-manage-quarantines.Kq6I6Yor_ZGNQRi.webp)\n\n2. Select **ADD QUARANTINE** to configure the new quarantine. This will bring up a pop-up for the configuration details.\n\n![Select the add quarantine button](https://developers.cloudflare.com/_astro/step2-add-quarantine.CVZq1ipO_Z1NvOUf.webp)\n\n3. In the quarantine configuration pop-up, enter the following:\n\n* **Name**: `Email security Malicious`.\n   * **Description**: `Email security Malicious`.\n   * For the **Inbound denial consequence**, select **Drop Message**.\n   * For the **Outbound denial consequence**, select **Drop Message**.\n\n![Configure the quarantine settings](https://developers.cloudflare.com/_astro/step3-configure-quarantine.Bd4Dhxyp_Z1HQEg4.webp)\n\nWhen you are finished entering these details, select **SAVE**.\n\n1. To access the newly create quarantine, select **GO TO ADMIN QUARANTINE** or access the quarantine directly by pointing your browser to <https://email-quarantine.google.com/adminreview>.\n\n![Access the quarantine created](https://developers.cloudflare.com/_astro/step4-access-quarantine.xZBJkpYu_1xhTUR.webp)\n\nOnce in the Admin quarantine console, you can access the **Email security Malicious** quarantine by selecting **Quarantine:ALL** > **Email security Malicious** in the filter section. Quarantined messages can be released as needed by an administrator.\n\n![Access Email security](https://developers.cloudflare.com/_astro/step4-area1.dpzSbYUX_1pLQtg.webp)\n\n### Create a content compliance filter to send malicious messages to quarantine\n\n1. In [Google's administrative console](https://admin.google.com), select **Compliance** to configure the content compliance filter.\n\n![Access the compliance configuration](https://developers.cloudflare.com/_astro/step1-compliance.t3TUTyHx_ZiONwp.webp)\n\n2. Go to the **Content compliance** area and select **CONFIGURE** to open the configuration dialog pop-up.\n\n![Select the configure button](https://developers.cloudflare.com/_astro/step2-configure.CLciz-bk_ZxsApU.webp)\n\n3. In the **Content compliance filter** configuration, enter the following:\n\n* **Name**: `Quarantine Email security Malicious`.\n\n* In **1. Email message to affect**, select **Inbound**.\n\n* In **2. Add expression that describe the content you want to search for in each message**:\n\n* Select **Add** to add the condition.\n\n* In the *Simple content match* dropdown, select **Advanced content match**.\n       * In **Location**, select **Full headers**.\n       * In **Match type**, select **Contains text**.\n       * In **Content**, enter `X-Area1Security-Disposition: MALICIOUS`.\n\n* Select **SAVE** to save the condition.\n\n* In **3. If the above expression match, do the following**, select the *Action* dropdown. Then choose **Quarantine message** and the **Email security Malicious** quarantine that was created in the previous step.\n\n![Configure the compliance filter](https://developers.cloudflare.com/_astro/step3-compliance-filter.ChHR2c1N_Z2pOIiy.webp)\n\nAfter you enter this information, select **SAVE**.\n\n4. Once saved, the console will update with the newly configured **content compliance filter**.\n\n![After configuration, the console shows the content compliance filter](https://developers.cloudflare.com/_astro/step4-compliance-filter.CXywFHVJ_iXYCT.webp)\n\nIf you would like to quarantine the other dispositions, repeat the above steps and use the following strings for the other dispositions:\n\n* `X-Area1Security-Disposition: MALICIOUS`\n   * `X-Area1Security-Disposition: SUSPICIOUS`\n   * `X-Area1Security-Disposition: SPOOF`\n   * `X-Area1Security-Disposition: UCE` (`UCE` is the equivalent of `SPAM`)\n\nIf desired, you can create a separate quarantine for each of the dispositions.\n\nGoogle handles Groups (that is, distributions lists) differently from user mail accounts. The compliance filters actions are limited to the **Users** account type. If you heavily use Google Groups (that is, distribution lists), quarantining malicious messages using the Email security quarantine is the recommended method to ensure full protection.\n\n## 3. Add your domain to Email security\n\nTo avoid email loop errors, add your domain to your Email security dashboard.\n\n1. Log in to the [Email security dashboard](https://horizon.area1security.com/home).\n\n2. Go to **Settings** (the gear icon).\n\n3. In **Email Configuration** > **Domains**, select **New Domain**.\n\n4. Enter the following settings:\n\n1. **Domain**: Enter the domain you want Email security to protect.\n   2. **Configured as**: Select **MX Records**.\n   3. **Forwarding to**: Add `google.com`.\n   4. **Quarantine policy**: Select **Malicious** and **Spam**.\n\n5. Select **Publish domain**.\n\n## 4. Update your domain MX records\n\nInstructions to update your MX records will depend on the DNS provider you are using. You need to replace the existing Google MX records with the Email security hosts. For example:\n\n| MX Priority | Host |\n| - | - |\n| `5` | `mailstream-eu1.mxrecord.io` |\n| `10` | `mailstream-central.mxrecord.mx` |\n| `20` | `mailstream-east.mxrecord.io` |\n| `20` | `mailstream-west.mxrecord.io` |\n\nWhen configuring the Email Security (formerly Area 1) MX records, it is important to configure hosts with the correct MX priority. This will allow mail flows to the preferred hosts and fail over as needed.\n\nChoose from the following Email Security MX hosts, and order them by priority. For example, if you are located outside the US and want to prioritize email processing in the EU, add `mailstream-eu1.mxrecord.io` as your first host, and then the US servers.\n\n| Host | Location | Note |\n| - | - | - |\n| | US | Best option to ensure all email traffic processing happens in the US. |\n| `mailstream-eu1.mxrecord.io` | EU | Best option to ensure all email traffic processing happens in Germany, with backup to US data centers. |\n| `mailstream-bom.mxrecord.mx` | India | Best option to ensure all email traffic processing happens within India. |\n| `mailstream-india-primary.mxrecord.mx` | India | Same as `mailstream-bom.mxrecord.mx`, with backup to US data centers. |\n| `mailstream-asia.mxrecord.mx` | India | Best option to ensure all email traffic processing happens in India, with Australia data centers as backup. |\n| `mailstream-syd.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens within Australia. |\n| `mailstream-australia-primary.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens in Australia, with India and US data centers as backup. |\n\nDNS changes will reach the major DNS servers in about an hour or follow the TTL value as described in the [Prerequisites section](#prerequisites).\n\n## 5. Secure your email flow\n\nAfter 36 hours, the MX record DNS update will have sufficiently propagated across the Internet. It is now safe to secure your email flow. This will ensure that Google only accepts messages that are first received by Email security. This step is highly recommended to prevent threat actors from using cached MX entries to bypass Email security by injecting messages directly into Gmail.\n\n1. Access the [Google Administrative Console](https://admin.google.com/), then select **Apps** > **Google Workspace** > **Gmail**.\n\n2. Select **Spam, Phishing, and Malware**.\n\n3. Go to **Inbound Gateway configuration** and select **Configure**.\n\n4. Enable **Reject all mail not from gateway IPs** and select **Save**.\n\n5. Select **Save** once more to commit and activate the configuration change in the Gmail advanced configuration console.\n\n## 6. Send Email security spam to user spam folder (optional)\n\nUnlike the configuration in [step 2](#2-quarantine-malicious-detections) where the message can be sent to an administrative quarantine, this optional step can be configured to send messages that are identified as spam by Email security to the user’s spam folder.\n\n1. Access [Google's Administrative Console](https://admin.google.com/), then select **Apps** > **Google Workspace** > **Gmail**.\n\n2. Select **Spam, Phishing, and Malware**.\n\n3. Go to **Inbound Gateway configuration** and select **Configure**.\n\n4. In the **Message Tagging** section, select **Message is considered spam if the following header regexp matches**.\n\n5. In the **Regexp** section, enter the string `X-Area1Security-Disposition: UCE` (`UCE` is the equivalent of `SPAM`).\n\n6. Select **SAVE** to save the updated configuration.\n\n<page>\n---\ntitle: Deploy and configure Microsoft Office 365 with Email security (formerly\n  Area 1) as the MX Record · Cloudflare Email security (formerly Area 1) docs\ndescription: In this tutorial, you will learn how to configure Microsoft Office\n  365 with Email security as its MX record. This tutorial is broken down into\n  several steps. If at any steps during this tutorial you receive a message\n  saying that you need to run the Enable-OrganizationCustomization cmdlet, refer\n  to section 6.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/deployment/inline/setup/office-365-area1-mx/\n  md: https://developers.cloudflare.com/email-security/deployment/inline/setup/office-365-area1-mx/index.md\n---\n\nArea 1 has been renamed\n\nArea 1 is now **Email Security (formerly Area 1)**.\n\n![A schematic showing where Email security is in the life cycle of an email received](https://developers.cloudflare.com/_astro/office365-mx.DyNuwhSm_1Pxj4b.webp)\n\nIn this tutorial, you will learn how to configure Microsoft Office 365 with Email security as its MX record. This tutorial is broken down into several steps. If at any steps during this tutorial you receive a message saying that you need to run the `Enable-OrganizationCustomization` cmdlet, [refer to section 6](#6-execute-enable-organizationcustomization-if-required).\n\nEmail Security (formerly Area 1) supports Microsoft Office 365 Government Community Cloud (GCC). Refer to [Microsoft 365 Government Community Cloud](https://developers.cloudflare.com/email-security/reference/office365-gcc/) for more information.\n\nFor the purposes of this guide, Office 365 and Microsoft 365 are equivalent.\n\nEmail Security (formerly Area 1) does not currently manage outbound email. If you intend to remove other existing services that manage outbound email, you will have to plan accordingly on migrating outbound functions back to your email services (such as Office 365 / Google Workspace).\n\nTo ensure changes made in this tutorial take effect quickly, update the Time to Live (TTL) value of the existing MX records on your domains to five minutes. Do this on all the domains you will be deploying.\n\nChanging the TTL value instructs DNS servers on how long to cache this value before requesting an update from the responsible nameserver. You need to change the TTL value before changing your MX records to Cloudflare Email Security (formerly Area 1). This will ensure that changes take effect quickly and can also be reverted quickly if needed. If your DNS manager does not allow for a TTL of five minutes, set it to the lowest possible setting.\n\nTo check your existing TTL, open a terminal window and run the following command against your domain:\n\nIn the above example, TTL is shown in seconds as `300` (or five minutes).\n\nIf you are using Cloudflare for DNS, you can leave the [TTL setting as **Auto**](https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl/).\n\nBelow is a list with instructions on how to edit MX records for some popular services:\n\n* **Cloudflare**: [Set up email records](https://developers.cloudflare.com/dns/manage-dns-records/how-to/email-records/)\n* **GoDaddy**: [Edit an MX Record](https://www.godaddy.com/help/edit-an-mx-record-19235)\n* **AWS**: [Creating records by using the Amazon Route 53 console](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html)\n* **Azure**: [Create DNS records in a custom domain for a web app](https://learn.microsoft.com/en-us/azure/dns/dns-web-sites-custom-domain)\n\n## 1. Add Email security IP addresses to Allow List\n\n1. Go to the [Microsoft Security admin center](https://security.microsoft.com/homepage).\n\n2. Go to **Email & collaboration** > **Policies & Rules** > **Threat policies**.\n\n3. Select the [Anti-spam option](https://security.microsoft.com/antispam).\n\n![Select the anti-spam option](https://developers.cloudflare.com/_astro/step3-anti-spam.BX6vR5_z_Z1GaRXz.webp)\n\n4. Select **Connection filter policy (Default)** > **Edit connection filter policy**.\n\n![Select edit connection filter policy](https://developers.cloudflare.com/_astro/step4-edit-filter-policy.A8Ro0_Pg_PFD3J.webp)\n\n5. In **Always allow messages from the following IP addresses or address range** add the IP addresses and CIDR blocks mentioned in [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/).\n\n![Enter the egress IP addresses](https://developers.cloudflare.com/_astro/step5-egress-ips.C6oS_7kc_2jp3b9.webp)\n\n7. Microsoft recommends disabling SPF Hard fail when an email solution is placed in front of it. Return to the [Anti-spam option](https://security.microsoft.com/antispam).\n\n8. Select **Anti-spam inbound policy (Default)**.\n\n9. At the end of the **Bulk email threshold & spam properties** section, select **Edit spam threshold and properties**.\n\n![Select the spam threshold and properties button](https://developers.cloudflare.com/_astro/step9-spam-threshold.DQEQPUiI_2c4WvY.webp)\n\n10. Scroll to **Mark as spam** > **SPF record: hard fail**, and ensure it is set to **Off**.\n\n![Make sure SPF record: hard fail is set to off](https://developers.cloudflare.com/_astro/step10-spf-record-hard-fail.BuwVzD6k_ZOdqek.webp)\n\n## 2. Enhanced Filtering configuration\n\nThis option will allow Office 365 to properly identify the original connecting IP before the message was received by Email security (formerly Area 1). This helps with SPF analysis. This has two steps:\n\n* Creating an inbound connector.\n* Enabling the enhanced filtering configuration of the connector.\n\n### Create an inbound connector\n\n1. Go to the new [**Exchange admin center**](https://admin.exchange.microsoft.com/#/homepage).\n\n2. Select **Mail flow** > **Connectors**.\n\n![Select Connectors from Mail flow](https://developers.cloudflare.com/_astro/step2-mailflow-conectors.D-_KSNgO_Z2wAJzv.webp)\n\n3. Select **Add a connector**.\n\n4. In **Connection from**, select **Partner organization**.\n\n6. Set the following options:\n\n* **Name** - `Email security Inbound Connector`\n   * **Description** - `Inbound connector for Enhanced Filtering`\n\n![Enter a name and descriptions for your connector](https://developers.cloudflare.com/_astro/step6-connector-options.ED0n-5il_1WFJDd.webp)\n\n8. In **Authenticating sent email**, select **By verifying that the IP address of the sending server matches one of the following IP addresses, which belongs to your partner organization.**\n\n9. Enter all of the egress IPs in the [Egress IPs](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/) page.\n\n![Enter all of Email security's Egress IPs](https://developers.cloudflare.com/_astro/step9-egress-ips.4C-zVla8_2vo2Ce.webp)\n\n11. In **Security restrictions**, accept the default **Reject email messages if they aren't sent over TLS** setting.\n\n13. Review your settings and select **Create connector**.\n\n### Enable enhanced filtering\n\nNow that the inbound connector has been configured, you will need to enable the enhanced filtering configuration of the connector in the [Security admin console](https://security.microsoft.com/homepage).\n\n1. Go to [Security Admin console](https://security.microsoft.com/homepage) > **Email & collaboration** > **Policy & Rules**.\n\n2. Go to **Threat policies** > **Rules**, and select **Enhanced filtering**.\n\n![Go to Enhanced filtering](https://developers.cloudflare.com/_astro/step2-enhanced-filtering.DzDMbFoR_1KkPOA.webp)\n\n3. Select the `Email security Inbound Connector` that you configured previously to edit its configuration parameters.\n\n4. Select **Automatically detect and skip the last IP address** and **Apply to entire organization**.\n\n![Select Automatically detect and skip the last IP address, and Apply to entire organization](https://developers.cloudflare.com/_astro/step3-selectors.DU-k5j1W_1xif0j.webp)\n\n## 3. Configure Email security quarantine policies\n\n### Select the disposition you want to quarantine\n\nQuarantining messages is a per domain configuration. To modify which domains will have their messages quarantined, access the domain configuration:\n\n1. Log in to the [Email security dashboard](https://horizon.area1security.com/).\n\n2. Go to **Settings** (the gear icon) > **Domains**.\n\n3. Locate the domain you want to edit.\n\n4. Select the **...** > **Edit**.\n\n5. Select the additional dispositions you want to quarantine.\n\n![Manage domain quarantines](https://developers.cloudflare.com/_astro/step4-area1-dispositions.lsa9cYbq_Z25C2Tq.webp)\n\nWhen Email security is deployed as the MX record and protecting Office 365, `MALICIOUS` and `SPAM` detections will automatically be quarantined. This behavior cannot be modified.\n\n### Manage the Admin Quarantine\n\n1. Log in to the [Email security dashboard](https://horizon.area1security.com/).\n\n2. Go to **Email** > **Admin Quarantine**.\n\n3. Locate the message you want to manage, and select the `...` icon next to it. This will let you preview, download, or release the quarantined message.\n\n![Manage admin quarantines](https://developers.cloudflare.com/_astro/step4-manage-admin-quarantine.DWu8KCg6_1XnWzQ.webp)\n\n## 4. Message handling\n\nThere may be scenarios where use of the Office 365 (O365) email quarantine or a combination with Email security is preferred. The following are the best practices for using the O365 quarantine [by disposition](https://developers.cloudflare.com/email-security/reference/dispositions-and-attributes/):\n\n| Disposition | Action |\n| - | - |\n| `MALICIOUS` | Should always be quarantined. If the user requires notification, they should require administrator approval to release messages. Users should never have the ability to self remediate `MALICIOUS` emails without approval from an administrator. Emails should be body and subject tagged. |\n| `SUSPICIOUS` | Should not be quarantined. Emails should be body and subject tagged, and delivered to the user’s inbox or junk mail folder. Advantage customers should use [`URL defang`](https://developers.cloudflare.com/email-security/email-configuration/email-policies/link-actions/) with this disposition, while all Enterprise customers should always enable [Email Link Isolation](https://developers.cloudflare.com/email-security/email-configuration/email-policies/link-actions/#email-link-isolation). |\n| `SPAM` | Should always be quarantined. If the user requires notification, they may or may not require administrator approval to release emails. Emails should be subject tagged. |\n| `BULK` | Should not be quarantined. Emails should be subject tagged and delivered to the inbox or junk mail folder. |\n| `SPOOF` | If `SPOOF` detections are clean and well managed [in the Allow List](https://developers.cloudflare.com/email-security/email-configuration/lists/), emails should always be quarantined. If the `SPOOF` detections are not clean, they should have the same treatment as `SPAM` dispositions if you have [Enhanced Detections](https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/) configured. If not, `SPOOF` detections should be treated as `BULK`. Emails should be body and subject tagged. |\n\nOffice 365 (O365) has various options, as well as limitations, as to how quarantine email messages. Refer to [Office 365 use cases](https://developers.cloudflare.com/email-security/deployment/inline/setup/office-365-area1-mx/use-cases/) for more information.\n\nThe Email security dashboard has an [Admin quarantine](https://developers.cloudflare.com/email-security/email-configuration/admin-quarantine/), and you can also use the Office 365 quarantine for when a user quarantine is needed. While there are many quarantine options, the following are the primary use cases the Office 365 [example tutorials](https://developers.cloudflare.com/email-security/deployment/inline/setup/office-365-area1-mx/use-cases/) will cover:\n\n* **Use case 1**: Deliver emails to Office 365 junk email folder and Admin Quarantine in Email security (Recommended)\n* **Use case 2**: Deliver emails to junk email folder and user managed quarantine (this use case requires that `MALICIOUS` emails be quarantined within the Email security dashboard)\n* **Use case 3**: Deliver emails to junk email and administrative quarantine\n* **Use case 4**: Deliver emails to the user managed quarantine and administrative quarantine\n* **Use case 5**: Deliver emails to the user junk email folder and administrative quarantine\n\n## 5. Update your domain MX records\n\nInstructions to update your MX records will depend on the DNS provider you are using. You will need to update and replace your existing MX record with the Email security hosts. For example:\n\n| MX Priority | Host |\n| - | - |\n| `5` | `mailstream-eu1.mxrecord.io` |\n| `10` | `mailstream-central.mxrecord.mx` |\n| `20` | `mailstream-east.mxrecord.io` |\n| `20` | `mailstream-west.mxrecord.io` |\n\nWhen configuring the Email Security (formerly Area 1) MX records, it is important to configure hosts with the correct MX priority. This will allow mail flows to the preferred hosts and fail over as needed.\n\nChoose from the following Email Security MX hosts, and order them by priority. For example, if you are located outside the US and want to prioritize email processing in the EU, add `mailstream-eu1.mxrecord.io` as your first host, and then the US servers.\n\n| Host | Location | Note |\n| - | - | - |\n| | US | Best option to ensure all email traffic processing happens in the US. |\n| `mailstream-eu1.mxrecord.io` | EU | Best option to ensure all email traffic processing happens in Germany, with backup to US data centers. |\n| `mailstream-bom.mxrecord.mx` | India | Best option to ensure all email traffic processing happens within India. |\n| `mailstream-india-primary.mxrecord.mx` | India | Same as `mailstream-bom.mxrecord.mx`, with backup to US data centers. |\n| `mailstream-asia.mxrecord.mx` | India | Best option to ensure all email traffic processing happens in India, with Australia data centers as backup. |\n| `mailstream-syd.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens within Australia. |\n| `mailstream-australia-primary.area1.cloudflare.net` | Australia / New Zealand | Best option to ensure all email traffic processing happens in Australia, with India and US data centers as backup. |\n\nDNS changes will reach the major DNS servers in about an hour or follow the TTL value as described in the [Prerequisites section](#prerequisites).\n\n### Secure Office 365 from MX records bypass (recommended)\n\nOne method of DNS attacks is to search for old MX records and send phishing emails directly to the mail server. To secure the email flow, you will want to enforce an email flow where inbound messages are accepted by Office 365 only when they originate from Email security. This can be done by adding a connector to only allow email from Email security with TLS encryption. This step is optional but recommended.\n\nThis step should not be performed until 24 hours after all domains (excluding your `<on_microsoft.com>` domain) in your Office 365 organization have been onboarded to Email security, and Email security is their MX record. If a domain has not been onboarded or DNS is still propagating, you will impact production email flow for that domain.\n\n#### Configure domains\n\n1. Log in to the [Email security (formerly Area 1) dashboard](https://horizon.area1security.com/).\n\n2. Go to **Settings** (the gear icon).\n\n3. In **Email Configuration** > **Domains**, make sure each domain you are onboarding has been added.\n\n4. Set the following options for each domain:\n\n* **Domain**: `<YOUR_DOMAIN>`\n   * **Configured as**: `MX Records`\n   * **Forwarding to**: This should match the expected MX record for each domain in the [Domains section](https://admin.microsoft.com/#/Domains/) of Office 365\n   * **IP Restrictions**: Leave empty\n   * **Outbound TLS**: `Forward all messages over TLS`\n   * **Quarantine Policy**: Varies by deployment.\n\n#### Create Connector\n\n1. Go to the new [Exchange admin center](https://admin.exchange.microsoft.com/#/homepage).\n\n2. Go to **Mail flow** > **Connectors**.\n\n3. Select **Add a connector**.\n\n4. Select **Connection from** > **Partner organization**.\n\n6. Set the following options:\n\n* **Name** - `Secure O365 Inbound`\n   * **Description** - `Only accept inbound email from Email security (formerly Area 1)`\n\n8. Make sure **By Verifying that the sender domain matches one of the following domains** is selected.\n\n9. Enter `*` in the text field, and select **+**.\n\n![Enter an asterisk in the text box, and select the plus button](https://developers.cloudflare.com/_astro/step9-create-conector.CrgG_ZCE_1yTDMd.webp)\n\n11. Make sure **Reject email messages if they aren't sent over TLS** is selected.\n\n12. Still in the same screen, select **Reject email messages if they aren’t sent from within this IP address range**, and enter all the egress IPs in the [Egress IPs page](https://developers.cloudflare.com/email-security/deployment/inline/reference/egress-ips/).\n\n![Enter all the egress IPs for Office 365](https://developers.cloudflare.com/_astro/step12-egress-ips.DjrzRr8f_lME7A.webp)\n\n14. Review your settings and select **Create connector**.\n\n## 6 Execute `Enable-OrganizationCustomization` (if required)\n\nThe following steps are only required if you have not previously customized your Office 365 instance. If you received the message to run this cmdlet in any of the previous steps, you will need to execute it in order to proceed with the configuration. This change may take as long as 24 hours to take effect.\n\n1. Run PowerShell as administrator, and execute the following command. Reply `Yes` when prompted:\n\n![Run the install-module command in PowerShell](https://developers.cloudflare.com/_astro/step1-install-module.B-3lzoxd_181g8B.webp)\n\nThis module is a Microsoft module.\n\n1. Run the following commands to execute the policy change and connect to the Office 365 instance:\n\nConfirm that you want to execute the policy change, and then run the following command:\n\nFinally, run the following to authenticate against your Office 365 instance:\n\n![Run the commands to execute the policy change](https://developers.cloudflare.com/_astro/step2-set-executionpolicy.BpqpygoE_2c3jan.webp)\n\n2. The `Connect-ExchangeOnline` cmdlet will prompt you to login. Log in using an Office 365 administrator account. Once authenticated, you will be returned to the PowerShell prompt.\n\n![Log in with an Office 365 admin account](https://developers.cloudflare.com/_astro/step3-connect-exchange.MD9DPBT__27Gwt5.webp)\n\n3. You can verify that the `OrganizationCustomization` is enabled by running the command:\n\n![Run the get-organizationconfig command](https://developers.cloudflare.com/_astro/step4-get-organizationconfig.BulZ0upk_ZCKAxt.webp)\n\nIf the result is `false`, `OrganizationCustomization` is already enabled and no further actions are required. If it is true, you need to enable it:\n\n![If the previous result is true, enable the organization customization mode](https://developers.cloudflare.com/_astro/step4-enable-organizationcustomization.D2DkAgo3_VW6I3.webp)\n\n<page>\n---\ntitle: Google Workspaces directory integration · Cloudflare Email security\n  (formerly Area 1) docs\ndescription: Email security can integrate with Google to retrieve user and group\n  information. This can be used to enforce the Business Email Compromise\n  configuration to prevent user impersonation.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/business-email-compromise/gworkspaces-directory-guide/\n  md: https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/business-email-compromise/gworkspaces-directory-guide/index.md\n---\n\nEmail security can integrate with Google to retrieve user and group information. This can be used to enforce the Business Email Compromise configuration to prevent user impersonation.\n\n## 1. Create a service account in Google for Email security Directory Integration\n\nYou need to authorize Email security to make connections into your Google tenant to retrieve your directory details. Cloudflare recommends that you create a service account for this purpose. This account will require the following following privileges:\n\n* View group subscriptions on your domain.\n* View organization units on your domain.\n* View groups on your domain.\n* See info about users on your domain.\n\nStart by creating a service account. If you already have one, you can skip this step.\n\n1. Access your [Google admin console](https://admin.google.com/), and go to **Account** > **Admin roles**.\n\n![Access the admin console in your Google account](https://developers.cloudflare.com/_astro/step1-access-gadmin.CQkN9gbr_ZTsucX.webp)\n\n2. Select **Create new role**, and give it a descriptive name and description. When you are finished, select **Continue**.\n\n3. In **Admin console privileges**, select the following privileges:\n\n* *Organizational Units > Read*\n   * *Users > Read*\n   * *Directory Settings > Settings >Google Support Settings*\n   * *Directory Sync > Manage Directory Sync Settings > Read Directory Sync Settings*\n\n![Select only the privileges mentioned here](https://developers.cloudflare.com/_astro/step3-console-privileges.vFqEU1es_Z1optTG.webp)\n\n4. When you specify Admin console privileges, you also grant the corresponding Admin API privileges. In any case, make sure the following privileges are selected for **Admin API privileges**:\n\n* *Organizational Units > Read*\n   * *Users > Read*\n   * *Groups > Read*\n\n![Select only the privileges mentioned here](https://developers.cloudflare.com/_astro/step4-api-privileges.Cd1euJz-_1eT6Ix.webp)\n\n5. Select **Continue**.\n\n6. Review your information and select **Create Role**.\n\n## 2. Authorize Email security for Directory Access with Google\n\n1. Log in to the [Email security dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Directories**, and select **Add Directory** to start the authorization process.\n\n![Go to Directories in the dashboard of Email security, and then select Add Directory to start the authorization process](https://developers.cloudflare.com/_astro/step2-directories.D22k3b5I_Z2pynUM.webp)\n\n3. In the Add Directory configuration panel, enter the following details:\n\n* **Directory Type**: Open the drop-down menu and select **Google**.\n   * **Directory Name**: Enter a string that represents the directory. This value will be referenced in the Business Email Compromise List configuration section. For example, `Gmail`.\n   * **Sync Frequency**: Update the value to your preference.\n\nSelect **Authorize** when you are done.\n\n4. The Email security dashboard will redirect you to a Google login page. Select or enter the appropriate account to initiate the authentication process.\n\n5. Once authenticated, the system will show a dialog box with a list of the required permissions. Check all the checkboxes, and select **Continue** to authorize the change.\n\n![Select all the settings to authorize Google](https://developers.cloudflare.com/_astro/step5-authorize-google.BLbvhcCy_ZyIIqK.webp)\n\n6. Upon authorization, you will be automatically redirected back to the Add Directory configuration panel. Select **Save** to complete the authorization process.\n\n![Select Save to complete the authorization process](https://developers.cloudflare.com/_astro/step6-save.D3QFRqJX_Z1KDMQr.webp)\n\n7. Once saved, your newly configured directory will appear in the configured directories table.\n\n![Your directory will appear in the configured directories table](https://developers.cloudflare.com/_astro/step7-directories.X-76CIOe_19aOhA.webp)\n\n## 3. Configure the Business Email Compromise list\n\nNow that Email Security (formerly Area 1) has been authorized to access and retrieve directory information, you will need to configure the Business Email Compromise list.\n\n1. Log in to the [Email Security (formerly Area 1) dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Email Configuration** > **Enhanced Detections** > **Business Email Compromise**.\n\n![Access Business Email Compromise in Email Security (formerly Area 1) dashboard to start setting up this feature](https://developers.cloudflare.com/_astro/step2-business-email-compromise.JLn7Jc_Z_ZUFG4J.webp)\n\n3. Open the drop-down menu and select the directory you have created in the previous step 3.\n\n![Select the directory you have created in the previous step 3](https://developers.cloudflare.com/_astro/step3-office365.DovwiIDh_Z1sV2Cc.webp)\n\n4. If the initial directory synchronization has completed, the page will refresh and list groups and users. If you do not see any information, wait a few minutes as the system completes processing the initial synchronization.\n\n![The screen should refresh and show a list of users and groups](https://developers.cloudflare.com/_astro/step4-business-list.CpO6oJT4_moqQF.webp)\n\n5. Select the arrow next to a group to expand it and show its members.\n\n![Select the arrow to expand it and show a list of its members](https://developers.cloudflare.com/_astro/step5-show-members.DDOL6mZ3_Z22IF1S.webp)\n\n6. To protect an entire group, select the three-dots button next to it, and then select **Protect**. When you protect a group, all of its members will be automatically protected. The protection markers will turn green to indicate that protection is active.\n\n![You can protect an entire group of users. The protection markers will turn green to show that protection is active](https://developers.cloudflare.com/_astro/step6-protect-group.Dp7Ice3T_Who9v.webp)\n\n7. You can also protect individual users. Select the three-dots button next to each user you want to protect, and then select **Protect**.\n\n## 4. Configure secondary email address (if required)\n\nWhen the Business Email Compromise list is configured, Email Security (formerly Area 1) will enforce the proper match of the sender’s display name and email address. Any variation from this strict requirement will raise a detection event. The reason of detection will be `Protected Name <NAME> should not appear as <non-configured email address>`.\n\nIn some instances, you may want to allow your protected users to send emails from an alternate email address (like their personal email address). To configure this alternate address, you will have to add it to their directory entry.\n\n1. Log in to the [Email Security (formerly Area 1) dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Email Configuration** > **Enhanced Detections** > **Business Email Compromise**.\n\n3. Search for the user you want to allow an alternate email address.\n\n4. Select the three-dots button > **Edit**.\n\n![Select edit to add alternate email addresses to your user](https://developers.cloudflare.com/_astro/step4-edit-user.DL6F3KAq_ZD7GcV.webp)\n\n5. In **Secondary Emails** add the additional email addresses. Place each entry on a new line.\n\n![Add each new email address to the Secondary Emails field. Place each address on a separate line](https://developers.cloudflare.com/_astro/step5-new-email.B-eIH6gr_zbom5.webp)\n\n6. Select **Save** to finish.\n\n<page>\n---\ntitle: Office 365 directory integration · Cloudflare Email security (formerly\n  Area 1) docs\ndescription: Email security (formerly Area 1) can integrate with Office 365 to\n  retrieve user and group information. This can be used to enforce the Business\n  Email Compromise configuration to prevent user impersonation.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/business-email-compromise/o365-directory-guide/\n  md: https://developers.cloudflare.com/email-security/email-configuration/enhanced-detections/business-email-compromise/o365-directory-guide/index.md\n---\n\nEmail security (formerly Area 1) can integrate with Office 365 to retrieve user and group information. This can be used to enforce the Business Email Compromise configuration to prevent user impersonation.\n\n## 1. Authorize Email security with Office 365 for Directory Access\n\nYou need to authorize Email security to make connections into your [Office 365 tenant](https://learn.microsoft.com/en-us/microsoft-365/solutions/tenant-management-overview) to retrieve your directory details. The account used to authorize will require the **Privileged authentication admin** and **Privileged role admin** roles.\n\n### How does the authorization work?\n\nThe authorization process grants Email security access to the Azure environment with the least applicable privileges required to function. The Enterprise Application that Email security registers is not tied to any administrator account. Inside of the Azure Active Directory admin center you can review the permissions granted to the application in the Enterprise Application section.\n\nWhen assigning user roles in the Office 365 console, you will find these roles in **User permissions** > **Roles configuration** > **Identity admin roles**.\n\n![A list of permissions for Email security](https://developers.cloudflare.com/_astro/permissions.DRkhTx-V_JHMjL.webp)\n\n1. Log in to the [Email security (formerly Area 1) dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Directories**, and select **Add Directory** to start the authorization process.\n\n![Go to Directories in the dashboard of Email security, and then select Add Directory to start the authorization process](https://developers.cloudflare.com/_astro/step2-directories.D22k3b5I_Z2pynUM.webp)\n\n3. In the Add Directory configuration panel, enter the following details:\n\n* **Directory Type**: Open the drop-down menu and select **Office 365**.\n   * **Directory Name**: Enter a string that represents the directory. This value will be referenced in the Business Email Compromise List configuration section. For example, `Office 365`.\n   * **Sync Frequency**: Update the value to your preference.\n\nSelect **Authorize** when you are done.\n\n![Add the appropriate details to the configuration panel](https://developers.cloudflare.com/_astro/step3-directory-config-panel.CN4uFFNK_Z10sKoT.webp)\n\n4. The Email security dashboard will redirect you to a Microsoft login page. Select or enter the appropriate account to initiate the authentication process.\n\n![Select the appropriate Microsoft account to continue](https://developers.cloudflare.com/_astro/step4-login.DmmDslaO_ZcfduF.webp)\n\n5. Once authenticated, the system will show a dialog box with a list of the requested permissions. Select **Accept** to authorize the change.\n\n![Accept the permissions to continue](https://developers.cloudflare.com/_astro/step5-permissions.CNTdCD6P_ZDk7eE.webp)\n\n6. Upon authorization, you will be automatically redirected back to the Add Directory configuration panel. Select **Save** to complete the authorization process.\n\n![Select Save to complete the authorization process](https://developers.cloudflare.com/_astro/step6-save.CJqUX5UA_Z1SjV0d.webp)\n\n7. Once saved, your newly configured directory will appear in the configured directories table.\n\n![Your directory will appear in the configured directories table](https://developers.cloudflare.com/_astro/step7-directories.X-76CIOe_19aOhA.webp)\n\n## 2. Configure the Business Email Compromise list\n\nNow that Email Security (formerly Area 1) has been authorized to access and retrieve directory information, you will need to configure the Business Email Compromise list.\n\n1. Log in to the [Email Security (formerly Area 1) dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Email Configuration** > **Enhanced Detections** > **Business Email Compromise**.\n\n![Access Business Email Compromise in Email Security (formerly Area 1) dashboard to start setting up this feature](https://developers.cloudflare.com/_astro/step2-business-email-compromise.JLn7Jc_Z_ZUFG4J.webp)\n\n3. Open the drop-down menu and select the directory you have created in the previous step 3.\n\n![Select the directory you have created in the previous step 3](https://developers.cloudflare.com/_astro/step3-office365.DovwiIDh_Z1sV2Cc.webp)\n\n4. If the initial directory synchronization has completed, the page will refresh and list groups and users. If you do not see any information, wait a few minutes as the system completes processing the initial synchronization.\n\n![The screen should refresh and show a list of users and groups](https://developers.cloudflare.com/_astro/step4-business-list.CpO6oJT4_moqQF.webp)\n\n5. Select the arrow next to a group to expand it and show its members.\n\n![Select the arrow to expand it and show a list of its members](https://developers.cloudflare.com/_astro/step5-show-members.DDOL6mZ3_Z22IF1S.webp)\n\n6. To protect an entire group, select the three-dots button next to it, and then select **Protect**. When you protect a group, all of its members will be automatically protected. The protection markers will turn green to indicate that protection is active.\n\n![You can protect an entire group of users. The protection markers will turn green to show that protection is active](https://developers.cloudflare.com/_astro/step6-protect-group.Dp7Ice3T_Who9v.webp)\n\n7. You can also protect individual users. Select the three-dots button next to each user you want to protect, and then select **Protect**.\n\n## 3. Configure secondary email address (if required)\n\nWhen the Business Email Compromise list is configured, Email Security (formerly Area 1) will enforce the proper match of the sender’s display name and email address. Any variation from this strict requirement will raise a detection event. The reason of detection will be `Protected Name <NAME> should not appear as <non-configured email address>`.\n\nIn some instances, you may want to allow your protected users to send emails from an alternate email address (like their personal email address). To configure this alternate address, you will have to add it to their directory entry.\n\n1. Log in to the [Email Security (formerly Area 1) dashboard](https://horizon.area1security.com/), and select **Settings** (the gear icon).\n\n2. Go to **Email Configuration** > **Enhanced Detections** > **Business Email Compromise**.\n\n3. Search for the user you want to allow an alternate email address.\n\n4. Select the three-dots button > **Edit**.\n\n![Select edit to add alternate email addresses to your user](https://developers.cloudflare.com/_astro/step4-edit-user.DL6F3KAq_ZD7GcV.webp)\n\n5. In **Secondary Emails** add the additional email addresses. Place each entry on a new line.\n\n![Add each new email address to the Secondary Emails field. Place each address on a separate line](https://developers.cloudflare.com/_astro/step5-new-email.B-eIH6gr_zbom5.webp)\n\n6. Select **Save** to finish.\n\n<page>\n---\ntitle: Provision with Microsoft Entra · Cloudflare Fundamentals docs\ndescription: Once you have gathered the required data, the following steps will\n  be required to finish the provisioning with Entra.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/fundamentals/account/account-security/scim-setup/entra/\n  md: https://developers.cloudflare.com/fundamentals/account/account-security/scim-setup/entra/index.md\n---\n\n**Important Update:** Cloudflare now supports native User Groups for enhanced access control. This new feature replaces the previous method of directly assigning Cloudflare roles based on IdP group mappings (identified by the pattern `CF-<accountID> - <Role Name>`), which is deprecated as of June 2nd, 2025. SCIM Virtual Groups will reach end-of-life on December 2, 2025. Update your SCIM configurations using the instructions below to utilize User Groups for seamless provisioning.\n\nOnce you have [gathered the required data](https://developers.cloudflare.com/fundamentals/account/account-security/scim-setup/#gather-the-required-data), the following steps will be required to finish the provisioning with Entra.\n\n## Set up the Enterprise application\n\n1. Go to the Entra admin center and select **Applications** > **Enterprise Applications**.\n2. In the Microsoft Entra Gallery, select **New application** > **Create your own application**, then choose a name.\n3. Select **Integrate any other application you don't find in the gallery (Non-gallery)**.\n4. **Create** an application.\n\n## Provision the Enterprise application\n\n1. Inside the newly created application under **Manage** from the sidebar menu, select **Provisioning**.\n2. Select **New configuration** and enter the **Tenant URL**: `https://api.cloudflare.com/client/v4/accounts/<ACCOUNT_ID>/scim/v2`. Replace `<ACCOUNT_ID>` with your own account ID.\n3. Paste the SCIM provisioning API token value as **Secret token**.\n4. Select **Test Connection** then **Save** the configuration.\n\n## Configure user and group synchronization\n\n1. Navigate to the newly created application under **Manage** from the sidebar menu, select **Users and groups**.\n2. [Assign users and groups to the application](https://learn.microsoft.com/entra/identity/enterprise-apps/assign-user-or-group-access-portal).\n3. After the users are assigned, navigate to **Provisioning** on the sidebar menu and select **Start Provisioning**.\n\nTo successfully synchronize the group details into Cloudflare the `User Principal Name` (of `Identity`) and `Email` (of `Contact Information`) fields of each user must be identical. Values are case-sensitive, and the User Principal Name can only contain alphanumeric characters. Learn more about [how to create, invite, and delete users](https://learn.microsoft.com/entra/fundamentals/how-to-create-delete-users).\n\n1. To validate which users and groups have been synchronized, navigate to **Provisioning logs** on the sidebar menu. You can also [review the Cloudflare Audit Logs](https://developers.cloudflare.com/fundamentals/account/account-security/review-audit-logs/).\n\nIf the Entra group shares the same name of an existing Cloudflare user group, the Cloudflare user group will become read-only after the provisioning.\n\n1. To grant permissions to users and groups at Cloudflare, refer to [Roles](https://developers.cloudflare.com/fundamentals/manage-members/roles/) and [Policies](https://developers.cloudflare.com/fundamentals/manage-members/policies/).\n\n## (Optional) Automate Cloudflare's SCIM integration\n\nCloudflare's SCIM integration requires one external application per account. Customers with multiple accounts may want to automate part of the setup to save time and reduce the amount of time spent in the Entra administrative UI.\n\nThe initial setup of creating the non-gallery applications and adding the provisioning URL and API key are scriptable via API, but the rest of the setup is dependent on your specific need and IDP configuration.\n\n**1. Get an access token**\n\nGet an Entra access token. Note that the example below is using the Azure CLI.",
  "code_samples": [
    {
      "code": "{\n  \"id\": \"31c70c65-9f81-4669-94ed-1e1e041e7b06\",\n  \"scope\": \"region\",\n  \"name\": \"WEUR\",\n  \"mode\": \"monitoring\",\n  \"profile_sensitivity\": \"medium\",\n  \"rate_sensitivity\": \"medium\",\n  \"burst_sensitivity\": \"medium\",\n  \"created_on\": \"2023-10-01T13:10:38.762503+01:00\",\n  \"modified_on\": \"2023-10-01T13:10:38.762503+01:00\"\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"id\": \"31c70c65-9f81-4669-94ed-1e1e041e7b06\",\n  \"prefix\": \"192.0.2.0/24\",\n  \"comment\": \"Game ranges\",\n  \"excluded\": false,\n  \"created_on\": \"2022-01-01T13:06:04.721954+01:00\",\n  \"modified_on\": \"2022-01-01T13:06:04.721954+01:00\"\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"id\": \"31c70c65-9f81-4669-94ed-1e1e041e7b06\",\n  \"prefix\": \"192.0.2.0/24\",\n  \"comment\": \"Game ranges\",\n  \"enabled\": true,\n  \"created_on\": \"2021-10-01T13:06:04.721954+01:00\",\n  \"modified_on\": \"2021-10-01T13:06:04.721954+01:00\"\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"id\": \"31c70c65-9f81-4669-94ed-1e1e041e7b06\",\n  \"scope\": \"region\",\n  \"name\": \"WEUR\",\n  \"rate_sensitivity\": \"medium\",\n  \"burst_sensitivity\": \"medium\",\n  \"created_on\": \"2021-10-01T13:10:38.762503+01:00\",\n  \"modified_on\": \"2021-10-01T13:10:38.762503+01:00\"\n}",
      "language": "json"
    },
    {
      "code": "{\n  \"id\": \"20b99eb6-8b48-48dd-a5b9-a995a0843b57\",\n  \"expression\": \"ip.dst in { 192.0.2.0/24 203.0.113.0/24 } and tcp.dstport in { 80 443 10000..65535 }\",\n  \"mode\": \"enabled\",\n  \"created_on\": \"2022-11-01T13:10:38.762503+01:00\",\n  \"modified_on\": \"2022-11-01T13:10:38.762503+01:00\"\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_protection_status \\\n--header \"Authorization: Bearer <API_TOKEN>\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"enabled\": false\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl --request PATCH \\\nhttps://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_protection_status \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"enabled\": true\n}'",
      "language": "bash"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes \\\n--header \"Authorization: Bearer <API_TOKEN>\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"prefix\": \"203.0.113/24\",\n      \"comment\": \"My prefix\",\n      \"excluded\": false\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/prefixes/bulk \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '[\n  {\n    \"prefix\": \"192.0.2.0/24\",\n    \"comment\": \"Game ranges\",\n    \"excluded\": false\n  },\n  {\n    \"prefix\": \"192.0.2.2/26\",\n    \"comment\": \"Range for a specific game\",\n    \"excluded\": true\n  }\n]'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"id\": \"<PREFIX_1_ID>\",\n      \"prefix\": \"192.0.2.0/24\",\n      \"excluded\": false,\n      \"comment\": \"Game ranges\",\n      \"created_on\": \"<TIMESTAMP>\",\n      \"modified_on\": \"<TIMESTAMP>\"\n    },\n    {\n      \"id\": \"<PREFIX_2_ID>\",\n      \"prefix\": \"192.0.2.2/26\",\n      \"excluded\": true,\n      \"comment\": \"Range for a specific game\",\n      \"created_on\": \"<TIMESTAMP>\",\n      \"modified_on\": \"<TIMESTAMP>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist \\\n--header \"Authorization: Bearer <API_TOKEN>\"",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": [\n    {\n      \"id\": \"<ALLOWLIST_PREFIX_ID>\",\n      \"prefix\": \"192.0.2.127\",\n      \"comment\": \"Single IP address in allowlist\",\n      \"enabled\": true,\n      \"created_on\": \"<TIMESTAMP>\",\n      \"modified_on\": \"<TIMESTAMP>\"\n    }\n  ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/allowlist \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"prefix\": \"203.0.113.0/26\",\n  \"comment\": \"Partner range\",\n  \"enabled\": true\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<ALLOWLIST_PREFIX_1_ID>\",\n    \"prefix\": \"203.0.113.0/26\",\n    \"comment\": \"Partner range\",\n    \"enabled\": true,\n    \"created_on\": \"<TIMESTAMP>\",\n    \"modified_on\": \"<TIMESTAMP>\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/rules \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"scope\": \"region\",\n  \"name\": \"WEUR\",\n  \"mode\": \"monitoring\",\n  \"rate_sensitivity\": \"medium\",\n  \"burst_sensitivity\": \"medium\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<SYN_FLOOD_RULE_ID>\",\n    \"scope\": \"region\",\n    \"name\": \"WEUR\",\n    \"mode\": \"monitoring\",\n    \"rate_sensitivity\": \"medium\",\n    \"burst_sensitivity\": \"medium\",\n    \"created_on\": \"<TIMESTAMP>\",\n    \"modified_on\": \"<TIMESTAMP>\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/rules \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"scope\": \"region\",\n  \"name\": \"WEUR\",\n  \"mode\": \"monitoring\",\n  \"rate_sensitivity\": \"low\",\n  \"burst_sensitivity\": \"low\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<OOS_TCP_RULE_ID>\",\n    \"scope\": \"region\",\n    \"name\": \"WEUR\",\n    \"mode\": \"monitoring\",\n    \"rate_sensitivity\": \"low\",\n    \"burst_sensitivity\": \"low\",\n    \"created_on\": \"<TIMESTAMP>\",\n    \"modified_on\": \"<TIMESTAMP>\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/syn_protection/filters \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"expression\": \"ip.dst in { 192.0.2.0/24 }\",\n  \"mode\": \"monitoring\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<SYN_FLOOD_FILTER_ID>\",\n    \"expression\": \"ip.dst in { 192.0.2.0/24 }\",\n    \"mode\": \"monitoring\",\n    \"created_on\": \"<TIMESTAMP>\",\n    \"modified_on\": \"<TIMESTAMP>\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_tcp_protection/configs/tcp_flow_protection/filters \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"expression\": \"ip.dst in { 203.0.113.0/24 } and tcp.dstport in { 8000..8081 }\",\n  \"mode\": \"disabled\"\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<OOS_TCP_FILTER_ID>\",\n    \"expression\": \"ip.dst in { 203.0.113.0/24 } and tcp.dstport in { 8000..8081 }\",\n    \"mode\": \"disabled\",\n    \"created_on\": \"<TIMESTAMP>\",\n    \"modified_on\": \"<TIMESTAMP>\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}",
      "language": "json"
    },
    {
      "code": "curl --request PUT \\\nhttps://api.cloudflare.com/client/v4/zones/{zone_id}/rulesets/phases/ddos_l7/entrypoint \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"description\": \"Execute HTTP DDoS Attack Protection managed ruleset in the zone-level phase entry point ruleset\",\n  \"rules\": [\n    {\n      \"action\": \"execute\",\n      \"action_parameters\": {\n        \"id\": \"<MANAGED_RULESET_ID>\",\n        \"overrides\": {\n          \"sensitivity_level\": \"medium\",\n          \"action\": \"managed_challenge\",\n          \"categories\": [\n            {\n              \"category\": \"<TAG_NAME>\",\n              \"sensitivity_level\": \"low\"\n            }\n          ],\n          \"rules\": [\n            {\n              \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n              \"action\": \"block\"\n            }\n          ]\n        }\n      },\n      \"expression\": \"true\"\n    }\n  ]\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<PHASE_ENTRY_POINT_RULESET_ID>\",\n    \"name\": \"default\",\n    \"description\": \"Execute HTTP DDoS Attack Protection managed ruleset in the zone-level phase entry point ruleset\",\n    \"kind\": \"zone\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\",\n          \"version\": \"latest\",\n          \"overrides\": {\n            \"action\": \"managed_challenge\",\n            \"categories\": [\n              {\n                \"category\": \"<TAG_NAME>\",\n                \"sensitivity_level\": \"low\"\n              }\n            ],\n            \"rules\": [\n              {\n                \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n                \"action\": \"block\"\n              }\n            ],\n            \"sensitivity_level\": \"medium\"\n          }\n        },\n        \"expression\": \"true\",\n        \"last_updated\": \"2021-06-16T04:14:47.977741Z\",\n        \"ref\": \"<RULE_REF>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-06-16T04:14:47.977741Z\",\n    \"phase\": \"ddos_l7\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "curl --request PUT \\\nhttps://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/phases/ddos_l7/entrypoint \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"description\": \"Disable a managed ruleset rule for allowlisted IP addresses\",\n  \"rules\": [\n    {\n      \"expression\": \"ip.src in $allowlisted_ips\",\n      \"action\": \"execute\",\n      \"action_parameters\": {\n        \"id\": \"<MANAGED_RULESET_ID>\",\n        \"overrides\": {\n          \"rules\": [\n            {\n              \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n              \"action\": \"log\",\n              \"sensitivity_level\": \"eoff\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<PHASE_ENTRY_POINT_RULESET_ID>\",\n    \"name\": \"default\",\n    \"description\": \"Disable a managed ruleset rule for allowlisted IP addresses\",\n    \"kind\": \"root\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\",\n          \"version\": \"latest\",\n          \"overrides\": {\n            \"rules\": [\n              {\n                \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n                \"action\": \"log\",\n                \"sensitivity_level\": \"eoff\"\n              }\n            ]\n          }\n        },\n        \"expression\": \"ip.src in $allowlisted_ips\",\n        \"last_updated\": \"2022-10-16T04:14:47.977741Z\",\n        \"ref\": \"<RULE_REF>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2022-10-16T04:14:47.977741Z\",\n    \"phase\": \"ddos_l7\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "curl --request PUT \\\nhttps://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/phases/ddos_l4/entrypoint \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"description\": \"Define overrides for the Network-layer DDoS Attack Protection managed ruleset\",\n  \"rules\": [\n    {\n      \"action\": \"execute\",\n      \"expression\": \"ip.dst in { 1.1.1.0/24 }\",\n      \"action_parameters\": {\n        \"id\": \"<MANAGED_RULESET_ID>\",\n        \"overrides\": {\n          \"sensitivity_level\": \"medium\",\n          \"categories\": [\n            {\n              \"category\": \"<TAG_NAME>\",\n              \"sensitivity_level\": \"low\"\n            }\n          ],\n          \"rules\": [\n            {\n              \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n              \"action\": \"block\"\n            }\n          ]\n        }\n      }\n    }\n  ]\n}'",
      "language": "bash"
    },
    {
      "code": "{\n  \"result\": {\n    \"id\": \"<PHASE_ENTRY_POINT_RULESET_ID>\",\n    \"name\": \"default\",\n    \"description\": \"Define overrides for the Network-layer DDoS Attack Protection managed ruleset\",\n    \"kind\": \"root\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"id\": \"<RULE_ID>\",\n        \"version\": \"1\",\n        \"action\": \"execute\",\n        \"action_parameters\": {\n          \"id\": \"<MANAGED_RULESET_ID>\",\n          \"version\": \"latest\",\n          \"overrides\": {\n            \"categories\": [\n              {\n                \"category\": \"<TAG_NAME>\",\n                \"sensitivity_level\": \"low\"\n              }\n            ],\n            \"rules\": [\n              {\n                \"id\": \"<MANAGED_RULESET_RULE_ID>\",\n                \"action\": \"block\"\n              }\n            ],\n            \"sensitivity_level\": \"medium\"\n          }\n        },\n        \"expression\": \"ip.dst in { 1.1.1.0/24 }\",\n        \"last_updated\": \"2021-08-16T04:14:47.977741Z\",\n        \"ref\": \"<RULE_REF>\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2021-08-16T04:14:47.977741Z\",\n    \"phase\": \"ddos_l4\"\n  }\n}",
      "language": "json"
    },
    {
      "code": "sub.example.com CNAME sub.example.com.cdn.cloudflare.net",
      "language": "txt"
    },
    {
      "code": "sub.example.com CNAME sub.example.com.cdn.cloudflare.net",
      "language": "txt"
    },
    {
      "code": "198.41.144.240/28\n198.41.150.240/28\n2a06:98c0:3601::/48\n2a06:98c0:1401::/48",
      "language": "txt"
    },
    {
      "code": "172.65.64.6",
      "language": "txt"
    },
    {
      "code": "198.41.144.240/28\n198.41.150.240/28\n2a06:98c0:3601::/48\n2a06:98c0:1401::/48",
      "language": "txt"
    },
    {
      "code": "172.65.30.82\n172.65.50.145\n2606:4700:60:0:317:26ee:3bdf:5774\n2606:4700:60:0:35a:4be3:4144:c5ee",
      "language": "txt"
    },
    {
      "code": "allow-transfer {198.41.144.240/28;198.41.150.240/28;2a06:98c0:3601::/48;2a06:98c0:1401::/48;}\nalso-notify { 172.65.30.82;172.65.50.145;2606:4700:60:0:317:26ee:3bdf:5774;2606:4700:60:0:35a:4be3:4144:c5ee;}",
      "language": "txt"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dnssec\" \\\n  --request PATCH \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"status\": \"active\",\n    \"dnssec_multi_signer\": true\n  }'",
      "language": "bash"
    },
    {
      "code": "curl 'https://api.cloudflare.com/client/v4/zones/{zone_id}/dns_records' \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"type\": \"DNSKEY\",\n  \"name\": \"<ZONE_NAME>\",\n  \"data\": {\n    \"flags\": 256,\n    \"protocol\": 3,\n    \"algorithm\": 13,\n    \"public_key\": \"<PUBLIC_KEY>\"\n  },\n  \"ttl\": 3600\n}'",
      "language": "bash"
    },
    {
      "code": "curl 'https://api.cloudflare.com/client/v4/zones/{zone_id}/dnssec/zsk' \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\"",
      "language": "bash"
    },
    {
      "code": "$ dig <ZONE_NAME> dnskey @<CLOUDFLARE_NAMESERVER> +noall +answer | grep 256",
      "language": "sh"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_settings\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"multi_provider\": true\n    }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dnssec\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"status\": \"active\"\n    }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dnssec\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"dnssec_presigned\": true\n    }'",
      "language": "bash"
    },
    {
      "code": "curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_settings\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"secondary_overrides\": true\n    }'",
      "language": "bash"
    },
    {
      "code": "52.11.209.211\n52.89.255.11\n52.0.67.109\n54.173.50.115\n104.30.32.0/19\n158.51.64.0/26\n158.51.65.0/26\n134.195.26.0/23",
      "language": "txt"
    },
    {
      "code": "2405:8100:c400::/38",
      "language": "txt"
    },
    {
      "code": "52.58.35.43\n35.157.195.63",
      "language": "txt"
    },
    {
      "code": "104.30.32.0/24\n104.30.33.0/24\n104.30.34.0/24\n104.30.35.0/24\n104.30.36.0/24\n104.30.37.0/24\n104.30.38.0/24\n104.30.39.0/24\n104.30.40.0/24\n104.30.41.0/24\n104.30.42.0/24\n104.30.43.0/24\n104.30.44.0/24\n104.30.45.0/24\n104.30.46.0/24\n104.30.47.0/24\n104.30.48.0/24\n104.30.49.0/24\n104.30.50.0/24\n104.30.51.0/24\n104.30.52.0/24\n104.30.53.0/24\n104.30.54.0/24\n104.30.55.0/24\n104.30.56.0/24\n104.30.57.0/24\n104.30.58.0/24\n104.30.59.0/24\n104.30.60.0/24\n104.30.61.0/24\n104.30.62.0/24\n104.30.63.0/24\n134.195.26.0/24\n134.195.27.0/24",
      "language": "txt"
    },
    {
      "code": "dig mx <YOUR_DOMAIN>",
      "language": "sh"
    },
    {
      "code": "; <<>> DiG 9.10.6 <<>> mx <YOUR_DOMAIN>\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 39938\n;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 1\n\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;domain.    IN  MX\n\n\n;; ANSWER SECTION:\n<YOUR_DOMAIN>.  300  IN  MX  5 mailstream-central.mxrecord.mx.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-east.mxrecord.io.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-west.mxrecord.io.",
      "language": "sh"
    },
    {
      "code": "dig mx <YOUR_DOMAIN>",
      "language": "sh"
    },
    {
      "code": "; <<>> DiG 9.10.6 <<>> mx <YOUR_DOMAIN>\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 39938\n;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 1\n\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;domain.    IN  MX\n\n\n;; ANSWER SECTION:\n<YOUR_DOMAIN>.  300  IN  MX  5 mailstream-central.mxrecord.mx.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-east.mxrecord.io.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-west.mxrecord.io.",
      "language": "sh"
    },
    {
      "code": "dig mx <YOUR_DOMAIN>",
      "language": "sh"
    },
    {
      "code": "; <<>> DiG 9.10.6 <<>> mx <YOUR_DOMAIN>\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 39938\n;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 1\n\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;domain.    IN  MX\n\n\n;; ANSWER SECTION:\n<YOUR_DOMAIN>.  300  IN  MX  5 mailstream-central.mxrecord.mx.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-east.mxrecord.io.\n<YOUR_DOMAIN>.  300  IN  MX  10 mailstream-west.mxrecord.io.",
      "language": "sh"
    },
    {
      "code": "Install-Module ExchangeOnlineManagement",
      "language": "powershell"
    },
    {
      "code": "set-executionpolicy remotesigned",
      "language": "powershell"
    },
    {
      "code": "Import-Module ExchangeOnlineManagement",
      "language": "powershell"
    },
    {
      "code": "Connect-ExchangeOnline",
      "language": "powershell"
    },
    {
      "code": "Get-OrganizationConfig | FL isDehydrated",
      "language": "powershell"
    },
    {
      "code": "Enable-OrganizationCustomization",
      "language": "powershell"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Prefix",
      "id": "prefix"
    },
    {
      "level": "h2",
      "text": "Prefix in allowlist",
      "id": "prefix-in-allowlist"
    },
    {
      "level": "h2",
      "text": "SYN flood rule or out-of-state TCP rule",
      "id": "syn-flood-rule-or-out-of-state-tcp-rule"
    },
    {
      "level": "h2",
      "text": "Filter",
      "id": "filter"
    },
    {
      "level": "h2",
      "text": "Get Advanced TCP Protection status",
      "id": "get-advanced-tcp-protection-status"
    },
    {
      "level": "h2",
      "text": "Enable Advanced TCP Protection",
      "id": "enable-advanced-tcp-protection"
    },
    {
      "level": "h2",
      "text": "Get existing prefixes",
      "id": "get-existing-prefixes"
    },
    {
      "level": "h2",
      "text": "Add prefixes",
      "id": "add-prefixes"
    },
    {
      "level": "h2",
      "text": "Get all prefixes in allowlist",
      "id": "get-all-prefixes-in-allowlist"
    },
    {
      "level": "h2",
      "text": "Add a prefix to the allowlist",
      "id": "add-a-prefix-to-the-allowlist"
    },
    {
      "level": "h2",
      "text": "Create a SYN flood rule",
      "id": "create-a-syn-flood-rule"
    },
    {
      "level": "h2",
      "text": "Create an out-of-state TCP rule",
      "id": "create-an-out-of-state-tcp-rule"
    },
    {
      "level": "h2",
      "text": "Create a SYN flood filter",
      "id": "create-a-syn-flood-filter"
    },
    {
      "level": "h2",
      "text": "Create an out-of-state TCP filter",
      "id": "create-an-out-of-state-tcp-filter"
    },
    {
      "level": "h2",
      "text": "Configure an override for the HTTP DDoS Attack Protection managed ruleset",
      "id": "configure-an-override-for-the-http-ddos-attack-protection-managed-ruleset"
    },
    {
      "level": "h3",
      "text": "Creating multiple rules",
      "id": "creating-multiple-rules"
    },
    {
      "level": "h2",
      "text": "Example API calls",
      "id": "example-api-calls"
    },
    {
      "level": "h3",
      "text": "Zone-level configuration example",
      "id": "zone-level-configuration-example"
    },
    {
      "level": "h3",
      "text": "Account-level configuration example",
      "id": "account-level-configuration-example"
    },
    {
      "level": "h2",
      "text": "Access",
      "id": "access"
    },
    {
      "level": "h3",
      "text": "Create a DDoS override",
      "id": "create-a-ddos-override"
    },
    {
      "level": "h3",
      "text": "Delete a DDoS override",
      "id": "delete-a-ddos-override"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "Traffic from your mobile application is blocked by a DDoS Managed Rule",
      "id": "traffic-from-your-mobile-application-is-blocked-by-a-ddos-managed-rule"
    },
    {
      "level": "h3",
      "text": "Traffic is flagged by an adaptive rule based on the location and may be an attack",
      "id": "traffic-is-flagged-by-an-adaptive-rule-based-on-the-location-and-may-be-an-attack"
    },
    {
      "level": "h3",
      "text": "Legitimate traffic is incorrectly identified as an attack and causes a false positive",
      "id": "legitimate-traffic-is-incorrectly-identified-as-an-attack-and-causes-a-false-positive"
    },
    {
      "level": "h3",
      "text": "An attack is incorrectly identified as legitimate traffic and causes a false negative",
      "id": "an-attack-is-incorrectly-identified-as-legitimate-traffic-and-causes-a-false-negative"
    },
    {
      "level": "h3",
      "text": "Incomplete mitigations",
      "id": "incomplete-mitigations"
    },
    {
      "level": "h2",
      "text": "Available expression fields",
      "id": "available-expression-fields"
    },
    {
      "level": "h2",
      "text": "Configure an override for the Network-layer DDoS Attack Protection managed ruleset",
      "id": "configure-an-override-for-the-network-layer-ddos-attack-protection-managed-ruleset"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Create a DDoS override",
      "id": "create-a-ddos-override"
    },
    {
      "level": "h3",
      "text": "Delete a DDoS override",
      "id": "delete-a-ddos-override"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "VPN traffic is blocked by a UDP rule",
      "id": "vpn-traffic-is-blocked-by-a-udp-rule"
    },
    {
      "level": "h3",
      "text": "Attack traffic is flagged by the adaptive rule based on UDP and destination port",
      "id": "attack-traffic-is-flagged-by-the-adaptive-rule-based-on-udp-and-destination-port"
    },
    {
      "level": "h3",
      "text": "Minimize the risk of false positives impacting production traffic",
      "id": "minimize-the-risk-of-false-positives-impacting-production-traffic"
    },
    {
      "level": "h2",
      "text": "Available expression fields",
      "id": "available-expression-fields"
    },
    {
      "level": "h2",
      "text": "Important remarks",
      "id": "important-remarks"
    },
    {
      "level": "h3",
      "text": "Recommended vs. non-recommended fields",
      "id": "recommended-vs.-non-recommended-fields"
    },
    {
      "level": "h3",
      "text": "Character limits",
      "id": "character-limits"
    },
    {
      "level": "h2",
      "text": "Subdomain does not exist",
      "id": "subdomain-does-not-exist"
    },
    {
      "level": "h2",
      "text": "Subdomain already exists",
      "id": "subdomain-already-exists"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Subdomain does not exist",
      "id": "subdomain-does-not-exist"
    },
    {
      "level": "h2",
      "text": "Subdomain already exists",
      "id": "subdomain-already-exists"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Cloudflare as Primary",
      "id": "cloudflare-as-primary"
    },
    {
      "level": "h3",
      "text": "Allow range",
      "id": "allow-range"
    },
    {
      "level": "h3",
      "text": "Transfer IP",
      "id": "transfer-ip"
    },
    {
      "level": "h2",
      "text": "Cloudflare as Secondary",
      "id": "cloudflare-as-secondary"
    },
    {
      "level": "h3",
      "text": "Allow range",
      "id": "allow-range"
    },
    {
      "level": "h3",
      "text": "Notify IPs",
      "id": "notify-ips"
    },
    {
      "level": "h3",
      "text": "Bind server configuration",
      "id": "bind-server-configuration"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Steps",
      "id": "steps"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Create TSIG (optional)",
      "id": "1.-create-tsig-(optional)"
    },
    {
      "level": "h2",
      "text": "2. Create Peer DNS Server (optional)",
      "id": "2.-create-peer-dns-server-(optional)"
    },
    {
      "level": "h2",
      "text": "3. Link peer to primary zone (optional)",
      "id": "3.-link-peer-to-primary-zone-(optional)"
    },
    {
      "level": "h2",
      "text": "4. Update your secondary DNS provider",
      "id": "4.-update-your-secondary-dns-provider"
    },
    {
      "level": "h2",
      "text": "5. Add secondary nameservers within Cloudflare",
      "id": "5.-add-secondary-nameservers-within-cloudflare"
    },
    {
      "level": "h2",
      "text": "6. Enable outgoing zone transfers",
      "id": "6.-enable-outgoing-zone-transfers"
    },
    {
      "level": "h2",
      "text": "7. Add secondary nameservers to registrar",
      "id": "7.-add-secondary-nameservers-to-registrar"
    },
    {
      "level": "h2",
      "text": "Proxied records",
      "id": "proxied-records"
    },
    {
      "level": "h2",
      "text": "DNS-only CNAME records",
      "id": "dns-only-cname-records"
    },
    {
      "level": "h2",
      "text": "Records that are not transferred",
      "id": "records-that-are-not-transferred"
    },
    {
      "level": "h2",
      "text": "Set up multi-signer DNSSEC",
      "id": "set-up-multi-signer-dnssec"
    },
    {
      "level": "h2",
      "text": "Set up live signing DNSSEC",
      "id": "set-up-live-signing-dnssec"
    },
    {
      "level": "h2",
      "text": "Set up pre-signed DNSSEC",
      "id": "set-up-pre-signed-dnssec"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Steps",
      "id": "steps"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h3",
      "text": "At your primary DNS provider",
      "id": "at-your-primary-dns-provider"
    },
    {
      "level": "h3",
      "text": "At Cloudflare",
      "id": "at-cloudflare"
    },
    {
      "level": "h2",
      "text": "1. Create TSIG (optional)",
      "id": "1.-create-tsig-(optional)"
    },
    {
      "level": "h2",
      "text": "2. Create Peer Server",
      "id": "2.-create-peer-server"
    },
    {
      "level": "h2",
      "text": "3. Create the Secondary Zone",
      "id": "3.-create-the-secondary-zone"
    },
    {
      "level": "h2",
      "text": "4. Update registrar",
      "id": "4.-update-registrar"
    },
    {
      "level": "h2",
      "text": "5. Create notifications (optional)",
      "id": "5.-create-notifications-(optional)"
    },
    {
      "level": "h2",
      "text": "6. Proxy traffic through Cloudflare (optional)",
      "id": "6.-proxy-traffic-through-cloudflare-(optional)"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Set up Secondary DNS override",
      "id": "set-up-secondary-dns-override"
    },
    {
      "level": "h2",
      "text": "Proxied A and AAAA records",
      "id": "proxied-a-and-aaaa-records"
    },
    {
      "level": "h2",
      "text": "CNAME record on the zone apex",
      "id": "cname-record-on-the-zone-apex"
    },
    {
      "level": "h2",
      "text": "Verify that your records are proxied",
      "id": "verify-that-your-records-are-proxied"
    },
    {
      "level": "h2",
      "text": "Scan for threats",
      "id": "scan-for-threats"
    },
    {
      "level": "h2",
      "text": "Analyze results",
      "id": "analyze-results"
    },
    {
      "level": "h2",
      "text": "Configure Inbound Rule",
      "id": "configure-inbound-rule"
    },
    {
      "level": "h2",
      "text": "Email processing and reports",
      "id": "email-processing-and-reports"
    },
    {
      "level": "h2",
      "text": "User roles",
      "id": "user-roles"
    },
    {
      "level": "h2",
      "text": "Set up Microsoft Graph API",
      "id": "set-up-microsoft-graph-api"
    },
    {
      "level": "h2",
      "text": "Azure applications",
      "id": "azure-applications"
    },
    {
      "level": "h3",
      "text": "Directory Integration",
      "id": "directory-integration"
    },
    {
      "level": "h3",
      "text": "Retraction",
      "id": "retraction"
    },
    {
      "level": "h2",
      "text": "Journaling",
      "id": "journaling"
    },
    {
      "level": "h3",
      "text": "1. Configure connector for delivery to Email security (formerly Area 1) (if required)",
      "id": "1.-configure-connector-for-delivery-to-email-security-(formerly-area-1)-(if-required)"
    },
    {
      "level": "h3",
      "text": "2. Configure journal rule",
      "id": "2.-configure-journal-rule"
    },
    {
      "level": "h3",
      "text": "3. Compliance",
      "id": "3.-compliance"
    },
    {
      "level": "h2",
      "text": "Geographic locations",
      "id": "geographic-locations"
    },
    {
      "level": "h2",
      "text": "United States",
      "id": "united-states"
    },
    {
      "level": "h3",
      "text": "IPv4",
      "id": "ipv4"
    },
    {
      "level": "h3",
      "text": "IPv6",
      "id": "ipv6"
    },
    {
      "level": "h2",
      "text": "Europe",
      "id": "europe"
    },
    {
      "level": "h2",
      "text": "India",
      "id": "india"
    },
    {
      "level": "h2",
      "text": "Australia / New Zealand",
      "id": "australia-/-new-zealand"
    },
    {
      "level": "h2",
      "text": "Office 365 `/24` addresses",
      "id": "office-365-`/24`-addresses"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Add a Sender Group for Email security Email Protection IPs",
      "id": "1.-add-a-sender-group-for-email-security-email-protection-ips"
    },
    {
      "level": "h2",
      "text": "2. Configure Incoming Relays",
      "id": "2.-configure-incoming-relays"
    },
    {
      "level": "h2",
      "text": "3. Disable SPF checks",
      "id": "3.-disable-spf-checks"
    },
    {
      "level": "h2",
      "text": "4. Update your domain MX records",
      "id": "4.-update-your-domain-mx-records"
    },
    {
      "level": "h2",
      "text": "1. Add a Sender Group for Email security Email Protection IPs",
      "id": "1.-add-a-sender-group-for-email-security-email-protection-ips"
    },
    {
      "level": "h2",
      "text": "2. Add SMTP route for the Email security Email Protection Hosts",
      "id": "2.-add-smtp-route-for-the-email-security-email-protection-hosts"
    },
    {
      "level": "h2",
      "text": "3. Create Incoming Content Filters",
      "id": "3.-create-incoming-content-filters"
    },
    {
      "level": "h3",
      "text": "Incoming Content Filter - To Email security",
      "id": "incoming-content-filter---to-email-security"
    },
    {
      "level": "h3",
      "text": "Incoming Content Filter - From Email security",
      "id": "incoming-content-filter---from-email-security"
    },
    {
      "level": "h2",
      "text": "4. Add the Incoming Content Filter to the Inbound Policy table",
      "id": "4.-add-the-incoming-content-filter-to-the-inbound-policy-table"
    },
    {
      "level": "h2",
      "text": "5. Geographic locations",
      "id": "5.-geographic-locations"
    },
    {
      "level": "h2",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Add Email security IP addresses to the Inbound gateway configuration",
      "id": "1.-add-email-security-ip-addresses-to-the-inbound-gateway-configuration"
    },
    {
      "level": "h2",
      "text": "2. Quarantine malicious detections",
      "id": "2.-quarantine-malicious-detections"
    },
    {
      "level": "h3",
      "text": "Create Email security Malicious Quarantine",
      "id": "create-email-security-malicious-quarantine"
    },
    {
      "level": "h3",
      "text": "Create a content compliance filter to send malicious messages to quarantine",
      "id": "create-a-content-compliance-filter-to-send-malicious-messages-to-quarantine"
    },
    {
      "level": "h2",
      "text": "3. Add your domain to Email security",
      "id": "3.-add-your-domain-to-email-security"
    },
    {
      "level": "h2",
      "text": "4. Update your domain MX records",
      "id": "4.-update-your-domain-mx-records"
    },
    {
      "level": "h2",
      "text": "5. Secure your email flow",
      "id": "5.-secure-your-email-flow"
    },
    {
      "level": "h2",
      "text": "6. Send Email security spam to user spam folder (optional)",
      "id": "6.-send-email-security-spam-to-user-spam-folder-(optional)"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Add Email security IP addresses to Allow List",
      "id": "1.-add-email-security-ip-addresses-to-allow-list"
    },
    {
      "level": "h2",
      "text": "2. Enhanced Filtering configuration",
      "id": "2.-enhanced-filtering-configuration"
    },
    {
      "level": "h3",
      "text": "Create an inbound connector",
      "id": "create-an-inbound-connector"
    },
    {
      "level": "h3",
      "text": "Enable enhanced filtering",
      "id": "enable-enhanced-filtering"
    },
    {
      "level": "h2",
      "text": "3. Configure Email security quarantine policies",
      "id": "3.-configure-email-security-quarantine-policies"
    },
    {
      "level": "h3",
      "text": "Select the disposition you want to quarantine",
      "id": "select-the-disposition-you-want-to-quarantine"
    },
    {
      "level": "h3",
      "text": "Manage the Admin Quarantine",
      "id": "manage-the-admin-quarantine"
    },
    {
      "level": "h2",
      "text": "4. Message handling",
      "id": "4.-message-handling"
    },
    {
      "level": "h2",
      "text": "5. Update your domain MX records",
      "id": "5.-update-your-domain-mx-records"
    },
    {
      "level": "h3",
      "text": "Secure Office 365 from MX records bypass (recommended)",
      "id": "secure-office-365-from-mx-records-bypass-(recommended)"
    },
    {
      "level": "h2",
      "text": "6 Execute `Enable-OrganizationCustomization` (if required)",
      "id": "6-execute-`enable-organizationcustomization`-(if-required)"
    },
    {
      "level": "h2",
      "text": "1. Create a service account in Google for Email security Directory Integration",
      "id": "1.-create-a-service-account-in-google-for-email-security-directory-integration"
    },
    {
      "level": "h2",
      "text": "2. Authorize Email security for Directory Access with Google",
      "id": "2.-authorize-email-security-for-directory-access-with-google"
    },
    {
      "level": "h2",
      "text": "3. Configure the Business Email Compromise list",
      "id": "3.-configure-the-business-email-compromise-list"
    },
    {
      "level": "h2",
      "text": "4. Configure secondary email address (if required)",
      "id": "4.-configure-secondary-email-address-(if-required)"
    },
    {
      "level": "h2",
      "text": "1. Authorize Email security with Office 365 for Directory Access",
      "id": "1.-authorize-email-security-with-office-365-for-directory-access"
    },
    {
      "level": "h3",
      "text": "How does the authorization work?",
      "id": "how-does-the-authorization-work?"
    },
    {
      "level": "h2",
      "text": "2. Configure the Business Email Compromise list",
      "id": "2.-configure-the-business-email-compromise-list"
    },
    {
      "level": "h2",
      "text": "3. Configure secondary email address (if required)",
      "id": "3.-configure-secondary-email-address-(if-required)"
    },
    {
      "level": "h2",
      "text": "Set up the Enterprise application",
      "id": "set-up-the-enterprise-application"
    },
    {
      "level": "h2",
      "text": "Provision the Enterprise application",
      "id": "provision-the-enterprise-application"
    },
    {
      "level": "h2",
      "text": "Configure user and group synchronization",
      "id": "configure-user-and-group-synchronization"
    },
    {
      "level": "h2",
      "text": "(Optional) Automate Cloudflare's SCIM integration",
      "id": "(optional)-automate-cloudflare's-scim-integration"
    }
  ],
  "url": "llms-txt#json-object",
  "links": []
}