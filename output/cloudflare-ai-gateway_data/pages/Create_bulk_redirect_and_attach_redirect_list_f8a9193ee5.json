{
  "title": "Create bulk redirect and attach redirect list",
  "content": "resource \"cloudflare_ruleset\" \"bulk_root_redirect_to_id\" {\n  account_id  = var.cloudflare_account_id\n  name        = var.bulk_redirect_list_name\n  description = var.bulk_redirect_list_description\n  kind        = \"root\"\n  phase       = \"http_request_redirect\"\n\nrules {\n    action = \"redirect\"\n    action_parameters {\n      from_list {\n        name = var.bulk_redirect_list_name\n        key  = \"http.request.full_uri\"\n      }\n    }\n    expression  = \"http.request.full_uri in ${\"$\"}${var.bulk_redirect_list_name}\"\n    description = var.bulk_redirect_list_description\n    enabled     = true\n  }\n\ndepends_on = [\n    cloudflare_list_item.bulk_redirect_to_id_item\n  ]\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets\" \\\n  --request POST \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"Redirect rules ruleset\",\n    \"kind\": \"zone\",\n    \"phase\": \"http_request_dynamic_redirect\",\n    \"rules\": [\n        {\n            \"ref\": \"redirect_gb_fr_to_localized\",\n            \"expression\": \"(ip.src.country eq \\\"GB\\\" or ip.src.country eq \\\"FR\\\") and http.request.uri.path eq \\\"/\\\"\",\n            \"description\": \"Redirect GB and FR users in home page to localized site.\",\n            \"action\": \"redirect\",\n            \"action_parameters\": {\n                \"from_value\": {\n                    \"target_url\": {\n                        \"expression\": \"lower(concat(\\\"https://\\\", ip.src.country, \\\".example.com\\\"))\"\n                    },\n                    \"status_code\": 307,\n                    \"preserve_query_string\": true\n                }\n            }\n        }\n    ]\n  }'\njson\n{\n  \"result\": {\n    \"id\": \"528f4f03bf0da53a29907199625867be\",\n    \"name\": \"Redirect rules ruleset\",\n    \"kind\": \"zone\",\n    \"version\": \"1\",\n    \"rules\": [\n      {\n        \"ref\": \"redirect_gb_fr_to_localized\",\n        \"id\": \"235e557b92fd4e5e8753ee665a9ddd75\",\n        \"version\": \"1\",\n        \"expression\": \"(ip.src.country eq \\\"GB\\\" or ip.src.country eq \\\"FR\\\") and http.request.uri.path eq \\\"/\\\"\",\n        \"description\": \"Redirect GB and FR users in home page to localized site.\",\n        \"action\": \"redirect\",\n        \"action_parameters\": {\n          \"from_value\": {\n            \"target_url\": {\n              \"expression\": \"lower(concat(\\\"https://\\\", ip.src.country, \\\".example.com\\\"))\"\n            },\n            \"status_code\": 307,\n            \"preserve_query_string\": true\n          }\n        },\n        \"last_updated\": \"2022-09-28T09:20:42Z\"\n      }\n    ],\n    \"last_updated\": \"2022-09-28T09:20:42Z\",\n    \"phase\": \"http_request_dynamic_redirect\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/$RULESET_ID\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"name\": \"Redirect rules ruleset\",\n    \"kind\": \"zone\",\n    \"phase\": \"http_request_dynamic_redirect\",\n    \"rules\": [\n        {\n            \"ref\": \"redirect_gb_fr_to_localized\",\n            \"expression\": \"(ip.src.country eq \\\"GB\\\" or ip.src.country eq \\\"FR\\\") and http.request.uri.path eq \\\"/\\\"\",\n            \"description\": \"Redirect GB and FR users in home page to localized site.\",\n            \"action\": \"redirect\",\n            \"action_parameters\": {\n                \"from_value\": {\n                    \"target_url\": {\n                        \"expression\": \"lower(concat(\\\"https://\\\", ip.src.country, \\\".example.com\\\"))\"\n                    },\n                    \"status_code\": 307,\n                    \"preserve_query_string\": true\n                }\n            }\n        },\n        {\n            \"ref\": \"redirect_contacts_to_new_page\",\n            \"expression\": \"http.request.uri.path eq \\\"/contacts.html\\\"\",\n            \"description\": \"Redirect to new contacts page.\",\n            \"action\": \"redirect\",\n            \"action_parameters\": {\n                \"from_value\": {\n                    \"target_url\": {\n                        \"value\": \"https://example.com/contact-us/\"\n                    },\n                    \"status_code\": 308\n                }\n            }\n        }\n    ]\n  }'\njson\n{\n  \"result\": {\n    \"id\": \"528f4f03bf0da53a29907199625867be\",\n    \"name\": \"Redirect rules ruleset\",\n    \"description\": \"\",\n    \"kind\": \"zone\",\n    \"version\": \"2\",\n    \"rules\": [\n      {\n        \"ref\": \"redirect_gb_fr_to_localized\",\n        \"id\": \"235e557b92fd4e5e8753ee665a9ddd75\",\n        \"version\": \"1\",\n        \"action\": \"redirect\",\n        \"action_parameters\": {\n          \"from_value\": {\n            \"target_url\": {\n              \"expression\": \"lower(concat(\\\"https://\\\", ip.src.country, \\\".example.com\\\"))\"\n            },\n            \"status_code\": 307,\n            \"preserve_query_string\": true\n          }\n        },\n        \"expression\": \"(ip.src.country eq \\\"GB\\\" or ip.src.country eq \\\"FR\\\") and http.request.uri.path eq \\\"/\\\"\",\n        \"description\": \"Redirect GB and FR users in home page to localized site.\",\n        \"last_updated\": \"2022-10-03T15:38:51.658387Z\",\n        \"ref\": \"235e557b92fd4e5e8753ee665a9ddd75\",\n        \"enabled\": true\n      },\n      {\n        \"ref\": \"redirect_contacts_to_new_page\",\n        \"id\": \"cfad5efbfcd1440fb5b30cf30f95ece3\",\n        \"version\": \"1\",\n        \"action\": \"redirect\",\n        \"action_parameters\": {\n          \"from_value\": {\n            \"target_url\": {\n              \"value\": \"https://example.com/contact-us/\"\n            },\n            \"status_code\": 308\n          }\n        },\n        \"expression\": \"http.request.uri.path eq \\\"/contacts.html\\\"\",\n        \"description\": \"Redirect to new contacts page.\",\n        \"last_updated\": \"2022-10-03T15:38:51.658387Z\",\n        \"ref\": \"cfad5efbfcd1440fb5b30cf30f95ece3\",\n        \"enabled\": true\n      }\n    ],\n    \"last_updated\": \"2022-10-03T15:38:51.658387Z\",\n    \"phase\": \"http_request_dynamic_redirect\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\njson\n\"action_parameters\": {\n  \"from_value\": {\n    \"target_url\": {\n      \"value\": \"<STATIC_URL_VALUE>\"\n    },\n    \"status_code\": <STATUS_CODE>,\n    \"preserve_query_string\": <BOOLEAN_VALUE>\n  }\n}\njson\n\"action_parameters\": {\n  \"from_value\": {\n    \"target_url\": {\n      \"expression\": \"<DYNAMIC_URL_EXPRESSION>\"\n    },\n    \"status_code\": <STATUS_CODE>,\n    \"preserve_query_string\": <BOOLEAN_VALUE>\n  }\n}\ntf",
  "code_samples": [
    {
      "code": "## Required token permissions\n\nYour API token must have at least the following [permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/):\n\n* Dashboard\n\n  * Account Filter Lists > Edit\n  * Bulk URL Redirects > Edit\n\n* API\n\n  * Account Rule Lists Write\n  * Bulk URL Redirects Write\n\n## Additional resources\n\nFor additional guidance on using Terraform with Cloudflare, refer to the following resources:\n\n* [Terraform documentation](https://developers.cloudflare.com/terraform/)\n* [Cloudflare Provider for Terraform](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) (reference documentation)\n\n</page>\n\n<page>\n---\ntitle: Create a redirect rule via API · Cloudflare Rules docs\ndescription: Use the Rulesets API to create a redirect rule via API.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-api/\n  md: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-api/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to create a redirect rule via API.\n\nAdd redirect rules to the entry point ruleset of the `http_request_dynamic_redirect` phase at the zone level. Refer to the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) documentation for more information on [creating a ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/create/) and supplying a list of rules for the ruleset.\n\nNote\n\nSingle Redirects require that the incoming traffic for the hostname referenced in visitors' requests is [proxied by Cloudflare](https://developers.cloudflare.com/dns/proxy-status/).\n\n## Basic rule settings\n\nA redirect rule must have:\n\n* `action` set to `redirect`\n* An `action_parameters` object with additional configuration settings — refer to [Available settings](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/) for details.\n\n## Example requests\n\nThe following request of the [Create a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/create/) operation creates a phase entry point ruleset for the `http_request_dynamic_redirect` phase at the zone level, and defines a single redirect rule with a dynamic URL redirect. Use this operation if you have not created a phase entry point ruleset for the `http_request_dynamic_redirect` phase yet.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "Response",
      "language": "unknown"
    },
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\nIf there is already a phase entry point ruleset for the `http_request_dynamic_redirect` phase, use the [Update a zone ruleset](https://developers.cloudflare.com/api/resources/rulesets/methods/update/) operation instead, like in the following example:\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "Response",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Required API token permissions\n\nThe API token used in API requests to manage redirect rules must have at least the following permission:\n\n* *Zone* > *Single Redirect* > *Edit*\n\n</page>\n\n<page>\n---\ntitle: Create a redirect rule in the dashboard · Cloudflare Rules docs\nlastUpdated: 2025-09-24T12:01:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/\n  md: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/index.md\n---\n\n1. In the Cloudflare dashboard, go to the Rules **Overview** page.\n\n   [Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/rules/overview)\n\n2. Select **Create rule** > **Redirect Rule**.\n\n3. (Optional) Select one of the rule templates that address common use cases. Then, review and adjust the proposed rule configuration.\n\n4. Enter a descriptive name for the rule in **Rule name**.\n\n5. Under **When incoming requests match**, select one of the following options:\n\n   * **Wildcard pattern**: The rule will only apply to traffic matching the wildcard pattern.\n\n     * **Request URL**: Enter the [wildcard pattern](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) using the asterisk (`*`) character to match multiple requests. For example, `http*://*.example.com/files/*`.\n\n     * **Then**: Define the [URL redirect settings](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/) including:\n\n       * **Target URL**: Enter the target URL, which can be static (for example, `https://example.com`) or dynamic (for example, `https://example.com/${1}/files/${2}`). Use [wildcard replacement](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#wildcard_replace) such as `${1}` and `${2}` to define dynamic target URLs.\n       * **Status code**: Select the status code for the redirect (for example, `301`).\n       * **Preserve query string**: Choose whether to keep the query string from the original request.\n\n   * **All incoming requests**: The rule will apply to all traffic.\n     * **Then**: Define the [URL redirect settings](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/) for all incoming requests.\n\n   * **Custom filter expression**: The rule will only apply to traffic matching a custom expression. Define the [rule expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/) to configure which requests should be redirected.\n     * **Then**: Define the [URL redirect settings](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/) for requests matching the custom rule expression.\n\n6. To save and deploy your rule, select **Deploy**. If you are not ready to deploy your rule, select **Save as Draft**.\n\n   If you are matching a hostname in your rule expression, you may be prompted to create a proxied DNS record for that hostname. Refer to [Troubleshooting](https://developers.cloudflare.com/rules/reference/troubleshooting/#this-rule-may-not-apply-to-your-traffic) for more information.\n\nNote\n\nSingle Redirects require that the incoming traffic for the hostname referenced in visitors' requests is [proxied by Cloudflare](https://developers.cloudflare.com/dns/proxy-status/).\n\n</page>\n\n<page>\n---\ntitle: Single Redirects settings · Cloudflare Rules docs\ndescription: The following sections describe the settings of redirect rules to\n  configure static and dynamic URL redirects.\nlastUpdated: 2025-09-11T15:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/\n  md: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/settings/index.md\n---\n\nThe following sections describe the settings of redirect rules to configure static and dynamic URL redirects.\n\n## Wildcard URL Redirect\n\nPerforms a URL redirect using [wildcard patterns](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) to match multiple requests. This method simplifies defining source and target URL patterns without needing complex expressions.\n\nA wildcard URL redirect has the following configuration parameters:\n\n* **Request URL**: Enter the [wildcard pattern](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#wildcard-matching) using the asterisk (`*`) character to match multiple requests. For example, `https://*.example.com/files/*`.\n\n* **Target URL**: Enter the target URL, which can be static (for example, `https://example.com`) or dynamic (for example, `https://example.com/${1}/files/${2}`). Use [wildcard replacement](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#wildcard_replace) like `${1}`, `${2}`, etc., to define dynamic targets.\n\n* **Status code**: The HTTP status code of the redirect response (*301* by default). Must be one of the following: *301* (Moved permanently), *302* (Found, also known as Moved temporarily), *307* (Temporary redirect), or *308* (Permanent redirect).\n\n* **Preserve query string**: Whether to preserve the query string when redirecting (disabled by default).\n\n## Static URL redirect\n\nPerforms a static URL redirect with a given HTTP status code and optionally preserves the query string.\n\nA static URL redirect has the following configuration parameters:\n\n* **URL**: A literal string that will be used in the `Location` HTTP header returned in the redirect response.\n\n* **Status code**: The HTTP status code of the redirect response (*301* by default). Must be one of the following: *301* (Moved permanently), *302* (Found, also known as Moved temporarily), *307* (Temporary redirect), or *308* (Permanent redirect).\n\n* **Preserve query string**: Whether to preserve the query string when redirecting (disabled by default).\n\nAPI information\n\nThe full syntax of the `\"action_parameters\"` field for a redirect rule performing a static URL redirect is the following:",
      "language": "unknown"
    },
    {
      "code": "The only required parameter is `<STATIC_URL_VALUE>`.\n\nThe optional parameters can have the following values:\n\n* `\"status_code\"` (integer): `301` (Moved permanently), `302` (Found, also known as Moved temporarily), `307` (Temporary redirect), or `308` (Permanent redirect).\n* `\"preserve_query_string\"` (boolean): `true` or `false`.\n\n## Dynamic URL redirect\n\nPerforms a dynamic URL redirect, where the target URL is determined by an expression. You can configure the redirect HTTP status code and whether to preserve the query string when redirecting.\n\nA dynamic URL redirect has the following configuration parameters:\n\n* **Expression**: An [expression](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/) that defines the target URL of the redirect. The result of evaluating this expression will be used in the `Location` HTTP header returned in the redirect response. Refer to the [fields](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/) and [functions](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/) you can use in expressions.\n\n* **Status code**: The HTTP status code of the redirect response (*301* by default). Must be one of the following: *301* (Moved permanently), *302* (Found, also known as Moved temporarily), *307* (Temporary redirect), or *308* (Permanent redirect).\n\n* **Preserve query string**: Whether to preserve the query string when redirecting (disabled by default).\n\nAPI information\n\nThe full syntax of the `\"action_parameters\"` field for a redirect rule performing a dynamic URL redirect is the following:",
      "language": "unknown"
    },
    {
      "code": "The only required parameter is `<DYNAMIC_URL_EXPRESSION>`.\n\nThe optional parameters can have the following values:\n\n* `\"status_code\"` (integer): `301` (Moved permanently), `302` (Found, also known as Moved temporarily), `307` (Temporary redirect), or `308` (Permanent redirect).\n* `\"preserve_query_string\"` (boolean): `true` or `false`.\n\n</page>\n\n<page>\n---\ntitle: Create a redirect rule using Terraform · Cloudflare Rules docs\ndescription: The following example defines a single redirect rule for a zone\n  using Terraform. The rule creates a static URL redirect for visitors\n  requesting the contacts page using an old URL.\nlastUpdated: 2025-08-22T14:24:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/terraform-example/\n  md: https://developers.cloudflare.com/rules/url-forwarding/single-redirects/terraform-example/index.md\n---\n\nNote\n\nTerraform code snippets below refer to the v4 SDK only.\n\nThe following example defines a single redirect rule for a zone using Terraform. The rule creates a static URL redirect for visitors requesting the contacts page using an old URL.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Required token permissions",
      "id": "required-token-permissions"
    },
    {
      "level": "h2",
      "text": "Additional resources",
      "id": "additional-resources"
    },
    {
      "level": "h2",
      "text": "Basic rule settings",
      "id": "basic-rule-settings"
    },
    {
      "level": "h2",
      "text": "Example requests",
      "id": "example-requests"
    },
    {
      "level": "h2",
      "text": "Required API token permissions",
      "id": "required-api-token-permissions"
    },
    {
      "level": "h2",
      "text": "Wildcard URL Redirect",
      "id": "wildcard-url-redirect"
    },
    {
      "level": "h2",
      "text": "Static URL redirect",
      "id": "static-url-redirect"
    },
    {
      "level": "h2",
      "text": "Dynamic URL redirect",
      "id": "dynamic-url-redirect"
    }
  ],
  "url": "llms-txt#create-bulk-redirect-and-attach-redirect-list",
  "links": []
}