{
  "title": "Single Redirects resource",
  "content": "resource \"cloudflare_ruleset\" \"single_redirects_example\" {\n  zone_id     = \"<ZONE_ID>\"\n  name        = \"redirects\"\n  description = \"Redirects ruleset\"\n  kind        = \"zone\"\n  phase       = \"http_request_dynamic_redirect\"\n\nrules {\n    ref         = \"redirect_old_url\"\n    description = \"Redirect visitors still using old URL\"\n    expression  = \"(http.request.uri.path matches \\\"^/contact-us/\\\")\"\n    action      = \"redirect\"\n    action_parameters {\n      from_value {\n        status_code = 301\n        target_url {\n          value = \"/contacts/\"\n        }\n        preserve_query_string = false\n      }\n    }\n  }\n}\ntxt\n   ip.src.country == \"GB\" and http.request.full_uri in $uk_redirect_list\n   bash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"wordpress\",\n                            \"enabled\": false\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"wordpress\",\n                            \"enabled\": false\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"block\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"block\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID_1>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"id\": \"<RULE_ID_2>\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID_1>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"id\": \"<RULE_ID_2>\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/ddos_l7/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<HTTP_DDOS_RULESET_ID>\",\n                \"overrides\": {\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"sensitivity_level\": \"low\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"drupal\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"drupal\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nsql\n(ip.src.country ne \"GB\")\ntxt",
  "code_samples": [
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n## Additional resources\n\nFor additional guidance on using Terraform with Cloudflare, refer to the following resources:\n\n* [Terraform documentation](https://developers.cloudflare.com/terraform/)\n* [Cloudflare Provider for Terraform](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) (reference documentation)\n\n</page>\n\n<page>\n---\ntitle: Perform mobile redirects · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect visitors using mobile devices to\n  a different hostname.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/perform-mobile-redirects/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/perform-mobile-redirects/index.md\n---\n\nThe following examples will redirect visitors using mobile devices — based on the request user agent string — to a different hostname.\n\n## Redirect mobile users dropping the original URI path\n\nThis example static redirect will redirect requests for the current zone (`example.com`) from mobile users to `m.example.com` without preserving the URI path in the original HTTP request.\n\n**When incoming requests match**\n\n* Enter the following expression in the [Expression Editor](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-editor):\\\n  `not http.host in {\"m.example.com\"} and (http.user_agent contains \"mobi\" or http.user_agent contains \"Mobi\")`\n\n**Then**\n\n* **Type:** *Static*\n* **URL:** `m.example.com`\n* **Status code:** *301*\n\nNotes about this example:\n\n* The `not http.host in {\"m.example.com\"}` condition prevents redirect loops.\n* The user agent condition follows [Mozilla's recommendation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/User-Agent/Firefox#device-specific_user_agent_strings) for identifying mobile devices.\n* The **Then** > **URL** value should be the same as the one you entered in the `http.host` condition of the rule's filter expression.\n* You can redirect users to other zones on Cloudflare or to other hostnames not on Cloudflare.\n\n## Redirect mobile users keeping the original path\n\nThis example single redirect will redirect requests for the current zone (`example.com`) from mobile users to `m.example.com`, keeping the URI path of the original HTTP request.\n\n**When incoming requests match**\n\n* Enter the following expression in the [Expression Editor](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-editor):\\\n  `not http.host in {\"m.example.com\"} and (http.user_agent contains \"mobi\" or http.user_agent contains \"Mobi\")`\n\n**Then**\n\n* **Type:** *Dynamic*\n* **Expression:** `concat(\"https://m.example.com\", http.request.uri.path)`\n* **Status code:** *301*\n\nNotes about this example:\n\n* The `not http.host in {\"m.example.com\"}` condition prevents redirect loops.\n* The user agent condition follows [Mozilla's recommendation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/User-Agent/Firefox#device-specific_user_agent_strings) for identifying mobile devices.\n* The hostname in **Then** > **Expression** should be the same as the one you entered in the `http.host` condition of the rule's filter expression.\n* Depending on your use case, you may want to enable **Then** > **Preserve query string** to also keep the query string of the original request.\n* You can redirect users to other zones on Cloudflare or to other hostnames not on Cloudflare.\n\n</page>\n\n<page>\n---\ntitle: Redirect admin area requests to HTTPS · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect requests for the administration\n  area of `store.example.com` to HTTPS, keeping the original path and query\n  string.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-admin-https/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-admin-https/index.md\n---\n\nThis example single redirect for zone `example.com` will redirect requests for the administration area of a specific subdomain (`store.example.com`) to HTTPS, keeping the original path and query string.\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `http://store.example.com/admin*`\n\n**Then**\n\n* **Target URL**: `https://store.example.com/admin${1}`\n* **Status code:** *301*\n* **Preserve query string:** Enabled\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `http://store.example.com/admin/products/` | `https://store.example.com/admin/products/` | `301` |\n| `https://store.example.com/admin/products/` | (unchanged) | n/a |\n| `http://store.example.com/admin/?logged_out=true` | `https://store.example.com/admin/?logged_out=true` | `301` |\n| `http://store.example.com/?all_items=true` | (unchanged) | n/a |\n| `http://example.com/admin/` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Redirect requests from one domain to another · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect all requests to a different\n  domain, maintaining all functionality, except for the discontinued HTTP\n  service (port 80).\nlastUpdated: 2025-11-07T12:30:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-another-domain/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-another-domain/index.md\n---\n\nIn this example the original domain was replaced with a different domain. All functionality was maintained, except for the HTTP service (port 80) which was discontinued.\n\n[Create a redirect rule](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) with the following configuration:\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `http*://example.com/*`\n\n**Then**\n\n* **Target URL**: `https://example.net/${2}`\n* **Status code:** *301*\n* **Preserve query string:** Enabled\n\nThis configuration will perform the following redirects:\n\n| Request URL | URL after redirect | Status code |\n| - | - | - |\n| `http://example.com/` | `https://example.net/` | `301` |\n| `https://example.com/` | `https://example.net/` | `301` |\n| `https://example.com/my/path/to/page.htm` | `https://example.net/my/path/to/page.htm` | `301` |\n| `https://example.com/search?q=term` | `https://example.net/search?q=term` | `301` |\n\n</page>\n\n<page>\n---\ntitle: Redirect requests from one country to a domain · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect all website visitors from the\n  United Kingdom to a different domain, maintaining the current functionality in\n  the same paths.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-country/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-country/index.md\n---\n\nIn this example, all website visitors from the United Kingdom will be redirected to a different domain, but maintaining current functionality in the same paths.\n\n1. Create a Bulk Redirect List named `uk_redirect_list` with the following URL redirect:\n\n   * **Source URL**: `https://example.com/`\n   * **Target URL**: `https://example.co.uk/`\n   * **Subpath matching**: Enabled\n   * **Preserve query string**: Enabled\n\n2. Create a Bulk Redirect Rule that enables the previous Bulk Redirect List and set the rule expression to the following:",
      "language": "unknown"
    },
    {
      "code": "This configuration will perform the following redirects for UK visitors:\n\n| Request URL | URL after redirect |\n| - | - |\n| `https://example.com/` | `https://example.co.uk/` |\n| `https://example.com/my/path/to/page.htm` | `https://example.co.uk/my/path/to/page.htm` |\n| `https://example.com/search?q=term` | `https://example.co.uk/search?q=term` |\n\n</page>\n\n<page>\n---\ntitle: Redirect requests for a domain to a new domain · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect all URLs for a domain to point\n  to the root of a new domain, including any subdomains of the old domain.\nlastUpdated: 2025-11-07T12:38:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-domain-root/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-domain-root/index.md\n---\n\nIn this example, an old website was discontinued and replaced by a new one in a different domain. The functionality is different, and all URLs should now point to the root of the new domain. The same applies to any subdomains of the old domain.\n\n[Create a redirect rule](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/create-dashboard/) with the following configuration:\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `http*://*example.com/*`\n\n**Then**\n\n* **Target URL**: `https://example.net/`\n* **Status code:** *301*\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `http://example.com/` | `https://example.net/` | `301` |\n| `https://example.com/` | `https://example.net/` | `301` |\n| `https://subdomain.example.com/` | `https://example.net/` | `301` |\n| `https://example.com/my/path/to/page.htm` | `https://example.net/` | `301` |\n| `https://example.com/search?q=term` | `https://example.net/` | `301` |\n\n</page>\n\n<page>\n---\ntitle: Redirect requests to a different hostname · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect all requests for\n  `smallshop.example.com` to a different hostname using HTTPS, keeping the\n  original path and query string.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-hostname/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-all-different-hostname/index.md\n---\n\nThis example single redirect will redirect all requests for `smallshop.example.com` to a different hostname `globalstore.example.net` using HTTPS, keeping the original path and query string.\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `http*://smallshop.example.com/*`\n\n**Then**\n\n* **Target URL**: `https://globalstore.example.net/${2}`\n* **Status code:** *301*\n* **Preserve query string:** Enabled\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `http://smallshop.example.com/` | `https://globalstore.example.net/` | `301` |\n| `http://smallshop.example.com/admin/?logged_out=true` | `https://globalstore.example.net/admin/?logged_out=true` | `301` |\n| `https://smallshop.example.com/?all_items=1` | `https://globalstore.example.net/?all_items=1` | `301` |\n| `http://example.com/about/` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Redirect local visitors to specific subdomains · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect United Kingdom and France\n  visitors from the `example.com` website's  root path (`/`) to their localized\n  subdomains `https://gb.example.com` and `https://fr.example.com`,\n  respectively.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-country-subdomains/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-country-subdomains/index.md\n---\n\nThis example single redirect for zone `example.com` will redirect United Kingdom and France visitors requesting the website's root path (`/`) to their localized subdomains `https://gb.example.com` and `https://fr.example.com`, respectively.\n\n**When incoming requests match**\n\nUsing the Expression Editor:\\\n`(ip.src.country eq \"GB\" or ip.src.country eq \"FR\") and http.request.uri.path eq \"/\"`\n\n**Then**\n\n* **Type:** *Dynamic*\n* **Expression:** `lower(concat(\"https://\", ip.src.country, \".example.com\"))`\n* **Status code:** *301*\n\nFor example, the redirect rule would perform the following redirects:\n\n| Visitor country | Request URL | Target URL | Status code |\n| - | - | - | - |\n| United Kingdom | `example.com` | `https://gb.example.com` | `301` |\n| France | `example.com` | `https://fr.example.com` | `301` |\n| United States | `example.com` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Redirect visitors to a new page URL · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect visitors from `/contact-us/` to\n  the page's new path `/contacts/`.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-new-url/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-new-url/index.md\n---\n\nThis example static redirect for zone `example.com` will redirect visitors requesting the `/contact-us/` page to the new page URL `/contacts/`.\n\n**When incoming requests match**\n\n* **Field:** *URI Path*\n* **Operator:** *equals*\n* **Value:** `/contact-us/`\n\nIf you are using the Expression Editor, enter the following expression:\\\n`http.request.uri.path eq \"/contact-us/\"`\n\n**Then**\n\n* **Type:** *Static*\n* **URL:** `/contacts/`\n* **Status code:** *301*\n* **Preserve query string:** Enabled\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `example.com/contact-us/` | `example.com/contacts/` | `301` |\n| `example.com/contact-us/?state=TX` | `example.com/contacts/?state=TX` | `301` |\n| `example.com/team/` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Redirect from root to WWW · Cloudflare Rules docs\ndescription: Create a redirect rule to forward HTTPS requests from the root\n  (also known as the “apex” or “naked” domain) to the WWW subdomain.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-root-to-www/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-root-to-www/index.md\n---\n\nThis example creates a redirect rule that forwards HTTPS requests from the root domain (`example.com`) to the WWW subdomain (`www.example.com`), while retaining the original path and query string.\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `https://example.com/*`\n\n**Then**\n\n* **Target URL**: `https://www.example.com/${1}`\n* **Status code**: *301*\n* **Preserve query string**: Enabled\n\nThis rule ensures that only HTTPS requests from the root domain are redirected to the WWW subdomain, leaving other requests (such as HTTP or requests to other subdomains) unchanged.\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `https://example.com/products/` | `https://www.example.com/products/` | `301` |\n| `https://store.example.com/products/` | (unchanged) | n/a |\n| `https://example.com/admin/?logged_out=true` | `https://www.example.com/admin/?logged_out=true` | `301` |\n| `http://example.com/?all_items=true` | (unchanged) | n/a |\n| `http://www.example.com/admin/` | (unchanged) | n/a |\n\nMake sure to replace `example.com` with your actual hostname before deploying your rule.\n\n</page>\n\n<page>\n---\ntitle: Redirect from WWW to root · Cloudflare Rules docs\ndescription: Create a redirect rule to forward HTTPS requests from the WWW\n  subdomain to the root (also known as the “apex” or “naked” domain).\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-www-to-root/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-www-to-root/index.md\n---\n\nThis example creates a redirect rule that forwards HTTPS requests from the WWW subdomain (`www.example.com`) to the root domain (`example.com`), while retaining the original path and query string.\n\n**When incoming requests match**\n\n* **Wildcard pattern**\n  * **Request URL**: `https://www.*`\n\n**Then**\n\n* **Target URL**: `https://${1}`\n* **Status code**: *301*\n* **Preserve query string**: Enabled\n\nThis rule ensures that only HTTPS requests from `www.` subdomains are redirected to the root domain, leaving other requests (such as HTTP or non-WWW) unchanged.\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `https://www.example.com/products/` | `https://example.com/products/` | `301` |\n| `https://www.store.example.com/products/` | `https://store.example.com/products/` | `301` |\n| `https://store.example.com/products/` | (unchanged) | n/a |\n| `https://www.example.com/admin/?logged_out=true` | `https://example.com/admin/?logged_out=true` | `301` |\n| `http://www.example.com/?all_items=true` | (unchanged) | n/a |\n| `http://example.com/admin/` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Remove locale from URL path · Cloudflare Rules docs\ndescription: Create a redirect rule to redirect visitors from an old URL format\n  with locale information to a new URL format.\nlastUpdated: 2025-10-13T13:40:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/rules/url-forwarding/examples/remove-locale-url/\n  md: https://developers.cloudflare.com/rules/url-forwarding/examples/remove-locale-url/index.md\n---\n\nThis example single redirect for zone `example.com` will redirect visitors from an old URL format that included the locale (for example, `/en-us/<page_name>`) to the new format `/<page_name>`.\n\n**When incoming requests match**\n\n* **Field:** *URI Path*\n* **Operator:** *matches regex*\n* **Value:** `^/[A-Za-z]{2}-[A-Za-z]{2}/`\n\nIf you are using the Expression Editor, enter the following expression:\\\n`http.request.uri.path matches \"^/[A-Za-z]{2}-[A-Za-z]{2}/\"`\n\n**Then**\n\n* **Type:** *Dynamic*\n* **Expression:** `regex_replace(http.request.uri.path, \"^/[A-Za-z]{2}-[A-Za-z]{2}/(.*)\", \"/${1}\")`\n* **Status code:** *301*\n* **Preserve query string:** Enabled\n\nThe function [`regex_replace()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#regex_replace) allows you to extract parts of the URL using regular expressions' capture groups. Create capture groups by putting part of the regular expression in parentheses. Then, reference a capture group using `${<num>}` in the replacement string, where `<num>` is the number of the capture group.\n\nFor example, the redirect rule would perform the following redirects:\n\n| Request URL | Target URL | Status code |\n| - | - | - |\n| `example.com/en-us/meet-our-team` | `example.com/meet-our-team` | `301` |\n| `example.com/pt-BR/meet-our-team` | `example.com/meet-our-team` | `301` |\n| `example.com/en-us/calendar?view=month` | `example.com/calendar?view=month` | `301` |\n| `example.com/meet-our-team` | (unchanged) | n/a |\n| `example.com/robots.txt` | (unchanged) | n/a |\n\n</page>\n\n<page>\n---\ntitle: Use category overrides to enable Joomla rules · Cloudflare Ruleset Engine docs\ndescription: Use the Rulesets API to configure the execution of a managed\n  ruleset and override its behavior. By default, enabled rules perform the\n  actions defined by the managed ruleset issuer. This example uses overrides to\n  ensure that only rules with a specific tag are enabled.\nlastUpdated: 2025-04-01T09:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-joomla-only/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-joomla-only/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to configure the execution of a managed ruleset and override its behavior. By default, enabled rules perform the actions defined by the managed ruleset issuer. This example uses overrides to ensure that only rules with a specific tag are enabled.\n\nFollow the steps below to configure the execution of a managed ruleset with two overrides for enabling only the rules tagged with `joomla`.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. Configure a tag override that enables only the rules with a given tag.\n\nTag overrides take precedence over ruleset overrides. Only the rules with the specified tag are enabled, and all other rules are disabled.\n\n## Example 1\n\nThis example deploys the Cloudflare Managed Ruleset to a phase with only Joomla rules enabled. The `name`, `kind`, and `phase` fields are omitted from the request because they are immutable.\n\nExample: Enable only Joomla rules using category overrides at the zone level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "* `\"id\": \"<MANAGED_RULESET_ID>\"` adds a rule to the ruleset of a phase that will apply the Cloudflare Managed Ruleset to requests for the specified zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level that disables all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"joomla\", \"action\": \"block\", \"enabled\": true}]` defines an override at the tag level that enables the Joomla rules and sets their action to `block`.\n\nExample: Enable only Joomla rules using category overrides at the account level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "* `\"id\": \"<MANAGED_RULESET_ID>\"` adds a rule to the ruleset of a phase that will apply the Cloudflare Managed Ruleset to requests for `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level that disables all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"joomla\", \"action\": \"block\", \"enabled\": true}]` defines an override at the tag level that enables the Joomla rules and sets their action to `block`.\n\nYou can add more than one category override to a rule.\n\n## Example 2\n\nThis example adds two overrides to the rule that executes a managed ruleset (`<MANAGED_RULESET_ID>`) in the `http_request_firewall_managed` phase. Note that the `name`, `kind`, and `phase` fields are omitted from the request because they are immutable.\n\nExample: Add more than one category override at the zone level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "Example: Add more than one category override at the account level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "The order of the overrides in the ruleset determines if rules in the deployed managed ruleset are enabled or disabled. Overrides placed later in the list take precedence over earlier overrides.\n\nConsider four rules from the managed ruleset in the code above that have different combinations of `category` tags. The following table shows the status of the rules after the overrides.\n\n| Rule in managed ruleset | Tags | Rule status after overrides |\n| - | - | - |\n| ManagedRule1 | `drupal`, `dos` | Disabled |\n| ManagedRule2 | `drupal`, `dos`, `joomla` | Enabled |\n| ManagedRule3 | `dos`, `joomla`, `wordpress` | Disabled |\n| ManagedRule4 | `drupal`, `wordpress` | Disabled |\n| ManagedRule5 | (no tags) | Disabled |\n\n</page>\n\n<page>\n---\ntitle: Use tag overrides to set WordPress rules to Block · Cloudflare Ruleset\n  Engine docs\ndescription: Follow the steps below to create a rule that executes a managed\n  ruleset and defines an override for rules with a specific tag.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-wordpress-block/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-wordpress-block/index.md\n---\n\nFollow the steps below to create a rule that executes a managed ruleset and defines an override for rules with a specific tag.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a tag override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets a specified action for all rules with a given tag.\n\n## Zone-level example\n\nThis example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to perform the following two steps in a single `PUT` request:\n\n* Set the list of rules in the `http_request_firewall_managed` phase entry point ruleset to a single rule that executes the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/).\n* Override rules with the `wordpress` tag to set the action to `block`. All other rules use the default action provided by the ruleset issuer.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThis example uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to perform the following two steps in a single `PUT` request:\n\n* Set the list of rules in the `http_request_firewall_managed` phase entry point ruleset to a single rule that executes the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) for the zone `example.com`.\n* Override rules with the `wordpress` tag to set the action to `block`. All other rules use the default action provided by the ruleset issuer.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Use rulesets and rule overrides to only enable selected rules ·\n  Cloudflare Ruleset Engine docs\ndescription: Use a ruleset override and a rule override in a phase entry point\n  ruleset to execute only selected rules in a managed ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/enable-selected-rules/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/enable-selected-rules/index.md\n---\n\nUse a ruleset override and a rule override in a phase entry point ruleset to execute only selected rules in a managed ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) to set an action for the rules you want to execute.\n\n## Zone-level example\n\nThe following `PUT` request uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to define a configuration that executes only two rules from a managed ruleset in the `http_request_firewall_managed` phase.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests in the specified zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"rules\": [{\"id\": \"<RULE_ID_1>\", \"action\": \"block\", \"enabled\": true}, {\"id\": \"<RULE_ID_2>\", \"action\": \"log\", \"enabled\": true}]` defines a list of overrides at the rule level to enable two individual rules.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThe following `PUT` request uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to define a configuration that executes only two rules from a managed ruleset in the `http_request_firewall_managed` phase.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"rules\": [{\"id\": \"<RULE_ID_1>\", \"action\": \"block\", \"enabled\": true}, {\"id\": \"<RULE_ID_2>\", \"action\": \"log\", \"enabled\": true}]` defines a list of overrides at the rule level to enable two individual rules.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Adjust an L3/4 DDoS rule · Cloudflare Ruleset Engine docs\nlastUpdated: 2025-07-11T17:09:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/link-override-ddos-l34-rule-sensitivity/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/link-override-ddos-l34-rule-sensitivity/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Adjust the sensitivity of an HTTP DDoS rule to Low · Cloudflare Ruleset\n  Engine docs\ndescription: Follow the steps below to override the sensitivity of a specific\n  rule of the Cloudflare HTTP DDoS Attack Protection managed ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ddos-rule-sensitivity/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ddos-rule-sensitivity/index.md\n---\n\nFollow the steps below to override the sensitivity of a specific rule of the Cloudflare HTTP DDoS Attack Protection managed ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase to deploy the Cloudflare HTTP DDoS Attack Protection managed ruleset. You only need to deploy this specific ruleset when you wish to define one or more overrides, since it is enabled by default.\n2. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets the `sensitivity_level` of a specific rule.\n\n## Example\n\nThe following example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the two steps in a single `PUT` request.\n\n* Set the rules in the `ddos_l7` phase entry point ruleset to a single rule that executes the Cloudflare HTTP DDoS Attack Protection managed ruleset (with ID `<HTTP_DDOS_RULESET_ID>`).\n* Create an override for the rule with ID `<RULE_ID>` and set the rule sensitivity to `low`. All other rules use the default sensitivity defined by Cloudflare.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Deploy a managed ruleset with ruleset, tag, and rule overrides ·\n  Cloudflare Ruleset Engine docs\ndescription: Customize the execution of managed rulesets with a combination of\n  ruleset overrides, tag overrides, and rule overrides in your phase entry point\n  ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ruleset-tag-rule/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ruleset-tag-rule/index.md\n---\n\nCustomize the execution of managed rulesets with a combination of ruleset overrides, tag overrides, and rule overrides in your phase entry point ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset to execute a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. [Configure a tag override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets an action for rules with a given tag.\n4. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets an action for the rules you want to execute.\n\n## Zone-level example\n\nThis example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the following in a single `PUT` request:\n\n* Add a rule to the `http_request_firewall_managed` phase entry point ruleset that executes a managed ruleset.\n* Use category overrides to enable rules with `wordpress` and `drupal` tags and set their actions to `log`.\n* Add a rule override that enables a single rule.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to a zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"wordpress\", \"action\": \"log\", \"enabled\": true}, {\"category\": \"drupal\", \"action\": \"log\", \"enabled\": true}]` defines an override at the tag level to enable rules tagged with `wordpress` or `drupal` and sets their action to `log`.\n* `\"rules\": [{\"id\": \"<RULE_ID>\", \"action\": \"block\", \"enabled\": true}]` defines an override at the rule level that enables one individual rule and sets the action to `block`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThis example uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the following in a single `PUT` request:\n\n* Add a rule to the `http_request_firewall_managed` phase entry point ruleset that executes a managed ruleset for the zone `example.com`.\n* Use category overrides to enable rules with `wordpress` and `drupal` tags and set their actions to `log`.\n* Add a rule override that enables a single rule.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"wordpress\", \"action\": \"log\", \"enabled\": true}, {\"category\": \"drupal\", \"action\": \"log\", \"enabled\": true}]` defines an override at the tag level to enable rules tagged with `wordpress` or `drupal` and sets their action to `log`.\n* `\"rules\": [{\"id\": \"<RULE_ID>\", \"action\": \"block\", \"enabled\": true}]` defines an override at the rule level that enables one individual rule and sets the action to `block`.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Edit expressions in the dashboard · Cloudflare Ruleset Engine docs\ndescription: Edit expressions in the Cloudflare dashboard using the Expression\n  Builder, which allows for a visual approach, or using the Expression Editor,\n  in which you type the expression.\nlastUpdated: 2025-11-21T10:50:37.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/index.md\n---\n\nIn the Cloudflare dashboard, there are two options for editing [expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/):\n\n* [Expression Builder](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-builder): Allows you to create expressions using drop-down lists, emphasizing a visual approach to defining an expression.\n* [Expression Editor](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-editor): A text-only interface that supports advanced features, such as grouping symbols and functions for transforming and validating values.\n\nIn general, you can switch back and forth between the Expression Builder and the Expression Editor. However, the Expression Builder does not support advanced features like:\n\n* [Nested expressions](#create-nested-expressions)\n* [Function calls](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/)\n\nThe builder may also not show all the fields you can use in the expression you are editing.\n\nIf you use advanced expression features or enter unlisted fields in your expression when using the editor, you may not be able to switch to the Expression Builder. You will get a warning popup stating that the expression is not supported in the builder. To proceed, you may discard any changes made in the editor, or cancel the switch and continue working in the editor.\n\n## Expression Builder\n\nThe Expression Builder allows you to visually create rule expressions by using drop-down lists and entering field values to define one or multiple sub-expressions.\n\n![The Expression Builder interface used to visually define expressions](https://developers.cloudflare.com/_astro/expression-builder.Cg2aqK5m_Z213DfV.webp)\n\nThe **Expression Preview** displays the expression in text:",
      "language": "unknown"
    },
    {
      "code": "The Expression Builder will [automatically escape](#escape-special-characters) the backslash (`\\`) and double quote (`\"`) special characters in string literals when using the [quoted string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#quoted-string-syntax).\n\n## Expression Editor\n\nThe **Expression Editor** is a text-only interface for defining rule expressions that supports the entire specification of Cloudflare's [Rules language](https://developers.cloudflare.com/ruleset-engine/rules-language/), including parentheses as grouping symbols.\n\n![The Expression Editor used to enter advanced expressions](https://developers.cloudflare.com/_astro/expression-editor.CI-o8RRS_ZLoFLg.webp)\n\nTo access the Expression Editor, select **Edit expression** next to the **Expression Preview**:\n\n![Selecting Edit expression in the Create custom rule page to switch to the Expression Editor](https://developers.cloudflare.com/_astro/expression-builder.Cg2aqK5m_Z213DfV.webp)\n\nTo switch back from the Expression Editor to the Expression Builder, select **Use expression builder**.\n\n### Escape special characters\n\nIn expressions using the [quoted string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#quoted-string-syntax), all backslash (`\\`) and double quote (`\"`) characters in string literals must be escaped. The visual Expression Builder will automatically escape these special characters by prepending a backslash such that `\\` and `\"` become `\\\\` and `\\\"`, respectively.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Additional resources",
      "id": "additional-resources"
    },
    {
      "level": "h2",
      "text": "Redirect mobile users dropping the original URI path",
      "id": "redirect-mobile-users-dropping-the-original-uri-path"
    },
    {
      "level": "h2",
      "text": "Redirect mobile users keeping the original path",
      "id": "redirect-mobile-users-keeping-the-original-path"
    },
    {
      "level": "h2",
      "text": "Example 1",
      "id": "example-1"
    },
    {
      "level": "h2",
      "text": "Example 2",
      "id": "example-2"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Expression Builder",
      "id": "expression-builder"
    },
    {
      "level": "h2",
      "text": "Expression Editor",
      "id": "expression-editor"
    },
    {
      "level": "h3",
      "text": "Escape special characters",
      "id": "escape-special-characters"
    }
  ],
  "url": "llms-txt#single-redirects-resource",
  "links": []
}