{
  "title": "Example of an expression with a \" character written using the raw string syntax",
  "content": "http.request.uri.path eq r#\"/foo\"bar\"#\ntxt\n((http.request.uri.path contains \"/xmlrpc.php\") or (http.request.uri.path\ncontains \"/wp-login.php\") or (http.request.uri.path contains \"/wp-admin/\"\nand not http.request.uri.path contains \"/wp-admin/admin-ajax.php\" and not\nhttp.request.uri.path contains \"/wp-admin/theme-editor.php\")) and\nip.src.country ne \"MY\"\ntxt\nlower(http.request.uri.path) contains \"/wp-login.php\"\ntxt\nFilter parsing error (1:313): ((http.request.uri.path contains\n\"/xmlrpc.php\") or (http.request.uri.path contains \"/wp-login.php\") or\n(http.request.uri.path contains \"/wp-admin/\" and not\nhttp.request.uri.path contains \"/wp-admin/admin-ajax.php\" and not\nhttp.request.uri.path contains \"/wp-admin/theme-editor.php\")) and\nip.src.country ne \"MY\") ^ unrecognised input\ngraphql\nquery AegisIpUtilizationQuery(\n  $accountTag: string\n  $datetimeStart: string\n  $datetimeEnd: string\n) {\n  viewer {\n    utilization: accounts(filter: { accountTag: $accountTag }) {\n      avgByPopUtilization: aegisIpUtilizationAdaptiveGroups(\n        limit: 100\n        filter: {\n          datetimeFiveMinutes_geq: $datetimeStart\n          datetimeFiveMinutes_leq: $datetimeEnd\n        }\n        orderBy: [datetimeFiveMinutes_ASC]\n      ) {\n        avg {\n          utilization\n        }\n        dimensions {\n          datetimeFiveMinutes\n          popUtilizationKey\n        }\n      }\n\nmaxByPopUtilization: aegisIpUtilizationAdaptiveGroups(\n        limit: 100\n        filter: {\n          datetimeFiveMinutes_geq: $datetimeStart\n          datetimeFiveMinutes_leq: $datetimeEnd\n        }\n        orderBy: [datetimeFiveMinutes_ASC]\n      ) {\n        max {\n          utilization\n        }\n        dimensions {\n          datetimeFiveMinutes\n          popUtilizationKey\n        }\n      }\n\nfilterPopUtilization: aegisIpUtilizationAdaptiveGroups(\n        limit: 100\n        filter: {\n          datetimeFiveMinutes_geq: $datetimeStart\n          datetimeFiveMinutes_leq: $datetimeEnd\n          popName: \"<CLOUDFLARE_POP>\"\n        }\n        orderBy: [datetimeFiveMinutes_ASC]\n      ) {\n        max {\n          utilization\n        }\n        dimensions {\n          datetimeFiveMinutes\n          popUtilizationKey\n        }\n      }\n\nfilterIPUtilization: aegisIpUtilizationAdaptiveGroups(\n        limit: 100\n        filter: {\n          datetimeFiveMinutes_geq: $datetimeStart\n          datetimeFiveMinutes_leq: $datetimeEnd\n          egressIp: \"<YOUR_EGRESS_IP>\"\n        }\n        orderBy: [datetimeFiveMinutes_ASC]\n      ) {\n        max {\n          utilization\n        }\n        dimensions {\n          datetimeFiveMinutes\n          popUtilizationKey\n        }\n      }\n\nfilterOriginUtilization: aegisIpUtilizationAdaptiveGroups(\n        limit: 100\n        filter: {\n          datetimeFiveMinutes_geq: $datetimeStart\n          datetimeFiveMinutes_leq: $datetimeEnd\n          origin: \"<ORIGIN_IP_AND_PORT>\"\n        }\n        orderBy: [datetimeFiveMinutes_ASC]\n      ) {\n        max {\n          utilization\n        }\n        dimensions {\n          datetimeFiveMinutes\n          popUtilizationKey\n        }\n      }\n    }\n  }\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/{zone_id}/rulesets/{ruleset_id}/rules\" \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"action\": \"skip\",\n  \"action_parameters\": {\n    \"products\": [\n      \"zoneLockdown\"\n    ]\n  },\n  \"expression\": \"http.user_agent contains \\\"1234567890abcdef\\\"\",\n  \"description\": \"bypass zone lockdown - specific healthcheck\"\n}'\nplaintext\ntext/html\ntext/richtext\ntext/plain\ntext/css\ntext/x-script\ntext/x-component\ntext/x-java-source\ntext/x-markdown\napplication/javascript\napplication/x-javascript\ntext/javascript\ntext/js\nimage/x-icon\nimage/vnd.microsoft.icon\napplication/x-perl\napplication/x-httpd-cgi\ntext/xml\napplication/xml\napplication/rss+xml\napplication/vnd.api+json\napplication/x-protobuf\napplication/json\nmultipart/bag\nmultipart/mixed\napplication/xhtml+xml\nfont/ttf\nfont/otf\nfont/x-woff\nimage/svg+xml\napplication/vnd.ms-fontobject\napplication/ttf\napplication/x-ttf\napplication/otf\napplication/x-otf\napplication/truetype\napplication/opentype\napplication/x-opentype\napplication/font-woff\napplication/eot\napplication/font\napplication/font-sfnt\napplication/wasm\napplication/javascript-binast\napplication/manifest+json\napplication/ld+json\napplication/graphql+json\napplication/geo+json\nmermaid\nflowchart LR\naccTitle: Compressed responses sent from the origin server\naccDescr: Cloudflare accepts responses from origin server using Brotli compression, Gzip compression, or no compression.\n\nA[Visitor browser]\nB((Cloudflare))\nC[(Origin server)]\n\nA -.-> B == \"Request<br>Accept-Encoding: br, gzip\" ==> C\nC == \"Response<br>(Brotli / Gzip / No compression)\" ==> B -.-> A\n\nstyle A stroke-dasharray: 5 5\nstyle B stroke: orange,fill: orange,color: black\nstyle C stroke-width: 2px\nlinkStyle 1,2 stroke-width: 2px\nlinkStyle 0,3 stroke-width: 1px\nplaintext\nChrome 36+\nEdge 16+\nSafari 10+\nFirefox 44+\nOpera 22+\nIE 9+\nChrome for Android 115+\nSafari on iOS 10+\nSamsung Internet 5+\ntxt\n/static/fetch1\n//other.example.com/fetch2\nhttp://another.example.com/fetch3\njson\n{\n  \"prefetch\": [\n    {\n      \"source\": \"document\",\n      \"where\": {\n        \"and\": [{ \"href_matches\": \"/*\", \"relative_to\": \"document\" }]\n      },\n      \"eagerness\": \"conservative\"\n    }\n  ]\n}\nbash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/settings/speed_brain\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"value\": \"on\"\n    }'\n  bash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/settings/origin_h2_max_streams\" \\\n  --request PATCH \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"value\": 100\n  }'\nhcl\nresource \"cloudflare_zone_setting\" \"example\" {\n  zone_id    = \"<ZONE_ID>\"\n  setting_id = \"origin_h2_max_streams\"\n  value      = 50\n}\nbash\n  curl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/settings/min_tls_version\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"id\": \"min_tls_version\",\n      \"value\": \"1.2\"\n    }'\n  bash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/hostnames/settings/min_tls_version/$HOSTNAME\" \\\n  --request PUT \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"value\": \"1.2\"\n  }'\nsh\ncurl https://www.example.com -svo /dev/null --tls-max 1.1\ntxt\nnow() + min((floor(60 * pow(1.05, retry_attempt)) * INTERVAL '1 second'), INTERVAL '4 hours')\ntxt\n-----BEGIN CERTIFICATE-----\n<intermediate>\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n<leaf>\n-----END CERTIFICATE-----\nsh\n   cp example.com.key temp.key\n   sh\n   openssl rsa -in temp.key -out example.com.key\n   sh\n   rsa -in C:\\Path\\To\\example.com.key -out key.pem\n   bash\nopenssl x509 -in certificate.crt -noout -text\nbash\nopenssl x509 -in certificate.crt -noout -text\nbash\nopenssl x509 -in certificateFile.pem -noout -text\nsh\n  cat app_example_com.pem\n  sh\n  -----BEGIN CERTIFICATE-----\n  MIIFJDCCBAygAwIBAgIQD0ifmj/Yi5NP/2gdUySbfzANBgkqhkiG9w0BAQsFADBN\n  MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMScwJQYDVQQDEx5E\n  ...\n  SzSHfXp5lnu/3V08I72q1QNzOCgY1XeL4GKVcj4or6cT6tX6oJH7ePPmfrBfqI/O\n  OeH8gMJ+FuwtXYEPa4hBf38M5eU5xWG7\n  -----END CERTIFICATE-----\n  sh\n  MYCERT=\"$(cat app_example_com.pem|perl -pe 's/\\r?\\n/\\\\n/'|sed -e 's/..$//')\"\n  MYKEY=\"$(cat app_example_com.key|perl -pe 's/\\r?\\n/\\\\n/'|sed -e's/..$//')\"\n  bash\n  request_body=$(< <(cat <<EOF\n  {\n    \"certificate\": \"$MYCERT\",\n    \"private_key\": \"$MYKEY\",\n    \"bundle_method\": \"ubiquitous\"\n  }\n  EOF\n  ))\n  bash\n  request_body=$(< <(cat <<EOF\n  {\n    \"certificate\": \"$MYCERT\",\n    \"private_key\": \"$MYKEY\",\n    \"bundle_method\": \"ubiquitous\",\n    \"geo_restrictions\": {\"label\": \"us\"}'\n  }\n  EOF\n  ))\n  bash\n  request_body=$(< <(cat <<EOF\n  {\n    \"certificate\": \"$MYCERT\",\n    \"private_key\": \"$MYKEY\",\n    \"bundle_method\": \"ubiquitous\",\n    \"geo_restrictions\": {\"label\": \"us\"}',\n    \"type\":\"sni_custom\"\n  }\n  EOF\n  ))\n  bash\n  curl https://api.cloudflare.com/client/v4/zones/{zone_id}/custom_certificates \\\n  --header \"X-Auth-Email: <EMAIL>\" \\\n  --header \"X-Auth-Key: <API_KEY>\" \\\n  --header \"Content-Type: application/json\" \\\n  --data \"$request_body\"\n  bash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_certificates\" \\\n  --request POST \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"certificate\": \"certificate\",\n    \"private_key\": \"<PRIVATE_KEY>\",\n    \"policy\": \"(country: US) and (region: EU)\",\n    \"type\": \"sni_custom\"\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/custom_certificates\" \\\n  --request POST \\\n  --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n  --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n  --json '{\n    \"certificate\": \"certificate\",\n    \"private_key\": \"<PRIVATE_KEY>\",\n    \"policy\": \"(region: EU) and (not country: FR)\",\n    \"type\": \"sni_custom\"\n  }'\nbash\n➜  ~ dig example.com caa +short",
  "code_samples": [
    {
      "code": "When you select *Matches regex* in the **Operator** dropdown in the dashboard, the expression preview will automatically use the raw string syntax. In other situations, you may need to switch to the Expression Editor to manually enter a string using the raw string syntax. In this case, switching back to the Expression Builder will keep the syntax you used in the editor.\n\nWhen you write a [regular expression](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#regular-expression-matching) using the quoted string syntax, you may need to perform additional escaping — refer to [Quoted string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#quoted-string-syntax) for details.\n\nTo write complex regular expressions, Cloudflare recommends that you use the [raw string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#raw-string-syntax), which needs less escaping.\n\n### Create nested expressions\n\nThe Expression Editor supports parentheses as [grouping symbols](https://developers.cloudflare.com/ruleset-engine/rules-language/operators/#grouping-symbols). Use parentheses to explicitly group and nest expressions and, in turn, create highly targeted expressions.\n\nThe following rule expression will match requests from any visitor who is not from Malaysia and tries to access WordPress URI paths.",
      "language": "unknown"
    },
    {
      "code": "Only the Expression Editor supports nested expressions such as the one above. If you create a rule with nested expressions in the Expression Editor and try to switch to the Expression Builder, a dialog will warn you that the expression is not supported in the builder. You will be prompted to **Discard changes** and switch to the Expression Builder or **Cancel** and continue working in the editor.\n\nNote\n\nString comparison in rule expressions is case-sensitive. To account for possible variations of string capitalization in an expression, you can use the [`lower()`](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/#lower) function and compare the result with a lowercased string, like in the following example:",
      "language": "unknown"
    },
    {
      "code": "## Expression validation\n\nCloudflare validates all expressions before saving them, so if your expression has errors, you will receive an error message in the Cloudflare dashboard, similar to the following:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Cache Reserve analytics · Cloudflare Smart Shield docs\ndescription: Cache Reserve Analytics provides insights regarding your Cache\n  Reserve usage. It allows you to check what content is stored in Cache Reserve,\n  how often it is being accessed, how long it has been there and how much egress\n  from your origin it is saving you.\nlastUpdated: 2025-09-17T12:18:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/cache-reserve/analytics/\n  md: https://developers.cloudflare.com/smart-shield/configuration/cache-reserve/analytics/index.md\n---\n\nCache Reserve Analytics provides insights regarding your Cache Reserve usage. It allows you to check what content is stored in Cache Reserve, how often it is being accessed, how long it has been there and how much egress from your origin it is saving you.\n\nYou have access to the following metrics:\n\n* **Egress savings (bandwidth)** - is an estimation based on response bytes served from Cache Reserve that did not need to be served from your origin server. These are represented as cache hits.\n\n* **Requests served by Cache Reserve** - is the number of requests served by Cache Reserve (total).\n\n* **Data storage summary** - is based on a representative sample of requests. Refer to [Sampling](https://developers.cloudflare.com/analytics/graphql-api/sampling/) for more details about how Cloudflare samples data.\n\n  * **Current data stored** - is the data stored (currently) over time.\n  * **Aggregate storage usage** - is the total of storage used for the selected timestamp.\n\n* **Operations** - Class A (writes) and Class B (reads) operations over time.\n\n</page>\n\n<page>\n---\ntitle: Cache Reserve operations · Cloudflare Smart Shield docs\ndescription: Operations are performed by Cache Reserve on behalf of the user to\n  write data from the origin to Cache Reserve and to pass that data downstream\n  to other parts of Cloudflare’s network. These operations are managed\n  internally by Cloudflare.\nlastUpdated: 2025-09-17T12:18:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/cache-reserve/operations/\n  md: https://developers.cloudflare.com/smart-shield/configuration/cache-reserve/operations/index.md\n---\n\nOperations are performed by Cache Reserve on behalf of the user to write data from the origin to Cache Reserve and to pass that data downstream to other parts of Cloudflare’s network. These operations are managed internally by Cloudflare.\n\n#### Class A operations (writes)\n\nClass A operations are performed based on cache misses from Cloudflare’s CDN. When a request cannot be served from cache, it will be fetched from the origin and written to cache reserve as well as our edge caches on the way back to the visitor.\n\n#### Class B operations (reads)\n\nClass B operations are performed when data needs to be fetched from Cache Reserve to respond to a miss in the edge cache.\n\n#### Purge\n\nAsset purges are free operations.\n\nCache Reserve will be instantly purged along with edge cache when you send a purge by URL request. Refer to [cache configurations](https://developers.cloudflare.com/cache/how-to/purge-cache/) for details.\n\nOther purge methods, such as purge by tag, host, prefix, or purge everything will force an attempt to [revalidate](https://developers.cloudflare.com/cache/concepts/cache-responses/#revalidated) on the subsequent request for the Cache Reserve asset. Note that assets purged this way will still incur storage costs until their retention TTL expires.\n\nNote\n\nNote this differs from the standard CDN's purge by tag, host, or prefix features which force a cache miss, requiring the origin to deliver the asset in full.\n\n</page>\n\n<page>\n---\ntitle: How it works · Cloudflare Smart Shield docs\ndescription: Refer to the pages below to understand how Dedicated CDN Egress IPs work.\nlastUpdated: 2025-11-19T12:11:06.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/\n  md: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/index.md\n---\n\nRefer to the pages below to understand how Dedicated CDN Egress IPs work.\n\n* [Egress IPs](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/egress-ips/)\n* [Connection forwarding](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/connection-forwarding/)\n\n</page>\n\n<page>\n---\ntitle: IPs utilization · Cloudflare Smart Shield docs\ndescription: Use the GraphQL API to get aggregate data and monitor your\n  dedicated IPs capacity (formerly known as Aegis).\nlastUpdated: 2025-11-19T12:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/ips-utilization/\n  md: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/ips-utilization/index.md\n---\n\nUse the [GraphQL API](https://developers.cloudflare.com/analytics/graphql-api/) to get aggregate data and monitor your dedicated IPs capacity (formerly known as Aegis).\n\nEach Dedicated CDN Egress IP can support 40,000 concurrent connections per origin IP port. For example, if you have one dedicated IP and two origins (A and B), this single IP can support 40,000 concurrent connections to origin A, while simultaneously supporting 40,000 concurrent connections to origin B.\n\nRefer to the [GraphQL Analytics API documentation](https://developers.cloudflare.com/analytics/graphql-api/getting-started/) for further guidance, or consider the [example](#example) below for a quickstart.\n\n## GraphQL schema\n\nThe specific schema to get Dedicated CDN Egress IPs data is called `aegisIpUtilizationAdaptiveGroups`.\n\nYou can get average (`avg`) or maximum (`max`) utilization values (in percentage), and use the following dimensions:\n\n* `datetimeFiveMinutes` time\n\n  * Timestamp truncated to five minutes. For example, `2025-01-10T00:05:00Z`.\n\n* `popName` string\n\n  * The Cloudflare point of presence (PoP). For example, `sjc`.\n\n* `egressIp` string\n\n  * Your assigned Dedicated CDN Egress IP. For example, `192.0.2.1`.\n\n* `origin` string\n\n  * Origin IP and port. For example, `203.0.113.150:443`.\n\n* `popUtilizationKey` string\n\n  * The Cloudflare point of presence (PoP), the Dedicated CDN Egress IP, and the origin IP and port. For example, `sjc 192.0.2.1 203.0.113.150:443`.\n\n## Example\n\nRefer to the query below to learn how to get average utilization and maximum utilization by point of presence, and filter the results.\n\nYou can also select the button at the bottom to use this query for your account via the [Cloudflare GraphQL API Explorer](https://graphql.cloudflare.com/explorer). Make sure to provide your account ID and timestamps, and replace the placeholders for `popName`, `egressIp`, and `origin` as needed.",
      "language": "unknown"
    },
    {
      "code": "[Run in GraphQL API Explorer](https://graphql.cloudflare.com/explorer?query=I4VwpgTgngBAgmA5gSwM4EkAOBVALsgG2QC8BDfAewDsBFcaACgCgYYASUgY04pCtwAqpRAC4YqXBGRVELdgBNyYfAFswAZVykIuMRKky5bRbmXI1AUSry9k6bICUMAN5yAbsjAB3SC7msQfCIySioxLh4+XFQGADNCUwgxZxgI3n4hUXY0qMyYAF8nV1YS1LdEACEoAAUKHCCScmRqcKQ0LDxCRtC4RUx8NzAAcQheTBj-UpgiFWRdGABGAAYlydL4gkTktamTMzUAMWRBgFlpQLBUAH1EMGAxYyVVDS0dHdK956PT89NrgjuD0+5jAVnk7wKEIoEHkkCqYgA2sDDscwGcqBdrnB1ABhAC6OyKENI5T8UymgS6IWaVAh+Qh8hBVFQNNQZPJJWRYG+aN+lwhrEwdU6wSa1AA0mAoHSdvSdipSAAPKq1epUsVhVJtDBq0U9PoDYajEDjZgc6bmOZiZarc0bLbs81cnnozE3QEKJ4gzTaXACmDO1Guv5XAH3T2mZ5gmXm6GwiDwmBIr0on4YkPY-GEx1TBWKnPkyl6mkxjmMtTM1kF3Yp7lBvmof1C3XdGmS6Xm+nkuXk+2QVUi1stLUoHWD6nUXqkfqokZjCbmmZWxYrCF9pLVj61l0N93hx6R72vP3m1iBtNusNA2vR08wZsAOVIajEACIADw4gAyAHlsAARA4vzgAAlCwrmqH9qgAPlfUtyTjOEoERc9eXTS4rkzAlySJc0803EoiyHWlOwZJkWWoNlilPVDg35O9m3HDV23gkoeymdd0GqJjQlaUcOgaCcqCnGdBjnE0Fw5Jd5htNcEkgbY71o3dbn3LkfTeJTt3rdD-g9A99lBax-SQCBLh1N93wATT-ECrgsIYwPUdQri42DWNKRCE2QpNlN0zDcWwqZcI5fDqPNIihI8zlyKrcKy20i8-ibYVBOYqVovY9Z5IgH8pBQKgeJpPj2hbISRMNcTTQhaTrVXO0csUmjErQt1VOvQ81A0k9ms6uskowq8I0M29T2hZACssn8QPQIZ0AfVzqkwh9-wg6aBHc0jYxhJCUJauisUC7N4tKML-UijVorPWLKIIs99obFKyvSjsOS7KZ3tYd76XyIA\\&variables=N4IghgxhD2CuB2AXAKmA5iAXCAggYTwHkBVAOWQH0BJAERABoQATMRAU0QEsBbNgZURgAToiwgASgFEACgBl8kigHUqyABIU+ycVVIBxBs1YcebSfCZipchctUatO-SAC+QA)\n\n</page>\n\n<page>\n---\ntitle: Fields reference · Cloudflare Ruleset Engine docs\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/index.md\n---\n\nCategories\n\n[cf.api\\_gateway.auth\\_id\\_present](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.auth_id_present/)\n\n[Indicates whether the request contained an API session authentication token, as defined by API Shield's saved session identifiers.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.auth_id_present/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.auth_id_present/)\n\n[cf.api\\_gateway.fallthrough\\_detected](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.fallthrough_detected/)\n\n[Indicates whether the request matched a saved endpoint in Endpoint Management.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.fallthrough_detected/)\n\n[cf.api\\_gateway.request\\_violates\\_schema](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.request_violates_schema/)\n\n[Indicates whether the request violated the schema assigned to the respective saved endpoint.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.api_gateway.request_violates_schema/)\n\n[cf.bot\\_management.corporate\\_proxy](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.corporate_proxy/)\n\n[Indicates whether the incoming request comes from an identified Enterprise-only cloud-based corporate proxy or secure web gateway.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.corporate_proxy/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.corporate_proxy/)\n\n[cf.bot\\_management.detection\\_ids](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.detection_ids/)\n\n[List of IDs that correlate to the Bot Management heuristic detections made on a request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.detection_ids/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.detection_ids/)\n\n[cf.bot\\_management.ja3\\_hash](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja3_hash/)\n\n[Provides an SSL/TLS fingerprint to help you identify potential bot requests.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja3_hash/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja3_hash/)\n\n[cf.bot\\_management.ja4](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja4/)\n\n[Provides an SSL/TLS fingerprint to help you identify potential bot requests.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja4/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.ja4/)\n\n[cf.bot\\_management.js\\_detection.passed](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.js_detection.passed/)\n\n[Indicates whether the visitor has previously passed a JS Detection.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.js_detection.passed/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.js_detection.passed/)\n\n[cf.bot\\_management.score](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.score/)\n\n[Represents the likelihood that a request originates from a bot using a score from 1–99.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.score/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.score/)\n\n[cf.bot\\_management.static\\_resource](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.static_resource/)\n\n[Indicates whether static resources should be included when you create a rule using `cf.bot_management.score`.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.static_resource/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.static_resource/)\n\n[cf.bot\\_management.verified\\_bot](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.verified_bot/)\n\n[Indicates whether the request originated from a known good bot or crawler.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.verified_bot/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.bot_management.verified_bot/)\n\n[cf.client.bot](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.client.bot/)\n\n[Indicates whether the request originated from a known good bot or crawler.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.client.bot/)\n\n[cf.edge.client\\_tcp](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.client_tcp/)\n\n[Indicates if the request was made over TCP.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.client_tcp/)\n\n[cf.edge.server\\_ip](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.server_ip/)\n\n[Represents the global network's IP address to which the HTTP request has resolved.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.server_ip/)\n\n[cf.edge.server\\_port](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.server_port/)\n\n[Represents the port number at which the Cloudflare global network received the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.edge.server_port/)\n\n[cf.hostname.metadata](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.hostname.metadata/)\n\n[Returns the string representation of the per-hostname custom metadata JSON object set by SSL for SaaS customers.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.hostname.metadata/)\n\n[cf.llm.prompt.detected](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.detected/)\n\n[Indicates whether Cloudflare detected an LLM prompt in the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.detected/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.detected/)\n\n[cf.llm.prompt.injection\\_score](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.injection_score/)\n\n[A score from 1–99 that represents the likelihood that the LLM prompt in the request is trying to perform a prompt injection attack.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.injection_score/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.injection_score/)\n\n[cf.llm.prompt.pii\\_categories](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_categories/)\n\n[Array of string values with the personally identifiable information (PII) categories found in the LLM prompt included in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_categories/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_categories/)\n\n[cf.llm.prompt.pii\\_detected](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_detected/)\n\n[Indicates whether any personally identifiable information (PII) has been detected in the LLM prompt included in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_detected/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.pii_detected/)\n\n[cf.llm.prompt.unsafe\\_topic\\_categories](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_categories/)\n\n[Array of string values with the type of unsafe topics detected in the LLM prompt.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_categories/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_categories/)\n\n[cf.llm.prompt.unsafe\\_topic\\_detected](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_detected/)\n\n[Indicates whether the incoming request includes any unsafe topic category in the LLM prompt.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_detected/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.llm.prompt.unsafe_topic_detected/)\n\n[cf.random\\_seed](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.random_seed/)\n\n[Returns per-request random bytes that you can use in the `uuidv4()` function.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.random_seed/)\n\n[cf.ray\\_id](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.ray_id/)\n\n[The Ray ID of the current request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.ray_id/)\n\n[cf.response.1xxx\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.response.1xxx_code/)\n\n[Contains the specific code for 1XXX Cloudflare errors.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.response.1xxx_code/)\n\n[cf.response.error\\_type](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.response.error_type/)\n\n[A string with the type of error in the response being returned.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.response.error_type/)\n\n[cf.threat\\_score](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.threat_score/)\n\n[Represents a Cloudflare threat score.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.threat_score/)\n\n[cf.timings.client\\_tcp\\_rtt\\_msec](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.timings.client_tcp_rtt_msec/)\n\n[The smoothed TCP round-trip time from client to Cloudflare in milliseconds.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.timings.client_tcp_rtt_msec/)\n\n[cf.tls\\_cipher](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_cipher/)\n\n[The cipher for the connection to Cloudflare.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_cipher/)\n\n[cf.tls\\_ciphers\\_sha1](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_ciphers_sha1/)\n\n[The SHA-1 fingerprint of the client TLS cipher list in received order, encoded in Base64 using big-endian format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_ciphers_sha1/)\n\n[cf.tls\\_client\\_auth.cert\\_fingerprint\\_sha1](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_fingerprint_sha1/)\n\n[The SHA-1 fingerprint of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_fingerprint_sha1/)\n\n[cf.tls\\_client\\_auth.cert\\_fingerprint\\_sha256](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_fingerprint_sha256/)\n\n[The SHA-256 fingerprint of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_fingerprint_sha256/)\n\n[cf.tls\\_client\\_auth.cert\\_issuer\\_dn](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn/)\n\n[The Distinguished Name (DN) of the Certificate Authority (CA) that issued the certificate included in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn/)\n\n[cf.tls\\_client\\_auth.cert\\_issuer\\_dn\\_legacy](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn_legacy/)\n\n[The Distinguished Name (DN) of the Certificate Authority (CA) that issued the certificate in the request in a legacy format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn_legacy/)\n\n[cf.tls\\_client\\_auth.cert\\_issuer\\_dn\\_rfc2253](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn_rfc2253/)\n\n[The Distinguished Name (DN) of the Certificate Authority (CA) that issued the certificate in the request in RFC 2253 format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_dn_rfc2253/)\n\n[cf.tls\\_client\\_auth.cert\\_issuer\\_serial](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_serial/)\n\n[Serial number of the direct issuer of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_serial/)\n\n[cf.tls\\_client\\_auth.cert\\_issuer\\_ski](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_ski/)\n\n[The Subject Key Identifier (SKI) of the direct issuer of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_issuer_ski/)\n\n[cf.tls\\_client\\_auth.cert\\_not\\_after](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_not_after/)\n\n[The certificate in the request is not valid after this date.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_not_after/)\n\n[cf.tls\\_client\\_auth.cert\\_not\\_before](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_not_before/)\n\n[The certificate in the request is not valid before this date.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_not_before/)\n\n[cf.tls\\_client\\_auth.cert\\_presented](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_presented/)\n\n[Returns `true` when a request presents a certificate (valid or not).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_presented/)\n\n[cf.tls\\_client\\_auth.cert\\_revoked](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_revoked/)\n\n[Indicates whether the request presented a valid but revoked client certificate.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_revoked/)\n\n[cf.tls\\_client\\_auth.cert\\_serial](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_serial/)\n\n[Serial number of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_serial/)\n\n[cf.tls\\_client\\_auth.cert\\_ski](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_ski/)\n\n[The Subject Key Identifier (SKI) of the certificate in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_ski/)\n\n[cf.tls\\_client\\_auth.cert\\_subject\\_dn](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn/)\n\n[The Distinguished Name (DN) of the owner (or requester) of the certificate included in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn/)\n\n[cf.tls\\_client\\_auth.cert\\_subject\\_dn\\_legacy](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn_legacy/)\n\n[The Distinguished Name (DN) of the owner (or requester) of the certificate in the request in a legacy format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn_legacy/)\n\n[cf.tls\\_client\\_auth.cert\\_subject\\_dn\\_rfc2253](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn_rfc2253/)\n\n[The Distinguished Name (DN) of the owner (or requester) of the certificate in the request in RFC 2253 format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_subject_dn_rfc2253/)\n\n[cf.tls\\_client\\_auth.cert\\_verified](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_verified/)\n\n[Returns `true` when a request presents a valid client certificate.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_auth.cert_verified/)\n\n[cf.tls\\_client\\_extensions\\_sha1](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_extensions_sha1/)\n\n[The SHA-1 fingerprint of TLS client extensions, encoded in Base64 using big-endian format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_extensions_sha1/)\n\n[cf.tls\\_client\\_extensions\\_sha1\\_le](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_extensions_sha1_le/)\n\n[The SHA-1 fingerprint of TLS client extensions, encoded in Base64 using little-endian format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_extensions_sha1_le/)\n\n[cf.tls\\_client\\_hello\\_length](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_hello_length/)\n\n[The length of the client hello message sent in a TLS handshake.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_hello_length/)\n\n[cf.tls\\_client\\_random](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_random/)\n\n[The value of the 32-byte random value provided by the client in a TLS handshake, encoded in Base64.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_client_random/)\n\n[cf.tls\\_version](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_version/)\n\n[The TLS version of the connection to Cloudflare.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.tls_version/)\n\n[cf.verified\\_bot\\_category](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.verified_bot_category/)\n\n[Provides the type and purpose of a verified bot.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.verified_bot_category/)\n\n[cf.waf.auth\\_detected](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.auth_detected/)\n\n[Indicates whether the Cloudflare WAF detected authentication credentials in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.auth_detected/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.auth_detected/)\n\n[cf.waf.content\\_scan.has\\_failed](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_failed/)\n\n[Indicates whether the file scanner was unable to scan all the content objects detected in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_failed/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_failed/)\n\n[cf.waf.content\\_scan.has\\_malicious\\_obj](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_malicious_obj/)\n\n[Indicates whether the request contains at least one malicious content object.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_malicious_obj/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_malicious_obj/)\n\n[cf.waf.content\\_scan.has\\_obj](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_obj/)\n\n[Indicates whether the request contains at least one content object.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_obj/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.has_obj/)\n\n[cf.waf.content\\_scan.num\\_malicious\\_obj](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_malicious_obj/)\n\n[The number of malicious content objects detected in the request (zero or greater).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_malicious_obj/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_malicious_obj/)\n\n[cf.waf.content\\_scan.num\\_obj](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_obj/)\n\n[The number of content objects detected in the request (zero or greater).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_obj/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.num_obj/)\n\n[cf.waf.content\\_scan.obj\\_results](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_results/)\n\n[An array of scan results in the order the content objects were detected in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_results/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_results/)\n\n[cf.waf.content\\_scan.obj\\_sizes](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_sizes/)\n\n[An array of file sizes in bytes, in the order the content objects were detected in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_sizes/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_sizes/)\n\n[cf.waf.content\\_scan.obj\\_types](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_types/)\n\n[An array of file types in the order the content objects were detected in the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_types/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.content_scan.obj_types/)\n\n[cf.waf.credential\\_check.password\\_leaked](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.password_leaked/)\n\n[Indicates whether the password detected in the request was previously leaked.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.password_leaked/)\n\n[cf.waf.credential\\_check.username\\_and\\_password\\_leaked](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_and_password_leaked/)\n\n[Indicates whether the auth credentials detected in the request (username-password pair) were previously leaked.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_and_password_leaked/)\n\n[* Pro or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_and_password_leaked/)\n\n[cf.waf.credential\\_check.username\\_leaked](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_leaked/)\n\n[Indicates whether the username detected in the request was previously leaked.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_leaked/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_leaked/)\n\n[cf.waf.credential\\_check.username\\_password\\_similar](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_password_similar/)\n\n[Indicates whether a similar version of the username and password credentials detected in the request were previously leaked.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_password_similar/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.credential_check.username_password_similar/)\n\n[cf.waf.score](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score/)\n\n[A global score from 1–99 that combines the score of each WAF attack vector into a single score.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score/)\n\n[cf.waf.score.class](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.class/)\n\n[The attack score class of the current request, based on the WAF attack score.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.class/)\n\n[* Business or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.class/)\n\n[cf.waf.score.rce](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.rce/)\n\n[An attack score from 1–99 classifying the command injection or Remote Code Execution (RCE) attack vector.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.rce/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.rce/)\n\n[cf.waf.score.sqli](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.sqli/)\n\n[An attack score from 1–99 classifying the SQL injection (SQLi) attack vector.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.sqli/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.sqli/)\n\n[cf.waf.score.xss](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.xss/)\n\n[An attack score from 1–99 classifying the cross-site scripting (XSS) attack vector.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.xss/)\n\n[* Enterprise](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.waf.score.xss/)\n\n[cf.worker.upstream\\_zone](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.worker.upstream_zone/)\n\n[Identifies whether a request comes from a worker or not.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/cf.worker.upstream_zone/)\n\n[http.cookie](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.cookie/)\n\n[The entire cookie as a string.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.cookie/)\n\n[http.host](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.host/)\n\n[The hostname used in the full request URI.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.host/)\n\n[http.referer](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.referer/)\n\n[The HTTP `Referer` request header, which contains the address of the web page that linked to the currently requested page.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.referer/)\n\n[http.request.accepted\\_languages](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.accepted_languages/)\n\n[List of language tags provided in the `Accept-Language` HTTP request header.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.accepted_languages/)\n\n[http.request.body.form](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form/)\n\n[The HTTP request body of a form represented as a Map (or associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form/)\n\n[http.request.body.form.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.names/)\n\n[The names of the form fields in an HTTP request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.names/)\n\n[http.request.body.form.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.values/)\n\n[The values of the form fields in an HTTP request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.form.values/)\n\n[http.request.body.mime](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.mime/)\n\n[The MIME type of the request detected from the request body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.mime/)\n\n[http.request.body.multipart](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart/)\n\n[A Map (or associative array) representation of multipart names to multipart values in the request body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart/)\n\n[http.request.body.multipart.content\\_dispositions](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_dispositions/)\n\n[List of `Content-Disposition` headers for each part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_dispositions/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_dispositions/)\n\n[http.request.body.multipart.content\\_transfer\\_encodings](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_transfer_encodings/)\n\n[List of `Content-Transfer-Encoding` headers for each part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_transfer_encodings/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_transfer_encodings/)\n\n[http.request.body.multipart.content\\_types](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_types/)\n\n[List of `Content-Type` headers for each part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_types/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.content_types/)\n\n[http.request.body.multipart.filenames](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.filenames/)\n\n[List of filenames for each part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.filenames/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.filenames/)\n\n[http.request.body.multipart.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.names/)\n\n[List of multipart names for every part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.names/)\n\n[http.request.body.multipart.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.values/)\n\n[List of multipart values for every part in the multipart body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.multipart.values/)\n\n[http.request.body.raw](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.raw/)\n\n[The unaltered HTTP request body.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.raw/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.raw/)\n\n[http.request.body.size](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.size/)\n\n[The total size of the HTTP request body (in bytes).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.size/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.size/)\n\n[http.request.body.truncated](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.truncated/)\n\n[Indicates whether the HTTP request body is truncated.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.truncated/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.body.truncated/)\n\n[http.request.cookies](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.cookies/)\n\n[The `Cookie` HTTP header associated with a request represented as a Map (associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.cookies/)\n\n[* Pro or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.cookies/)\n\n[http.request.full\\_uri](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.full_uri/)\n\n[The full URI as received by the web server.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.full_uri/)\n\n[http.request.headers](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers/)\n\n[The HTTP request headers represented as a Map (or associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers/)\n\n[http.request.headers.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.names/)\n\n[The names of the headers in the HTTP request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.names/)\n\n[http.request.headers.truncated](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.truncated/)\n\n[Indicates whether the HTTP request contains too many headers.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.truncated/)\n\n[http.request.headers.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.values/)\n\n[The values of the headers in the HTTP request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.headers.values/)\n\n[http.request.jwt.claims.aud](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud/)\n\n[The `aud` (audience) claim identifies the recipients that the JSON Web Token (JWT) is intended for.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud/)\n\n[http.request.jwt.claims.aud.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.names/)\n\n[The `aud` (audience) claim identifies the recipients that the JSON Web Token (JWT) is intended for.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.names/)\n\n[http.request.jwt.claims.aud.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.values/)\n\n[The `aud` (audience) claim identifies the recipients that the JSON Web Token (JWT) is intended for.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.aud.values/)\n\n[http.request.jwt.claims.iat.sec](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec/)\n\n[The `iat` (issued at) claim identifies the time (number of seconds) at which the JWT was issued.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec/)\n\n[http.request.jwt.claims.iat.sec.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.names/)\n\n[The `iat` (issued at) claim identifies the time (number of seconds) at which the JWT was issued.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.names/)\n\n[http.request.jwt.claims.iat.sec.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.values/)\n\n[The `iat` (issued at) claim identifies the time (number of seconds) at which the JWT was issued.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iat.sec.values/)\n\n[http.request.jwt.claims.iss](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss/)\n\n[The `iss` (issuer) claim identifies the principal that issued the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss/)\n\n[http.request.jwt.claims.iss.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.names/)\n\n[The `iss` (issuer) claim identifies the principal that issued the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.names/)\n\n[http.request.jwt.claims.iss.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.values/)\n\n[The `iss` (issuer) claim identifies the principal that issued the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.iss.values/)\n\n[http.request.jwt.claims.jti](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti/)\n\n[The `jti` (JWT ID) claim provides a unique identifier for the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti/)\n\n[http.request.jwt.claims.jti.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.names/)\n\n[The `jti` (JWT ID) claim provides a unique identifier for the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.names/)\n\n[http.request.jwt.claims.jti.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.values/)\n\n[The `jti` (JWT ID) claim provides a unique identifier for the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.jti.values/)\n\n[http.request.jwt.claims.nbf.sec](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec/)\n\n[The `nbf` (not before) claim identifies the time (number of seconds) before which the JWT must not be accepted for processing.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec/)\n\n[http.request.jwt.claims.nbf.sec.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.names/)\n\n[The `nbf` (not before) claim identifies the time (number of seconds) before which the JWT must not be accepted for processing.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.names/)\n\n[http.request.jwt.claims.nbf.sec.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.values/)\n\n[The `nbf` (not before) claim identifies the time (number of seconds) before which the JWT must not be accepted for processing.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.nbf.sec.values/)\n\n[http.request.jwt.claims.sub](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub/)\n\n[The `sub` (subject) claim identifies the principal that is the subject of the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub/)\n\n[http.request.jwt.claims.sub.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.names/)\n\n[The `sub` (subject) claim identifies the principal that is the subject of the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.names/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.names/)\n\n[http.request.jwt.claims.sub.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.values/)\n\n[The `sub` (subject) claim identifies the principal that is the subject of the JWT.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.values/)\n\n[* Enterprise add-on](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.jwt.claims.sub.values/)\n\n[http.request.method](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.method/)\n\n[The HTTP method, returned as a string of uppercase characters.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.method/)\n\n[http.request.timestamp.msec](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.timestamp.msec/)\n\n[The millisecond when Cloudflare received the request, between 0–999.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.timestamp.msec/)\n\n[http.request.timestamp.sec](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.timestamp.sec/)\n\n[The timestamp when Cloudflare received the request, expressed as UNIX time in seconds.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.timestamp.sec/)\n\n[http.request.uri](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri/)\n\n[The URI path and query string of the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri/)\n\n[http.request.uri.args](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args/)\n\n[The HTTP URI arguments associated with a request represented as a Map (associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args/)\n\n[http.request.uri.args.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args.names/)\n\n[The names of the arguments in the HTTP URI query string.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args.names/)\n\n[http.request.uri.args.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args.values/)\n\n[The values of arguments in the HTTP URI query string.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.args.values/)\n\n[http.request.uri.path](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.path/)\n\n[The URI path of the request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.path/)\n\n[http.request.uri.path.extension](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.path.extension/)\n\n[The lowercased file extension in the URI path without the dot (`.`) character.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.path.extension/)\n\n[http.request.uri.query](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.query/)\n\n[The entire query string, without the `?` delimiter.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.uri.query/)\n\n[http.request.version](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.version/)\n\n[The version of the HTTP protocol used. Use this field when different checks are needed for different versions.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.request.version/)\n\n[http.response.code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.code/)\n\n[The HTTP status code returned to the client, either set by a Cloudflare product or returned by the origin server.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.code/)\n\n[http.response.content\\_type.media\\_type](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.content_type.media_type/)\n\n[The lowercased content type (including subtype and suffix) without any extra parameters, based on the response's `Content-Type` header.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.content_type.media_type/)\n\n[http.response.headers](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers/)\n\n[The HTTP response headers represented as a Map (or associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers/)\n\n[http.response.headers.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers.names/)\n\n[The names of the headers in the HTTP response.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers.names/)\n\n[http.response.headers.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers.values/)\n\n[The values of the headers in the HTTP response.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.response.headers.values/)\n\n[http.user\\_agent](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.user_agent/)\n\n[The HTTP `User-Agent` request header, which contains a characteristic string to identify the client operating system and web browser.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.user_agent/)\n\n[http.x\\_forwarded\\_for](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.x_forwarded_for/)\n\n[The full value of the `X-Forwarded-For` HTTP header.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/http.x_forwarded_for/)\n\n[ip.src](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src/)\n\n[The client TCP IP address, which may be adjusted to reflect the actual address of the client using HTTP headers such as `X-Forwarded-For` or `X-Real-IP`.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src/)\n\n[ip.src.asnum](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.asnum/)\n\n[The 16-bit or 32-bit integer representing the Autonomous System (AS) number associated with the client IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.asnum/)\n\n[ip.src.city](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.city/)\n\n[The city associated with the client IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.city/)\n\n[ip.src.continent](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.continent/)\n\n[The continent code associated with the client IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.continent/)\n\n[ip.src.country](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.country/)\n\n[The 2-letter country code in ISO 3166-1 Alpha 2 format.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.country/)\n\n[ip.src.is\\_in\\_european\\_union](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.is_in_european_union/)\n\n[Whether the request originates from a country in the European Union (EU).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.is_in_european_union/)\n\n[* Business or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.is_in_european_union/)\n\n[ip.src.lat](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.lat/)\n\n[The latitude associated with the client IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.lat/)\n\n[ip.src.lon](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.lon/)\n\n[The longitude associated with the client IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.lon/)\n\n[ip.src.metro\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.metro_code/)\n\n[The metro code or Designated Market Area (DMA) code associated with the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.metro_code/)\n\n[ip.src.postal\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.postal_code/)\n\n[The postal code associated with the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.postal_code/)\n\n[ip.src.region](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.region/)\n\n[The region name associated with the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.region/)\n\n[ip.src.region\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.region_code/)\n\n[The region code associated with the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.region_code/)\n\n[ip.src.subdivision\\_1\\_iso\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_1_iso_code/)\n\n[The ISO 3166-2 code for the first-level region associated with the IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_1_iso_code/)\n\n[* Business or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_1_iso_code/)\n\n[ip.src.subdivision\\_2\\_iso\\_code](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_2_iso_code/)\n\n[The ISO 3166-2 code for the second-level region associated with the IP address.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_2_iso_code/)\n\n[* Business or above](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.subdivision_2_iso_code/)\n\n[ip.src.timezone.name](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.timezone.name/)\n\n[The name of the timezone associated with the incoming request.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ip.src.timezone.name/)\n\n[raw.http.request.full\\_uri](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.full_uri/)\n\n[The raw full URI as received by the web server without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.full_uri/)\n\n[raw.http.request.uri](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri/)\n\n[The URI path and query string of the request without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri/)\n\n[raw.http.request.uri.args](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args/)\n\n[The raw HTTP URI arguments associated with a request represented as a Map (associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args/)\n\n[raw.http.request.uri.args.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args.names/)\n\n[The raw names of the arguments in the HTTP URI query string.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args.names/)\n\n[raw.http.request.uri.args.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args.values/)\n\n[The raw values of arguments in the HTTP URI query string.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.args.values/)\n\n[raw.http.request.uri.path](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.path/)\n\n[The raw URI path of the request without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.path/)\n\n[raw.http.request.uri.path.extension](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.path.extension/)\n\n[The raw file extension in the request URI path without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.path.extension/)\n\n[raw.http.request.uri.query](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.query/)\n\n[The entire query string without the `?` delimiter and without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.request.uri.query/)\n\n[raw.http.response.headers](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers/)\n\n[The HTTP response headers without any transformation represented as a Map (or associative array).](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers/)\n\n[raw.http.response.headers.names](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers.names/)\n\n[The names of the headers in the HTTP response without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers.names/)\n\n[raw.http.response.headers.values](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers.values/)\n\n[The values of the headers in the HTTP response without any transformation.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/raw.http.response.headers.values/)\n\n[ssl](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ssl/)\n\n[Returns `true` when the HTTP connection to the client is encrypted.](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/reference/ssl/)\n\n</page>\n\n<page>\n---\ntitle: Use with other Cloudflare products · Cloudflare Smart Shield docs\ndescription: Use Dedicated CDN Egress IPs in combination with different Cloudflare products.\nlastUpdated: 2025-11-19T12:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/other-products/\n  md: https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/other-products/index.md\n---\n\nUse Dedicated CDN Egress IPs in combination with different Cloudflare products.\n\n## Access and CNI\n\nYou can use Dedicated CDN Egress IPs combined with [Cloudflare Network Interconnect (CNI)](https://developers.cloudflare.com/network-interconnect/) to secure your applications with [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) without installing software or customizing code on your server.\n\nWhile Access allows you to enforce policies at the hostname level, other solutions are usually necessary to protect against origin IP bypass [1](#user-content-fn-1). With Dedicated CDN Egress IPs, you only allow a small number of IPs (that are not publicly listed) through your network firewall and, with Cloudflare Network Interconnect, you can use a completely private path between Cloudflare and your application server, without exposure to the public Internet. For details and background, refer to the [Cloudflare blog](https://blog.cloudflare.com/access-aegis-cni).\n\nDedicated CDN Egress IPs are included within [BGP advertisement over CNI](https://developers.cloudflare.com/network-interconnect/).\n\n## Data Localization Suite\n\n[Data Localization Suite (DLS)](https://developers.cloudflare.com/data-localization/) is an enterprise add-on that enables you to choose the location where Cloudflare encrypts, decrypts, and stores data.\n\nTo ensure egress will happen from DLS-specified locations, make sure you have Dedicated CDN Egress IPs provisioned in those locations. Refer to [IPs allocation](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/egress-ips/#ips-allocation) for details.\n\n## Load Balancing\n\n[Cloudflare Load Balancing](https://developers.cloudflare.com/load-balancing/) allows you to intelligently distribute traffic across your origins by issuing regular monitors (that assess origin health) and following the traffic steering policies you define.\n\nBy default, the Load Balancing monitors will use public Cloudflare IP addresses.\n\nTo avoid inconsistencies between what the Load Balancing monitors report and what you observe in service traffic with Dedicated CDN Egress IPs, make sure to turn on the **Simulate Zone** option in the [monitor settings](https://developers.cloudflare.com/load-balancing/monitors/create-monitor/#create-a-monitor).\n\n## Spectrum\n\n[Spectrum](https://developers.cloudflare.com/spectrum/) allows you to route email, file transfer, games, and more over TCP or UDP through Cloudflare. This means you can mask your origin and protect it from DDoS attacks.\n\nWhile you can use [BYOIP](https://developers.cloudflare.com/byoip/) or static IPs to control which IPs are used for ingress with Spectrum, Dedicated CDN Egress IPs allows you to have a more strict list of [egress IPs](https://developers.cloudflare.com/smart-shield/configuration/dedicated-egress-ips/how-it-works/egress-ips/) as well.\n\nDedicated CDN Egress IPs with Spectrum supports both TCP and UDP application types. HTTP/HTTPS types are also supported, although through a different configuration.\n\nIf you are interested in any of these solutions, contact your account team.\n\n## Workers\n\n[Workers](https://developers.cloudflare.com/workers/) provides a serverless execution environment for you to create applications leveraging Cloudflare's global network.\n\nRefer to the sections below for information on how Dedicated CDN Egress IPs pair up with Workers.\n\n### `fetch`\n\n[`fetch()` requests](https://developers.cloudflare.com/workers/runtime-apis/fetch/) that access services on your origin will use Dedicated CDN Egress IP addresses.\n\nWorkers subrequests — requests from one Worker to another — are expected to use different IPs. However, [`fetch()` requests](https://developers.cloudflare.com/workers/runtime-apis/fetch/) to external origins made by a Worker invoked via a subrequest will use Dedicated CDN Egress IP addresses.\n\n### `connect`\n\nFor [`connect()` requests](https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/) - which create outbound TCP connections from Workers - Dedicated CDN Egress IPs are **not** used.\n\n## Footnotes\n\n1. When an attacker knows your origin server IP and uses it to directly interact with the target application. [↩](#user-content-fnref-1)\n\n</page>\n\n<page>\n---\ntitle: Health Checks analytics · Cloudflare Smart Shield docs\ndescription: Use Health Checks analytics to debug possible origin issues.\nlastUpdated: 2025-09-17T12:18:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/health-checks/analytics/\n  md: https://developers.cloudflare.com/smart-shield/configuration/health-checks/analytics/index.md\n---\n\nUse Health Checks analytics to debug possible origin issues.\n\nYou can evaluate origin uptime, latency, failure reason, and specific event logs:\n\n* **Health Checks By Uptime**: Shows the percentage of uptime for individual origins over time.\n\n* **Health Checks By Failure Reason**: Shows a breakdown of failures by the specific reason. Refer to [common error code causes and solutions below](#common-error-codes).\n\n* **Health Checks By Latency**: Shows average latency – measured in round trip time — for individual origins over time.\n\n* **Event Log**: Shows individual health check data.\n\n  * Select each record for additional details on **Round trip time**, the **Failure Reason**, the **Average Waterfall** (showing chronological data about request stages), **Response status code**, and more.\n  * Note that **Global** is not a configured region; it represents the aggregated data from all enabled regions.\n\n## Common error codes\n\n### TCP connection failed\n\n#### Cause\n\nHealth Checks failed to establish a TCP connection to your origin server.\n\n#### Solution\n\nThis typically occurs when there is a network failure between Cloudflare and your origin, and/or a firewall refuses to allow our connection. Ensure your network and firewall configurations are not interfering with traffic.\n\n### HTTP timeout occurred\n\n#### Cause\n\nThe origin failed to return an HTTP response within the timeout configured. This happens if you have the timeout set to a low number. For example, one to two seconds.\n\n#### Solution\n\nCloudflare recommends increasing the HTTP response timeout to allow the origin server to respond.\n\n### Response code mismatch error\n\n#### Cause\n\nCloudflare receives an HTTP status code that does not match the values defined in the `expected_codes` property of your Health Check configuration.\n\n#### Solution\n\nResponse codes must match the `expected_codes`. Confirm the values are correct by comparing the expected response codes and the status code received in the Event Log.\n\n#### ​​Alternate cause\n\nYou may also see this issue if you have a Health Check configured to use HTTP connections and your origin server is redirecting to HTTPS. In this case, the response code will often be `301`, `302`, or `303`.\n\n#### Solution\n\nChange your Cloudflare Health Check configuration to use HTTPS or set the value of `follow_redirect` to `true` so that Cloudflare can resolve the correct status code.\n\n### Response body mismatch error\n\n#### Cause\n\nThe response body returns from your origin server and does not include the (case-insensitive) value of `expected_body` configured in your Health Check.\n\nNote\n\nWe only read the first 10 KB of the response. If you return a larger response, and the `expected_body` is not in the first 10 KB, the Health Check will fail.\n\n#### Solution\n\nEnsure the `expected_body` is in the first 10 KB of the response body. ​​\n\n### TLS untrusted certificate error\n\n#### Cause\n\nThe certificate is not trusted by a public Certificate Authority (CA).\n\n#### Solution\n\nIf you’re using a self-signed certificate, Cloudflare recommends either using a publicly trusted certificate or setting the `allow_insecure` property on your Health Check to `true`.\n\n### TLS name mismatch error\n\n#### Cause\n\nOur Health Check (client) was not able to match a name on the server certificate to the hostname of the request.\n\n#### Solution\n\nInspect your Health Check configuration to confirm that the `header` value set in the Cloudflare Health Check is correct.\n\n### TLS protocol error\n\n#### Cause\n\nThis error can occur if you are using an older version of TLS or your origin server is not configured for HTTPS.\n\n#### Solution\n\nEnsure that your origin server supports TLS 1.2 or greater and is configured for HTTPS.\n\n### TLS unrecognized name error\n\n#### Cause\n\nThe server did not recognize the name provided by the client. When a host header is set, this is set as the ServerName in the initial TLS handshake. If it is not set, Cloudflare will not provide a ServerName, which can cause this error.\n\n#### Solution\n\nSet the host header in your Health Check object.\n\n### ​​No route to host error\n\n#### Cause\n\nThe IP address cannot be reached from Cloudflare’s network. Common causes are ISP or hosting provider network issues (e.g. BGP level), or that the IP does not exist.\n\n#### Solution\n\nEnsure IP is accurate, and check if there is an ISP or hosting provider network issue.\n\n### TCP Timeout\n\n#### Cause\n\nData transmission was not acknowledged and the retransmit of data did not succeed.\n\n#### Solution\n\nConfirm whether the SYN-ACK for the handshake takes place at your origin and contact [Cloudflare support](https://developers.cloudflare.com/support/contacting-cloudflare-support/).\n\n### ​​Network Unreachable\n\n#### Cause\n\nCloudflare cannot connect to the origin web server due to network unavailability. This is usually caused by a network issue or incorrect origin IP.\n\n#### Solution\n\nCheck the IP entered for the origin in Cloudflare’s Health Checks configuration or the IP returned via DNS for the origin hostname.\n\n### HTTP Invalid Response\n\n#### Cause\n\nUsually caused by an HTTP 502 error or bad gateway.\n\n#### Solution\n\nEnsure the origin web server responds to requests and that no applications have crashed or are under high load.\n\n### DNS Unknown Host\n\n#### Cause\n\nThe origin web server hostname does not exist.\n\n#### Solution\n\nConfirm the origin web server resolves to an IP address.\n\n### Connection Reset by Peer\n\n#### Cause\n\nA network error occurred while the client received data from the origin web server.\n\n#### Solution\n\nConfirm whether the origin web server is experiencing a high amount of traffic or an error.\n\n### Monitor Configuration Error\n\n#### Cause\n\nThere was a configuration error in the Health Check and no checks were run against the origin.\n\n#### Solution\n\nReview your Health Check configuration to ensure it matches an expected request to your origin.\n\n### ​​DNS Internal\n\n#### Cause\n\nThe origin web server’s hostname resolves to an internal or restricted address. No checks are run against this origin.\n\n#### Solution\n\nCloudflare does not allow use of an origin web server hostname that resolves to a Cloudflare IP.\n\n### Other Failure\n\n#### Cause\n\nIf the failure cannot be classified as any other type of failure mentioned above.\n\n#### Solution\n\nContact [Cloudflare support](https://developers.cloudflare.com/support/contacting-cloudflare-support/).\n\n</page>\n\n<page>\n---\ntitle: Manage Health Checks · Cloudflare Smart Shield docs\ndescription: Refer to the section below to learn how to manage your Smart Shield\n  health checks.\nlastUpdated: 2025-09-17T12:18:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/health-checks/setup/\n  md: https://developers.cloudflare.com/smart-shield/configuration/health-checks/setup/index.md\n---\n\nRefer to the section below to learn how to manage your Smart Shield health checks.\n\n## Create and edit health checks\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com) and select your account and domain.\n\n2. Go to **Speed** > **Smart Shield**.\n\n3. For Health Checks, select **Manage**.\n\n4. Select **Create** or find an existing health check and select **Edit**.\n\n5. Fill out the form or edit existing values, paying special attention to:\n\n   * The values for **Interval** and **Check regions**, because decreasing the **Interval** and increasing **Check regions** may increase the load on your origin server.\n   * **Retries**, which specify the number of retries to attempt in case of a timeout before marking the origin as unhealthy.\n\n6. Select **Save and Deploy**.\n\n## Configure alerts\n\nYou can configure [notification emails](https://developers.cloudflare.com/notifications/get-started/) to be alerted when the health check detects that there is a change in the status of your origin server. Cloudflare will send you an email within seconds so you can take the necessary action before customers are impacted.\n\nThe email provides information to determine what caused the health status change. You can evaluate when the change happened, the status of the origin server, if and why it is unhealthy, the expected response code, and the received response code. Refer to [common error codes](https://developers.cloudflare.com/smart-shield/configuration/health-checks/analytics/#common-error-codes) for further guidance.\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com) and select your account and domain.\n2. Go to **Speed** > **Smart Shield**.\n3. For Health Checks, select **Manage** and then **Configure an alert**.\n4. Fill out the **Notification name** and **Description**.\n5. Add a Notification email.\n6. Select **Next**.\n7. Add health checks to include in your alerts.\n8. Choose the **Notification trigger**, which determines when you receive alerts.\n9. Select **Create**.\n\n</page>\n\n<page>\n---\ntitle: Zone lockdown migration guide · Cloudflare Smart Shield docs\ndescription: Currently, any Cloudflare customer on a paid plan can configure\n  Health Checks against any host or IP. Zone Lockdown specifies a list of one or\n  more IP addresses, CIDR ranges, or networks that are the only IPs allowed to\n  access a domain, subdomain, or URL. It allows multiple destinations in a\n  single rule as well as IPv4 and IPv6 addresses. IP addresses not specified in\n  the Zone Lockdown rule are denied access to the specified resources.\nlastUpdated: 2025-09-17T12:18:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/smart-shield/configuration/health-checks/zone-lockdown/\n  md: https://developers.cloudflare.com/smart-shield/configuration/health-checks/zone-lockdown/index.md\n---\n\nCurrently, any Cloudflare customer on a paid plan can configure Health Checks against any host or IP. [Zone Lockdown](https://developers.cloudflare.com/waf/tools/zone-lockdown/) specifies a list of one or more IP addresses, CIDR ranges, or networks that are the only IPs allowed to access a domain, subdomain, or URL. It allows multiple destinations in a single rule as well as IPv4 and IPv6 addresses. IP addresses not specified in the Zone Lockdown rule are denied access to the specified resources.\n\nCustomers who use zone lockdown and want their health checks to continue passing can use [WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/) to bypass zone lockdown.\n\n## Bypass zone lockdown\n\nTo bypass zone lockdown using a WAF custom rule:\n\n1. Follow the steps to [create a custom rule in the dashboard](https://developers.cloudflare.com/waf/custom-rules/create-dashboard/).\n\n2. Create a custom rule matching on **user agent**.\n\n   Cloudflare Health Checks have a user agent of the following format: `Mozilla/5.0 (compatible;Cloudflare-Healthchecks/1.0;+https://www.cloudflare.com/; healthcheck-id: XXX)` where `XXX` is replaced with the first 16 characters of the Health Check ID.\n\n   To allow a specific Health Check, verify if the user agent contains the first 16 characters of the Health Check ID.\n\n3. Set the action to *Skip* and the corresponding feature to **Zone Lockdown** under **More components to skip**.\n\n### Via the API\n\nThis example adds a new WAF custom rule to the ruleset with ID `{ruleset_id}` that skips zone lockdown for incoming requests with a user agent containing `1234567890abcdef`:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Content compression · Cloudflare Speed docs\ndescription: Learn how Cloudflare compresses content for faster web performance.\nlastUpdated: 2025-09-23T08:43:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/compression/\n  md: https://developers.cloudflare.com/speed/optimization/content/compression/index.md\n---\n\nCloudflare compresses content in two ways: between Cloudflare and your website visitors and between Cloudflare and your origin server.\n\n## Compression between Cloudflare and website visitors\n\nIn addition to Cloudflare's [default caching behavior](https://developers.cloudflare.com/cache/concepts/default-cache-behavior/), Cloudflare supports Gzip, Brotli, and Zstandard compression when delivering content to website visitors.\n\nNote\n\nCustomers can enable Zstandard compression through [Compression Rules](https://developers.cloudflare.com/rules/compression-rules/).\n\nIf supported by visitors' web browsers, Cloudflare will return Gzip, Brotli, or Zstandard-encoded responses for the following content types:",
      "language": "unknown"
    },
    {
      "code": "Cloudflare's global network can deliver content to website visitors using Gzip compression, Brotli compression, Zstandard compression, or no compression, depending on:\n\n* The values visitors provide in the `accept-encoding` request header.\n* Your [Cloudflare plan](#between-visitors-and-cloudflare).\n* Any configured [compression rule](https://developers.cloudflare.com/rules/compression-rules/) that matches incoming requests.\n\nFor responses with error status codes, Cloudflare will only compress responses if their error status code is `403` or `404`. For successful response status codes, Cloudflare will only compress responses if their status code is `200`. Responses with other status codes will not be compressed.\n\nYou can override Cloudflare's default compression behavior using [Compression Rules](https://developers.cloudflare.com/rules/compression-rules/).\n\nMinimum response size for compression\n\nCloudflare will only apply compression to responses with a minimum size when sending them to website visitors:\n\n* For Gzip, responses must have a minimum size of 48 bytes.\n* For Brotli and Zstandard, responses must have a minimum size of 50 bytes.\n\nSmaller responses will not be compressed, regardless of their content type.\n\n### Content-Length header handling\n\nWhen Cloudflare compresses a response sent to the website visitor, it may omit the `Content-Length` HTTP header to avoid delivering incorrect length information caused by dynamic transformations. To preserve the `Content-Length` header set by the origin server, add `cache-control: no-transform` to the origin server's response. This directive prevents Cloudflare from altering compression on responses, allowing the `Content-Length` header to pass through as-is. The `cache-control: no-transform` header must be set by the origin — it cannot be added in client requests.\n\n***\n\n## Content compression from origin servers to the Cloudflare network\n\nWhen requesting content from your origin server, Cloudflare supports Brotli compression, Gzip compression, or no compression.",
      "language": "unknown"
    },
    {
      "code": "If your origin server responds to a Cloudflare request using Brotli/Gzip compression, we will keep the same compression in the response sent to the website visitor if:\n\n* You include a `content-encoding` header in your server response mentioning the compression being used (`br` or `gzip`).\n* The visitor browser (or client) supports the compression algorithm.\n* You do not enable Cloudflare features that change the response content (refer to [Notes about end-to-end compression](#notes-about-end-to-end-compression) for details).\n\nCloudflare's reverse proxy can also convert between compressed formats and uncompressed formats. Cloudflare can receive content from your origin server with Brotli or Gzip compression and serve it to visitors uncompressed (or vice versa), independently of caching.\n\nIf you do not want a particular response from your origin to be encoded with Brotli/Gzip when delivered to website visitors, you can disable this by including a `cache-control: no-transform` HTTP header in the response from your origin web server.\n\nWarning\n\nCloudflare will take into consideration the `accept-encoding` header value in website visitors' requests when sending responses to those visitors. However, when requesting content from your origin server, Cloudflare will send a different `Accept-Encoding` header, supporting Brotli and Gzip compression.\n\n***\n\n## Notes about end-to-end compression\n\n### Content recompression due to dynamic transformations\n\nEven when using the same compression algorithm end to end (between your origin server and Cloudflare, and between the Cloudflare global network and your website visitor), Cloudflare will need to decompress the response and compress it again if you enable any of the following settings for the request:\n\n* [Automatic HTTPS Rewrites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/automatic-https-rewrites/)\n* [Cloudflare Fonts](https://developers.cloudflare.com/speed/optimization/content/fonts/)\n* [Email Address Obfuscation](https://developers.cloudflare.com/waf/tools/scrape-shield/email-address-obfuscation/)\n* [Mirage](https://developers.cloudflare.com/speed/optimization/images/mirage/) (deprecated)\n* [Polish](https://developers.cloudflare.com/images/polish/)\n* [Rocket Loader](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/)\n* [JavaScript detections](https://developers.cloudflare.com/bots/additional-configurations/javascript-detections/)\n* [RUM](https://developers.cloudflare.com/speed/observatory/run-speed-test/#enable-real-user-monitoring-rum)\n\nTo disable these settings for specific URI paths, create a [configuration rule](https://developers.cloudflare.com/rules/configuration-rules/).\n\nNote\n\nAdditionally, the [Replace insecure JS libraries](https://developers.cloudflare.com/waf/tools/replace-insecure-js-libraries/) setting also requires Cloudflare to decompress the response and compress it again. At this time, you cannot turn it off using Configuration Rules.\n\n### Content-Length header\n\nCloudflare may remove the `Content-Length` HTTP header of responses delivered to website visitors. To ensure that the header is preserved, add a `cache-control: no-transform` HTTP header to the response at the origin server.\n\n## Compression methods by plan\n\n### Between visitors and Cloudflare\n\nBy default, Cloudflare uses the following compression methods for content delivery, depending on the zone plan. However, the actual compression applied may also depend on what the visitor's browser requests via the `accept-encoding` header.\n\n* Free Plan: Content is compressed by default using Zstandard.\n* Pro and Business Plans: Content is compressed by default using Brotli.\n* Enterprise Plan: Content is compressed by default using Gzip.\n\n### Between Cloudflare and the origin server\n\nOn all plans, Cloudflare requests content from the origin server using the `accept-encoding: br, gzip` header. This means that Cloudflare asks the origin to send the content compressed using Brotli or Gzip, depending on which method the origin server supports.\n\n</page>\n\n<page>\n---\ntitle: Automatic Platform Optimization · Cloudflare Speed docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/apo/\n  md: https://developers.cloudflare.com/speed/optimization/content/apo/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Early Hints · Cloudflare Speed docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/early-hints/\n  md: https://developers.cloudflare.com/speed/optimization/content/early-hints/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Cloudflare Fonts (beta) · Cloudflare Speed docs\ndescription: Cloudflare Fonts is a feature designed for websites that use Google\n  Fonts. It rewrites Google Fonts to be delivered from a website’s own origin,\n  eliminating the need to rely on third-party font providers. Cloudflare Fonts\n  is tailored to improve website performance and user privacy without the need\n  for any code changes or self-hosting of fonts.\nlastUpdated: 2025-10-10T13:43:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/fonts/\n  md: https://developers.cloudflare.com/speed/optimization/content/fonts/index.md\n---\n\nCloudflare Fonts is a feature designed for websites that use Google Fonts. It rewrites Google Fonts to be delivered from a website’s own origin, eliminating the need to rely on third-party font providers. Cloudflare Fonts is tailored to improve website performance and user privacy without the need for any code changes or self-hosting of fonts.\n\n## How Cloudflare Fonts works\n\nCloudflare Fonts works by rewriting your webpage’s HTML. It removes Google Fonts links and replaces them with inline CSS. This CSS includes links to fonts from your own Cloudflare zone rather than from Google servers. This ensures that font files are served from your domain through Cloudflare's infrastructure, optimizing performance and enhancing user privacy.\n\n### Browser support\n\nCloudflare Fonts is compatible with browsers that support Unicode-range subsetting and WOFF or WOFF2 formats, including:",
      "language": "unknown"
    },
    {
      "code": "## Get started\n\nTo enable Cloudflare Fonts for your entire domain:\n\n1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n2. Go to **Content Optimization**.\n\n3. For **Cloudflare Fonts**, switch the toggle to **On**.\n\nNote\n\nTo use this feature on specific hostnames - instead of across your entire zone - use a [configuration rule](https://developers.cloudflare.com/rules/configuration-rules/).\n\n## Limitations\n\nWhile Cloudflare Fonts offers powerful font optimization capabilities, it is important to be aware of its limitations:\n\n* **Font transformation**: Currently, Cloudflare Fonts exclusively supports Google Fonts transformation.\n* **APO compatibility**: Cloudflare Fonts does not operate when [Automatic Platform Optimization](https://developers.cloudflare.com/automatic-platform-optimization/) (APO) is enabled. Cloudflare APO automatically optimizes Google Fonts in a similar way.\n* **CSS import**: Cloudflare Fonts is compatible only with the `<link>` setup for Google Fonts and does not support the CSS `@import` method.\n* **CSP headers**: Cloudflare Fonts does not modify [Content Security Policy (CSP)](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy) headers. Certain CSP configurations may make Cloudflare Fonts stop working, such as restrictions on inline styles through [`style-src`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/style-src), or restriction of fonts originating from the site's own origin via [`font-src`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/font-src).\n* **Fallback mechanism**: In cases where Cloudflare Fonts does not support a specific page, it will gracefully fallback to using Google Fonts.\n\n</page>\n\n<page>\n---\ntitle: Prefetch URLs · Cloudflare Speed docs\ndescription: URL prefetching means that Cloudflare pre-populates the cache with\n  content a visitor is likely to request next. This setting — when combined with\n  additional setup — leads to a higher cache hit rate and thus a faster\n  experience for the user.\nlastUpdated: 2025-12-11T15:46:03.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/prefetch-urls/\n  md: https://developers.cloudflare.com/speed/optimization/content/prefetch-urls/index.md\n---\n\nURL prefetching means that Cloudflare pre-populates the cache with content a visitor is likely to request next. This setting — when combined with [additional setup](#setup) — leads to a higher cache hit rate and thus a faster experience for the user.\n\n***\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | No | No | Yes |\n\n***\n\n## Setup\n\nFor Cloudflare to start prefetching URLs, you will need to [enable the feature](#enable-prefetch-urls) and [include a list of URLs to prefetch](#choose-urls-to-prefetch).\n\n### Enable Prefetch URLs\n\n* Dashboard\n\n  To enable **Prefetch URLs** in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n  2. Go to **Content Optimization**.\n\n  3. For **Prefetch URLs**, switch the toggle to **On**.\n\n* API\n\n  To enable or disable **Prefetch URLs** with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `prefetch_preload` as the setting name in the URI path, and the `value` parameter set to your desired setting (`\"on\"` or `\"off\"`).\n\n### Choose URLs to prefetch\n\nAfter you [enable the feature](#enable-prefetch-urls), you also need to indicate which URLs Cloudflare should prefetch.\n\nTo do this, include a Link HTTP response header pointing to a manifest file with the `rel=\"prefetch\"` attribute and then serve the manifest file with `text/plain` as the Content-type response header.\n\nExample HTTP response header:\\\n`Link: <http://www.example.com/manifest.txt>; rel=\"prefetch\"`\n\nExample `manifest.txt` file:",
      "language": "unknown"
    },
    {
      "code": "The manifest file should contain URIs, protocol-relative URLs or full URLs, separated by new lines. These files must be on your websites that are on Cloudflare. If you reference HTML pages, only the HTML page itself will be pre-fetched - any sub-requests from that HTML will not be fetched unless they are also defined explicitly in your manifest.\n\nNote\n\nThe IP address used to make the prefetch request to the manifest file is logged as `127.0.0.1` in your Cloudflare logs.\n\n### Prefetch files limits\n\nThe prefetch files limits are the following:\n\n* The maximum number of manifest files is 16.\n* The maximum number of files per manifest file is 100.\n* A manifest file has a size limit of 1 MB.\n\n## Limitations\n\n* Cloudflare will only prefetch files listed in the manifest file if the resources are those [cached by default](https://developers.cloudflare.com/cache/concepts/default-cache-behavior/#default-cached-file-extensions).\n\n* Prefetch is not compatible with the custom cache key configuration. For more information, refer to [Cache Key limitations](https://developers.cloudflare.com/cache/how-to/cache-keys/#limitations).\n\n</page>\n\n<page>\n---\ntitle: Rocket Loader · Cloudflare Speed docs\ndescription: Rocket Loader prioritizes your website's content (text, images,\n  fonts, and more) by deferring the loading of all of your JavaScript until\n  after rendering.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/rocket-loader/\n  md: https://developers.cloudflare.com/speed/optimization/content/rocket-loader/index.md\n---\n\nRocket Loader prioritizes your website's content (text, images, fonts, and more) by deferring the loading of all of your JavaScript until after rendering.\n\nThis type of loading (known as asynchronous loading) leads to earlier rendering of your page content. Rocket Loader handles both inline and external scripts, while maintaining order of execution. Cloudflare will detect incompatible browsers and disable Rocket Loader.\n\nOn pages with JavaScript, this results in a [much faster loading experience](https://www.cloudflare.com/learning/performance/test-the-speed-of-a-website/) for your users and improves the following performance metrics:\n\n* Time to First Paint (TTFP)\n* Time to First Contentful Paint (TTFCP)\n* Time to First Meaningful Paint (TTFMP)\n* Document Load\n\n## How to\n\n* [Enable](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/enable/)\n* [Ignore JavaScripts](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/ignore-javascripts/)\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Limitations\n\nSome of Cloudflare's optional features, including Rocket Loader and Email Obfuscation, use non standard tags that fail strict HTML validation via tools like [w3.org](https://validator.w3.org/). These failures do not correlate to issues for your site visitors.\n\nIf you observe JavaScript or jQuery issues for your website, [disable Rocket Loader](https://developers.cloudflare.com/speed/optimization/content/rocket-loader/enable/) and retest your website.\n\nIf you have a Content Security Policy (CSP) in place for your domain, you will need to [update your headers](https://developers.cloudflare.com/fundamentals/reference/policies-compliances/content-security-policies/#product-requirements) to support Rocket Loader.\n\n\n</page>\n\n<page>\n---\ntitle: Smart Hints · Cloudflare Speed docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/smart-hints/\n  md: https://developers.cloudflare.com/speed/optimization/content/smart-hints/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Speed Brain · Cloudflare Speed docs\ndescription: Learn how Speed Brain enhances web performance by prefetching\n  likely next pages, improving metrics like LCP and TTFB.\nlastUpdated: 2025-10-10T13:43:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/speed-brain/\n  md: https://developers.cloudflare.com/speed/optimization/content/speed-brain/index.md\n---\n\nSpeed Brain is a tool for improving web page performance by prefetching the most likely next navigation.\n\n***\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Enabled by default | Yes | Yes | Yes |\n\n***\n\n## Requirements\n\nSpeed Brain works under the following conditions:\n\n* The Speed Brain feature is enabled in Cloudflare.\n* The browser of the web page visitor is using a Chromium-based browser version 121 or later.\n* The web page requested by the prefetch is eligible for cache.\n* The page requested by the prefetch does not invoke a Worker.\n\n## What is Speed Brain?\n\nThe overall goal of Speed Brain is to try to download a webpage to the browser before a user navigates to it.\n\nCloudflare leverages the [Speculation Rules API](https://developer.mozilla.org/en-US/docs/Web/API/Speculation_Rules_API) to improve web page performance by instructing the browser to consider prefetching future navigations. Speed Brain does not improve page load time for the first page that is visited on a website, but it can improve it for subsequent web pages that are navigated to on the same site.\n\nBy prefetching pages that the browser considers likely to be navigated to, Speed Brain can enhance key metrics like [Largest Content Paint](https://web.dev/articles/lcp) (LCP), [Time to First Byte](https://web.dev/articles/ttfb) (TTFB) and overall page load time.\n\n## How Speed Brain works\n\nWhen Cloudflare's Speed Brain feature is enabled, an HTTP header called `Speculation-Rules` is added to web page responses. The value for this header is an URL that hosts an opinionated Speculation-Rules configuration. This configuration instructs the browser to consider prefetching any future navigations with a `conservative` [eagerness](https://developer.chrome.com/docs/web-platform/prerender-pages#eagerness).\n\nThe configuration looks like this:",
      "language": "unknown"
    },
    {
      "code": "This configuration instructs the browser to initiate prefetch requests for future navigations. These prefetch requests will include the `sec-purpose: prefetch` HTTP request header. Prefetches that are not successful will respond with a `503` status code. Prefetches that are successful will respond with a `200` status code.\n\n## Test Speed Brain\n\nTo test that Speed Brain is enabled, you can check that your HTTP response headers for your web pages include the `Speculation-Rules` header. However, note that during the beta phase of Speed Brain, this behavior might not be 100% consistent.\n\nTo test whether your browser is making prefetch requests, open the **Network** tab in Chrome DevTools. Then, mouse-down on a link on a webpage with Speed Brain enabled. This action should initiate a prefetch request, which will be  visible in the **Network** tab. However, note that there are several reasons why the browser might choose not to initiate a prefetch. Refer to the [Chrome Limits guide](https://developer.chrome.com/docs/web-platform/prerender-pages#chrome-limits) for more details. For more general information about debugging Speculation-Rules, refer to the [Chrome Speculation Debugging guide](https://developer.chrome.com/docs/devtools/application/debugging-speculation-rules).\n\n## RUM integration\n\nSpeed Brain is designed to integrate with Web Analytics & Real User Measurements (RUM). This integration allows you to understand the web performance implications of Speed Brain within the Web Analytics interface in Cloudflare's Dashboard.\n\nWhile you can use Speed Brain without RUM enabled, you will not have visibility into how the feature is affecting the performance of your web pages. For further details on how to set up RUM, refer to the [Web Analytics & RUM](https://developers.cloudflare.com/web-analytics/) documentation.\n\n## Enable and disable Speed Brain\n\nSpeed Brain is available in Cloudflare's **Speed** tab of the dashboard and also in the API.\n\n* Dashboard\n\n  To enable or disable **Speed Brain** in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n  2. Go to **Content Optimization**.\n\n  3. Toggle **Speed Brain** to **On** or **Off**.\n\n* API\n\n  Use the following `PATCH` request to enable Speed Brain:\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Zone Settings Write`",
      "language": "unknown"
    },
    {
      "code": "To disable Speed Brain, set `value:` to `\"off\"`.\n\n* Terraform\n\n  You can also configure Speed Brain using Terraform. For more details, refer to the `cloudflare_zone_settings_override` resource in the [Terraform documentation](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs).\n\n## Caveats\n\n* Since prefetch responses are not guaranteed to be rendered by the browser, Speed Brain includes two safeguards to minimize the risk of [unsafe prefetching](https://developer.mozilla.org/en-US/docs/Web/API/Speculation_Rules_API#unsafe_prefetching):\n\n  * Speed Brain will not prefetch on routes that run Workers. Without this safeguard, prefetch requests could inadvertently run Worker logic that assumes the incoming request is a normal (that is, not a prefetch) request. An example of this could be an incrementing page view counter running in a Worker. A page view counter should not increment if the page is not actually rendered in the browser.\n\n  * Prefetch requests will never reach origin servers. Prefetch requests only serve content that is stored in Cloudflare’s Cache. If the content is not in Cache, the prefetch request will not continue to origin servers. Without this safeguard, origin server state could be modified despite the prefetch response not being rendered in the browser. An example of this could be a prefetch `GET` request to a sign-out URL inadvertently triggering a sign-out action on the server.\n\n* If origin server responses include the `Speculation-Rules` header, it will not be overridden.\n\n* Speed Brain will not work with restrictive [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy/script-src) configurations using `strict-dynamic` or `nonce-{hash}` attributes.\n\n* Currently, Speed Brain is not compatible with websites that use or rely on `pages.dev`.\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting Optimization issues · Cloudflare Speed docs\nlastUpdated: 2024-09-13T14:14:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/content/troubleshooting/\n  md: https://developers.cloudflare.com/speed/optimization/content/troubleshooting/index.md\n---\n\n* [Content encoding issues](https://developers.cloudflare.com/speed/optimization/content/troubleshooting/content-encoding-issues/)\n* [Turn off Auto Minify via API](https://developers.cloudflare.com/speed/optimization/content/troubleshooting/disable-auto-minify/)\n\n</page>\n\n<page>\n---\ntitle: Image Resizing · Cloudflare Speed docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/images/image-resizing/\n  md: https://developers.cloudflare.com/speed/optimization/images/image-resizing/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Cloudflare Mirage (deprecated) · Cloudflare Speed docs\ndescription: Cloudflare Mirage reduces bandwidth used by images in mobile\n  browsers. It can accelerate loading of image-heavy websites on very slow\n  mobile connections and HTTP/1.\nlastUpdated: 2025-10-10T13:43:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/images/mirage/\n  md: https://developers.cloudflare.com/speed/optimization/images/mirage/index.md\n---\n\nDeprecation notice\n\nMirage was deprecated on September 15, 2025. As an alternative, Cloudflare recommends using [lazy loading](https://developers.cloudflare.com/images/tutorials/optimize-mobile-viewing/) and [responsive images](https://developers.cloudflare.com/images/transform-images/make-responsive-images/) to optimize image performance for all devices.\n\nCloudflare Mirage reduces bandwidth used by images in mobile browsers. It can accelerate loading of image-heavy websites on very slow mobile connections and HTTP/1.\n\nIt does this by:\n\n* Replacing images with low-resolution thumbnails, which are bundled together into one file.\n* Acting as a lazy loader, deferring loading of higher-resolution images until they become visible.\n\nJavaScript must be enabled for Mirage to work.\n\n***\n\n## Comparison\n\n* [Polish](https://developers.cloudflare.com/images/polish/) seamlessly optimizes images for all browsers, not only mobile, and keeps images at full resolution.\n* [Image Resizing](https://developers.cloudflare.com/images/transform-images/) together with `loading=\"lazy\"` and `srcset` HTML attributes can achieve similar results as Mirage, but requires markup changes to implement.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | Yes | Yes | Yes |\n\n***\n\n## Image formats compatible with Mirage\n\nMirage will work with the following image formats:\n\n* `.jpg`\n* `.jpeg`\n* `.png`\n* `.gif`\n* `.img`\n\n***\n\n## Enable Mirage\n\nNote\n\nIf you send a Content Security Policy (CSP) header that restricts where scripts can be loaded, you will need to ensure `ajax.cloudflare.com` is enabled. For example, to allow scripts from your own domain and `ajax.cloudflare.com` enter the following: `script-src 'self' ajax.cloudflare.com;`\n\nTo enable Mirage image optimization for your entire domain:\n\n1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n2. Go to **Image Optimization**.\n\n3. For **Mirage**, switch the toggle to **On**.\n\nNote\n\nTo use this feature on specific hostnames - instead of across your entire zone - use a [configuration rule](https://developers.cloudflare.com/rules/configuration-rules/).\n\n***\n\n## Test Mirage\n\nMirage's features for Mobile Browser optimization are triggered based on high latency and poor network connections. You can test Mirage by making a request to your domain using a mobile [user-agent string](http://en.wikipedia.org/wiki/User_agent) and one of the following flags with your domain in your mobile browser:\n\n`EXAMPLE.COM/?forcepreload`\n\nTo run the pre-loader only and serve degraded images on the page enter:\n\n`EXAMPLE.COM/?forcepreloadonly`\n\nHere is an example where Mirage 2 is triggered by a `?forcepreloadonly` flag. The notable image degradation is a sign that Mirage is working:\n\n![Blog post regarding the launch of Mirage.\n](https://developers.cloudflare.com/_astro/hc-import-219178057_forcepreloadonly.Cs6EzIwK_Z1RXDSB.webp)\n\n</page>\n\n<page>\n---\ntitle: Polish · Cloudflare Speed docs\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/images/polish/\n  md: https://developers.cloudflare.com/speed/optimization/images/polish/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting Image issues · Cloudflare Speed docs\nlastUpdated: 2024-09-13T14:14:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/images/troubleshooting/\n  md: https://developers.cloudflare.com/speed/optimization/images/troubleshooting/index.md\n---\n\n* [Image optimization on optimized images](https://developers.cloudflare.com/speed/optimization/images/troubleshooting/multiple-optimizations/)\n* [Polish statuses](https://developers.cloudflare.com/images/polish/cf-polished-statuses/)\n* [Troubleshoot missing images](https://developers.cloudflare.com/speed/optimization/images/troubleshooting/troubleshooting-missing-images/)\n\n</page>\n\n<page>\n---\ntitle: 0-RTT Connection Resumption · Cloudflare Speed docs\ndescription: Zero round trip time resumption (0-RTT) improves performance for\n  clients who have previously connected to your website, reducing latency for\n  returning users. This feature is especially beneficial for those who\n  frequently visit your application or connect over mobile networks.\nlastUpdated: 2025-10-10T13:43:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/0-rtt-connection-resumption/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/0-rtt-connection-resumption/index.md\n---\n\nZero round trip time resumption (0-RTT) improves performance for clients who have previously connected to your website, reducing latency for returning users. This feature is especially beneficial for those who frequently visit your application or connect over mobile networks.\n\nWe support 0-RTT for GET, HEAD, and OPTIONS requests, facilitating faster responses for these types of requests. Note that 0-RTT is not supported for POST requests.\n\nIn line with 0-RTT standards, we add the `Early-Data: 1` header to 0-RTT requests, which allows origin servers to identify when a request has used 0-RTT resumption. Customers should be able to see the `Early-Data: 1` header for any 0-RTT requests connecting to their origin.\n\nFor more information on 0-RTT, including its functionality and potential limitations, refer to our [blog post](https://blog.cloudflare.com/even-faster-connection-establishment-with-quic-0-rtt-resumption/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Enable 0-RTT Connection Resumption\n\nBy default, 0-RTT Connection Resumption is not enabled on your Cloudflare application.\n\n* Dashboard\n\n  To enable 0-RTT Connection Resumption in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n     [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n  2. Go to the **Protocol Optimization** tab and under **0-RTT Connection Resumption**, switch the toggle to **On**.\n\n* API\n\n  To adjust your 0-RTT Connection Resumption settings with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `0rtt` as the setting name in the URI path, and the `value` parameter set to `\"on\"` or `\"off\"`.\n\nNote\n\nThe 0-RTT Connection Resumption is only established between the client and Cloudflare. It does not extend to the origin server.\n\n</page>\n\n<page>\n---\ntitle: Enhanced HTTP/2 Prioritization · Cloudflare Speed docs\ndescription: With Enhanced HTTP/2 Prioritization, Cloudflare delivers resources\n  in the optimal order for the fastest experience across all browsers. It also\n  supports control of content delivery when used in conjunction with Workers.\nlastUpdated: 2025-11-26T12:22:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/enhanced-http2-prioritization/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/enhanced-http2-prioritization/index.md\n---\n\nWith Enhanced HTTP/2 Prioritization, Cloudflare delivers resources in the optimal order for the fastest experience across all browsers. It also supports control of content delivery when used in conjunction with [Workers](https://developers.cloudflare.com/workers/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | Yes | Yes | Yes |\n\n## How it works\n\nThe speed of loading web content, from the user’s perspective, is dependent on the order in which the resources load. With HTTP/2, by default, Cloudflare will follow the order requested by the browser. This ordering varies from browser to browser, causing a significant difference in performance.\n\nWith Enhanced HTTP/2 Prioritization, Cloudflare overrides the default browser behavior to optimize the order of resource delivery, independent of the browser. The greatest improvements will be experienced by visitors using Safari and Edge browsers.\n\nFor more details, refer to [the introductory blog post](https://blog.cloudflare.com/better-http-2-prioritization-for-a-faster-web/).\n\n## Enable Enhanced HTTP/2 Prioritization\n\n* Dashboard\n\n  To enable **Enhanced HTTP/2 Prioritization** in the Cloudflare dashboard:\n\n  1. Log into the [Cloudflare dashboard](https://dash.cloudflare.com).\n  2. Select your account and zone.\n  3. Go to **Speed** > **Settings**.\n  4. Go to **Protocol Optimization**.\n  5. For **Enhanced HTTP/2 Prioritization**, switch the toggle to **On**.\n\n* API\n\n  To enable **Enhanced HTTP/2 Prioritization** using the Cloudflare API, send a [`PATCH` request](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) with `h2_prioritization` as the setting name in the URI path, and the `value` parameter set to `\"on\"`.\n\n</page>\n\n<page>\n---\ntitle: HTTP/2 · Cloudflare Speed docs\ndescription: HTTP/2 uses the TCP transport protocol and TLS to secure\n  communications and improves page load times.\nlastUpdated: 2025-11-26T12:22:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/http2/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/http2/index.md\n---\n\nHTTP/2 uses the TCP transport protocol and TLS to secure communications and improves page load times.\n\nNote\n\nFor more background on HTTP/2, visit the [Learning Center](https://www.cloudflare.com/learning/performance/http2-vs-http1.1/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n| Can customize | No | Yes | Yes | Yes |\n\n## Enable HTTP/2\n\nHTTP/2 is enabled by default for all plans (though it does require an [SSL certificate at Cloudflare’s edge network](https://developers.cloudflare.com/ssl/get-started/)).\n\n## Disable HTTP/2\n\nDomains on Free plans cannot disable Cloudflare's HTTP/2 setting.\n\n* Dashboard\n\n  To disable **HTTP/2** in the dashboard:\n\n  1. Log into the [Cloudflare dashboard](https://dash.cloudflare.com).\n  2. Select your account and zone.\n  3. Go to **Speed** > **Settings**.\n  4. Go to **Protocol Optimization**.\n  5. For **HTTP/2**, switch the toggle to **Off**.\n\n* API\n\n  To disable **HTTP/2** with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `http2` as the setting name in the URI path, and the `value` parameter set to `\"off\"`.\n\n## ERR\\_HTTP2\\_PROTOCOL\\_ERROR\n\nRequests proxied by Cloudflare may result in an error for visitors with the error code `ERR_HTTP2_PROTOCOL_ERROR` visible in the Developer Tools Console. These errors are usually due to an issue on the origin web server configuration, but might only materialize when requests are proxied by Cloudflare depending on the client browser's behavior. Some possible causes are:\n\n### Malformed HTTP response headers\n\nThe origin web server may be sending improperly formatted HTTP response headers.\n\n#### Resolution\n\nMake a request directly to your origin web server and inspect its HTTP response headers for anomalies. Make sure that the field values respect the following requirements:\n\n* [RFC 9110](https://www.rfc-editor.org/rfc/rfc9110.html#section-5.5)\n* [RFC 9113](https://www.rfc-editor.org/rfc/rfc9113.html#section-8.2.1)\n* [RFC 5234](https://www.rfc-editor.org/rfc/rfc5234#appendix-B.1)\n\n### Compression issues\n\nExamples of compression issues include the origin web server serving gzip encoded compressed content but failing to update the `Content-Length` header, or the origin web server serving broken gzip compressed content.\n\n#### Resolution\n\nYou can try to disable compression at your origin web server and rely on Cloudflare to [compress content](https://developers.cloudflare.com/speed/optimization/content/compression/).\n\nYou can also review your origin server's compression settings to make sure the compression is working as expected.\n\n</page>\n\n<page>\n---\ntitle: HTTP/2 to Origin · Cloudflare Speed docs\ndescription: A protocol is a set of rules governing the exchange or transmission\n  of data between devices. One of the most important protocols that run on the\n  human-computer interaction layer, where applications can access the network\n  services, is HTTP (Hypertext Transfer Protocol).\nlastUpdated: 2025-12-10T10:57:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/http2-to-origin/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/http2-to-origin/index.md\n---\n\nA protocol is a set of rules governing the exchange or transmission of data between devices. One of the most important protocols that run on the human-computer interaction layer, where applications can access the network services, is HTTP (Hypertext Transfer Protocol).\n\nHTTP is a well established protocol that has several versions, and each version adds features that improve performance over the older one. HTTP/1.1 and HTTP/2 are widely deployed on the Internet today. HTTP/1.1 has been around for more than a decade, but in 2015 the IETF (Internet Engineering Task Force) introduced HTTP/2, which introduces several features to reduce page load times. To know more about the differences between HTTP/1.1 and HTTP/2, please refer to [HTTP/2 versus HTTP/1.1](https://www.cloudflare.com/learning/performance/http2-vs-http1.1/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Disable HTTP/2 to Origin\n\nAt Cloudflare, HTTP/2 connection to the origin is enabled by default.\n\nIf you wish to disable HTTP/2 to Origin, you can follow these steps:\n\n1. In the Cloudflare dashboard, go to the **Speed** > **Settings** page.\n\n   [Go to **Settings**](https://dash.cloudflare.com/?to=/:account/:zone/speed/optimization)\n\n2. Go to the **Protocol Optimization** tab and under **HTTP/2 to Origin** set the toggle to **Off**.\n\n## Connection multiplexing\n\nCloudflare supports HTTP/2 multiplexing from its global edge network to your origin servers. Instead of opening a new TCP connection for every incoming request, multiple HTTP/2 streams share a single long-lived TCP connection. This significantly reduces the cost of connection setup and teardown, improving efficiency and performance between Cloudflare and your origin.\n\nBy pooling many requests into fewer TCP connections, Cloudflare lowers the number of active connections your origin must maintain — particularly valuable for backends sensitive to connection overhead or resource limits.\n\n### How it works\n\nWhen a new request arrives, Cloudflare attempts to reuse an existing HTTP/2 connection to the origin:\n\n* If the connection has not reached its concurrent stream limit, Cloudflare multiplexes the request over that same connection.\n* If the stream limit has been reached, Cloudflare opens a new TCP connection as needed.\n\nConnections are kept alive and reused until they become idle or hit their concurrency limit.\n\n#### Connection lifecycle\n\n* **Connection reuse**: Cloudflare maintains persistent (keep-alive) TCP connections to your origin. Reuse continues until the HTTP/2 stream limit is reached or the connection goes idle.\n\n* **Idle timeout (900s)**: If a connection remains idle (no active streams) for 900 seconds, Cloudflare closes it. Attempting to reuse a closed connection may result in a `520` error.\n\n* **Keep-alives**: Cloudflare sends periodic TCP keep-alives to detect unresponsive origins. After two unanswered probes, the connection is reset.\n\n  * First probe after \\~30 seconds of inactivity\n  * Second probe after 15 seconds\n\n* **Connection tear-down**: Connections may also close due to:\n\n  * Load balancing decisions\n  * Data center or node maintenance\n  * Reaching the maximum concurrency limit\n  * Origin or intermediary network closing idle connections\n\n### Benefits\n\n| Advantage | Description |\n| - | - |\n| Fewer TCP handshakes | Multiple requests share a single long-lived TCP connection, minimizing connection churn. |\n| Lower latency | Eliminates repeated TCP/TLS handshakes, reducing round-trip delays for new requests. |\n| Reduced origin load | Fewer concurrent connections for the origin to manage, easing load on resource-constrained systems. |\n| Adaptive scaling | During surges (for example, failovers), Cloudflare reuses available streams first, then opens new connections as needed. |\n\n### Default behavior by plan\n\n| Plan | Default State | Max concurrent streams per connection | Configurable? |\n| - | - | - | - |\n| Free / Pro / Business | Enabled by default | 200 | No |\n| Enterprise | Disabled by default (1 stream per connection) | 1–200+ | Yes |\n\n* **Free/Pro/Business**: Multiplexing is automatically enabled. Each connection supports up to 200 concurrent streams.\n* **Enterprise**: Multiplexing starts effectively disabled (1 stream). You can enable and configure concurrency per zone (up to 200+ concurrent streams).\n\n### Configuration\n\nConnection multiplexing is enabled by default on Free, Pro and Business zones and uses up to 100 concurrent streams by default. Enterprise plans can explicitly configure the maximum number of concurrent streams (often called the “multiplexing ratio”) for a zone in the dashboard or via API.\n\nDashboard\n\n1. Log in to the [Cloudflare dashboard](https://dash.cloudflare.com/login) and select your account.\n2. Choose the domain that will use HTTP/2 to Origin.\n3. Select **Speed > Optimization**.\n4. Open the **Protocol Optimization** tab.\n5. Under **HTTP/2 to Origin**, select **Configure** and adjust the stream settings as needed.\n\nAPI\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Zone Settings Write`\n* `Zone Write`",
      "language": "unknown"
    },
    {
      "code": "Refer to the [API documentation](https://developers.cloudflare.com/api/python/resources/zones/subresources/settings/methods/edit/) for more information.\n\nTerraform",
      "language": "unknown"
    },
    {
      "code": "Note\n\nIf your origin does not support multiplexing, enabling HTTP/2 to origin may result in 5xx errors, particularly 520s.\n\nDuring the HTTP/2 handshake, our edge reads the SETTINGS\\_MAX\\_CONCURRENT\\_STREAMS that your origin advertises, and it will respect that lower limit if your origin is configured with a stricter concurrency cap than Cloudflare's setting. This allows you to control concurrency on a per-origin basis, while still benefiting from Cloudflare's multiplexing framework.\n\n### Timeouts and error codes\n\n| Condition | Default / Range | Error code | Description |\n| - | - | - | - |\n| Proxy Read Timeout | 100s (up to 6000s for Enterprise) | `524` | Origin took too long to respond. |\n| Proxy Idle Timeout | 900s (fixed) | `520` | Connection closed due to idleness. |\n| TCP Keep-Alive Interval | 30s initial, 15s between probes | `520` | After two missed probes, Cloudflare resets the connection. |\n| TCP Handshake Timeout | 19s | `522` | Origin did not complete the SYN handshake. |\n| TCP ACK Timeout | 90s | `522` | Origin stopped acknowledging data. |\n\n### Common scenarios\n\n**Failover events**\n\nWhen traffic shifts suddenly (for example, during origin failover), Cloudflare reuses active connections where possible. If concurrency limits are reached, it opens new ones. Active connection counts may spike temporarily, but overall total connections remain lower than without multiplexing.\n\n**Long-Lived or idle requests**\n\n* If your requests exceed 100 seconds (for example, streaming), increase the Proxy Read Timeout (Enterprise only).\n* Origins that close connections faster than 900 seconds may experience connection churn, but Cloudflare automatically reestablishes new connections as needed.\n\n**Potential 5xx errors**\n\nSome 5xx errors, like `520` or `522`, may be related to idle timeouts or unreachable origins. If concurrency is set too high for an underpowered origin, bursts of simultaneous requests can overwhelm it and lead to stream resets or short spikes of 5xx errors. Enterprise customers who encounter this can ask their Cloudflare account team or support to lower the concurrency limit, which reduces how many requests are sent to the origin at the same time and helps prevent overload.\n\n### FAQ\n\n#### Does Cloudflare use a fixed multiplexing ratio?\n\nFree, Pro, and Business plans use 200 concurrent streams per connection. Enterprise users can configure between 1–200+ streams.\n\n#### How does Cloudflare scale connections during spikes or failovers?\n\nCloudflare first reuses existing keep-alive connections. If they reach concurrency limits, new connections are opened as needed. Even during surges, total connection count is typically lower than without multiplexing.\n\n#### What if my backend is sensitive to parallel requests?\n\nEnterprise users can lower the concurrency limit. Cloudflare also honors your origin's `SETTINGS_MAX_CONCURRENT_STREAMS`, allowing your server to enforce stricter limits. Cloudflare's CDN also provides Cache Locking, which helps avoid multiple parallel requests to your origin during revalidation. Refer to [Revalidation](https://developers.cloudflare.com/cache/concepts/revalidation/) for more information.\n\n#### Can I gradually roll out higher concurrency?\n\nYes. You can adjust your origin's HTTP/2 settings or Cloudflare's zone setting incrementally to increase concurrency safely.\n\n#### From where does Cloudflare connect to my origin?\n\nCloudflare operates a flat anycast network. Any data center may connect directly to your origin — there is no L1/L2 hierarchy. Origin connections may come from multiple data centers worldwide.\n\n#### Does Cloudflare prewarm connections to origins?\n\nNo. Connections are created on demand and reused where possible. There is no persistent idle pool.\n\n#### How are idle connections managed?\n\nIdle connections are closed after 900 seconds of inactivity. They are not reopened proactively; new connections are created as traffic resumes.\n\n#### Can Cloudflare close active TCP connections?\n\nOnly if the origin closes them, a network error occurs, or Cloudflare performs maintenance or load redistribution. There is no hard maximum lifetime for active connections.\n\n## Protocol compatibility\n\nNote that if the origin does not support HTTP/2, Cloudflare will initiate an HTTP/1.1 connection. We connect to servers who announce support of HTTP/2 connections via [ALPN](https://blog.cloudflare.com/introducing-http2).\n\nIf you are unsure if your server supports HTTP/2, we suggest checking your origin server's documentation or using a testing tool for HTTP/2 implementation (for example, [h2spec](https://github.com/summerwind/h2spec)).\n\n</page>\n\n<page>\n---\ntitle: HTTP/3 (with QUIC) · Cloudflare Speed docs\ndescription: HTTP/3 uses QUIC, which is a secure-by-default transport protocol.\n  HTTP/3 improves page load times in a similar way to HTTP/2. However, the QUIC\n  transport protocol solves TCP's head-of-line blocking problem, meaning that\n  performance over lossy networks can be better.\nlastUpdated: 2025-11-26T12:22:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/http3/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/http3/index.md\n---\n\nHTTP/3 uses QUIC, which is a secure-by-default transport protocol. HTTP/3 improves page load times in a similar way to HTTP/2. However, the QUIC transport protocol solves TCP's head-of-line blocking problem, meaning that performance over lossy networks can be better.\n\nNote\n\nFor more background on HTTP/3, visit the [Learning Center](https://www.cloudflare.com/learning/performance/what-is-http3/).\n\nNote\n\nThis setting is for connection between the user and Cloudflare. HTTP/3 connection to the origin is not yet supported.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Enable HTTP/3\n\nHTTP/3 is available to all plans (though it does require an [SSL certificate at Cloudflare’s edge network](https://developers.cloudflare.com/ssl/get-started/)).\n\n* Dashboard\n\n  To enable **HTTP/3** in the dashboard:\n\n  1. Log into the [Cloudflare dashboard](https://dash.cloudflare.com).\n  2. Select your account and zone.\n  3. Go to **Speed** > **Settings**.\n  4. Go to **Protocol Optimization**.\n  5. For **HTTP/3**, switch the toggle to **On**.\n\n* API\n\n  To enable **HTTP/3** with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `http3` as the setting name in the URI path, and the `value` parameter set to `\"on\"`.\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting Protocol optimization issues · Cloudflare Speed docs\nlastUpdated: 2024-09-13T14:14:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/speed/optimization/protocol/troubleshooting/\n  md: https://developers.cloudflare.com/speed/optimization/protocol/troubleshooting/index.md\n---\n\n* [Enhanced HTTP/2 Prioritization negatively affects iOS/Safari devices](https://developers.cloudflare.com/speed/optimization/protocol/troubleshooting/enhanced-http2-prioritization-ios-safari/)\n* [Troubleshoot protocol issues](https://developers.cloudflare.com/speed/optimization/protocol/troubleshooting/protocol-troubleshooting/)\n\n</page>\n\n<page>\n---\ntitle: API commands · Cloudflare SSL/TLS docs\ndescription: Use the following API commands to manage advanced certificates. If\n  you are using our API for the first time, review our API documentation.\nlastUpdated: 2025-04-22T13:13:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/api-commands/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/api-commands/index.md\n---\n\nUse the following API commands to manage advanced certificates. If you are using our API for the first time, review our [API documentation](https://developers.cloudflare.com/fundamentals/api/).\n\n| Command | Method | Endpoint | Additional notes |\n| - | - | - | - |\n| [Order advanced certificate](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/create/) | `POST` | `zones/<<ZONE_ID>>/ssl/certificate_packs/order` | |\n| [Restart certificate validation](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/edit/) | `PATCH` | `zones/<<ZONE_ID>>/ssl/certificate_packs/<<ID>>` | For a Certificate Pack in a `validation_timed_out` status. |\n| [Delete certificate pack](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/delete/) | `DELETE` | `zones/<<ZONE_ID>>/ssl/certificate_packs/<<ID>>` | |\n| [List certificate packs in a zone](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/list/) | `GET` | `zones/<<ZONE_ID>>/ssl/certificate_packs?status=all` | This API call returns all certificate packs for a domain (Universal, Custom, and Advanced). |\n| List Cipher Suite settings: [Get zone setting](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/get/) with `ciphers` as the setting name in the URI path | `GET` | `zones/<<ZONE_ID>>/settings/ciphers` | |\n| Change Cipher Suite settings: [Edit zone setting](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) with `ciphers` as the setting name in the URI path | `PATCH` | `zones/<<ZONE_ID>>/settings/ciphers` | To restore default settings, send a blank array in the `value` parameter. |\n\n</page>\n\n<page>\n---\ntitle: Manage advanced certificates · Cloudflare SSL/TLS docs\ndescription: Learn how to create, delete and perform other operations to manage\n  your Cloudflare Advanced SSL certificates.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/index.md\n---\n\n## Create a certificate\n\nIf you are using an existing [Universal SSL certificate](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/), Cloudflare will automatically replace this certificate once you finish ordering your advanced certificate.\n\nOnce you order a certificate, you can review the [certificate's status](https://developers.cloudflare.com/ssl/reference/certificate-statuses/) on the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page or via the API with a [GET request](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/list/).\n\n* Dashboard\n\n  To create a new advanced certificate in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. Select **Order Advanced Certificate**.\n\n  3. If Cloudflare does not have your billing information, you will need to enter that information.\n\n  4. Enter the following information:\n\n     * Certificate authority\n     * Certificate hostnames\n       * For hostnames longer than 64 characters, use the API.\n     * Validation method\n     * Certificate validity period\n\n  5. Select **Save**.\n\n* API\n\n  To create a new certificate using the API, send a [POST request](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/create/) to the Cloudflare API.\n\n  If you need certificates for hostnames longer than 64 characters ([RFC 5280](https://www.rfc-editor.org/rfc/rfc5280.html)), set the `cloudflare_branding` option to `true`. This will add `sni.cloudflaressl.com` in the Common Name (CN) field and will include the long hostname as a part of the Subject Alternative Name (SAN).\n\nWarning\n\nThe available options for **Validation method** and **Certificate Validity Period** may vary depending on the certificate authority you choose and the hostnames that you include in your Advanced certificate order.\n\n***\n\n## Delete a certificate\n\n* Dashboard\n\n  To delete an advanced certificate in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. Select a certificate.\n\n  3. Select **Delete Certificate**.\n\n* API\n\n  To delete a certificate using the API, send a [DELETE request](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/delete/) to the Cloudflare API.\n\n***\n\n## Restart validation\n\nTo restart validation for a certificate in a `validation_timed_out` status, send a [PATCH request](https://developers.cloudflare.com/api/resources/ssl/subresources/certificate_packs/methods/edit/) to the API.\n\n***\n\n## Restrict cipher suites\n\nCipher suites are a combination of ciphers used to negotiate security settings during the [SSL/TLS handshake](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/) (and therefore separate from the [SSL/TLS protocol](https://developers.cloudflare.com/ssl/reference/protocols/)).\n\nFor more details, refer to [Customize cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/).\n\n***\n\n## Perform domain control validation (DCV)\n\nBefore a certificate authority (CA) will issue a certificate for a domain, the requester must prove they have control over that domain. This process is known as domain control validation (DCV).\n\n\n\nNormally, you only need to update DCV if you have your application on a partial setup (Cloudflare does not run your authoritative nameservers).\n\nFor more information about DCV, refer to [DCV methods](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/).\n\n***\n\n## Set up alerts\n\nYou can configure alerts to receive notifications for changes in your certificates.\n\nAdvanced Certificate Alert\n\n**Who is it for?**\n\nCustomers with [advanced certificates](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) that want to be alerted on validation, issuance, renewal, and expiration of certificates.\n\n**Other options / filters**\n\nNone.\n\n**Included with**\n\nWhen an advanced certificate is validated, issued, renewed, or expired.\n\n**What should you do if you receive one?**\n\nAction only needed if notification is about a certificate that failed to be issued. Refer to [SSL expired or SSL mismatch errors](https://developers.cloudflare.com/ssl/troubleshooting/version-cipher-mismatch/) for more information.\n\nRefer to [Cloudflare Notifications](https://developers.cloudflare.com/notifications/get-started/) for more information on how to set up an alert.\n\n***\n\n## Advanced certificate renewal\n\nThe certificate validity period you choose determines when the auto renewal will start for your certificate. For details, refer to [Validity period and renewal](https://developers.cloudflare.com/ssl/reference/certificate-validity-periods/).\n\n</page>\n\n<page>\n---\ntitle: Always Use HTTPS · Cloudflare SSL/TLS docs\ndescription: Always Use HTTPS redirects all your visitor requests from http to\n  https, for all subdomains and hosts in your application.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/always-use-https/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/always-use-https/index.md\n---\n\nAlways Use HTTPS redirects all your visitor requests from `http` to `https`, for all subdomains and hosts in your application.\n\nNote\n\nThis process does not impact certificate validation. If you use [HTTP DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/), you can still enable Always Use HTTPS.\n\nCloudflare recommends not performing redirects at your origin web server, as this can cause [redirect loop errors](https://developers.cloudflare.com/ssl/troubleshooting/too-many-redirects/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Encrypt all visitor traffic\n\nTo redirect traffic for all subdomains and hosts in your application, you can enable **Always Use HTTPS**.\n\nNote\n\nIf only some parts of your application can support HTTPS traffic, do not enable **Always Use HTTPS** and use a [single redirect](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/) to selectively perform the redirect to HTTPS. Refer to [Redirect admin area requests to HTTPS](https://developers.cloudflare.com/rules/url-forwarding/examples/redirect-admin-https/) for an example.\n\n* Dashboard\n\n  To enable **Always Use HTTPS** in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **SSL/TLS Overview** page.\n\n     [Go to **Overview**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls)\n\n  2. Make sure that your [SSL/TLS encryption mode](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/off/) is not set to **Off**. When you set your encryption mode to **Off**, the **Always Use HTTPS** option will not be visible in your Cloudflare dashboard.\n\n  3. Go to the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page.\n\n  4. Turn on **Always Use HTTPS**.\n\n* API\n\n  To enable or disable **Always Use HTTPS** with the API:\n\n  1. Make sure that your [SSL/TLS encryption mode](https://developers.cloudflare.com/ssl/origin-configuration/ssl-modes/off/) **is not** set to **Off**.\n  2. Send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `always_use_https` as the setting name in the URI path, and the `value` parameter set to your desired setting (`\"on\"` or `\"off\"`).\n\n## Limitations\n\nForcing HTTPS does not resolve issues with [mixed content](https://developers.cloudflare.com/ssl/troubleshooting/mixed-content-errors/), as browsers check the protocol of included resources before making a request. You will need to use only relative links or HTTPS links on pages that you force to HTTPS. Cloudflare can automatically resolve some mixed-content links using our [Automatic HTTPS Rewrites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/automatic-https-rewrites/) functionality.\n\n</page>\n\n<page>\n---\ntitle: Automatic HTTPS Rewrites · Cloudflare SSL/TLS docs\ndescription: Automatic HTTPS Rewrites prevents end users from seeing \"mixed\n  content\" errors by rewriting URLs from http to https for resources or links on\n  your web site that can be served with HTTPS.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/automatic-https-rewrites/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/automatic-https-rewrites/index.md\n---\n\nAutomatic HTTPS Rewrites prevents end users from seeing \"mixed content\" errors by rewriting URLs from `http` to `https` for resources or links on your web site that can be served with HTTPS.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Additional details\n\nIf your site contains links or references to HTTP URLs that are also available securely via HTTPS, Automatic HTTPS Rewrites can help. If you connect to your site over HTTPS and the lock icon is not present, or has a yellow warning triangle on it, your site may contain references to HTTP assets (“mixed content”).\n\nMixed content is often due to factors not under the website owner’s control such as embedded third-party content or complex content management systems. By rewriting URLs from “http” to “https”, Automatic HTTPS Rewrites simplifies the task of making your entire website available over HTTPS, helping to eliminate mixed content errors and ensuring that all data loaded by your website is protected from eavesdropping and tampering.\n\nNote\n\nFor security reasons, this feature will run on URLs pointing to `localhost` if the URL is fetching an active resource (script, iframe, link, object, etc.).\n\n## Enable Automatic HTTPS Rewrites\n\n* Dashboard\n\n  To enable **Automatic HTTPS Rewrites** in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. For **Automatic HTTPS Rewrites**, switch the toggle to **On**.\n\n* API\n\n  To enable or disable **Automatic HTTPS Rewrites** with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `automatic_https_rewrites` as the setting name in the URI path, and the `value` parameter set to your desired setting (`\"on\"` or `\"off\"`).\n\nNote\n\nTo use this feature on specific hostnames - instead of across your entire zone - use a [configuration rule](https://developers.cloudflare.com/rules/configuration-rules/).\n\n## Limitations\n\nBefore a rewrite is applied, Cloudflare checks the HTTP resources to ensure they are accessible via HTTPS. If they are not available over HTTPS, Cloudflare cannot rewrite the URL.\n\nSome resources are loaded by JavaScript or CSS via HTTP when the site is loaded in a browser. You will see mixed content warnings in those situations. To determine which URLs do not have HTTPS support, Cloudflare uses data from [EFF’s HTTPS Everywhere](https://www.eff.org/https-everywhere/faq#how-do-i-add-my-own-site-to-https-everywhere) and [Chrome’s HSTS preload list](https://hstspreload.org). If your zone is not on one of these lists, only active content will be rewritten. Passive content (such as images) will not be rewritten and will still cause mixed content errors.\n\nIf a third-party domain supports HTTPS and is not rewritten automatically, you can manually change those links to relative links or HTTPS links. Alternatively, you can ask the third-party domain owner to submit their site for inclusion in the HTTPS Everywhere rulesets, which [accept pull requests on GitHub](https://github.com/EFForg/https-everywhere/). For more information on how to fix mixed content errors, refer to [Troubleshooting mixed content errors](https://developers.cloudflare.com/ssl/troubleshooting/mixed-content-errors/).\n\n</page>\n\n<page>\n---\ntitle: Certificate Signing Requests (CSRs) · Cloudflare SSL/TLS docs\ndescription: Generate a Certificate Signing Request (CSR) to get a custom\n  certificate from the Certificate Authority (CA) of your choice while\n  maintaining control of the private key on Cloudflare. The private key\n  associated with the CSR will be generated by Cloudflare and will never leave\n  our network.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/certificate-signing-requests/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/certificate-signing-requests/index.md\n---\n\nGenerate a Certificate Signing Request (CSR) to get a custom certificate from the Certificate Authority (CA) of your choice while maintaining control of the private key on Cloudflare. The private key associated with the CSR will be generated by Cloudflare and will never leave our network.\n\nA CSR contains information about your domain: your organization name and address, the common name (domain name), and Subject Alternative Names (SANs).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | No | No | No | Included with [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) |\n\n## Types of CSRs\n\nYou can create two types of CSRs:\n\n* **Zone-level**: Meant only for sign certificates associated with the current zone.\n* **Account-level**: Meant for organizations that issue certificates across multiple domains.\n\n## Create and use a CSR\n\nTo create a CSR:\n\n1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n   [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n2. On **Certificate Signing Request (CSR)**, select **Generate**.\n\n3. Choose a **Scope** (only [certain customers](#types-of-csrs) can choose **Account**).\n\n4. Enter relevant information on the form and select **Create**.\n\nTo use a CSR:\n\n1. On the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page, select the CSR record you just created under **Certificate Signing Request (CSR)**.\n\n2. Copy (or select **Click to copy**) the value for **Certificate Signing Request**.\n\n3. Obtain a certificate from the Certificate Authority (CA) of your choice using your CSR.\n\n4. When you [upload the custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/) to Cloudflare, select an **Encoding mode** of **Certificate Signing Request (CSR)** and enter the associated value.\n\n   Note\n\n   You will not see the option to adjust your **Encoding Mode** until after you have created a CSR associated with the specific zone or your account.\n\n## Renew a certificate\n\nWhen you [renew a custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/renewing/), you need to reuse a previously generated CSR.\n\nNote that it is not possible to use a different CSR with the same certificate. In this case, you must upload the certificate as a new certificate, selecting the new CSR.\n\n</page>\n\n<page>\n---\ntitle: Certificate Transparency Monitoring · Cloudflare SSL/TLS docs\ndescription: Certificate Transparency (CT) Monitoring is an opt-in feature in\n  public beta that aims at improving security by allowing you to double-check\n  any SSL/TLS certificates issued for your domain.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/certificate-transparency-monitoring/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/certificate-transparency-monitoring/index.md\n---\n\nCertificate Transparency (CT) Monitoring is an [opt-in](#opt-in-and-out) feature in public beta that aims at improving security by allowing you to double-check any SSL/TLS certificates issued for your domain.\n\nCT Monitoring alerts are triggered not only by Cloudflare processes - including [backup certificates](https://developers.cloudflare.com/ssl/edge-certificates/backup-certificates/) -, but whenever a certificate that covers your monitored domain is issued by a [Certificate Authority (CA)](https://developers.cloudflare.com/ssl/concepts/#certificate-authority-ca) and added to a public CT log. You can learn more about how this works in the [introductory blog post](https://blog.cloudflare.com/introducing-certificate-transparency-and-nimbus/).\n\nAspects to consider\n\n* If you use Cloudflare or other services that automatically issue certificates for your domain or subdomains, this may trigger CT Monitoring emails as well.\n* If your domain is included in a shared certificate, you may receive notifications for domains or subdomains that do not belong to you but are included as subject alternative names (SANs) together with your domain. You can use a tool like [Certificate Search](https://crt.sh/) to gather more information in such cases.\n* CT Monitoring does not detect phishing attempts. For example, for `cloudflare.com`, an alert would not trigger if a certificate was issued for `cloudf1are.com` or `cloud-flare.com`.\n\n***\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n| Email Recipients | All account members | All account members | Specified email addresses | Specified email addresses |\n\n***\n\n## Opt in and out\n\nAlerts are turned off by default. If you want to receive alerts, go to the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates#ct-alerting-card) page and enable **Certificate Transparency Monitoring**. If you are in a Business or Enterprise zone, select **Add Email**.\n\nTo stop receiving alerts, disable **Certificate Transparency Monitoring** or remove your email from the feature card.\n\n***\n\n## Emails to be concerned about\n\nMost certificate alerts are routine. Cloudflare sends alerts whenever a certificate for your domain appears in a log. Certificates expire (and must be reissued), so it is completely normal to receive issuance emails. If your domain is listed in the email, along with reasonable ownership and certificate information, then **no action is required**.\n\nAdditionally, you should check whether the certificate was issued through Cloudflare. Cloudflare partners with [multiple CAs](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) to provide certificates. To view all Cloudflare-issued certificates and backup certificates - which require no additional actions - visit the [Edge Certificates page](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) in the dashboard.\n\nYou *should* take action when something is clearly wrong, such as if you:\n\n* Do not recognize the certificate issuer.\n\n  Note\n\n  Cloudflare provisions backup certificates, so you may see a certificate listed that is not in active use for your site. The [Edge Certificates page](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) will show all certificates requested for your site.\n\n* Have recently noticed problems with your website.\n\n***\n\n## How to take action\n\n### Option 1: Contact certificate authorities\n\nOnly Certificate Authorities can revoke malicious certificates. If you believe an illegitimate certificate was issued for your domain, contact the Certificate Authority listed as the **Issuer** in the email.\n\n* [GlobalSign support](https://support.globalsign.com/)\n\n* [GoDaddy support](https://www.godaddy.com/contact-us?sp_hp=B)\n\n* [Google Trust Services support](https://pki.goog/faq/)\n\n* [IdenTrust support](https://www.identrust.com/support/support-team)\n\n* [Let's Encrypt support](https://letsencrypt.org/contact/)\n\n* [Sectigo support](https://sectigo.com/support)\n\n* [SSL.com support](https://www.ssl.com/submit-a-ticket/)\n\n### Option 2: Contact domain registrars\n\nDomain registrars may be able to **suspend** potentially malicious domains. If, for example, you notice that a malicious domain was registered through GoDaddy, contact GoDaddy’s support team to see if they can help you. Do the same for other registrars.\n\n### Option 3: Improvise\n\nThere are other ways to combat malicious certificates. You can warn your visitors with an on-site notification or ask browser makers (Google for Chrome, etc.) to block these domains.\n\nIf someone is attempting to impersonate you online, you should absolutely take action. This is usually difficult to recognize, so exercise caution. **Remember: the vast majority of certificates are not malicious. Only take action if you believe something is wrong.**\n\n***\n\n## HTTP Public Key Pinning\n\nCertificate Transparency Monitoring addresses the same problems as HTTP Public Key Pinning (HPKP), but with [fewer technical issues](https://scotthelme.co.uk/im-giving-up-on-hpkp/).\n\nCloudflare does not offer or support HPKP and advises against using it with Universal SSL.\n\n</page>\n\n<page>\n---\ntitle: Cipher suites · Cloudflare SSL/TLS docs\ndescription: Consider information about supported cipher suites, how to meet\n  your security requirements, and how to troubleshoot compatibility and other\n  issues.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/index.md\n---\n\nCipher suites are a combination of ciphers used to negotiate security settings during the [SSL/TLS handshake](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/) (and therefore separate from the [SSL/TLS protocol](https://developers.cloudflare.com/ssl/reference/protocols/)).\n\n\n\nThis section covers cipher suites used in connections between clients — such as your visitor's browser — and the Cloudflare network. For information about cipher suites used between Cloudflare and your origin server, refer to [Origin server > Cipher suites](https://developers.cloudflare.com/ssl/origin-configuration/cipher-suites/).\n\nNote\n\nCloudflare maintains a [public repository of our SSL/TLS configurations](https://github.com/cloudflare/sslconfig) on GitHub, where you can find changes in the commit history.\n\n[RC4 cipher suites](https://blog.cloudflare.com/end-of-the-road-for-rc4/) or [SSLv3](https://blog.cloudflare.com/sslv3-support-disabled-by-default-due-to-vulnerability/) are no longer supported.\n\n## Cipher suites and edge certificates\n\nWhile the cipher suites used by default for all Cloudflare domains/zones are meant to balance security and compatibility, some of them might be considered weak by third-party testing tools, such as the Qualys SSL Labs test.\n\nIf the default option ([Legacy](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/recommendations/)) does not meet your business requirements, you can [purchase the Advanced Certificate Manager add-on](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/acm/) to be able to [specify more secure cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/).\n\nCustom cipher suites is a hostname-level setting. Once specified, the configuration is applicable to all edge certificates used to connect to the hostname(s), regardless of [certificate type](https://developers.cloudflare.com/ssl/edge-certificates/) (universal, advanced, or custom).\n\n## Related SSL/TLS settings\n\nAlthough configured independently, cipher suites interact with other SSL/TLS settings.\n\n### Minimum TLS Version\n\nYou can specify a [minimum TLS version](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/minimum-tls/) that is required for a client to connect to your website or application.\n\nFor example, if TLS 1.1 is selected as the minimum, visitors attempting to connect using TLS 1.0 will be rejected while visitors attempting to connect using TLS 1.1, 1.2, or 1.3 (if enabled) will be allowed.\n\nEach cipher suite relates to a specific minimum protocol that it supports. This means that if you use a [higher security level](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/recommendations/) for your cipher suites and stop supporting TLS 1.0, you should also adjust your minimum TLS version accordingly.\n\n[Compliance standards](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/compliance-status/) can also require you to up the minimum TLS version accepted in connections to your website or application.\n\n### TLS 1.3\n\nYou cannot set specific TLS 1.3 ciphers. Instead, you can enable [TLS 1.3](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/tls-13/#enable-tls-13) for your entire zone and Cloudflare will use [all applicable TLS 1.3 cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/supported-cipher-suites/). In combination with this, you can still [disable weak cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/) for TLS 1.0-1.2.\n\nCloudflare may return the following names for TLS 1.3 cipher suites. This is how they map to [RFC 8446](https://www.rfc-editor.org/rfc/rfc8446.html) names:\n\n| Cloudflare | RFC 8446 |\n| - | - |\n| `AEAD-AES128-GCM-SHA256` | `TLS_AES_128_GCM_SHA256` |\n| `AEAD-AES256-GCM-SHA384` | `TLS_AES_256_GCM_SHA384` |\n| `AEAD-CHACHA20-POLY1305-SHA256` | `TLS_CHACHA20_POLY1305_SHA256` |\n\n## Resources\n\n* [Customize cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/)\n* [Security levels](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/recommendations/)\n* [Compliance standards](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/compliance-status/)\n* [Supported cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/supported-cipher-suites/)\n* [Troubleshooting](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/troubleshooting/)\n\n## Limitations\n\nIt is not possible to configure cipher suites for [Cloudflare Pages](https://developers.cloudflare.com/pages/) hostnames.\n\n</page>\n\n<page>\n---\ntitle: HTTP Strict Transport Security (HSTS) · Cloudflare SSL/TLS docs\ndescription: HSTS protects HTTPS web servers from downgrade attacks. These\n  attacks redirect web browsers from an HTTPS web server to an\n  attacker-controlled server, allowing bad actors to compromise user data and\n  cookies.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/http-strict-transport-security/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/http-strict-transport-security/index.md\n---\n\nHSTS protects HTTPS web servers from downgrade attacks. These attacks redirect web browsers from an HTTPS web server to an attacker-controlled server, allowing bad actors to compromise user data and cookies.\n\nHSTS adds an HTTP header that directs [compliant web browsers](https://developers.cloudflare.com/ssl/reference/browser-compatibility/) to:\n\n* Transform HTTP links to HTTPS links\n* Prevent users from bypassing SSL browser warnings\n\nBefore enabling HSTS, review the [requirements](#requirements).\n\nNote\n\nFor more background information on HSTS, see the [introductory blog post](https://blog.cloudflare.com/enforce-web-policy-with-hypertext-strict-transport-security-hsts/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Requirements\n\nIn order for HSTS to work as expected, you need to:\n\n* Have enabled HTTPS before HSTS so browsers can accept your HSTS settings\n* Keep HTTPS enabled so visitors can access your site\n\nOnce you enabled HSTS, avoid the following actions to ensure visitors can still access your site:\n\n* Changing your DNS records from [Proxied to DNS only](https://developers.cloudflare.com/dns/proxy-status/)\n* [Pausing Cloudflare](https://developers.cloudflare.com/fundamentals/manage-domains/pause-cloudflare/) on your site\n* Pointing your nameservers away from Cloudflare\n* Redirecting HTTPS to HTTP\n* Disabling SSL (invalid or expired certificates or certificates with mismatched hostnames)\n\nWarning\n\nIf you remove HTTPS before disabling HSTS or before waiting for the duration of the original **Max Age Header** specified in your Cloudflare HSTS configuration, your website becomes inaccessible to visitors for the duration of the Max Age Header or until you enable HTTPS.\n\n## Enable HSTS\n\n* Dashboard\n\n  To enable HSTS using the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. For **HTTP Strict Transport Security (HSTS)**, select **Enable HSTS**.\n\n  3. Read the dialog and select **I understand**.\n\n  4. Select **Next**.\n\n  5. Configure the [HSTS settings](#configuration-settings).\n\n  6. Select **Save**.\n\n* API\n\n  To enable HSTS with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `security_header` as the setting name in the URI path, and specify the `value` object that includes your HSTS settings.\n\nNote\n\nTo enable HSTS on a specific subdomain only, configure a [subdomain setup](https://developers.cloudflare.com/dns/zone-setups/subdomain-setup/). Alternatively, you can add the appropriate HSTS header at the origin, or use a [response header transform rule](https://developers.cloudflare.com/rules/transform/response-header-modification/).\n\n## Disable HSTS\n\nTo disable HSTS on your website:\n\n1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n   [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n2. For **HTTP Strict Transport Security (HSTS)**, select **Enable HSTS**.\n\n3. Set the **Max Age Header** to **0 (Disable)**.\n\n4. If you previously enabled the **No-Sniff** header and want to remove it, set it to **Off**.\n\n5. Select **Save**.\n\n## Configuration settings\n\n| Name | Required | Description | Options |\n| - | - | - | - |\n| Enable HSTS (Strict-Transport-Security) | Yes | Serves HSTS headers to browsers for all HTTPS requests. HTTP (non-secure) requests will not contain the header. | Off / On |\n| Max Age Header (max-age) | Yes | Specifies duration for a browser HSTS policy and requires HTTPS on your website. | Disable, or a range from 1 to 12 months |\n| Apply HSTS policy to subdomains (includeSubDomains) | No | Applies the HSTS policy from a parent domain to subdomains. Subdomains are inaccessible if they do not support HTTPS. | Off / On |\n| Preload | No | Permits browsers to automatically preload HSTS configuration. Prevents an attacker from downgrading a first request from HTTPS to HTTP. Preload can make a website without HTTPS completely inaccessible. | Off / On |\n| No-Sniff Header | No | Sends the `X-Content-Type-Options: nosniff` header to prevent Internet Explorer and Chrome from automatically detecting a content type other than those explicitly specified by the Content-Type header. | Off / On |\n\nNote\n\nOnce HSTS **Preload** is configured, submit requests for addition to each browser’s preload list. Chrome, Firefox/Mozilla, and Safari use the Chrome preload list. A minimum **Max Age Header** of 12 months is required for inclusion in HSTS preload lists.\n\n</page>\n\n<page>\n---\ntitle: Minimum TLS Version · Cloudflare SSL/TLS docs\ndescription: Minimum TLS Version only allows HTTPS connections from visitors\n  that support the selected TLS protocol version or newer.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/minimum-tls/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/minimum-tls/index.md\n---\n\nMinimum TLS Version only allows HTTPS connections from visitors that support the selected TLS protocol version or newer.\n\nFor example, if TLS 1.1 is selected, visitors attempting to connect using TLS 1.0 will be rejected. Visitors attempting to connect using TLS 1.1, 1.2, or 1.3 ([if enabled](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/tls-13/)) will be allowed to connect.\n\nNote\n\nIf you are looking to restrict cipher suites, refer to [Customize cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/). For guidance on which TLS version to use, refer to [TLS protocols](https://developers.cloudflare.com/ssl/reference/protocols/).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n| Per-hostname | Included with [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) | Included with [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) | Included with [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) | Included with [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) |\n\nIt is not possible to configure minimum TLS version for [Cloudflare Pages](https://developers.cloudflare.com/pages/) hostnames.\n\n## How to disable TLS 1.0\n\nYou can disable TLS 1.0 by choosing a higher minimum TLS version.\n\nAll users can apply this configuration to all hostnames in their zones following the steps under [zone-level](#zone-level).\n\nIf you have an [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/#advanced-certificate-manager) subscription, you also have the option to disable TLS 1.0 (or other versions) with a [per-hostname](#per-hostname) setup.\n\n## Setup\n\nWarning\n\nThe Minimum TLS version that you set up following these steps does not apply to [R2](https://developers.cloudflare.com/r2/) custom domains. To control the TLS version for R2 custom domains, refer to the [custom domains documentation](https://developers.cloudflare.com/r2/buckets/public-buckets/#minimum-tls-version).\n\n### Zone-level\n\nTo manage the TLS version applied to your whole zone when proxied through Cloudflare:\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. For **Minimum TLS Version**, select an option.\n\n* API\n\n  Use the [Edit zone setting](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) endpoint with `min_tls_version` as the setting name in the URI path, and specify your preferred minimum version in the `value` field.\n\n  In the following example, the minimum TLS version for the zone will be set to `1.2`. Replace the zone ID and API token placeholders with your information, and adjust the `value` field with your chosen TLS version.\n\n  Required API token permissions\n\n  At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n  * `Zone Settings Write`",
      "language": "unknown"
    },
    {
      "code": "### Per-hostname\n\n[Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) users also have the option to specify minimum TLS versions per specific hostnames in their Cloudflare zone.\n\nThis is currently only available via the API:\n\n* Use the [Edit TLS setting for hostname](https://developers.cloudflare.com/api/resources/hostnames/subresources/settings/subresources/tls/methods/update/) endpoint to specify different values for `min_tls_version`.\n* Use the [Delete TLS setting for hostname](https://developers.cloudflare.com/api/resources/hostnames/subresources/settings/subresources/tls/methods/delete/) endpoint to clear previously defined `min_tls_version` setting.\n\nCloudflare uses the [hostname priority logic](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/) to determine which setting to apply.\n\nIn the following example, the minimum TLS version for a specific hostname will be set to `1.2`. Replace the zone ID, hostname, and authentication placeholders with your information, and adjust the `value` field with your chosen TLS version.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "### Cloudflare for SaaS\n\nIf you are a SaaS provider looking to configure minimum TLS version for your custom hostnames, refer to the Cloudflare for SaaS [TLS management](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/enforce-mtls/#minimum-tls-version).\n\n## Test supported TLS versions\n\nTo test supported TLS versions, attempt a request to your website or application while specifying a TLS version.\n\nFor example, to test TLS 1.1, use the `curl` command below. Replace `www.example.com` with your Cloudflare domain and hostname.",
      "language": "unknown"
    },
    {
      "code": "If the TLS version you are testing is blocked by Cloudflare, the TLS handshake is not completed and returns an error:\n\n`* error:1400442E:SSL routines:CONNECT_CR_SRVR_HELLO:tlsv1 alert`\n\nNote\n\nLocal VPN or a device security client may prevent insecure connections using legacy protocols like TLS 1.0. Make sure to disable such network or security client before running the test on your device.\n\n</page>\n\n<page>\n---\ntitle: TLS 1.3 · Cloudflare SSL/TLS docs\ndescription: TLS 1.3 enables the latest version of the TLS protocol (when\n  supported) for improved security and performance.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/tls-13/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/tls-13/index.md\n---\n\nTLS 1.3 enables the latest version of the TLS protocol (when supported) for improved security and performance.\n\n## What is TLS 1.3?\n\nTLS 1.3 is the newest, fastest, and most secure version of the [TLS protocol](https://developers.cloudflare.com/ssl/reference/protocols/).\n\nBy turning on the TLS 1.3 feature, traffic to and from your website will be served over the TLS 1.3 protocol when supported by clients. TLS 1.3 protocol has improved latency over older versions, has several new features, and is currently supported in all updated major browsers.\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Enable TLS 1.3\n\nTLS 1.3 can be activated in the Cloudflare dashboard or through the API:\n\n* Dashboard\n\n  To enable TLS 1.3 in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. For **TLS 1.3**, switch the toggle to **On**.\n\n* API\n\n  To adjust your TLS 1.3 settings with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `tls_1_3` as the setting name in the URI path, and set the `value` parameter to your desired setting (`\"on\"`, `\"zrt\"` or `\"off\"`). `zrt` refers to [Zero Round Trip Time Resumption (0-RTT)](https://blog.cloudflare.com/introducing-0-rtt/).\n\n### Troubleshooting\n\nSince TLS 1.3 implementations are relatively new, some failures may occur. If you experience errors, submit a Cloudflare Support ticket with the following information:\n\n* Steps to replicate the issue (if possible)\n* Client build version\n* Client diagnostic information\n* Packet captures\n\nChrome users should submit a [net-internals trace](https://dev.chromium.org/for-testers/providing-network-details) to Google. Firefox users should [report bugs to Mozilla](https://bugzilla.mozilla.org/home).\n\n## Limitations\n\nYou cannot set specific TLS 1.3 ciphers. Instead, you can enable [TLS 1.3](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/tls-13/#enable-tls-13) for your entire zone and Cloudflare will use [all applicable TLS 1.3 cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/supported-cipher-suites/). In combination with this, you can still [disable weak cipher suites](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/cipher-suites/customize-cipher-suites/) for TLS 1.0-1.2.\n\n</page>\n\n<page>\n---\ntitle: Opportunistic Encryption · Cloudflare SSL/TLS docs\ndescription: Opportunistic Encryption allows browsers to access HTTP URIs over\n  an encrypted TLS channel. It's not a substitute for HTTPS, but provides\n  additional security for otherwise vulnerable requests.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/opportunistic-encryption/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/opportunistic-encryption/index.md\n---\n\nOpportunistic Encryption allows browsers to access HTTP URIs over an encrypted TLS channel. It's not a substitute for HTTPS, but provides additional security for otherwise vulnerable requests.\n\nUse HTTPS when both strong encryption and authentication are required. HTTP Opportunistic Encryption provides a means of enabling TLS when needed for other protocols such as HTTP/2. It does not provide the same indications of security as HTTPS (the green lock icon in most browser address bars).\n\n## Availability\n\n| | Free | Pro | Business | Enterprise |\n| - | - | - | - | - |\n| Availability | Yes | Yes | Yes | Yes |\n\n## Enable Opportunistic Encryption\n\nYou do not need to configure your origin web server to support Opportunistic Encryption. All it requires is updating your settings in the Cloudflare dashboard.\n\n* Dashboard\n\n  To enable Opportunistic Encryption in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. For **Opportunistic Encryption**, switch the toggle to **On**.\n\n* API\n\n  To adjust your Opportunistic Encryption settings with the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/zones/subresources/settings/methods/edit/) request with `opportunistic_encryption` as the setting name in the URI path, and specify the `value` parameter with your desired setting (`\"on\"` or `\"off\"`).\n\nNote\n\nTo use this feature on specific hostnames - instead of across your entire zone - use a [configuration rule](https://developers.cloudflare.com/rules/configuration-rules/).\n\n</page>\n\n<page>\n---\ntitle: Total TLS · Cloudflare SSL/TLS docs\ndescription: Total TLS allows Cloudflare to issue individual certificates for\n  your proxied hostnames. These certificates will protect proxied hostnames not\n  covered by Universal certificates.\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/index.md\n---\n\nTotal TLS allows Cloudflare to issue individual certificates for your proxied hostnames. These certificates will protect proxied hostnames not covered by [Universal certificates](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/).\n\nWarning\n\nTotal TLS certificates follow the Common Name (CN) restriction of 64 characters ([RFC 5280](https://www.rfc-editor.org/rfc/rfc5280.html)). If you have a hostname that exceeds this length, you can create an [Advanced Certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/#create-a-certificate) via API to cover it.\n\nWhen issued, these certificates will have a type of **Advanced - Total TLS**, and their default validity period is 90 days.\n\n## Reference\n\n* [Enable](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/enable/)\n* [Error messages](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/error-messages/)\n\n## Availability\n\nTotal TLS is available for domains that have purchased [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) and are currently using a [full DNS setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/).\n\n## Limitations\n\n### Hostnames used with other Cloudflare products\n\nTotal TLS does not issue certificates for any hostnames used with:\n\n* [Cloudflare Load Balancing](https://developers.cloudflare.com/load-balancing/)\n* [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/routing-to-tunnel/)\n* [Cloudflare Spectrum](https://developers.cloudflare.com/spectrum/)\n\nYou can use other types of certificates or manually [order advanced certificates](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/#create-a-certificate) for these hostnames.\n\n### Deleting certificates\n\nOnce you [enable Total TLS](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/enable/), be careful deleting any Total TLS certificates associated with proxied hostnames.\n\nIf you do, our system assumes you want to opt that hostname out of Total TLS certificate and will not order new certificates for the hostname in the future. This behavior applies even if you delete and re-create the hostname's DNS record.\n\n</page>\n\n<page>\n---\ntitle: Domain control validation flow · Cloudflare SSL/TLS docs\ndescription: Consider the steps that have to take place before the DCV process\n  is completed and certificate authorities can issue SSL/TLS certificates.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/index.md\n---\n\nTo obtain [Universal](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/), [Advanced](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/), and [Custom hostname](https://developers.cloudflare.com/cloudflare-for-platforms/cloudflare-for-saas/security/certificate-management/) certificates, Cloudflare partners with different publicly trusted [certificate authorities (CAs)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/).\n\nHowever, every time a CA is requested to issue or renew a certificate, the requester must prove that they have control over the domain. That is when the DCV process takes place, with the proof usually consisting of placing an HTTP token at a standard URL path (`/.well-known/pki-validation`), or placing a TXT record at the authoritative DNS provider.\n\n## Where Cloudflare sits in the DCV process\n\nFor the use cases mentioned above, there are three different parties involved in the process:\n\n* The website or application for which the certificate is issued.\n* The requester (Cloudflare).\n* The CA that processes the request.\n\n## Steps in the process\n\nIn summary, five steps have to succeed after Cloudflare requests a CA to issue or renew a certificate:\n\n1. Cloudflare receives the DCV tokens from the CA.\n2. Cloudflare either places the tokens on your behalf ([Full DNS setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/), [Delegated DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/delegated-dcv/)), or makes the tokens available for you to place them.\n3. Cloudflare polls the validation URLs to check for the tokens.\n4. After Cloudflare can confirm that the tokens are placed via multiple DNS resolvers, the CA is asked to check as well.\n5. If the CA can confirm the tokens are placed, the certificate gets issued. If the CA cannot confirm the tokens are placed, the certificate is not issued and the tokens are no longer valid.\n\n## Aspects to consider\n\n* Settings that interfere with the validation URLs - firewall blocks or misconfigured DNSSEC, for example - can cause issues with your certificate issuance or renewal. Refer to the [troubleshooting guide](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/troubleshooting/).\n\n* When your certificate is in `pending_validation` and valid tokens are in place, some security features targeting your zone's path for `/.well-known/*` can be automatically bypassed.\n\n* Certificate authority authorization (CAA) records may block certificate issuance. Refer to [CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/).\n\n### DCV tokens\n\nDCV tokens are generated and controlled by the CA and not by Cloudflare. You can find further technical specification of how they work in [RFC 8555](https://www.rfc-editor.org/rfc/rfc8555#section-7.1.5).\n\n* As mentioned in [Step 5](#steps-in-the-process), DCV tokens will change upon verification failures. For example, if a DCV check fails because of a DNSSEC issue, the certificate order is no longer valid and Cloudflare must start a new certificate request. Since tokens cannot be reused, a new token is required.\n\n* DCV tokens also have [validity periods](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/validation-backoff-schedule/). If you are handling the DCV process manually, it is recommended that you place the tokens as soon as the certificate is up for renewal. Otherwise, the tokens may expire and new tokens will be required.\n\n</page>\n\n<page>\n---\ntitle: Methods — Domain Control Validation · Cloudflare SSL/TLS docs\ndescription: Review different methods to perform Domain Control Validation when\n  using Cloudflare SSL/TLS.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/index.md\n---\n\nBefore a certificate authority (CA) will issue a certificate for a domain, the requester must prove they have control over that domain. This process is known as domain control validation (DCV).\n\n## Perform DCV\n\nFor details on each method available for DCV, refer to the following resources:\n\n* [Delegated](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/delegated-dcv/)\n* [TXT](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/txt/)\n* [HTTP](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/http/)\n\nNote\n\nFor guidance on when you need to perform DCV, refer to [Domain Control Validation](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/).\n\n***\n\n## Verify DCV status\n\nTo verify the [DCV status](https://developers.cloudflare.com/ssl/reference/certificate-statuses/) of a certificate, either monitor the certificate's status on the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page or use the [Verification Status endpoint](https://developers.cloudflare.com/api/resources/ssl/subresources/verification/methods/get/).\n\nA status of `active` means that the certificate has been deployed to Cloudflare’s global network and will be served as soon as HTTP traffic is proxied to Cloudflare.\n\n## Update DCV methods\n\nYou cannot update the DCV method for an active certificate. To update the DCV method for a subdomain, wait until the DCV expires and then change the DCV method.\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting Domain Control Validation · Cloudflare SSL/TLS docs\ndescription: Taking into account the steps involved in DCV, some situations may\n  interfere with certificate issuance and renewal.\nlastUpdated: 2025-10-16T07:27:17.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/troubleshooting/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/troubleshooting/index.md\n---\n\nTaking into account the [steps involved in DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/), some situations may interfere with certificate issuance and renewal.\n\n[Blocked validation URLs](#blocked-validation-url) or [misconfigured DNS settings](#dns-settings-and-records) might interfere with the certificate authority's ability to finish the validation process. In these situations, you may need to update your configuration at Cloudflare or at your authoritative DNS provider. Additionally, there can also be [errors on the CA side](#ca-errors).\n\nNote\n\nIf you are using the Cloudflare API, error messages are presented under the `validation_errors` parameter.\n\n## Blocked validation URL\n\nIf you have issues while HTTP DCV is in place, review the following settings:\n\n* **Anything affecting `/.well-known/*`**: Review [WAF custom rules](https://developers.cloudflare.com/waf/custom-rules/), [IP Access Rules](https://developers.cloudflare.com/waf/tools/ip-access-rules/), and other [configuration rules](https://developers.cloudflare.com/rules/configuration-rules/) to make sure that your rules *do not* enable interactive challenge on the validation URL.\n\n* **Cloudflare Account Settings** and **Page Rules**: Review your [account settings](https://developers.cloudflare.com/fundamentals/reference/under-attack-mode/), [Configuration Rules](https://developers.cloudflare.com/rules/configuration-rules/), and [Page Rules](https://developers.cloudflare.com/rules/page-rules/) to ensure you have not enabled Under Attack mode on the validation URL.\n\n  Warning\n\n  When your certificate is in `pending_validation` and valid tokens are in place, some security features targeting your zone's path for `/.well-known/*` can be automatically bypassed.\n\n## Redirection\n\nEnabling [Always Use HTTPS](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/always-use-https/) does not impact the validation process.\n\nIn a [Partial (CNAME) setup](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/#partial-dns-setup---action-sometimes-required) where you are managing the token on the origin side, please ensure that no redirection from HTTP to HTTPS occurs on the `/.well-known/*` path.\n\nWhen using [Redirect Rules](https://developers.cloudflare.com/rules/url-forwarding/single-redirects/) the `/.well-known/*` path should be excluded from redirections.\n\n## DNS settings and records\n\nThe errors below refer to situations that have to be addressed at the authoritative DNS provider:\n\n* `the Certificate Authority had trouble performing a DNS lookup: dns problem: looking up caa for <hostname>: dnssec: bogus`\n* `Certificate authority encountered a SERVFAIL during DNS lookup, please check your DNS reachability.`\n\nConsider the following when troubleshooting:\n\n* [DNSSEC](https://www.cloudflare.com/learning/dns/dns-security/) must be configured correctly. You can use [DNSViz](https://dnsviz.net/) to understand and troubleshoot the deployment of DNSSEC.\n* Your [CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) should allow Cloudflare's partner [certificate authorities (CAs)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) to issue certificates on your behalf.\n* Your [CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) must be resolvable from all locations.\n* The HTTP verification process is done preferably over **IPv6**, so if any AAAA record exists and does not point to the same dual-stack location as the A record, the validation will fail.\n* If an [NS record](https://developers.cloudflare.com/dns/manage-dns-records/reference/dns-record-types/#ns) is present for the hostname or its parent, DNS resolution will be managed externally by the DNS provider defined in the NS target. In this case, you must either add the DCV TXT record at the external DNS provider, or remove the NS record at Cloudflare.\n\n## CA errors\n\n### Rate limiting\n\nAs mentioned in [Certificate authorities](https://developers.cloudflare.com/ssl/reference/certificate-authorities/), specific CAs may have their own limitations. If you use Let’s Encrypt and receive the error below, it means you hit the [duplicate certificate limit](https://letsencrypt.org/docs/duplicate-certificate-limit/) imposed by Let's Encrypt.\n\n`The authority has rate limited these domains. Please wait for the rate limit to expire or try another authority.`\n\nA certificate is considered a duplicate of an earlier certificate if it contains the exact same set of hostnames.\n\nIn this case, you can either wait for the rate limit window to end or choose a different certificate authority.\n\n### Multiple perspective CAA check error\n\nThe error `Certificate authority encountered a multiple perspective CAA check error, please ensure your DNS is configured to allow CAA queries` means that the CA was not able to resolve the CAA records related to your domain from specific geographic locations.\n\nYou can investigate for resolution error using the [ping.pe tool](https://dig.ping.pe/). For example, for a [Google Trust Services](https://developers.cloudflare.com/ssl/reference/certificate-authorities/#google-trust-services) certificate encountering this issue, you can check for: `<hostname>:CAA:8.8.8.8`.\n\nRead more from Certificate Authorities specific documentation: [SSL.com](https://www.ssl.com/blogs/multi-perspective-issuance-corroboration-mpic-arrives/), [Let's Encrypt](https://letsencrypt.org/2020/02/19/multi-perspective-validation), and [Google Trust Services](https://pki.goog/faq/#faq-mpic).\n\n### Internal errors\n\nWhen the certificate authority finds an issue during the CA check portion of the [DCV flow](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/), you may see a `Internal error with Certificate Authority` message. In this case, either wait or try a different certificate authority.\n\nWhen the error states that the `certificate authority will not issue for this domain`, you can try a different certificate authority or contact the CA directly.\n\n</page>\n\n<page>\n---\ntitle: Validation backoff schedule · Cloudflare SSL/TLS docs\ndescription: Consider what happens if a domain control validation (DCV) fails\n  and what schedule Cloudflare follows for new attempts and backoff.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/validation-backoff-schedule/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/validation-backoff-schedule/index.md\n---\n\nDomain control validation (DCV) has to happen before a certificate authority (CA) will issue a certificate for a domain. If DCV fails during issuance or renewal, Cloudflare automatically retries it on a schedule.\n\nIf you use [Delegated DCV](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/delegated-dcv/) or if [Cloudflare automatically performs DCV for you](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/), this page is only informational. If you have to manually perform DCV, consider the following sections about the validation schedule and remember that DCV tokens have a [fixed validity period](#dcv-tokens-validity).\n\nNote\n\nYou can also request an immediate recheck by using the [Edit SSL Certificate Pack Validation Method endpoint](https://developers.cloudflare.com/api/resources/ssl/subresources/verification/methods/edit/), specifying the same `validation_method` as the [method](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/methods/) you currently use.\n\n***\n\n## DCV tokens validity\n\nThe DCV process relies on tokens that are generated by the issuing certificate authority. These tokens have a validity period defined by each CA:\n\n* Google Trust Services - 14 days\n* Let's Encrypt - 7 days\n* SSL.com - 14 days\n\nAfter this period, DCV tokens expire as dictated by the [CA/B Baseline Requirements](https://cabforum.org/baseline-requirements-documents/), and new, valid tokens must be placed.\n\nWarning\n\nTokens may also become invalid upon validation failure. For more details, refer to [Domain control validation flow](https://developers.cloudflare.com/ssl/edge-certificates/changing-dcv-method/dcv-flow/#dcv-tokens).\n\n***\n\n## Successive checks function\n\nCloudflare caps the check backoff to a maximum of four hours to avoid the function growing exponentially, which would result in large gaps between checks towards the end of the month.",
      "language": "unknown"
    },
    {
      "code": "***\n\n## Capped attempts reference table\n\nAs presented in the following table, most of the checks take place on the first day after the DCV token is generated.\n\nIn manual processes, it is possible that you fall behind schedule when you place the token, meaning that it may not be validated immediately.\n\nIn automatic processes, most validations complete within the first five minutes, unless there is a setup misconfiguration.\n\n| Retry Attempt | In Seconds | In Minutes | In Hours |\n| - | - | - | - |\n| 0 | 60 | 1.000 | 0.016667 |\n| 1 | 63 | 1.050 | 0.017500 |\n| 2 | 66 | 1.100 | 0.018333 |\n| 3 | 69 | 1.150 | 0.019167 |\n| 4 | 72 | 1.200 | 0.020000 |\n| 5 | 76 | 1.267 | 0.021111 |\n| 6 | 80 | 1.333 | 0.022222 |\n| 7 | 84 | 1.400 | 0.023333 |\n| 8 | 88 | 1.467 | 0.024444 |\n| 9 | 93 | 1.550 | 0.025833 |\n| 10 | 242 | 4.033 | 0.067222 |\n| 11 | 279 | 4.650 | 0.077500 |\n| 12 | 321 | 5.350 | 0.089167 |\n| 13 | 369 | 6.150 | 0.102500 |\n| 14 | 424 | 7.067 | 0.117778 |\n| 15 | 488 | 8.133 | 0.135556 |\n| 16 | 561 | 9.350 | 0.155833 |\n| 17 | 645 | 10.750 | 0.179167 |\n| 18 | 742 | 12.367 | 0.206111 |\n| 19 | 853 | 14.217 | 0.236944 |\n| 20 | 981 | 16.350 | 0.272500 |\n| 21 | 1129 | 18.817 | 0.313611 |\n| 22 | 1298 | 21.633 | 0.360556 |\n| 23 | 1493 | 24.883 | 0.414722 |\n| 24 | 1717 | 28.617 | 0.476944 |\n| 25 | 1975 | 32.917 | 0.548611 |\n| 26 | 2271 | 37.850 | 0.630833 |\n| 27 | 2612 | 43.533 | 0.725556 |\n| 28 | 3003 | 50.050 | 0.834167 |\n| 29 | 3454 | 57.567 | 0.959444 |\n| 30 | 3972 | 66.200 | 1.103333 |\n| 31 | 4568 | 76.133 | 1.268889 |\n| 32 | 5253 | 87.550 | 1.459167 |\n| 33 | 6041 | 100.683 | 1.678056 |\n| 34 | 6948 | 115.800 | 1.930000 |\n| 35 | 7990 | 133.167 | 2.219444 |\n| 36 | 9189 | 153.150 | 2.552500 |\n| 37 | 10567 | 176.117 | 2.935278 |\n| 38 | 12152 | 202.533 | 3.375556 |\n| 39 | 13975 | 232.917 | 3.881944 |\n| 40 | 14400 | 240.000 | 4.000000 |\n| 41 | 14400 | 240.000 | 4.000000 |\n| 42 | 14400 | 240.000 | 4.000000 |\n| 43 | 14400 | 240.000 | 4.000000 |\n| 44 | 14400 | 240.000 | 4.000000 |\n| 45 | 14400 | 240.000 | 4.000000 |\n| 46 | 14400 | 240.000 | 4.000000 |\n| 47 | 14400 | 240.000 | 4.000000 |\n| 48 | 14400 | 240.000 | 4.000000 |\n| 49 | 14400 | 240.000 | 4.000000 |\n| 50 | 14400 | 240.000 | 4.000000 |\n| 51 | 14400 | 240.000 | 4.000000 |\n| 52 | 14400 | 240.000 | 4.000000 |\n| 53 | 14400 | 240.000 | 4.000000 |\n| 54 | 14400 | 240.000 | 4.000000 |\n| 55 | 14400 | 240.000 | 4.000000 |\n| 56 | 14400 | 240.000 | 4.000000 |\n| 57 | 14400 | 240.000 | 4.000000 |\n| 58 | 14400 | 240.000 | 4.000000 |\n| 59 | 14400 | 240.000 | 4.000000 |\n| 60 | 14400 | 240.000 | 4.000000 |\n| 61 | 14400 | 240.000 | 4.000000 |\n| 62 | 14400 | 240.000 | 4.000000 |\n| 63 | 14400 | 240.000 | 4.000000 |\n| 64 | 14400 | 240.000 | 4.000000 |\n| 65 | 14400 | 240.000 | 4.000000 |\n| 66 | 14400 | 240.000 | 4.000000 |\n| 67 | 14400 | 240.000 | 4.000000 |\n| 68 | 14400 | 240.000 | 4.000000 |\n| 69 | 14400 | 240.000 | 4.000000 |\n| 70 | 14400 | 240.000 | 4.000000 |\n| 71 | 14400 | 240.000 | 4.000000 |\n| 72 | 14400 | 240.000 | 4.000000 |\n| 73 | 14400 | 240.000 | 4.000000 |\n| 74 | 14400 | 240.000 | 4.000000 |\n| 75 | 14400 | 240.000 | 4.000000 |\n| 76 | 14400 | 240.000 | 4.000000 |\n| 77 | 14400 | 240.000 | 4.000000 |\n| 78 | 14400 | 240.000 | 4.000000 |\n| 79 | 14400 | 240.000 | 4.000000 |\n| 80 | 14400 | 240.000 | 4.000000 |\n| 81 | 14400 | 240.000 | 4.000000 |\n| 82 | 14400 | 240.000 | 4.000000 |\n| 83 | 14400 | 240.000 | 4.000000 |\n| 84 | 14400 | 240.000 | 4.000000 |\n| 85 | 14400 | 240.000 | 4.000000 |\n| 86 | 14400 | 240.000 | 4.000000 |\n| 87 | 14400 | 240.000 | 4.000000 |\n| 88 | 14400 | 240.000 | 4.000000 |\n| 89 | 14400 | 240.000 | 4.000000 |\n| 90 | 14400 | 240.000 | 4.000000 |\n| 91 | 14400 | 240.000 | 4.000000 |\n| 92 | 14400 | 240.000 | 4.000000 |\n| 93 | 14400 | 240.000 | 4.000000 |\n| 94 | 14400 | 240.000 | 4.000000 |\n| 95 | 14400 | 240.000 | 4.000000 |\n| 96 | 14400 | 240.000 | 4.000000 |\n| 97 | 14400 | 240.000 | 4.000000 |\n| 98 | 14400 | 240.000 | 4.000000 |\n| 99 | 14400 | 240.000 | 4.000000 |\n| 100 | 14400 | 240.000 | 4.000000 |\n| 101 | 14400 | 240.000 | 4.000000 |\n| 102 | 14400 | 240.000 | 4.000000 |\n| 103 | 14400 | 240.000 | 4.000000 |\n| 104 | 14400 | 240.000 | 4.000000 |\n| 105 | 14400 | 240.000 | 4.000000 |\n| 106 | 14400 | 240.000 | 4.000000 |\n| 107 | 14400 | 240.000 | 4.000000 |\n| 108 | 14400 | 240.000 | 4.000000 |\n| 109 | 14400 | 240.000 | 4.000000 |\n| 110 | 14400 | 240.000 | 4.000000 |\n| 111 | 14400 | 240.000 | 4.000000 |\n| 112 | 14400 | 240.000 | 4.000000 |\n| 113 | 14400 | 240.000 | 4.000000 |\n| 114 | 14400 | 240.000 | 4.000000 |\n| 115 | 14400 | 240.000 | 4.000000 |\n| 116 | 14400 | 240.000 | 4.000000 |\n| 117 | 14400 | 240.000 | 4.000000 |\n| 118 | 14400 | 240.000 | 4.000000 |\n| 119 | 14400 | 240.000 | 4.000000 |\n\n</page>\n\n<page>\n---\ntitle: Bundle methodologies · Cloudflare SSL/TLS docs\ndescription: When an SSL certificate is deployed to Cloudflare's global network,\n  it may be augmented with intermediate and root certificates to assist the user\n  agent in finding a chain to a publicly trusted root.\nlastUpdated: 2025-12-05T17:26:34.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/index.md\n---\n\nWhen an SSL certificate is deployed to Cloudflare's global network, it may be augmented with intermediate and root certificates to assist the user agent in finding a chain to a publicly trusted root.\n\nYou can control the mechanics of how certificates are bundled by specifying a bundling methodology.\n\n## Intermediate and root certificates\n\nCloudflare maintains intermediate and root certificates used for bundling on a [GitHub repository](https://github.com/cloudflare/cfssl_trust). As the certificates expire or are removed by certificate authorities, Cloudflare removes and adds them accordingly.\n\nExpiration values for these certificates may appear in the `expires_on` field when you use the [Analyze Certificate endpoint](https://developers.cloudflare.com/api/resources/ssl/subresources/analyze/methods/create/) - often when the methodology you specify is [Compatible](#compatible). However, these expiration values reflect intermediate and root certificates - which are handled by Cloudflare -, not the leaf certificate you would have previously uploaded to Cloudflare.\n\nNote\n\nWhen using `compatible` or `modern`, a selection might be done on the intermediates you provide at upload time, meaning it is not guaranteed all of them will make it to the final chain. If you must ensure the chain you upload is the one used, select `user-defined`.\n\n## Methodologies\n\n### Compatible\n\nCompatible is the default methodology and uses common and well distributed intermediate certificates to complete the chain. This ensures that the resulting bundle is compatible with as many clients as possible.\n\nThe related value for the `bundle_method` parameter when using the [API](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) is `ubiquitous`.\n\n### Modern\n\nModern consists of attempts to make the chain as efficient as possible, often by using newer or fewer intermediate certificates.\n\nThe related value for the `bundle_method` parameter when using the [API](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) is `optimal`.\n\n### User-defined\n\nUser-defined allows you to paste your own certificate chain and present that bundle to clients. You must specify any intermediates you wish to use, followed by the leaf. If you are using a self-signed certificate (not recommended), you must use this mode.\n\nThe related value for the `bundle_method` parameter when using the [API](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) is `force`. The order and format of the chain should look like the following:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Remove key file password · Cloudflare SSL/TLS docs\ndescription: You cannot upload a custom certificate with a password-protected key file.\nlastUpdated: 2024-08-20T19:58:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/remove-file-key-password/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/remove-file-key-password/index.md\n---\n\nYou cannot upload a custom certificate with a password-protected key file.\n\nThe process for removing the password depends on your operating system. The following examples remove the password from `example.com.key`.\n\nLinux\n\n1. Open a command console.\n\n2. Go to the directory containing the `example.com.key` file.\n\n3. Copy the original key.",
      "language": "unknown"
    },
    {
      "code": "4. Run the following command (if using an ECDSA certificate, replace `rsa` with `ec`).",
      "language": "unknown"
    },
    {
      "code": "5. When prompted in the console window, enter the original key password.\n\n6. [Upload the file contents](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate) to Cloudflare.\n\nWindows\n\n1. Go to <https://indy.fulgan.com/SSL/> and download the latest version of OpenSSL for your x86 or x86\\_64 operating system.\n\n2. Open the `.zip` file and extract it.\n\n3. Select **openssl.exe**.\n\n4. In the command window that appears, run:",
      "language": "unknown"
    },
    {
      "code": "5. Enter the original key password when prompted by the **openssl.exe** command window.\n\n6. [Upload](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate) the contents of the `key.pem` file to Cloudflare.\n\n</page>\n\n<page>\n---\ntitle: Renewal and expiration · Cloudflare SSL/TLS docs\ndescription: Learn how renewal and expiration work when using Cloudflare Custom\n  SSL certificates.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/renewing/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/renewing/index.md\n---\n\n## Renew custom certificates\n\nSince Cloudflare cannot renew uploaded certificates, you should ensure that you replace or [update](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#update-an-existing-custom-certificate) an expiring custom certificate before it expires, otherwise your visitors may not be able to connect.\n\nCloudflare automatically sends email notifications 30 and 14 days before your custom certificate expires. The email is sent to users who have the SSL/TLS, Administrator, or Super Administrator [roles](https://developers.cloudflare.com/fundamentals/manage-members/roles/).\n\nNote\n\nWhen renewing a custom certificate, you can reuse a [previously generated CSR](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/certificate-signing-requests/).\n\nIf you are on an Enterprise plan and want to renew a custom (modern) certificate, consider requesting access to [Staging environment (Beta)](https://developers.cloudflare.com/ssl/edge-certificates/staging-environment/).\n\n## Expired certificates\n\nIf a valid replacement - covering some or all of the SANs in the expiring custom certificate - is already available, Cloudflare will remove the expiring custom certificate in the 24 hours before expiration. There is no expected downtime due to certificate transition.\n\nIf no valid replacement is available, Cloudflare will remove the custom certificate after it expires.\n\nAffected domains and subdomains will fall back to any other active certificate covering the hostnames on the expiring certificate.\n\nWarning\n\nAll certificates in a [certificate pack](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/#certificate-packs) are treated as one object. The expiration date of a certificate pack is equivalent to the soonest `Not After` date among the certificates in the pack.\n\nFor example if you have a custom certificate made of an ECSDA and a RSA certificate, if one of them expires the whole pack will be removed.\n\n## Migrate to other certificate types\n\nIf you no longer want to use your custom certificate but still want your website or application to be covered with SSL/TLS, you can do the following:\n\n1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n   [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n2. Make sure there is already an active [universal](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) or [advanced](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) certificate covering the same hostnames.\n\n3. Delete your custom certificate.\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting · Cloudflare SSL/TLS docs\ndescription: Troubleshoot issues with Client certificates\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/troubleshooting/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/troubleshooting/index.md\n---\n\n## Generic troubleshooting\n\n### Make sure your key and certificate match\n\nYou can use an external tool such as the [SSLShopper Certificate Key Matcher](https://www.sslshopper.com/certificate-key-matcher.html) to check your certificate and make sure the key matches.\n\n### Check the certificate details\n\nYou can use `openssl` to check all the details of your certificate:",
      "language": "unknown"
    },
    {
      "code": "Then, make sure all the information is correct before uploading.\n\n## Moved domains\n\nIf you move a domain without deleting the custom certificate from the previous zone, the certificate may still [take precedence](https://developers.cloudflare.com/ssl/reference/certificate-and-hostname-priority/) and be presented to your visitors, until the previous zone is [deleted](https://developers.cloudflare.com/dns/zone-setups/reference/domain-status/).\n\nRefer to [Move a domain between Cloudflare accounts](https://developers.cloudflare.com/fundamentals/manage-domains/move-domain/#issue-new-certificates) for details.\n\n## Let's Encrypt chain update\n\nAs Let's Encrypt - one of the [certificate authorities (CAs)](https://developers.cloudflare.com/ssl/reference/certificate-authorities/) used by Cloudflare - has announced changes in its [chain of trust](https://developers.cloudflare.com/ssl/concepts/#chain-of-trust), you may face issues.\n\nIf you are using a Let's Encrypt certificate uploaded by yourself as a custom certificate, consider the following:\n\n* If you use **compatible** or **modern** [bundle method](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/) and have uploaded your certificate before September 9, 2024, [update your custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#update-an-existing-custom-certificate) so that it can be bundled with the new chain.\n* If you use **user-defined** bundle method, make sure that your certificates uploaded after September 30, 2024, do not use the Let's Encrypt cross-signed chain.\n\n## Error codes\n\n### Invalid certificate. (Code: 1002)\n\n**Root cause**\n\nThe certificate you are trying to upload is invalid. For example, there might be extra lines, or the BEGIN/END text is not correct, or extra characters are added following a copy/paste.\n\nIn the case of an update with the [PATCH API call](https://developers.cloudflare.com/api/resources/custom_certificates/methods/edit/), it can mean the path parameter `{custom_certificate_id}` is invalid.\n\n**Solution**\n\nCarefully check the content of the certificate. You may use `openssl` to check all the details of your certificate:",
      "language": "unknown"
    },
    {
      "code": "When using the API, carefully check the `{custom_certificate_id}` path parameter. You can confirm the certificate ID by [listing the existing custom certificates](https://developers.cloudflare.com/api/resources/custom_certificates/methods/list/) (`id` in the response).\n\n### You have reached the maximum number of custom certificates. (Code: 1212)\n\n**Root cause**\n\nYou have used up your custom certificate quota.\n\n**Solution**\n\nDelete some existing certificates to add a new one. If you are an Enterprise customer, you can contact your account team to acquire more custom certificates.\n\n### This certificate has already been submitted. (Code: 1220)\n\n**Root cause**\n\nYou are trying to upload a custom certificate that you have already uploaded.\n\n**Solution**\n\nDelete the existing one and try again.\n\n### The SSL attribute is invalid. Please refer to the API documentation, check your input and try again. (Code: 1434)\n\n**Root cause**\n\nYou are trying to upload a custom certificate that does not support any cipher that is needed by Chromium-based browsers.\n\n**Solution**\n\nModify the certificate so that it supports chromium-supported ciphers and try again.\n\n### You have reached your quota for the requested resource. (Code: 2005)\n\n**Root cause**\n\nThe quota for custom certificates depends on the **type** of certificate (**Custom Legacy** vs **Custom Modern**).\n\nIf you try to upload a certificate **type** but have already reached your quota, you will receive this error.\n\n**Solution**\n\nFirst, check your custom certificate entitlements on the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page.\n\nThen, when actually uploading or editing the certificate, make sure you select the appropriate option for **Legacy Client Support**.\n\n### The certificate chain you uploaded cannot be bundled using Cloudflare's trust store. Please check your input and try again. (Code: 2100)\n\n**Root cause**\n\nYou are trying to upload a custom certificate that contains the root and leaf certificate at the same time.\n\n**Solution**\n\nUpload the leaf certificate only.\n\n### The certificate chain you uploaded has no leaf certificates. Please check your input and try again. (Code: 2101)\n\n**Root cause**\n\nYou are trying to upload a root + intermediate + intermediate `.crt` file, but the actual leaf certificate is in a separate file.\n\n**Solution**\n\nAdd the leaf to the `.crt` file, or just use the leaf by itself since the Certificate Authority has a public chain of trust in our trust store.\n\n### The certificate chain you uploaded does not include any hostnames from your zone. Please check your input and try again. (Code: 2103)\n\n**Root cause**\n\nCloudflare verifies that uploaded custom certificates include a hostname for the associated zone. Moreover, this hostname must be included as a Subject Alternative Name (SAN). This is following the standard set by the [CA/Browser Forum](https://cabforum.org/wp-content/uploads/BRv1.2.5.pdf#page=16).\n\n**Solution**\n\nMake sure your certificate contains a Subject Alternative Name (SAN) specifying a hostname in your zone. You can use the `openssl` command below and look for `Subject Alternative Name` in the output.",
      "language": "unknown"
    },
    {
      "code": "If it does not exist, you will need to request a new certificate.\n\n### The private key you uploaded is invalid. Please check your input and try again. (Code: 2106)\n\n**Root cause**\n\nCloudflare requires separate, pem-encoded files for the SSL private key and certificate.\n\n**Solution**\n\nContact your Certificate Authority (CA) to confirm whether your current certificate meets this requirement or request your CA to assist with certificate format conversion.\n\nMake sure your certificate complies with these [requirements](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#certificate-requirements).\n\nCheck that the certificate and private keys match before uploading the certificate in the Cloudflare dashboard. This [external resource](https://www.sslshopper.com/article-most-common-openssl-commands.html) might help.\n\n</page>\n\n<page>\n---\ntitle: Manage custom certificates · Cloudflare SSL/TLS docs\ndescription: This page lists Cloudflare requirements for custom certificates and\n  explains how to upload and update these certificates using Cloudflare\n  dashboard or API.\nlastUpdated: 2025-10-28T14:13:10.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/index.md\n---\n\nThis page lists Cloudflare requirements for custom certificates and explains how to upload and update these certificates using Cloudflare dashboard or API.\n\n## Certificate requirements\n\nBefore accepting custom certificates, Cloudflare parses them and checks for validity according to a list of requirements.\n\nFull list of requirements\n\nEach custom certificate you upload must:\n\n* Be encoded in PEM format (PEM, PKCS#7, or PKCS#12). See [Converting Using OpenSSL](https://www.sslshopper.com/article-most-common-openssl-commands.html) for conversion examples.\n\n* Not have a [key file password](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/remove-file-key-password/).\n\n* Not be expiring in less than 14 days from time of upload.\n\n* Have a subject alternative name (SAN) matching at least one hostname in the zone where it is being uploaded.\n\n* Use a private key greater than or equal to a minimum length. Currently, 2048 bit for RSA and 225 bit for ECDSA.\n\n* Be publicly trusted by a major browser. This does not apply for certificates that specify `User Defined` as their [bundling methodology](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/).\n\n* Be one of the following certificate types:\n\n  * Unified Communications Certificates (UCC)\n  * Extended Validation (EV)\n  * Domain Validated (DV)\n  * Organization Validated (OV)\n\n***\n\n## Upload a custom certificate\n\nWarning\n\nWhen using `compatible` or `modern` [bundling](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies), make sure to upload only the leaf certificate. This will allow Cloudflare to properly handle [the expiration of intermediate and root certificates](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/#intermediate-and-root-certificates).\n\n* Dashboard\n\n  To upload a custom SSL certificate in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. In **Edge Certificates**, select **Upload Custom SSL Certificate**.\n\n  3. Copy and paste relevant values into **SSL Certificate** and **Private key** text areas (or select **Paste from file**).\n\n     Note\n\n     If doing this manually, include the `---BEGIN CERTIFICATE---` and `---END CERTIFICATE---` like the placeholder text.\n\n  4. Choose the appropriate [**Bundle Method**](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/bundling-methodologies/).\n\n  5. Select a value for [**Private Key Restriction**](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/#geo-key-manager-private-key-restriction).\n\n  6. Select a value for **Legacy Client Support**, which specifies [Server Name Indication (SNI)](https://developers.cloudflare.com/ssl/reference/browser-compatibility/#non-sni-support) support:\n\n     * **Modern (recommended)**: SNI only\n\n     * **Legacy**: Supports non-SNI\n\n       Warning\n\n       Custom certificates of the type `legacy_custom` are not compatible with [BYOIP](https://developers.cloudflare.com/byoip/).\n\n  7. Select **Upload Custom Certificate**. If you see an error for `The key you provided does not match the certificate`, contact your Certificate Authority to ensure the private key matches the certificate.\n\n  8. (optional) [Add a CAA DNS record](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/).\n\n* API\n\n  The following call will upload a certificate for use with `app.example.com`. Cloudflare will automatically bundle the certificate with a certificate chain optimized for maximum compatibility with browsers.\n\n  Warning\n\n  Note that if you are using an ECC key generated by OpenSSL, you will need to first remove the `-----BEGIN EC PARAMETERS-----...-----END EC PARAMETERS-----` section of the file.\n\n  1. Update the file and build the payload",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "With the certificate and key saved to environment variables (using escaped newlines), build the payload:",
      "language": "unknown"
    },
    {
      "code": "You can optionally add [geographic restrictions](https://blog.cloudflare.com/introducing-cloudflare-geo-key-manager/) that specify where your private key can physically be decrypted:",
      "language": "unknown"
    },
    {
      "code": "You can also enable support for legacy clients which do not include SNI in the TLS handshake.",
      "language": "unknown"
    },
    {
      "code": "`sni_custom` is recommended by Cloudflare. Use `legacy_custom` when a specific client requires non-SNI support. The Cloudflare API treats all Custom SSL certificates as Legacy by default.\n\n  Warning\n\n  Custom certificates of the type `legacy_custom` are not compatible with [BYOIP](https://developers.cloudflare.com/byoip/).\n\n  1. Upload your certificate and key\n\n  Use the [POST](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) endpoint to upload your certificate and key.",
      "language": "unknown"
    },
    {
      "code": "1. (Optional) Add a CAA record.\n\n  A Certificate Authority Authorization (CAA) DNS record specifies which certificate authorities (CAs) are allowed to issue certificates for a domain. This record reduces the chance of unauthorized certificate issuance and promotes standardization across your organization.\n\n  For more guidance, refer to [Create a CAA record](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/).\n\n***\n\n## Update an existing custom certificate\n\nBefore you update an existing custom certificate, you might want to consider having active [universal](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) or [advanced](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) certificates as fallback options. Go to the [**Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates) page to check a list of hostnames and status of the edge certificates in your zone.\n\nIf you are on an Enterprise plan and want to update a custom (modern) certificate, also consider requesting access to [Staging environment (Beta)](https://developers.cloudflare.com/ssl/edge-certificates/staging-environment/).\n\nReplacing a custom certificate following these steps does not lead to any downtime. No connections will be terminated and new connections will use the new certificate. The old certificate will only actually be deleted when the new certificate is uploaded and active.\n\n* Dashboard\n\n  To update a certificate in the dashboard:\n\n  1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n     [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n  2. In **Edge Certificates**, locate a custom certificate and select it to expand.\n\n  3. Select the wrench button and choose **Replace SSL certificate and key**.\n\n  4. Follow the same steps as [upload a new certificate](#upload-a-custom-certificate).\n\n* API\n\n  To update a certificate using the API, send a [`PATCH`](https://developers.cloudflare.com/api/resources/custom_certificates/methods/edit/) command.\n\nNote\n\nTo update the **Private Key Restriction** setting of a certificate, delete and re-add the certificate.\n\n***\n\n## Delete a custom certificate\n\n1. In the Cloudflare dashboard, go to the **Edge Certificates** page.\n\n   [Go to **Edge Certificates**](https://dash.cloudflare.com/?to=/:account/:zone/ssl-tls/edge-certificates)\n\n2. In **Edge Certificates**, locate a custom certificate and select it to expand.\n\n3. Select the cross button.\n\n4. Select **Confirm** to delete the certificate.\n\n</page>\n\n<page>\n---\ntitle: Setup - Geo Key Manager · Cloudflare SSL/TLS docs\ndescription: Learn how to set up Geo Key Manager and choose the geographical\n  boundaries of where your private encryption keys are stored.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/setup/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/setup/index.md\n---\n\n## Geo Key Manager v2 Beta\n\nNote\n\nGeo Key Manager v2 is only available through the Cloudflare API.\n\nGeo Key Manager v2 gives customers flexibility when choosing the geographical boundaries of where their keys are stored.\n\nUsing the `policy` field, customers can define policies containing allow and block lists of countries or regions where the private key should be stored.\n\nTo use Geo Key Manager v2 with the API, generally, follow the steps to [upload a custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate).\n\nWhen sending the [`POST`](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) request, include the `policy` parameter to define policies containing allow and block lists of countries or regions where the private key should be stored.\n\nNote\n\nYou also have access to the `geo_restrictions` parameter, which is mutually exclusive with the `policy` parameter and is part of [Geo Key Manager v1](#geo-key-manager-v1).\n\n### Examples\n\nStore private keys in the E.U. and the U.S.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: Mutual TLS Certificates Write`\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "Store private keys in the E.U., but not in France\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Access: Mutual TLS Certificates Write`\n* `SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "Note\n\nFor more information on the `policy` field, refer to [Supported options](https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/supported-options/).\n\n## Geo Key Manager v1\n\nThe first version of Geo Key Manager supports 3 regions: U.S., E.U., and a set of High Security Data Centers. If you would like to restrict your private key to another country or region, [apply for the closed beta](https://www.cloudflare.com/lp/geo-key-manager/) of the new version.\n\n* Dashboard\n\n  To use Geo Key Manager in the dashboard:\n\n  1. Follow the steps to [upload a custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate).\n\n  2. For **Private Key Restriction**, choose one of the following options:\n\n     * **Distribute to all Cloudflare data centers (optimal performance)**\n     * **Distribute only to U.S. data centers**\n     * **Distribute only to E.U. data centers**\n     * **Distribute only to highest security data centers** ([more details](https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/supported-options/#highest-security-data-centers))\n\n  3. Select **Upload Custom Certificate**.\n\n* API\n\n  To use Geo Key Manager with the API, generally, follow the steps to [upload a custom certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate).\n\n  When sending the [`POST`](https://developers.cloudflare.com/api/resources/custom_certificates/methods/create/) request, include the `geo_restrictions` parameter set to one of the following options:\n\n  * `us`\n  * `eu`\n  * `highest_security`([more details](https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/supported-options/#highest-security-data-centers))\n\n</page>\n\n<page>\n---\ntitle: Supported options - Geo Key Manager · Cloudflare SSL/TLS docs\ndescription: Learn which options are supported for Geo Key Manager.\nlastUpdated: 2024-08-13T19:56:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/supported-options/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/geokey-manager/supported-options/index.md\n---\n\n## Available regions\n\nFor customers with Geo Key Manager v2, you can use the `policy` parameter to specify following regions using the **Region code**:\n\n| Region code | Region name |\n| - | - |\n| AFR | Africa |\n| APAC | Asia Pacific |\n| EEUR | Eastern Europe |\n| ENAM | Eastern North America |\n| EU | European Union |\n| ME | Middle East |\n| OC | Oceania |\n| SAM | South America |\n| WEUR | Western Europe |\n| WNAM | Western North America |\n\n***\n\n## Available countries\n\nFor customers with Geo Key Manager v2, you can use the `policy` parameter to specify individual countries as well. Cloudflare is constantly expanding the number of supported countries. To indicate a country, specify the two-letter (ISO 3166) country code.\n\nExamples of supported countries are Japan, Canada, India, and Australia.\n\n***\n\n## Highest security data centers\n\nFor customers with both Geo Key Manager v1 and v2, you can use the `geo_restrictions` parameter to only choose Cloudflare's highest security data centers.\n\nThe following aspects are unique to our highest security data centers, but the baseline security requirements for all data centers are also detailed in [our blog](https://blog.cloudflare.com/introducing-cloudflare-geo-key-manager/).\n\n### Pre-scheduled and biometric controlled facility access\n\nEmployees of Cloudflare permitted to access the facility must have previously scheduled a visit before access will be granted.\n\nAccess to the entrance of the facility is controlled through the use of a biometric hand reader combined with an assigned access code.\n\n### Private cages with biometric readers\n\nAll equipment is in private cages with physical access controlled via biometrics and recorded in audit logs. Entrants have to pass through five separate readers before they can access the cage.\n\n### Exterior security controls and monitoring\n\nAll points of ingress/egress are monitored by an intrusion detection system (IDS), with authorized users and access events archived for historical review.\n\n### Interior security controls and monitoring\n\nInterior points of ingress/egress are controlled by the access control subsystem, with entry routed through a mantrap. All areas are monitored and recorded with closed-circuit television, with data kept for a minimum of thirty days.\n\nExterior walls are airtight and may incorporate additional security measures such as reinforced concrete, Kevlar bullet board, vapor barriers, or bullet-proof front doors.\n\n</page>\n\n<page>\n---\ntitle: CAs and edge certificates FAQ · Cloudflare SSL/TLS docs\ndescription: Get answers to commonly asked questions about the certificates you\n  can obtain through Cloudflare and the CAs that Cloudflare partners with.\nlastUpdated: 2025-07-17T10:06:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/troubleshooting/ca-faq/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/troubleshooting/ca-faq/index.md\n---\n\nRefer to this page for frequently asked questions about Cloudflare SSL/TLS certificate offerings and the CAs that Cloudflare partners with.\n\n## General\n\n### Does Cloudflare issue both RSA and ECDSA certificates?\n\nYes. Cloudflare can issue both RSA and ECDSA certificates.\n\n## Certificate authorities (CAs)\n\n### Which certificate authorities does Cloudflare use?\n\nCloudflare uses Let's Encrypt, Google Trust Services, SSL.com, and Sectigo. You can see a complete list of products and available CAs and algorithms in the [certificate authorities reference page](https://developers.cloudflare.com/ssl/reference/certificate-authorities/).\n\nSectigo is only used for [backup certificates](https://developers.cloudflare.com/ssl/edge-certificates/backup-certificates/).\n\n### Are there any CA limitations I should know about?\n\nYou can find a list of limitations for every CA in our pipeline in the [certificate authorities reference page](https://developers.cloudflare.com/ssl/reference/certificate-authorities/).\n\n### What clients are supported by the CAs that Cloudflare offers?\n\nIn the [certificate authorities reference page](https://developers.cloudflare.com/ssl/reference/certificate-authorities/), you can find information about device and browser compatibility.\n\n### I do not want to use one of the CAs that Cloudflare partners with. What can I do?\n\nIf you are on a Business or Enterprise plan, you can [upload a certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate) from the CA of your choice.\n\n### What CAA records do I need in order to allow issuance from Cloudflare CAs?\n\nYou can find CAA records associated with every Cloudflare CA in the [certificate authorities reference page](https://developers.cloudflare.com/ssl/reference/certificate-authorities/#caa-records). If you are using Cloudflare as your DNS provider, then the CAA records will be added on your behalf.\n\n### I am missing the CAs that Cloudflare uses in my trust store. What should I do?\n\nYou can use Cloudflare [CFSSL trust store](https://github.com/cloudflare/cfssl_trust), which includes all of the CAs that are used by Cloudflare managed certificates.\n\n## Universal SSL\n\n### I am using Universal SSL and I would like to use a different CA. How can I do that?\n\nTo be able to specify a CA, you must purchase [Advanced Certificate Manager](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/). Through Advanced Certificate Manager, you can choose the certificate authority when ordering an advanced certificate or you can choose a default CA when using [Total TLS](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/).\n\nIf you are on a Business or Enterprise plan, you can [upload a certificate](https://developers.cloudflare.com/ssl/edge-certificates/custom-certificates/uploading/#upload-a-custom-certificate) from the CA of your choice. In this case, certificate issuance and renewal will have to be managed by you.\n\n### Does Cloudflare issue both RSA and ECDSA certificates for Universal certificates?\n\nUniversal certificates on free zones only receive an ECDSA certificate. Paid zones receive an RSA and ECDSA certificate.\n\n## Advanced Certificate Manager\n\n### How can I choose which CA will be used for my certificates?\n\nWhen [ordering an advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/), you can choose the CA through the UI or API.\n\n[Total TLS](https://developers.cloudflare.com/ssl/edge-certificates/additional-options/total-tls/) allows you to get full certificate coverage. When enabling Total TLS, you can choose the CA that will be used for all Total TLS certificates.\n\n## Renewal\n\n### Error when clicking `Approve Certificate` on a Certificate Approval renewal email\n\nThe full error message is: `An error occurred while attempting to validate your domain. Please try again later or contact support for assistance.`\n\nCheck the status of the certificate on the [Cloudflare dashboard](https://dash.cloudflare.com?to=/:account/:zone/ssl-tls). If the status is `Active`, you can disregard this email and the error message.\n\n</page>\n\n<page>\n---\ntitle: Certification Authority Authorization (CAA) FAQ · Cloudflare SSL/TLS docs\ndescription: The following page answers common questions about Certification\n  Authority Authorization (CAA) records.\nlastUpdated: 2025-08-20T18:47:44.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ssl/edge-certificates/troubleshooting/caa-records/\n  md: https://developers.cloudflare.com/ssl/edge-certificates/troubleshooting/caa-records/index.md\n---\n\nThe following page answers common questions about Certification Authority Authorization (CAA) records.\n\n***\n\n## What is CAA and how can I create one?\n\nA Certificate Authority Authorization (CAA) DNS record specifies which certificate authorities (CAs) are allowed to issue certificates for a domain. This record reduces the chance of unauthorized certificate issuance and promotes standardization across your organization.\n\n\n\nFor more details, refer to [Create CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/).\n\n***\n\n## How does Cloudflare evaluate CAA records?\n\nCAA records are evaluated by a CA, not by Cloudflare.\n\nNote\n\nSetting a CAA record to specify one or more particular CAs does not affect which CA(s) Cloudflare uses to issue a Universal or Advanced SSL certificate for your domain.\n\nYou can specify CAs associated with Cloudflare certificates when [ordering an advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/).\n\n***\n\n## What are the dangers of setting CAA records?\n\nIf you are part of a large organization or one where multiple parties are tasked with obtaining SSL certificates, [include CAA records](https://developers.cloudflare.com/ssl/edge-certificates/caa-records/) that allow issuance for all CAs applicable for your organization. Failure to do so can inadvertently block SSL issuance for other parts of your organization.\n\n***\n\n## What CAA records are added by Cloudflare?\n\nCloudflare adds CAA records automatically in the following situations:\n\n* When you have [Universal SSL](https://developers.cloudflare.com/ssl/edge-certificates/universal-ssl/) and add any CAA records to your zone.\n* When you have [advanced certificates](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/) and add any CAA records to your zone.\n\nThese records make sure Cloudflare can still issue Universal certificates on your behalf.\n\nIf Cloudflare has automatically added CAA records on your behalf, these records will not appear in the Cloudflare dashboard. However, if you run a command line query using `dig`, you can see any existing CAA records, including those added by Cloudflare (replacing `example.com` with your own domain on Cloudflare):",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "Create nested expressions",
      "id": "create-nested-expressions"
    },
    {
      "level": "h2",
      "text": "Expression validation",
      "id": "expression-validation"
    },
    {
      "level": "h2",
      "text": "GraphQL schema",
      "id": "graphql-schema"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Access and CNI",
      "id": "access-and-cni"
    },
    {
      "level": "h2",
      "text": "Data Localization Suite",
      "id": "data-localization-suite"
    },
    {
      "level": "h2",
      "text": "Load Balancing",
      "id": "load-balancing"
    },
    {
      "level": "h2",
      "text": "Spectrum",
      "id": "spectrum"
    },
    {
      "level": "h2",
      "text": "Workers",
      "id": "workers"
    },
    {
      "level": "h3",
      "text": "`fetch`",
      "id": "`fetch`"
    },
    {
      "level": "h3",
      "text": "`connect`",
      "id": "`connect`"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Common error codes",
      "id": "common-error-codes"
    },
    {
      "level": "h3",
      "text": "TCP connection failed",
      "id": "tcp-connection-failed"
    },
    {
      "level": "h3",
      "text": "HTTP timeout occurred",
      "id": "http-timeout-occurred"
    },
    {
      "level": "h3",
      "text": "Response code mismatch error",
      "id": "response-code-mismatch-error"
    },
    {
      "level": "h3",
      "text": "Response body mismatch error",
      "id": "response-body-mismatch-error"
    },
    {
      "level": "h3",
      "text": "TLS untrusted certificate error",
      "id": "tls-untrusted-certificate-error"
    },
    {
      "level": "h3",
      "text": "TLS name mismatch error",
      "id": "tls-name-mismatch-error"
    },
    {
      "level": "h3",
      "text": "TLS protocol error",
      "id": "tls-protocol-error"
    },
    {
      "level": "h3",
      "text": "TLS unrecognized name error",
      "id": "tls-unrecognized-name-error"
    },
    {
      "level": "h3",
      "text": "​​No route to host error",
      "id": "​​no-route-to-host-error"
    },
    {
      "level": "h3",
      "text": "TCP Timeout",
      "id": "tcp-timeout"
    },
    {
      "level": "h3",
      "text": "​​Network Unreachable",
      "id": "​​network-unreachable"
    },
    {
      "level": "h3",
      "text": "HTTP Invalid Response",
      "id": "http-invalid-response"
    },
    {
      "level": "h3",
      "text": "DNS Unknown Host",
      "id": "dns-unknown-host"
    },
    {
      "level": "h3",
      "text": "Connection Reset by Peer",
      "id": "connection-reset-by-peer"
    },
    {
      "level": "h3",
      "text": "Monitor Configuration Error",
      "id": "monitor-configuration-error"
    },
    {
      "level": "h3",
      "text": "​​DNS Internal",
      "id": "​​dns-internal"
    },
    {
      "level": "h3",
      "text": "Other Failure",
      "id": "other-failure"
    },
    {
      "level": "h2",
      "text": "Create and edit health checks",
      "id": "create-and-edit-health-checks"
    },
    {
      "level": "h2",
      "text": "Configure alerts",
      "id": "configure-alerts"
    },
    {
      "level": "h2",
      "text": "Bypass zone lockdown",
      "id": "bypass-zone-lockdown"
    },
    {
      "level": "h3",
      "text": "Via the API",
      "id": "via-the-api"
    },
    {
      "level": "h2",
      "text": "Compression between Cloudflare and website visitors",
      "id": "compression-between-cloudflare-and-website-visitors"
    },
    {
      "level": "h3",
      "text": "Content-Length header handling",
      "id": "content-length-header-handling"
    },
    {
      "level": "h2",
      "text": "Content compression from origin servers to the Cloudflare network",
      "id": "content-compression-from-origin-servers-to-the-cloudflare-network"
    },
    {
      "level": "h2",
      "text": "Notes about end-to-end compression",
      "id": "notes-about-end-to-end-compression"
    },
    {
      "level": "h3",
      "text": "Content recompression due to dynamic transformations",
      "id": "content-recompression-due-to-dynamic-transformations"
    },
    {
      "level": "h3",
      "text": "Content-Length header",
      "id": "content-length-header"
    },
    {
      "level": "h2",
      "text": "Compression methods by plan",
      "id": "compression-methods-by-plan"
    },
    {
      "level": "h3",
      "text": "Between visitors and Cloudflare",
      "id": "between-visitors-and-cloudflare"
    },
    {
      "level": "h3",
      "text": "Between Cloudflare and the origin server",
      "id": "between-cloudflare-and-the-origin-server"
    },
    {
      "level": "h2",
      "text": "How Cloudflare Fonts works",
      "id": "how-cloudflare-fonts-works"
    },
    {
      "level": "h3",
      "text": "Browser support",
      "id": "browser-support"
    },
    {
      "level": "h2",
      "text": "Get started",
      "id": "get-started"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h3",
      "text": "Enable Prefetch URLs",
      "id": "enable-prefetch-urls"
    },
    {
      "level": "h3",
      "text": "Choose URLs to prefetch",
      "id": "choose-urls-to-prefetch"
    },
    {
      "level": "h3",
      "text": "Prefetch files limits",
      "id": "prefetch-files-limits"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "How to",
      "id": "how-to"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h2",
      "text": "What is Speed Brain?",
      "id": "what-is-speed-brain?"
    },
    {
      "level": "h2",
      "text": "How Speed Brain works",
      "id": "how-speed-brain-works"
    },
    {
      "level": "h2",
      "text": "Test Speed Brain",
      "id": "test-speed-brain"
    },
    {
      "level": "h2",
      "text": "RUM integration",
      "id": "rum-integration"
    },
    {
      "level": "h2",
      "text": "Enable and disable Speed Brain",
      "id": "enable-and-disable-speed-brain"
    },
    {
      "level": "h2",
      "text": "Caveats",
      "id": "caveats"
    },
    {
      "level": "h2",
      "text": "Comparison",
      "id": "comparison"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Image formats compatible with Mirage",
      "id": "image-formats-compatible-with-mirage"
    },
    {
      "level": "h2",
      "text": "Enable Mirage",
      "id": "enable-mirage"
    },
    {
      "level": "h2",
      "text": "Test Mirage",
      "id": "test-mirage"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enable 0-RTT Connection Resumption",
      "id": "enable-0-rtt-connection-resumption"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h2",
      "text": "Enable Enhanced HTTP/2 Prioritization",
      "id": "enable-enhanced-http/2-prioritization"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enable HTTP/2",
      "id": "enable-http/2"
    },
    {
      "level": "h2",
      "text": "Disable HTTP/2",
      "id": "disable-http/2"
    },
    {
      "level": "h2",
      "text": "ERR\\_HTTP2\\_PROTOCOL\\_ERROR",
      "id": "err\\_http2\\_protocol\\_error"
    },
    {
      "level": "h3",
      "text": "Malformed HTTP response headers",
      "id": "malformed-http-response-headers"
    },
    {
      "level": "h3",
      "text": "Compression issues",
      "id": "compression-issues"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Disable HTTP/2 to Origin",
      "id": "disable-http/2-to-origin"
    },
    {
      "level": "h2",
      "text": "Connection multiplexing",
      "id": "connection-multiplexing"
    },
    {
      "level": "h3",
      "text": "How it works",
      "id": "how-it-works"
    },
    {
      "level": "h3",
      "text": "Benefits",
      "id": "benefits"
    },
    {
      "level": "h3",
      "text": "Default behavior by plan",
      "id": "default-behavior-by-plan"
    },
    {
      "level": "h3",
      "text": "Configuration",
      "id": "configuration"
    },
    {
      "level": "h3",
      "text": "Timeouts and error codes",
      "id": "timeouts-and-error-codes"
    },
    {
      "level": "h3",
      "text": "Common scenarios",
      "id": "common-scenarios"
    },
    {
      "level": "h3",
      "text": "FAQ",
      "id": "faq"
    },
    {
      "level": "h2",
      "text": "Protocol compatibility",
      "id": "protocol-compatibility"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enable HTTP/3",
      "id": "enable-http/3"
    },
    {
      "level": "h2",
      "text": "Create a certificate",
      "id": "create-a-certificate"
    },
    {
      "level": "h2",
      "text": "Delete a certificate",
      "id": "delete-a-certificate"
    },
    {
      "level": "h2",
      "text": "Restart validation",
      "id": "restart-validation"
    },
    {
      "level": "h2",
      "text": "Restrict cipher suites",
      "id": "restrict-cipher-suites"
    },
    {
      "level": "h2",
      "text": "Perform domain control validation (DCV)",
      "id": "perform-domain-control-validation-(dcv)"
    },
    {
      "level": "h2",
      "text": "Set up alerts",
      "id": "set-up-alerts"
    },
    {
      "level": "h2",
      "text": "Advanced certificate renewal",
      "id": "advanced-certificate-renewal"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Encrypt all visitor traffic",
      "id": "encrypt-all-visitor-traffic"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Additional details",
      "id": "additional-details"
    },
    {
      "level": "h2",
      "text": "Enable Automatic HTTPS Rewrites",
      "id": "enable-automatic-https-rewrites"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Types of CSRs",
      "id": "types-of-csrs"
    },
    {
      "level": "h2",
      "text": "Create and use a CSR",
      "id": "create-and-use-a-csr"
    },
    {
      "level": "h2",
      "text": "Renew a certificate",
      "id": "renew-a-certificate"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Opt in and out",
      "id": "opt-in-and-out"
    },
    {
      "level": "h2",
      "text": "Emails to be concerned about",
      "id": "emails-to-be-concerned-about"
    },
    {
      "level": "h2",
      "text": "How to take action",
      "id": "how-to-take-action"
    },
    {
      "level": "h3",
      "text": "Option 1: Contact certificate authorities",
      "id": "option-1:-contact-certificate-authorities"
    },
    {
      "level": "h3",
      "text": "Option 2: Contact domain registrars",
      "id": "option-2:-contact-domain-registrars"
    },
    {
      "level": "h3",
      "text": "Option 3: Improvise",
      "id": "option-3:-improvise"
    },
    {
      "level": "h2",
      "text": "HTTP Public Key Pinning",
      "id": "http-public-key-pinning"
    },
    {
      "level": "h2",
      "text": "Cipher suites and edge certificates",
      "id": "cipher-suites-and-edge-certificates"
    },
    {
      "level": "h2",
      "text": "Related SSL/TLS settings",
      "id": "related-ssl/tls-settings"
    },
    {
      "level": "h3",
      "text": "Minimum TLS Version",
      "id": "minimum-tls-version"
    },
    {
      "level": "h3",
      "text": "TLS 1.3",
      "id": "tls-1.3"
    },
    {
      "level": "h2",
      "text": "Resources",
      "id": "resources"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Requirements",
      "id": "requirements"
    },
    {
      "level": "h2",
      "text": "Enable HSTS",
      "id": "enable-hsts"
    },
    {
      "level": "h2",
      "text": "Disable HSTS",
      "id": "disable-hsts"
    },
    {
      "level": "h2",
      "text": "Configuration settings",
      "id": "configuration-settings"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "How to disable TLS 1.0",
      "id": "how-to-disable-tls-1.0"
    },
    {
      "level": "h2",
      "text": "Setup",
      "id": "setup"
    },
    {
      "level": "h3",
      "text": "Zone-level",
      "id": "zone-level"
    },
    {
      "level": "h3",
      "text": "Per-hostname",
      "id": "per-hostname"
    },
    {
      "level": "h3",
      "text": "Cloudflare for SaaS",
      "id": "cloudflare-for-saas"
    },
    {
      "level": "h2",
      "text": "Test supported TLS versions",
      "id": "test-supported-tls-versions"
    },
    {
      "level": "h2",
      "text": "What is TLS 1.3?",
      "id": "what-is-tls-1.3?"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enable TLS 1.3",
      "id": "enable-tls-1.3"
    },
    {
      "level": "h3",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Enable Opportunistic Encryption",
      "id": "enable-opportunistic-encryption"
    },
    {
      "level": "h2",
      "text": "Reference",
      "id": "reference"
    },
    {
      "level": "h2",
      "text": "Availability",
      "id": "availability"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Hostnames used with other Cloudflare products",
      "id": "hostnames-used-with-other-cloudflare-products"
    },
    {
      "level": "h3",
      "text": "Deleting certificates",
      "id": "deleting-certificates"
    },
    {
      "level": "h2",
      "text": "Where Cloudflare sits in the DCV process",
      "id": "where-cloudflare-sits-in-the-dcv-process"
    },
    {
      "level": "h2",
      "text": "Steps in the process",
      "id": "steps-in-the-process"
    },
    {
      "level": "h2",
      "text": "Aspects to consider",
      "id": "aspects-to-consider"
    },
    {
      "level": "h3",
      "text": "DCV tokens",
      "id": "dcv-tokens"
    },
    {
      "level": "h2",
      "text": "Perform DCV",
      "id": "perform-dcv"
    },
    {
      "level": "h2",
      "text": "Verify DCV status",
      "id": "verify-dcv-status"
    },
    {
      "level": "h2",
      "text": "Update DCV methods",
      "id": "update-dcv-methods"
    },
    {
      "level": "h2",
      "text": "Blocked validation URL",
      "id": "blocked-validation-url"
    },
    {
      "level": "h2",
      "text": "Redirection",
      "id": "redirection"
    },
    {
      "level": "h2",
      "text": "DNS settings and records",
      "id": "dns-settings-and-records"
    },
    {
      "level": "h2",
      "text": "CA errors",
      "id": "ca-errors"
    },
    {
      "level": "h3",
      "text": "Rate limiting",
      "id": "rate-limiting"
    },
    {
      "level": "h3",
      "text": "Multiple perspective CAA check error",
      "id": "multiple-perspective-caa-check-error"
    },
    {
      "level": "h3",
      "text": "Internal errors",
      "id": "internal-errors"
    },
    {
      "level": "h2",
      "text": "DCV tokens validity",
      "id": "dcv-tokens-validity"
    },
    {
      "level": "h2",
      "text": "Successive checks function",
      "id": "successive-checks-function"
    },
    {
      "level": "h2",
      "text": "Capped attempts reference table",
      "id": "capped-attempts-reference-table"
    },
    {
      "level": "h2",
      "text": "Intermediate and root certificates",
      "id": "intermediate-and-root-certificates"
    },
    {
      "level": "h2",
      "text": "Methodologies",
      "id": "methodologies"
    },
    {
      "level": "h3",
      "text": "Compatible",
      "id": "compatible"
    },
    {
      "level": "h3",
      "text": "Modern",
      "id": "modern"
    },
    {
      "level": "h3",
      "text": "User-defined",
      "id": "user-defined"
    },
    {
      "level": "h2",
      "text": "Renew custom certificates",
      "id": "renew-custom-certificates"
    },
    {
      "level": "h2",
      "text": "Expired certificates",
      "id": "expired-certificates"
    },
    {
      "level": "h2",
      "text": "Migrate to other certificate types",
      "id": "migrate-to-other-certificate-types"
    },
    {
      "level": "h2",
      "text": "Generic troubleshooting",
      "id": "generic-troubleshooting"
    },
    {
      "level": "h3",
      "text": "Make sure your key and certificate match",
      "id": "make-sure-your-key-and-certificate-match"
    },
    {
      "level": "h3",
      "text": "Check the certificate details",
      "id": "check-the-certificate-details"
    },
    {
      "level": "h2",
      "text": "Moved domains",
      "id": "moved-domains"
    },
    {
      "level": "h2",
      "text": "Let's Encrypt chain update",
      "id": "let's-encrypt-chain-update"
    },
    {
      "level": "h2",
      "text": "Error codes",
      "id": "error-codes"
    },
    {
      "level": "h3",
      "text": "Invalid certificate. (Code: 1002)",
      "id": "invalid-certificate.-(code:-1002)"
    },
    {
      "level": "h3",
      "text": "You have reached the maximum number of custom certificates. (Code: 1212)",
      "id": "you-have-reached-the-maximum-number-of-custom-certificates.-(code:-1212)"
    },
    {
      "level": "h3",
      "text": "This certificate has already been submitted. (Code: 1220)",
      "id": "this-certificate-has-already-been-submitted.-(code:-1220)"
    },
    {
      "level": "h3",
      "text": "The SSL attribute is invalid. Please refer to the API documentation, check your input and try again. (Code: 1434)",
      "id": "the-ssl-attribute-is-invalid.-please-refer-to-the-api-documentation,-check-your-input-and-try-again.-(code:-1434)"
    },
    {
      "level": "h3",
      "text": "You have reached your quota for the requested resource. (Code: 2005)",
      "id": "you-have-reached-your-quota-for-the-requested-resource.-(code:-2005)"
    },
    {
      "level": "h3",
      "text": "The certificate chain you uploaded cannot be bundled using Cloudflare's trust store. Please check your input and try again. (Code: 2100)",
      "id": "the-certificate-chain-you-uploaded-cannot-be-bundled-using-cloudflare's-trust-store.-please-check-your-input-and-try-again.-(code:-2100)"
    },
    {
      "level": "h3",
      "text": "The certificate chain you uploaded has no leaf certificates. Please check your input and try again. (Code: 2101)",
      "id": "the-certificate-chain-you-uploaded-has-no-leaf-certificates.-please-check-your-input-and-try-again.-(code:-2101)"
    },
    {
      "level": "h3",
      "text": "The certificate chain you uploaded does not include any hostnames from your zone. Please check your input and try again. (Code: 2103)",
      "id": "the-certificate-chain-you-uploaded-does-not-include-any-hostnames-from-your-zone.-please-check-your-input-and-try-again.-(code:-2103)"
    },
    {
      "level": "h3",
      "text": "The private key you uploaded is invalid. Please check your input and try again. (Code: 2106)",
      "id": "the-private-key-you-uploaded-is-invalid.-please-check-your-input-and-try-again.-(code:-2106)"
    },
    {
      "level": "h2",
      "text": "Certificate requirements",
      "id": "certificate-requirements"
    },
    {
      "level": "h2",
      "text": "Upload a custom certificate",
      "id": "upload-a-custom-certificate"
    },
    {
      "level": "h2",
      "text": "Update an existing custom certificate",
      "id": "update-an-existing-custom-certificate"
    },
    {
      "level": "h2",
      "text": "Delete a custom certificate",
      "id": "delete-a-custom-certificate"
    },
    {
      "level": "h2",
      "text": "Geo Key Manager v2 Beta",
      "id": "geo-key-manager-v2-beta"
    },
    {
      "level": "h3",
      "text": "Examples",
      "id": "examples"
    },
    {
      "level": "h2",
      "text": "Geo Key Manager v1",
      "id": "geo-key-manager-v1"
    },
    {
      "level": "h2",
      "text": "Available regions",
      "id": "available-regions"
    },
    {
      "level": "h2",
      "text": "Available countries",
      "id": "available-countries"
    },
    {
      "level": "h2",
      "text": "Highest security data centers",
      "id": "highest-security-data-centers"
    },
    {
      "level": "h3",
      "text": "Pre-scheduled and biometric controlled facility access",
      "id": "pre-scheduled-and-biometric-controlled-facility-access"
    },
    {
      "level": "h3",
      "text": "Private cages with biometric readers",
      "id": "private-cages-with-biometric-readers"
    },
    {
      "level": "h3",
      "text": "Exterior security controls and monitoring",
      "id": "exterior-security-controls-and-monitoring"
    },
    {
      "level": "h3",
      "text": "Interior security controls and monitoring",
      "id": "interior-security-controls-and-monitoring"
    },
    {
      "level": "h2",
      "text": "General",
      "id": "general"
    },
    {
      "level": "h3",
      "text": "Does Cloudflare issue both RSA and ECDSA certificates?",
      "id": "does-cloudflare-issue-both-rsa-and-ecdsa-certificates?"
    },
    {
      "level": "h2",
      "text": "Certificate authorities (CAs)",
      "id": "certificate-authorities-(cas)"
    },
    {
      "level": "h3",
      "text": "Which certificate authorities does Cloudflare use?",
      "id": "which-certificate-authorities-does-cloudflare-use?"
    },
    {
      "level": "h3",
      "text": "Are there any CA limitations I should know about?",
      "id": "are-there-any-ca-limitations-i-should-know-about?"
    },
    {
      "level": "h3",
      "text": "What clients are supported by the CAs that Cloudflare offers?",
      "id": "what-clients-are-supported-by-the-cas-that-cloudflare-offers?"
    },
    {
      "level": "h3",
      "text": "I do not want to use one of the CAs that Cloudflare partners with. What can I do?",
      "id": "i-do-not-want-to-use-one-of-the-cas-that-cloudflare-partners-with.-what-can-i-do?"
    },
    {
      "level": "h3",
      "text": "What CAA records do I need in order to allow issuance from Cloudflare CAs?",
      "id": "what-caa-records-do-i-need-in-order-to-allow-issuance-from-cloudflare-cas?"
    },
    {
      "level": "h3",
      "text": "I am missing the CAs that Cloudflare uses in my trust store. What should I do?",
      "id": "i-am-missing-the-cas-that-cloudflare-uses-in-my-trust-store.-what-should-i-do?"
    },
    {
      "level": "h2",
      "text": "Universal SSL",
      "id": "universal-ssl"
    },
    {
      "level": "h3",
      "text": "I am using Universal SSL and I would like to use a different CA. How can I do that?",
      "id": "i-am-using-universal-ssl-and-i-would-like-to-use-a-different-ca.-how-can-i-do-that?"
    },
    {
      "level": "h3",
      "text": "Does Cloudflare issue both RSA and ECDSA certificates for Universal certificates?",
      "id": "does-cloudflare-issue-both-rsa-and-ecdsa-certificates-for-universal-certificates?"
    },
    {
      "level": "h2",
      "text": "Advanced Certificate Manager",
      "id": "advanced-certificate-manager"
    },
    {
      "level": "h3",
      "text": "How can I choose which CA will be used for my certificates?",
      "id": "how-can-i-choose-which-ca-will-be-used-for-my-certificates?"
    },
    {
      "level": "h2",
      "text": "Renewal",
      "id": "renewal"
    },
    {
      "level": "h3",
      "text": "Error when clicking `Approve Certificate` on a Certificate Approval renewal email",
      "id": "error-when-clicking-`approve-certificate`-on-a-certificate-approval-renewal-email"
    },
    {
      "level": "h2",
      "text": "What is CAA and how can I create one?",
      "id": "what-is-caa-and-how-can-i-create-one?"
    },
    {
      "level": "h2",
      "text": "How does Cloudflare evaluate CAA records?",
      "id": "how-does-cloudflare-evaluate-caa-records?"
    },
    {
      "level": "h2",
      "text": "What are the dangers of setting CAA records?",
      "id": "what-are-the-dangers-of-setting-caa-records?"
    },
    {
      "level": "h2",
      "text": "What CAA records are added by Cloudflare?",
      "id": "what-caa-records-are-added-by-cloudflare?"
    }
  ],
  "url": "llms-txt#example-of-an-expression-with-a-\"-character-written-using-the-raw-string-syntax",
  "links": []
}