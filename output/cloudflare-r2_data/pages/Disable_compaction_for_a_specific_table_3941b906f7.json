{
  "title": "Disable compaction for a specific table",
  "content": "npx wrangler r2 bucket catalog compaction disable my-bucket my-namespace my-table\nbash",
  "code_samples": [
    {
      "code": "For more details on managing compaction, refer to [Manage catalogs](https://developers.cloudflare.com/r2/data-catalog/manage-catalogs/).\n\n### Choose the right target file size\n\nYou can configure the target file size for compaction. Currently, the minimum is 64 MB and the maximum is 512 MB.\n\nDifferent compute engines have different optimal file sizes, so check their documentation.\n\nPerformance tradeoffs depend on your use case. For example, queries that return small amounts of data may perform better with smaller files, as larger files could result in reading unnecessary data.\n\n* For workloads that are more latency sensitive, consider a smaller target file size (for example, 64 MB - 128 MB)\n* For streaming ingest workloads, consider medium file sizes (for example, 128 MB - 256 MB)\n* For OLAP style queries that need to scan a lot of data, consider larger file sizes (for example, 256 MB - 512 MB)\n\n## Why do I need snapshot expiration?\n\nEvery write to an Iceberg table—whether an insert, update, or delete—creates a new snapshot. Over time, these snapshots can accumulate and cause performance issues:\n\n* **Metadata overhead**: Each snapshot adds entries to the table's metadata files. As the number of snapshots grows, metadata files become larger, slowing down query planning and table operations\n* **Increased storage costs**: Old snapshots reference data files that may no longer be needed, preventing them from being cleaned up and consuming unnecessary storage\n* **Slower table operations**: Operations like listing snapshots or accessing table history become slower over time\n\n## R2 Data Catalog automatic snapshot expiration\n\n### Configure snapshot expiration\n\nSnapshot expiration uses two parameters to determine which snapshots to remove:\n\n* `--older-than-days`: Remove snapshots older than this many days (default: 30 days)\n* `--retain-last`: Always keep this minimum number of recent snapshots (default: 5 snapshots)\n\nBoth conditions must be met for a snapshot to be expired. This ensures you always retain recent snapshots even if they are older than the age threshold.\n\n### Examples",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h3",
      "text": "Choose the right target file size",
      "id": "choose-the-right-target-file-size"
    },
    {
      "level": "h2",
      "text": "Why do I need snapshot expiration?",
      "id": "why-do-i-need-snapshot-expiration?"
    },
    {
      "level": "h2",
      "text": "R2 Data Catalog automatic snapshot expiration",
      "id": "r2-data-catalog-automatic-snapshot-expiration"
    },
    {
      "level": "h3",
      "text": "Configure snapshot expiration",
      "id": "configure-snapshot-expiration"
    },
    {
      "level": "h3",
      "text": "Examples",
      "id": "examples"
    }
  ],
  "url": "llms-txt#disable-compaction-for-a-specific-table",
  "links": []
}