{
  "title": "Create an Iceberg table",
  "content": "test_table = (\"default\", \"my_table\")\ntable = catalog.create_table(\n    test_table,\n    schema=df.schema,\n)\nsql\n-- Install the iceberg DuckDB extension (if you haven't already) and load the extension.\nINSTALL iceberg;\nLOAD iceberg;\n\n-- Install and load httpfs extension for reading/writing files over HTTP(S).\nINSTALL httpfs;\nLOAD httpfs;\n\n-- Create a DuckDB secret to store R2 Data Catalog credentials.\nCREATE SECRET r2_secret (\n    TYPE ICEBERG,\n    TOKEN '<token>'\n);\n\n-- Attach R2 Data Catalog with the following ATTACH statement.\nATTACH '<warehouse_name>' AS my_r2_catalog (\n    TYPE ICEBERG,\n    ENDPOINT '<catalog_uri>'\n);\n\n-- Create the default schema in the catalog and set it as the active schema.\nCREATE SCHEMA my_r2_catalog.default;\nUSE my_r2_catalog.default;\n\n-- Create and populate a sample Iceberg table with data.\nCREATE TABLE my_iceberg_table AS SELECT a FROM range(4) t(a);\n\n-- Show all available tables.\nSHOW ALL TABLES;\n\n-- Query the Iceberg table you just created.\nSELECT * FROM my_r2_catalog.default.my_iceberg_table;\nsql\n-- Create a database (if you don't already have one) to organize your external data\nCREATE DATABASE IF NOT EXISTS r2_example_db;\n\n-- Create an external volume pointing to your R2 bucket\nCREATE OR REPLACE EXTERNAL VOLUME ext_vol_r2\n    STORAGE_LOCATIONS = (\n        (\n            NAME = 'my_r2_storage_location'\n            STORAGE_PROVIDER = 'S3COMPAT'\n            STORAGE_BASE_URL = 's3compat://<bucket-name>'\n            CREDENTIALS = (\n                AWS_KEY_ID = '<access_key>'\n                AWS_SECRET_KEY = '<secret_access_key>'\n            )\n            STORAGE_ENDPOINT = '<account_id>.r2.cloudflarestorage.com'\n        )\n    )\n    ALLOW_WRITES = FALSE;\n\n-- Create a catalog integration for R2 Data Catalog (read-only)\nCREATE OR REPLACE CATALOG INTEGRATION r2_data_catalog\n    CATALOG_SOURCE = ICEBERG_REST\n    TABLE_FORMAT = ICEBERG\n    CATALOG_NAMESPACE = 'default'\n    REST_CONFIG = (\n        CATALOG_URI = '<catalog_uri>'\n        CATALOG_NAME = '<warehouse_name>'\n    )\n    REST_AUTHENTICATION = (\n        TYPE = BEARER\n        BEARER_TOKEN = '<token>'\n    )\n    ENABLED = TRUE;\n\n-- Create an Apache Iceberg table in your selected Snowflake database\nCREATE ICEBERG TABLE my_iceberg_table\n    CATALOG = 'r2_data_catalog'\n    EXTERNAL_VOLUME = 'ext_vol_r2'\n    CATALOG_TABLE_NAME = 'my_table';  -- Name of existing table in your R2 data catalog\n\n-- Query your Iceberg table\nSELECT * FROM my_iceberg_table;\npy\nfrom pyspark.sql import SparkSession",
  "code_samples": [
    {
      "code": "</page>\n\n<page>\n---\ntitle: DuckDB · Cloudflare R2 docs\ndescription: Below is an example of using DuckDB to connect to R2 Data Catalog.\n  For more information on connecting to R2 Data Catalog with DuckDB, refer to\n  DuckDB documentation.\nlastUpdated: 2025-09-30T22:06:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/r2/data-catalog/config-examples/duckdb/\n  md: https://developers.cloudflare.com/r2/data-catalog/config-examples/duckdb/index.md\n---\n\nBelow is an example of using [DuckDB](https://duckdb.org/) to connect to R2 Data Catalog. For more information on connecting to R2 Data Catalog with DuckDB, refer to [DuckDB documentation](https://duckdb.org/docs/stable/core_extensions/iceberg/iceberg_rest_catalogs#r2-catalog).\n\n## Prerequisites\n\n* Sign up for a [Cloudflare account](https://dash.cloudflare.com/sign-up/workers-and-pages).\n* [Create an R2 bucket](https://developers.cloudflare.com/r2/buckets/create-buckets/) and [enable the data catalog](https://developers.cloudflare.com/r2/data-catalog/manage-catalogs/#enable-r2-data-catalog-on-a-bucket).\n* [Create an R2 API token](https://developers.cloudflare.com/r2/api/tokens/) with both [R2 and data catalog permissions](https://developers.cloudflare.com/r2/api/tokens/#permissions).\n* Install [DuckDB](https://duckdb.org/docs/installation/).\n  * Note: [DuckDB 1.4.0](https://github.com/duckdb/duckdb/releases/tag/v1.4.0) or greater is required to attach and write to [Iceberg REST Catalogs](https://duckdb.org/docs/stable/core_extensions/iceberg/iceberg_rest_catalogs).\n\n## Example usage\n\nIn the [DuckDB CLI](https://duckdb.org/docs/stable/clients/cli/overview.html) (Command Line Interface), run the following commands:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Snowflake · Cloudflare R2 docs\ndescription: Below is an example of using Snowflake to connect and query data\n  from R2 Data Catalog (read-only).\nlastUpdated: 2025-04-09T22:46:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/r2/data-catalog/config-examples/snowflake/\n  md: https://developers.cloudflare.com/r2/data-catalog/config-examples/snowflake/index.md\n---\n\nBelow is an example of using [Snowflake](https://docs.snowflake.com/en/user-guide/tables-iceberg-configure-catalog-integration-rest) to connect and query data from R2 Data Catalog (read-only).\n\n## Prerequisites\n\n* Sign up for a [Cloudflare account](https://dash.cloudflare.com/sign-up/workers-and-pages).\n* [Create an R2 bucket](https://developers.cloudflare.com/r2/buckets/create-buckets/) and [enable the data catalog](https://developers.cloudflare.com/r2/data-catalog/manage-catalogs/#enable-r2-data-catalog-on-a-bucket).\n* [Create an R2 API token](https://developers.cloudflare.com/r2/api/tokens/) with both [R2 and data catalog permissions](https://developers.cloudflare.com/r2/api/tokens/#permissions).\n* A [Snowflake](https://www.snowflake.com/) account with the necessary privileges to create external volumes and catalog integrations.\n\n## Example usage\n\nIn your Snowflake [SQL worksheet](https://docs.snowflake.com/en/user-guide/ui-snowsight-worksheets-gs) or [notebook](https://docs.snowflake.com/en/user-guide/ui-snowsight/notebooks), run the following commands:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Spark (PySpark) · Cloudflare R2 docs\ndescription: Below is an example of using PySpark to connect to R2 Data Catalog.\nlastUpdated: 2025-04-09T22:46:56.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/r2/data-catalog/config-examples/spark-python/\n  md: https://developers.cloudflare.com/r2/data-catalog/config-examples/spark-python/index.md\n---\n\nBelow is an example of using [PySpark](https://spark.apache.org/docs/latest/api/python/index.html) to connect to R2 Data Catalog.\n\n## Prerequisites\n\n* Sign up for a [Cloudflare account](https://dash.cloudflare.com/sign-up/workers-and-pages).\n* [Create an R2 bucket](https://developers.cloudflare.com/r2/buckets/create-buckets/) and [enable the data catalog](https://developers.cloudflare.com/r2/data-catalog/manage-catalogs/#enable-r2-data-catalog-on-a-bucket).\n* [Create an R2 API token](https://developers.cloudflare.com/r2/api/tokens/) with both [R2 and data catalog permissions](https://developers.cloudflare.com/r2/api/tokens/#permissions).\n* Install the [PySpark](https://spark.apache.org/docs/latest/api/python/getting_started/install.html) library.\n\n## Example usage",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Example usage",
      "id": "example-usage"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Example usage",
      "id": "example-usage"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Example usage",
      "id": "example-usage"
    }
  ],
  "url": "llms-txt#create-an-iceberg-table",
  "links": []
}