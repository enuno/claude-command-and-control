{
  "title": "Data Verification (/learn/gateways/data-verification)",
  "content": "AR.IO gateways continuously verify that data chunks are correctly stored and retrievable from Arweave. This ensures users receive authentic, uncorrupted data with cryptographic proof of integrity. The verification system is what makes AR.IO gateways trustworthy data providers for the permaweb.\n\n## How Gateways Verify Data\n\nData verification is an ongoing process that uses Merkle tree cryptography to provide mathematical proof of data integrity. The process involves multiple specialized components working together to ensure cached data matches what's stored on Arweave:\n\n**The Verification Workflow:**\n\nGateways achieve verification through a systematic five-phase process orchestrated by the DataVerificationWorker. This process ensures that every piece of cached data cryptographically matches its original form on Arweave, providing mathematical proof of integrity before serving data to users.\n\n**1. Discovery Phase**\n- Periodically scan for unverified data items\n- Priority-based queue management (higher priority items first)\n- Track retry attempts for failed verifications\n\n**2. Data Retrieval**\n- Fetch data attributes from gateway storage\n- Retrieve the complete data stream\n- Gather metadata needed for verification\n\n**3. Cryptographic Computation**\n- Calculate Merkle data root from actual data stream\n- Generate cryptographic proofs using the same algorithm as Arweave\n- Create verifiable hash chains\n\n**4. Root Comparison**\n- Compare computed root against indexed root in database\n- Verify data hasn't been corrupted or altered\n- Validate chunk integrity against Merkle proofs\n\n**5. Action Based on Results**\n- **Success**: Mark data as verified with timestamp\n- **Failure**: Trigger re-import from Arweave or unbundle from parent\n- **Error**: Increment retry counter and requeue for later\n\n## Verification Types\n\nAR.IO gateways handle different types of data verification based on the data's origin:\n\n### Transaction Data Verification\nFor individual Arweave transactions:\n- **Direct root validation** against transaction data roots stored on-chain\n- **Complete data reconstruction** from chunks to ensure availability\n- **Cryptographic proof** that data matches what was originally stored\n\n### Bundle Data Verification\nFor ANS-104 data bundles (collections of data items):\n- **Bundle integrity checks** to verify the container is valid\n- **Individual item verification** within each bundle\n- **Recursive unbundling** when verification fails to re-extract items\n- **Nested bundle support** for bundles containing other bundles\n\n### Chunk-Level Validation\nAt the most granular level:\n- **Merkle proof validation** for individual data chunks\n- **Sequential integrity** ensuring chunks form complete data\n- **Parallel verification** of multiple chunks for performance\n\n## Why Verification Matters\n\n### Cryptographic Trust Foundation\n- **Mathematical Proof**: Merkle tree cryptography provides irrefutable proof of data integrity\n- **Independent Validation**: Multiple gateways verify the same data independently\n- **Network Consensus**: Distributed verification creates trust without central authority\n\n### Data Integrity Guarantees\n- **Tamper Detection**: Any alteration to data is immediately detectable\n- **Corruption Recovery**: Automatic healing of corrupted data through re-import\n- **Permanent Storage Validation**: Ensures Arweave's permanence promise is maintained\n\n### Gateway Reliability\n- **Continuous Monitoring**: Ongoing verification catches issues before users encounter them\n- **Self-Healing System**: Automatic recovery mechanisms maintain data availability\n- **Transparent Operations**: Verification status and timestamps provide audit trails\n\n## Explore Gateway Systems\n\n}\n  />\n  }\n  />\n  }\n  />\n  }\n  />",
  "code_samples": [
    {
      "code": "sequenceDiagram\n    participant Scheduler\n    participant Worker as DataVerificationWorker\n    participant ContigIndex as ContiguousDataIndex\n    participant RootTxIndex as DataItemRootTxIndex\n    participant DataRootComp as DataRootComputer\n    participant DataSource as ContiguousDataSource\n    participant Importer as DataImporter\n    participant Bundler as BundleQueue\n\n    Note over Scheduler,Bundler: Data Discovery Phase\n    Scheduler->>Worker: Triggers queueRootTx() periodically\n    Worker->>ContigIndex: getVerifiableDataIds()\n    ContigIndex-->>Worker: Returns list of data IDs\n    \n    loop For each dataId\n        Worker->>RootTxIndex: getRootTxId(dataId)\n        RootTxIndex-->>Worker: Returns rootTxId\n        Worker->>Worker: Enqueue rootTxId if not processed\n    end\n\n    Note over Scheduler,Bundler: Verification Phase\n    Worker->>ContigIndex: getDataAttributes(rootTxId)\n    ContigIndex-->>Worker: Returns attributes (indexedDataRoot, hash)\n\n    alt indexedDataRoot is present\n        Worker->>DataRootComp: computeDataRoot(rootTxId)\n        DataRootComp->>DataSource: getData(rootTxId)\n        DataSource-->>DataRootComp: Returns data stream\n        DataRootComp-->>Worker: Returns computedDataRoot\n\n        alt computedDataRoot matches indexedDataRoot\n            Worker->>ContigIndex: saveVerificationStatus(rootTxId)\n            ContigIndex-->>Worker: âœ“ Verification Success\n            Note over Worker: Data is now verified and cached for serving\n        else computedDataRoot does NOT match\n            Worker->>Importer: queueItem({id: rootTxId}, priority=true)\n            Importer-->>Worker: Queued for re-import from Arweave\n        end\n    else indexedDataRoot is MISSING\n        Worker->>Bundler: queueBundle({id: rootTxId})\n        Bundler-->>Worker: Queued for bundle unbundling\n    end",
      "language": "mermaid"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "How Gateways Verify Data",
      "id": "how-gateways-verify-data"
    },
    {
      "level": "h2",
      "text": "Verification Types",
      "id": "verification-types"
    },
    {
      "level": "h3",
      "text": "Transaction Data Verification",
      "id": "transaction-data-verification"
    },
    {
      "level": "h3",
      "text": "Bundle Data Verification",
      "id": "bundle-data-verification"
    },
    {
      "level": "h3",
      "text": "Chunk-Level Validation",
      "id": "chunk-level-validation"
    },
    {
      "level": "h2",
      "text": "Why Verification Matters",
      "id": "why-verification-matters"
    },
    {
      "level": "h3",
      "text": "Cryptographic Trust Foundation",
      "id": "cryptographic-trust-foundation"
    },
    {
      "level": "h3",
      "text": "Data Integrity Guarantees",
      "id": "data-integrity-guarantees"
    },
    {
      "level": "h3",
      "text": "Gateway Reliability",
      "id": "gateway-reliability"
    },
    {
      "level": "h2",
      "text": "Explore Gateway Systems",
      "id": "explore-gateway-systems"
    }
  ],
  "url": "llms-txt#data-verification-(/learn/gateways/data-verification)",
  "links": []
}