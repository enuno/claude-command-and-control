{
  "title": "Automating SSL Certificate Renewal (/build/run-a-gateway/manage/ssl-certs)",
  "content": "Secure your AR.IO Gateway with automated SSL certificate renewal using Certbot and DNS challenge validation. This guide covers setup for different DNS providers to automatically renew certificates without manual intervention.\n\nUsing DNS challenge validation with Certbot allows you to:\n- Automatically renew SSL certificates\n- Support wildcard certificates\n- Avoid manual certificate management\n- Ensure continuous gateway security\n\n- A running AR.IO Gateway\n- Domain name configured with your DNS provider\n- Administrative access to your server\n- API access to your DNS provider\n\n## DNS Provider Setup\n\n### Cloudflare Configuration\n\n### Create Cloudflare API Token\n\nNavigate to **Cloudflare → My Profile → API Tokens → Create Token**\n\nConfigure the token with these permissions:\n- **Zone → Zone → Read**\n- **Zone → DNS → Edit**\n\n![Cloudflare API Token Configuration](https://arweave.net/GMzqNXNCQMSLqyt7SV7FrGOgCuGBeaO5qjRWibFkVBE)\n\n### Install Certbot and Cloudflare Plugin\n\n### Configure API Credentials\n\nCreate the credentials file:\n\n### Generate SSL Certificate\n\nRequest the certificate with wildcard support:\n\n### Test Automatic Renewal\n\nPerform a dry run to validate the renewal process:\n\n### Verify Automatic Renewal Timer\n\nCheck that the certbot timer is active:\n\n### Namecheap Configuration\n\n**API Requirements:** Namecheap requires specific conditions to create API keys:\n- At least 20 domains under your account\n- Minimum $50 account balance\n- At least $50 spent within the last 2 years\n\nIf you don't meet these requirements, contact Namecheap support for a waiver.\n\n### Create Namecheap API Key\n\nNavigate to **Namecheap → Profile → Tools → Manage API Access Keys**\n\nCreate your API credentials and note:\n- Your username\n- Your API key\n\n### Install Certbot and Dependencies\n\nInstall the Namecheap DNS plugin:\n\n### Configure API Credentials\n\nCreate the credentials file:\n\nAdd your API credentials:\n\n### Generate SSL Certificate\n\nRequest the certificate with wildcard support:\n\n### Test Automatic Renewal\n\nPerform a dry run to validate the renewal process:\n\n### Verify Automatic Renewal Timer\n\nCheck that the certbot timer is active:\n\n## Post-Installation Steps\n\nAfter successfully setting up automatic SSL renewal:\n\n### Update Gateway Configuration\n\nConfigure your AR.IO Gateway to use the new certificates. Update your gateway's SSL configuration to point to:\n- **Certificate:** `/etc/letsencrypt/live/your-domain.com/fullchain.pem`\n- **Private Key:** `/etc/letsencrypt/live/your-domain.com/privkey.pem`\n\n### Reload Web Server (Optional)\n\nIf you're using nginx or another web server, reload it to apply the new certificates:\n\n### Monitor Renewal Process\n\nCertbot automatically sets up a systemd timer for renewal. Certificates will be renewed when they have 30 days or less remaining.\n\nTo manually check renewal status:\n\n- **DNS propagation delays:** Wait 5-10 minutes for DNS changes to propagate\n- **API rate limits:** Check your DNS provider's API rate limits\n- **Permission errors:** Ensure credential files have correct permissions (600)\n\n### Logs and Debugging\n\nCheck certbot logs for detailed error information:\n\nWith SSL certificates automated, consider:\n- [Setting up monitoring](/build/extensions/grafana) to track certificate expiration\n- [Configuring gateway filters](/build/run-a-gateway/manage/filters) for optimal performance\n- [Implementing content moderation](/build/run-a-gateway/manage/content-moderation) policies",
  "code_samples": [
    {
      "code": "apt update\napt install certbot python3-certbot-dns-cloudflare -y",
      "language": "bash"
    },
    {
      "code": "nano /etc/letsencrypt/cloudflare.ini",
      "language": "bash"
    },
    {
      "code": "dns_cloudflare_api_token = your_api_token_here",
      "language": "ini"
    },
    {
      "code": "chmod 600 /etc/letsencrypt/cloudflare.ini",
      "language": "bash"
    },
    {
      "code": "certbot certonly --dns-cloudflare \\\n  --dns-cloudflare-credentials /etc/letsencrypt/cloudflare.ini \\\n  -d example.com -d *.example.com",
      "language": "bash"
    },
    {
      "code": "Successfully received certificate.\nCertificate is saved at: /etc/letsencrypt/live/example.com/fullchain.pem\nKey is saved at: /etc/letsencrypt/live/example.com/privkey.pem",
      "language": "bash"
    },
    {
      "code": "certbot renew --dry-run",
      "language": "bash"
    },
    {
      "code": "Saving debug log to /var/log/letsencrypt/letsencrypt.log\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nProcessing /etc/letsencrypt/renewal/example.com.conf\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nAccount registered.\nSimulating renewal of an existing certificate for example.com and *.example.com\nWaiting 10 seconds for DNS changes to propagate\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nCongratulations, all simulated renewals succeeded:\n  /etc/letsencrypt/live/example.com/fullchain.pem (success)",
      "language": "bash"
    },
    {
      "code": "systemctl list-timers | grep certbot",
      "language": "bash"
    },
    {
      "code": "Tue 2024-11-05 02:22:10 UTC  3h 21min  Mon 2024-11-04 17:16:51 UTC  5h 43min ago  certbot.timer  certbot.service",
      "language": "bash"
    },
    {
      "code": "apt update\napt install certbot python3-pip -y",
      "language": "bash"
    },
    {
      "code": "pip install certbot-dns-namecheap",
      "language": "bash"
    },
    {
      "code": "nano /etc/letsencrypt/namecheap.ini",
      "language": "bash"
    },
    {
      "code": "dns_namecheap_username = your_username\ndns_namecheap_api_key = your_api_key",
      "language": "ini"
    },
    {
      "code": "chmod 600 /etc/letsencrypt/namecheap.ini",
      "language": "bash"
    },
    {
      "code": "certbot certonly --dns-namecheap \\\n  --dns-namecheap-credentials /etc/letsencrypt/namecheap.ini \\\n  -d example.com -d *.example.com",
      "language": "bash"
    },
    {
      "code": "Successfully received certificate.\nCertificate is saved at: /etc/letsencrypt/live/example.com/fullchain.pem\nKey is saved at: /etc/letsencrypt/live/example.com/privkey.pem",
      "language": "bash"
    },
    {
      "code": "certbot renew --dry-run",
      "language": "bash"
    },
    {
      "code": "Saving debug log to /var/log/letsencrypt/letsencrypt.log\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nProcessing /etc/letsencrypt/renewal/example.com.conf\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nAccount registered.\nSimulating renewal of an existing certificate for example.com and *.example.com\nWaiting 10 seconds for DNS changes to propagate\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\nCongratulations, all simulated renewals succeeded:\n  /etc/letsencrypt/live/example.com/fullchain.pem (success)",
      "language": "bash"
    },
    {
      "code": "systemctl list-timers | grep certbot",
      "language": "bash"
    },
    {
      "code": "Tue 2024-11-05 02:22:10 UTC  3h 21min  Mon 2024-11-04 17:16:51 UTC  5h 43min ago  certbot.timer  certbot.service",
      "language": "bash"
    },
    {
      "code": "systemctl reload nginx",
      "language": "bash"
    },
    {
      "code": "certbot certificates",
      "language": "bash"
    },
    {
      "code": "tail -f /var/log/letsencrypt/letsencrypt.log",
      "language": "bash"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Overview",
      "id": "overview"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "DNS Provider Setup",
      "id": "dns-provider-setup"
    },
    {
      "level": "h3",
      "text": "Cloudflare Configuration",
      "id": "cloudflare-configuration"
    },
    {
      "level": "h3",
      "text": "Create Cloudflare API Token",
      "id": "create-cloudflare-api-token"
    },
    {
      "level": "h3",
      "text": "Install Certbot and Cloudflare Plugin",
      "id": "install-certbot-and-cloudflare-plugin"
    },
    {
      "level": "h3",
      "text": "Configure API Credentials",
      "id": "configure-api-credentials"
    },
    {
      "level": "h3",
      "text": "Generate SSL Certificate",
      "id": "generate-ssl-certificate"
    },
    {
      "level": "h3",
      "text": "Test Automatic Renewal",
      "id": "test-automatic-renewal"
    },
    {
      "level": "h3",
      "text": "Verify Automatic Renewal Timer",
      "id": "verify-automatic-renewal-timer"
    },
    {
      "level": "h3",
      "text": "Namecheap Configuration",
      "id": "namecheap-configuration"
    },
    {
      "level": "h3",
      "text": "Create Namecheap API Key",
      "id": "create-namecheap-api-key"
    },
    {
      "level": "h3",
      "text": "Install Certbot and Dependencies",
      "id": "install-certbot-and-dependencies"
    },
    {
      "level": "h3",
      "text": "Configure API Credentials",
      "id": "configure-api-credentials"
    },
    {
      "level": "h3",
      "text": "Generate SSL Certificate",
      "id": "generate-ssl-certificate"
    },
    {
      "level": "h3",
      "text": "Test Automatic Renewal",
      "id": "test-automatic-renewal"
    },
    {
      "level": "h3",
      "text": "Verify Automatic Renewal Timer",
      "id": "verify-automatic-renewal-timer"
    },
    {
      "level": "h2",
      "text": "Post-Installation Steps",
      "id": "post-installation-steps"
    },
    {
      "level": "h3",
      "text": "Update Gateway Configuration",
      "id": "update-gateway-configuration"
    },
    {
      "level": "h3",
      "text": "Reload Web Server (Optional)",
      "id": "reload-web-server-(optional)"
    },
    {
      "level": "h3",
      "text": "Monitor Renewal Process",
      "id": "monitor-renewal-process"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "Common Issues",
      "id": "common-issues"
    },
    {
      "level": "h3",
      "text": "Logs and Debugging",
      "id": "logs-and-debugging"
    },
    {
      "level": "h2",
      "text": "Next Steps",
      "id": "next-steps"
    }
  ],
  "url": "llms-txt#automating-ssl-certificate-renewal-(/build/run-a-gateway/manage/ssl-certs)",
  "links": []
}