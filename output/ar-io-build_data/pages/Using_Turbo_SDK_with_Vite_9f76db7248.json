{
  "title": "Using Turbo SDK with Vite",
  "content": "**Firefox Compatibility**: Some compatibility issues have been reported with\n  the Turbo SDK in Firefox browsers. At this time the below framework examples\n  may not behave as expected in Firefox.\n\nThis guide demonstrates how to configure the `@ardrive/turbo-sdk` in a Vite application with proper polyfills for client-side usage. Vite provides excellent support for modern JavaScript features and can be easily configured to work with the Turbo SDK through plugins.\n\n**Polyfills**: Vite simplifies polyfill management compared to other bundlers.\n  The `vite-plugin-node-polyfills` plugin handles most of the complexity\n  automatically.\n\n- Vite 5+\n- Node.js 18+\n- React 18+ (or your preferred framework)\n- Basic familiarity with Vite configuration\n\nInstall the main Turbo SDK package:\n\nAdd the Vite node polyfills plugin for browser compatibility:\n\n**Wallet Integration Dependencies**: The Turbo SDK includes\n      `@dha-team/arbundles` as a peer dependency, which provides the necessary\n      signers for browser wallet integration (like `InjectedEthereumSigner` and\n      `ArconnectSigner`). You can import these directly without additional\n      installation.\n\nAdd React and TypeScript dependencies (if using React):\n\nCreate or update your `vite.config.js` file:\n\nIf you're using TypeScript, update your `tsconfig.json`:\n\n**TypeScript Wallet Types**\n\nCreate a `types/wallet.d.ts` file to properly type wallet objects:\n\nSelect between MetaMask or Wander wallet integration:\n\n**Never expose private keys in browser applications!** Always use browser\n      wallet integrations for security.\n\nCreate a React component for MetaMask wallet integration:\n\nCreate a React component for Wander wallet integration:\n\nHere's a complete `package.json` example for a Vite + React + Turbo SDK project:\n\n## Common Issues and Solutions\n\n1. **\"global is not defined\"**\n   - Ensure you have `global: 'globalThis'` in your Vite config's `define` section\n\n2. **Buffer polyfill issues**\n   - Make sure `vite-plugin-node-polyfills` is properly configured with Buffer globals\n   - Add the buffer path mapping in your `tsconfig.json`\n\n3. **Module resolution errors**\n   - Use `moduleResolution: \"Bundler\"` in TypeScript configuration\n   - Ensure you're importing from `@ardrive/turbo-sdk/web` for browser usage\n\n1. **\"process is not defined\"**\n   - Enable process globals in the node polyfills plugin configuration\n\n2. **Wallet integration errors**\n   - For MetaMask, use `InjectedEthereumSigner` from `@dha-team/arbundles`\n   - For Wander wallet, use `ArconnectSigner` from the Turbo SDK\n   - Always check wallet availability before attempting connection\n\n### Development Experience\n\n1. **Hot reload issues with wallet connections**\n   - Wallet state may not persist across hot reloads\n   - Consider using localStorage to persist connection state\n\n2. **Console warnings about dependencies**\n   - Some peer dependency warnings are normal for wallet libraries\n   - Focus on runtime functionality rather than dependency warnings\n\n1. **Development vs Production**\n   - Use debug logs during development: `TurboFactory.setLogLevel('debug')`\n   - Remove debug logs in production builds\n\n2. **Error Handling**\n   - Always wrap wallet operations in try-catch blocks\n   - Provide meaningful error messages to users\n   - Log detailed error information for debugging\n\n3. **Performance**\n   - Initialize Turbo clients once and reuse them\n   - Consider lazy loading wallet integration components\n   - Use loading states for better user experience\n\n4. **Security**\n   - Never expose private keys in browser applications\n   - Always validate wallet connections before operations\n   - Use secure wallet connection methods in production\n\n## Production Deployment Checklist\n\nFor production builds:\n\n1. **Build optimization**\n   - Vite automatically optimizes builds with tree shaking\n   - Polyfills are only included when needed\n\n2. **Testing**\n   - Test wallet connections across different browsers\n   - Verify polyfills work in production builds\n   - Test with actual wallet extensions\n\n3. **Monitoring**\n   - Monitor bundle sizes to ensure polyfills don't bloat your app\n   - Set up error tracking for wallet connection failures\n\n## Implementation Verification\n\nTo verify your Vite setup is working correctly:\n\n1. **Check Development Server**: Start your dev server and verify no polyfill errors\n2. **Test Wallet Connections**: Ensure both MetaMask and Wander wallet integrations work\n3. **Build Verification**: Run `npm run build` and check for any build errors\n4. **Bundle Analysis**: Use `vite-bundle-analyzer` to inspect your bundle size\n\n## Additional Resources\n\n- [Vite Documentation](https://vitejs.dev/)\n- [vite-plugin-node-polyfills](https://www.npmjs.com/package/vite-plugin-node-polyfills)\n- [Turbo SDK Documentation](https://docs.ardrive.io)\n- [Web Usage Examples](https://docs.ardrive.io)\n- [ArDrive Examples Repository](https://github.com/ardriveio/turbo-sdk)\n\nFor more examples and advanced usage patterns, refer to the [Turbo SDK examples directory](https://github.com/ardriveio/turbo-sdk) or the main [SDK documentation](https://docs.ardrive.io).",
  "code_samples": [
    {
      "code": "npm install @ardrive/turbo-sdk",
      "language": "bash"
    },
    {
      "code": "npm install --save-dev vite-plugin-node-polyfills",
      "language": "bash"
    },
    {
      "code": "npm install react react-dom\n    npm install --save-dev @vitejs/plugin-react @types/react @types/react-dom",
      "language": "bash"
    },
    {
      "code": "base: \"/\",\n      plugins: [\n        react(),\n        nodePolyfills({\n          // Enable specific polyfills for Turbo SDK requirements\n          include: [\"crypto\", \"stream\", \"buffer\", \"process\"],\n          globals: {\n            Buffer: true,\n            global: true,\n            process: true,\n          },\n        }),\n      ],\n      define: {\n        // Define globals for browser compatibility\n        global: \"globalThis\",\n      },\n    });",
      "language": "javascript"
    },
    {
      "code": "{\n      \"compilerOptions\": {\n        \"target\": \"ESNext\",\n        \"lib\": [\"DOM\", \"DOM.Iterable\", \"ESNext\"],\n        \"allowJs\": true,\n        \"skipLibCheck\": true,\n        \"esModuleInterop\": true,\n        \"allowSyntheticDefaultImports\": true,\n        \"strict\": true,\n        \"forceConsistentCasingInFileNames\": true,\n        \"module\": \"ESNext\",\n        \"moduleResolution\": \"Bundler\",\n        \"isolatedModules\": true,\n        \"jsx\": \"react-jsx\",\n        \"paths\": {\n          \"buffer/\": [\"./node_modules/vite-plugin-node-polyfills/shims/buffer\"]\n        }\n      },\n      \"include\": [\"src\"]\n    }",
      "language": "json"
    },
    {
      "code": "// types/wallet.d.ts\n    interface Window {\n      ethereum?: {\n        request: (args: { method: string; params?: any[] }) => Promise;\n        on?: (event: string, handler: (...args: any[]) => void) => void;\n        removeListener?: (event: string, handler: (...args: any[]) => void) => void;\n        isMetaMask?: boolean;\n      };\n      arweaveWallet?: {\n        connect: (permissions: string[]) => Promise;\n        disconnect: () => Promise;\n        getActiveAddress: () => Promise;\n        getPermissions: () => Promise;\n        sign: (transaction: any) => Promise;\n        getPublicKey: () => Promise;\n      };\n    }",
      "language": "typescript"
    },
    {
      "code": "const [connected, setConnected] = useState(false);\n      const [address, setAddress] = useState(\"\");\n      const [uploading, setUploading] = useState(false);\n      const [uploadResult, setUploadResult] = useState(null);\n\n      const connectMetaMask = useCallback(async () => {\n        try {\n          if (!window.ethereum) {\n            alert(\"MetaMask is not installed!\");\n            return;\n          }\n\n          // Request account access\n          await window.ethereum.request({\n            method: \"eth_requestAccounts\",\n          });\n\n          // Get the current account\n          const accounts = await window.ethereum.request({\n            method: \"eth_accounts\",\n          });\n\n          if (accounts.length > 0) {\n            setAddress(accounts[0]);\n            setConnected(true);\n\n            // Log current chain for debugging\n            const chainId = await window.ethereum.request({\n              method: \"eth_chainId\",\n            });\n            console.log(\"Connected to chain:\", chainId);\n          }\n        } catch (error) {\n          console.error(\"Failed to connect to MetaMask:\", error);\n        }\n      }, []);\n\n      const uploadWithMetaMask = async (event) => {\n        const file = event.target.files?.[0];\n        if (!file || !connected) return;\n\n        setUploading(true);\n\n        try {\n          // Create a provider wrapper for InjectedEthereumSigner\n          const providerWrapper = {\n            getSigner: () => ({\n              signMessage: async (message: string | Uint8Array) => {\n                const accounts = await window.ethereum!.request({\n                  method: \"eth_accounts\",\n                });\n                if (accounts.length === 0) {\n                  throw new Error(\"No accounts available\");\n                }\n\n                // Convert message to hex if it's Uint8Array\n                const messageToSign =\n                  typeof message === \"string\"\n                    ? message\n                    : \"0x\" +\n                      Array.from(message)\n                        .map((b) => b.toString(16).padStart(2, \"0\"))\n                        .join(\"\");\n\n                return await window.ethereum!.request({\n                  method: \"personal_sign\",\n                  params: [messageToSign, accounts[0]],\n                });\n              },\n            }),\n          };\n\n          // Create the signer using InjectedEthereumSigner\n          const signer = new InjectedEthereumSigner(providerWrapper);\n          const turbo = TurboFactory.authenticated({\n            signer,\n            token: \"ethereum\", // Important: specify token type for Ethereum\n          });\n\n          // Upload file with progress tracking\n          const result = await turbo.uploadFile({\n            fileStreamFactory: () => file.stream(),\n            fileSizeFactory: () => file.size,\n            dataItemOpts: {\n              tags: [\n                { name: \"Content-Type\", value: file.type },\n                { name: \"App-Name\", value: \"My-Vite-App\" },\n                { name: \"Funded-By\", value: \"Ethereum\" },\n              ],\n            },\n            events: {\n              onProgress: ({ totalBytes, processedBytes, step }) => {\n                console.log(\n                  `${step}: ${Math.round((processedBytes / totalBytes) * 100)}%`\n                );\n              },\n              onError: ({ error, step }) => {\n                console.error(`Error during ${step}:`, error);\n                console.error(\"Error details:\", JSON.stringify(error, null, 2));\n              },\n            },\n          });\n\n          setUploadResult(result);\n        } catch (error) {\n          console.error(\"Upload failed:\", error);\n          console.error(\"Error details:\", JSON.stringify(error, null, 2));\n          alert(`Upload failed: ${error.message}`);\n        } finally {\n          setUploading(false);\n        }\n      };\n\n      return (\n        \n          MetaMask Upload\n\n          {!connected ? (\n            \n              Connect MetaMask\n            \n          ) : (\n\n                âœ… Connected: {address.slice(0, 6)}...{address.slice(-4)}\n\n                  Select File to Upload:\n\n              {uploading && (\n                \n                  ðŸ”„ Uploading... Please confirm transaction in MetaMask\n                \n              )}\n\n              {uploadResult && (\n\n                    âœ… Upload Successful!\n\n                    Transaction ID: {uploadResult.id}\n\n                    Data Size: {uploadResult.totalBytes} bytes\n\n              )}\n            \n          )}\n        \n      );\n    }",
      "language": "tsx"
    },
    {
      "code": "const [connected, setConnected] = useState(false);\n      const [address, setAddress] = useState(\"\");\n      const [uploading, setUploading] = useState(false);\n      const [uploadResult, setUploadResult] = useState(null);\n\n      const connectWanderWallet = useCallback(async () => {\n        try {\n          if (!window.arweaveWallet) {\n            alert(\"Wander wallet is not installed!\");\n            return;\n          }\n\n          // Required permissions for Turbo SDK\n          const permissions = [\n            \"ACCESS_ADDRESS\",\n            \"ACCESS_PUBLIC_KEY\",\n            \"SIGN_TRANSACTION\",\n            \"SIGNATURE\",\n          ];\n\n          // Connect to wallet\n          await window.arweaveWallet.connect(permissions);\n\n          // Get wallet address\n          const walletAddress = await window.arweaveWallet.getActiveAddress();\n          setAddress(walletAddress);\n          setConnected(true);\n        } catch (error) {\n          console.error(\"Failed to connect to Wander wallet:\", error);\n        }\n      }, []);\n\n      const uploadWithWanderWallet = async (event) => {\n        const file = event.target.files?.[0];\n        if (!file || !connected) return;\n\n        setUploading(true);\n\n        try {\n          // Create ArConnect signer using Wander wallet\n          const signer = new ArconnectSigner(window.arweaveWallet);\n          const turbo = TurboFactory.authenticated({ signer });\n          // Note: No need to specify token for Arweave as it's the default\n\n          // Upload file with progress tracking\n          const result = await turbo.uploadFile({\n            fileStreamFactory: () => file.stream(),\n            fileSizeFactory: () => file.size,\n            dataItemOpts: {\n              tags: [\n                { name: \"Content-Type\", value: file.type },\n                { name: \"App-Name\", value: \"My-Vite-App\" },\n                { name: \"Funded-By\", value: \"Arweave\" },\n              ],\n            },\n            events: {\n              onProgress: ({ totalBytes, processedBytes, step }) => {\n                console.log(\n                  `${step}: ${Math.round((processedBytes / totalBytes) * 100)}%`\n                );\n              },\n              onError: ({ error, step }) => {\n                console.error(`Error during ${step}:`, error);\n              },\n            },\n          });\n\n          setUploadResult(result);\n        } catch (error) {\n          console.error(\"Upload failed:\", error);\n          alert(`Upload failed: ${error.message}`);\n        } finally {\n          setUploading(false);\n        }\n      };\n\n      return (\n        \n          Wander Wallet Upload\n\n          {!connected ? (\n            \n              Connect Wander Wallet\n            \n          ) : (\n\n                âœ… Connected: {address.slice(0, 6)}...{address.slice(-4)}\n\n                  Select File to Upload:\n\n              {uploading && (\n                \n                  ðŸ”„ Uploading... Please confirm transaction in Wander wallet\n                \n              )}\n\n              {uploadResult && (\n\n                    âœ… Upload Successful!\n\n                    Transaction ID: {uploadResult.id}\n\n                    Data Size: {uploadResult.totalBytes} bytes\n\n              )}\n            \n          )}\n        \n      );\n    }",
      "language": "tsx"
    },
    {
      "code": "{\n      \"name\": \"vite-turbo-app\",\n      \"version\": \"0.1.0\",\n      \"private\": true,\n      \"type\": \"module\",\n      \"scripts\": {\n        \"dev\": \"vite\",\n        \"build\": \"vite build\",\n        \"preview\": \"vite preview\",\n        \"lint\": \"eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0\"\n      },\n      \"dependencies\": {\n        \"@ardrive/turbo-sdk\": \"^1.20.0\",\n        \"react\": \"^18.3.1\",\n        \"react-dom\": \"^18.3.1\"\n      },\n      \"devDependencies\": {\n        \"@types/react\": \"^18.3.1\",\n        \"@types/react-dom\": \"^18.3.0\",\n        \"@vitejs/plugin-react\": \"^4.2.1\",\n        \"typescript\": \"^5.3.3\",\n        \"vite\": \"^5.2.14\",\n        \"vite-plugin-node-polyfills\": \"^0.17.0\"\n      }\n    }",
      "language": "json"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Overview",
      "id": "overview"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Common Issues and Solutions",
      "id": "common-issues-and-solutions"
    },
    {
      "level": "h3",
      "text": "Build Errors",
      "id": "build-errors"
    },
    {
      "level": "h3",
      "text": "Runtime Errors",
      "id": "runtime-errors"
    },
    {
      "level": "h3",
      "text": "Development Experience",
      "id": "development-experience"
    },
    {
      "level": "h2",
      "text": "Best Practices",
      "id": "best-practices"
    },
    {
      "level": "h2",
      "text": "Production Deployment Checklist",
      "id": "production-deployment-checklist"
    },
    {
      "level": "h2",
      "text": "Implementation Verification",
      "id": "implementation-verification"
    },
    {
      "level": "h2",
      "text": "Additional Resources",
      "id": "additional-resources"
    }
  ],
  "url": "llms-txt#using-turbo-sdk-with-vite",
  "links": []
}