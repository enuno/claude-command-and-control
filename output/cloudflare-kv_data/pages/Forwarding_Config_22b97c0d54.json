{
  "title": "Forwarding Config",
  "content": "forward-zone:\n name: \".\"\n forward-tls-upstream: yes\n forward-addr: 162.159.36.5@853#9y65g5srsm.cloudflare-gateway.com\n forward-addr: 2001:db8:abcd::1234#9y65g5srsm.cloudflare-gateway.com\ntxt\nhttps://<YOUR_DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query\npowershell\n   nslookup -type=A <your-subdomain>.cloudflare-gateway.com\n   powershell\n   nslookup -type=AAAA <your-subdomain>.cloudflare-gateway.com\n   powershell\n   Add-DnsClientDohServerAddress -ServerAddress <IP-address> -DohTemplate https://<your-subdomain>.cloudflare-gateway.com/dns-query -AllowFallbackToUdp $False -AutoUpgrade $False\n   powershell\n   Get-DnsClientDohServerAddress\n   powershell\nnslookup -type=A <your-subdomain>.cloudflare-gateway.com\npowershell\nnslookup -type=AAAA <your-subdomain>.cloudflare-gateway.com\nhttp\nGET /dns-query?name=example.com&type=A HTTP/2\nHost: dns.cloudflare-gateway.com\ncf-dns-location: 9y65g5srsm\nAccept: application/dns-message\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/service_tokens\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\"name\":\"ACME Corporation service token\"}'\njson\n{\n  \"result\": {\n    \"client_id\": \"88bf3b6d86161464f6509f7219099e57.access\",\n    \"client_secret\": \"bdd31cbc4dec990953e39163fbbb194c93313ca9f0a6e420346af9d326b1d2a5\",\n    \"created_at\": \"2022-06-09T01:59:17Z\",\n    \"expires_at\": \"2023-06-09T01:59:17Z\",\n    \"id\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n    \"name\": \"ACME Corporation service token\",\n    \"updated_at\": \"2022-06-09T01:59:17Z\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl --request PUT \\\n\"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/organizations/doh/$SERVICE_TOKEN_ID\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\njson\n{\n  \"result\": {\n    \"client_id\": \"88bf3b6d86161464f6509f7219099e57.access\",\n    \"created_at\": \"2022-06-09T01:59:17Z\",\n    \"expires_at\": \"2023-06-09T01:59:17Z\",\n    \"id\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n    \"name\": \"ACME Corporation service token\",\n    \"updated_at\": \"2022-06-09T01:59:17Z\",\n    \"duration\": \"8760h\"\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/access/users\" \\\n--header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"John Doe\",\n  \"email\": \"jdoe@acme.com\",\n  \"custom\": {\"groups\":[{\"id\": \"02fk6b3p3majl10\", \"email\": \"finance@acme.com\", \"name\": \"Finance\"}]}\n}'\njson\n{\n  \"result\": {\n    \"id\": \"54d425de-7a78-4186-9975-d43c88ee7899\",\n    \"created_at\": \"2022-03-16T21:18:39.93598Z\",\n    \"updated_at\": \"2022-05-17T23:50:39.598345Z\",\n    \"uid\": \"54d425de-7a78-4186-9975-d43c88ee7899\",\n    \"name\": \"John Doe\",\n    \"email\": \"jdoe@acme.com\",\n    \"custom\": {\n      \"groups\": [\n        {\n          \"email\": \"finance@acme.com\",\n          \"id\": \"02fk6b3p3majl10\",\n          \"name\": \"Finance\"\n        }\n      ]\n    }\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://<TEAM_NAME>.cloudflareaccess.com/cdn-cgi/access/doh-token?account-id=<ACCOUNT_ID>&user-id=<USER_ID>&auth-domain=<TEAM_NAME>.cloudflareaccess.com\" \\\n--header \"Cf-Access-Client-Id: <CLIENT_ID>\" \\\n--header \"Cf-Access-Client-Secret: <CLIENT_SECRET>\"\njson\n{\n  \"token\": \"y2khbGciOiJSUzI1NiIsImtpZCI6ImJlZjVkYjg4ZTEwMjk3ZDEwNzhkMmEyYjE0MjMxZTljYTQwMjQ2NjAwOTQzNmJhOTQwOGJkODY3ZmI4OWFiOGQifQ.eyJ0eXBlIjoiZG9oIiwiYXVkIjoiY2xvdWRmbGFyZS1nYXRld2F5LmNvbSIsImlhdCI6MTY1NDc1MTg3NSwiZXhwIjoxNjU0ODM4Mjc1LCJhY2NvdW50LWlkIjoiMTA4MDM0OGIyZGYzYmQwN2QxZmI1MjM3Y2Q1ZDU5M2EiLCJ1c2VyLWlkIjoiNTRkNDI1ZGUtN2E3OC00MTg2LTk5NzUtZDQzYzg4ZWU3ODk5In0.I5p4WsH2dPhQ8vwy84zF05PsoBHCsUSXAaMpNhEH36oFZ3tXcs9ksLz7OzpZ_x3HxUfO3n57LlpAF1VehaBt2i94XCkvSgtHpYcwd_qZydLp-BGtcyfU1LbdXQC3m6zxKcIWu5VySi8I-J25UYlpyJhYgZ4DQUZIpqbSSt6WcVRKvA7OBa7xjkTux4OcqWAViO_ZS-GLwl-fqhvolmiwk37seBD3YuV1zG06VeWXfrMkZ5MbhooHD1DZDBHOZpTtmN8MbeKeI4tlY1mb_O3-jE-um6F9Hrl4NQm89MKFzsum-_Rywi5m4PTSlDza7fjdJs7RzFgJd3VWgzG-jgyQKw\"\n}\nbash\ncurl --silent \"https://<ACCOUNT_ID>.cloudflare-gateway.com/dns-query?name=example.com\" \\\n--header \"accept: application/dns-json\" \\\n--header \"CF-Authorization: <USER_DOH_TOKEN>\" | jq\njson\n{\n  \"Status\": 0,\n  \"TC\": false,\n  \"RD\": true,\n  \"RA\": true,\n  \"AD\": false,\n  \"CD\": false,\n  \"Question\": [\n    {\n      \"name\": \"example.com\",\n      \"type\": 1\n    }\n  ],\n  \"Answer\": [\n    {\n      \"name\": \"example.com\",\n      \"type\": 1,\n      \"TTL\": 60,\n      \"data\": \"162.159.36.12\"\n    }\n  ]\n}\njs\nfunction FindProxyForURL(url, host) {\n  // No proxy for private (RFC 1918) IP addresses (intranet sites)\n  if (\n    isInNet(dnsResolve(host), \"10.0.0.0\", \"255.0.0.0\") ||\n    isInNet(dnsResolve(host), \"172.16.0.0\", \"255.240.0.0\") ||\n    isInNet(dnsResolve(host), \"192.168.0.0\", \"255.255.0.0\")\n  ) {\n    return \"DIRECT\";\n  }\n\n// No proxy for localhost\n  if (isInNet(dnsResolve(host), \"127.0.0.0\", \"255.0.0.0\")) {\n    return \"DIRECT\";\n  }\n\n// Proxy all\n  return \"HTTPS 3ele0ss56t.proxy.cloudflare-gateway.com:443\";\n}\njs\nfunction FindProxyForURL(url, host) {\n  // *** Identity Provider Bypass ***\n  // CRITICAL: Bypass your IdP to prevent authentication loops\n  // Uncomment and configure the section for your IdP:\n\n// Okta\n  // if (host === \"your-domain.okta.com\" || shExpMatch(host, \"*.oktacdn.com\")) {\n  //   return \"DIRECT\";\n  // }\n\n// Microsoft Entra ID (Azure AD)\n  // if (\n  //   host === \"login.microsoftonline.com\" ||\n  //   host === \"aadcdn.msauth.net\" ||\n  //   host === \"aadcdn.msftauth.net\"\n  // ) {\n  //   return \"DIRECT\";\n  // }\n\n// Google Workspace\n  // if (\n  //   host === \"accounts.google.com\" ||\n  //   shExpMatch(host, \"*.gstatic.com\")\n  // ) {\n  //   return \"DIRECT\";\n  // }\n\n// GitHub\n  // if (shExpMatch(host, \"*.github.com\")) {\n  //   return \"DIRECT\";\n  // }\n\n// *** Private Networks ***\n  // Bypass private RFC 1918 IP addresses\n  if (\n    isInNet(dnsResolve(host), \"10.0.0.0\", \"255.0.0.0\") ||\n    isInNet(dnsResolve(host), \"172.16.0.0\", \"255.240.0.0\") ||\n    isInNet(dnsResolve(host), \"192.168.0.0\", \"255.255.0.0\")\n  ) {\n    return \"DIRECT\";\n  }\n\n// Bypass localhost\n  if (isInNet(dnsResolve(host), \"127.0.0.0\", \"255.0.0.0\")) {\n    return \"DIRECT\";\n  }\n\n// Bypass plain hostnames (no dots)\n  if (isPlainHostName(host)) {\n    return \"DIRECT\";\n  }\n\n// Bypass .local domains\n  if (shExpMatch(host, \"*.local\")) {\n    return \"DIRECT\";\n  }\n\n// *** Cloudflare Access Logout ***\n  // Optional: Redirect logout requests to your Access logout page\n  // if (shExpMatch(url, \"*logout*\")) {\n  //   return \"HTTPS your-team-name.cloudflareaccess.com/cdn-cgi/access/logout\";\n  // }\n\n// *** Proxy all other traffic ***\n  return \"HTTPS your-subdomain.proxy.cloudflare-gateway.com:443\";\n}\njs\nfunction FindProxyForURL(url, host) {\n  // Resolve once and reuse\n  var hostIP = dnsResolve(host);\n\nif (isInNet(hostIP, \"10.0.0.0\", \"255.0.0.0\")) {\n    return \"DIRECT\";\n  }\n\n// Reuse hostIP for additional checks\n  if (isInNet(hostIP, \"172.16.0.0\", \"255.240.0.0\")) {\n    return \"DIRECT\";\n  }\n\nreturn \"HTTPS proxy.example.com:443\";\n}\njs\nif (isPlainHostName(host)) return \"DIRECT\";\njs\nfunction FindProxyForURL(url, host) {\n  // Normalize to lowercase\n  host = host.toLowerCase();\n  url = url.toLowerCase();\n\nif (shExpMatch(host, \"*.example.com\")) {\n    return \"DIRECT\";\n  }\n\nreturn \"HTTPS proxy.cloudflare-gateway.com:443\";\n}\njs\n// Bypass font providers\nif (\n  shExpMatch(host, \"*.googleapis.com\") ||\n  shExpMatch(host, \"*.gstatic.com\") ||\n  shExpMatch(host, \"fonts.adobe.com\")\n) {\n  return \"DIRECT\";\n}\njs\n// Bypass streaming services\nif (\n  shExpMatch(host, \"*.netflix.com\") ||\n  shExpMatch(host, \"*.youtube.com\") ||\n  shExpMatch(host, \"*.googlevideo.com\")\n) {\n  return \"DIRECT\";\n}\nbash\n   ~/Desktop $ mkdir tmp\n\n~/Desktop $ cd tmp\n   sh\n   ~/Desktop/tmp $ codesign -d --extract-certificates \"/Applications/Cloudflare WARP.app/Contents/Resources/CloudflareWARP\"\n   Executable=/Applications/Cloudflare WARP.app/Contents/Resources/CloudflareWARP\n   sh\n   ~/Desktop/tmp $ openssl x509 -inform DER -in codesign0 -fingerprint -sha1 -noout | tr -d :\n   SHA1 Fingerprint=FE2C359D79D4CEAE6BDF7EFB507326C6B4E2436E\n   powershell\n   Get-AuthenticodeSignature -FilePath c:\\myfile.exe\n   sh\n   shasum -a 256 myfile\n   powershell\n   get-filehash -path \"C:\\myfile.exe\" -Algorithm SHA256 | format-list\n   sh\nps -eo comm | xargs -I {} which \"{}\" | sort | uniq | xargs -I {} realpath \"{}\"\nsh\nps -eo pid | awk '{print \"/proc/\"$1\"/exe\"}' | xargs readlink -f | awk '{print $1}' | sort | uniq\npowershell\nGet-Process | Select-Object ProcessName, Path | Format-Table -AutoSize\nbash\n   curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/mtls_certificates\" \\\n     --request POST \\\n     --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n     --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n     --json '{\n       \"name\": \"example_ca_cert\",\n       \"certificates\": \"-----BEGIN CERTIFICATE-----\\nXXXXX\\n-----END CERTIFICATE-----\",\n       \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nXXXXX\\n-----END PRIVATE KEY-----\",\n       \"ca\": true\n     }'\n   json\n   {\n     \"success\": true,\n     \"errors\": [],\n     \"messages\": [],\n     \"result\": {\n       \"id\": \"2458ce5a-0c35-4c7f-82c7-8e9487d3ff60\",\n       \"name\": \"example_ca_cert\",\n       \"issuer\": \"O=Example Inc.,L=California,ST=San Francisco,C=US\",\n       \"signature\": \"SHA256WithRSA\",\n       ...\n     }\n   }\n   powershell\n  Get-ChildItem Cert:\\LocalMachine\\My\\ | where{$_.Subject -like \"*<COMMON_NAME>*\"}\n  powershell\n  Get-ChildItem Cert:\\CurrentUser\\My\\ | where{$_.Subject -like \"*<COMMON_NAME>*\"}\n  sh\n  /usr/bin/security find-certificate -c \"<COMMON_NAME>\" -p /Library/Keychains/System.keychain\n  sh\n  certutil -L -d /etc/pki/nssdb\n  sh\n  Certificate Nickname                                         Trust Attributes\n                                                               SSL,S/MIME,JAR/XPI\n\nmeow                                                         CTu,Cu,Cu\n  noPrivateKey                                                 CT,,\n  sh\n  certutil -L -d /etc/pki/nssdb -n meow\n  sh\n  Certificate:\n      Data:\n          Version: 3 (0x2)\n          Serial Number: 236 (0xec)\n          Signature Algorithm: PKCS #1 SHA-256 With RSA Encryption\n          Issuer: \"CN=123456.mycompany\"\n          Validity:\n              Not Before: Tue Jul 02 17:20:40 2024\n              Not After : Sun Jul 02 17:20:40 2034\n          Subject: \"CN=123456.mycompany\"\n          Subject Public Key Info:\n              Public Key Algorithm: PKCS #1 RSA Encryption\n              RSA Public Key:\n                  Modulus:\n                      <redacted>\n                  Exponent: 65537 (0x10001)\n      Signature Algorithm: PKCS #1 SHA-256 With RSA Encryption\n      Signature:\n          <redacted>\n      Fingerprint (SHA-256):\n          <redacted>\n      Fingerprint (SHA1):\n          <redacted>\n\nMozilla-CA-Policy: false (attribute missing)\n      Certificate Trust Flags:\n          SSL Flags:\n              Valid CA\n              Trusted CA\n              User\n              Trusted Client CA\n          Email Flags:\n              Valid CA\n              Trusted CA\n              User\n          Object Signing Flags:\n              Valid CA\n              Trusted CA\n              User\n  sh\n   system_profiler SPHardwareDataType | grep 'Serial Number'\n   powershell\n   Get-CimInstance Win32_BIOS\n   sh\n   sudo dmidecode -s system-serial-number\n   sh\n   /usr/sbin/system_profiler SPStorageDataType\n   sh\n   Storage:\n\nFree: 428.52 GB (428,519,702,528 bytes)\n        Capacity: 494.38 GB (494,384,795,648 bytes)\n        Mount Point: /System/Volumes/Data\n   sh\n   diskutil info /System/Volumes/Data | grep FileVault\n   sh\n    FileVault:                 Yes\n   sh\nlsblk\nsh\nNAME                        MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT\nnvme0n1                     259:0    0 476.9G  0 disk\n├─nvme0n1p1                 259:1    0   512M  0 part  /boot/efi\n├─nvme0n1p2                 259:2    0   488M  0 part  /boot\n└─nvme0n1p3                 259:3    0   476G  0 part\n  └─nvme0n1p3_crypt         253:0    0 475.9G  0 crypt\n    ├─my--vg-root   253:1            0 474.9G  0 lvm   /\n    └─my--vg-swap_1 253:2            0   976M  0 lvm   [SWAP]\npowershell\n   (Get-WmiObject Win32_ComputerSystem).Domain\n   sh\n   sudo /sbin/pfctl -s info\n   powershell\n   Get-NetFirewallProfile -PolicyStore ActiveStore -Name Public\n   sh\n   defaults read loginwindow SystemVersionStampAsString\n   bash\n   (Get-CimInstance Win32_OperatingSystem).version\n   bash\n   (Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" -Name UBR).UBR\n   sh\n   $ uname -r\n   5.14.0-25.el9.x86_64\n   sh\n   cat /etc/os-release | grep \"ID\"\n   sh\n   sudo update-ca-certificates\n   sh\n   cd /usr/local/share/ca-certificates\n   sh\n   ls -l\n   sh\n   lrwxrwxrwx 1 root root   49 Jan  3 21:46 managed-warp.crt -> /usr/local/share/ca-certificates/managed-warp.pem\n   -rw-r--r-- 1 root root 1139 Jan  3 21:46 managed-warp.pem\n   sh\n   mkdir -p /root/customca\n   cd /root/customca\n   sh\n   openssl genrsa -out <CUSTOM-ROOT-PRIVATE-KEY>.pem 2048\n   sh\n   openssl req -x509 -sha256 -new -nodes -key <CUSTOM-ROOT-PRIVATE-KEY>.pem -days 365 -out <CUSTOM-ROOT-CERT>.pem\n   sh\nopenssl rsa -in <CUSTOM-ROOT-PRIVATE-KEY>.pem -text\nsh\nopenssl x509 -in <CUSTOM-ROOT-CERT>.pem -text\nbash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/mtls_certificates\" \\\n       --request POST \\\n       --header \"X-Auth-Email: $CLOUDFLARE_EMAIL\" \\\n       --header \"X-Auth-Key: $CLOUDFLARE_API_KEY\" \\\n       --json '{\n         \"name\": \"example_ca_cert\",\n         \"certificates\": \"-----BEGIN CERTIFICATE-----\\nXXXXX\\n-----END CERTIFICATE-----\",\n         \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nXXXXX\\n-----END PRIVATE KEY-----\",\n         \"ca\": true\n       }'\n     json\n     {\n       \"success\": true,\n       \"errors\": [],\n       \"messages\": [],\n       \"result\": {\n         \"id\": \"2458ce5a-0c35-4c7f-82c7-8e9487d3ff60\",\n         \"name\": \"example_ca_cert\",\n         \"issuer\": \"O=Example Inc.,L=California,ST=San Francisco,C=US\",\n         \"signature\": \"SHA256WithRSA\",\n         ...\n       }\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/certificates/$CERTIFICATE_ID/activate\" \\\n       --request POST \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n     json\n     {\n       \"errors\": [],\n       \"messages\": [],\n       \"success\": true,\n       \"result\": {\n         \"in_use\": false,\n         \"id\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n         \"certificate\": \"-----BEGIN CERTIFICATE-----\\\\n ... \\\\n-----END CERTIFICATE-----\\\\n\",\n         \"issuer_org\": \"Example Inc.\",\n         \"issuer_raw\": \"O=Example Inc.,L=California,ST=San Francisco,C=US\",\n         \"fingerprint\": \"E9:19:49:AA:DD:D8:1E:C1:20:2A:D8:22:BF:A5:F8:FC:1A:F7:10:9F:C7:5B:69:AB:0:31:91:8B:61:B4:BF:1C\",\n         \"binding_status\": \"pending_deployment\",\n         \"type\": \"custom\",\n         \"updated_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"uploaded_on\": \"2014-01-01T05:20:00.12345Z\",\n         \"created_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"expires_on\": \"2014-01-01T05:20:00.12345Z\"\n       }\n     }\n     bash\n     curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/certificates/$CERTIFICATE_ID\" \\\n       --request GET \\\n       --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\"\n     json\n     {\n       \"errors\": [],\n       \"messages\": [],\n       \"success\": true,\n       \"result\": {\n         \"in_use\": false,\n         \"id\": \"f174e90a-fafe-4643-bbbc-4a0ed4fc8415\",\n         \"certificate\": \"-----BEGIN CERTIFICATE-----\\\\n ... \\\\n-----END CERTIFICATE-----\\\\n\",\n         \"issuer_org\": \"Example Inc.\",\n         \"issuer_raw\": \"O=Example Inc.,L=California,ST=San Francisco,C=US\",\n         \"fingerprint\": \"E9:19:49:AA:DD:D8:1E:C1:20:2A:D8:22:BF:A5:F8:FC:1A:F7:10:9F:C7:5B:69:AB:0:31:91:8B:61:B4:BF:1C\",\n         \"binding_status\": \"available\",\n         \"type\": \"custom\",\n         \"updated_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"uploaded_on\": \"2014-01-01T05:20:00.12345Z\",\n         \"created_at\": \"2014-01-01T05:20:00.12345Z\",\n         \"expires_on\": \"2014-01-01T05:20:00.12345Z\"\n       }\n     }\n     bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/configuration\" \\\n    --request PATCH \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"settings\": {\n          \"certificate\": {\n              \"id\": \"{certificate_id}\",\n              \"in_use\": true\n          }\n      }\n    }'\n  sh\nopenssl x509 -noout -fingerprint -sha1 -inform der -in <certificate.crt>\nsh\nSHA1 Fingerprint=BB:2D:B6:3D:6B:DE:DA:06:4E:CA:CB:40:F6:F2:61:40:B7:10:F0:6C\nsh\nopenssl x509 -noout -fingerprint -sha1 -inform pem -in <certificate.pem>\nsh\nSHA1 Fingerprint=BB:2D:B6:3D:6B:DE:DA:06:4E:CA:CB:40:F6:F2:61:40:B7:10:F0:6C\nsh\nopenssl x509 -noout -fingerprint -sha256 -inform der -in <certificate.crt>\nsh\nsha256 Fingerprint=F5:E1:56:C4:89:78:77:AD:79:3A:1E:83:FA:77:83:F1:9C:B0:C6:1B:58:2C:2F:50:11:B3:37:72:7C:62:3D:EF\nsh\nopenssl x509 -noout -fingerprint -sha256 -inform pem -in <certificate.pem>\nsh\nsha256 Fingerprint=F5:E1:56:C4:89:78:77:AD:79:3A:1E:83:FA:77:83:F1:9C:B0:C6:1B:58:2C:2F:50:11:B3:37:72:7C:62:3D:EF\nsh\n     openssl x509 -inform PEM -in ~/Downloads/certificate.pem -outform DER -out ~/Downloads/certificate.cer\n     powershell\n     openssl x509 -inform PEM -in \"$HOME\\Downloads\\certificate.pem\" -outform DER -out \"$HOME\\Downloads\\certificate.cer\"\n     sh\n  sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain <path-to-certificate.crt>\n  sh\n  echo | sudo tee -a /etc/ssl/cert.pem < certificate.pem\n  sh\n     sudo apt-get install ca-certificates\n     sh\n     sudo cp certificate.pem /usr/share/ca-certificates/certificate.crt\n     sh\n     sudo dpkg-reconfigure ca-certificates\n     sh\n     sudo dnf install ca-certificates\n     sh\n     sudo cp certificate.crt certificate.pem /etc/pki/ca-trust/source/anchors\n     sh\n     sudo update-ca-trust\n     powershell\n     python -m pip install certifi\n     powershell\n     $CERT_PATH = python -c \"import certifi; print(certifi.where())\"\n     powershell\n     gc \"$env:USERPROFILE\\Downloads\\certificate.crt\" | ac $CERT_PATH\n     powershell\n     [System.Environment]::SetEnvironmentVariable('CERT_PATH', $CERT_PATH, 'Machine')\n     [System.Environment]::SetEnvironmentVariable('SSL_CERT_FILE', $CERT_PATH, 'Machine')\n     [System.Environment]::SetEnvironmentVariable('REQUESTS_CA_BUNDLE', $CERT_PATH, 'Machine')\n     sh\n     python -m pip install certifi\n     sh\n     echo | cat - certificate.pem >> $(python -m certifi)\n     sh\n     echo 'export CERT_PATH=$(python -c \"import certifi; print(certifi.where())\")\n     export SSL_CERT_FILE=${CERT_PATH}\n     export REQUESTS_CA_BUNDLE=${CERT_PATH}' >> ~/.zshrc\n     sh\n     openssl x509 -in Cloudflare_CA.pem -inform pem -out Cloudflare_CA.der -outform der\n     sh\n     sudo $JAVA_HOME/bin/keytool -import -trustcacerts -alias 'Cloudflare Root CA' -file Cloudflare_CA.der -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit -noprompt 2>&1\n     powershell\n     openssl x509 -in Cloudflare_CA.pem -inform pem -out Cloudflare_CA.der -outform der\n     powershell\n     \"%JAVA_HOME%\\bin\\keytool\" -import -trustcacerts -alias \"Cloudflare Root CA\" -file Cloudflare_CA.der -keystore \"%JAVA_HOME%\\jre\\lib\\security\\cacerts\" -storepass changeit -noprompt\n     sh\n     openssl x509 -in ~/Downloads/certificate.pem -out ~/Downloads/ruby-root-ca.crt\n     sh\n     mkdir -p ~/.gem/ssl\n     sh\n     cp ~/Downloads/ruby-root-ca.crt ~/.gem/ssl/rubygems.org.pem\n     sh\n     gem sources --add-trusted-cert ~/.gem/ssl/rubygems.org.pem\n     yaml\n     :ssl_cert: ~/.gem/ssl/rubygems.org.pem\n     powershell\n     openssl x509 -in %UserProfile%\\Downloads\\certificate.pem -out %UserProfile%\\Downloads\\ruby-root-ca.crt\n     powershell\n     mkdir -Force \"$env:USERPROFILE\\.gem\\ssl\"\n     powershell\n     Copy-Item \"$env:USERPROFILE\\Downloads\\ruby-root-ca.crt\" \"$env:USERPROFILE\\.gem\\ssl\\rubygems.org.pem\"\n     powershell\n     gem sources --add-trusted-cert \"$env:USERPROFILE\\.gem\\ssl\\rubygems.org.pem\"\n     yaml\n     :ssl_cert: C:/Users/<username>/.gem/ssl/rubygems.org.pem\n     powershell\n     [System.Environment]::SetEnvironmentVariable('CARGO_HTTP_CAINFO', \"$HOME\\Downloads\\certificate.pem\", 'User')\n     toml\n  [http]\n  cainfo = \"C:\\\\Users\\\\<username>\\\\Downloads\\\\certificate.pem\"\n  sh\n     export CARGO_HTTP_CAINFO=\"$HOME/Downloads/certificate.pem\"\n     toml\n  [http]\n  cainfo = \"/path/to/certificate.pem\"\n  powershell\n     git config -l\n     txt\n     core.symlinks=false\n     core.autocrlf=true\n     core.fscache=true\n     color.diff=auto\n     color.status=auto\n     color.branch=auto\n     color.interactive=true\n     help.format=html\n     rebase.autosquash=true\n     http.sslcainfo=C:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt\n     http.sslbackend=openssl\n     diff.astextplain.textconv=astextplain\n     filter.lfs.clean=git-lfs clean -- %f\n     filter.lfs.smudge=git-lfs smudge -- %f\n     filter.lfs.process=git-lfs filter-process\n     filter.lfs.required=true\n     credential.helper=manager\n     powershell\n     gc .\\certificate.pem | ac $(git config --get http.sslcainfo)\n     sh\n  git config --global http.sslcainfo [PATH_TO_CLOUDFLARE_CERT]\n  sh\n   npm config set cafile [PATH_TO_CLOUDFLARE_CERT.pem]\n   sh\nexport NODE_EXTRA_CA_CERTS='[PATH_TO_CLOUDFLARE_CERT.pem]'\nsh\ncomposer config cafile [PATH_TO_CLOUDFLARE_CERT.pem]\nsh\n   cd docker-project\n   mkdir certs\n   mv /path/to/downloaded/certificate.pem certs/\n   sh\n   docker-project/\n   ├── Dockerfile\n   └── certs/\n       └── certificate.pem\n   docker\n        FROM registry.access.redhat.com/ubi9/ubi:latest\n        # Or FROM centos:7 or FROM fedora:38\n\n# Install necessary certificates package\n        RUN dnf install -y ca-certificates\n\n# Copy and add Cloudflare root certificate\n        COPY certs/certificate.pem /etc/pki/ca-trust/source/anchors/certificate.crt\n        RUN update-ca-trust extract\n        docker\n        FROM debian:12\n        # Or FROM ubuntu:22.04\n\n# Install necessary certificates package\n        RUN apt-get update && apt-get install -y ca-certificates\n\n# Copy and add Cloudflare root certificate\n        COPY certs/certificate.pem /usr/local/share/ca-certificates/certificate.crt\n        RUN update-ca-certificates\n        docker\n        FROM alpine:3.18\n\n# Install necessary certificates package\n        RUN apk add --no-cache ca-certificates\n\n# Copy and add Cloudflare root certificate\n        COPY certs/certificate.pem /usr/local/share/ca-certificates/certificate.crt\n        RUN update-ca-certificates\n        sh\n        docker build -t <your-container-name> .\n        sh\n        docker run --rm your-image-name sh -c \"cat /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem | grep Cloudflare\"\n        sh\n        docker run --rm your-image-name sh -c \"cat /etc/ssl/certs/certificate.pem\"\n        yaml\n        version: '3'\n        services:\n          redhat-app:\n            image: registry.access.redhat.com/ubi9/ubi:latest\n             volumes:\n               - certs/certificate.pem:/etc/pki/ca-trust/source/anchors/certificate.pem\n             entrypoint: /bin/sh -c \"dnf install -y ca-certificates && update-ca-trust extract && app start\"\n        yaml\n        version: '3'\n        services:\n          debian-app:\n            image: debian:12\n             volumes:\n               - certs/certificate.pem:/usr/local/share/ca-certificates/certificate.crt\n             entrypoint: /bin/sh -c \"apt-get update && apt-get install -y ca-certificates && update-ca-certificates && app start\"\n        yaml\n        version: '3'\n        services:\n          alpine-app:\n            image: alpine:3.18\n             volumes:\n               - certs/certificate.pem:/usr/local/share/ca-certificates/certificate.pem\n             entrypoint: /bin/sh -c \"apk add --no-cache ca-certificates && update-ca-certificates && app start\"\n        sh\n        docker-compose up\n        sh\n        docker exec -it <container-name> sh -c \"cat /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem | grep Cloudflare\"\n        sh\n        docker exec -it <container-name> sh -c \"cat /etc/ssl/certs/ca-certificates.crt | grep Cloudflare\"\n        curl\ncurl --ca-native https://example.com\nsh\n  wget --ca-certificate=[PATH_TO_CLOUDFLARE_CERT.pem] https://example.com\n  sh\n  ca_certificate = [PATH_TO_CLOUDFLARE_CERT.pem]\n  txt\n      /Applications/Android Studio.app/Contents/jbr/Contents/Home\n      sh\n     export JAVA_HOME=\"/path/to/jre\"\n     sh\n     \"$JAVA_HOME/bin/keytool\" -import -file ~/Downloads/certificate.crt -alias CloudflareRootCA -keystore \"$JAVA_HOME/lib/security/cacerts\" -storepass changeit -trustcacerts -noprompt\n     powershell\n     $env:JAVA_HOME = \"C:\\Program Files\\Android\\Android Studio\\jbr\"\n     powershell\n     & \"$env:JAVA_HOME\\bin\\keytool.exe\" -import -file \"$env:USERPROFILE\\Downloads\\certificate.crt\" -alias CloudflareRootCA -keystore \"$env:JAVA_HOME\\lib\\security\\cacerts\" -storepass changeit -trustcacerts -noprompt\n     txt\n   *** System properties:\n   java.home=/Users/<username>/.p2/pool/plugins/org.eclipse.justj.openjdk.hotspot.jre.full.macosx.aarch64_17.0.8.v20230831-1047/jre\n   sh\n     export JAVA_HOME=$(echo /path/to/java.home)\n     sh\n     \"$JAVA_HOME/bin/keytool\" -import -file ~/Downloads/certificate.crt -alias CloudflareRootCA -keystore \"$JAVA_HOME/lib/security/cacerts\" -storepass changeit -trustcacerts -noprompt\n     powershell\n     set JAVA_HOME=\"\\path\\to\\java.home\"\n     powershell\n     \"%JAVA_HOME%\\bin\\keytool.exe\" -import -file \"%UserProfile%\\Downloads\\Cloudflare_CA.crt\" -alias CloudflareRootCA -keystore \"%JAVA_HOME%\\lib\\security\\cacerts\" -storepass changeit -trustcacerts -noprompt\n     sh\n   curl --remote-name https://curl.se/ca/cacert.pem\n   sh\n   cat cacert.pem certificate.pem > ~/ca.pem\n   sh\n   gcloud config set core/custom_ca_certs_file ~/ca.pem\n   ini\n   [default]\n   region = us-west-1\n\nca_bundle = /path/to/certificate.pem\n   sh\n  export REQUESTS_CA_BUNDLE=\"$HOME/Downloads/certificate.pem\"\n  powershell\n  [System.Environment]::SetEnvironmentVariable('REQUESTS_CA_BUNDLE', \"$HOME\\Downloads\\certificate.pem\", 'User')\n  sh\n   REQUESTS_CA_BUNDLE=/path/to/certificate.pem az <command>\n   sh\n  export AWS_CA_BUNDLE=\"$HOME/Downloads/certificate.pem\"\n  powershell\n  [System.Environment]::SetEnvironmentVariable('AWS_CA_BUNDLE', \"$HOME\\Downloads\\certificate.pem\", 'User')\n  ini\n   [default]\n   region = us-west-1\n\nca_bundle = /path/to/certificate.pem\n   python\n   import boto3\n\nclient = boto3.client(\n       's3',\n       verify='/path/to/certificate.pem'\n   )\n   sh\n     cat /Applications/\"Google Drive.app\"/Contents/Resources/roots.pem > ~/Documents/gdrivecerts.pem\n     sh\n     cat ~/Downloads/certificate.pem >> ~/Documents/gdrivecerts.pem\n     sh\n     sudo defaults write /Library/Preferences/com.google.drivefs.settings TrustedRootCertsFile \"/Users/$(whoami)/Documents/gdrivecerts.pem\"\n     sh\n  defaults read /Library/Preferences/com.google.drivefs.settings\n  powershell\n     Get-Content \"C:\\Program Files\\Google\\Drive File Stream\\roots.pem\" | Set-Content \"$HOME\\Documents\\gdrivecerts.pem\"\n     powershell\n     Get-Content \"$HOME\\Downloads\\certificate.pem\" | Add-Content \"$HOME\\Documents\\gdrivecerts.pem\"\n     powershell\n     Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Google\\DriveFS\" -Name \"TrustedRootCertsFile\" -Value \"$HOME\\Documents\\gdrivecerts.pem\"\n     powershell\n  Get-ItemProperty -Path \"HKLM:\\SOFTWARE\\Google\\DriveFS\" | Select-Object TrustedRootCertsFile\n  sh\ncd /Applications/Cloudflare\\ WARP.app/Contents/Resources\n./uninstall.sh\nsh\nsudo yum remove cloudflare-warp\nsh\nsudo apt remove cloudflare-warp\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules\" \\\n--header \"Authorization: Bearer <API_TOKEN>\"\njson\n---\n{\n  \"result\": [\n    {\n      \"id\": \"<RULE_ID>\",\n      \"scope\": \"<SCOPE>\",\n      \"name\": \"<NAME>\",\n      \"mode\": \"<MODE>\",\n      \"profile_sensitivity\": \"<SENSITIVITY>\",\n      \"rate_sensitivity\": \"<RATE>\",\n      \"burst_sensitivity\": \"<BURST>\",\n      \"created_on\": \"2023-10-01T13:10:38.762503+01:00\",\n      \"modified_on\": \"2023-10-01T13:10:38.762503+01:00\",\n      }\n    ],\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules\" \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--data '{\n  \"scope\": \"global\",\n  \"name\": \"global\",\n  \"mode\": \"<MODE>\",\n  \"rate_sensitivity\": \"<RATE>\",\n  \"burst_sensitivity\": \"<BURST>\",\n  \"profile_sensitivity\": \"<SENSITIVITY>\"\n}'\njson\n{\n  \"result\": {\n    \"id\": \"<RULE_ID>\",\n    \"scope\": \"global\",\n    \"name\": \"global\",\n    \"mode\": \"<MODE>\",\n    \"rate_sensitivity\": \"<RATE>\",\n    \"burst_sensitivity\": \"<BURST>\",\n    \"profile_sensitivity\": \"<SENSITIVITY>\",\n    \"created_on\": \"2023-10-01T13:10:38.762503+01:00\",\n    \"modified_on\": \"2023-10-01T13:10:38.762503+01:00\",\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\nbash\ncurl --request PATCH \\\n\"https://api.cloudflare.com/client/v4/accounts/{account_id}/magic/advanced_dns_protection/configs/dns_protection/rules/{rule_id}\" \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--data '{\n  \"mode\": \"<NEW_MODE>\",\n  \"profile_sensitivity\": \"<NEW_SENSITIVITY>\",\n  \"rate_sensitivity\": \"<NEW_RATE>\",\n  \"burst_sensitivity\": \"<NEW_BURST>\"\n}'\njson\n{\n  \"result\": {\n    \"id\": \"<RULE_ID>\",\n    \"scope\": \"<SCOPE>\",\n    \"name\": \"<NAME>\",\n    \"mode\": \"<NEW_MODE>\",\n    \"profile_sensitivity\": \"<NEW_SENSITIVITY>\",\n    \"rate_sensitivity\": \"<NEW_RATE>\",\n    \"burst_sensitivity\": \"<NEW_BURST>\",\n    \"created_on\": \"2023-10-01T13:10:38.762503+01:00\",\n    \"modified_on\": \"2023-10-01T13:10:38.762503+01:00\",\n  },\n  \"success\": true,\n  \"errors\": [],\n  \"messages\": []\n}\n```\n\nRefer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/json-objects/) for more information on the fields in the JSON body.\n\n<page>\n---\ntitle: Advanced TCP Protection API - JSON objects · Cloudflare DDoS Protection docs\ndescription: This page contains an example of the DNS protection rule JSON\n  object used in the API.\nlastUpdated: 2025-08-15T20:11:52.000Z\nchatbotDeprioritize: false\ntags: JSON\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/json-objects/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/json-objects/index.md\n---",
  "code_samples": [
    {
      "code": "</page>\n\n<page>\n---\ntitle: DNS over HTTPS (DoH) · Cloudflare One docs\ndescription: With Cloudflare Gateway, you can filter DNS over HTTPS (DoH)\n  requests by DNS location or by user without needing to install the WARP client\n  on your devices.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-https/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-https/index.md\n---\n\nWith Cloudflare Gateway, you can filter DNS over HTTPS (DoH) requests by [DNS location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) or by user without needing to install the WARP client on your devices.\n\nLocation-based policies require that you send DNS requests to a [location-specific DoH endpoint](#filter-doh-requests-by-location), while identity-based policies require that requests include a [user-specific DoH token](#filter-doh-requests-by-user).\n\n## Filter DoH requests by location\n\nLocation-based policies require that you send DNS queries to a unique DoH endpoint assigned to the location:",
      "language": "unknown"
    },
    {
      "code": "### Prerequisites\n\nObtain your location's DoH subdomain.\n\n### Configure browser for DoH\n\nBrowsers can be configured to use any DNS over HTTPS (DoH) endpoint. If you choose to configure DoH directly in your browser, you must choose a Gateway DNS location as your DoH endpoint, otherwise DNS filtering will not occur in that browser.\n\nMozilla Firefox\n\n1. In Firefox, go to **Settings**.\n2. In **Privacy & Security**, go to **DNS over HTTPS**.\n3. Under **Enable secure DNS using**, select *Max Protection*.\n4. In **Choose provider**, choose *Custom*.\n5. In the field, enter `https://<YOUR_DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query`.\n\nFirefox is now configured to use your DoH endpoint. For more information on configuring DoH settings in Firefox, refer to [Mozilla's documentation](https://support.mozilla.org/kb/dns-over-https).\n\nNote\n\nIf you want to enforce DNS policies through WARP instead of over DoH, you can disable DoH for your organization by blocking the [Firefox DoH canary domain](https://support.mozilla.org/kb/canary-domain-use-application-dnsnet).\n\nGoogle Chrome\n\n1. In Chrome, go to **Settings** > **Privacy and security** > **Security**.\n2. Scroll down and turn on **Use secure DNS**.\n3. Select **With Custom**.\n4. In the **Enter custom provider** field, enter `https://<YOUR_DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query`.\n\nRead more about [enabling DNS over HTTPS](https://www.chromium.org/developers/dns-over-https) on Chrome.\n\nMicrosoft Edge\n\n1. In Microsoft Edge, go to **Settings**.\n2. Select **Privacy, Search, and Services**, and scroll down to **Security**.\n3. Turn on **Use secure DNS**.\n4. Select **Choose a service provider**.\n5. In the **Enter custom provider** field, enter `https://<YOUR_DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query`.\n\nBrave\n\n1. In Brave, go to **Settings** > **Security and Privacy** > **Security**.\n2. Turn on **Use secure DNS**.\n3. Select **With Custom**.\n4. In the **Enter custom provider** field, enter `https://<YOUR_DOH_SUBDOMAIN>.cloudflare-gateway.com/dns-query`.\n\nSafari\n\nCurrently, Safari does not support DNS over HTTPS.\n\nYour DNS queries will now be sent to Gateway for filtering. To filter these requests, build a DNS policy using the [**DNS Location**](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) selector.\n\n### Configure operating system for DoH\n\nWindows 11\n\n1. Obtain the `A` and `AAAA` record values associated with your location's DoH endpoint.\n\n   1. Run the following command to obtain your `A` record values:",
      "language": "unknown"
    },
    {
      "code": "1. Obtain your `AAAA` record values.",
      "language": "unknown"
    },
    {
      "code": "1. Copy the resulting IP addresses.\n\n2. Add the addresses to your list of known DoH servers.\n\n   1. Run the following command for each address:",
      "language": "unknown"
    },
    {
      "code": "1. Confirm the addresses were added.",
      "language": "unknown"
    },
    {
      "code": "3. In Windows, go to **Settings** > **Network & internet** > your active Internet connection. This option may be either **Ethernet** or **Wi-Fi**.\n\n4. Under **DNS server assignment**, select **Edit**.\n\n5. In the drop-down menu, choose *Manual*.\n\n6. Enable **IPv4**.\n\n7. In **Preferred DNS** and **Alternate DNS**, enter the IPv4 addresses from your `A` record command. Set **DNS over HTTPS** to *On (automatic template)*.\n\n8. Enable **IPv6**.\n\n9. In **Preferred DNS** and **Alternate DNS**, enter the IPv6 addresses from your `AAAA` record command. Set **DNS over HTTPS** to *On (automatic template)*.\n\nWindows Server 2022\n\nObtain the `A` and `AAAA` record values associated with your location's DoH endpoint.\n\n1. Run the following command to obtain your `A` record values:",
      "language": "unknown"
    },
    {
      "code": "1. Obtain your `AAAA` record values.",
      "language": "unknown"
    },
    {
      "code": "1. Copy the resulting IP addresses.\n2. [Add the addresses](https://learn.microsoft.com/en-us/windows-server/networking/dns/doh-client-support#add-a-new-doh-server-to-the-list-of-known-servers) to your list of known DoH servers.\n3. [Configure the Windows Server client](https://learn.microsoft.com/en-us/windows-server/networking/dns/doh-client-support#configure-the-dns-client-to-support-doh) or [set up a Group Policy](https://learn.microsoft.com/en-us/windows-server/networking/dns/doh-client-support#configuring-doh-through-group-policy) to use DoH.\n\nFor more information, refer to [Microsoft's DoH guide](https://learn.microsoft.com/en-us/windows-server/networking/dns/doh-client-support) for Windows Server 2022 and newer.\n\n### Use generic DoH endpoint\n\nYou can send DoH requests to the generic Cloudflare DoH endpoint, `dns.cloudflare-gateway.com`. To specify a location in your request, include a header named `cf-dns-location` with a value of your location's DoH subdomain. For example:",
      "language": "unknown"
    },
    {
      "code": "## Filter DoH requests by user\n\nIn order to filter DoH queries based on user identity, each query must include a user-specific authentication token. If you have several devices per user and want to apply device-specific policies, you will need to map each device to a different email.\n\nCurrently, authentication tokens can only be generated through the API. You can run this [interactive Python script](https://developers.cloudflare.com/cloudflare-one/static/authenticated-doh.py) which automates the setup procedure, or follow the steps described below.\n\n### 1. Create a service token for the account\n\nEach Cloudflare account can only have one active Access [service token](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/service-tokens/) authorized for DNS over HTTPS (DoH) at a time.",
      "language": "unknown"
    },
    {
      "code": "Save the service token's `client_id`, `client_secret`, and `id`.\n\nExample response",
      "language": "unknown"
    },
    {
      "code": "### 2. Enable DoH functionality for the service token",
      "language": "unknown"
    },
    {
      "code": "If you get an `access.api.error.service_token_not_found` error, check that `$SERVICE_TOKEN_ID` is the value of `id` and not `client_id`.\n\nNote\n\nAlthough you can create multiple valid service tokens, only one service token can be designated for issuing DoH tokens. Calling the API to enable DoH on a new service token replaces the previously active service token. If a new token overrides an active service token, the API call will fail.\n\nExample response",
      "language": "unknown"
    },
    {
      "code": "### 3. Create a user\n\nCreate a new user and optionally add them to a group.",
      "language": "unknown"
    },
    {
      "code": "Save the user's `id` returned in the response.\n\nExample response",
      "language": "unknown"
    },
    {
      "code": "Note\n\nSteps 1-3 above only need to be completed once, while Steps 4-5 below would occur during normal operation.\n\n### 4. Generate a DoH token for the user\n\nRequest a DoH token for the user, using your service token to authenticate into your team domain.",
      "language": "unknown"
    },
    {
      "code": "The response contains a unique DoH token associated with the user. This token expires in 24 hours. We recommend setting up a refresh flow for the DoH token instead of generating a new one for every DoH query.\n\nExample response",
      "language": "unknown"
    },
    {
      "code": "### 5. Send an authenticated DoH query\n\nSend DoH queries to the resolver at `https://<ACCOUNT_ID>.cloudflare-gateway.com/dns-query`, making sure to include the user's DoH token in the `CF-Authorization` header.",
      "language": "unknown"
    },
    {
      "code": "If the site is blocked and you have turned on the [block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#configure-policy-block-behavior) for the policy, the query will return `162.159.36.12` (the IP address of the Gateway block page). If the block page is disabled, the response will be `0.0.0.0`.\n\nExample response",
      "language": "unknown"
    },
    {
      "code": "You can verify that the request was associated with the correct user email by checking your [Gateway DNS logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/). To filter these requests, build a DNS policy using any of the Gateway [identity-based selectors](https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/).\n\n</page>\n\n<page>\n---\ntitle: Locations · Cloudflare One docs\ndescription: DNS locations are a collection of DNS endpoints which can be mapped\n  to physical entities such as offices, homes, or data centers.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\ntags: IPv6\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/index.md\n---\n\nDNS locations are a collection of DNS endpoints which can be mapped to physical entities such as offices, homes, or data centers.\n\nThe fastest way to start filtering DNS queries from a location is by changing the DNS resolvers at the router.\n\n## Add a DNS location\n\nTo add a DNS location to Gateway:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Resolvers & Proxies** > **DNS locations**.\n\n2. Select **Add a location**.\n\n3. Choose a name for your DNS location.\n\n4. Choose at least one [DNS endpoint](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/#dns-endpoints) to resolve your organization's DNS queries.\n\n5. (Optional) Toggle the following settings:\n\n   * **Enable EDNS client subnet** sends a user's IP geolocation to authoritative DNS nameservers. [EDNS Client Subnet (ECS)](https://developers.cloudflare.com/cloudflare-one/glossary/?term=ecs) helps reduce latency by routing the user to the closest origin server. Cloudflare enables EDNS in a privacy preserving way by not sending the user's exact IP address but rather the first `/24` range of the larger range that contains their IP address. This `/24` range will share the same geographic location as the user's exact IP address.\n   * **Set as Default DNS Location** sets this location as the default DoH endpoint for DNS queries.\n\n6. Select **Continue**.\n\n7. (Optional) Turn on source IP filtering for your configured endpoints, then add any source IPv4/IPv6 addresses to validate.\n\n   * Endpoint authentication is required for standard IPv4 addresses and optional for dedicated IPv4 addresses.\n   * **DoH endpoint filtering & authentication** lets you restrict DNS resolution to only valid identities or user tokens in addition to IPv4/IPv6 addresses.\n\n8. Select **Continue**.\n\n9. Review the settings for your DNS location, then choose **Done**.\n\n1) Change the DNS resolvers on your router, browser, or OS by following the setup instructions in the UI.\n2) Select **Go to DNS Location**. Your location will appear in your list of locations.\n\nYou can now apply [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/) to your location using the [Location selector](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#location).\n\n## DNS endpoints\n\n### IPv4 and IPv6 DNS\n\nCloudflare will prefill the [**Source IPv4 Address**](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/dns-resolver-ips/#source-ip) based on the network you are on. Additionally, Enterprise users can use [dedicated DNS resolver IP addresses](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/dns-resolver-ips/#dns-resolver-ip) assigned to their account or [resolver IP addresses they provide (BYOIP)](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/dns-resolver-ips/#bring-your-own-dns-resolver-ip).\n\nYou do not need to configure the IPv4 DNS endpoint if:\n\n* Your network only uses IPv6.\n* Your users will send all DNS requests from this location using [DNS over HTTPS](#dns-over-https-doh) via a browser.\n* You will deploy the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/).\n\nYour IPv4 address is taken error\n\nWhen you try to configure a DNS location over IPv4, Gateway may display a **Your source IPv4 address is taken** error. This may mean someone else in the same network configured Gateway before you did. If your network supports IPv6, you can still use Gateway's DNS filtering by sending DNS queries over IPv6. You can also use the DNS over HTTPS hostname to send queries using a DNS over HTTPS client.\n\nIf you think someone else is wrongfully using this IPv4 address, [contact Cloudflare support](https://developers.cloudflare.com/support/contacting-cloudflare-support/#getting-help-with-an-issue).\n\n### DNS over TLS (DoT)\n\nDNS over TLS (DoT) is a standard for encrypting DNS traffic using its own port (`853`) and TLS encryption.\n\nFor more information, refer to [DNS over TLS](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-tls/).\n\n### DNS over HTTPS (DoH)\n\nDNS over HTTPS (DoH) is a standard for encrypting DNS traffic via the HTTPS protocol, preventing tracking and spoofing of DNS queries.\n\nGateway requires a DoH endpoint for default DNS locations. For more information, refer to [DNS over HTTPS](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-https/).\n\n## Secure DNS locations\n\nSecure DNS locations provide additional protection against malicious domains for use in services such as [protective DNS (PDNS)](https://developers.cloudflare.com/reference-architecture/diagrams/sase/gateway-for-protective-dns/). For a DNS location to be considered secure, Gateway requires that:\n\n* Your IPv4 and IPv6 endpoints use your [BYOIP addresses](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/dns-resolver-ips/#bring-your-own-dns-resolver-ip) (if any).\n* [Source network filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) is configured for your IPv4, IPv6, and DoT endpoints.\n* Source network filtering or token authentication are configured for your DoH endpoints.\n* Any enabled endpoints for a DNS location meet security permissions.\n\nYou can assign users the [**Cloudflare Zero Trust DNS Locations Write** role](https://developers.cloudflare.com/cloudflare-one/roles-permissions/#zero-trust-roles) to grant them the permission to create and edit secure DNS locations. To allow users to view locations, you must also assign the **Cloudflare Zero Trust Read Only** role. Users with these roles can view any DNS location, but can only create or edit secure locations.\n\nRoles that supersede **Cloudflare Zero Trust DNS Locations Write** include:\n\n* Cloudflare Gateway\n* Cloudflare Zero Trust\n* Super Administrator\n\n## Limitations\n\n### Captive portals\n\nDeploying Gateway DNS filtering using static IP addresses may prevent users from connecting to public Wi-Fi networks through captive portals. If users are experiencing connectivity issues related to captive portals, they should:\n\n1. Remove the static IP addresses from the device.\n2. Connect to the Wi-Fi network.\n3. Once the connection has been established, add the static IP addresses back.\n\nTo avoid this issue, use the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) to connect your devices to Cloudflare One.\n\n### Third-party filtering\n\nGateway will not properly filter traffic sent through third-party VPNs or other Internet filtering software, such as [iCloud Private Relay](https://support.apple.com/102602) or [Google Chrome IP Protection](https://github.com/GoogleChrome/ip-protection#ip-protection). To ensure your DNS policies apply to your traffic, Cloudflare recommends turning off software that may interfere with Gateway.\n\nTo turn off iCloud Private Relay, refer to the Apple user guides for [macOS](https://support.apple.com/guide/mac-help/use-icloud-private-relay-mchlecadabe0/) or [iOS](https://support.apple.com/guide/iphone/protect-web-browsing-icloud-private-relay-iph499d287c2/).\n\n</page>\n\n<page>\n---\ntitle: PAC file best practices · Cloudflare One docs\ndescription: A PAC file is a text file that specifies which traffic should\n  redirect to the proxy server. When a browser makes a web request, it consults\n  the PAC file's FindProxyForURL() function, which evaluates the request and\n  returns routing instructions, such as a direct connection, proxy server, or\n  failover sequence.\nlastUpdated: 2025-12-12T20:47:02.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/best-practices/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/best-practices/index.md\n---\n\nA PAC file is a text file that specifies which traffic should redirect to the proxy server. When a browser makes a web request, it consults the PAC file's `FindProxyForURL()` function, which evaluates the request and returns routing instructions, such as a direct connection, proxy server, or failover sequence.\n\n## PAC file format\n\nThe default Cloudflare PAC file follows a standard format:",
      "language": "unknown"
    },
    {
      "code": "You can [customize the PAC file](https://developer.mozilla.org/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling/Proxy_Auto-Configuration_PAC_file) and host it somewhere your browser can access.\n\n### Formatting considerations\n\n* Make sure the directive used for the endpoint is `HTTPS` and not `PROXY`. For example:\n\n  * Correct: `return \"HTTPS your-subdomain.proxy.cloudflare-gateway.com:443\";`\n  * Incorrect: `return \"PROXY your-subdomain.proxy.cloudflare-gateway.com:443\";`\n\n* You must use a PAC file instead of configuring the endpoint directly in the proxy configuration of the browser. Modern browsers do not support HTTPS proxies without PAC files.\n\n* Use a plain text editor such as VS Code to avoid extra characters.\n\n* If you are using PAC files for public Internet browsing (instead of only internal services), refer to [Common bypass rules](#common-bypass-rules) for domains you may need to exclude from the proxy to prevent website functionality issues.\n\n## PAC file template with identity provider bypass\n\nWhen using [authorization endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/#authorization-endpoint), you must bypass your identity provider (IdP) domains in the PAC file. This prevents authentication loops where the browser tries to authenticate with the proxy before it can reach the IdP to authenticate.\n\nThe following example PAC file is a comprehensive template that includes common IdP bypass rules. Replace the placeholder values with your configuration:",
      "language": "unknown"
    },
    {
      "code": "IdP bypass requirement\n\nWhen using authorization endpoints, you must configure IdP bypass for your identity provider. Without this, your users will be unable to authenticate and encounter errors when trying to use the proxy.\n\n## Performance optimization\n\nBrowsers evaluate PAC files for every request. Optimizing PAC file performance is critical to avoid delays and issues in web browsing for your users.\n\n### Cache DNS results in variables\n\nWhen performing DNS resolution with `dnsResolve()`, store the result in a variable to reuse it across multiple checks. This avoids redundant DNS lookups:",
      "language": "unknown"
    },
    {
      "code": "### Check for plain hostnames first\n\nNetBIOS names (hostnames without periods) are typically internal and should bypass the proxy. Check for these first:",
      "language": "unknown"
    },
    {
      "code": "## Advanced techniques\n\n### Case sensitivity handling\n\nJavaScript is case-sensitive. Convert hostnames to lowercase for consistent matching:",
      "language": "unknown"
    },
    {
      "code": "## Common bypass rules\n\nWhen using PAC files for public Internet browsing (not just internal services), you may need to bypass the proxy for certain domains to prevent website functionality issues. The following are common scenarios where your proxy may interfere with traffic.\n\nOptional rules\n\nThese bypass rules are optional and depend on your organization's security requirements. Evaluate each bypass rule against your security policies before implementation. You can also use [HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to selectively filter traffic from these domains while still routing them through the proxy.\n\n### Font and static asset providers\n\nFont APIs and static asset providers should typically bypass the proxy to prevent rendering issues:",
      "language": "unknown"
    },
    {
      "code": "### Streaming and media services\n\nVideo streaming and large media downloads may perform better with direct connections:",
      "language": "unknown"
    },
    {
      "code": "## Test PAC files\n\n### Test with expected websites\n\nBefore deploying your PAC file to all users in your organization, test it with the websites and applications your users commonly access. This helps ensure:\n\n* Internal resources are accessible and not incorrectly routed through the proxy\n* External websites are properly filtered through Gateway\n* Performance is acceptable for typical usage patterns\n\nTip\n\nCreate a test list of representative domains and verify the PAC file routes them correctly.\n\n### Validate syntax\n\nPAC files use JavaScript syntax. A single syntax error (such as a missing closing parenthesis `)` or bracket `]`) will cause the entire PAC file to fail. Use a JavaScript-aware text editor to find and fix syntax errors before deployment.\n\n## Troubleshoot configurations\n\n### Debug PAC file routing decisions\n\nIf you have an issue with proxy routing, most browsers provide debugging tools to verify PAC file behavior:\n\nChromium-based browsers (Chrome, Edge, Brave)\n\n1. In your browser, go to `chrome://net-export/` (or `edge://net-export/`).\n2. Select **Start Logging to Disk**.\n3. Go to the website you want to test with the affected browser.\n4. Select **Stop Logging**.\n5. Open the downloaded file with [netlog-viewer](https://netlog-viewer.appspot.com/).\n6. Search for your domain to see proxy resolution decisions.\n\nFirefox\n\n1. In Firefox, go to **Tools** > **Browser Tools** > **Browser Console**.\n2. Go to the website you want to test with the affected browser.\n3. Look for messages related to proxy resolution.\n\nYou can also test PAC file logic directly in the console by copying your `FindProxyForURL` function and calling it with test URLs. For example:\n\nTODO\n\nSafari\n\n1. In Safari, go to **Safari** > **Settings**, then select **Advanced**.\n2. Turn on **Show Develop menu in menu bar**.\n3. Select **Develop** > **Show Web Inspector**.\n4. Go to the **Network** tab.\n5. Look at the request details to verify proxy usage.\n\n### Browsing on a device using a PAC file is slow\n\nExcessive DNS lookups in the PAC file can cause delays. Review your PAC file and minimize the use of `dnsResolve()`, `isInNet()`, and `isResolvable()` functions.\n\n### Browser caches PAC files incorrectly\n\nWhen you update a PAC file, browsers may continue to use a cached version, causing unexpected behavior. Clear your browser cache and restart the browser after updating the PAC file to ensure the browser uses the latest version.\n\n</page>\n\n<page>\n---\ntitle: Application check · Cloudflare One docs\ndescription: The Application Check device posture attribute checks that a\n  specific application process is running on a device. You can create multiple\n  application checks for each operating system you need to run it on, or if you\n  need to check for multiple applications.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/application-check/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/application-check/index.md\n---\n\nThe Application Check device posture attribute checks that a specific application process is running on a device. You can create multiple application checks for each operating system you need to run it on, or if you need to check for multiple applications.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Configure an application check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **Application Check**.\n\n4. You will be prompted for the following information:\n\n   1. **Name**: Enter a unique name for this device posture check.\n   2. **Operating system**: Select your operating system.\n   3. **Application path**: Enter the file path for the executable that will be running (for example, `C:\\Program Files\\myfolder\\myfile.exe`).\n\n   Note\n\n   * Be sure to enter the binary file path, not the application launch path. When checking for an application on macOS, a common mistake is to enter `/Applications/ApplicationName.app`. This will not work as `ApplicationName.app` is a folder. The executable file that will be running is located within the folder, for example `ApplicationName.app/Contents/MacOS/ApplicationName`.\n   * Some applications change their file path after an update. Ensure that the application is always in a stable location, or use an environment variable to identify a specific folder. For example, Windows provides [recognized environment variables](https://learn.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables) that you can reference in your file path (`%PROGRAMFILES%\\myfolder\\myfile.exe`).\n\n5. **Signing certificate thumbprint (recommended)**: Enter the [thumbprint of the publishing certificate](#determine-the-signing-thumbprint) used to sign the binary. Adding this information will enable the check to ensure that the application was signed by the expected software developer.\n\n6. **SHA-256 (optional)**: Enter the [SHA-256 value](#determine-the-sha-256-value) of the binary. This is used to ensure the integrity of the binary file on the device.\n\n7. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the application check is returning the expected results.\n\n## Determine the signing thumbprint\n\nThe process to determine the signing thumbprint of an application varies depending on the operating system. This is how you would look up the signing thumbprint of the Cloudflare WARP application on macOS and Windows.\n\nNote\n\nWhen setting up new device posture checks, we recommend first testing them without setting certificate thumbprint or SHA256 checksum values.\n\n### macOS\n\n1. Create a directory.",
      "language": "unknown"
    },
    {
      "code": "2. Run the following command to extract certificates for the WARP application:",
      "language": "unknown"
    },
    {
      "code": "3. Next, run the following command to extract the SHA1 thumbprint:",
      "language": "unknown"
    },
    {
      "code": "### Windows\n\n1. Open a PowerShell window.\n\n2. Use the `Get-AuthenticodeSignature` command to find the thumbprint. For example:",
      "language": "unknown"
    },
    {
      "code": "## Determine the SHA-256 value\n\nThe SHA-256 value almost always changes between versions of a file/application.\n\n### macOS\n\n1. Open a Terminal window.\n\n2. Use the `shasum` command to find the SHA256 value of the file. For example:",
      "language": "unknown"
    },
    {
      "code": "### Windows\n\n1. Open a PowerShell window.\n\n2. Use the `get-filehash` command to find the SHA256 value of the file. For example:",
      "language": "unknown"
    },
    {
      "code": "## How WARP checks for an application\n\nLearn how the WARP client determines if an application is running on various systems.\n\n### macOS\n\nTo get the list of active processes, run the following command:",
      "language": "unknown"
    },
    {
      "code": "The application path must appear in the output for the check to pass.\n\n### Linux\n\nThe WARP client gets the list of running binaries by following the soft links in `/proc/<pid>/exe`. To view all active processes and their soft links:",
      "language": "unknown"
    },
    {
      "code": "The application path must appear in the `/proc/<pid>/exe` output for the check to pass.\n\n### Windows\n\nTo get the list of active processes, run the following command:",
      "language": "unknown"
    },
    {
      "code": "The application path must appear in the output for the check to pass.\n\n</page>\n\n<page>\n---\ntitle: Carbon Black · Cloudflare One docs\ndescription: Cloudflare One can check if Carbon Black is running on a device to\n  determine if a request should be allowed to reach a protected resource.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/carbon-black/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/carbon-black/index.md\n---\n\nCloudflare One can check if [Carbon Black](https://www.carbonblack.com/) is running on a device to determine if a request should be allowed to reach a protected resource.\n\n## Prerequisites\n\n* Carbon Black agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Configure the Carbon Black check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **Carbon Black**.\n\n4. You will be prompted for the following information:\n\n   1. **Name**: Enter a unique name for this device posture check.\n   2. **Operating system**: Select your operating system. You will need to configure one posture check per operating system (macOS and Windows currently supported).\n   3. **Application Path**: Enter the full path to the Carbon Black process to be checked (for example, `c:\\program files\\CarbonBlack\\CarbonBlack.exe`).\n   4. **Signing certificate thumbprint (recommended)**: Enter the thumbprint of the publishing certificate used to sign the binary. This proves the binary came from Carbon Black and is the recommended way to validate the process.\n   5. **SHA-256 (optional)**: Enter a SHA-256 value. This is used to validate the SHA256 signature of the binary and ensures the integrity of the binary file on the device. Note: do not fill out this field unless you strictly control updates to Carbon Black, as this will change between versions.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the Carbon Black check is returning the expected results.\n\n</page>\n\n<page>\n---\ntitle: Client certificate · Cloudflare One docs\ndescription: The Client Certificate device posture attribute checks if the\n  device has a valid client certificate signed by a trusted certificate. The\n  trusted certificate is uploaded to Cloudflare and specified as part of the\n  posture check rule. The client certificate posture check can be used in\n  Gateway and Access policies to ensure that the user is connecting from a\n  managed device.\nlastUpdated: 2025-10-28T21:24:57.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/index.md\n---\n\nThe Client Certificate device posture attribute checks if the device has a valid client certificate signed by a trusted certificate. The trusted certificate is uploaded to Cloudflare and specified as part of the posture check rule. The client certificate posture check can be used in Gateway and Access policies to ensure that the user is connecting from a managed device.\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/teams-pricing/) |\n| - | - |\n| All modes | All plans |\n\n| System | Availability | Minimum WARP version1 |\n| - | - | - |\n| Windows | ✅ | 2024.6.415.0 |\n| macOS | ✅ | 2024.6.416.0 |\n| Linux | ✅ | 2024.6.497.0 |\n| iOS | ❌ | |\n| Android | ❌ | |\n| ChromeOS | ❌ | |\n\n1 Client certificate checks that ran on an earlier WARP version will continue to work. To configure a new certificate check, update WARP to the versions listed above.\n\n## Prerequisites\n\n* A CA that issues client certificates for your devices. WARP does not evaluate the certificate trust chain; this needs to be the issuing certificate.\n\n  Upload the signing certificate that issued the client certificate\n\n  When uploading a certificate to use in posture checks, Cloudflare does not differentiate between root and intermediate certificates. You must upload the actual signing certificate - the one that directly signed the client certificate.\n\n  If you upload a different certificate, even if it exists higher up in the trust chain (for example, the root that issued the signing certificate), the posture check will fail.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device.\n\n* A client certificate is [installed and trusted](#configure-the-client-certificate-check) on the device.\n\nNote\n\nTo generate a sample root CA for testing, refer to [Generate mTLS certificates](https://developers.cloudflare.com/cloudflare-one/access-controls/service-credentials/mutual-tls-authentication/#generate-mtls-certificates).\n\n## Configure the client certificate check\n\n1. Use the [Upload mTLS certificate endpoint](https://developers.cloudflare.com/api/resources/mtls_certificates/methods/create/) to upload the certificate and private key to Cloudflare. The certificate must be a signing certificate, formatted as a single string with `\\n` replacing the line breaks. The private key is only required if you are using this custom certificate for Gateway HTTPS inspection.\n\n   Required API token permissions\n\n   At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n   * `Account: SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "The response will return a UUID for the certificate. For example:",
      "language": "unknown"
    },
    {
      "code": "2. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n3. Go to **WARP client checks** and select **Add a check**.\n\n4. Select **Client certificate**.\n\n5. You will be prompted for the following information:\n\n   1. **Name**: Enter a unique name for this device posture check.\n\n   2. **Operating system**: Select your operating system.\n\n   3. **OS locations**: Specify the location(s) where the client certificate is installed.\n\n      Windows\n\n      * Local machine trust store\n      * User trust store\n\n      macOS\n\n      * System keychain\n\n      Linux\n\n      * NSSDB (`/etc/pki/nssdb`) - To search a custom location, enter the absolute file path(s) to the certificate and private key (for example `/usr/local/mycompany/certs/client.pem` and `/usr/local/mycompany/certs/client_key.pem`). The certificate and private key must be in `PEM` format. They can either be in two different files or the same file.\n\n   4. **Certificate ID**: Enter the UUID of the signing certificate.\n\n   5. **Common name**: (Optional) To check for a Common Name (CN) on the client certificate, enter a string with optional `${serial_number}` and `${hostname}` variables (for example, `${serial_number}_mycompany`). WARP will search for an exact, case-insensitive match. If you do not specify a common name, WARP will ignore the common name field on the certificate.\n\n   6. **Check for Extended Key Usage**: (Optional) Check whether the client certificate has one or more attributes set. Supported values are **Client authentication** (`1.3.6.1.5.5.7.3.2`) and/or **Email** (`1.3.6.1.5.5.7.3.4`).\n\n   7. **Check for private key**: (Recommended) When enabled, WARP checks that the device has a private key associated with the client certificate.\n\n   8. **Subject Alternative Name**: (Optional) To check for a Subject Alternative Name (SAN) on the client certificate, enter a string with optional `${serial_number}` and `${hostname}` variables (for example, `${serial_number}_mycompany`). WARP will search for an exact, case-insensitive match. You can add multiple SANs to the posture check — a certificate only needs to match one SAN for the check to pass.\n\n6. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the client certificate check is returning the expected results.\n\n## Troubleshooting\n\nYou can use the following commands to check if a client certificate is properly installed and trusted on the device.\n\n* Windows\n\n  1. Open a PowerShell window.\n  2. To search the local machine trust store for a certificate with a specific common name, run the following command:",
      "language": "unknown"
    },
    {
      "code": "1. To search the user trust store for a certificate with a specific common name, run the following command:",
      "language": "unknown"
    },
    {
      "code": "* macOS\n\n  1. Open Terminal.\n  2. To search System Keychain for a certificate with a specific common name, run the following command:",
      "language": "unknown"
    },
    {
      "code": "* Linux\n\n  1. Open Terminal.\n  2. To list all client certificates in NSSDB, run the following command:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "1. Open your desired certificate using its certificate nickname. The common name will appear in the line `Subject: \"CN=123456.mycompany\"`.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "For the posture check to pass, a certificate must appear in the output that validates against the uploaded signing certificate.\n\n</page>\n\n<page>\n---\ntitle: Device serial numbers · Cloudflare One docs\ndescription: Cloudflare One allows you to build Zero Trust rules based on device\n  serial numbers. You can create these rules so that access to applications is\n  granted only to users connecting from company devices.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/corp-device/index.md\n---\n\nCloudflare One allows you to build Zero Trust rules based on device serial numbers. You can create these rules so that access to applications is granted only to users connecting from company devices.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Create a list of serial numbers\n\nTo create rules based on device serial numbers, you first need to create a [Gateway List](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of numbers.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Lists**.\n\n2. Select **Create manual list** or **Upload CSV**. For larger teams, we recommend uploading a CSV or using Cloudflare's [API endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/).\n\n3. Give your list a descriptive name, as this name will appear when configuring your policies.\n\n4. Set **List Type** to *Serial numbers*.\n\n5. Enter the serial numbers of the devices your team manages, or upload your CSV file.\n\n6. Select **Save**.\n\nYou can now create an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) or a Gateway [network policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/#enforce-device-posture) that checks if the device presents a serial number on your list. In Access, the serial number check will appear as a *Device Posture - Serial Number List* selector. In Gateway, your serial number list will appear in the **Value** dropdown when you choose the [Passed Device Posture Check](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#device-posture) selector.\n\n## Validate the serial number\n\nYou can use the following commands to check the serial number of your device. The results can help you validate if the posture check is working as expected.\n\n### macOS\n\n1. Open a terminal window.\n\n2. Use the `system_profiler` command to check for the value of `SPHardwareDataType` and retrieve the serial number.",
      "language": "unknown"
    },
    {
      "code": "### Windows\n\n1. Open a PowerShell window.\n\n2. Use the `Get-CimInstance` command to get the SerialNumber property of the `Win32_BIOS` class.",
      "language": "unknown"
    },
    {
      "code": "### Linux\n\n1. Open a Terminal Window\n\n2. Use the `dmidecode` command to get the version property `system-serial-number`.",
      "language": "unknown"
    },
    {
      "code": "### iOS, Android and ChromeOS\n\nSerial number checks are not supported on mobile devices. You can identify mobile devices by a [unique client ID](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/device-uuid) instead of by serial number.\n\n</page>\n\n<page>\n---\ntitle: Device UUID · Cloudflare One docs\ndescription: Cloudflare One allows you to build Zero Trust rules based on device\n  UUIDs supplied in an MDM file. You can create these rules so that access to\n  applications is granted only to users connecting from company devices.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/device-uuid/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/device-uuid/index.md\n---\n\nCloudflare One allows you to build Zero Trust rules based on device UUIDs supplied in an MDM file. You can create these rules so that access to applications is granted only to users connecting from company devices.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## 1. Assign UUIDs to devices\n\nYou will need to use a [managed deployment tool](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/) to assign UUIDs. It is not possible to assign them manually.\n\n1. Generate a unique identifier for each corporate device. For best practices on choosing UUIDs, refer to the [Android documentation](https://developer.android.com/training/articles/user-data-ids#best-practices-android-identifiers).\n\n2. Enter the UUIDs into your MDM configuration file using the [`unique_client_id` key](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#unique_client_id).\n\n## 2. Create a list of UUIDs\n\nTo create rules based on device UUIDs, you first need to create a [Gateway List](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of UUIDs.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Lists**.\n\n2. Select **Create manual list** or **Upload CSV**. For larger teams, we recommend uploading a CSV or using Cloudflare's [API endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/methods/list/).\n\n3. Give your list a descriptive name, as this name will appear when configuring your policies.\n\n4. Set **List Type** to *Device IDs*.\n\n5. Enter the UUIDs of the devices your team manages, or upload your CSV file.\n\n6. Select **Save**.\n\nNote\n\nHyphens are automatically stripped from UUIDs. For example, the posture check will match `123e4567-e89b-12d3-a456-426614174000` to `123e4567e89b12d3a456426614174000`.\n\n## 3. Enable the posture check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **Unique Client ID**.\n\n4. You will be prompted for the following information:\n\n   * **Name**: Enter a unique name for this device posture check.\n   * **Operating system**: Select the operating system of the device.\n   * **List**: Select your [list of UUIDs](#2-create-a-list-of-uuids).\n\n5. Select **Save**.\n\n6. [Verify](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#2-verify-device-posture-checks) that the posture check is returning the expected results.\n\nYou can now create an Access or Gateway device posture policy that checks if the device presents a UUID on your list.\n\n</page>\n\n<page>\n---\ntitle: Disk encryption · Cloudflare One docs\ndescription: The Disk Encryption device posture attribute ensures that disks are\n  encrypted on a device.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/disk-encryption/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/disk-encryption/index.md\n---\n\nThe Disk Encryption device posture attribute ensures that disks are encrypted on a device.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Enable the disk encryption check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n2. Go to **WARP client checks** and select **Add a check**.\n3. Select **Disk Encryption**.\n4. Enter a descriptive name for the check.\n5. Select your operating system.\n6. Either enable disk encryption for all volumes, or input the specific volume(s) you want to check for encryption (for example, `C`).\n7. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the disk encryption check is returning the expected results.\n\n## Validate disk encryption status\n\nThe following commands will return the disk encryption status on various operating systems. The results can help you validate if the posture check is working as expected.\n\n### macOS\n\n1. Open a terminal window.\n\n2. Run the `/usr/sbin/system_profiler SPStorageDataType` command to return a list of drivers on the system and note the value of **Mount Point**.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "3. Run the `diskutil info` command for a specific **Mount Point** and look for the value returned for **FileVault**. It must show **Yes** for the disk to be considered encrypted.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### Windows\n\n1. Open a PowerShell window.\n2. Run the `Get-BitLockerVolume` command to list all volumes detected on the system.\n3. **Protection Status** must be set to **On** for the disk to be considered encrypted.\n\n### Linux\n\nList all hard drives on the system:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "On Linux, encryption is reported per mounted partition, not physical drive. In the example above, the root and swap partitions are considered encrypted because they are located within a `crypt` container. The `/boot` and `/boot/efi` partitions remain unencrypted.\n\n### iOS, Android and ChromeOS\n\nThese platforms are always encrypted and so no disk encryption check is supported.\n\n</page>\n\n<page>\n---\ntitle: Domain joined · Cloudflare One docs\ndescription: The Domain Joined device posture attribute ensures that a user is a\n  member of a specific Windows Active Directory domain.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/domain-joined/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/domain-joined/index.md\n---\n\nThe Domain Joined device posture attribute ensures that a user is a member of a specific Windows Active Directory domain.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Enable the Domain Joined check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **Domain Joined**.\n\n4. Enter a descriptive name for the check.\n\n5. Select your operating system.\n\n6. Enter the domain you want to check for, such as `example.com`.\n\n   Note\n\n   The **Domain** field is case-sensitive. If your domain is `example.com`, entering `Example.com` will fail the posture check.\n\n7. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the Domain Joined check is returning the expected results.\n\n## Validate the domain value\n\nTo check the domain value on your Windows device:\n\n1. Open a PowerShell window.\n\n2. Run the following command:",
      "language": "unknown"
    },
    {
      "code": "The command will return the Active Directory domain to which your device belongs.\n\n</page>\n\n<page>\n---\ntitle: File check · Cloudflare One docs\ndescription: The File Check device posture attribute checks for the presence of\n  a file on a device. You can create multiple file checks for each operating\n  system you need to run it on, or if you need to check for multiple files.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/file-check/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/file-check/index.md\n---\n\nThe File Check device posture attribute checks for the presence of a file on a device. You can create multiple file checks for each operating system you need to run it on, or if you need to check for multiple files.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Configure a file check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **File Check**.\n\n4. You will be prompted for the following information:\n\n   1. **Name**: Enter a unique name for this device posture check.\n   2. **Operating system**: Select your operating system.\n   3. **File Path**: Enter a file path (for example, `c:\\my folder\\myfile.exe`).\n   4. **Signing certificate thumbprint (recommended)**: Enter the [thumbprint](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/application-check/#determine-the-signing-thumbprint) of the publishing certificate used to sign the file. Adding this information will enable the check to ensure that the file was signed by the expected software developer.\n   5. **SHA-256 (optional)**: Enter the [SHA-256 value](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/application-check/#determine-the-sha-256-value) of the file. This is used to ensure the integrity of the file on the device.\n\n5. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the file check is returning the expected results.\n\n</page>\n\n<page>\n---\ntitle: Firewall · Cloudflare One docs\ndescription: The Firewall device posture attribute ensures that a firewall is\n  running on a device.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/firewall/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/firewall/index.md\n---\n\nThe Firewall device posture attribute ensures that a firewall is running on a device.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Enable the firewall check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n2. Go to **WARP client checks** and select **Add a check**.\n3. Select **Firewall**.\n4. Enter a descriptive name for the check.\n5. Select your operating system.\n6. Turn on **Enable firewall check**.\n7. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the firewall check is returning the expected results.\n\n## How WARP checks the firewall status\n\nOperating systems determine firewall configuration in various ways. Follow the steps below to understand how the WARP client determines if the firewall is enabled.\n\n### On macOS\n\nmacOS has two firewalls: an application-based firewall and a port-based firewall. The WARP client will report a firewall is enabled if either firewall is running.\n\n#### Application-based firewall\n\n1. Open **System Settings** and go to **Network**.\n2. Verify that **Firewall** is `Active`.\n\n#### Port-based firewall\n\n1. Open Terminal and run:",
      "language": "unknown"
    },
    {
      "code": "2. Verify that **Status** is `Enabled`.\n\n### On Windows\n\n1. Open PowerShell and run:",
      "language": "unknown"
    },
    {
      "code": "2. Verify that **Enabled** is `True`.\n\n</page>\n\n<page>\n---\ntitle: OS version · Cloudflare One docs\ndescription: The OS Version device posture attribute checks whether the version\n  of a device's operating system matches, is greater than or lesser than the\n  configured value.\nlastUpdated: 2025-11-11T17:21:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/index.md\n---\n\nThe OS Version device posture attribute checks whether the version of a device's operating system matches, is greater than or lesser than the configured value.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Enable the OS version check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **OS version**.\n\n4. Configure the **Operating system**, **Operator**, and **Version** fields to specify the [OS version](#determine-the-os-version) you want devices to match.\n\n   Note\n\n   The OS version must be specified as a valid [Semver](https://semver.org/). For example, if your device is running OS version `1.2`, you must enter `1.2.0`.\n\n5. (Optional) Configure additional OS-specific fields:\n\n   * Windows\n\n     To check that Windows devices have required security patches and features installed, include an Update Build Revision (UBR) number in the OS version check.\n\n     * **Update Build Revision**: Enter the Windows UBR you want devices to match (for example, `3803`). The UBR is the fourth part of the full Windows version number (for example, in `10.0.19045.3803`, the UBR is `3803`).\n\n   * macOS\n\n     * **Rapid Security Response Version**: Enter the macOS [Rapid Security Response (RSR)](https://support.apple.com/guide/deployment/rapid-security-responses-dep93ff7ea78/web) version you want devices to match (for example, `(a)`). Be sure to include the parenthesis around the letter.\n\n   * Linux\n\n     * **Distro name** and **Distro revision**: Enter the Linux distribution you want devices to match (for example, `ubuntu 22.04`). The distro version always matches with an equal-to operator (==) regardless of the **Operator** setting.\n\n     * **Patch Version**: Enter the [patch version](#linux) of the kernel. For example, if the kernel is `6.50.0-1007-oem`, enter `1007`.\n\n   * iOS\n\n     * **Rapid Security Response Version**: Enter the iOS [Rapid Security Response (RSR)](https://support.apple.com/guide/deployment/rapid-security-responses-dep93ff7ea78/web) version you want devices to match (for example, `(a)`). Be sure to include the parenthesis around the letter.\n\n6. Select **Save**.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the OS version check is returning the expected results.\n\n## Determine the OS version\n\nOperating systems display version numbers in different ways. This section covers how to retrieve the version number in each OS, in a format matching what the OS version posture check expects.\n\n### macOS\n\n1. Open a terminal window.\n\n2. Use the `defaults` command to check for the value of `SystemVersionStampAsString`.",
      "language": "unknown"
    },
    {
      "code": "### Windows\n\nWindows version numbers consist of four parts: `Major.Minor.Build.UBR`. For example, `10.0.19045.3803` where:\n\n* `10.0` is the **Version** (Major.Minor)\n* `19045` is the **Build** number\n* `3803` is the **UBR** (Update Build Revision)\n\nTo determine the Windows version on your device:\n\n1. Open a PowerShell window.\n\n2. Get the **Version** (Major.Minor.Build):",
      "language": "unknown"
    },
    {
      "code": "This returns the version in the format `Major.Minor.Build` (for example, `10.0.19045`).\n\n3. Get the **UBR** (Update Build Revision):",
      "language": "unknown"
    },
    {
      "code": "This returns the UBR value (for example, `3803`).\n\n### Linux\n\n#### OS version\n\nThe Linux OS version check reads the system kernel version.\n\n1. Open a Terminal window.\n\n2. Run the `uname -r` command to get the complete kernel version. For example,",
      "language": "unknown"
    },
    {
      "code": "3. **Version** is the first three numbers of the output in SemVer format (`5.14.0`).\n\n4. **Patch Version** is the first number after the SemVer (`25`).\n\n#### Distro version\n\nThe WARP client reads **Distro name** and **Distro revision** from the `/etc/os-release` file. The name comes from the **ID** field, and the revision comes from the **VERSION\\_ID** field.\n\nTo determine the Linux distro version on your device:\n\n1. Open a Terminal window.\n\n2. Get the OS identification fields that contain `ID`:",
      "language": "unknown"
    },
    {
      "code": "3. If the output of the above command contained `ID=ubuntu` and `VERSION_ID=22.04`, **Distro name** would be `ubuntu` and **Distro revision** would be `22.04`. The WARP client will check these strings for an exact match.\n\n### ChromeOS\n\nChromeOS version numbers consist of [four parts](https://www.chromium.org/developers/version-numbers/): `MAJOR.MINOR.BUILD.PATCH`. The OS version posture check returns `MAJOR.MINOR.BUILD`.\n\nTo determine the ChromeOS version on your device:\n\n1. Open Chrome browser and go to `chrome://system`.\n\n2. Find the following values:\n\n   | Property | OS version component |\n   | - | - |\n   | `CHROMEOS_RELEASE_CHROME_MILESTONE` | `MAJOR` |\n   | `CHROMEOS_RELEASE_BUILD_NUMBER` | `MINOR` |\n   | `CHROMEOS_RELEASE_BRANCH_NUMBER` | `BUILD` |\n\n3. The OS version in Semver format is `MAJOR.MINOR.BUILD` (for example, `103.14816.131`).\n\n</page>\n\n<page>\n---\ntitle: Require Gateway · Cloudflare One docs\ndescription: With Require Gateway, you can allow access to your applications\n  only to devices enrolled in your Zero Trust organization. Unlike Require WARP,\n  which will check for any WARP instance (including the consumer version),\n  Require Gateway will only allow requests coming from devices whose traffic is\n  filtered by your organization's Cloudflare Gateway configuration. This policy\n  is best used when you want to protect company-owned assets by only allowing\n  access to employees.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-gateway/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-gateway/index.md\n---\n\nWith Require Gateway, you can allow access to your applications only to devices enrolled in your Zero Trust organization. Unlike [Require WARP](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-warp/), which will check for any WARP instance (including the consumer version), Require Gateway will only allow requests coming from devices whose traffic is filtered by your organization's Cloudflare Gateway configuration. This policy is best used when you want to protect company-owned assets by only allowing access to employees.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## 1. Enable the Gateway check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **Gateway**, then select **Save**.\n\n## 2. Add the check to an Access application\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Locate the application for which you want to require Gateway. Select **Configure**.\n\n3. In the **Policies** tab, create a new Access policy or edit an existing policy.\n\n4. In the policy builder, add an Include or Require rule which uses the *Gateway* selector. Save the policy.\n\n5. Save the Access application.\n\nBefore granting access to the application, the policy will check that the device is running the WARP client and enrolled in your Zero Trust organization.\n\n</page>\n\n<page>\n---\ntitle: Require WARP · Cloudflare One docs\ndescription: Cloudflare One enables you to restrict access to your applications\n  to devices running the Cloudflare WARP client. This allows you to flexibly\n  ensure that a user's traffic is secure and encrypted before allowing access to\n  a resource protected behind Cloudflare One.\nlastUpdated: 2025-10-28T22:09:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-warp/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/require-warp/index.md\n---\n\nNote\n\nThis device posture attribute will check for all versions of WARP, including the consumer version.\n\nCloudflare One enables you to restrict access to your applications to devices running the Cloudflare WARP client. This allows you to flexibly ensure that a user's traffic is secure and encrypted before allowing access to a resource protected behind Cloudflare One.\n\n## Prerequisites\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## 1. Enable the WARP check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. Ensure that *Allow Secure Web Gateway to proxy traffic*\\* is enabled.\n3. Go to **Reusable components** > **Posture checks**.\n4. In **WARP client checks**, select **Add a check**.\n5. Select **WARP**, then select **Save**.\n\n## 2. Add the check to an Access policy\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Locate the application for which you want to require WARP. Select **Configure**.\n\n3. In the **Policies** tab, create a new Access policy or edit an existing policy.\n\n4. In the policy builder, add an Include or Require rule which uses the *WARP* selector. Save the policy.\n\n5. Save the Access application.\n\nBefore granting access to the application, the policy will check that the device is running the WARP client.\n\n</page>\n\n<page>\n---\ntitle: SentinelOne - WARP client checks · Cloudflare One docs\ndescription: Cloudflare One can check if SentinelOne is running on a device to\n  determine if a request should be allowed to reach a protected resource.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/sentinel-one/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/sentinel-one/index.md\n---\n\nCloudflare One can check if [SentinelOne](https://www.sentinelone.com/) is running on a device to determine if a request should be allowed to reach a protected resource.\n\n## Prerequisites\n\n* SentinelOne agent is deployed on the device.\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [WARP Client Checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/).\n\n## Configure the SentinelOne check\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n2. Go to **WARP client checks** and select **Add a check**.\n\n3. Select **SentinelOne**.\n\n4. You will be prompted for the following information:\n\n   1. **Name**: Enter a unique name for this device posture check.\n\n   2. **Operating system**: Select your operating system. You will need to configure one posture check per operating system.\n\n   3. **Application Path**: Enter the full path to the SentinelOne process to be checked (for example, `C:\\Program Files\\SentinelOne\\Sentinel Agent 21.7.4.1043\\SentinelAgent.exe`).\n\n      Note\n\n      The path of the SentinelOne process may change between updates. Make sure to edit **Application Path** to match the new path, or use `%PATH%` variables.\n\n   4. **Signing certificate thumbprint (recommended)**: Enter the thumbprint of the publishing certificate used to sign the binary. This proves the binary came from SentinelOne and is the recommended way to validate the process.\n\n   5. **SHA-256 (optional)**: Enter a SHA-256 value. This is used to validate the SHA256 signature of the binary and ensures the integrity of the binary file on the device. Note: do not fill out this field unless you strictly control updates to SentinelOne, as this will change between versions.\n\nNext, go to **Insights** > **Logs** > **Posture logs** and verify that the SentinelOne check is returning the expected results.\n\n</page>\n\n<page>\n---\ntitle: Integrate Tanium with Access · Cloudflare One docs\ndescription: Cloudflare Access can use endpoint data from Tanium™ to determine\n  if a request should be allowed to reach a protected resource. When users\n  attempt to connect to a resource protected by Access with a Tanium rule,\n  Cloudflare Access will validate the user's identity, and the browser will\n  connect to the Tanium agent before making a decision to grant access.\nlastUpdated: 2025-10-28T21:24:57.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/tanium/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/tanium/index.md\n---\n\nNote\n\nNot recommended for new deployments. We recommend using the [Tanium service-to-service integration](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/taniums2s/) to get device posture signals from Tanium.\n\nCloudflare Access can use endpoint data from [Tanium™](https://www.tanium.com/) to determine if a request should be allowed to reach a protected resource. When users attempt to connect to a resource protected by Access with a Tanium rule, Cloudflare Access will validate the user's identity, and the browser will connect to the Tanium agent before making a decision to grant access.\n\nGateway policy limitation\n\nThe legacy Tanium integration cannot be used in [Gateway network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#device-posture). Only [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) are supported.\n\n## Prerequisites\n\n* Tanium Core Platform version 7.2 or later\n\n* Cloudflare WARP client is [deployed](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on the device. For a list of supported modes and operating systems, refer to [Access integrations](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/access-integrations/).\n\n## Integrate Tanium with Cloudflare Access\n\nNote\n\nThe integration does not currently support Safari.\n\n1. Configure your Tanium deployment using the [step-by-step documentation](https://docs.tanium.com/endpoint_identity/endpoint_identity/userguide.html) provided. You will need the public key to integrate your Tanium deployment with Cloudflare Access.\n\n2. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Posture checks**.\n\n3. Go to **WARP client checks** and select **Add a check**.\n\n4. Select **Tanium** from the list of providers.\n\n5. Enter any **Name** for the integration.\n\n6. For **Port**, enter `17472`.\n\n   This is the default port used by the Tanium endpoints to communicate inbound and outbound with Cloudflare Access. You may need to modify it to reflect your organization's deployment.\n\n7. Input the public certificate generated in Step 1.\n\n   Adding the certificate allows Cloudflare to validate that the response from the Tanium agent is valid.\n\nYou can now build [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) that check [device posture signals](#tanium-endpoint-signals) from the Tanium endpoint.\n\n## Example Access policy\n\nThis example will only grant access to users who are part of your team's email domain and running the Tanium agent.\n\n| Action | Rule type | Selector | Value |\n| - | - | - | - |\n| Allow | Include | Emails Ending in | `@team.com` |\n| | Require | Device Posture - Tanium | `Managed` |\n\nThe Tanium rule will require that the device connecting is managed in your Tanium deployment and has checked into the Tanium server in the last 7 days.\n\n## Tanium endpoint signals\n\n| Signal | Value | Description |\n| - | - | - |\n| Managed | Boolean | Validates that the device is managed in your organization's Tanium account. |\n\n</page>\n\n<page>\n---\ntitle: Install certificate using WARP · Cloudflare One docs\ndescription: Automatically deploy a root certificate on desktop devices.\nlastUpdated: 2025-12-30T20:00:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/index.md\n---\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/teams-pricing/) |\n| - | - |\n| All modes | All plans |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows | ✅ | 2024.12.554.0 |\n| macOS | ✅ | 2024.12.554.0 |\n| Linux \\* | ✅ | 2024.12.554.0 |\n| iOS | ❌ | |\n| Android | ❌ | |\n| ChromeOS | ❌ | |\n\n\\* Only supported on Debian-based systems.\n\nThe [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) can automatically install a Cloudflare certificate or [custom root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/) on Windows, macOS, and Debian/Ubuntu Linux devices. On mobile devices and Red Hat-based systems, you will need to [install the certificate manually](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/).\n\nThe certificate is required if you want to [apply HTTP policies to encrypted websites](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/), display custom [block pages](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/), and more.\n\n## Install a certificate using WARP\n\nTo configure WARP to install a root certificate on your organization's devices:\n\n1. (Optional) [Upload](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/) a custom root certificate to Cloudflare.\n2. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices** > **Management**.\n3. Under **Global WARP settings**, turn on [**Install CA to system certificate store**](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#install-ca-to-system-certificate-store).\n4. [Install](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/) the WARP client on the device.\n5. [Enroll the device](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) in your Zero Trust organization.\n6. (Optional) If the device is running macOS Big Sur or newer, [manually trust the certificate](#manually-trust-the-certificate).\n\nWARP will now download any [certificates set to **Available**](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/#activate-a-root-certificate). After download, WARP will add the certificates to the device's system certificate store in `installed_certs/<certificate_id>.pem` and append the contents to the `installed_cert.pem` file. If you have any scripts using `installed_cert.pem`, Cloudflare recommends you set them to use the individual files in the `installed_certs/` directory instead. `installed_certs.pem` will be deprecated by 2025-06-31.\n\nNote\n\nIt may take up to 10 minutes for newly updated settings to propagate to devices.\n\nWARP does not install certificates to individual applications. You will need to [manually add certificates](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#add-the-certificate-to-applications) to applications that rely on their own certificate store instead of the system certificate store.\n\n## Access the installed certificate\n\nAfter installing the certificate using WARP, you can verify successful installation by accessing the device's system certificate store.\n\n### macOS\n\nTo access the installed certificate in macOS:\n\n1. Open Keychain Access.\n2. In **System Keychains**, go to **System** > **Certificates**.\n3. Open your certificate. The default Cloudflare certificate name is **Gateway CA - Cloudflare Managed G1**.\n4. If the certificate is trusted by all users, Keychain Access will display **This certificate is marked as trusted for all users**.\n\nThe WARP client will also place the certificate in `/Library/Application Support/Cloudflare/installed_cert.pem` for reference by scripts or tools.\n\n#### Manually trust the certificate\n\nmacOS Big Sur and newer do not allow WARP to automatically trust the certificate. To manually trust the certificate:\n\n1. In Keychain Access, [find and open the certificate](#macos).\n2. Open **Trust**.\n3. Set **When using this certificate** to *Always Trust*.\n4. (Optional) Restart the device to reset connections to Zero Trust.\n\nAlternatively, you can configure your mobile device management (MDM) to automatically trust the certificate on all of your organization's devices.\n\n### Windows\n\nTo access the installed certificate in Windows:\n\n1. Open the Start menu and select **Run**.\n2. Enter `certlm.msc`.\n3. Go to **Trusted Root Certification Authority** > **Certificates**. The default Cloudflare certificate name is **Gateway CA - Cloudflare Managed G1**.\n\nThe WARP client will also place the certificate in `%PROGRAMDATA%\\Cloudflare\\installed_cert.pem` for reference by scripts or tools.\n\n### Debian-based Linux distributions\n\nOn Debian-based Linux distributions, the certificate is stored in `/usr/local/share/ca-certificates`. The default installed Cloudflare certificate name is `managed-warp.pem`. The WARP client will create a symbolic link named `managed-warp.crt` to use as its root certificate. If your system is not using `managed-warp.crt`, run the following commands to update the system store:\n\n1. Update your list of custom CA certificates.",
      "language": "unknown"
    },
    {
      "code": "2. Go to the system certificate store.",
      "language": "unknown"
    },
    {
      "code": "3. Verify your system has both the `managed-warp.pem` file and the `managed-warp.crt` symbolic link. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "The WARP client will also place the certificate in `/var/lib/cloudflare-warp/installed_cert.pem` for reference by scripts or tools.\n\n## Uninstall the certificate\n\nIf the certificate was installed by the WARP client, it is automatically removed when you turn on another certificate for inspection in Cloudflare One, turn off **Install CA to system certificate store**, or [uninstall WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/remove-warp/). WARP does not remove certificates that were installed manually (for example, certificates added to third-party applications).\n\nTo manually remove the certificate, refer to the instructions supplied by your operating system or the third-party application.\n\n</page>\n\n<page>\n---\ntitle: Deploy custom certificate · Cloudflare One docs\ndescription: Configure WARP to use a custom root certificate instead of the\n  Cloudflare certificate.\nlastUpdated: 2025-12-19T22:38:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/index.md\n---\n\nNote\n\nOnly available on Enterprise plans.\n\nEnterprise customers who do not wish to install a [Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/) have the option to upload their own root certificate to Cloudflare. This feature is sometimes referred to as Bring Your Own Public Key Infrastructure (BYOPKI). Gateway will use your uploaded certificate to encrypt all sessions between the end user and Gateway, enabling all HTTPS inspection features that previously required a Cloudflare certificate. You can upload multiple certificates to your account, but only one can be active at any given time. You also need to upload a private key to intercept domains with JIT certificates and to enable the [block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/).\n\nYou can upload either a root certificate or a full certificate chain (root certificate plus intermediate certificates). Uploading a certificate chain allows end-user devices to only install the root certificate, which can simplify certificate management for larger enterprises.\n\nYou can upload up to five custom root certificates. If your organization requires more than five certificates, contact your account team.\n\nWarning\n\nCustom certificates are limited to use between your users and the Gateway proxy. Gateway connects to origin servers using publicly trusted certificates, similar to how a browser validates secure websites.\n\nIf your users need to connect to self-signed origin servers, create an HTTP Allow policy for the origin server with the [untrusted certificate action](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#untrusted-certificates) set to *Pass through*.\n\n## Generate a custom root CA\n\nBefore you generate a custom root CA, make sure you have [OpenSSL](https://www.openssl.org/) installed.\n\n1. Open a terminal.\n\n2. Create a directory for the root CA and change into it.",
      "language": "unknown"
    },
    {
      "code": "3. Generate a private key for the root CA.",
      "language": "unknown"
    },
    {
      "code": "4. Generate a self-signed root certificate.",
      "language": "unknown"
    },
    {
      "code": "When preparing your certificate and private key for upload, be sure to remove any unwanted characters, such as mismatching subdomains in the certificate's common name. To review the private key, run the following command:",
      "language": "unknown"
    },
    {
      "code": "To review the certificate, run the following command:",
      "language": "unknown"
    },
    {
      "code": "## Deploy a custom root certificate\n\nYou can upload a single root certificate or a full certificate chain. When uploading a certificate chain via the dashboard, API, or Terraform, concatenate the root certificate and any intermediate certificates in PEM format, with the root certificate first.\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings** > **Certificates**.\n\n  2. Select **Upload certificate**.\n\n  3. Enter the private key and SSL certificate you generated or select **Paste certificate from file** to upload them from a file. If uploading a certificate chain, paste all certificates (root and intermediates) in PEM format with the root certificate first.\n\n  4. Select **Upload custom certificate**.\n\n     You can now [use the generated custom root certificate](#use-a-custom-root-certificate) for inspection.\n\n* API\n\n  1. Use the [Upload mTLS certificate endpoint](https://developers.cloudflare.com/api/resources/mtls_certificates/methods/create/) to upload the certificate and private key to Cloudflare. The certificate must be a root CA or certificate chain, formatted as a single string with `\\n` replacing the line breaks.\n\n     Required API token permissions\n\n     At least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n     * `Account: SSL and Certificates Write`",
      "language": "unknown"
    },
    {
      "code": "The response will return a UUID for the certificate. For example:",
      "language": "unknown"
    },
    {
      "code": "When uploading a certificate chain, the `certificates` field should contain all certificates in PEM format. To format this field, order the root certificate first, then concatenate any intermediate certificates.\n\n  2. Set the certificate as available for use in inspection with the [Activate a Zero Trust certificate endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/certificates/methods/activate/). This will deploy the certificate across the Cloudflare global network.",
      "language": "unknown"
    },
    {
      "code": "The response will return the certificate and a `pending_deployment` binding status. For example:",
      "language": "unknown"
    },
    {
      "code": "3. Use the [Get Zero Trust certificate details endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/certificates/methods/get/) to verify the certificate's binding status is set to `available`.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "4. (Optional) Verify the certificate is installed on your user's devices either [with WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/) or [manually](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/).\n\n  5. Use the [Patch Zero Trust account configuration endpoint](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/configurations/methods/edit/) to turn on the certificate for use in inspection. For example:",
      "language": "unknown"
    },
    {
      "code": "Once `in-use` is set to `true`, Gateway will sign your traffic using the custom root certificate and private key. If you turn off or deactivate the custom certificate, Gateway will revert to the next available Cloudflare certificate generated for your Zero Trust account.\n\nPrivate key visibility\n\nWhen you upload a private key to Zero Trust, Cloudflare encrypts the key and stores it at rest. Only your delegated apps have the necessary decryption keys to decrypt the private key. You will not be able to retrieve the private key after upload.\n\n## Use a custom root certificate\n\nTo use a custom root certificate you generated and uploaded to Cloudflare, refer to [Activate a root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/#activate-a-root-certificate).\n\n## Troubleshoot HTTP errors\n\nIf Gateway returns an **HTTP Response Code: 526** after deploying a custom certificate, you can [troubleshoot errors with our FAQ](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#i-see-error-526-when-browsing-to-a-website).\n\n</page>\n\n<page>\n---\ntitle: Install certificate manually · Cloudflare One docs\ndescription: Manually add a Cloudflare certificate to mobile devices and\n  individual applications.\nlastUpdated: 2025-12-19T22:24:02.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/index.md\n---\n\nNote\n\nThis procedure is only required to enable specific Cloudflare Zero Trust features, and should only be done at the direction of your IT department. This procedure is not required to enable the WARP client for consumers.\n\nIf your device does not support [certificate installation via WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/), you can manually install a Cloudflare certificate. You must add the certificate to both the [system keychain](#add-the-certificate-to-operating-systems) and to [individual application stores](#add-the-certificate-to-applications). These steps must be performed on each new device that is to be subject to HTTP filtering.\n\nZero Trust will only inspect traffic using installed certificates set to [**Available** and **In-Use**](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/#activate-a-root-certificate).\n\n## Download a Cloudflare root certificate\n\nDownload limitation\n\nYou can only download Cloudflare-generated certificates from the Cloudflare One dashboard or with WARP.\n\nFirst, [generate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/#generate-a-cloudflare-root-certificate) and download a Cloudflare certificate. The certificate is available in both `.pem` and `.crt` file format. Certain applications require the certificate to be in a specific file type, so ensure you download the most appropriate file for your use case.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.\n2. Select **Certificates**.\n3. Select the certificate you want to download.\n4. Select **More actions**.\n5. Depending on which format you want, choose **Download .pem** and/or **Download .crt**.\n\nAlternatively, you can download and install a certificate [using WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/#install-a-certificate-using-warp). WARP will add the certificates to the device's system certificate store in `installed_certs/<certificate_id>.pem`.\n\n### Verify the downloaded certificate\n\nTo verify your download, use a terminal to check that the downloaded certificate's hash matches the thumbprint listed under **Certificate thumbprint**. For example:\n\n#### SHA1",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "#### SHA256",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### Convert the certificate\n\nSome applications require a certificate formatted in the `.cer` file type. You can convert your downloaded certificate using [OpenSSL](https://www.openssl.org/):\n\n* macOS and Linux\n\n  1. [Install OpenSSL](https://wiki.openssl.org/index.php/Compilation_and_Installation).\n\n  2. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  3. In a terminal, convert the certificate to DER format with the `.cer` file type:",
      "language": "unknown"
    },
    {
      "code": "* Windows\n\n  1. [Install OpenSSL for Windows](https://slproweb.com/products/Win32OpenSSL.html).\n\n  2. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  3. In a PowerShell terminal, convert the certificate to DER format with the `.cer` file type:",
      "language": "unknown"
    },
    {
      "code": "## Add the certificate to operating systems\n\n### macOS\n\nIn macOS, you can choose the keychain in which you want to install the certificate. Each keychain impacts which users will be affected by trusting the root certificate.\n\n| Keychain | Access scope |\n| - | - |\n| login | The logged in user |\n| Local Items | Users with access to cached iCloud passwords |\n| System | All users on the system |\n\nTo install a Cloudflare certificate in macOS, you can use either the Keychain Access application or a terminal. Both methods require you to [download a certificate](#download-the-cloudflare-root-certificate) in `.crt` format.\n\n* Keychain Access\n\n  1. Download a Cloudflare certificate.\n\n     1. Open the `.crt` file in Keychain Access. If prompted, enter your local password.\n     2. In **Keychain**, choose the access option that suits your needs and select **Add**.\n     3. In the list of certificates, locate the newly installed certificate. Keychain Access will mark this certificate as not trusted. Right-click the certificate and select **Get Info**.\n     4. Select **Trust**. Under **When using this certificate**, select *Always Trust*.\n\n  The root certificate is now installed and ready to be used.\n\n* Terminal\n\n  1. Download a Cloudflare certificate.\n  2. Open Terminal.\n  3. Add the certificate to your keychain:",
      "language": "unknown"
    },
    {
      "code": "This keychain will allow all users on the system access to the certificate. If you want to install the certificate to a different keychain, replace `System.keychain` with the name of that keychain.\n\n  1. Update the OpenSSL CA Store to include the Cloudflare certificate:",
      "language": "unknown"
    },
    {
      "code": "The root certificate is now installed and ready to be used.\n\nChange certificate access scope\n\nIf you want to change user access to the Cloudflare certificate, you can open Keychain Access and move the certificate to a different keychain on the left sidebar.\n\n### Windows\n\nWindows offers two locations to install the certificate, each impacting which users will be affected by trusting the root certificate.\n\n| Store location | Access scope |\n| - | - |\n| Current User Store | The logged in user |\n| Local Machine Store | All users on the system |\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate).\n2. Right-click the certificate file.\n3. Select **Open**. If a security warning appears, choose **Open** to proceed.\n4. The **Certificate** window will appear. Select **Install Certificate**.\n5. Now choose a Store Location. If a security warning appears, choose **Yes** to proceed.\n6. On the next screen, select **Browse**.\n7. In the list, choose the *Trusted Root Certification Authorities* store.\n8. Select **OK**, then select **Finish**.\n\nThe root certificate is now installed and ready to be used.\n\nWarning\n\nIf your certificate is installed in the **Local Machine Store**, the [device posture check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/) looking for a certificate will fail. Install the certificate in the **Current User Store** to ensure a successful posture device check.\n\n### Linux\n\nThe location where the root certificate should be installed is different depending on your Linux distribution. Follow the specific instructions for your distribution.\n\n* Debian-based\n\n  The following procedure applies to Debian-based systems, such as Debian, Ubuntu, and Kali Linux.\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  2. Install the `ca-certificates` package.",
      "language": "unknown"
    },
    {
      "code": "3. Copy the certificate to the system, changing the file extension to `.crt`.",
      "language": "unknown"
    },
    {
      "code": "4. Import the certificate.",
      "language": "unknown"
    },
    {
      "code": "* Red Hat-based\n\n  The following procedure applies to Red Hat-based systems, such as CentOS and Red Hat Enterprise Linux (RHEL).\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in both `.crt` and `.pem` format.\n\n  2. Install the `ca-certificates` package.",
      "language": "unknown"
    },
    {
      "code": "3. Copy both certificates to the trust store.",
      "language": "unknown"
    },
    {
      "code": "4. Import the certificate.",
      "language": "unknown"
    },
    {
      "code": "* NixOS\n\n  NixOS does not use the system certificate store for self updating and instead relies on the certificates found in `~/.nix-profile/etc/ssl/certs` or provided by `NIX_SSL_CERT_FILE` at runtime.\n\n### iOS\n\n1. In Safari, [download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. Open Files and go to **Recents**.\n3. Find and open the downloaded certificate file. A message will appear confirming the profile was downloaded. Select **Close**.\n4. Open Settings. Select the **Profile Downloaded** section beneath your Apple Account info. Alternatively, go to **General** > **VPN & Device Management** and select the **Gateway CA - Cloudflare Managed G1** profile.\n5. Select **Install**. If the iOS device is passcode-protected, you will be prompted to enter the passcode.\n6. A certificate warning will appear. Select **Install**. If a second prompt appears, select **Install** again.\n7. The Profile Installed screen will appear. Select **Done**. The certificate is now installed. However, before it can be used, it must be trusted by the device.\n8. In Settings, go to **General** > **About** > **Certificate Trust Settings**. The installed root certificates will be displayed under Enable full trust for root certificates.\n9. Turn on the Cloudflare certificate.\n10. A security warning message will appear. Choose **Continue**.\n\nThe root certificate is now installed and ready to be used.\n\n### Android\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate).\n2. In Settings, go to **Security** > **Advanced** > **Encryption & credentials** > **Install a certificate**.\n3. Select **CA certificate**.\n4. Select **Install anyway**.\n5. Verify your identity.\n6. Choose the certificate file you want to install.\n\nThe root certificate is now installed and ready to be used.\n\n### ChromeOS\n\nChromeOS devices use different methods to store and deploy root certificates. Certificates may fall under the **VPN and apps** or **CA certificate** settings. Follow the procedure that corresponds with your device.\n\n* VPN and apps\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.crt` format.\n\n  2. Go to **Settings** > **Apps** > **Google Play Store**.\n\n  3. Select **Manage Android preferences**.\n\n  4. Go to **Security & location** > **Credentials** > **Install from SD card**.\n\n  1) In the file open dialog, choose the `certificate.crt` file you downloaded. Select **Open**.\n  2) Enter a name to identify the certificate. Ensure **Credential use** is set to *VPN and apps*.\n  3) Select **OK**.\n\n* CA certificate\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.crt` format.\n\n  2. Go to **Settings** > **Apps** > **Google Play Store**.\n\n  3. Select **Manage Android preferences**.\n\n  4. Go to **Security & location** > **Credentials** > **Install a certificate > CA certificate**.\n\n  1) When prompted with a privacy warning, select **Install anyway**.\n  2) In the file open dialog, choose the `certificate.crt` file you downloaded. Select **Open**.\n  3) To verify the certificate is installed and trusted, go to **Settings** > **Apps** > **Google Play Store** > **Manage Android Preferences** > **Security** > **Credentials** > **Trusted credentials** > **User**.\n\nAfter adding the Cloudflare certificate to ChromeOS, you may also have to [install the certificate in your browser](#browsers).\n\n## Add the certificate to applications\n\nSome packages, development tools, and other applications provide options to trust root certificates that will allow for the traffic inspection features of Gateway to work without breaking the application.\n\nAll of the applications below first require downloading a Cloudflare certificate with the instructions above. On macOS, the default path to the system keychain database file is `/Library/Keychains/System.keychain`. On Windows, the default path is `\\Cert:\\CurrentUser\\Root`.\n\nNote\n\nSome applications require the use of a publicly trusted certificate — they do not trust the system certificate, nor do they have a configurable private store. For these applications to function, you must add a [Do Not Inspect policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) for the domains or IPs that the application relies on.\n\n### Browsers\n\nBrowsers may use their own certificate stores or rely on the operating system certificate store.\n\n#### Chrome\n\nVersions of Chrome before Chrome 113 use the [operating system root store](https://support.google.com/chrome/answer/95617?visit_id=638297158670039236-3119581239\\&p=root_store\\&rd=1#zippy=%2Cmanage-device-certificates-on-mac-windows) on macOS and Windows. Chrome 113 and newer on macOS and Windows -- and all versions on Linux and ChromeOS -- use the [Chrome internal trust store](https://www.chromium.org/Home/chromium-security/root-ca-policy/#introduction).\n\nTo install a Cloudflare certificate to Chrome manually:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. In Chrome, go to **Settings** > **Privacy and security** > **Security**.\n3. Select **Manage certificates**.\n4. Go to **Authorities**. Select **Import**.\n5. In the file open dialog, choose the `certificate.pem` file you downloaded.\n6. In the dialog box, turn on *Trust this certificate for identifying websites*, *Trust this certificate for identifying email users*, and *Trust this certificate for identifying software makers*. Select **OK**.\n7. To verify the certificate was installed and trusted, locate it in **Authorities**.\n\nFor information on installing a Cloudflare certificate for organizations, refer to [Google's Chrome Enterprise and Education documentation](https://support.google.com/chrome/a/answer/3505249).\n\n#### Firefox\n\nTo install a Cloudflare certificate to Firefox manually:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. In Firefox, go to **Settings** > **Privacy & Security**.\n3. In **Security**, select **Certificates** > **View Certificates**.\n4. In **Authorities**, select **Import**.\n5. In the file open dialog, choose the `certificate.pem` file you downloaded.\n6. In the dialog box, turn on *Trust this CA to identify websites* and *Trust this CA to identify email users*. Select **OK**.\n7. To verify the certificate was installed and trusted, locate it in the table under **Cloudflare**.\n\nFor information on installing a Cloudflare certificate for organizations, refer to this [Mozilla support article](https://support.mozilla.org/en-US/kb/setting-certificate-authorities-firefox).\n\n### Mobile device management (MDM) software\n\nZero Trust integrates with several [mobile device management (MDM) software partners](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/partners/) to deploy WARP across devices.\n\n#### Microsoft Intune\n\nTo upload and deploy a Cloudflare certificate in Microsoft Intune:\n\n1. [Download and convert a Cloudflare certificate](#convert-the-certificate) to DER format with the `.cer` file type.\n2. In Microsoft Intune, [create a trusted certificate profile](https://learn.microsoft.com/mem/intune/protect/certificates-trusted-root#to-create-a-trusted-certificate-profile) with your converted certificate.\n\nFor more information, refer to the [Microsoft documentation](https://learn.microsoft.com/mem/intune/protect/certificates-trusted-root).\n\n#### Jamf Pro\n\nTo upload and deploy a Cloudflare certificate in Jamf Pro:\n\n1. [Download and convert a Cloudflare certificate](#convert-the-certificate) to DER format with the `.cer` file type.\n2. In Jamf Pro, go to **Computers** > **Configuration Profiles** to create a computer configuration profile, or go to **Devices** > **Configuration Profiles** to create a mobile device configuration profile. Select **New**.\n3. Add a name and description for the profile.\n4. Choose whether you would like Jamf to install the certificate automatically or with self-service, and whether you would like to install the certificate for a single user or all users on the device.\n5. Select **Add** > **Certificate**. Choose the certificate file.\n6. Uncheck **Allow export from keychain**.\n7. Select **Scope**, then choose which devices or groups to deploy the certificate to.\n8. Select **Save**.\n\nFor more information, refer to the [Jamf Pro documentation](https://learn.jamf.com/bundle/jamf-pro-documentation-current/page/PKI_Certificates.html).\n\n#### Kandji\n\nTo upload and deploy a Cloudflare certificate in Kandji:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.crt` format.\n2. In Kandji, [upload the certificate](https://support.kandji.io/support/solutions/articles/72000558739-certificate-profile) as a PKCS #1-formatted certificate.\n\n#### Hexnode\n\nTo upload and deploy a Cloudflare certificate in Hexnode:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. In Hexnode, follow the directions for adding the certificate to [macOS](https://www.hexnode.com/mobile-device-management/help/how-to-add-certificates-for-mac-devices-with-hexnode-mdm/), [iOS](https://www.hexnode.com/mobile-device-management/help/add-certificates-for-ios-devices-with-hexnode-mdm/), and/or [Android](https://www.hexnode.com/mobile-device-management/help/how-to-add-certificates-for-android-devices-using-hexnode-mdm/) devices.\n\n#### JumpCloud\n\nTo upload and deploy a Cloudflare certificate in JumpCloud:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. In JumpCloud, [upload the certificate](https://jumpcloud.com/support/manage-device-trust-certificates#distributing-global-device-certificates-).\n3. [Configure a conditional access policy](https://jumpcloud.com/support/configure-a-conditional-access-policy) to deploy the certificate across devices.\n\n### Programming languages and runtimes\n\nProgramming language runtimes often maintain their own certificate stores or use language-specific certificate management tools.\n\n#### Python\n\nDepending on which version of Python you have installed and your configuration, you may need to use either the `python` or `python3` command. If you use [virtual environments](https://docs.python.org/3/library/venv.html), you will need to repeat the following steps within each virtual environment.\n\n* Windows\n\n  The command to install the certificate with Python on Windows automatically includes `pip` and `certifi` (the default certificate bundle for certificate validation).\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.crt` format.\n\n  2. In a PowerShell terminal, install the `certifi` package:",
      "language": "unknown"
    },
    {
      "code": "3. Identify the Python CA store:",
      "language": "unknown"
    },
    {
      "code": "4. Update the bundle to include the Cloudflare certificate:",
      "language": "unknown"
    },
    {
      "code": "5. (Optional) Configure your system variables to point to the CA store by adding them to PowerShell's configuration file:",
      "language": "unknown"
    },
    {
      "code": "6. Restart your terminal.\n\n* macOS and Linux\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  2. In a terminal, install the `certifi` package:",
      "language": "unknown"
    },
    {
      "code": "3. Append the Cloudflare certificate to this CA store by running:",
      "language": "unknown"
    },
    {
      "code": "4. (Optional) Configure your system variables to point to the CA store by adding them to your shell's configuration file (such as `~/.zshrc` or `~/.bash_profile`). For example:",
      "language": "unknown"
    },
    {
      "code": "5. Restart your terminal.\n\n#### Java\n\nJava may have multiple certificate keystore locations depending on different installations or applications that include Java. Depending on your Java Virtual Machine (JVM) installation, you may need to install the certificate for each instance. You may also need to manually configure each Java application to use and trust the certificate.\n\nTo install a Cloudflare root certificate in the system JVM, follow the procedure for your operating system. These steps require you to [download a `.pem` certificate](#download-the-cloudflare-root-certificate).\n\n* macOS and Linux\n\n  1. Install [OpenSSL](https://www.openssl.org/).\n\n  2. In a terminal, format the Cloudflare certificate for Java.",
      "language": "unknown"
    },
    {
      "code": "3. Import the converted certificate into the Java keystore.",
      "language": "unknown"
    },
    {
      "code": "4. Restart any instances of Java.\n\n* Windows\n\n  1. Install [OpenSSL for Windows](https://slproweb.com/products/Win32OpenSSL.html).\n\n  2. In an administrator PowerShell terminal, format the Cloudflare certificate for Java.",
      "language": "unknown"
    },
    {
      "code": "3. Import the converted certificate into the Java keystore.",
      "language": "unknown"
    },
    {
      "code": "4. Restart any instances of Java.\n\n#### Ruby\n\nTo trust a Cloudflare root certificate in RubyGems, follow the procedure for your operating system. These steps require you to [download a `.pem` certificate](#download-the-cloudflare-root-certificate).\n\n* macOS and Linux\n\n  1. Install [OpenSSL](https://www.openssl.org/).\n\n  2. In a terminal, format the Cloudflare certificate for Ruby.",
      "language": "unknown"
    },
    {
      "code": "3. Create a RubyGems certificate directory in your home folder.",
      "language": "unknown"
    },
    {
      "code": "4. Copy the Cloudflare certificate to your RubyGems certificate store.",
      "language": "unknown"
    },
    {
      "code": "5. Configure RubyGems to use the certificate.",
      "language": "unknown"
    },
    {
      "code": "Alternatively, add the following line to your RubyGems configuration file located in `~/.gemrc` file to globally trust the certificate:",
      "language": "unknown"
    },
    {
      "code": "6. Restart any terminal sessions.\n\n* Windows\n\n  1. Install [OpenSSL for Windows](https://slproweb.com/products/Win32OpenSSL.html).\n\n  2. In a PowerShell terminal, format the Cloudflare certificate for Ruby.",
      "language": "unknown"
    },
    {
      "code": "3. Create a RubyGems certificate directory in your home folder.",
      "language": "unknown"
    },
    {
      "code": "4. Copy the Cloudflare certificate to your RubyGems certificate store.",
      "language": "unknown"
    },
    {
      "code": "5. Configure RubyGems to use the certificate.",
      "language": "unknown"
    },
    {
      "code": "Alternatively, add the following line to your RubyGems configuration file located in `$HOME\\.gemrc` to globally trust the certificate:",
      "language": "unknown"
    },
    {
      "code": "6. Restart any terminal sessions.\n\n#### Rust\n\nRust's package manager Cargo uses the system certificate store by default on most platforms. However, you may need to configure it explicitly in some cases.\n\n* Windows\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  2. Set the `CARGO_HTTP_CAINFO` environment variable to point to the certificate. In PowerShell:",
      "language": "unknown"
    },
    {
      "code": "3. Restart your terminal.\n\n  Alternatively, you can configure this in your Cargo configuration file at `%USERPROFILE%\\.cargo\\config.toml`:",
      "language": "unknown"
    },
    {
      "code": "* macOS and Linux\n\n  1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n  2. Set the `CARGO_HTTP_CAINFO` environment variable by adding it to your shell's configuration file (such as `~/.zshrc` or `~/.bash_profile`):",
      "language": "unknown"
    },
    {
      "code": "3. Restart your terminal.\n\n  Alternatively, you can configure this in your Cargo configuration file at `~/.cargo/config.toml`:",
      "language": "unknown"
    },
    {
      "code": "### Development tools and package managers\n\nDevelopment tools and package managers often require certificate configuration for secure package downloads and repository access.\n\n#### Git\n\n* Windows\n\n  1. Open PowerShell.\n\n  2. Run the following command:",
      "language": "unknown"
    },
    {
      "code": "This command will output:",
      "language": "unknown"
    },
    {
      "code": "3. The `http.sslcainfo` defines the CA Certificate store. To append the Cloudflare certificate to the CA bundle, update `http.sslcainfo`.",
      "language": "unknown"
    },
    {
      "code": "* macOS and Linux\n\n  To configure Git to trust a Cloudflare certificate, run the following command:",
      "language": "unknown"
    },
    {
      "code": "#### npm\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Set the `cafile` configuration to use the Cloudflare certificate:",
      "language": "unknown"
    },
    {
      "code": "On some systems you may need to set the following in your path/export list:",
      "language": "unknown"
    },
    {
      "code": "#### PHP Composer\n\nThe command below will set the [`cafile`](https://getcomposer.org/doc/06-config.md#cafile) configuration inside of `composer.json` to use the Cloudflare root certificate. Make sure to [download a certificate](#download-the-cloudflare-root-certificate) in the `.pem` file type.",
      "language": "unknown"
    },
    {
      "code": "Alternatively, you can add this manually to your `composer.json` file under the `config` key.\n\n#### Docker\n\nTo install a certificate for use in a Docker container:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Create a directory for certificates in your Docker project:",
      "language": "unknown"
    },
    {
      "code": "3. Verify the certificate was moved to the directory correctly. Your project should have the following structure:",
      "language": "unknown"
    },
    {
      "code": "4. Add the certificate to your Docker image:\n\n   * During build process\n\n     To add the certificate to your Dockerfile to install it during the build process:\n\n     1. Add the certificate install directions to your Dockerfile. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "2. Build the Docker image:",
      "language": "unknown"
    },
    {
      "code": "3. Verify the certificate was installed:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "* During runtime\n\n     To add the certificate to your Docker Compose file to install it during runtime:\n\n     1. Add the certificate install directions to your `docker-compose.yml` file. For example:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "2. Run the container:",
      "language": "unknown"
    },
    {
      "code": "3. Verify the certificate was installed:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### Command-line tools\n\nCommand-line tools typically use the system certificate store but may require specific configuration.\n\n#### cURL\n\nBy default, cURL will use your operating system's native certificate store. To force cURL to use your default certificate, add the `--ca-native` flag to the command. For example:",
      "language": "unknown"
    },
    {
      "code": "* macOS\n\n  To use a Cloudflare root certificate with cURL on macOS, [install the certificate to the operating system keychain](#macos). cURL will use the macOS root certificate by default.\n\n* Windows\n\n  To use a Cloudflare certificate with the version of cURL preinstalled on Windows or another version that uses the Schannel (WinSSL) backend, [install the certificate to the Windows certificate store](#windows). If you use an older or custom version of cURL built with the OpenSSL backend, you will need to [manually configure cURL to use the certificate](#curl).\n\n* Linux\n\n  To use a Cloudflare root certificate with cURL on Linux, [install the certificate to your distribution's certificate store](#linux). cURL will use the Linux root certificate by default.\n\n#### GNU Wget\n\nBy default, GNU Wget will use your operating system's native certificate store. To force Wget to use your default certificate, add the `--ca-certificate` flag to the command.\n\n* macOS\n\n  To use a Cloudflare root certificate with Wget on macOS, [install the certificate to the operating system keychain](#macos). Wget will use the macOS root certificate by default.\n\n* Windows\n\n  To use a Cloudflare certificate with Wget on Windows, [install the certificate to the Windows certificate store](#windows). Wget will use the Windows root certificate by default.\n\n* Linux\n\n  To use a Cloudflare root certificate with Wget on Linux, [install the certificate to your distribution's certificate store](#linux). Wget will use the Linux root certificate by default.\n\n  Alternatively, you can specify a certificate file directly:",
      "language": "unknown"
    },
    {
      "code": "To make this permanent, add the following to your `~/.wgetrc` file:",
      "language": "unknown"
    },
    {
      "code": "### IDEs and development environments\n\nIntegrated development environments often use their own JVMs or certificate stores.\n\n#### Android Studio\n\nAndroid Studio uses its own JVM and certificate store. To install a Cloudflare root certificate:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate).\n\n2. Find the `java.home` value for your Android Studio installation.\n\n   1. In Android Studio, go to **Help** > **About** (or **Android Studio** > **About Android Studio** on macOS).\n\n   2. Copy the JRE path shown in the dialog. For example:",
      "language": "unknown"
    },
    {
      "code": "3. Add the Cloudflare certificate to Android Studio's JVM:\n\n* macOS and Linux\n\n  1. In a terminal, add the JRE path you copied as an environment variable.",
      "language": "unknown"
    },
    {
      "code": "2. Run `keytool` to install and trust the Cloudflare certificate.",
      "language": "unknown"
    },
    {
      "code": "3. Restart Android Studio.\n\n* Windows\n\n  1. In an administrator PowerShell terminal, add the JRE path you copied as an environment variable.",
      "language": "unknown"
    },
    {
      "code": "2. Run `keytool` to install and trust the Cloudflare certificate.",
      "language": "unknown"
    },
    {
      "code": "3. Restart Android Studio.\n\nFor Gradle builds within Android Studio, you may also need to configure the Gradle JVM to trust the certificate by following the same steps for the Gradle JVM location.\n\n#### JetBrains\n\nTo install a Cloudflare root certificate on JetBrains products, refer to the links below:\n\n* [AppCode](https://www.jetbrains.com/help/objc/settings-tools-server-certificates.html)\n* [CLion](https://www.jetbrains.com/help/clion/settings-tools-server-certificates.html)\n* [DataGrip](https://www.jetbrains.com/help/datagrip/settings-tools-server-certificates.html)\n* [DataSpell](https://www.jetbrains.com/help/dataspell/settings-tools-server-certificates.html)\n* [GoLand](https://www.jetbrains.com/help/go/settings-tools-server-certificates.html)\n* [IntelliJ IDEA](https://www.jetbrains.com/help/idea/settings-tools-server-certificates.html)\n* [PhpStorm](https://www.jetbrains.com/help/phpstorm/settings-tools-server-certificates.html)\n* [PyCharm](https://www.jetbrains.com/help/pycharm/settings-tools-server-certificates.html)\n* [Rider](https://www.jetbrains.com/help/rider/Settings_Tools_Server_Certificates.html)\n* [WebStorm](https://www.jetbrains.com/help/webstorm/settings-tools-server-certificates.html)\n\n#### Eclipse\n\nTo install a Cloudflare root certificate on Eclipse IDE for Java Developers, you must add the certificate to the Java virtual machine (JVM) used by Eclipse.\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate).\n\n2. Find the `java.home` value for your Eclipse installation.\n\n   1. In Eclipse, go to **Eclipse** > **About Eclipse** (or **Help** > **About Eclipse IDE** on Windows and Linux)\n   2. Select **Installation Details**, then go to **Configuration**.\n   3. Search for `java.home`, then locate the value. For example:",
      "language": "unknown"
    },
    {
      "code": "1. Copy the full path after `java.home=`.\n\n3. Add the Cloudflare certificate to Eclipse's JVM:\n\n* macOS and Linux\n\n  1. In a terminal, add the `java.home` value you copied as an environment variable.",
      "language": "unknown"
    },
    {
      "code": "2. Run `keytool` to install and trust the Cloudflare certificate.",
      "language": "unknown"
    },
    {
      "code": "3. Restart Eclipse.\n\n* Windows\n\n  1. In a terminal, add the `java.home` value you copied as an environment variable.",
      "language": "unknown"
    },
    {
      "code": "2. Run `keytool` to install and trust the Cloudflare certificate.",
      "language": "unknown"
    },
    {
      "code": "3. Restart Eclipse.\n\nFor more information on adding certificates to Eclipse with `keytool`, refer to [IBM's documentation](https://www.ibm.com/docs/en/ram/7.5.4?topic=client-adding-server-public-certificate-eclipse).\n\n### Cloud and infrastructure tools\n\nCloud service providers and infrastructure tools often require certificate configuration for API access and resource management.\n\n#### Google Cloud\n\n##### Google Cloud SDK\n\nThe commands below will set the Google Cloud SDK to use a Cloudflare certificate. For more information on configuring the Google Cloud SDK, refer to the [Google Cloud documentation](https://cloud.google.com/sdk/docs/proxy-settings).\n\n1. Get curl's `cacert` bundle.",
      "language": "unknown"
    },
    {
      "code": "2. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n3. Combine the certs into a single `.pem` file.",
      "language": "unknown"
    },
    {
      "code": "4. Configure Google Cloud to use the combined `.pem`.",
      "language": "unknown"
    },
    {
      "code": "Note\n\nThe file at `~/ca.pem` needs to remain in place in order for the `gcloud` utility to leverage it. If the file is moved, then you must re-run step 3 to point `gcloud` to the file's new location.\n\n##### Kaniko\n\nIf you use Kaniko with Google Cloud SDK, you must install a Cloudflare certificate in the [Kaniko CA store](https://docs.gitlab.com/ee/ci/docker/using_kaniko.html#using-a-registry-with-a-custom-certificate). For more information, refer to the [`gcloud` documentation](https://cloud.google.com/sdk/gcloud/reference/builds/submit).\n\n##### Google Apps Manager (GAM)\n\nGoogle Apps Manager (GAM) uses its own certificate store. To add a Cloudflare certificate to GAM, refer to the [GAM documentation](https://github.com/GAM-team/GAM/wiki/#using-gam-with-ssl--tls-mitm-inspection).\n\n#### AWS CLI\n\n##### Global config\n\nTo persistently set the location of the certificate:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Locate and open your [AWS configuration file](https://docs.aws.amazon.com/cli/v1/userguide/cli-configure-files.html#cli-configure-files-where).\n\n3. Configure the [`ca_bundle` setting](https://docs.aws.amazon.com/cli/v1/userguide/cli-configure-files.html#cli-configure-files-settings) with the location of your certificate. For example:",
      "language": "unknown"
    },
    {
      "code": "4. Restart your terminal.\n\n##### Environment variable\n\nTo set the location of the certificate for use as an environment variable:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. In a terminal, set the [`AWS_CA_BUNDLE` environment variable](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html) to the location of your certificate depending on your operating system.\n3. Restart your terminal.\n\n#### Azure CLI\n\n##### Global config\n\nTo persistently set the location of the certificate:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. Set the `REQUESTS_CA_BUNDLE` environment variable to point to your certificate depending on your operating system.\n\n* macOS and Linux\n\n  Add the following to your shell's configuration file (such as `~/.zshrc` or `~/.bash_profile`):",
      "language": "unknown"
    },
    {
      "code": "* Windows\n\n  In PowerShell:",
      "language": "unknown"
    },
    {
      "code": "1. Restart your terminal.\n\n##### Per-command\n\nTo set the location of the certificate for a single command:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Set the `REQUESTS_CA_BUNDLE` environment variable when running the command:",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to the [Azure CLI documentation](https://learn.microsoft.com/cli/azure/use-cli-effectively#work-behind-a-proxy).\n\n#### Boto3\n\nBoto3, the AWS SDK for Python, can be configured to use a Cloudflare certificate in several ways.\n\n##### Environment variable\n\nTo set the location of the certificate using an environment variable:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n2. Set the `AWS_CA_BUNDLE` environment variable depending on your operating system.\n\n* macOS and Linux\n\n  Add the following to your shell's configuration file (such as `~/.zshrc` or `~/.bash_profile`):",
      "language": "unknown"
    },
    {
      "code": "* Windows\n\n  In PowerShell:",
      "language": "unknown"
    },
    {
      "code": "1. Restart your terminal.\n\n##### AWS config file\n\nTo persistently set the location of the certificate in your AWS configuration:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Locate and open your [AWS configuration file](https://docs.aws.amazon.com/cli/v1/userguide/cli-configure-files.html#cli-configure-files-where).\n\n3. Configure the [`ca_bundle` setting](https://docs.aws.amazon.com/cli/v1/userguide/cli-configure-files.html#cli-configure-files-settings) with the location of your certificate. For example:",
      "language": "unknown"
    },
    {
      "code": "##### In code\n\nTo specify the certificate directly in your Python code:\n\n1. [Download a Cloudflare certificate](#download-the-cloudflare-root-certificate) in `.pem` format.\n\n2. Pass the certificate path when creating a Boto3 client or resource:",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to the [Boto3 documentation](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html).\n\n### Enterprise applications\n\nEnterprise desktop applications and specialized tools may require custom certificate configuration.\n\n#### Google Drive\n\nTo trust a Cloudflare root certificate in the Google Drive desktop application, follow the procedure for your operating system. These steps require you to [download a `.pem` certificate](#download-the-cloudflare-root-certificate).\n\n* macOS\n\n  1. In a terminal, copy the contents of the Google Drive certificate file to a new certificate file in a permanent location, such as your Documents folder. For example:",
      "language": "unknown"
    },
    {
      "code": "2. Append the contents of the downloaded certificate to the end of the new file. For example:",
      "language": "unknown"
    },
    {
      "code": "3. Apply the newly created root certificate to your Google Drive application. For example:",
      "language": "unknown"
    },
    {
      "code": "You can verify the update with the following command.",
      "language": "unknown"
    },
    {
      "code": "* Windows\n\n  1. In an administrator PowerShell terminal, copy the contents of the Google Drive certificate file to a new certificate file in a permanent location, such as your Documents folder. For example:",
      "language": "unknown"
    },
    {
      "code": "2. Append the contents of the downloaded certificate to the end of the new file. For example:",
      "language": "unknown"
    },
    {
      "code": "3. Apply the newly created root certificate to your Google Drive application. For example:",
      "language": "unknown"
    },
    {
      "code": "You can verify the update with the following command.",
      "language": "unknown"
    },
    {
      "code": "For more information, refer to the [Google documentation](https://support.google.com/a/answer/7644837) for the `TrustedRootCertsFile` setting.\n\n#### Minikube\n\nTo trust a Cloudflare root certificate in Minikube, refer to [x509: certificate signed by unknown authority](https://minikube.sigs.k8s.io/docs/handbook/vpn_and_proxy/#x509-certificate-signed-by-unknown-authority).\n\n</page>\n\n<page>\n---\ntitle: Configure WARP · Cloudflare One docs\ndescription: You can configure WARP client settings to work alongside existing\n  infrastructure and provide users with differential access to resources.\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/index.md\n---\n\nYou can configure WARP client settings to work alongside existing infrastructure and provide users with differential access to resources.\n\nManaged deployments\n\nIf you are deploying [WARP with device management software](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/), we recommend only supplying `organization` in your [deployment parameters](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/) and managing all other settings via the dashboard. Any settings you configure on the dashboard will be overridden by the local policy deployed by your management software. To ensure dashboard settings are applied as intended, remove the corresponding parameters from your managed deployment configuration.\n\n* [Device profiles](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/)\n* [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/)\n* [WARP settings](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/)\n* [Managed networks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/managed-networks/)\n* [Route traffic](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/)\n* [WARP sessions](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/)\n\n</page>\n\n<page>\n---\ntitle: Deploy WARP to your organization · Cloudflare One docs\ndescription: \"Depending on how your organization is structured, you can deploy\n  WARP in one of two ways:\"\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/index.md\n---\n\nDepending on how your organization is structured, you can deploy WARP in one of two ways:\n\n* [Manual deployment](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/) — If you are a small organization, asking your users to download the client themselves and type in the required settings is the ideal way to get started with WARP.\n\n* [Managed deployment](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/) — Bigger organizations with MDM tools like Intune or JAMF can deploy WARP to their entire fleet of devices from a single operation.\n\n</page>\n\n<page>\n---\ntitle: Download WARP stable releases · Cloudflare One docs\ndescription: This page contains the stable WARP client releases from the past\n  year. We recommend using stable releases for production environments. You can\n  download stable releases from the links below after checking requirements.\nlastUpdated: 2025-12-17T19:51:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/index.md\n---\n\nThis page contains the stable WARP client releases from the past year. We recommend using stable releases for production environments. You can download stable releases from the links below after checking requirements.\n\nCloudflare also offers an unstable [beta release track](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/) with the latest features and improvements, and an [LTS release track](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/lts-releases/) with extended support durations.\n\nFor more details on WARP client support timelines and end-of-life (EOL) policies, refer to the [Support lifecycle](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/support-lifecycle/) page.\n\n## Windows\n\n[Download latest stable release](https://downloads.cloudflareclient.com/v1/download/windows/ga)\n\n| | |\n| - | - |\n| **OS version** | Windows 10 LTSC, Windows 11, Windows 365 Cloud PC running Windows 11 |\n| **Processor** | AMD64 / x86-64 or ARM64 / AArch64 |\n| **.NET Framework version** | 4.7.2 or later |\n| **HD space** | 184 MB |\n| **Memory** | 3 MB |\n| **Network interface type** | Wi-Fi or LAN |\n| **MTU** | 1381 bytes recommended [1](#user-content-fn-1) |\n\n## Footnotes\n\n1. Minimum 1281 bytes with [Path MTU Discovery](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/) [↩](#user-content-fnref-1)\n\nLatest release\n\nPrevious version history (12)\n\nWindows 2025.8.779.0\n\nWindows 2025.7.176.0\n\nWindows 2025.6.1400.0\n\nWindows 2025.6.1335.0\n\nWindows 2025.5.943.0\n\nWindows 2025.5.893.0\n\nWindows 2025.4.943.0\n\nWindows 2025.4.929.0\n\nWindows 2025.2.664.0\n\nWindows 2025.2.600.0\n\nWindows 2025.1.861.0\n\nWindows 2024.12.760.0\n\n## macOS\n\n[Download latest stable release](https://downloads.cloudflareclient.com/v1/download/macos/ga)\n\n| | |\n| - | - |\n| **OS version** | Sonoma 14.0+, Sequoia 15.1+ (15.0.x is not supported), Tahoe 26.0+ |\n| **Processor** | M series |\n| **HD space** | 75 MB |\n| **Memory** | 35 MB |\n| **Network interface type** | Wi-Fi or LAN |\n| **MTU** | 1381 bytes recommended [1](#user-content-fn-1) |\n\n## Footnotes\n\n1. Minimum 1281 bytes with [Path MTU Discovery](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/) [↩](#user-content-fnref-1)\n\nLatest release\n\nPrevious version history (10)\n\nmacOS 2025.8.779.0\n\nmacOS 2025.7.176.0\n\nmacOS 2025.6.1335.0\n\nmacOS 2025.5.943.0\n\nmacOS 2025.5.893.0\n\nmacOS 2025.4.943.0\n\nmacOS 2025.4.929.0\n\nmacOS 2025.2.664.0\n\nmacOS 2025.2.600.0\n\nmacOS 2025.1.861.0\n\n## Linux\n\n[Package repository](https://pkg.cloudflareclient.com/)\n\n| | |\n| - | - |\n| **OS version** | CentOS 8, RHEL 8, Debian 12, Debian 13, Fedora 34, Fedora 35, Ubuntu 22.04 LTS, Ubuntu 24.04 LTS |\n| **Processor** | AMD64 / x86-64 or ARM64 / AArch64 |\n| **HD space** | 75 MB |\n| **Memory** | 35 MB |\n| **Network interface type** | Wi-Fi or LAN |\n| **MTU** | 1381 bytes recommended [1](#user-content-fn-1) |\n\n## Footnotes\n\n1. Minimum 1281 bytes with [Path MTU Discovery](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/) [↩](#user-content-fnref-1)\n\nLatest release\n\nPrevious version history (9)\n\nLinux 2025.8.779.0\n\nLinux 2025.7.176.0\n\nLinux 2025.6.1335.0\n\nLinux 2025.5.943.0\n\nLinux 2025.5.893.0\n\nLinux 2025.4.943.0\n\nLinux 2025.4.929.0\n\nLinux 2025.2.600.0\n\nLinux 2025.1.861.0\n\n## iOS\n\n| | |\n| - | - |\n| **OS version** | iOS 11+ |\n\n[Download from the iOS App Store](https://apps.apple.com/us/app/cloudflare-one-agent/id6443476492) or search for \"Cloudflare One Agent\".\n\nMigrate from 1.1.1.1\n\nThe legacy iOS client, [1.1.1.1: Faster Internet](https://apps.apple.com/us/app/1-1-1-1-faster-internet/id1423538627), has been replaced by the Cloudflare One Agent. Learn more in our [migration guide](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/cloudflare-one-agent-migration/).\n\n## Android\n\n| | |\n| - | - |\n| **OS version** | 5.0+ |\n\n[Download from the Google Play store](https://play.google.com/store/apps/details?id=com.cloudflare.cloudflareoneagent) or search for \"Cloudflare One Agent\".\n\nMigrate from 1.1.1.1\n\nThe legacy Android client, [1.1.1.1 + WARP: Safer Internet](https://play.google.com/store/apps/details?id=com.cloudflare.onedotonedotonedotone), has been replaced by the Cloudflare One Agent. Learn more in our [migration guide](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/cloudflare-one-agent-migration/).\n\n## ChromeOS\n\n| | |\n| - | - |\n| **OS version** | Chromebooks manufactured after 2019 |\n\nChromebooks are supported by our [Android app](#android). All Chromebooks made after 2019 should fully support our Android app. If you have a Chromebook made before 2019, [refer to this list](https://www.chromium.org/chromium-os/chrome-os-systems-supporting-android-apps/) to verify that your device is supported.\n\n</page>\n\n<page>\n---\ntitle: Remove WARP · Cloudflare One docs\ndescription: The following procedures will uninstall the WARP client from your\n  device. If you used the WARP client to deploy a root certificate, the\n  certificate will also be removed.\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/remove-warp/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/remove-warp/index.md\n---\n\nThe following procedures will uninstall the WARP client from your device. If you used the WARP client to deploy a root certificate, the certificate will also be removed.\n\n## Windows\n\n1. Go to Windows Settings (Windows Key + I).\n2. Select **Apps**.\n3. Select **App & Features**.\n4. Scroll to find the Cloudflare WARP application and select **Uninstall**.\n\n## macOS\n\nWe include an uninstall script as part of the macOS package that you originally used.\n\n1. To find and run the uninstall script, run the following commands:",
      "language": "unknown"
    },
    {
      "code": "1. If prompted, enter your admin credentials to proceed with the uninstall.\n\nNote\n\nYou can bypass the **Are you sure** prompt by passing `-f` as a parameter to the macOS uninstall command.\n\n## Linux\n\nOn CentOS 8, RHEL 8:",
      "language": "unknown"
    },
    {
      "code": "On Ubuntu 18.04, Ubuntu 20.04, Ubuntu 22.04, Debian 9, Debian 10, Debian 11:",
      "language": "unknown"
    },
    {
      "code": "## iOS and Android\n\n1. Find the Cloudflare One Agent application (or the legacy 1.1.1.1 application) on the home screen.\n2. Select and hold the application tile, and then select **Remove App**.\n3. Select **Delete App**.\n\nNote\n\nIf you [manually deployed a Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/), remember to manually delete the certificate from the device.\n\n</page>\n\n<page>\n---\ntitle: Set up WARP for your organization · Cloudflare One docs\ndescription: This is a high-level, step-by-step walkthrough on how to get\n  started with WARP in your organization. From downloading the client to sending\n  the first queries to Cloudflare's edge, here is a guide on how to do it for\n  the first time.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/index.md\n---\n\nThis is a high-level, step-by-step walkthrough on how to get started with WARP in your organization. From downloading the client to sending the first queries to Cloudflare's edge, here is a guide on how to do it for the first time.\n\n## Gateway with WARP (default)\n\nThis mode enables our complete suite of [device security features](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes).\n\n### 1. Create a Cloudflare Zero Trust account.\n\nThe [Cloudflare Zero Trust home](https://one.dash.cloudflare.com/) will be your go-to place to check device connectivity data, as well as create Secure Web Gateway and Zero Trust policies for your organization.\n\nAs you complete the [Cloudflare Zero Trust onboarding](https://developers.cloudflare.com/cloudflare-one/setup/), you will be asked to create a team name for your organization. You will need the team name when you deploy the WARP client on your devices; it will allow your users to connect to your organization's Cloudflare Zero Trust instance.\n\n### 2. Set up a login method.\n\nConfigure [One-time PIN](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/) or connect a [third-party identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) in Zero Trust. This is the login method your users will utilize when authenticating to add a new device to your Cloudflare Zero Trust setup.\n\n### 3. Next, define device enrollment permissions.\n\nCreate [device enrollment rules](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/device-enrollment/) to define which users in your organization should be able to connect devices to your organization's Cloudflare Zero Trust setup. As you create your rule, you will be asked to select which login method you would like users to authenticate with.\n\n### 4. Install the Cloudflare root certificate on your devices.\n\nAdvanced security features including HTTP traffic inspection require users to install and trust the [Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on their machine or device. If you are installing certificates manually on all your devices, these steps will need to be performed on each new device that is to be subject to HTTP filtering.\n\n### 5. Download and deploy the WARP client to your devices.\n\nChoose one of the [different ways](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) to deploy the WARP client, depending on what works best for your organization.\n\n### 6. Log in to your organization's Cloudflare Zero Trust instance from your devices.\n\nOnce the WARP client is installed on the device, [log in to your Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/). If you have already set up an identity provider in Cloudflare Access, the user will be prompted to authenticate using this method. If you have not set up an identity provider, the user can authenticate with a [one-time pin](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/) which is enabled by default.\n\nNext, build [Secure Web Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) to filter DNS, HTTP, and Network traffic on your devices.\n\n## Gateway with DoH\n\nThis mode is best suited for organizations that only want to apply DNS filtering to outbound traffic from their company devices. It does not enable advanced HTTP filtering features such as HTTP policies, identity-based policies, device posture checks, or Browser Isolation.\n\n### 1. Create a Cloudflare Zero Trust account.\n\nZero Trust will be your go-to place to check device connectivity data, as well as create Secure Web Gateway and Zero Trust policies for your organization.\n\nAs you complete the [Cloudflare Zero Trust onboarding](https://developers.cloudflare.com/cloudflare-one/setup/), you will be asked to create a team name for your organization. You will need the team name when you deploy the WARP client on your devices; it will allow your users to connect to your organization's Cloudflare Zero Trust instance.\n\n### 2. Set up a login method.\n\nConfigure [One-time PIN](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/) or connect a [third-party identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) in Zero Trust. This is the login method your users will utilize when authenticating to add a new device to your Cloudflare Zero Trust setup.\n\n### 3. Next, define device enrollment permissions.\n\nCreate [device enrollment rules](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/device-enrollment/) to define which users in your organization should be able to connect devices to your organization's Cloudflare Zero Trust setup. As you create your rule, you will be asked to select which login method you would like users to authenticate with.\n\n### 4. (optional) Add a DNS location to Gateway.\n\nThe WARP client will direct DoH queries to a default DNS endpoint when enrolled to your Zero Trust organization. If you need to direct these queries to a separate DNS endpoint, [add a DNS location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) to Gateway. Gateway will assign a DoH subdomain to that location, which you can add when deploying the WARP client to your devices.\n\n### 5. Download and deploy the WARP client to your devices.\n\nChoose one of the [different ways](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) to deploy the WARP client, depending on what works best for your organization.\n\nNext, create [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/) to control how DNS queries from your devices get resolved.\n\n</page>\n\n<page>\n---\ntitle: Troubleshoot WARP · Cloudflare One docs\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/index.md\n---\n\n* [WARP troubleshooting guide](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/troubleshooting-guide/)\n* [Common issues](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/common-issues/)\n* [Client errors](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/client-errors/)\n* [WARP diagnostic logs](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/)\n* [Known limitations](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/known-limitations/)\n* [Connectivity status](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/connectivity-status/)\n\n</page>\n\n<page>\n---\ntitle: Extended suggested ruleset · Cloudflare One docs\ndescription: \"If you are unable to export your current perimeter firewall rules,\n  consider identifying categories of systems or user groups that reside on your\n  Magic Transit prefixes. For example:\"\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/extended-ruleset/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/extended-ruleset/index.md\n---\n\nIf you are unable to export your current perimeter firewall rules, consider identifying categories of systems or user groups that reside on your Magic Transit prefixes. For example:\n\n* [Endpoints (user devices)](#endpoints-user-devices)\n* [Internal routers](#internal-routerfirewall-ip-addresses)\n* [Web servers](#web-servers)\n* [Non-web servers](#non-web-servers)\n\nFor each item above, consider the requirements in terms of their permitted Internet access. For example, permit what is required for legitimate traffic and block the rest.\n\n## Create lists for using Magic Firewall rules\n\nFor more information on lists, refer to [Use rule lists](https://developers.cloudflare.com/cloudflare-one/reusable-components/use-rules-list/).\n\nYou can also create a list from the dashboard from **Configurations** > **Lists** on your **Account Home**.\n\n## Endpoints (User devices)\n\nEndpoint devices do not operate as servers, which means:\n\n* They receive traffic from standard common ports — for example `80` or `443` — towards their ephemeral ports, above `32768` in modern operating systems (above `1025` in older Windows Server 2003 and Windows XP).\n* Connections flow outwards, not inwards, and therefore do not receive TCP SYN or ACK packets.\n* They typically only need client TCP and UDP, with no requirement for ingress ICMP.\n\nFor example, you can create a list for the combination of generic client TCP and client UDP that allows external pings or traceroutes and a catchall rule for all other protocols and traffic.\n\nCreate a list named **Endpoints** and specify the list of endpoints or user IP addresses to reference within the rules.\n\nNote\n\nRule 10 in the example ruleset below is acting as a catch-all to block all traffic not permitted in rules 1-3 towards your list of Endpoint IP addresses. If you want to permit other traffic to these destination IP addresses, the new rule must be added before rule 10.\n\n### Suggested rules\n\n**Rule ID**: 1 **Description**: Endpoints (clients) will receive traffic destined for ephemeral ports. Blocks inbound SYN-only traffic. (meaning SYN-ACKs are permitted) **Match**: `ip.proto eq \"tcp\" and ip.dst in $endpoints and tcp.dstport in {32768..60999} and not (tcp.flags.syn and not tcp.flags.ack)` **Action**: Allow\n\n**Rule ID**: 2 **Description**: Endpoints (clients) will receive traffic destined for ephemeral ports **Match**: `ip.proto eq \"udp\" and ip.dst in $endpoints and udp.dstport in {32768..60999}` **Action**: Allow\n\n**Rule ID**: 3 **Description**: Permits ICMP traffic to destination IP addresses in `$endpoints` list with ICMP Types:\n\n* Type 0 = Echo Reply\n* Type 3 = Destination Unreachable\n* Type 11 = Time Exceeded\n\n**Match**: `ip.proto eq \"icmp\" and ip.dst in $endpoints and (icmp.type eq 0 or icmp.type eq 3 or icmp.type eq 11)` **Action**: Allow\n\n**Rule ID**: 10 **Description**: Otherwise deny all traffic to IP's in `$endpoints` list **Match**: `ip.dst in $endpoints` **Action**: Block\n\n## Internal router/Firewall IP addresses\n\nFollow the best practices for internal routers or firewall interface IP addresses on your MT prefixes below.\n\n1. Create [an IP list](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists), **Internal routers** for example, with your IP addresses.\n2. Block ICMP if it is not needed.\n3. Permit GRE/ESP as needed if the devices have GRE/IPsec tunnels via the Internet.\n\n### Suggested rules\n\n**Rule ID**: 1 **Description**: Permit limited ICMP traffic inbound, including:\n\n* Type 0 - Echo Reply\n* Type 3 - Destination Unreachable\n* Type 8 - Echo\n* Type 11 - Time Exceeded\n\n**Match**: `ip.proto eq \"icmp\" and ip.dst in $internal_routers and ( (icmp.type eq 0 or icmp.type eq 3) or (icmp.type eq 11) or (icmp.type eq 8) )` **Action**: Allow\n\n**Rule ID**: 2 **Description**: Block all other traffic destined to these IP addresses **Match**: `ip.dst in $internal_routers` **Action**: Block\n\n## Web Servers\n\nWeb servers require careful consideration of necessary traffic flows. Traffic for the **web server** functionality is required in addition to traffic flows where the web server is acting as a client.\n\nWhere possible, permit the required destination IP addresses and ports for web servers and block everything else. Additional services, for example NTP/DNS, may be required along with the ports for the web traffic.\n\nThe following is an example of suggested rules, but you should only make changes based on your specific requirements. For example, if you are not proxied by Cloudflare Layer 7 protection and you expect traffic sourced from the web towards your web servers:\n\n1. Create [an IP list](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists), **web servers** for example, to list IP addresses for your web servers.\n2. Permit traffic for the web server traffic inbound from the Internet.\n3. Permit traffic for the infrastructure or client traffic flows from the Internet, for example DNS and NTP.\n4. Block all other traffic destined for the web server IP addresses.\n\n### Suggested rules\n\n**Rule ID**: 1 **Description**: Allows inbound HTTP/S traffic from the Internet with SYN-only or ACK-only flag (not SYN/ACKs) **Match**: `ip.proto eq \"tcp\" and tcp.srcport in {32768..60999} and ip.dst in $web_servers and tcp.dstport in {80 443} and not (tcp.flags.syn and tcp.flags.ack)` **Action**: Allow\n\n**Rule ID**: 2 **Description**: Allows UDP replies for DNS and NTP to web servers **Match**: `ip.dst in $web_servers and ip.proto eq \"udp\" and udp.srcport in {53 123} and udp.dstport in {1024..65535}` **Action**: Allow if necessary but Disable if under attack\n\n**Rule ID**: 3 **Description**: Catch-all to block all other traffic destined for web server IP addresses **Match**: `ip.dst in $web_servers` **Action**: Block\n\nAlternatively, if you have Cloudflare Layer 7 protection, the Cloudflare Public IP addresses can be permitted as the source IP addresses to the destination IP addresses for the HTTP/HTTPS inbound traffic. This recommendation effectively replaces Rule 1 in the example above.\n\nFor a list of Cloudflare's IP addresses, refer to [Cloudflare's IP addresses](https://www.cloudflare.com/ips/).\n\n### Suggested rules for Cloudflare proxied traffic\n\n**Description**: Allow inbound HTTP/S traffic from Cloudflare with SYN or ACK **Match**: `ip.proto eq \"tcp\" and ip.dst in $web_servers and tcp.dstport in {80 443} and not (tcp.flags.syn and tcp.flags.ack) and ip.src in {173.245.48.0/20 103.21.244.0/22 103.22.200.0/22 103.31.4.0/22 141.101.64.0/18 108.162.192.0/18 190.93.240.0/20 188.114.96.0/20 197.234.240.0/22 198.41.128.0/17 162.158.0.0/15 104.16.0.0/13 104.24.0.0/14 172.64.0.0/13 131.0.72.0/22}` **Action**: Allow\n\n## Non-web servers\n\nRestrict the source based on whether the server is expecting traffic from the general Internet or from only specific users.\n\n1. Apply rules based on source IP or ports if possible.\n2. Restrict permitted destination ports to only those that are required.\n3. Block incoming SYN to the closed ports.\n\n### Suggested rules\n\n* `IP Destination Address { non-web server } and TCP dst port in \\<valid ports> — Permit`\n* `IP Destination Address { non-web server } and UDP dst port in \\<valid ports> — Permit`\n* `IP Destination Address { web server } — Block`\n\n</page>\n\n<page>\n---\ntitle: Magic Transit egress · Cloudflare One docs\ndescription: The suggestions in the Minimal ruleset and Extended ruleset are\n  recommendations for ingress traffic.\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/magic-transit-egress/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/magic-transit-egress/index.md\n---\n\nThe suggestions in the [Minimal ruleset](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/minimal-ruleset) and [Extended ruleset](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/extended-ruleset) are recommendations for ingress traffic.\n\nFor Magic Transit egress traffic, consider the following information:\n\n* The Magic Firewall rules will apply to both Magic Transit ingress and egress traffic passing via Cloudflare.\n* Magic Firewall is not stateful for your Magic Transit egress traffic.\n* Magic Firewall is not stateful in both directions after DDoS mitigations.\n* If you have a Magic Firewall \"default drop\" catchall rule for ingress traffic, you will need to add an earlier rule to permit traffic sourced from your Magic Transit prefix with the destination as **any** to allow outbound egress traffic.\n\n</page>\n\n<page>\n---\ntitle: Minimal suggested ruleset · Cloudflare One docs\ndescription: The suggested minimal ruleset blocks some known common vectors for\n  DDoS attacks and permits all other ESP, TCP, UDP, GRE and ICMP traffic.\nlastUpdated: 2025-11-03T15:26:30.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/minimal-ruleset/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/best-practices/minimal-ruleset/index.md\n---\n\nThe suggested minimal ruleset blocks some known common vectors for DDoS attacks and permits all other ESP, TCP, UDP, GRE and ICMP traffic.\n\nThis is a suggested list and not an exhaustive list. Review your environment and add more rules as necessary.\n\n## Recommended rules\n\n**Rule ID**: 1\\\n**Description**: Single rule that blocks all traffic with UDP source ports which are used in attacks or invalid in Magic Transit ingress.\\\n**Match**: `(udp.srcport in {1900 11211 389 111 19 1194 3702 10001 20800 161 162 137 27005 520 0})`\\\n**Action**: Block\n\n**Rule ID**: 2\\\n**Description**: Blocks TCP traffic with source port `0` and common ports used in TCP SYN/ACK reflection attacks.\\\n**Match**: `(tcp.srcport in {21 0 3306})`\\\n**Action**: Block\n\n**Rule ID**: 3\\\n**Description**: Blocks HOPOPT (protocol 0) or else blocks if protocol not in `{ESP, TCP, UDP, GRE, ICMP}`. Note that this is only an example. Permit the relevant protocols for your environment.\\\n**Match**: `(ip.proto eq \"hopopt\") or (not ip.proto in {\"esp\" \"tcp\" \"udp\" \"gre\" \"icmp\"})`\\\n**Action**: Block\n\nThe recommended rules are part of the managed rules.\n\n## Traffic and port types\n\nThe information below covers traffic type, how the port is used, and reasons for blocking the port.\n\n| Traffic | Port use | Reason to block |\n| - | - | - |\n| UDP source port `0` | Reserved port. Should not be used by applications. | Invalid as a legitimate traffic source port. Commonly used in DDoS attacks. |\n| UDP source port `1900` | Simple Service Discovery Protocol (SSDP). Allows universal plug and play devices to send and receive information. | [SSDP DDoS attacks](https://www.cloudflare.com/learning/ddos/ssdp-ddos-attack/) exploit Universal Plug and Play protocols. |\n| UDP source port `11211` | Memcached. A database caching system designed to speed up websites and networks. | [Memcached DDoS Attacks](https://www.cloudflare.com/learning/ddos/memcached-ddos-attack/). |\n| UDP source port `389` | Connection-less Lightweight Directory Access Protocol (CLDAP). | [Used in reflection attacks](https://blog.cloudflare.com/reflections-on-reflections/). |\n| UDP source port `111` | SunRPC | Common attack vector. [Used in reflection attacks](https://blog.cloudflare.com/reflections-on-reflections/). |\n| UDP source port `19` | CHARGEN | [Amplification attack vector](https://blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/). |\n| UDP source port `1194` | OpenVPN | Unless this is an authorized VPN in your environment, this common VPN should be blocked. |\n| UDP source port `3702` | Web Services Dynamic Discovery Multicast discovery protocol (WS-Discovery) | Vulnerable to exploiting for DDoS attacks. |\n| UDP source port `10001` | Ubiquiti UniFi discovery protocol | Ubiquiti devices were exploited and used to conduct DDoS attacks on this port. |\n| UDP source port `20800` | Call of Duty | [Commonly used in attacks](https://blog.cloudflare.com/reflections-on-reflections/). |\n| UDP source ports `161` and `162` | SNMP | Vulnerable to exploiting for DDoS attacks. |\n| UDP source port `137` | NetBIOS | NetBIOS allows file sharing over networks. If configured improperly, can expose file systems. |\n| UDP source port `27005` | SRCDS | Used in [amplication attacks](https://blog.cloudflare.com/reflections-on-reflections/). |\n| UDP source port `520` | Routing Information Protocol (RIP) | Internal routing protocol. Not required on Internet WAN access. |\n| TCP source port `0` | Reserved port. Should not be used by applications. | Commonly used in DDoS attacks. Invalid as a legitimate traffic source port. |\n| TCP source port `0` | FTP | Commonly used for attacks. |\n| TCP source port `3306` | MYSQL open source database | Used as attack vector in DDoS attacks. |\n\n## Other common traffic to consider\n\nThe list below is a common list of traffic types you should also consider blocking or restricting inbound.\n\n* SFTP, TFTP\n* SSH, Telnet\n* RDP\n* RCP\n* SMCP\n* NTP\n  * Common vector for reflection attacks. Consider using [Cloudflare Gateway](https://developers.cloudflare.com/web3/), [1.1.1.1's DNS over HTTPS (DoH)](https://developers.cloudflare.com/1.1.1.1/), or an internal DNS service if possible. Consider restricting your firewall rules to only allow the source and destination of DNS traffic.\n* MS-SQL\n  * Common vector and [increasingly used as vector for DDoS attacks](https://blog.cloudflare.com/ddos-attack-trends-for-2021-q4/). Block if unused or consider restricting only to the required source IP addresses.\n* HTTP and HTTPS\n  * If you only have servers on your Magic Transit prefixes, consider blocking ingress traffic on TCP source ports 80 and 443 from outside. If you have endpoints on your Magic Transit prefixes, you can allow traffic on the source ports but consider creating a disabled rule you can activate to respond to reflection attacks as needed.\n\nIf relevant to your environment, consider blocking based on geolocation data, which blocks traffic based on the country or user when an end user's IP address is registered in the geolocation database.\n\nIf you are interested in participating in the beta for [Session Initiation Protocol (SIP) Validation](https://blog.cloudflare.com/programmable-packet-filtering-with-magic-firewall/), contact your Implementation Manager.\n\n</page>\n\n<page>\n---\ntitle: Common API calls · Cloudflare DDoS Protection docs\ndescription: The following sections contain example requests for common API\n  calls. For a list of available API endpoints, refer to Endpoints.\nlastUpdated: 2024-11-04T15:20:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/examples/\n  md: https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/examples/index.md\n---\n\nThe following sections contain example requests for common API calls. For a list of available API endpoints, refer to [Endpoints](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/#endpoints).\n\n## Get all DNS protection rules\n\nThe following example retrieves the currently configured rules for Advanced DNS Protection.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "### Create DNS protection rule\n\nThe following example creates an Advanced DNS Protection rule with a global scope.",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "Refer to [JSON objects](https://developers.cloudflare.com/ddos-protection/advanced-ddos-systems/api/dns-protection/json-objects/) for more information on the fields in the JSON body.\n\n### Update DNS protection rule\n\nThe following example updates an existing DNS protection rule with ID `{rule_id}`.\n\nThe request body can contain only the fields you want to update (from `mode`, `profile_sensitivity`, `rate_sensitivity`, and `burst_sensitivity`).",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Filter DoH requests by location",
      "id": "filter-doh-requests-by-location"
    },
    {
      "level": "h3",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h3",
      "text": "Configure browser for DoH",
      "id": "configure-browser-for-doh"
    },
    {
      "level": "h3",
      "text": "Configure operating system for DoH",
      "id": "configure-operating-system-for-doh"
    },
    {
      "level": "h3",
      "text": "Use generic DoH endpoint",
      "id": "use-generic-doh-endpoint"
    },
    {
      "level": "h2",
      "text": "Filter DoH requests by user",
      "id": "filter-doh-requests-by-user"
    },
    {
      "level": "h3",
      "text": "1. Create a service token for the account",
      "id": "1.-create-a-service-token-for-the-account"
    },
    {
      "level": "h3",
      "text": "2. Enable DoH functionality for the service token",
      "id": "2.-enable-doh-functionality-for-the-service-token"
    },
    {
      "level": "h3",
      "text": "3. Create a user",
      "id": "3.-create-a-user"
    },
    {
      "level": "h3",
      "text": "4. Generate a DoH token for the user",
      "id": "4.-generate-a-doh-token-for-the-user"
    },
    {
      "level": "h3",
      "text": "5. Send an authenticated DoH query",
      "id": "5.-send-an-authenticated-doh-query"
    },
    {
      "level": "h2",
      "text": "Add a DNS location",
      "id": "add-a-dns-location"
    },
    {
      "level": "h2",
      "text": "DNS endpoints",
      "id": "dns-endpoints"
    },
    {
      "level": "h3",
      "text": "IPv4 and IPv6 DNS",
      "id": "ipv4-and-ipv6-dns"
    },
    {
      "level": "h3",
      "text": "DNS over TLS (DoT)",
      "id": "dns-over-tls-(dot)"
    },
    {
      "level": "h3",
      "text": "DNS over HTTPS (DoH)",
      "id": "dns-over-https-(doh)"
    },
    {
      "level": "h2",
      "text": "Secure DNS locations",
      "id": "secure-dns-locations"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Captive portals",
      "id": "captive-portals"
    },
    {
      "level": "h3",
      "text": "Third-party filtering",
      "id": "third-party-filtering"
    },
    {
      "level": "h2",
      "text": "PAC file format",
      "id": "pac-file-format"
    },
    {
      "level": "h3",
      "text": "Formatting considerations",
      "id": "formatting-considerations"
    },
    {
      "level": "h2",
      "text": "PAC file template with identity provider bypass",
      "id": "pac-file-template-with-identity-provider-bypass"
    },
    {
      "level": "h2",
      "text": "Performance optimization",
      "id": "performance-optimization"
    },
    {
      "level": "h3",
      "text": "Cache DNS results in variables",
      "id": "cache-dns-results-in-variables"
    },
    {
      "level": "h3",
      "text": "Check for plain hostnames first",
      "id": "check-for-plain-hostnames-first"
    },
    {
      "level": "h2",
      "text": "Advanced techniques",
      "id": "advanced-techniques"
    },
    {
      "level": "h3",
      "text": "Case sensitivity handling",
      "id": "case-sensitivity-handling"
    },
    {
      "level": "h2",
      "text": "Common bypass rules",
      "id": "common-bypass-rules"
    },
    {
      "level": "h3",
      "text": "Font and static asset providers",
      "id": "font-and-static-asset-providers"
    },
    {
      "level": "h3",
      "text": "Streaming and media services",
      "id": "streaming-and-media-services"
    },
    {
      "level": "h2",
      "text": "Test PAC files",
      "id": "test-pac-files"
    },
    {
      "level": "h3",
      "text": "Test with expected websites",
      "id": "test-with-expected-websites"
    },
    {
      "level": "h3",
      "text": "Validate syntax",
      "id": "validate-syntax"
    },
    {
      "level": "h2",
      "text": "Troubleshoot configurations",
      "id": "troubleshoot-configurations"
    },
    {
      "level": "h3",
      "text": "Debug PAC file routing decisions",
      "id": "debug-pac-file-routing-decisions"
    },
    {
      "level": "h3",
      "text": "Browsing on a device using a PAC file is slow",
      "id": "browsing-on-a-device-using-a-pac-file-is-slow"
    },
    {
      "level": "h3",
      "text": "Browser caches PAC files incorrectly",
      "id": "browser-caches-pac-files-incorrectly"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure an application check",
      "id": "configure-an-application-check"
    },
    {
      "level": "h2",
      "text": "Determine the signing thumbprint",
      "id": "determine-the-signing-thumbprint"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h2",
      "text": "Determine the SHA-256 value",
      "id": "determine-the-sha-256-value"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h2",
      "text": "How WARP checks for an application",
      "id": "how-warp-checks-for-an-application"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure the Carbon Black check",
      "id": "configure-the-carbon-black-check"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure the client certificate check",
      "id": "configure-the-client-certificate-check"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Create a list of serial numbers",
      "id": "create-a-list-of-serial-numbers"
    },
    {
      "level": "h2",
      "text": "Validate the serial number",
      "id": "validate-the-serial-number"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h3",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h3",
      "text": "iOS, Android and ChromeOS",
      "id": "ios,-android-and-chromeos"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Assign UUIDs to devices",
      "id": "1.-assign-uuids-to-devices"
    },
    {
      "level": "h2",
      "text": "2. Create a list of UUIDs",
      "id": "2.-create-a-list-of-uuids"
    },
    {
      "level": "h2",
      "text": "3. Enable the posture check",
      "id": "3.-enable-the-posture-check"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable the disk encryption check",
      "id": "enable-the-disk-encryption-check"
    },
    {
      "level": "h2",
      "text": "Validate disk encryption status",
      "id": "validate-disk-encryption-status"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h3",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h3",
      "text": "iOS, Android and ChromeOS",
      "id": "ios,-android-and-chromeos"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable the Domain Joined check",
      "id": "enable-the-domain-joined-check"
    },
    {
      "level": "h2",
      "text": "Validate the domain value",
      "id": "validate-the-domain-value"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure a file check",
      "id": "configure-a-file-check"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable the firewall check",
      "id": "enable-the-firewall-check"
    },
    {
      "level": "h2",
      "text": "How WARP checks the firewall status",
      "id": "how-warp-checks-the-firewall-status"
    },
    {
      "level": "h3",
      "text": "On macOS",
      "id": "on-macos"
    },
    {
      "level": "h3",
      "text": "On Windows",
      "id": "on-windows"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable the OS version check",
      "id": "enable-the-os-version-check"
    },
    {
      "level": "h2",
      "text": "Determine the OS version",
      "id": "determine-the-os-version"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h3",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h3",
      "text": "ChromeOS",
      "id": "chromeos"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Enable the Gateway check",
      "id": "1.-enable-the-gateway-check"
    },
    {
      "level": "h2",
      "text": "2. Add the check to an Access application",
      "id": "2.-add-the-check-to-an-access-application"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Enable the WARP check",
      "id": "1.-enable-the-warp-check"
    },
    {
      "level": "h2",
      "text": "2. Add the check to an Access policy",
      "id": "2.-add-the-check-to-an-access-policy"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Configure the SentinelOne check",
      "id": "configure-the-sentinelone-check"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Integrate Tanium with Cloudflare Access",
      "id": "integrate-tanium-with-cloudflare-access"
    },
    {
      "level": "h2",
      "text": "Example Access policy",
      "id": "example-access-policy"
    },
    {
      "level": "h2",
      "text": "Tanium endpoint signals",
      "id": "tanium-endpoint-signals"
    },
    {
      "level": "h2",
      "text": "Install a certificate using WARP",
      "id": "install-a-certificate-using-warp"
    },
    {
      "level": "h2",
      "text": "Access the installed certificate",
      "id": "access-the-installed-certificate"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h3",
      "text": "Debian-based Linux distributions",
      "id": "debian-based-linux-distributions"
    },
    {
      "level": "h2",
      "text": "Uninstall the certificate",
      "id": "uninstall-the-certificate"
    },
    {
      "level": "h2",
      "text": "Generate a custom root CA",
      "id": "generate-a-custom-root-ca"
    },
    {
      "level": "h2",
      "text": "Deploy a custom root certificate",
      "id": "deploy-a-custom-root-certificate"
    },
    {
      "level": "h2",
      "text": "Use a custom root certificate",
      "id": "use-a-custom-root-certificate"
    },
    {
      "level": "h2",
      "text": "Troubleshoot HTTP errors",
      "id": "troubleshoot-http-errors"
    },
    {
      "level": "h2",
      "text": "Download a Cloudflare root certificate",
      "id": "download-a-cloudflare-root-certificate"
    },
    {
      "level": "h3",
      "text": "Verify the downloaded certificate",
      "id": "verify-the-downloaded-certificate"
    },
    {
      "level": "h3",
      "text": "Convert the certificate",
      "id": "convert-the-certificate"
    },
    {
      "level": "h2",
      "text": "Add the certificate to operating systems",
      "id": "add-the-certificate-to-operating-systems"
    },
    {
      "level": "h3",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h3",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h3",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h3",
      "text": "iOS",
      "id": "ios"
    },
    {
      "level": "h3",
      "text": "Android",
      "id": "android"
    },
    {
      "level": "h3",
      "text": "ChromeOS",
      "id": "chromeos"
    },
    {
      "level": "h2",
      "text": "Add the certificate to applications",
      "id": "add-the-certificate-to-applications"
    },
    {
      "level": "h3",
      "text": "Browsers",
      "id": "browsers"
    },
    {
      "level": "h3",
      "text": "Mobile device management (MDM) software",
      "id": "mobile-device-management-(mdm)-software"
    },
    {
      "level": "h3",
      "text": "Programming languages and runtimes",
      "id": "programming-languages-and-runtimes"
    },
    {
      "level": "h3",
      "text": "Development tools and package managers",
      "id": "development-tools-and-package-managers"
    },
    {
      "level": "h3",
      "text": "Command-line tools",
      "id": "command-line-tools"
    },
    {
      "level": "h3",
      "text": "IDEs and development environments",
      "id": "ides-and-development-environments"
    },
    {
      "level": "h3",
      "text": "Cloud and infrastructure tools",
      "id": "cloud-and-infrastructure-tools"
    },
    {
      "level": "h3",
      "text": "Enterprise applications",
      "id": "enterprise-applications"
    },
    {
      "level": "h2",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "iOS",
      "id": "ios"
    },
    {
      "level": "h2",
      "text": "Android",
      "id": "android"
    },
    {
      "level": "h2",
      "text": "ChromeOS",
      "id": "chromeos"
    },
    {
      "level": "h2",
      "text": "Windows",
      "id": "windows"
    },
    {
      "level": "h2",
      "text": "macOS",
      "id": "macos"
    },
    {
      "level": "h2",
      "text": "Linux",
      "id": "linux"
    },
    {
      "level": "h2",
      "text": "iOS and Android",
      "id": "ios-and-android"
    },
    {
      "level": "h2",
      "text": "Gateway with WARP (default)",
      "id": "gateway-with-warp-(default)"
    },
    {
      "level": "h3",
      "text": "1. Create a Cloudflare Zero Trust account.",
      "id": "1.-create-a-cloudflare-zero-trust-account."
    },
    {
      "level": "h3",
      "text": "2. Set up a login method.",
      "id": "2.-set-up-a-login-method."
    },
    {
      "level": "h3",
      "text": "3. Next, define device enrollment permissions.",
      "id": "3.-next,-define-device-enrollment-permissions."
    },
    {
      "level": "h3",
      "text": "4. Install the Cloudflare root certificate on your devices.",
      "id": "4.-install-the-cloudflare-root-certificate-on-your-devices."
    },
    {
      "level": "h3",
      "text": "5. Download and deploy the WARP client to your devices.",
      "id": "5.-download-and-deploy-the-warp-client-to-your-devices."
    },
    {
      "level": "h3",
      "text": "6. Log in to your organization's Cloudflare Zero Trust instance from your devices.",
      "id": "6.-log-in-to-your-organization's-cloudflare-zero-trust-instance-from-your-devices."
    },
    {
      "level": "h2",
      "text": "Gateway with DoH",
      "id": "gateway-with-doh"
    },
    {
      "level": "h3",
      "text": "1. Create a Cloudflare Zero Trust account.",
      "id": "1.-create-a-cloudflare-zero-trust-account."
    },
    {
      "level": "h3",
      "text": "2. Set up a login method.",
      "id": "2.-set-up-a-login-method."
    },
    {
      "level": "h3",
      "text": "3. Next, define device enrollment permissions.",
      "id": "3.-next,-define-device-enrollment-permissions."
    },
    {
      "level": "h3",
      "text": "4. (optional) Add a DNS location to Gateway.",
      "id": "4.-(optional)-add-a-dns-location-to-gateway."
    },
    {
      "level": "h3",
      "text": "5. Download and deploy the WARP client to your devices.",
      "id": "5.-download-and-deploy-the-warp-client-to-your-devices."
    },
    {
      "level": "h2",
      "text": "Create lists for using Magic Firewall rules",
      "id": "create-lists-for-using-magic-firewall-rules"
    },
    {
      "level": "h2",
      "text": "Endpoints (User devices)",
      "id": "endpoints-(user-devices)"
    },
    {
      "level": "h3",
      "text": "Suggested rules",
      "id": "suggested-rules"
    },
    {
      "level": "h2",
      "text": "Internal router/Firewall IP addresses",
      "id": "internal-router/firewall-ip-addresses"
    },
    {
      "level": "h3",
      "text": "Suggested rules",
      "id": "suggested-rules"
    },
    {
      "level": "h2",
      "text": "Web Servers",
      "id": "web-servers"
    },
    {
      "level": "h3",
      "text": "Suggested rules",
      "id": "suggested-rules"
    },
    {
      "level": "h3",
      "text": "Suggested rules for Cloudflare proxied traffic",
      "id": "suggested-rules-for-cloudflare-proxied-traffic"
    },
    {
      "level": "h2",
      "text": "Non-web servers",
      "id": "non-web-servers"
    },
    {
      "level": "h3",
      "text": "Suggested rules",
      "id": "suggested-rules"
    },
    {
      "level": "h2",
      "text": "Recommended rules",
      "id": "recommended-rules"
    },
    {
      "level": "h2",
      "text": "Traffic and port types",
      "id": "traffic-and-port-types"
    },
    {
      "level": "h2",
      "text": "Other common traffic to consider",
      "id": "other-common-traffic-to-consider"
    },
    {
      "level": "h2",
      "text": "Get all DNS protection rules",
      "id": "get-all-dns-protection-rules"
    },
    {
      "level": "h3",
      "text": "Create DNS protection rule",
      "id": "create-dns-protection-rule"
    },
    {
      "level": "h3",
      "text": "Update DNS protection rule",
      "id": "update-dns-protection-rule"
    }
  ],
  "url": "llms-txt#forwarding-config",
  "links": []
}