{
  "title": "Single Redirects resource",
  "content": "resource \"cloudflare_ruleset\" \"single_redirects_example\" {\n  zone_id     = \"<ZONE_ID>\"\n  name        = \"redirects\"\n  description = \"Redirects ruleset\"\n  kind        = \"zone\"\n  phase       = \"http_request_dynamic_redirect\"\n\nrules {\n    ref         = \"redirect_old_url\"\n    description = \"Redirect visitors still using old URL\"\n    expression  = \"(http.request.uri.path matches \\\"^/contact-us/\\\")\"\n    action      = \"redirect\"\n    action_parameters {\n      from_value {\n        status_code = 301\n        target_url {\n          value = \"/contacts/\"\n        }\n        preserve_query_string = false\n      }\n    }\n  }\n}\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"wordpress\",\n                            \"enabled\": false\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"joomla\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"wordpress\",\n                            \"enabled\": false\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"block\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"block\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID_1>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"id\": \"<RULE_ID_2>\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID_1>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"id\": \"<RULE_ID_2>\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/ddos_l7/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<HTTP_DDOS_RULESET_ID>\",\n                \"overrides\": {\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"sensitivity_level\": \"low\"\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/zones/$ZONE_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"true\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"drupal\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nbash\ncurl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/rulesets/phases/http_request_firewall_managed/entrypoint\" \\\n  --request PUT \\\n  --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n  --json '{\n    \"rules\": [\n        {\n            \"action\": \"execute\",\n            \"expression\": \"cf.zone.name eq \\\"example.com\\\" and cf.zone.plan eq \\\"ENT\\\"\",\n            \"action_parameters\": {\n                \"id\": \"<MANAGED_RULESET_ID>\",\n                \"overrides\": {\n                    \"enabled\": false,\n                    \"categories\": [\n                        {\n                            \"category\": \"wordpress\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        },\n                        {\n                            \"category\": \"drupal\",\n                            \"action\": \"log\",\n                            \"enabled\": true\n                        }\n                    ],\n                    \"rules\": [\n                        {\n                            \"id\": \"<RULE_ID>\",\n                            \"action\": \"block\",\n                            \"enabled\": true\n                        }\n                    ]\n                }\n            }\n        }\n    ]\n  }'\nsql\n(ip.src.country ne \"GB\")\ntxt",
  "code_samples": [
    {
      "code": "Use the `ref` field to get stable rule IDs across updates when using Terraform. Adding this field prevents Terraform from recreating the rule on changes. For more information, refer to [Troubleshooting](https://developers.cloudflare.com/terraform/troubleshooting/rule-id-changes/#how-to-keep-the-same-rule-id-between-modifications) in the Terraform documentation.\n\n## Additional resources\n\nFor additional guidance on using Terraform with Cloudflare, refer to the following resources:\n\n* [Terraform documentation](https://developers.cloudflare.com/terraform/)\n* [Cloudflare Provider for Terraform](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs) (reference documentation)\n\n</page>\n\n<page>\n---\ntitle: Use category overrides to enable Joomla rules · Cloudflare Ruleset Engine docs\ndescription: Use the Rulesets API to configure the execution of a managed\n  ruleset and override its behavior. By default, enabled rules perform the\n  actions defined by the managed ruleset issuer. This example uses overrides to\n  ensure that only rules with a specific tag are enabled.\nlastUpdated: 2025-04-01T09:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-joomla-only/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-joomla-only/index.md\n---\n\nUse the [Rulesets API](https://developers.cloudflare.com/ruleset-engine/rulesets-api/) to configure the execution of a managed ruleset and override its behavior. By default, enabled rules perform the actions defined by the managed ruleset issuer. This example uses overrides to ensure that only rules with a specific tag are enabled.\n\nFollow the steps below to configure the execution of a managed ruleset with two overrides for enabling only the rules tagged with `joomla`.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. Configure a tag override that enables only the rules with a given tag.\n\nTag overrides take precedence over ruleset overrides. Only the rules with the specified tag are enabled, and all other rules are disabled.\n\n## Example 1\n\nThis example deploys the Cloudflare Managed Ruleset to a phase with only Joomla rules enabled. The `name`, `kind`, and `phase` fields are omitted from the request because they are immutable.\n\nExample: Enable only Joomla rules using category overrides at the zone level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "* `\"id\": \"<MANAGED_RULESET_ID>\"` adds a rule to the ruleset of a phase that will apply the Cloudflare Managed Ruleset to requests for the specified zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level that disables all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"joomla\", \"action\": \"block\", \"enabled\": true}]` defines an override at the tag level that enables the Joomla rules and sets their action to `block`.\n\nExample: Enable only Joomla rules using category overrides at the account level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "* `\"id\": \"<MANAGED_RULESET_ID>\"` adds a rule to the ruleset of a phase that will apply the Cloudflare Managed Ruleset to requests for `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level that disables all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"joomla\", \"action\": \"block\", \"enabled\": true}]` defines an override at the tag level that enables the Joomla rules and sets their action to `block`.\n\nYou can add more than one category override to a rule.\n\n## Example 2\n\nThis example adds two overrides to the rule that executes a managed ruleset (`<MANAGED_RULESET_ID>`) in the `http_request_firewall_managed` phase. Note that the `name`, `kind`, and `phase` fields are omitted from the request because they are immutable.\n\nExample: Add more than one category override at the zone level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "Example: Add more than one category override at the account level\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "The order of the overrides in the ruleset determines if rules in the deployed managed ruleset are enabled or disabled. Overrides placed later in the list take precedence over earlier overrides.\n\nConsider four rules from the managed ruleset in the code above that have different combinations of `category` tags. The following table shows the status of the rules after the overrides.\n\n| Rule in managed ruleset | Tags | Rule status after overrides |\n| - | - | - |\n| ManagedRule1 | `drupal`, `dos` | Disabled |\n| ManagedRule2 | `drupal`, `dos`, `joomla` | Enabled |\n| ManagedRule3 | `dos`, `joomla`, `wordpress` | Disabled |\n| ManagedRule4 | `drupal`, `wordpress` | Disabled |\n| ManagedRule5 | (no tags) | Disabled |\n\n</page>\n\n<page>\n---\ntitle: Use tag overrides to set WordPress rules to Block · Cloudflare Ruleset\n  Engine docs\ndescription: Follow the steps below to create a rule that executes a managed\n  ruleset and defines an override for rules with a specific tag.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-wordpress-block/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/deploy-cmr-wordpress-block/index.md\n---\n\nFollow the steps below to create a rule that executes a managed ruleset and defines an override for rules with a specific tag.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a tag override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets a specified action for all rules with a given tag.\n\n## Zone-level example\n\nThis example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to perform the following two steps in a single `PUT` request:\n\n* Set the list of rules in the `http_request_firewall_managed` phase entry point ruleset to a single rule that executes the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/).\n* Override rules with the `wordpress` tag to set the action to `block`. All other rules use the default action provided by the ruleset issuer.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThis example uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to perform the following two steps in a single `PUT` request:\n\n* Set the list of rules in the `http_request_firewall_managed` phase entry point ruleset to a single rule that executes the [Cloudflare Managed Ruleset](https://developers.cloudflare.com/waf/managed-rules/reference/cloudflare-managed-ruleset/) for the zone `example.com`.\n* Override rules with the `wordpress` tag to set the action to `block`. All other rules use the default action provided by the ruleset issuer.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Use rulesets and rule overrides to only enable selected rules ·\n  Cloudflare Ruleset Engine docs\ndescription: Use a ruleset override and a rule override in a phase entry point\n  ruleset to execute only selected rules in a managed ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/enable-selected-rules/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/enable-selected-rules/index.md\n---\n\nUse a ruleset override and a rule override in a phase entry point ruleset to execute only selected rules in a managed ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset that executes a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) to set an action for the rules you want to execute.\n\n## Zone-level example\n\nThe following `PUT` request uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to define a configuration that executes only two rules from a managed ruleset in the `http_request_firewall_managed` phase.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests in the specified zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"rules\": [{\"id\": \"<RULE_ID_1>\", \"action\": \"block\", \"enabled\": true}, {\"id\": \"<RULE_ID_2>\", \"action\": \"log\", \"enabled\": true}]` defines a list of overrides at the rule level to enable two individual rules.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThe following `PUT` request uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to define a configuration that executes only two rules from a managed ruleset in the `http_request_firewall_managed` phase.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"rules\": [{\"id\": \"<RULE_ID_1>\", \"action\": \"block\", \"enabled\": true}, {\"id\": \"<RULE_ID_2>\", \"action\": \"log\", \"enabled\": true}]` defines a list of overrides at the rule level to enable two individual rules.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Adjust an L3/4 DDoS rule · Cloudflare Ruleset Engine docs\nlastUpdated: 2025-07-11T17:09:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/link-override-ddos-l34-rule-sensitivity/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/link-override-ddos-l34-rule-sensitivity/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Adjust the sensitivity of an HTTP DDoS rule to Low · Cloudflare Ruleset\n  Engine docs\ndescription: Follow the steps below to override the sensitivity of a specific\n  rule of the Cloudflare HTTP DDoS Attack Protection managed ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ddos-rule-sensitivity/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ddos-rule-sensitivity/index.md\n---\n\nFollow the steps below to override the sensitivity of a specific rule of the Cloudflare HTTP DDoS Attack Protection managed ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase to deploy the Cloudflare HTTP DDoS Attack Protection managed ruleset. You only need to deploy this specific ruleset when you wish to define one or more overrides, since it is enabled by default.\n2. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets the `sensitivity_level` of a specific rule.\n\n## Example\n\nThe following example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the two steps in a single `PUT` request.\n\n* Set the rules in the `ddos_l7` phase entry point ruleset to a single rule that executes the Cloudflare HTTP DDoS Attack Protection managed ruleset (with ID `<HTTP_DDOS_RULESET_ID>`).\n* Create an override for the rule with ID `<RULE_ID>` and set the rule sensitivity to `low`. All other rules use the default sensitivity defined by Cloudflare.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Deploy a managed ruleset with ruleset, tag, and rule overrides ·\n  Cloudflare Ruleset Engine docs\ndescription: Customize the execution of managed rulesets with a combination of\n  ruleset overrides, tag overrides, and rule overrides in your phase entry point\n  ruleset.\nlastUpdated: 2025-10-22T08:15:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ruleset-tag-rule/\n  md: https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-examples/override-ruleset-tag-rule/index.md\n---\n\nCustomize the execution of managed rulesets with a combination of ruleset overrides, tag overrides, and rule overrides in your phase entry point ruleset.\n\n1. [Add a rule](https://developers.cloudflare.com/ruleset-engine/basic-operations/deploy-rulesets/) to a phase entry point ruleset to execute a managed ruleset.\n2. [Configure a ruleset override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that disables all rules in the managed ruleset.\n3. [Configure a tag override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets an action for rules with a given tag.\n4. [Configure a rule override](https://developers.cloudflare.com/ruleset-engine/managed-rulesets/override-managed-ruleset/) that sets an action for the rules you want to execute.\n\n## Zone-level example\n\nThis example uses the [Update a zone entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the following in a single `PUT` request:\n\n* Add a rule to the `http_request_firewall_managed` phase entry point ruleset that executes a managed ruleset.\n* Use category overrides to enable rules with `wordpress` and `drupal` tags and set their actions to `log`.\n* Add a rule override that enables a single rule.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to a zone (`$ZONE_ID`).\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"wordpress\", \"action\": \"log\", \"enabled\": true}, {\"category\": \"drupal\", \"action\": \"log\", \"enabled\": true}]` defines an override at the tag level to enable rules tagged with `wordpress` or `drupal` and sets their action to `log`.\n* `\"rules\": [{\"id\": \"<RULE_ID>\", \"action\": \"block\", \"enabled\": true}]` defines an override at the rule level that enables one individual rule and sets the action to `block`.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Response Compression Write`\n* `Config Settings Write`\n* `Dynamic URL Redirects Write`\n* `Cache Settings Write`\n* `Custom Errors Write`\n* `Origin Write`\n* `Managed headers Write`\n* `Zone Transform Rules Write`\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `HTTP DDoS Managed Ruleset Write`\n* `Sanitize Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Bot Management Write`\n* `Zone WAF Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "## Account-level example\n\nThis example uses the [Update an account entry point ruleset](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update/) operation to execute the following in a single `PUT` request:\n\n* Add a rule to the `http_request_firewall_managed` phase entry point ruleset that executes a managed ruleset for the zone `example.com`.\n* Use category overrides to enable rules with `wordpress` and `drupal` tags and set their actions to `log`.\n* Add a rule override that enables a single rule.\n\nIn this example:\n\n* `\"id\": \"<MANAGED_RULESET_ID>\"` defines the managed ruleset to execute for requests addressed to `example.com`.\n* `\"enabled\": false` defines an override at the ruleset level to disable all rules in the managed ruleset.\n* `\"categories\": [{\"category\": \"wordpress\", \"action\": \"log\", \"enabled\": true}, {\"category\": \"drupal\", \"action\": \"log\", \"enabled\": true}]` defines an override at the tag level to enable rules tagged with `wordpress` or `drupal` and sets their action to `log`.\n* `\"rules\": [{\"id\": \"<RULE_ID>\", \"action\": \"block\", \"enabled\": true}]` defines an override at the rule level that enables one individual rule and sets the action to `block`.\n\nNote\n\nAt the account level, the rule expression of an `execute` rule must end with `and cf.zone.plan eq \"ENT\"` so that it only applies to zones on an Enterprise plan.\n\nRequired API token permissions\n\nAt least one of the following [token permissions](https://developers.cloudflare.com/fundamentals/api/reference/permissions/) is required:\n\n* `Mass URL Redirects Write`\n* `Magic Firewall Write`\n* `L4 DDoS Managed Ruleset Write`\n* `Transform Rules Write`\n* `Select Configuration Write`\n* `Account WAF Write`\n* `Account Rulesets Write`\n* `Logs Write`",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Edit expressions in the dashboard · Cloudflare Ruleset Engine docs\ndescription: Edit expressions in the Cloudflare dashboard using the Expression\n  Builder, which allows for a visual approach, or using the Expression Editor,\n  in which you type the expression.\nlastUpdated: 2025-11-21T10:50:37.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/\n  md: https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/index.md\n---\n\nIn the Cloudflare dashboard, there are two options for editing [expressions](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/):\n\n* [Expression Builder](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-builder): Allows you to create expressions using drop-down lists, emphasizing a visual approach to defining an expression.\n* [Expression Editor](https://developers.cloudflare.com/ruleset-engine/rules-language/expressions/edit-expressions/#expression-editor): A text-only interface that supports advanced features, such as grouping symbols and functions for transforming and validating values.\n\nIn general, you can switch back and forth between the Expression Builder and the Expression Editor. However, the Expression Builder does not support advanced features like:\n\n* [Nested expressions](#create-nested-expressions)\n* [Function calls](https://developers.cloudflare.com/ruleset-engine/rules-language/functions/)\n\nThe builder may also not show all the fields you can use in the expression you are editing.\n\nIf you use advanced expression features or enter unlisted fields in your expression when using the editor, you may not be able to switch to the Expression Builder. You will get a warning popup stating that the expression is not supported in the builder. To proceed, you may discard any changes made in the editor, or cancel the switch and continue working in the editor.\n\n## Expression Builder\n\nThe Expression Builder allows you to visually create rule expressions by using drop-down lists and entering field values to define one or multiple sub-expressions.\n\n![The Expression Builder interface used to visually define expressions](https://developers.cloudflare.com/_astro/expression-builder.Cg2aqK5m_Z213DfV.webp)\n\nThe **Expression Preview** displays the expression in text:",
      "language": "unknown"
    },
    {
      "code": "The Expression Builder will [automatically escape](#escape-special-characters) the backslash (`\\`) and double quote (`\"`) special characters in string literals when using the [quoted string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#quoted-string-syntax).\n\n## Expression Editor\n\nThe **Expression Editor** is a text-only interface for defining rule expressions that supports the entire specification of Cloudflare's [Rules language](https://developers.cloudflare.com/ruleset-engine/rules-language/), including parentheses as grouping symbols.\n\n![The Expression Editor used to enter advanced expressions](https://developers.cloudflare.com/_astro/expression-editor.CI-o8RRS_ZLoFLg.webp)\n\nTo access the Expression Editor, select **Edit expression** next to the **Expression Preview**:\n\n![Selecting Edit expression in the Create custom rule page to switch to the Expression Editor](https://developers.cloudflare.com/_astro/expression-builder.Cg2aqK5m_Z213DfV.webp)\n\nTo switch back from the Expression Editor to the Expression Builder, select **Use expression builder**.\n\n### Escape special characters\n\nIn expressions using the [quoted string syntax](https://developers.cloudflare.com/ruleset-engine/rules-language/values/#quoted-string-syntax), all backslash (`\\`) and double quote (`\"`) characters in string literals must be escaped. The visual Expression Builder will automatically escape these special characters by prepending a backslash such that `\\` and `\"` become `\\\\` and `\\\"`, respectively.",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Additional resources",
      "id": "additional-resources"
    },
    {
      "level": "h2",
      "text": "Example 1",
      "id": "example-1"
    },
    {
      "level": "h2",
      "text": "Example 2",
      "id": "example-2"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Zone-level example",
      "id": "zone-level-example"
    },
    {
      "level": "h2",
      "text": "Account-level example",
      "id": "account-level-example"
    },
    {
      "level": "h2",
      "text": "Expression Builder",
      "id": "expression-builder"
    },
    {
      "level": "h2",
      "text": "Expression Editor",
      "id": "expression-editor"
    },
    {
      "level": "h3",
      "text": "Escape special characters",
      "id": "escape-special-characters"
    }
  ],
  "url": "llms-txt#single-redirects-resource",
  "links": []
}