{
  "title": "Specify ContentType to restrict uploads to a specific file type",
  "content": "put_url = s3.generate_presigned_url(\n    'put_object',\n    Params={\n        'Bucket': 'my-bucket',\n        'Key': 'dog.png',\n        'ContentType': 'image/png'\n    },\n    ExpiresIn=3600\n)\n\nprint(put_url)\nsh\nhttps://<ACCOUNT_ID>.r2.cloudflarestorage.com/my-bucket/dog.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=...&X-Amz-Date=<timestamp>&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=<signature>\nhttps://<ACCOUNT_ID>.r2.cloudflarestorage.com/my-bucket/dog.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=...&X-Amz-Date=<timestamp>&X-Amz-Expires=3600&X-Amz-SignedHeaders=content-type%3Bhost&X-Amz-Signature=<signature>\nsh\ncurl -X PUT \"https://<ACCOUNT_ID>.r2.cloudflarestorage.com/my-bucket/dog.png?X-Amz-Algorithm=...\" \\\n  -H \"Content-Type: image/png\" \\\n  --data-binary @dog.png\njson\n[\n  {\n    \"AllowedOrigins\": [\"https://example.com\"],\n    \"AllowedMethods\": [\"PUT\"],\n    \"AllowedHeaders\": [\"Content-Type\"],\n    \"ExposeHeaders\": [\"ETag\"],\n    \"MaxAgeSeconds\": 3600\n  }\n]\npython",
  "code_samples": [
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "You can use the link generated by the `put_object` example to upload to the specified bucket and key, until the presigned link expires. When using a presigned URL with `ContentType`, the client must include a matching `Content-Type` header in the request.",
      "language": "unknown"
    },
    {
      "code": "## Restrict uploads with CORS and Content-Type\n\nWhen generating presigned URLs for uploads, you can limit abuse and misuse by:\n\n1. **Restricting Content-Type**: Specify the allowed content type in the presigned URL parameters. The upload will fail if the client sends a different `Content-Type` header.\n\n2. **Configuring CORS**: Set up [CORS rules](https://developers.cloudflare.com/r2/buckets/cors/#add-cors-policies-from-the-dashboard) on your bucket to control which origins can upload files. Configure CORS via the [Cloudflare dashboard](https://dash.cloudflare.com/?to=/:account/r2/overview) by adding a JSON policy to your bucket settings:",
      "language": "unknown"
    },
    {
      "code": "Then generate a presigned URL with a Content-Type restriction:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Restrict uploads with CORS and Content-Type",
      "id": "restrict-uploads-with-cors-and-content-type"
    }
  ],
  "url": "llms-txt#specify-contenttype-to-restrict-uploads-to-a-specific-file-type",
  "links": []
}