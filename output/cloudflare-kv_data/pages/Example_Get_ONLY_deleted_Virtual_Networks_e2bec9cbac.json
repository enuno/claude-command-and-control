{
  "title": "Example: Get ONLY deleted Virtual Networks",
  "content": "curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/teamnet/virtual_networks?is_deleted=true\" \\\n     -H \"Authorization: Bearer $API_TOKEN\"\nsh\nnetcat -zv [your-server's-ip-address] 80\nnetcat -zv [your-server's-ip-address] 443\ntxt\n[ip-address] 80 (http) open\ntxt\n[ip-address] 443 (https): Connection refused\ntxt\nResolveUnicastSingleLabel=yes\nsh\nsudo systemctl restart systemd-resolved.service\ntxt\n   HKEY_LOCAL_MACHINE\\SOFTWARE\\POLICIES\\MICROSOFT\\Windows\\NetworkConnectivityStatusIndicator\n   Type: DWORD\n   Value: UseGlobalDNS\n   Data: 1\n   txt\n   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NlaSvc\\Parameters\\Internet\n   Type: DWORD\n   Value: EnableActiveProbing\n   Data: 1\n   sh\n   warp-cli tunnel rotate-keys\n   powershell\nmsiexec /i <PATH_TO_WARP_MSI> /L*V <PATH_TO_OUTPUT_LOG>\npowershell\nGet-ChildItem -Path \"HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\" -Recurse | ForEach-Object { $_.Name; Get-ItemProperty $_.PSPath; \"\" }\ntxt\nChannelTimeout global=8h\ntf\n     resource \"cloudflare_zero_trust_access_identity_provider\" \"microsoft_entra_id\" {\n       account_id = var.cloudflare_account_id\n       name       = \"Entra ID example\"\n       type       = \"azureAD\"\n       config      = {\n         client_id                  = var.entra_id_client_id\n         client_secret              = var.entra_id_client_secret\n         directory_id               = var.entra_id_directory_id\n         support_groups             = true\n         }\n     }\n     mermaid\n    flowchart LR\n\t\t\tsubgraph remotebrowser[Remote browser]\n        siteA[\"Isolated\n\t\t\t\twebsite\"]--Data-->remoteclip[\"Remote\n\t\t\t\tclipboard\"]\n      end\n\t\t\tsubgraph client[Client]\n        localclip[\"Local\n\t\t\t\tclipboard\"]\n      end\n\t\t\tremoteclip-->localclip\nmermaid\n    flowchart LR\n\t\t\tsubgraph client[Client]\n        localclip[\"Local\n\t\t\t\tclipboard\"]\n      end\n\t\t\tsubgraph remotebrowser[Remote browser]\n\t\t\t\tremoteclip[\"Remote\n\t\t\t\tclipboard\"]-->siteA[\"Isolated\n\t\t\t\twebsite\"]\n      end\n\t\t\tlocalclip--Data-->remoteclip\nbash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate all security threats\",\n      \"description\": \"Isolate security threats such as malware and phishing\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.uri.security_category[*] in {68 178 80 83 176 175 117 131 134 151 153})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate high risk content\",\n      \"description\": \"Isolate high risk content categories such as newly registered domains\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.uri.content_category[*] in {32 169 177 128})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate news and media\",\n      \"description\": \"Isolate news and media sites, which are targets for malvertising attacks\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(http.request.uri.content_category[*] in {122})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate uncategorized content\",\n      \"description\": \"Isolate content not categorized by Cloudflare Radar\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"not(any(http.request.uri.content_category[*] in {2 67 125 133 3 75 183 89 182 6 90 91 144 150 7 70 74 76 79 92 96 100 106 107 116 120 121 122 127 139 156 164 99 9 101 137 10 103 146 11 12 77 98 108 110 111 118 126 129 172 168 113 33 179 166 15 115 119 124 141 161 17 85 87 102 157 135 138 180 162 140 142 32 169 177 128 22 73 82 88 148 23 24 181 71 72 173 78 84 86 94 97 104 105 114 174 93 130 132 136 147 149 154 158 152 26 69 184 81 95 109 123 145 155 159 160 163 165 167}))\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/rules\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"name\": \"Isolate ChatGPT\",\n      \"description\": \"Isolate the use of ChatGPT\",\n      \"enabled\": true,\n      \"action\": \"isolate\",\n      \"filters\": [\n          \"http\"\n      ],\n      \"traffic\": \"any(app.ids[*] in {1199})\",\n      \"identity\": \"\",\n      \"device_posture\": \"\"\n    }'\n  csv\nvalue,description\n192.0.2.0/24,This is an IP address range in CIDR format\n198.51.100.0/24,This is also an IP address range\n203.0.113.0/24,This is the third IP address range\ntf\n     locals {\n       ip_list = csvdecode(file(\"${path.module}/list-test.csv\"))\n     }\n     tf\n     resource \"cloudflare_zero_trust_list\" \"ips_from_csv\" {\n       account_id  = var.cloudflare_account_id\n       name        = \"IPs imported from CSV\"\n       description = \"Managed by Terraform\"\n       type        = \"IP\"\n       items       = local.ip_list\n     }\n     bash\n  curl \"https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/gateway/lists\" \\\n    --request POST \\\n    --header \"Authorization: Bearer $CLOUDFLARE_API_TOKEN\" \\\n    --json '{\n      \"description\": \"Private application IPs\",\n      \"items\": [\n          {\n              \"value\": \"10.226.0.177/32\"\n          },\n          {\n              \"value\": \"10.226.1.177/32\"\n          }\n      ],\n      \"name\": \"Corporate IP list\",\n      \"type\": \"IP\"\n    }'\n  tf\n     resource \"cloudflare_zero_trust_list\" \"wiki_IPs\" {\n       account_id  = var.cloudflare_account_id\n       name        = \"Company Wiki IP addresses\"\n       description = \"Managed by Terraform\"\n       type        = \"IP\"\n       items = [\n         {\n           description = \"Example IP address range\"\n           value = \"192.0.2.0/24\",\n         },\n         {\n           value = \"198.51.100.0/24\"\n         }\n       ]\n     }\n     tf\n     resource \"cloudflare_zero_trust_list\" \"wiki_domains\" {\n       account_id  = var.cloudflare_account_id\n       name        = \"Company Wiki Domains\"\n       description = \"Managed by Terraform\"\n       type        = \"DOMAIN\"\n       items = [\n         {\n           value = \"wiki.example.com\"\n         },\n         {\n           value = \"wiki2.example.com\"\n         }]\n     }\n     mermaid\nflowchart LR\naccTitle: Device posture policy enforcement\nA[Device] --schedule--> B[WARP client]--> C((Cloudflare)) --> D[Access policy]\nC --5 min--> E[Cache] --> F[Gateway policy]\nA --> G[Service provider] --interval--> C\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rules/lists \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"name\": \"iplist\",\n  \"description\": \"This contains IPs that should be allowed.\",\n  \"kind\": \"ip\"\n}'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rules/lists/{list_id}/items \\\n--header \"X-Auth-Email: <EMAIL>\" \\\n--header \"X-Auth-Key: <API_KEY>\" \\\n--header \"Content-Type: application/json\" \\\n--data '[\n  {\"ip\":\"10.0.0.1\"},\n  {\"ip\":\"10.10.0.0/24\"}\n]'\nbash\ncurl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/{ruleset_id}/rules \\\n--header \"Authorization: Bearer <API_TOKEN>\" \\\n--header \"Content-Type: application/json\" \\\n--data '{\n  \"action\": \"skip\",\n  \"action_parameters\": {\n    \"ruleset\": \"current\"\n  },\n  \"expression\": \"ip.src in $iplist\",\n  \"description\": \"Allowed IPs from iplist\",\n  \"enabled\": true\n}'\ntf\ndata \"cloudflare_zero_trust_gateway_app_types_list\" \"gateway_apptypes\" {\n  account_id = var.cloudflare_account_id\n}\n\nlocals {\n  apptypes_map = merge([\n    for c in data.cloudflare_zero_trust_gateway_app_types_list.gateway_apptypes.result :\n    { (c.name) = c.id }\n  ]...)\n}\n\nresource \"cloudflare_zero_trust_gateway_policy\" \"zt_block_dns_apps\" {\n  account_id = var.cloudflare_account_id\n  name       = \"DNS Blocked apps\"\n  action     = \"block\"\n  traffic    = \"any(app.ids[*] in {${join(\" \", [\n    local.apptypes_map[\"Discord\"],\n    local.apptypes_map[\"GoToMeeting\"],\n    local.apptypes_map[\"Greenhouse\"],\n    local.apptypes_map[\"Zelle\"],\n    local.apptypes_map[\"Microsoft Visual Studio\"]\n  ])}})\"\n}\ntf\ndata \"cloudflare_zero_trust_gateway_categories_list\" \"categories\" {\n  account_id = var.cloudflare_account_id\n}\n\nlocals {\n  main_categories_map = {\n    for idx, c in data.cloudflare_zero_trust_gateway_categories_list.categories.result :\n    c.name => c.id\n  }\n\nsubcategories_map = merge(flatten([\n    for idx, c in data.cloudflare_zero_trust_gateway_categories_list.categories.result : {\n      for k, v in coalesce(c.subcategories, []) :\n      v.name => v.id\n    }\n  ])...)\n}\n\nresource \"cloudflare_zero_trust_gateway_policy\" \"zt_block_dns_tech_categories\" {\n  account_id = var.cloudflare_account_id\n  name       = \"DNS Blocked\"\n  action     = \"block\"\n  traffic    = \"any(dns.content_category[*] in {${join(\" \", [\n    local.main_categories_map[\"Technology\"],\n    local.subcategories_map[\"APIs\"],\n    local.subcategories_map[\"Artificial Intelligence\"],\n    local.subcategories_map[\"Content Servers\"],\n    local.subcategories_map[\"Translator\"]\n  ])}})\"\n}\nbash\n  curl https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets \\\n  --header \"Authorization: Bearer <API_TOKEN>\" \\\n  --header \"Content-Type: application/json\" \\\n  --data '{\n    \"name\": \"IDS Execute ruleset\",\n    \"description\": \"Ruleset to enable IDS\",\n    \"kind\": \"root\",\n    \"phase\": \"magic_transit_ids_managed\",\n    \"rules\": [\n      {\n        \"enabled\": true,\n        \"expression\": \"true\",\n        \"action\": \"execute\",\n        \"description\": \"enable ids\",\n        \"action_parameters\": {\n          \"id\": \"${managed_ruleset_id}\"\n        }\n      }\n    ]\n  }'\n  bash\n  curl --request PATCH \\\n  https://api.cloudflare.com/client/v4/accounts/{account_id}/rulesets/{root_ruleset_id}/rules/{rule_id} \\\n  --header \"Authorization: Bearer <API_TOKEN>\" \\\n  --header \"Content-Type: application/json\" \\\n  --data '{\n    \"enabled\": false,\n    \"expression\": \"true\",\n    \"action\": \"execute\",\n    \"action_parameters\": {\n      \"id\": \"${managed_ruleset_id}\"\n    }\n  }'\n  txt\ncloudflare.com/redirect-path/path/to/page?querystring=Y\ntxt\ncloudflare.com/redirect-path/path/to/page?querystring=Y&k=1\nmermaid\nflowchart TD\n%% Accessibility\n accTitle: How Gateway policies work in a tiered account configuration\n accDescr: Flowchart describing the order of precedence Gateway applies policies in a tiered account configuration.\n\n%% Flowchart\n subgraph s1[\"Parent account\"]\n        n1[\"Block malware\"]\n        n2[\"Block DNS tunnel\"]\n        n3[\"Block spyware\"]\n  end\n subgraph s2[\"Child account A\"]\n        n4[\"Block social media\"]\n  end\n subgraph s3[\"Child account B\"]\n        n5[\"Block instant messaging\"]\n  end\n    n1 ~~~ n2\n    n2 ~~~ n3\n    A[\"Tenant\"] --Administers--> s1\n    s1 -- \"Applies policies to\" --> s2 & s3\n\nn1@{ shape: lean-l}\n    n2@{ shape: lean-l}\n    n3@{ shape: lean-l}\n    n4@{ shape: lean-l}\n    n5@{ shape: lean-l}\nmermaid\nflowchart TD\n%% Accessibility\n accTitle: How Gateway policies work in a siloed account configuration\n accDescr: Flowchart describing the order of precedence Gateway applies policies in a siloed account configuration.\n\n%% Flowchart\n subgraph s1[\"Siloed account A\"]\n        n1[\"Block social media\"]\n  end\n subgraph s2[\"Siloed account C\"]\n        n2[\"Block instant messaing\"]\n  end\n subgraph s3[\"Siloed account B\"]\n        n3[\"Block news\"]\n  end\n    A[\"Tenant\"] -- Administers --> s1 & s3 & s2\n\nn1@{ shape: lean-l}\n    n2@{ shape: lean-l}\n    n3@{ shape: lean-l}\nmermaid\nflowchart TB\n    %% Accessibility\n    accTitle: Gateway order of enforcement\n    accDescr: Flowchart describing the order of enforcement for Gateway policies.\n\nsubgraph Resolution[\"Resolution\"]\n        dns2[\"1.1.1.1\"]\n        dns4[\"Custom resolver\"]\n        dns3[\"Resolver policies <br>(Enterprise users only)\"]\n        internal[\"Internal DNS\"]\n  end\n subgraph DNS[\"DNS\"]\n        dns1[\"DNS policies\"]\n        Resolution\n  end\n subgraph HTTP[\"HTTP policies\"]\n        http1{{\"Do Not Inspect policies\"}}\n        http2[\"Isolate policies  <br>(with Browser Isolation add-on)\"]\n        http3[\"Allow, Block, Do Not Scan, Quarantine, and Redirect policies, DLP, and anti-virus scanning\"]\n        https[\"HTTP or HTTPS?\"]\n  end\n subgraph Proxy[\"Proxy\"]\n        HTTP\n        network1[\"Network policies\"]\n        nonhttp[\"Non-HTTP(S) traffic\"]\n  end\n subgraph Egress[\"Egress\"]\n        egress1[\"Egress policies <br>(Enterprise users only)\"]\n  end\n    start([\"Traffic\"]) --> dns0[/\"DNS query\"/] & http0[\"Network connections\"]\n    dns0 ----> dns1\n    dns1 -- Resolved by --> dns2\n    dns1 --> dns3\n    dns3 -- Resolved by --> dns4\n    dns2 -----> internet([\"Internet\"])\n    dns4 -----> internet\n    dns4 ---> cloudflare[\"Private network services <br>(Cloudflare Tunnel, Magic WAN, WARP Connector)\"]\n    http1 -- Do Not Inspect --> internet\n    http1 -- Inspect --> http2\n    http2 --> http3\n    http0 --> magic[\"Magic Firewall (Enterprise users only)\"]\n    magic --> egress1\n    egress1 --> tcp[\"Check for origin availability (TCP SYN)\"]\n    tcp --> network1\n    http3 --> internet\n    https -- HTTPS --> http1\n    https -- HTTP --> http2\n    network1 --> https & nonhttp\n    dns3 -- Resolved by --> internal & dns2\n    nonhttp -----> internet\n\nhttps@{ shape: hex}\n    http0@{ shape: lean-r}\nmermaid\nflowchart TD\n    %% Accessibility\n    accTitle: How Gateway proxy works\n    accDescr: Flowchart describing how the Gateway proxy uses the Happy Eyeballs algorithm to establish TCP connections and proxy user traffic.\n\n%% Flowchart\n    A[User's device sends TCP SYN to Gateway] --> B[Gateway sends TCP SYN to origin server]\n    B --> C{{Origin server responds with TCP SYN-ACK?}}\n    C -->|Yes| E[TCP handshakes completed]\n    C -->|No| D[Connection fails]\n    E --> F{{Connection allowed?}}\n    F -->|Allow policy| G[Gateway proxies traffic bidirectionally]\n    F -->|Block policy| H[Connection blocked by firewall policies]\n\n%% Styling\n    style D stroke:#D50000\n    style G stroke:#00C853\n    style H stroke:#D50000\ntf\nresource \"cloudflare_zero_trust_gateway_policy\" \"policy_1\" {\n  account_id = var.cloudflare_account_id\n  # other attributes...\n  precedence = 1000\n}\n\nresource \"cloudflare_zero_trust_gateway_policy\" \"policy_2\" {\n  account_id = var.cloudflare_account_id\n  # other attributes...\n  precedence = 2000\n}\n\nresource \"cloudflare_zero_trust_gateway_policy\" \"policy_3\" {\n  account_id = var.cloudflare_account_id\n  # other attributes...\n  precedence = 3000\n}\nmermaid\nflowchart TD\n    %% Accessibility\n    accTitle: How Gateway proxy works\n    accDescr: Flowchart describing how the Gateway proxy uses the Happy Eyeballs algorithm to establish TCP connections and proxy user traffic.\n\n%% Flowchart\n    A[User's device sends TCP SYN to Gateway] --> B[Gateway sends TCP SYN to origin server]\n    B --> C{{Origin server responds with TCP SYN-ACK?}}\n    C -->|Yes| E[TCP handshakes completed]\n    C -->|No| D[Connection fails]\n    E --> F{{Connection allowed?}}\n    F -->|Allow policy| G[Gateway proxies traffic bidirectionally]\n    F -->|Block policy| H[Connection blocked by firewall policies]\n\n%% Styling\n    style D stroke:#D50000\n    style G stroke:#00C853\n    style H stroke:#D50000\nsh\n     ps -aux | grep cloudflared\n     sh\n     johndoe         407  0.8  1.7 1259904 35296 ?       Ssl  21:02   0:00 /usr/bin/cloudflared --no-autoupdate tunnel run --token eyJhI...\n     sh\n     id -g johndoe\n     sh\n     10001\n     sh\n     sudo sysctl net.ipv4.ping_group_range\n     sh\n     net.ipv4.ping_group_range= 0 10000\n     sh\n     echo 0 10001 | sudo tee /proc/sys/net/ipv4/ping_group_range\n     sh\n     echo \"net.ipv4.ping_group_range = 0 10001\" | sudo tee -a /etc/sysctl.d/99-cloudflared.conf\n     sh\n     cloudflared tunnel run --icmpv4-src <IP of primary interface>\n     mermaid\nflowchart TD\n    %% Accessibility\n    accTitle: How Gateway routes DNS queries\n    accDescr: Flowchart describing the order Cloudflare Gateway routes a DNS query from an endpoint through DNS and resolver policies back to the user.\n\n%% Flowchart\n    user([\"User\"])-->endpoint[/\"Gateway DNS endpoint\"/]\n\nendpoint-->query[\"DNS policy (query)\"]\n\nquery-->resolver[\"Resolver policy\"]\n\nresolver--\"Routes to </br>custom resolver\"-->response[\"DNS policy (response)\"]\n\nresponse--\"Returns response\"-->user\ntf\n     resource \"cloudflare_zero_trust_gateway_policy\" \"resolver_policy\" {\n       name        = \"Example resolver policy\"\n       enabled     = true\n       account_id  = var.cloudflare_account_id\n       description = \"TERRAFORM MANAGED resolver policy\"\n       action      = \"resolve\"\n       traffic     = \"dns.fqdn in {\\\"internal.example.com\\\"}\"\n       identity    = \"identity.email in {\\\"jdoe@example.com\\\"}\"\n       precedence  = 1\n       rule_settings = {\n           dns_resolvers = {\n           # You can add up to 10 IPv4 and 10 IPv6 addresses to a policy.\n             ipv4 = [{\n               ip = \"192.0.2.24\"\n               port = 53\n               route_through_private_network = true\n               vnet_id = cloudflare_zero_trust_tunnel_cloudflared_virtual_network.staging_vnet.id\n             }]\n             ipv6 = [{\n               ip = \"2001:DB8::\"\n               port = 53\n               route_through_private_network = true\n               vnet_id = cloudflare_zero_trust_tunnel_cloudflared_virtual_network.staging_vnet.id\n             }]\n           }\n       }\n     }\n     js\n  export default {\n    async fetch(request, env, ctx) {\n      const { headers } = request;\n      const cfaccessemail = headers.get(\"cf-access-authenticated-user-email\");\n\nconst requestWithID = new Request(request);\n      requestWithID.headers.set(\"company-user-id\", cfaccessemail);\n\nreturn fetch(requestWithID);\n    },\n  };\n  ts\n  export default {\n    async fetch(request, env, ctx): Promise<Response> {\n      const { headers } = request;\n      const cfaccessemail = headers.get(\"cf-access-authenticated-user-email\");\n\nconst requestWithID = new Request(request);\n      requestWithID.headers.set(\"company-user-id\", cfaccessemail);\n\nreturn fetch(requestWithID);\n    },\n  } satisfies ExportedHandler<Env>;\n  http\n\"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\",\n    \"Accept-Encoding\": \"gzip\",\n    \"Accept-Language\": \"en-US,en;q=0.9\",\n    \"Cf-Access-Authenticated-User-Email\": \"user@example.com\",\n    \"Company-User-Id\": \"user@example.com\",\n    \"Connection\": \"keep-alive\"\nbash\n     wrangler login\n     bash\n     mkdir ai-agent-wrapper\n     cd ai-agent-wrapper\n     wrangler init\n     toml\n     name = \"ai-agent-wrapper\"\n     main = \"src/index.js\"\n     compatibility_date = \"2023-10-30\"\n\n[vars]\n     # Add any environment variables here\n     bash\n     wrangler secret put <OPENAI_API_KEY>\n     javascript\nexport default {\n  async fetch(request, env) {\n    if (request.url.endsWith(\"/api/chat\")) {\n      if (request.method === \"POST\") {\n        try {\n          const { messages } = await request.json();\n\nconst response = await fetch(\n            \"https://gateway.ai.cloudflare.com/v1/$ACCOUNT_ID/$GATEWAY_ID/openai/chat/completions\",\n            {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: `Bearer ${env.OPENAI_API_KEY}`,\n              },\n              body: JSON.stringify({\n                model: \"gpt-4o-mini\",\n                messages: messages,\n              }),\n            },\n          );\n\nif (!response.ok) {\n            throw new Error(`AI Gateway Error: ${response.status}`);\n          }\n\nconst result = await response.json();\n          return new Response(\n            JSON.stringify({\n              response: result.choices[0].message.content,\n            }),\n            {\n              headers: { \"Content-Type\": \"application/json\" },\n            },\n          );\n        } catch (error) {\n          return new Response(JSON.stringify({ error: error.message }), {\n            status: 500,\n            headers: { \"Content-Type\": \"application/json\" },\n          });\n        }\n      }\n      return new Response(\"Method not allowed\", { status: 405 });\n    }\n\nreturn new Response(HTML, {\n      headers: { \"Content-Type\": \"text/html\" },\n    });\n  },\n};\n\nconst HTML = `<!DOCTYPE html>\n  <html lang=\"en\" data-theme=\"dark\">\n177 collapsed lines\n  <head>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <title>ChatGPT Wrapper</title>\n      <style>\n          :root {\n              --background-color: #1a1a1a;\n              --chat-background: #2d2d2d;\n              --text-color: #ffffff;\n              --input-border: #404040;\n              --message-ai-background: #404040;\n              --message-ai-text: #ffffff;\n          }\n\nbody {\n              font-family: system-ui, sans-serif;\n              margin: 0;\n              padding: 20px;\n              background: var(--background-color);\n              display: flex;\n              flex-direction: column;\n              align-items: center;\n              gap: 20px;\n              color: var(--text-color);\n          }\n\n.chat-container {\n              width: 100%;\n              max-width: 800px;\n              background: var(--chat-background);\n              border-radius: 10px;\n              box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n              height: 80vh;\n              display: flex;\n              flex-direction: column;\n          }\n\n.chat-header {\n              padding: 15px 20px;\n              border-bottom: 1px solid var(--input-border);\n              background: var(--chat-background);\n              border-radius: 10px 10px 0 0;\n              text-align: center;\n          }\n\n.chat-messages {\n              flex-grow: 1;\n              overflow-y: auto;\n              padding: 20px;\n          }\n\n.message {\n              margin-bottom: 20px;\n              padding: 10px 15px;\n              border-radius: 10px;\n              max-width: 80%;\n          }\n\n.user-message {\n              background: #007AFF;\n              color: white;\n              margin-left: auto;\n          }\n\n.ai-message {\n              background: var(--message-ai-background);\n              color: var(--message-ai-text);\n          }\n\n.input-container {\n              padding: 20px;\n              border-top: 1px solid var(--input-border);\n              display: flex;\n              gap: 10px;\n          }\n\ninput {\n              flex-grow: 1;\n              padding: 10px;\n              border: 1px solid var(--input-border);\n              border-radius: 5px;\n              font-size: 16px;\n              background: var(--chat-background);\n              color: var(--text-color);\n          }\n\nbutton {\n              padding: 10px 20px;\n              background: #007AFF;\n              color: white;\n              border: none;\n              border-radius: 5px;\n              cursor: pointer;\n              font-size: 16px;\n          }\n\nbutton:disabled {\n              background: #ccc;\n          }\n\n.error {\n              color: red;\n              padding: 10px;\n              text-align: center;\n          }\n      </style>\n  </head>\n  <body>\n      <div class=\"chat-container\">\n          <div class=\"chat-header\">\n              <h2>AI Assistant</h2>\n          </div>\n          <div class=\"chat-messages\" id=\"messages\"></div>\n          <div class=\"input-container\">\n              <input type=\"text\" id=\"userInput\" placeholder=\"Type your message...\" />\n              <button onclick=\"sendMessage()\" id=\"sendButton\">Send</button>\n          </div>\n      </div>\n\n<script>\n          let messages = [];\n          const messagesDiv = document.getElementById('messages');\n          const userInput = document.getElementById('userInput');\n          const sendButton = document.getElementById('sendButton');\n\nuserInput.addEventListener('keypress', (e) => {\n              if (e.key === 'Enter') sendMessage();\n          });\n\nasync function sendMessage() {\n              const content = userInput.value.trim();\n              if (!content) return;\n\nuserInput.disabled = true;\n              sendButton.disabled = true;\n\nmessages.push({ role: 'user', content });\n              appendMessage('user', content);\n              userInput.value = '';\n\ntry {\n                  const response = await fetch('/api/chat', {\n                      method: 'POST',\n                      headers: { 'Content-Type': 'application/json' },\n                      body: JSON.stringify({\n                          messages\n                      })\n                  });\n\nif (!response.ok) {\n                      throw new Error('API request failed');\n                  }\n\nconst result = await response.json();\n                  const aiMessage = result.response;\n\nmessages.push({ role: 'assistant', content: aiMessage });\n                  appendMessage('ai', aiMessage);\n              } catch (error) {\n                  appendMessage('ai', 'Sorry, there was an error processing your request.');\n                  console.error('Error:', error);\n              }\n\nuserInput.disabled = false;\n              sendButton.disabled = false;\n              userInput.focus();\n          }\n\nfunction appendMessage(role, content) {\n              const messageDiv = document.createElement('div');\n              messageDiv.className = 'message ' + role + '-message';\n              messageDiv.textContent = content;\n              messagesDiv.appendChild(messageDiv);\n              messagesDiv.scrollTop = messagesDiv.scrollHeight;\n          }\n      </script>\n  </body>\n  </html>`;\ntoml\n  name = \"ai-agent-wrapper\"\n  main = \"src/index.js\"\n  compatibility_date = \"2023-10-30\"\n  workers_dev = false\n\n# Replace with your custom domain\n  routes = [\n    { pattern = \"<YOUR_CUSTOM_DOMAIN>\", custom_domain = true }\n  ]\n\n[vars]\n  # Add any environment variables here\n  sh\n   cloudflared access login https://example.com\n   sh\ncloudflared access curl http://example.com\nsh\ncloudflared access login http://example.com\nsh\ncloudflared access curl http://example.com\nsh\ncloudflared access token -app=http://example.com\nsh\n   export TOKEN=$(cloudflared access token -app=http://example.com)\n   sh\n   echo $TOKEN\n   sh\ncurl -H \"cf-access-token: $TOKEN\" https://example.com/rest/api/2/item/foo-123\nsh\n   npm create cloudflare@latest risky-users -- --template https://github.com/cloudflare/msft-risky-user-ad-sync\n   sh\n   cd risky-users\n   jsonc\n     {\n       \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n       \"name\": \"risky-users\",\n       \"compatibility_date\": \"2023-01-04\",\n       \"main\": \"src/index.js\",\n       \"workers_dev\": false,\n       \"account_id\": \"<ACCOUNT-ID>\",\n       \"vars\": {\n         \"AZURE_AD_TENANT_ID\": \"<TENANT-ID>\",\n         \"AZURE_AD_CLIENT_ID\": \"<CLIENT-ID>\"\n       },\n       \"triggers\": {\n         \"crons\": [\n           \"* * * * *\"\n         ]\n       }\n     }\n     toml\n     name = \"risky-users\"\n     compatibility_date = \"2023-01-04\"\n     main = \"src/index.js\"\n     workers_dev = false\n\naccount_id = \"<ACCOUNT-ID>\"\n\n[vars]\n     AZURE_AD_TENANT_ID = \"<TENANT-ID>\"\n     AZURE_AD_CLIENT_ID = \"<CLIENT-ID>\"\n\n[triggers]\n     crons = [\"* * * * *\"]\n     sh\n   npx wrangler deploy\n   sh\n   wrangler secret put AZURE_AD_CLIENT_SECRET\n   sh\nwrangler tail --format pretty\nsh\n     npm create cloudflare@latest -- device-posture-worker\n     sh\n     yarn create cloudflare device-posture-worker\n     sh\n     pnpm create cloudflare@latest device-posture-worker\n     sh\n   $ cd device-posture-worker\n   js\n   import { parse } from \"cookie\";\n   export default {\n     async fetch(request, env, ctx) {\n       // The name of the cookie\n       const COOKIE_NAME = \"CF_Authorization\";\n       const CF_GET_IDENTITY =\n         \"https://<your-team-name>.cloudflareaccess.com/cdn-cgi/access/get-identity\";\n       const cookie = parse(request.headers.get(\"Cookie\") || \"\");\n       if (cookie[COOKIE_NAME] != null) {\n         try {\n           let id = await (await fetch(CF_GET_IDENTITY, request)).json();\n           let diskEncryptionStatus = false;\n           let firewallStatus = false;\n\nfor (const checkId in id.devicePosture) {\n             const check = id.devicePosture[checkId];\n             if (check.type === \"disk_encryption\") {\n               console.log(check.type);\n               diskEncryptionStatus = check.success;\n             }\n             if (check.type === \"firewall\") {\n               console.log(check.type);\n               firewallStatus = check.success;\n               break;\n             }\n           }\n           //clone request (immutable otherwise) and insert posture values in new header set\n           let newRequest = await new Request(request);\n           newRequest.headers.set(\n             \"Cf-Access-Firewall-Activated\",\n             firewallStatus,\n           );\n           newRequest.headers.set(\"Cf-Access-Disk-Encrypted\", firewallStatus);\n\n//sent modified request to origin\n           return await fetch(newRequest);\n         } catch (e) {\n           console.log(e);\n           return await fetch(request);\n         }\n       }\n       return await fetch(request);\n     },\n   };\n   json\n{\n  \"id\": \"P51Tuu01fWHMBjIBvrCK1lK-eUDWs2aQMv03WDqT5oY\",\n  \"name\": \"John Doe\",\n  \"email\": \"john.doe@cloudflare.com\",\n  \"amr\": [\n    \"pwd\"\n  ],\n  \"oidc_fields\": {\n    \"principalName\": \"XXXXXX_cloudflare.com#EXT#@XXXXXXcloudflare.onmicrosoft.com\"\n  },\n  \"groups\": [\n    {\n      \"id\": \"fdaedb59-e9be-4ab7-8001-3e069da54185\",\n      \"name\": \"XXXXX\"\n    }\n  ],\n  \"idp\": {\n    \"id\": \"b9f4d68e-dac1-48b0-b728-ae05a5f0d4b2\",\n    \"type\": \"azureAD\"\n  },\n  \"geo\": {\n    \"country\": \"FR\"\n  },\n  \"user_uuid\": \"ce40d564-c72f-475f-a9b8-f395f19ad986\",\n  \"account_id\": \"121287a0c6e6260ec930655e6b39a3a8\",\n  \"iat\": 1724056537,\n  \"devicePosture\": {\n    \"f6f9391e-6776-4878-9c60-0cc807dc7dc8\": {\n      \"id\": \"f6f9391e-6776-4878-9c60-0cc807dc7dc8\",\n      \"schedule\": \"5m\",\n      \"timestamp\": \"2024-08-19T08:31:59.274Z\",\n      \"description\": \"\",\n      \"type\": \"disk_encryption\",\n      \"check\": {\n        \"drives\": {\n          \"C\": {\n            \"encrypted\": true\n          }\n        }\n      },\n      \"success\": false,\n      \"rule_name\": \"Disk Encryption - Windows\",\n      \"input\": {\n        \"requireAll\": true,\n        \"checkDisks\": []\n    },\n    \"a0a8e83d-be75-4aa6-bfa0-5791da6e9186\": {\n      \"id\": \"a0a8e83d-be75-4aa6-bfa0-5791da6e9186\",\n      \"schedule\": \"5m\",\n      \"timestamp\": \"2024-08-19T08:31:59.274Z\",\n      \"description\": \"\",\n      \"type\": \"firewall\",\n      \"check\": {\n        \"firewall\": false\n      },\n      \"success\": false,\n      \"rule_name\": \"Local Firewall Check - Windows\",\n      \"input\": {\n        \"enabled\": true\n      }\n    }\n    ...\n  }\njsonc\n  {\n    \"$schema\": \"./node_modules/wrangler/config-schema.json\",\n    \"route\": {\n      \"pattern\": \"app.example.com/*\",\n      \"zone_name\": \"example.com\"\n    }\n  }\n  toml\n  route = { pattern= \"app.example.com/*\", zone_name=\"example.com\"}\n  sh\nnpx wrangler deploy\njson\n{\n  \"headers\": {\n    \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\",\n    \"Accept-Encoding\": \"gzip\",\n    \"Accept-Language\": \"en-US,en;q=0.9,fr-FR;q=0.8,fr;q=0.7,en-GB;q=0.6\",\n    \"Cf-Access-Authenticated-User-Email\": \"John.Doe@cloudflare.com\",\n    \"Cf-Access-Disk-Encrypted\": \"false\",\n    \"Cf-Access-Firewall-Activated\": \"false\",\n    \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36\"\n  }\n}\npython\nfrom fastapi import Request, HTTPException",
  "code_samples": [
    {
      "code": "Following this change, retrieving a complete list of both active and deleted resources will require two separate API calls: one to get active items (by omitting the parameter or using `is_deleted=false`) and one to get deleted items (`is_deleted=true`).\n\n#### Why we’re making this change\n\nThis update is based on user feedback and aims to:\n\n* **Create a more intuitive default:** Aligning with common API design principles where list operations return only active resources by default.\n* **Reduce unexpected results:** Prevents users from accidentally operating on deleted resources that were returned unexpectedly.\n* **Improve performance:** For most users, the default query result will now be smaller and more relevant.\n\nTo learn more, please visit the [Cloudflare Tunnel API](https://developers.cloudflare.com/api/resources/zero_trust/subresources/tunnels/) and [Zero Trust Networks API](https://developers.cloudflare.com/api/resources/zero_trust/subresources/networks/) documentation.\n\n## 2025-07-15\n\n**Faster, more reliable UDP traffic for Cloudflare Tunnel**\n\nYour real-time applications running over [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/) are now faster and more reliable. We've completely re-architected the way `cloudflared` proxies UDP traffic in order to isolate it from other traffic, ensuring latency-sensitive applications like private DNS are no longer slowed down by heavy TCP traffic (like file transfers) on the same Tunnel.\n\nThis is a foundational improvement to Cloudflare Tunnel, delivered automatically to all customers. There are no settings to configure — your UDP traffic is already flowing faster and more reliably.\n\n**What’s new:**\n\n* **Faster UDP performance**: We've significantly reduced the latency for establishing new UDP sessions, making applications like private DNS much more responsive.\n* **Greater reliability for mixed traffic**: UDP packets are no longer affected by heavy TCP traffic, preventing timeouts and connection drops for your real-time services.\n\nLearn more about running [TCP or UDP applications](https://developers.cloudflare.com/reference-architecture/architectures/sase/#connecting-applications) and [private networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/) through [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/).\n\n## 2024-12-19\n\n**Troubleshoot tunnels with diagnostic logs**\n\nThe latest `cloudflared` build [2024.12.2](https://github.com/cloudflare/cloudflared/releases/tag/2024.12.2) introduces the ability to collect all the diagnostic logs needed to troubleshoot a `cloudflared` instance.\n\nA diagnostic report collects data from a single instance of `cloudflared` running on the local machine and outputs it to a `cloudflared-diag` file.\n\nThe `cloudflared-diag-YYYY-MM-DDThh-mm-ss.zip` archive contains the files listed below. The data in a file either applies to the `cloudflared` instance being diagnosed (`diagnosee`) or the instance that triggered the diagnosis (`diagnoser`). For example, if your tunnel is running in a Docker container, the diagnosee is the Docker instance and the diagnoser is the host instance.\n\n| File name | Description | Instance |\n| - | - | - |\n| `cli-configuration.json` | [Tunnel run parameters](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/cloudflared-parameters/run-parameters/) used when starting the tunnel | diagnosee |\n| `cloudflared_logs.txt` | [Tunnel log file](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/monitor-tunnels/logs/)[1](#user-content-fn-1) | diagnosee |\n| `configuration.json` | Tunnel configuration parameters | diagnosee |\n| `goroutine.pprof` | goroutine profile made available by `pprof` | diagnosee |\n| `heap.pprof` | heap profile made available by `pprof` | diagnosee |\n| `metrics.txt` | Snapshot of [Tunnel metrics](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/monitor-tunnels/metrics/#available-metrics) at the time of diagnosis | diagnosee |\n| `network.txt` | JSON traceroutes to Cloudflare's global network using IPv4 and IPv6 | diagnoser |\n| `raw-network.txt` | Raw traceroutes to Cloudflare's global network using IPv4 and IPv6 | diagnoser |\n| `systeminformation.json` | Operating system information and resource usage | diagnosee |\n| `task-result.json` | Result of each diagnostic task | diagnoser |\n| `tunnelstate.json` | Tunnel connections at the time of diagnosis | diagnosee |\n\n## Footnotes\n\n1. If the log file is blank, you may need to [set `--loglevel` to `debug`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/monitor-tunnels/logs/#view-logs-on-the-server) when you start the tunnel. The `--loglevel` parameter is only required if you ran the tunnel from the CLI using a `cloudflared tunnel run` command. It is not necessary if the tunnel runs as a Linux/macOS service or runs in Docker/Kubernetes. [↩](#user-content-fnref-1)\n\nFor more information, refer to [Diagnostic logs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/troubleshoot-tunnels/diag-logs/).\n\n## 2024-10-17\n\n**Simplifed WARP Connector deployment**\n\nYou can now deploy WARP Connector using a simplified, guided workflow similar to `cloudflared` connectors. For detailed instructions, refer to the [WARP Connector documentation](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/).\n\n## 2024-10-10\n\n**Bugfix for --grace-period**\n\nThe new `cloudflared` build [2024.10.0](https://github.com/cloudflare/cloudflared/releases/tag/2024.10.0) has a bugfix related to the [--grace-period](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/cloudflared-parameters/run-parameters/#grace-period) tunnel run parameter. `cloudflared` connectors will now abide by the specified waiting period before forcefully closing connections to Cloudflare's network.\n\n## 2024-08-06\n\n**cloudflared builds available in GitHub for Apple silicon**\n\nmacOS users can now download `cloudflared-arm64.pkg` directly from [GitHub](https://github.com/cloudflare/cloudflared/releases), in addition to being available via Homebrew.\n\n</page>\n\n<page>\n---\ntitle: Zero Trust WARP Client Changelog · Cloudflare One docs\ndescription: Review recent changes to the Zero Trust WARP client.\nlastUpdated: 2025-07-07T17:31:26.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/changelog/warp/\n  md: https://developers.cloudflare.com/cloudflare-one/changelog/warp/index.md\n---\n\n[Subscribe to RSS](https://developers.cloudflare.com/changelog/rss/zero-trust-warp.xml)\n\n## 2025-12-09\n\n**WARP client for Windows (version 2025.10.118.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* The [Local Domain Fallback](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/) feature has been fixed for devices running WARP client version 2025.4.929.0 and newer. Previously, these devices could experience failures with Local Domain Fallback unless a fallback server was explicitly configured. This configuration is no longer a requirement for the feature to function correctly.\n* [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) now supports transparent HTTP proxying in addition to CONNECT-based proxying.\n* Fixed an issue where sending large messages to the WARP daemon by Inter-Process Communication (IPC) could cause WARP to crash and result in service interruptions.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-12-09\n\n**WARP client for macOS (version 2025.10.118.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* The [Local Domain Fallback](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/) feature has been fixed for devices running WARP client version 2025.4.929.0 and newer. Previously, these devices could experience failures with Local Domain Fallback unless a fallback server was explicitly configured. This configuration is no longer a requirement for the feature to function correctly.\n* [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) now supports transparent HTTP proxying in addition to CONNECT-based proxying.\n\n## 2025-11-11\n\n**WARP client for Windows (version 2025.9.558.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes, improvements, and new features including [Path Maximum Transmission Unit Discovery (PMTUD)](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery). When PMTUD is enabled, the client will dynamically adjust packet sizing to optimize connection performance. There is also a new connection status message in the GUI to inform users that the local network connection may be unstable. This will make it easier to diagnose connectivity issues.\n\n**Changes and improvements**\n\n* Fixed an inconsistency with [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) settings in multi-user environments when switching between users.\n* The GUI now displays the health of the tunnel and DNS connections by showing a connection status message when the network may be unstable. This will make it easier to diagnose connectivity issues.\n* Fixed an issue where deleting a registration was erroneously reported as having failed.\n* Path Maximum Transmission Unit Discovery (PMTUD) may now be used to discover the effective MTU of the connection. This allows the WARP client to improve connectivity optimized for each network. PMTUD is disabled by default. To enable it, refer to the [PMTUD documentation](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery).\n* Improvements for the [OS version](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/os-version/) WARP client check. Windows Updated Build Revision (UBR) numbers can now be checked by the client to ensure devices have required security patches and features installed.\n* The WARP client now supports Windows 11 ARM-based machines. For information on known limitations, refer to the [Known limitations page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/known-limitations/#warp-disconnected-on-windows-arm).\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-11-11\n\n**WARP client for macOS (version 2025.9.558.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes, improvements, and new features including [Path Maximum Transmission Unit Discovery (PMTUD)](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery). When PMTUD is enabled, the client will dynamically adjust packet sizing to optimize connection performance. There is also a new connection status message in the GUI to inform users that the local network connection may be unstable. This will make it easier to diagnose connectivity issues.\n\n**Changes and improvements**\n\n* The GUI now displays the health of the tunnel and DNS connections by showing a connection status message when the network may be unstable. This will make it easier to diagnose connectivity issues.\n* Fixed an issue where deleting a registration was erroneously reported as having failed.\n* Path Maximum Transmission Unit Discovery (PMTUD) may now be used to discover the effective MTU of the connection. This allows the WARP client to improve connectivity optimized for each network. PMTUD is disabled by default. To enable it, refer to the [PMTUD documentation](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery).\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/connections/connect-devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-11-11\n\n**WARP client for Linux (version 2025.9.558.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes, improvements, and new features including [Path Maximum Transmission Unit Discovery (PMTUD)](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery). When PMTUD is enabled, the client will dynamically adjust packet sizing to optimize connection performance. There is also a new connection status message in the GUI to inform users that the local network connection may be unstable. This will make it easier to diagnose connectivity issues.\n\nWARP client version 2025.8.779.0 introduced an updated public key for Linux packages. The public key must be updated if it was installed before September 12, 2025 to ensure the repository remains functional after December 4, 2025. Instructions to make this update are available at [pkg.cloudflareclient.com](https://pkg.cloudflareclient.com/).\n\n**Changes and improvements**\n\n* The GUI now displays the health of the tunnel and DNS connections by showing a connection status message when the network may be unstable. This will make it easier to diagnose connectivity issues.\n* Fixed an issue where deleting a registration was erroneously reported as having failed.\n* Path Maximum Transmission Unit Discovery (PMTUD) may now be used to discover the effective MTU of the connection. This allows the WARP client to improve connectivity optimized for each network. PMTUD is disabled by default. To enable it, refer to the [PMTUD documentation](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/path-mtu-discovery/#enable-path-mtu-discovery).\n\n## 2025-10-16\n\n**WARP client for Windows (version 2025.9.173.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes, improvements, and new features including Path Maximum Transmission Unit Discovery (PMTUD). With PMTUD enabled, the client will dynamically adjust packet sizing to optimize connection performance. There is also a new connection status message in the GUI to inform users that the local network connection may be unstable. This will make it easier to debug connectivity issues.\n\n**Changes and improvements**\n\n* Improvements for [Windows multi-user](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/windows-multiuser/) to maintain the [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) state when switching between users.\n* The GUI now displays the health of the tunnel and DNS connections by showing a connection status message when the network may be unstable. This will make it easier to debug connectivity issues.\n* Deleting registrations no longer returns an error when succeeding.\n* Path Maximum Transmission Unit Discovery (PMTUD) is now used to discover the effective MTU of the connection. This allows the client to improve connection performance optimized for the current network.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-10-16\n\n**WARP client for macOS (version 2025.9.173.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes, improvements, and new features including Path Maximum Transmission Unit Discovery (PMTUD). With PMTUD enabled, the client will dynamically adjust packet sizing to optimize connection performance. There is also a new connection status message in the GUI to inform users that the local network connection may be unstable. This will make it easier to debug connectivity issues.\n\n**Changes and improvements**\n\n* The GUI now displays the health of the tunnel and DNS connections by showing a connection status message when the network may be unstable. This will make it easier to debug connectivity issues.\n* Deleting registrations no longer returns an error when succeeding.\n* Path Maximum Transmission Unit Discovery (PMTUD) is now used to discover the effective MTU of the connection. This allows the client to improve connection performance optimized for the current network.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-10-07\n\n**WARP client for Linux (version 2025.8.779.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains significant fixes and improvements including an updated public key for Linux packages. The public key must be updated if it was installed before September 12, 2025 to ensure the repository remains functional after December 4, 2025. Instructions to make this update are available at [pkg.cloudflareclient.com](https://pkg.cloudflareclient.com/).\n\n**Changes and improvements**\n\n* [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) has been enhanced for even faster resolution. Proxy mode now supports SOCKS4, SOCK5, and HTTP CONNECT over an L4 tunnel with custom congestion control optimizations instead of the previous L3 tunnel to Cloudflare's network. This has more than doubled Proxy mode throughput in lab speed testing, by an order of magnitude in some cases.\n\n* The MASQUE protocol is now the only protocol that can use [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode). If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new WARP mode or switch to the MASQUE protocol. Otherwise, all devices matching the profile will lose connectivity.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-10-07\n\n**WARP client for Windows (version 2025.8.779.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains significant fixes and improvements.\n\n**Changes and improvements**\n\n* [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) has been enhanced for even faster resolution. Proxy mode now supports SOCKS4, SOCK5, and HTTP CONNECT over an L4 tunnel with custom congestion control optimizations instead of the previous L3 tunnel to Cloudflare's network. This has more than doubled Proxy mode throughput in lab speed testing, by an order of magnitude in some cases.\n\n* The MASQUE protocol is now the only protocol that can use [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode). If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new WARP mode or switch to the MASQUE protocol. Otherwise, all devices matching the profile will lose connectivity.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-10-07\n\n**WARP client for macOS (version 2025.8.779.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains significant fixes and improvements.\n\n**Changes and improvements**\n\n* [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) has been enhanced for even faster resolution. Proxy mode now supports SOCKS4, SOCK5, and HTTP CONNECT over an L4 tunnel with custom congestion control optimizations instead of the previous L3 tunnel to Cloudflare's network. This has more than doubled Proxy mode throughput in lab speed testing, by an order of magnitude in some cases.\n\n* The MASQUE protocol is now the only protocol that can use [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode). If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new WARP mode or switch to the MASQUE protocol. Otherwise, all devices matching the profile will lose connectivity.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-09-30\n\n**WARP client for Windows (version 2025.7.176.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* MASQUE is now the default [tunnel protocol](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#device-tunnel-protocol) for all new WARP device profiles.\n* Improvement to limit idle connections in [Gateway with DoH mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#gateway-with-doh) to avoid unnecessary resource usage that can lead to DoH requests not resolving.\n* Improvement to maintain TCP connections to reduce interruptions in long-lived connections such as RDP or SSH.\n* Improvements to maintain [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) settings when [switching between organizations](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/switch-organizations/#switch-organizations-in-warp).\n* Improvements to maintain client connectivity during network changes.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-09-30\n\n**WARP client for macOS (version 2025.7.176.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Fixed a bug preventing the `warp-diag captive-portal` command from running successfully due to the client not parsing SSID on macOS.\n* Improvements to maintain [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) settings when [switching between organizations](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/switch-organizations/#switch-organizations-in-warp).\n* MASQUE is now the default [tunnel protocol](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#device-tunnel-protocol) for all new WARP device profiles.\n* Improvement to limit idle connections in [Gateway with DoH mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#gateway-with-doh) to avoid unnecessary resource usage that can lead to DoH requests not resolving.\n* Improvements to maintain client connectivity during network changes.\n* The WARP client now supports macOS Tahoe (version 26.0).\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-09-30\n\n**WARP client for Linux (version 2025.7.176.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements including an updated public key for Linux packages. The public key must be updated if it was installed before September 12, 2025 to ensure the repository remains functional after December 4, 2025. Instructions to make this update are available at [pkg.cloudflareclient.com](https://pkg.cloudflareclient.com/).\n\n**Changes and improvements**\n\n* MASQUE is now the default [tunnel protocol](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#device-tunnel-protocol) for all new WARP device profiles.\n* Improvement to limit idle connections in [Gateway with DoH mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#gateway-with-doh) to avoid unnecessary resource usage that can lead to DoH requests not resolving.\n* Improvements to maintain [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) settings when [switching between organizations](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/switch-organizations/#switch-organizations-in-warp).\n* Improvements to maintain client connectivity during network changes.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-09-10\n\n**WARP client for Windows (version 2025.7.106.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements including enhancements to [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) for even faster resolution. The MASQUE protocol is now the only protocol that can use Proxy mode. If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) or all devices matching the profile will lose connectivity.\n\n**Changes and improvements**\n\n* Enhancements to [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) for even faster resolution. The MASQUE protocol is now the only protocol that can use Proxy mode. If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) or all devices matching the profile will lose connectivity.\n* Improvement to keep TCP connections up the first time WARP connects on devices so that remote desktop sessions (such as RDP or SSH) continue to work.\n* Improvements to maintain Global WARP Override settings when switching between organization configurations.\n* The [MASQUE protocol](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#device-tunnel-protocol) is now the default protocol for all new WARP device profiles.\n* Improvement to limit idle connections in DoH mode to avoid unnecessary resource usage that can lead to DoH requests not resolving.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about Win32/ClickFix.ABA being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-09-10\n\n**WARP client for macOS (version 2025.7.106.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements including enhancements to [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) for even faster resolution. The MASQUE protocol is now the only protocol that can use Proxy mode. If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) or all devices matching the profile will lose connectivity.\n\n**Changes and improvements**\n\n* Enhancements to [Proxy mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/#proxy-mode) for even faster resolution. The MASQUE protocol is now the only protocol that can use Proxy mode. If you previously configured a device profile to use Proxy mode with Wireguard, you will need to select a new [WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) or all devices matching the profile will lose connectivity.\n* Fixed a bug preventing the `warp-diag captive-portal` command from running successfully due to the client not parsing SSID on macOS.\n* Improvements to maintain Global WARP Override settings when switching between organization configurations.\n* The [MASQUE protocol](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#device-tunnel-protocol) is now the default protocol for all new WARP device profiles.\n* Improvement to limit idle connections in DoH mode to avoid unnecessary resource usage that can lead to DoH requests not resolving.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-08-29\n\n**Cloudflare One WARP Diagnostic AI Analyzer**\n\nWe're excited to share a new AI feature, the [WARP diagnostic analyzer](https://blog.cloudflare.com/AI-troubleshoot-warp-and-network-connectivity-issues/), to help you troubleshoot and resolve WARP connectivity issues faster. This beta feature is now available in the [Zero Trust dashboard](https://one.dash.cloudflare.com/) to all users. The AI analyzer makes it easier for you to identify the root cause of client connectivity issues by parsing [remote captures](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/#start-a-remote-capture) of [WARP diagnostic logs](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/#warp-diag-logs). The WARP diagnostic analyzer provides a summary of impact that may be experienced on the device, lists notable events that may contribute to performance issues, and recommended troubleshooting steps and articles to help you resolve these issues. Refer to [WARP diagnostics analyzer (beta)](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/#warp-diagnostics-analyzer-beta) to learn more about how to maximize using the WARP diagnostic analyzer to troubleshoot the WARP client.\n\n## 2025-08-21\n\n**WARP client for Windows (version 2025.6.1400.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for pre-login for multi-user for the 2025.6.1135.0 release.\n\n**Changes and improvements**\n\n* Fixes an issue where new pre-login registrations were not being properly created.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 KB5062553](https://support.microsoft.com/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about Win32/ClickFix.ABA being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, please reconnect the WARP client by toggling off and back on.\n\n## 2025-08-19\n\n**WARP client for Windows (version 2025.6.1335.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Improvements to better manage multi-user pre-login registrations.\n* Fixed an issue preventing devices from reaching split-tunneled traffic even when WARP was disconnected.\n* Fix to prevent WARP from re-enabling its firewall rules after a user-initiated disconnect.\n* Improvement for faster client connectivity on high-latency captive portal networks.\n* Fixed an issue where recursive CNAME records could cause intermittent WARP connectivity issues.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 version KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with KB5055523 installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-08-19\n\n**WARP client for macOS (version 2025.6.1335.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Fixed an issue preventing devices from reaching split-tunneled traffic even when WARP was disconnected.\n* Fix to prevent WARP from re-enabling its firewall rules after a user-initiated disconnect.\n* Improvement for faster client connectivity on high-latency captive portal networks.\n* Fixed an issue where recursive CNAME records could cause intermittent WARP connectivity issues.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-08-19\n\n**WARP client for Linux (version 2025.6.1335.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Fixed an issue preventing devices from reaching split-tunneled traffic even when WARP was disconnected.\n* Fix to prevent WARP from re-enabling its firewall rules after a user-initiated disconnect.\n* Improvement for faster client connectivity on high-latency captive portal networks.\n* Fixed an issue where recursive CNAME records could cause intermittent WARP connectivity issues.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-07-24\n\n**WARP client for Windows (version 2025.6.824.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Improvements to better manage multi-user pre-login registrations.\n* Fixed an issue preventing devices from reaching split-tunneled traffic even when WARP was disconnected.\n* Fix to prevent WARP from re-enabling its firewall rules after a user-initiated disconnect.\n* Improvement to managed network detection checks for faster switching between managed networks.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 version KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-07-24\n\n**WARP client for macOS (version 2025.6.824.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* Fixed an issue preventing devices from reaching split-tunneled traffic even when WARP was disconnected.\n* Fix to prevent WARP from re-enabling its firewall rules after a user-initiated disconnect.\n* Improvement to managed network detection checks for faster switching between managed networks.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-07-23\n\n**WARP client for Windows (version 2025.5.943.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* WARP proxy mode now uses the operating system's DNS settings. Changes made to system DNS settings while in proxy mode require the client to be turned off then back on to take effect.\n* Changes to the [SCCM VPN boundary support](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#sccm-vpn-boundary-support) feature to no longer restart the SMS Agent Host (`ccmexec.exe`) service.\n* Fixed an issue affecting clients in Split Tunnel Include mode, where access to split-tunneled traffic was blocked after reconnecting the client.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 version KB5062553](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-07-23\n\n**WARP client for macOS (version 2025.5.943.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* WARP proxy mode now uses the operating system's DNS settings. Changes made to system DNS settings while in proxy mode require the client to be turned off then back on to take effect.\n* Fixed an issue affecting clients in Split Tunnel Include mode, where access to split-tunneled traffic was blocked after reconnecting the client.\n* For macOS deployments, the WARP client can now be managed using an `mdm.xml` file placed in `/Library/Application Support/Cloudflare/mdm.xml`. This new configuration option offers an alternative to the still supported method of deploying a managed plist through an MDM solution.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-07-23\n\n**WARP client for Linux (version 2025.5.943.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\n**Changes and improvements**\n\n* WARP proxy mode now uses the operating system's DNS settings. Changes made to system DNS settings while in proxy mode require the client to be turned off then back on to take effect.\n* Fixed an issue affecting clients in Split Tunnel Include mode, where access to split-tunneled traffic was blocked after reconnecting the client.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-06-30\n\n**WARP client for Windows (version 2025.5.893.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains improvements and new exciting features, including [SCCM VPN boundary support](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#sccm-vpn-boundary-support) and [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate protection of post-quantum cryptography without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* Fixed a device registration issue that caused WARP connection failures when changing networks.\n\n* Captive portal improvements and fixes:\n\n  * Captive portal sign in notifications will now be sent through operating system notification services.\n  * Fix for firewall configuration issue affecting clients in DoH only mode.\n\n* Improved the connectivity status message in the client GUI.\n\n* Fixed a bug affecting clients in Gateway with DoH mode where the original DNS servers were not restored after disabling WARP.\n\n* The WARP client now applies post-quantum cryptography end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be [enabled by MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n\n* Improvement to handle client configuration changes made by an MDM while WARP is not running.\n\n* Improvements for multi-user experience to better handle fast user switching and transitions from a pre-login to a logged-in state.\n\n* Added a WARP client device posture check for SAN attributes to the [client certificate check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/).\n\n* Fixed an issue affecting Split Tunnel Include mode, where traffic outside the tunnel was blocked when switching between Wi-Fi and Ethernet networks.\n\n* Added [SCCM VPN boundary support](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#sccm-vpn-boundary-support) to device profile settings. With SCCM VPN boundary support enabled, operating systems will register WARP's local interface IP with the on-premise DNS server when reachable.\n\n* Fix for an issue causing WARP connectivity to fail without full system reboot.\n\n**Known issues**\n\n* For Windows 11 24H2 users, Microsoft has confirmed a regression that may lead to performance issues like mouse lag, audio cracking, or other slowdowns. Cloudflare recommends users experiencing these issues upgrade to a minimum [Windows 11 24H2 version KB5060829](https://support.microsoft.com/en-us/topic/july-8-2025-kb5062553-os-build-26100-4652-523e69cb-051b-43c6-8376-6a76d6caeefd) or higher for resolution.\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-06-30\n\n**WARP client for macOS (version 2025.5.893.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains improvements and new exciting features, including [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate protection of post-quantum cryptography without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* Fixed an issue where WARP sometimes failed to automatically relaunch after updating.\n\n* Fixed a device registration issue causing WARP connection failures when changing networks.\n\n* Captive portal improvements and fixes:\n\n  * Captive portal sign in notifications will now be sent through operating system notification services.\n  * Fix for firewall configuration issue affecting clients in DoH only mode.\n\n* Improved the connectivity status message in the client GUI.\n\n* The WARP client now applies post-quantum cryptography end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be [enabled by MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n\n* Improvement to handle client configuration changes made by an MDM while WARP is not running.\n\n* Fixed an issue affecting Split Tunnel Include mode, where traffic outside the tunnel was blocked when switching between Wi-Fi and Ethernet networks.\n\n* Improvement for WARP connectivity issues on macOS due to the operating system not accepting DNS server configurations.\n\n* Added a WARP client device posture check for SAN attributes to the [client certificate check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/).\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-06-30\n\n**WARP client for Linux (version 2025.5.893.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains improvements and new exciting features, including [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate protection of post-quantum cryptography without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* Fixed a device registration issue causing WARP connection failures when changing networks.\n\n* Captive portal improvements and fixes:\n\n  * Captive portal sign in notifications will now be sent through operating system notification services.\n  * Fix for firewall configuration issue affecting clients in DoH only mode.\n\n* Improved the connectivity status message in the client GUI.\n\n* The WARP client now applies post-quantum cryptography end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be [enabled by MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n\n* Improvement to handle client configuration changes made by MDM while WARP is not running.\n\n* Fixed an issue affecting Split Tunnel Include mode, where traffic outside the tunnel was blocked when switching between Wi-Fi and Ethernet networks.\n\n* Added a WARP client device posture check for SAN attributes to the [client certificate check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/).\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-06-30\n\n**Cloudflare One Agent for Android (version 2.4.2)**\n\nA new GA release for the Android Cloudflare One Agent is now available in the [Google Play Store](https://play.google.com/store/apps/details?id=com.cloudflare.cloudflareoneagent). This release contains improvements and new exciting features, including [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate [protection of post-quantum cryptography](https://blog.cloudflare.com/pq-2024/) without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* QLogs are now disabled by default and can be enabled in the app by turning on **Enable qlogs** under **Settings** > **Advanced** > **Diagnostics** > **Debug Logs**. The QLog setting from previous releases will no longer be respected.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* The WARP client now applies [post-quantum cryptography](https://blog.cloudflare.com/pq-2024/) end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be enabled by [MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n* Fixed an issue that caused WARP connection failures on ChromeOS devices.\n\n## 2025-06-30\n\n**Cloudflare One Agent for iOS (version 1.11)**\n\nA new GA release for the iOS Cloudflare One Agent is now available in the [iOS App Store](https://apps.apple.com/us/app/cloudflare-one-agent/id6443476492). This release contains improvements and new exciting features, including [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate [protection of post-quantum cryptography](https://blog.cloudflare.com/pq-2024/) without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* QLogs are now disabled by default and can be enabled in the app by turning on **Enable qlogs** under **Settings** > **Advanced** > **Diagnostics** > **Debug Logs**. The QLog setting from previous releases will no longer be respected.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* The WARP client now applies [post-quantum cryptography](https://blog.cloudflare.com/pq-2024/) end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be enabled by [MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n\n## 2025-06-17\n\n**WARP client for Windows (version 2025.5.828.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains new improvements in addition to the features and improvements introduced in Beta client version 2025.5.735.1.\n\n**Changes and improvements**\n\n* Improvement to better handle multi-user fast user switching.\n* Fix for an issue causing WARP connectivity to fail without full system reboot.\n\n**Known issues**\n\n* Microsoft has confirmed a regression with Windows 11 starting around 24H2 that may cause performance issues for some users. These performance issues could manifest as mouse lag, audio cracking, or other slowdowns. A fix from Microsoft is expected in early July.\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected. To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-06-17\n\n**WARP client for macOS (version 2025.5.828.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains new improvements in addition to the features and improvements introduced in Beta client version 2025.5.735.1.\n\n**Changes and improvements**\n\n* Improvement for WARP connectivity issues on macOS due to the operating system not accepting DNS server configurations.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-06-05\n\n**WARP client for Windows (version 2025.5.735.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains improvements and new exciting features, including [SCCM VPN boundary support](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#sccm-vpn-boundary-support) and [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate protection of post-quantum cryptography without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* Fixed a device registration issue causing WARP connection failures when changing networks.\n* Captive portal improvements including showing connectivity status in the client and sending system notifications for captive portal sign in.\n* Fixed a bug where in Gateway with DoH mode, connection to DNS servers was not automatically restored after reconnecting WARP.\n* The WARP client now applies post-quantum cryptography end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be [enabled by MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n* Improvement to gracefully handle changes made by MDM while WARP is not running.\n* Improvement for multi-user mode to avoid unnecessary key rotations when transitioning from a pre-login to a logged-in state.\n* Added a WARP client device posture check for SAN attributes to the [client certificate check](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/client-certificate/).\n* Fixed an issue affecting Split Tunnel Include mode, where traffic outside the tunnel was blocked when switching between Wi-Fi and Ethernet networks.\n* Added [SCCM VPN boundary support](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#sccm-vpn-boundary-support) to device profile settings. With SCCM VPN boundary support enabled, operating systems will register WARP's local interface IP with the on-premise DNS server when reachable.\n\n**Known issues**\n\n* Microsoft has confirmed a regression with Windows 11 starting around 24H2 that may cause performance issues for some users. These performance issues could manifest as mouse lag, audio cracking, or other slowdowns. A fix from Microsoft is expected in early July.\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected. To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-06-05\n\n**WARP client for macOS (version 2025.5.735.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains improvements and new exciting features, including [post-quantum cryptography](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum). By tunneling your corporate network traffic over Cloudflare, you can now gain the immediate protection of post-quantum cryptography without needing to upgrade any of your individual corporate applications or systems.\n\n**Changes and improvements**\n\n* Fixed an issue where the Cloudflare WARP application may not have automatically relaunched after an update.\n* Fixed a device registration issue causing WARP connection failures when changing networks.\n* Captive portal improvements including showing connectivity status in the client and sending system notifications for captive portal sign in.\n* The WARP client now applies post-quantum cryptography end-to-end on enabled devices accessing resources behind a Cloudflare Tunnel. This feature can be [enabled by MDM](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/parameters/#enable_post_quantum).\n* Improvement to gracefully handle changes made by MDM while WARP is not running.\n* Fixed an issue affecting Split Tunnel Include mode, where traffic outside the tunnel was blocked when switching between Wi-Fi and Ethernet networks.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-05-22\n\n**WARP client for Windows (version 2025.4.943.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for [managed networks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/managed-networks/) for the 2025.4.929.0 release.\n\n**Changes and improvements**\n\n* Fixed an issue where it could take up to 3 minutes for the correct device profile to be applied in some circumstances. In the worst case, it should now only take up to 40 seconds. This will be improved further in a future release.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n* Microsoft has confirmed a regression with Windows 11 starting around 24H2 that may cause performance issues for some users. These performance issues could manifest as mouse lag, audio cracking, or other slowdowns. A fix from Microsoft is expected in early July.\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n## 2025-05-22\n\n**WARP client for macOS (version 2025.4.943.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for [managed networks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/managed-networks/) for the 2025.4.929.0 release.\n\n**Changes and improvements**\n\n* Fixed an issue where it could take up to 3 minutes for the correct device profile to be applied in some circumstances. In the worst case, it should now only take up to 40 seconds. This will be improved further in a future release.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-05-22\n\n**WARP client for Linux (version 2025.4.943.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for [managed networks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/managed-networks/) for the 2025.4.929.0 release.\n\n**Changes and improvements**\n\n* Fixed an issue where it could take up to 3 minutes for the correct device profile to be applied in some circumstances. In the worst case, it should now only take up to 40 seconds. This will be improved further in a future release.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-05-14\n\n**WARP client for Windows (version 2025.4.929.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains two significant changes all customers should be aware of:\n\n1. All DNS traffic now flows inside the WARP tunnel. Customers are no longer required to configure their local firewall rules to allow our [DoH IP addresses and domains](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#doh-ip).\n2. When using MASQUE, the connection will fall back to HTTP/2 (TCP) when we detect that HTTP/3 traffic is blocked. This allows for a much more reliable connection on some public WiFi networks.\n\n**Changes and improvements**\n\n* Fixed an issue causing reconnection loops when captive portals are detected.\n* Fixed an issue that caused WARP client disk encryption posture checks to fail due to missing drive names.\n* Fixed an issue where managed network policies could incorrectly report network location beacons as missing.\n* Improved DEX test error reporting.\n* Fixed an issue where some parts of the WARP Client UI were missing in high contrast mode.\n* Fixed an issue causing client notifications to fail in IPv6 only environments which prevented the client from receiving configuration changes to settings like device profile.\n* Added a TCP fallback for the MASQUE tunnel protocol to improve connectivity on networks that block UDP or HTTP/3 specifically.\n* Added new IP addresses for [tunnel connectivity checks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#connectivity-checks). If your organization uses a firewall or other policies you will need to exempt these IPs.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* Improved the error message displayed in the client GUI when the rate limit for entering an incorrect admin override code is met.\n* Improved handling of non-SLAAC IPv6 interface addresses for better connectivity in IPv6 only environments.\n* Fixed an issue where frequent network changes could cause WARP to become unresponsive.\n* Improvement for WARP to check if tunnel connectivity fails or times out at device wake before attempting to reconnect.\n* Fixed an issue causing WARP connection disruptions after network changes.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n* Microsoft has confirmed a regression with Windows 11 starting around 24H2 that may cause performance issues for some users. These performance issues could manifest as mouse lag, audio cracking, or other slowdowns. A fix from Microsoft is expected in early July.\n\n* Devices with `KB5055523` installed may receive a warning about `Win32/ClickFix.ABA` being present in the installer. To resolve this false positive, update Microsoft Security Intelligence to [version 1.429.19.0](https://www.microsoft.com/en-us/wdsi/definitions/antimalware-definition-release-notes?requestVersion=1.429.19.0) or later.\n\n## 2025-05-12\n\n**WARP client for Linux (version 2025.4.929.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains two significant changes all customers should be aware of:\n\n1. All DNS traffic now flows inside the WARP tunnel. Customers are no longer required to configure their local firewall rules to allow our [DoH IP addresses and domains](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#doh-ip).\n2. When using MASQUE, the connection will fall back to HTTP/2 (TCP) when we detect that HTTP/3 traffic is blocked. This allows for a much more reliable connection on some public WiFi networks.\n\n**Changes and improvements**\n\n* Fixed an issue where the managed network policies could incorrectly report network location beacons as missing.\n* Improved DEX test error reporting.\n* Fixed an issue causing client notifications to fail in IPv6 only environments which prevented the client from receiving configuration changes to settings like device profile.\n* Added a TCP fallback for the MASQUE tunnel protocol to improve connectivity on networks that block UDP or HTTP/3 specifically.\n* Added new IP addresses for [tunnel connectivity checks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#connectivity-checks). If your organization uses a firewall or other policies you will need to exempt these IPs.\n* Fixed an issue where frequent network changes could cause WARP to become unresponsive.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* Improvement for WARP to check if tunnel connectivity fails or times out at device wake before attempting to reconnect.\n* Fixed an issue causing WARP connection disruptions after network changes.\n\n**Known issues**\n\n* Devices using WARP client 2025.4.929.0 and up may experience Local Domain Fallback failures if a fallback server has not been configured. To configure a fallback server, refer to [Route traffic to fallback server](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#route-traffic-to-fallback-server).\n\n## 2025-05-12\n\n**WARP client for macOS (version 2025.4.929.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains two significant changes all customers should be aware of:\n\n1. All DNS traffic now flows inside the WARP tunnel. Customers are no longer required to configure their local firewall rules to allow our [DoH IP addresses and domains](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#doh-ip).\n2. When using MASQUE, the connection will fall back to HTTP/2 (TCP) when we detect that HTTP/3 traffic is blocked. This allows for a much more reliable connection on some public WiFi networks.\n\n**Changes and improvements**\n\n* Fixed an issue where the managed network policies could incorrectly report network location beacons as missing.\n* Improved DEX test error reporting.\n* Fixed an issue causing client notifications to fail in IPv6 only environments which prevented the client from receiving configuration changes to settings like device profile.\n* Improved captive portal detection.\n* Added a TCP fallback for the MASQUE tunnel protocol to improve connectivity on networks that block UDP or HTTP/3 specifically.\n* Added new IP addresses for [tunnel connectivity checks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#connectivity-checks). If your organization uses a firewall or other policies you will need to exempt these IPs.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* Improved the error message displayed in the client GUI when the rate limit for entering an incorrect admin override code is met.\n* Improved handling of non-SLAAC IPv6 interface addresses for better connectivity in IPv6 only environments.\n* Fixed an issue where frequent network changes could cause WARP to become unresponsive.\n* Improvement for WARP to check if tunnel connectivity fails or times out at device wake before attempting to reconnect.\n* Fixed an issue causing WARP connection disruptions after network changes.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-04-22\n\n**WARP client for Windows (version 2025.4.589.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\n**Changes and improvements**\n\n* Fixed an issue causing reconnection loops when captive portals are detected.\n* Fixed an issue that caused WARP client disk encryption posture checks to fail due to missing drive names.\n* Fixed an issue where managed network policies could incorrectly report network location beacons as missing.\n* Improved error reporting for DEX tests.\n* Improved WARP client UI high contrast mode.\n* Fixed an issue causing client notifications to fail in IPv6 only environments which prevented the client from receiving configuration changes to settings like device profile.\n* Added a TCP fallback for the MASQUE tunnel protocol to improve compatibility with networks on MASQUE.\n* Added new IP addresses for [tunnel connectivity checks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#connectivity-checks). If your organization uses a firewall or other policies you will need to exempt these IPs.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* Improved the error message displayed in the client GUI when the rate limit for entering an incorrect admin override code is met.\n* Added a [Collect Captive Portal Diag](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/#get-captive-portal-logs) button in the client GUI to make it easier for users to collect captive portal debugging diagnostics.\n* Improved handling of non-SLAAC IPv6 interface addresses for better connectivity in IPv6 only environments.\n* Fixed an issue where frequent network changes could cause WARP to become unresponsive.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-04-22\n\n**WARP client for macOS (version 2025.4.589.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\n**Changes and improvements**\n\n* Fixed an issue where managed network policies could incorrectly report network location beacons as missing.\n* Improved DEX test error reporting.\n* Fixed an issue causing client notifications to fail in IPv6 only environments which prevented the client from receiving configuration changes to settings like device profile.\n* Improved captive portal detection.\n* Added a TCP fallback for the MASQUE tunnel protocol to improve compatibility with networks on MASQUE.\n* Added new IP addresses for [tunnel connectivity checks](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/firewall/#connectivity-checks). If your organization uses a firewall or other policies you will need to exempt these IPs.\n* DNS over HTTPS traffic is now included in the WARP tunnel by default.\n* Improved the error message displayed in the client GUI when the rate limit for entering an incorrect admin override code is met.\n* Added a [Collect Captive Portal Diag](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/#get-captive-portal-logs) button in the client GUI to make it easier for users to collect captive portal debugging diagnostics.\n* Improved handling of non-SLAAC IPv6 interface addresses for better connectivity in IPv6 only environments.\n* Fixed an issue where frequent network changes could cause WARP to become unresponsive.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-04-08\n\n**WARP client for Windows (version 2025.2.664.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for captive portal detection for the 2025.2.600.0 release.\n\n**Changes and improvements**\n\n* Fix to reduce the number of browser tabs opened during captive portal logins.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-04-08\n\n**WARP client for macOS (version 2025.2.664.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains a hotfix for captive portal detection and PF state tables for the 2025.2.600.0 release.\n\n**Changes and improvements**\n\n* Fix to reduce the number of browser tabs opened during captive portal logins.\n* Improvement to exclude local DNS traffic entries from PF state table to reduce risk of connectivity issues from exceeding table capacity.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.4 or later.\n\n## 2025-03-31\n\n**WARP client for macOS (version 2025.2.600.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains support for a new WARP setting, [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices). It also includes significant improvements to our captive portal / public Wi-Fi detection logic. If you have experienced captive portal issues in the past, re-test and give this version a try.\n\n**Changes and improvements**\n\n* Improved [captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/) to make more public networks compatible and have faster detection.\n* Improved error messages shown in the app.\n* WARP tunnel protocol details can now be viewed using the `warp-cli tunnel stats` command.\n* Fixed an issue with device revocation and re-registration when switching configurations.\n* Added a new [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) setting. This setting puts account administrators in control of disabling and enabling WARP across all devices registered to an account from the dashboard. Global WARP override is disabled by default.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.3 or later.\n\n## 2025-03-31\n\n**WARP client for Windows (version 2025.2.600.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains support for a new WARP setting, [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices). It also includes significant improvements to our captive portal / public Wi-Fi detection logic. If you have experienced captive portal issues in the past, re-test and give this version a try.\n\n**Changes and improvements**\n\n* Improved [captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/) to make more public networks compatible and have faster detection.\n* Improved error messages shown in the app.\n* Added the ability to control if the WARP interface IPs are [registered with DNS servers](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#warp-interface-ip-dns-registration) or not.\n* Removed DNS logs view from the Windows client GUI. DNS logs can be viewed as part of `warp-diag` or by viewing the log file on the user's local directory.\n* Fixed an issue that would result in a user receiving multiple re-authentication requests when waking their device from sleep.\n* WARP tunnel protocol details can now be viewed using the `warp-cli tunnel stats` command.\n* Improvements to [Windows multi-user](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/windows-multiuser/) including support for fast user switching. If you are interested in testing this feature, reach out to your Cloudflare account team.\n* Fixed an issue with device revocation and re-registration when switching configurations.\n* Fixed an issue where DEX tests would run during certain sleep states where the networking stack was not fully up. This would result in failures that would be ignored.\n* Added a new [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) setting. This setting puts account administrators in control of disabling and enabling WARP across all devices registered to an account from the dashboard. Global WARP override is disabled by default.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-03-31\n\n**WARP client for Linux (version 2025.2.600.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains support for a new WARP setting, [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices). It also includes significant improvements to our captive portal / public Wi-Fi detection logic. If you have experienced captive portal issues in the past, re-test and give this version a try.\n\n**Changes and improvements**\n\n* Improved [captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/) to make more public networks compatible and have faster detection.\n* WARP tunnel protocol details can now be viewed using the `warp-cli tunnel stats` command.\n* Fixed an issue with device revocation and re-registration when switching configurations.\n* Added a new [Global WARP override](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#disconnect-warp-on-all-devices) setting. This setting puts account administrators in control of disabling and enabling WARP across all devices registered to an account from the dashboard. Global WARP override is disabled by default.\n\n## 2025-03-17\n\n**Cloudflare One Agent for Android (version 2.4)**\n\nA new GA release for the Android Cloudflare One Agent is now available in the [Google Play Store](https://play.google.com/store/apps/details?id=com.cloudflare.cloudflareoneagent). This release includes a new feature allowing [team name insertion by URL](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/#enroll-using-a-url) during enrollment, as well as fixes and minor improvements.\n\n**Changes and improvements**\n\n* Improved in-app error messages.\n* Improved mobile client login with support for [team name insertion by URL](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/#enroll-using-a-url).\n* Fixed an issue preventing admin split tunnel settings taking priority for traffic from certain applications.\n\n## 2025-03-17\n\n**Cloudflare One Agent for iOS (version 1.10)**\n\nA new GA release for the iOS Cloudflare One Agent is now available in the [iOS App Store](https://apps.apple.com/us/app/cloudflare-one-agent/id6443476492). This release includes a new feature allowing [team name insertion by URL](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/#enroll-using-a-url) during enrollment, as well as fixes and minor improvements.\n\n**Changes and improvements**\n\n* Improved in-app error messages.\n* Improved mobile client login with support for [team name insertion by URL](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/manual-deployment/#enroll-using-a-url).\n* Bug fixes and performance improvements.\n\n## 2025-03-13\n\n**WARP client for macOS (version 2025.2.460.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains significant improvements to our captive portal / public Wi-Fi detection logic. If you have experienced captive portal issues in the past, re-test and give this version a try.\n\n**Changes and improvements**\n\n* Improved [captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/) to make more public networks compatible and have faster detection.\n* Improved error messages shown in the app.\n* WARP tunnel protocol details can now be viewed using the `warp-cli tunnel stats` command.\n* Fixed issue with device revocation and re-registration when switching configurations.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.3 or later.\n\n## 2025-03-13\n\n**WARP client for Windows (version 2025.2.460.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains significant improvements to our captive portal / public Wi-Fi detection logic. If you have experienced captive portal issues in the past, re-test and give this version a try.\n\n**Changes and improvements**\n\n* Improved [captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/) to make more public networks compatible and have faster detection.\n* Improved error messages shown in the app.\n* Added the ability to control if the WARP interface IPs are [registered with DNS servers](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#warp-interface-ip-dns-registration) or not.\n* Removed DNS logs view from the Windows client GUI. DNS logs can be viewed as part of `warp-diag` or by viewing the log file on the user's local directory.\n* Fixed issue that would result in a user receiving multiple re-authentication requests when waking their device from sleep.\n* WARP tunnel protocol details can now be viewed using the `warp-cli tunnel stats` command.\n* Improvements to [Windows multi-user](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/windows-multiuser/) including support for fast user switching. If you are interested in testing this feature, reach out to your Cloudflare account team.\n* Fixed issue with device revocation and re-registration when switching configurations.\n* Fixed issue where DEX tests would run during certain sleep states where the networking stack was not fully up. This would result in failures that would be ignored.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-02-19\n\n**WARP client for Windows (version 2025.1.861.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains only improvements.\n\n**Changes and improvements**\n\n* Improved command line interface for Access for Infrastructure with added function for filtering and ordering.\n* Fixed client connectivity issues when switching between managed network profiles that use different WARP protocols.\n* Added support for WARP desktop to use additional DoH endpoints to help reduce NAT congestion.\n* Improved connectivity check reliability in certain split tunnel configurations.\n* Improved reading of device DNS settings at connection restart.\n* Improved WARP connectivity in environments with virtual machine interfaces.\n* Improved Wireguard connection stability on reconnections.\n* Improved reliability of device posture checks for OS Version, Unique Client ID, Domain Joined, Disk Encryption, and Firewall attributes.\n* Added additional HTTP/3 QUIC connectivity test to warp-diag.\n* Added support for collection of system health metrics for enhanced device Digital Experience Monitoring.\n* Automated the removal of active registrations for devices with multiple registrations with the same Zero Trust organization.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-02-19\n\n**WARP client for macOS (version 2025.1.861.0)**\n\nA new GA release for the macOS WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains minor fixes and improvements.\n\nNote: If using macOS Sequoia, Cloudflare recommends the use of macOS 15.3 or later. With macOS 15.3, Apple addressed several issues that may have caused the WARP client to not behave as expected when used with macOS 15.0.x.\n\n**Changes and improvements**\n\n* Improved command line interface for Access for Infrastructure with added function for filtering and ordering.\n* Fixed client connectivity issues when switching between managed network profiles that use different WARP protocols.\n* Improved OS version posture checks on macOS for greater reliability and availability.\n* Added support for WARP desktop to use additional DoH endpoints to help reduce NAT congestion.\n* Improved Wireguard connection stability on reconnections.\n* Added additional HTTP/3 QUIC connectivity test to `warp-diag`.\n* Added support for collection of system health metrics for enhanced device Digital Experience Monitoring.\n* Automated the removal of active registrations for devices with multiple registrations with the same Zero Trust organization.\n* Fixes issues with deleted registration at start up.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.3 or later.\n\n## 2025-02-19\n\n**WARP client for Linux (version 2025.1.861.0)**\n\nA new GA release for the Linux WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release includes fixes and minor improvements.\n\n**Changes and improvements**\n\n* Improved command line interface for Access for Infrastructure with added function for filtering and ordering.\n* Fixed client connectivity issues when switching between managed network profiles that use different WARP protocols.\n* Added support for WARP desktop to use additional DoH endpoints to help reduce NAT congestion.\n* Improved Wireguard connection stability on reconnections.\n* Added additional HTTP/3 QUIC connectivity test to `warp-diag`.\n* Added support for collection of system health metrics for enhanced device Digital Experience Monitoring.\n* Automated the removal of active registrations for devices with multiple registrations with the same Zero Trust organization.\n\n## 2025-02-07\n\n**WARP client for macOS (version 2025.1.634.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains only a hotfix from the 2025.1.447.1 release. Note: If using macOS Sequoia, Cloudflare recommends the use of macOS 15.2 or later. With macOS 15.2, Apple addressed several issues that may have caused the WARP client to not behave as expected when used with macOS 15.0.x. **Changes and improvements** - Improved device registration retrieval for graceful restarts **Known issues** - macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.2 or later.\n\n## 2025-01-28\n\n**WARP client for macOS (version 2025.1.447.1)**\n\nA new Beta release for the macOS WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains only improvements.\n\nNote: If using macOS Sequoia, Cloudflare recommends the use of macOS 15.2 or later. With macOS 15.2, Apple addressed several issues that may have caused the WARP client to not behave as expected when used with macOS 15.0.x.\n\n**Changes and improvements**\n\n* Improved command line interface for Access for Infrastructure with added function for filtering and ordering.\n* Fixed client connectivity issues when switching between managed network profiles that use different WARP protocols.\n* Improved OS version posture checks on macOS for greater reliability and availability.\n* Added support for WARP desktop to use additional DoH endpoints to help reduce NAT congestion.\n* Improved Wireguard connection stability on reconnections.\n* Added additional HTTP/3 QUIC connectivity test to `warp-diag`.\n\n**Known issues**\n\n* macOS Sequoia: Due to changes Apple introduced in macOS 15.0.x, the WARP client may not behave as expected. Cloudflare recommends the use of macOS 15.2 or later.\n\n## 2025-01-28\n\n**WARP client for Windows (version 2025.1.447.1)**\n\nA new Beta release for the Windows WARP client is now available on the [beta releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/beta-releases/).\n\nThis release contains only improvements.\n\n**Changes and improvements**\n\n* Improved command line interface for Access for Infrastructure with added function for filtering and ordering.\n* Fixed client connectivity issues when switching between managed network profiles that use different WARP protocols.\n* Added support for WARP desktop to use additional DoH endpoints to help reduce NAT congestion.\n* Improved Windows multi-user feature with minor bug fixes and optimizations.\n* Improved connectivity check reliability in certain split tunnel configurations.\n* Improved reading of device DNS settings at connection restart.\n* Improved WARP connectivity in environments with virtual machine interfaces.\n* Improved Wireguard connection stability on reconnections.\n* Improved reliability of device posture checks for OS Version, Unique Client ID, Domain Joined, Disk Encryption, and Firewall attributes.\n* Added additional HTTP/3 QUIC connectivity test to `warp-diag`.\n\n**Known issues**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2025-01-09\n\n**WARP client for Windows (version 2024.12.760.0)**\n\nA new GA release for the Windows WARP client is now available on the [stable releases downloads page](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/).\n\nThis release contains only a hotfix from the 2024.12.554.0 release.\n\n**Changes and improvements:**\n\n* Fixed an issue that could prevent clients with certain split tunnel configurations from connecting.\n\n**Known issues:**\n\n* DNS resolution may be broken when the following conditions are all true:\n\n  * WARP is in Secure Web Gateway without DNS filtering (tunnel-only) mode.\n  * A custom DNS server address is configured on the primary network adapter.\n  * The custom DNS server address on the primary network adapter is changed while WARP is connected.\n\n  To work around this issue, reconnect the WARP client by toggling off and back on.\n\n## 2024-06-16\n\n**Explore product updates for Cloudflare One**\n\nWelcome to your new home for product updates on [Cloudflare One](https://developers.cloudflare.com/cloudflare-one/).\n\nOur [new changelog](https://developers.cloudflare.com/changelog/) lets you read about changes in much more depth, offering in-depth examples, images, code samples, and even gifs.\n\nIf you are looking for older product updates, refer to the following locations.\n\nOlder product updates\n\n* [Access](https://developers.cloudflare.com/cloudflare-one/changelog/access/)\n* [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/changelog/browser-isolation/)\n* [CASB](https://developers.cloudflare.com/cloudflare-one/changelog/casb/)\n* [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/changelog/tunnel/)\n* [Data Loss Prevention](https://developers.cloudflare.com/cloudflare-one/changelog/dlp/)\n* [Digital Experience Monitoring](https://developers.cloudflare.com/cloudflare-one/changelog/dex/)\n* [Email security](https://developers.cloudflare.com/cloudflare-one/changelog/email-security/)\n* [Gateway](https://developers.cloudflare.com/cloudflare-one/changelog/gateway/)\n* [Magic Cloud Networking](https://developers.cloudflare.com/magic-cloud-networking/changelog/)\n* [Magic Firewall](https://developers.cloudflare.com/magic-firewall/changelog/)\n* [Magic Network Monitoring](https://developers.cloudflare.com/magic-network-monitoring/changelog/)\n* [Magic Transit](https://developers.cloudflare.com/magic-transit/changelog/)\n* [Magic WAN](https://developers.cloudflare.com/magic-wan/changelog/)\n* [Network Interconnect](https://developers.cloudflare.com/network-interconnect/changelog/)\n* [Risk score](https://developers.cloudflare.com/cloudflare-one/changelog/risk-score/)\n* [Zero Trust WARP Client](https://developers.cloudflare.com/cloudflare-one/changelog/warp/)\n\n</page>\n\n<page>\n---\ntitle: Detection entries · Cloudflare One docs\ndescription: Cloudflare DLP can scan your web traffic and SaaS applications for\n  specific data defined in custom detection entries. Detection entries allow you\n  to define custom data patterns for DLP to detect using DLP profiles. Detection\n  entries include custom datasets with defined data, document entries with\n  example fingerprints, and AI prompt topics.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/index.md\n---\n\nCloudflare DLP can scan your web traffic and SaaS applications for specific data defined in custom detection entries. Detection entries allow you to define custom data patterns for DLP to detect using [DLP profiles](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/). Detection entries include custom [datasets](#datasets) with defined data, [document entries](#documents) with example fingerprints, and [AI prompt topics](#ai-prompt-topics).\n\nYou can configure sensitive data to be hashed before reaching Cloudflare and redacted from matches in [payload logs](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#log-the-payload-of-matched-rules).\n\n## Datasets\n\nYou can create and upload custom datasets to scan for specific matching data.\n\n### Dataset types\n\n#### Exact Data Match\n\nExact Data Match (EDM) protects sensitive information, such as names, addresses, phone numbers, and credit card numbers.\n\nAll data in uploaded EDM datasets is encrypted before reaching Cloudflare. To detect matches, Cloudflare hashes traffic and compares it to hashes from your dataset. Matched data will be redacted in payload logs.\n\n#### Custom Wordlist\n\nCustom Wordlist (CWL) protects non-sensitive data, such as intellectual property and SKU numbers. Optionally, CWL can detect case-sensitive data.\n\nCloudflare stores data from CWL datasets within DLP. Plaintext matches appear in payload logs.\n\n### Prepare DLP datasets\n\n#### Formatting\n\nTo prepare a dataset for DLP, add your desired data to a multi-column spreadsheet. Each line must be at least six characters long. Entries do not require trailing or final commas.\n\nFor compatibility, save your file in either `.csv` or `.txt` format with LF (`\\n`) newline characters. DLP does not support CRLF (`\\r\\n`) newline characters. For information on dataset limits, refer to [Account limits](https://developers.cloudflare.com/cloudflare-one/account-limits/#data-loss-prevention-dlp).\n\n#### Column title cells\n\nColumn title cells may result in false positives in Custom Wordlist datasets and should be removed.\n\nDLP will detect and use title cells as column names for Exact Data Match datasets. If multiple columns have the same name, DLP will append a number sign (`#`) and number to their names.\n\nUpdate EDM datasets\n\nTo select which Exact Data Match columns to use, you will need to [reupload any EDM datasets](#manage-existing-datasets) added prior to column support.\n\n### Upload a new dataset\n\nUpload an Exact Data Match dataset\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Detection entries**.\n2. From the **Datasets** tab, select **Add a dataset**.\n3. Select **Exact Data Match (EDM)**.\n4. Upload your dataset file. Select **Next**.\n5. Review and choose the detected columns you want to include. Select **Next**.\n6. Name your dataset. Optionally, add a description. Select **Next**.\n7. Review the details for your uploaded dataset. Select **Save dataset**.\n\nDLP will encrypt your dataset and save its hash.\n\nUpload a Custom Wordlist dataset\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Detection entries**.\n2. From the **Datasets** tab, select **Add a dataset**.\n3. Select **Custom Wordlist (CWL)**.\n4. Name your dataset. Optionally, add a description.\n5. (Optional) In **Settings**, turn on **Enforce case sensitivity** to require matched values to contain exact capitalization.\n6. In **Upload file**, choose your dataset file.\n7. Select **Save**.\n\nDLP will save your dataset in cleartext.\n\nThe dataset will appear in the list with an **Uploading** status. Once the upload is complete, the status will change to **Complete**. To use your uploaded dataset, add it as an existing entry to a [custom DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile).\n\n### Manage existing datasets\n\nUploaded DLP datasets are read-only. To update a dataset, you must upload a new file to replace the original.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Detection entries**.\n2. From the **Datasets** tab, select the dataset you want to update.\n3. Select **Upload dataset** and choose your updated dataset. Select **Next**.\n4. If your select dataset is an Exact Data Match dataset, review and choose the new columns. Select **Next**.\n5. Select **Save dataset**.\n\nYour new dataset will replace the original dataset.\n\nRemove existing column entries\n\nIf you want to update an Exact Data Match dataset to remove a column in use as an [existing detection entry](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile), you must remove the existing entry from any custom DLP profiles using it before updating the dataset.\n\n## Documents\n\nYou can upload example documents to scan for unstructured data or specific document types common to your organization. DLP will create a unique fingerprint of the document and detect patterns in your organization's traffic based on how similar it is to the original fingerprint.\n\nDLP stores uploaded documents encrypted at rest in a [Cloudflare R2](https://developers.cloudflare.com/r2/) bucket. To upload sensitive data that is only stored in memory, use [Exact Data Match](#exact-data-match).\n\n### Prepare document entries\n\nDLP supports documents in `.docx` and `.txt` format. Documents must be under 10 MB.\n\n### Upload a new document entry\n\nTo upload a new document entry to DLP:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Detection entries**.\n2. From the **Documents** tab, select **Add a document entry**.\n3. Name your document. Optionally, add a description.\n4. In **Minimum similarity for matches**, enter a value between 0% and 100%.\n5. In **Upload document**, choose and upload your document file.\n6. Select **Save**.\n\nThe document will appear in the list with a **Pending** status. Once the upload is complete, the status will change to **Complete**. If you created a document entry with Terraform, the status will be **No file** until you upload a file.\n\nTo use your uploaded document fingerprint, add it as an existing entry to a [custom DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile).\n\n### Manage existing document entries\n\nUploaded document entries are read-only. To update a document entry, you must upload a new file to replace the original.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Detection entries**.\n2. From the **Documents** tab, choose the document you want to update and select **Edit**.\n3. (Optional) Update the name and minimum similarity for matches for your document entry. You can also open the existing uploaded document.\n4. In **Update document entry**, choose and upload your updated document file.\n5. Select **Save**.\n\nYour new document entry will replace the original document entry. If your file upload fails, DLP will still use the original document fingerprint to scan traffic until you delete the entry.\n\n## AI prompt topics\n\nDLP uses [Application Granular Controls](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application-granular-controls) to detect and categorize prompts submitted to generative AI tools. Application Granular Controls analyzes prompts for both content and user intent. Supported AI prompt protection detections include:\n\n| Detection entry | Description |\n| - | - |\n| Content: PII | Prompt contains personal information such as names, SSNs, or email addresses. |\n| Content: Credentials and Secrets | Prompt contains API keys, passwords, or other sensitive credentials. |\n| Content: Source Code | Prompt contains actual source code, code snippets, or proprietary algorithms. |\n| Content: Customer Data | Prompt contains customer names, projects, business activities, or confidential customer contexts. |\n| Content: Financial Information | Prompt contains financial numbers or confidential business data. |\n| Intent: PII | Prompt requests specific personal information about individuals. |\n| Intent: Code Abuse and Malicious Code | Prompt requests malicious code for attacks, exploits, or harmful activities. |\n| Intent: Jailbreak | Prompt attempts to circumvent AI security policies. |\n\nEach detection entry is categorized as either Content or Intent. Content focuses on the specific text or data the user provides the generative AI tool. It is the information the AI needs to process and analyze to generate a response. Intent focuses on the user's goal or objective for the AI's response. It dictates the type of output the user wants to receive. This category is particularly useful for customers who are using SaaS connectors or MCPs that provide the AI application access to internal data sources that contain sensitive information.\n\nTo use an AI prompt topic, configure the corresponding [predefined DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/#ai-prompt) or add it as an existing entry to a [custom DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/#build-a-custom-profile). AI prompt protection is available for ChatGPT, Google Gemini, Perplexity, and Claude.\n\n</page>\n\n<page>\n---\ntitle: Scan HTTP traffic · Cloudflare One docs\ndescription: You can scan HTTP traffic for sensitive data through Secure Web\n  Gateway policies. To perform DLP filtering, first configure a DLP profile with\n  the data patterns you want to detect, and then build a Gateway HTTP policy to\n  allow or block the sensitive data from leaving your organization. Gateway will\n  parse and scan your HTTP traffic for strings matching the keywords or regular\n  expressions (regexes) specified in the DLP profile.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/index.md\n---\n\nYou can scan HTTP traffic for sensitive data through Secure Web Gateway policies. To perform DLP filtering, first configure a DLP profile with the data patterns you want to detect, and then build a Gateway HTTP policy to allow or block the sensitive data from leaving your organization. Gateway will parse and scan your HTTP traffic for strings matching the keywords or regular expressions (regexes) specified in the DLP profile.\n\n## Prerequisites\n\n* Set up [Gateway HTTP filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/).\n  * HTTP filtering requires turning on the [Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/#turn-on-the-gateway-proxy) for TCP traffic.\n* Turn on [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#turn-on-tls-decryption).\n\n## 1. Configure a DLP profile\n\nRefer to [Configure a DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/). We recommend getting started with a predefined profile.\n\nImportant\n\nDLP scans will not start until you [create a DLP policy](#2-create-a-dlp-policy).\n\n## 2. Create a DLP policy\n\nDLP Profiles may be used alongside other Cloudflare One rules in a [Gateway HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/). To start logging or blocking traffic, create a policy for DLP:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies**. Select **HTTP**.\n\n2. Select **Add a policy**.\n\n3. Build an [HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) using the [DLP Profile](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#dlp-profile) selector. For example, the following policy prevents users from uploading sensitive data to any location other than an approved corporate application:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | DLP Profile | in | *Social Security, Insurance, Tax, and Identifer Numbers* | And | Block |\n   | HTTP Method | in | *POST* | And | |\n   | Application | not in | *Workday* | | |\n\n4. Select **Create policy**.\n\nDLP scanning is now turned on.\n\n## 3. Test DLP policy\n\nYou can test your DLP policy on any device connected to your Zero Trust organization. To perform a basic test:\n\n1. Go to [dlptest.com](http://dlptest.com/http-post/).\n2. Enter a text message or upload a file containing the sensitive data.\n3. Select **Submit** to send the request.\n\nThe request will be allowed or blocked according to your DLP policies. If the data matches a DLP policy, you will see the request in your [DLP logs](#4-view-dlp-logs).\n\nDifferent sites will send requests in different ways. For example, some sites will split a file upload into multiple requests. Therefore, even if the policy works on `dlptest.com`, it is not guaranteed to work the same way on another site or application.\n\n## 4. View DLP logs\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Logs** > **HTTP request logs**.\n\n2. Select **Filter**.\n\n3. Choose an item under one of the following filters:\n\n   * **DLP Profiles** shows the requests which matched a specific DLP profile.\n   * **Policy** shows the requests which matched a specific DLP policy.\n\nYou can expand an individual row to view details about the request. To see the data that triggered the DLP policy, [configure logging options](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/).\n\n### Report false positives\n\n1. Select the log you want to report.\n2. Select **Report DLP false positive** under **DLP details**.\n3. The information to be sent to Cloudflare will appear. To confirm your report, select **Send report**.\n\nCloudflare will not respond directly to your report, but reporting false positives helps us improve our products. If you require technical assistance, reach out to [support](https://dash.cloudflare.com/?to=/:account/support).\n\n</page>\n\n<page>\n---\ntitle: Scan SaaS apps · Cloudflare One docs\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/saas-apps/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/saas-apps/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: DLP profiles · Cloudflare One docs\ndescription: A DLP profile is a collection of regular expressions and detection\n  entries that define the data patterns you want to detect. Cloudflare DLP\n  provides predefined profiles for common detections, or you can build custom\n  DLP profiles specific to your data, organization, and risk tolerance.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/\n  md: https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/index.md\n---\n\nA DLP profile is a collection of regular expressions and [detection entries](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/) that define the data patterns you want to detect. Cloudflare DLP provides predefined profiles for common detections, or you can build custom DLP profiles specific to your data, organization, and risk tolerance.\n\n## Configure a predefined profile\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Profiles**.\n2. Choose a [predefined profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/) and select **Edit**.\n3. Enable one or more **Detection entries** according to your preferences. The DLP Profile matches using the OR logical operator — if multiple entries are enabled, your data needs to match only one of the entries.\n4. Select **Save profile**.\n\nYou can now use this profile in a [DLP policy](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy) or [CASB integration](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/).\n\n## Build a custom profile\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Profiles**.\n\n2. Select **Create profile**.\n\n3. Enter a name and optional description for the profile.\n\n4. Add custom or existing detection entries.\n\n   Add a custom entry\n\n   1. Select **Add custom entry** and give it a name.\n\n   2. In **Value**, enter a regular expression (or regex) that defines the text pattern you want to detect. For example, `test\\d\\d` will detect the word `test` followed by two digits.\n\n      * Regular expressions are written in Rust. We recommend validating your regex with [Rustexp](https://rustexp.lpil.uk/).\n      * DLP detects UTF-8 characters, which can be up to 4 bytes each. Custom text pattern detections are limited to 1024 bytes in length.\n      * DLP does not support regular expressions with `+` or `*` operators because they are prone to exceeding the length limit. For example, the regex pattern `a+` can detect an infinite number of `a` characters. We recommend using `a{min,max}` instead, such as `a{1,1024}`.\n\n   3. To save the detection entry, select **Done**.\n\n   Add existing entries\n\n   Existing entries include [predefined](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/predefined-profiles/) and [user-defined](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/detection-entries/) detection entries.\n\n   1. Select **Add existing entries**.\n   2. Choose which entries you want to add, then select **Confirm**.\n   3. To save the detection entry, select **Done**.\n\n5. (Optional) Configure [**profile settings**](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/advanced-settings/) for the profile.\n\n6. Select **Save profile**.\n\nYou can now use this profile in a [DLP policy](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/#2-create-a-dlp-policy) or [CASB integration](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/casb-dlp/).\n\n</page>\n\n<page>\n---\ntitle: Directories · Cloudflare One docs\ndescription: Directories are folders to store user data. Email security allows\n  you to manage directories from the Cloudflare dashboard.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/directories/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/directories/index.md\n---\n\nDirectories are folders to store user data. Email security allows you to manage directories from the Cloudflare dashboard.\n\nTo add a directory:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/) > **Email security**.\n2. Select **Directories**.\n3. Select **Add a directory** > **Connect an integration**.\n4. Select either **Google Workspace CASB + EMAIL** or **Microsoft CASB+EMAIL**.\n5. Refer to [Enable Gmail BCC integration](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/bcc-setup/gmail-bcc-setup/enable-gmail-integration/#enable-gmail-bcc-integration) if you choose Google Workspace. Refer to [Enable Microsoft integration](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/api/m365-api/#enable-microsoft-integration) if you choose Microsoft 365.\n\nTo sync a directory:\n\n1. Locate the directory you want to sync.\n2. Select the three dots, then select **Sync now**.\n\nNote\n\nThe **Auto sync** option is on by default. It is recommended to keep this option on at all times to ensure directories are always synchronized.\n\n</page>\n\n<page>\n---\ntitle: Email security API · Cloudflare One docs\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/email-security-api-docs/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/email-security-api-docs/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Investigation · Cloudflare One docs\nlastUpdated: 2025-10-27T11:42:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/investigation/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/investigation/index.md\n---\n\n* [Search email](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/)\n\n</page>\n\n<page>\n---\ntitle: Monitoring · Cloudflare One docs\ndescription: Once you have chosen a domain to scan, Email security allows you to\n  monitor the traffic scanned from your email inboxes.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/index.md\n---\n\nOnce you have chosen a domain to scan, Email security allows you to monitor the traffic scanned from your email inboxes.\n\nNote\n\nWith Email security, you can enable logs to send detection data to an endpoint of your choice. Refer to [Enable Email security logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/enable-logs/) for more information.\n\nTo monitor your inbox:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security**.\n3. Under **Email security**, select **Monitoring**.\n\nThe dashboard will display the following metrics:\n\n* Email activity\n* [Disposition evaluation](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/)\n* Detection details\n* [Impersonations](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/)\n* [Phish submissions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/)\n* [Auto-move events](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/)\n* [Detection settings metrics](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/)\n\n## Email activity\n\nEmail activity aggregates statistics about emails scanned and dispositions assigned (the number of email flagged due to a detection) within a given timeframe.\n\nTo view the live number of email scanned and dispositions scanned, enable **Live mode**.\n\n## Disposition evaluation\n\nEmail traffic that flows through Email security is given a final disposition, which represents Email security's evaluation of that specific message.\n\nDisposition evaluation displays the following dispositions:\n\n* **Malicious**: Traffic associated with active threat campaigns. Malicious messages invoked multiple phishing verdict triggers and met thresholds for bad behavior.\n  * **Recommendation**: Block.\n* **Suspicious**: Traffic associated with phishing campaigns (and is under further analysis by our automated systems).\n  * **Recommendation**: Research these messages internally to evaluate legitimacy.\n* **Spam**: Traffic associated with non-malicious, commercial campaigns.\n  * **Recommendation**: Route to existing Spam quarantine folder.\n* **Spoof**: Traffic associated with phishing campaigns that is either non-compliant with your email authentication policies ([SPF](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-spf-record/), [DKIM](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-dkim-record/), [DMARC](https://www.cloudflare.com/en-gb/learning/dns/dns-records/dns-dmarc-record/)) or has mismatching `Envelope From` and `Header From` values.\n  * **Recommendation**: Block after investigating (can be triggered by third-party mail services).\n* **Bulk**: Traffic often associated with newsletters or marketing campaigns. Refer to [Graymail](https://en.wikipedia.org/wiki/Graymail_%28email%29) for more details.\n  * **Recommendation**: Monitor or tag.\n\n## Detection details\n\nDetection details displays information about:\n\n* **Malicious** disposition:\n\n  * **Email threat types**: Top malicious threat types, and their number relative to the total amount of malicious threats received.\n  * **Targeted users**: Top number of emails targeted, and their number relative to the total amount of malicious targets.\n  * **Malicious links**: A graph displaying the total number of malicious links and their distribution throughout the month.\n  * **Malicious attachments**: Number of malicious attachments, and the top types of malicious files received.\n\n* **Suspicious** disposition:\n\n  * **Suspicious threat types**: Top suspicious threat types, and their number relative to the total amount of threats received.\n  * **Suspicious targets**: Top number of emails targeted, and their number relative to the total amount of malicious targets.\n  * **Suspicious links**: A graph displaying the total number of suspicious links and their distribution throughout the month.\n\n* **Spoof** disposition:\n\n  * **Spoof users (impersonated names)**: Top number of impersonated names, and their number relative to the total number of detection received.\n  * **Spoof targets**: Top number of targeted emails.\n  * **Sender v. envelope mismatch**: This field indicates the number of mismatches between the email address the message was sent from, and the email address the message was *actually* sent from.\n\n## Impersonations\n\nImpersonations are a form of phishing attack where the actor pretends to be someone else to steal sensitive information.\n\n**Impersonations** displays the number of targeted users, and a chart describing the total number of impersonation attempts.\n\n* To view all targeted users, select **View all targeted users**.\n* To view all impersonation emails, select **View all impersonation emails**.\n* To view impersonated users, select **View impersonated users**.\n\nRefer to [Trusted domains](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/trusted-domains/) to add a trusted domain, and [Impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/) to add a user to the impersonation registry.\n\n## Phish submissions\n\nPhishing is a type of attack that involves stealing sensitive information with the aim of using and selling the information.\n\nA phish submission happens when a user or an administrator reports a phishing attack. Refer to [Phish submissions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/) to learn how to submit a phish.\n\nPhish submissions displays the following information:\n\n* **All submissions**: The total number of phish submissions.\n* **User submissions**: The number of phish submissions reported by your users.\n* **Admin submissions**: The number of phish submissions reported by an administrator.\n\nSelect **Review submissions** to review a filtered list of phish submissions reported by your team.\n\n## Auto-move events\n\nAuto-move events are emails moved to different inboxes based on the disposition Email security assigned.\n\nThis panel shows you the total number of auto-moves and the source folder from which these retractions are originating from.\n\nRefer to [Auto-moves](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/) to configure auto-move events.\n\n## Detection settings metrics\n\nDetection settings metric displays information about:\n\n* **Allowed traffic**: Traffic that Email security will exempt emails that match certain patterns from normal detection scanning. Allowed traffic shows metrics on emails that were allowed to go through user inboxes.\n* **Blocked traffic**: Traffic that Email security automatically blocks from senders. Blocked traffic shows metrics on emails that were blocked from user inboxes.\n* **Domain age**: The number of days since domain registration.\n\nSelect **Configure** to configure policy and rules for [allowed traffic](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/allow-policies/), [blocked traffic](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/blocked-senders/) and [domain age](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/additional-detections/).\n\n</page>\n\n<page>\n---\ntitle: Outbound Data Loss Prevention (DLP) · Cloudflare One docs\ndescription: Outbound Data Loss Prevention ensures the protection of sensitive\n  information in outbound emails with Cloudflare Data Loss Prevention (DLP).\n  Outbound Data Loss Prevention integrates with your inbox, and it proactively\n  monitors your email to prevent unauthorized data leaks.\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/outbound-dlp/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/outbound-dlp/index.md\n---\n\nCompatibility\n\nOutbound DLP is only compatible with Microsoft 365. You need to have Microsoft E3 or E5 license to enable Outbound DLP.\n\nOutbound Data Loss Prevention ensures the protection of sensitive information in outbound emails with [Cloudflare Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/). Outbound Data Loss Prevention integrates with your inbox, and it proactively monitors your email to prevent unauthorized data leaks.\n\nTo enable Outbound DLP:\n\n1. [Create an outbound policy](https://developers.cloudflare.com/cloudflare-one/email-security/outbound-dlp/#1-create-an-outbound-policy).\n2. [Set up DLP Assist add-in](https://developers.cloudflare.com/cloudflare-one/email-security/outbound-dlp/#2-dlp-assist-add-in).\n\n## 1. Create an outbound policy\n\nAn outbound policy allows you to control outbound email flow.\n\nTo create an outbound DLP policy:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Email security** > **Outbound DLP**.\n\n2. Select **Add a policy**.\n\n3. Name your policy.\n\n4. Build an expression to match specific email traffic. For example, you can create a policy that blocks outbound emails containing identifying numbers:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | Recipient email | not in | `example.com` | And | Block |\n   | Matched DLP profile | in | *Social Security, Insurance, Tax, and Identifier Numbers* | | |\n\n5. (Optional) Choose whether to use the default block message or a custom message.\n\n6. Select **Create policy**.\n\nAfter creating your policy, you can modify or reorder your policies in **Email security** > **Outbound DLP**.\n\n### Selectors\n\n| Selector | Description |\n| - | - |\n| Recipient email | The intended recipient of an outbound email. |\n| Email sender | The user in your organization sending an email. |\n| Matched DLP profile | The [DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) that content of an email matches upon scan. |\n\n## 2. DLP Assist add-in\n\nThe Data Loss Prevention (DLP) Assist add-in allows Microsoft 365 users to deploy a DLP solution for free using Cloudflare's Email security. DLP Assist add-in protects your data egress from Outlook web and dekstop client.\n\nTo set up DLP Assist add-in:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Email security** > **Outbound DLP**.\n\n2. Select **View Microsoft add-in instructions** > Select **Download add-in**. This downloads a `.xml` file necessary to install the add-in on the client side.\n\n3. Set up the add-in in Microsoft 365:\n\n   * Log in to the [Microsoft admin panel](https://security.microsoft.com/homepage) and go to **Microsoft 365 Admin Center** > **Settings** > **Integrated Apps**.\n   * Choose **Upload custom apps** and select **Office Add-in** for the application type.\n   * Select **Upload manifest file (.xml) from device**.\n   * Upload the Cloudflare add-in file you downloaded in step three. Then, verify and complete the wizard. It can take up to 24 hours for an add-in to propagate.\n\nThe add-in works by inserting headers into the [EML](https://en.wikipedia.org/wiki/EML) on the client side before the message is sent out.\n\nTo block, encrypt, or send approval, you can configure rules within Microsoft Purview DLP:\n\n1. Go to [Microsoft Purview](https://purview.microsoft.com/datalossprevention/overview?tid=11648e1c-3d60-40e2-bf07-f8d481e48e2d).\n\n2. Select **Policies** > **Create policy**.\n\n3. Do not choose any templates or custom policy. Select **Next**.\n\n4. Choose a name and description for the policy: You can choose any name. However, this guide will use `Cloudflare Assist Block`.\n\n5. Select **Next** on **Admin Units**:\n\n   * Choose to only apply to **Exchange Email**.\n   * Choose **Create or customize advanced DLP Rules**.\n\n6. Select **Create rule**:\n\n   * Create a policy name.\n\n   * Add the following conditions:\n\n     * **Header contains words or phrases**: `Key: cf_outbound_dlp with Value: BLOCK`\n     * Select **AND**.\n     * **Content is shared from Microsoft 365**: Select **with people from outside my organization**.\n\n7. Under **Actions**, the admin can choose what to do with the message. You can use the **Restrict access or encrypt the content in Microsoft 365 locations** to block the message or encrypt it.\n\n8. Under **User notifications**, turn on notifications. Admins can also edit the message if they want to. You can also configure if the admin wants to receive a notification under **Incident reports** > **Use this severity level in admin alerts and reports**.\n\n9. Select **Save**.\n\n10. Select **Turn the Policy On Immediately**.\n\nNote\n\nThe Cloudflare add-in can take up to 24 hours to propagate after install.\n\n### Limitations\n\nOutbound DLP presents its limitations:\n\n* Outbound DLP only protects user-managed inboxes.\n* Outbound DLP offers the most consistent experience on Outlook Web App and Outlook desktop, due to limitations imposed by Microsoft.\n\n| Platform | Status |\n| - | - |\n| Web client | Stable |\n| New Outlook desktop client - Windows | Stable |\n| Desktop client - macOS | Can cause scanning to be delayed due to Apple limitation |\n| Old Outlook desktop client | Does not work due to Microsoft limitation |\n| Mobile client - iOS | Unstable due to Apple limitation |\n| Mobile client - Android | Unstable due to Microsoft limitation |\n\n</page>\n\n<page>\n---\ntitle: PhishGuard · Cloudflare One docs\ndescription: PhishGuard is a team of analysts that routinely inspects your email\n  environment and responds to threats that come through your email inbox.\nlastUpdated: 2025-12-15T12:02:14.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/phishguard/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/phishguard/index.md\n---\n\nPhishGuard is a team of analysts that routinely inspects your email environment and responds to threats that come through your email inbox.\n\nWhile Email security uses advanced technologies to protect your email inbox, PhishGuard offers an additional human component to protect your email environment against impersonation events, suspicious items, false negatives/false positives, and any new event that automated intelligent systems may miss due to a lack of context (for example, a compromised account activity).\n\nPhishGuard only works on a post-delivery environment (only emails that have already landed in your email inbox are reviewed). As a result, PhishGuard analysts may [submit a message for review](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/#submit-messages-for-review) or [auto-move](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/) based on their findings.\n\nPhishGuard coordinates with the email detections team, allowing you to directly request immediate detection for specific items and implement custom detections unique to your needs. An example of this is requesting to block all PayPal traffic if you do not use PayPal for invoicing. This capability allows you to take ownership over the rules governing your email environment through PhishGuard's human intervention.\n\nAdditionally, PhishGuard analysts:\n\n* Use real-time threat data to identify malicious activity. Email-based threats are responded to rapidly, and immediately reported and documented.\n* Review every [user](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/#user-submissions) and [team](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/#team-submissions) submission so your security team can focus on more critical activites.\n* Help you detect and mitigate threats faster, reducing the time attacks have access to your network. This also helps reducing business impact, because it prevents data breaches, financial loss, and reputational damage.\n\nTo use PhishGuard:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n2. Select **Email security**.\n3. Select **PhishGuard**.\n\nThe dashboard will display the following metrics:\n\n* ROI Calculator\n* Insider threat defense\n* Email threat hunting\n* Actions\n* API Status\n* Managed email security operations\n* Reports\n\n## ROI Calculator\n\nUse the ROI Calculator to compare triage durations and hourly rates to calculate PhishGuard's return on investment.\n\nThe ROI Calculator displays:\n\n* Total aggregated saved number in USD dollars.\n* Triage duration: The amount of time in minutes spent triaging the message.\n* Hourly rate.\n\n## Insider threat defense\n\nAn [insider threat](https://www.cloudflare.com/en-gb/learning/access-management/what-is-an-insider-threat/) is a risk to an organization's security stemming from someone associated with the organization. PhishGuard looks for threat actor groups.\n\nInsider threat defense on the dashboard displays **Insider leads** and **Insider reports generated**. **Insider leads** displays the number of emails identified as potential insider threat email. **Insider reports generated** displays the number of reports created based on insider leads.\n\n## Email threat hunting\n\nPhishGuard reviews suspicious and highly malicious activity in your email environment.\n\nOn the Cloudflare One dashboard, email threat hunting displays previously unknown phishing attacks.\n\nEmail threat hunting also gives you information on **Threat leads generated** and **Total reposts generated**.\n\n## Actions\n\n**Actions** allows you to review the most common actions taken by the PhishGuard team, such as escalations, threat hunts, and moves.\n\n## API Status\n\nAPI Status allows you to monitor and configure the current status of API message auto-moves and directory integrations.\n\nSelect **Message moves** to [configure auto-moves](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/). Select **Directory integration** to [configure directories](https://developers.cloudflare.com/cloudflare-one/email-security/directories/).\n\n## Managed email security operations\n\nManaged email security operations allows you to review the results of phish submissions reviewed by the PhishGuard team.\n\nIt displays the following:\n\n* Total [phish submissions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/)\n* Tracked incidents\n* Median time to resolve\n* Resolved track incidents\n\n## Reports\n\nUnder Reports, you can review reports of threats discovered and resolved by the PhishGuard team.\n\nIf you select the three dots, you can:\n\n* **View report details**: Report Details gives you the following information about each report:\n\n  * **Overview**: An Overview of the report. This includes date and time of the report, type of attack performed, and more.\n  * **Target and victimology**: Company targeted.\n  * **Details**: Displays information such as delivery disposition, current disposition, ES Alert ID, Message-ID, Timestamp, Subject, and Attempted Fraudulent Amount.\n  * **Indicators of compromise (IOC)**: [Indicators of compromise (IOC)](https://www.cloudflare.com/en-gb/learning/security/what-are-indicators-of-compromise/) are information about a specific security breach that can help security teams determine if an attack has taken place.\n\n* Preview email.\n\n* [Move email](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/).\n\n</page>\n\n<page>\n---\ntitle: Reference · Cloudflare One docs\nlastUpdated: 2025-05-06T14:01:58.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/reference/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/reference/index.md\n---\n\n* [How Email security detects phish](https://developers.cloudflare.com/cloudflare-one/email-security/reference/how-es-detects-phish/)\n* [Dispositions and attributes](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/)\n\n</page>\n\n<page>\n---\ntitle: Retro Scan · Cloudflare One docs\ndescription: Retro Scan allows you to scan up to 14 days of old messages in your\n  Microsoft 365 inboxes and check if your current email security solution missed\n  any threats. Once you receive your Retro Scan report, you will be able to\n  remediate malicious messages.\nlastUpdated: 2025-11-05T17:19:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/retro-scan/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/retro-scan/index.md\n---\n\nRetro Scan allows you to scan up to 14 days of old messages in your Microsoft 365 inboxes and check if your current email security solution missed any threats. Once you receive your Retro Scan report, you will be able to remediate malicious messages.\n\nNote\n\nRetro Scan is only available for Microsoft 365 accounts.\n\nTo start a free scan:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n\n2. Select **Email security** > **Overview**.\n\n3. Select **Start a free scan** > **Generate report**.\n\n4. Enable your [Microsoft integration](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/api/m365-api/#enable-microsoft-integration). Once you enabled your Microsoft integration, you will redirected to a page wheer you will add your domains and speficy your current email security system.\n\n5. Generate Retro Scan report:\n\n   * **Connect domains**: Select at least one domain from your integration, then select **Continue**.\n   * **Select current solution**: Select the email security tool you are currently using, then select **Continue**.\n   * **Review details**: Review the details you previously selected. Then, select **Continue**. You will be notified by email once the report is available.\n\n6. Go to your email inbox and select the link to view the full report.\n\n7. On the Cloudflare dashboard, select **View report**.\n\nThe dashboard will display **Overview** and **Details** pages.\n\n### Overview\n\nOverview displays the total scanned domains. The overview shows you:\n\n* [Disposition evaluation](https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/#disposition-evaluation)\n* Malicious threat types\n* Malicious targets\n* Malicious threat origins\n\n### Details\n\nDetails allows you to review the first 1,000 emails assigned a disposition.\n\nSelect an email to review [details](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/#details) about the message.\n\n</page>\n\n<page>\n---\ntitle: Settings · Cloudflare One docs\nlastUpdated: 2025-10-27T11:42:41.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/settings/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/settings/index.md\n---\n\n* [Domain management](https://developers.cloudflare.com/cloudflare-one/email-security/settings/domain-management/)\n* [Detection settings](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/)\n* [Auto-move events](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/)\n* [Phish submissions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/phish-submissions/)\n\n</page>\n\n<page>\n---\ntitle: Before you begin · Cloudflare One docs\ndescription: \"Before you start the onboarding process, you will have to:\"\nlastUpdated: 2025-12-15T12:02:14.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/setup/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/setup/index.md\n---\n\nBefore you start the onboarding process, you will have to:\n\n1. Choose a deployment path: Email security provides two deployment modes, [post-delivery](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/) for API and BCC/Journaling and [pre-delivery](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/) for MX/Inline.\n2. Learn about dispositions, impersonation registry, and submissions.\n3. Know the steps to configure your email environment correctly.\n\nThe following table compares features available across API, BCC/Journaling and MX/Inline:\n\n| Feature | API | BCC | Journaling | MX/Inline |\n| - | - | - | - | - |\n| Deployment Type | Post-delivery | Post-delivery | Post-delivery | Pre-delivery (Inline) |\n| Supported Email Provider | Microsoft 365 | Gmail, Microsoft 365 | Microsoft 365 | All email providers |\n| Inspection Timing | Scans messages already in the mailbox | Scans a copy of the message upon delivery | Scans a copy of the message upon delivery | Scans the message before delivery |\n| Mechanism | Uses MS Graph API to integrate with Microsoft 365. | Uses a BCC rule to send a copy to Cloudflare | Uses a Journal Rule in the Microsoft Purview portal | Changes MX records to point email traffic to Cloudflare |\n| Message Remediation | Auto-moves through Read/Write API permissions | Auto-moves through Google or Microsoft integration | Auto-moves through Microsoft integration | Messages can be blocked, quarantined, or modified inline |\n| Message Modification | Primarily deletion/move post-delivery | Primarily deletion/move post-delivery | Primarily deletion/move post-delivery. | Move post-delivery. Supports link actions and text add-ons.[1](#user-content-fn-1) |\n\n[1](#user-content-fn-1) With [inline deployment](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/mx-inline-deployment/), Cloudflare recommends setting up the integrations to allow post-delivery response and phish submission response to work. Refer to step 7 in [Auto-moves](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/) to learn more.\n\n## 1. Choose a deployment\n\n### Post-delivery deployment\n\nWhen you choose post-delivery deployment, Cloudflare scans emails **after** they reach a users' inbox.\n\nIf you are a Microsoft 365 user, this is done via [Microsoft's Graph API](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/api/m365-api/) or [journaling](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/journaling-setup/m365-journaling/).\n\nIf you are a [Google Workspace](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/bcc-setup/gmail-bcc-setup/gmail-bcc-setup/) or [Microsoft Exchange](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/bcc-setup/bcc-microsoft-exchange/) user, this is done via BCC.\n\n#### Why you should consider post-delivery deployment\n\nPost-delivery deployment is time-efficient, because it does not involve MX changes. Post-delivery deployment does not disrupt mail flow. Post-delivery deployment allows you to enable [auto-move events](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/) to hard or soft delete messages, and synchronize your [directory](https://developers.cloudflare.com/cloudflare-one/email-security/directories/) when you use Microsoft Graph API or Google Workspace.\n\nNote\n\nWhen you choose post-delivery deployment:\n\n* The threat is removed **after** the message has been delivered to the inbox.\n* It requires API scopes, or BCC/Journaling rule configuration.\n* Auto-move is only available in BCC/Journaling if you associate an integration.\n\n### Pre-delivery deployment\n\nWhen you choose pre-delivery deployment, Cloudflare scans emails **before** they reach a users' inbox. The MX record points to Cloudflare.\n\n#### Why you should consider pre-delivery deployment\n\nPre-delivery deployment provides you with the highest level of protection. It enforces [text add-ons](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/configure-text-add-ons/) or link rewrite at delivery.\n\nPre-delivery blocks threats in transit, and it adds banners or texts before the user views the email.\n\nNote\n\nWhen you choose pre-delivery deployment:\n\n* You must edit MX records or create a connector.\n* You can enable auto-move events only after you associate an integration.\n* Cloudflare [egress IPs](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/egress-ips/) are allowed on downstream mail servers.\n\n## 2. Understand dispositions\n\nDispositions allow you to configure policies and tune reporting. For example, you can configure a policy to move suspicious emails to your junk folder.\n\nRefer to [Dispositions](https://developers.cloudflare.com/cloudflare-one/email-security/reference/dispositions-and-attributes/#dispositions) to learn more about dispositions.\n\n## 3. Set up the impersonation registry\n\nMost [business email compromise (BEC)](https://www.cloudflare.com/en-gb/learning/email-security/business-email-compromise-bec/) targets executives or finance roles. You must add addresses of roles who are likely to be impersonated. Refer to [Impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/) to learn how to add a user to the impersonation registry.\n\nRoles you may want to include in the impersonation registry are:\n\n* C-suites\n* Finance roles\n* HR\n* IT help-desk\n* Legal\n\nYou should review your impersonation registry on a quarterly basis as roles change.\n\n## 4. Submit messages\n\nA submission is a change to an email's disposition **after** initial scanning. It is Cloudflare's built-in feedback loop for correcting false positives/negatives **and** training the detection models to get smarter over time. Refer to [Submit messages for review](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/#submit-messages-for-review) to learn how to reclassify a message.\n\n### Who can reclassify messages\n\n[Security teams](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/team-submissions/) and [end users](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/user-submissions/) can perform a submission.\n\n### Why you should submit messages\n\nSubmissions are critical because:\n\n* **They help improve model accuracy**: Every validated submissions teaches Cloudflare's machine learning to recognise new lures, language, infrastructure, and benign patterns.\n* **They reduce alert fatigue**: Correcting Suspicious or Spam emails that users actually want tailors detections to your organization, cutting noise in the dashboard.\n* **They close the remediation loop**: When a disposition is upgraded to Malicious, Cloudflare auto-moves those emails out of every inbox (Graph API or Google Workspace API integrations).\n* **They can help you log activity taken on any submission**: Each submission displays a submission ID, details about original, requested and final dispositions, and more. Refer to [Submit messages for review](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/#submit-messages-for-review) to learn more about submissions.\n\nTo make the most of submissions:\n\n1. Review submissions on a weekly basis.\n2. Ensure you have an integration associated with any MX/Inline deployment. When you associate an integration, you will not need to upload the EMLs every time; Cloudflare can use APIs to receive a copy of your email messages.\n3. Investigate any increase in [user submissions](https://developers.cloudflare.com/cloudflare-one/email-security/investigation/search-email/#user-submissions) (users may have found a phish that bypassed filters) and confirm that analyst-final dispositions align with your policies.\n\nA correct use of submissions ensures that Email security delivers a stronger protection with less manual tuning.\n\n## 5. Configuration checklist\n\nFollow the below checklist to ensure your email environment is set up correctly:\n\n| Step | Post-delivery | Pre-delivery |\n| - | - | - |\n| Authorize integration ([Graph API](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/api/m365-api/#enable-microsoft-integration) or [Google Workspace](https://developers.cloudflare.com/cloudflare-one/email-security/setup/post-delivery-deployment/bcc-journaling/bcc-setup/gmail-bcc-setup/enable-gmail-integration/)) | Required[1](#user-content-fn-1) | Required [2](#user-content-fn-2) |\n| Associate an integration with an MX/Inline domain | | Required |\n| Add/verify domains | Required | Required |\n| [Update MX records/connector](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/mx-inline-deployment-setup/), then allow Cloudflare [egress IPs](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/egress-ips/) on downstream mail server | | Required |\n| Enable [Post‑delivery response and Phish submission response](https://developers.cloudflare.com/cloudflare-one/email-security/settings/auto-moves/) | Required | Required |\n| Populate [impersonation registry](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/impersonation-registry/) and [allow](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/allow-policies/)/[block](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/blocked-senders/) lists | Required | Required |\n| Configure [partner domain TLS](https://developers.cloudflare.com/cloudflare-one/email-security/setup/pre-delivery-deployment/partner-domain-tls/) and admin quarantine | | Required |\n| Configure [text add-ons](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/configure-text-add-ons/) and [link actions](https://developers.cloudflare.com/cloudflare-one/email-security/settings/detection-settings/configure-link-actions/) | | Required |\n| Send a test email and verify it appears in **Monitoring** > [**Email activity**](https://developers.cloudflare.com/cloudflare-one/email-security/monitoring/#email-activity) with expected disposition | Required | Required |\n\nNow that you know which deployment path to choose, you can begin your onboarding process.\n\n## Footnotes\n\n1. Associating an integration with BCC/Journaling is required for post-delivery but not for pre-delivery. [↩](#user-content-fnref-1) [↩2](#user-content-fnref-1-2) [↩3](#user-content-fnref-1-3)\n\n2. Still used for directory/auto‑move insight if desired as well as authorizing free API CASB. [↩](#user-content-fnref-2)\n\n</page>\n\n<page>\n---\ntitle: Identity FAQ · Cloudflare One docs\ndescription: Review frequently asked questions about identity and identity\n  providers in Cloudflare Zero Trust.\nlastUpdated: 2025-10-24T18:16:28.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/authentication-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/authentication-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## Can Access work with multiple identity providers at the same time?\n\nYes. Your team can simultaneously use multiple providers, reducing friction when working with partners or contractors. Get started by adding your preferred identity providers as login methods in Zero Trust. Then, when securing a new application behind Access, you'll be able to choose which providers you want your users to log in with to reach that application.\n\n## What if the identity provider my team uses is not listed?\n\nYou can add your preferred identity providers to Cloudflare Access even if you do not see them listed in Zero Trust, as long as these providers support SAML 2.0 or [OpenID Connect (OIDC)](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/).\n\n## How do end users log out of an application protected by Access?\n\nAccess provides a URL that will end a user's current session.\n\nTo force log out of an Access application, go to:\n\n`<your-application-domain>/cdn-cgi/access/logout`\n\nTo log out of an App Launcher session, go to:\n\n`<your-team-name>.cloudflareaccess.com/cdn-cgi/access/logout`\n\nFor more information, refer to our [session management page](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/#log-out-as-a-user).\n\n</page>\n\n<page>\n---\ntitle: Submissions · Cloudflare One docs\ndescription: Submitting messages allows you to choose the disposition of your\n  messages if the disposition is incorrect. This helps improve Email security's\n  detection accuracy and ensures proper handling of email threats.\nlastUpdated: 2025-12-15T12:02:14.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/\n  md: https://developers.cloudflare.com/cloudflare-one/email-security/submissions/index.md\n---\n\nSubmitting messages allows you to choose the disposition of your messages if the disposition is incorrect. This helps improve Email security's detection accuracy and ensures proper handling of email threats.\n\n## Submit messages for review\n\nTo submit a message for review:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Email security** and select **Investigation**.\n\n2. On the **Investigation** page, under **Your matching messages**, select the message you want to reclassify.\n\n3. Select the three dots, then select **Submit for review**.\n\n4. Under **New disposition**, select among the following:\n\n   * **Malicious**: Traffic invoked multiple phishing verdict triggers, met thresholds for bad behavior, and is associated with active campaigns.\n   * **Spoof**: Traffic associated with phishing campaigns that is either non-compliant with your email authentication policies (SPF, DKIM, DMARC) or has mismatching Envelope From and `Header From` values.\n   * **Spam**: Traffic associated with non-malicious, commercial campaigns.\n   * **Bulk**: Traffic associated with [Graymail](https://en.wikipedia.org/wiki/Graymail_%28email%29), that falls in between the definitions of `SPAM` and `SUSPICIOUS`. For example, a marketing email that intentionally obscures its unsubscribe link.\n   * **Clean**: Traffic not associated with any phishing campaigns.\n\n5. Select **Save**.\n\nTo submit messages in bulk, select **Select all messages** > **Action** > **Request submissions**.\n\nTo release messages in bulk, select **Select all messages** > **Action** > **Release**.\n\n## Upload EML files\n\nEmail security classifies certain emails as \"Clean\". If you disagree with the disposition, you can upload an EML file and reclassify the email.\n\nOn the **Investigation** page:\n\n1. Go to the email marked as **Clean**.\n2. Select the three dots > **Submit for review**.\n3. Upload the EML file.\n4. Select a new disposition.\n5. Select **Save**.\n\n## View submissions\n\nOnce you have submitted your messages, you can access those on **Submissions**.\n\nTo view submissions:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com/).\n\n2. Select **Email security** > **Submissions**.\n\n3. Choose from the following submission types:\n\n   * [**Team submissions**](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/team-submissions/): View emails your security team submitted for submissions.\n   * [**User submissions**](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/user-submissions/): View emails your users submitted for submissions.\n   * [**Invalid submissions**](https://developers.cloudflare.com/cloudflare-one/email-security/submissions/invalid-submissions/): View submissions that could not be processed.\n\n</page>\n\n<page>\n---\ntitle: Tunnels FAQ · Cloudflare One docs\ndescription: Review frequently asked questions about tunnels in Cloudflare Zero Trust.\nlastUpdated: 2025-11-03T17:59:55.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/cloudflare-tunnels-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/cloudflare-tunnels-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## ​Can I create a Tunnel for an apex domain?\n\nYes. With [Named Tunnels](https://blog.cloudflare.com/argo-tunnels-that-live-forever/) you can create a CNAME at the apex that points to the named tunnel.\n\n## ​Does Cloudflare Tunnel support Websockets?\n\nYes. Cloudflare Tunnel has full support for Websockets.\n\n## ​Does Cloudflare Tunnel support gRPC?\n\nYes.\n\nCloudflare Tunnel supports gRPC traffic via [private subnet routing](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/). Public hostname deployments are not currently supported.\n\n## How can Tunnel be used with Partial DNS (CNAME Setup)?\n\nCloudflare offers two modes of setup: [Full Setup](https://developers.cloudflare.com/dns/zone-setups/full-setup/), in which the domain uses Cloudflare DNS nameservers, and [Partial Setup](https://developers.cloudflare.com/dns/zone-setups/partial-setup/) (also known as CNAME setup) in which the domain uses non-Cloudflare DNS servers.\n\nThe best experience with Cloudflare Tunnel is using Full Setup because Cloudflare manages DNS for the domain and can automatically configure DNS records for newly started Tunnels.\n\nYou can still use Tunnel with Partial Setup. You will need to create a new DNS record with your current DNS provider for each new hostname connected through Cloudflare Tunnel. The DNS record should be of type CNAME or ALIAS if it is on the root of the domain. The name of the record should be the subdomain it corresponds to (e.g. `example.com` or `tunnel.example.com`) and the value of the record should be `subdomain.domain.tld.cdn.cloudflare.net`. (e.g. `example.com.cdn.cloudflare.net` or `tunnel.example.com.cdn.cloudflare.net`)\n\n## How can origin servers be secured when using Tunnel?\n\nTunnel can expose web applications to the Internet that sit behind a NAT or firewall. Thus, you can keep your web server otherwise completely locked down. To double check that your origin web server is not responding to requests outside Cloudflare while Tunnel is running you can run netcat in the command line:",
      "language": "unknown"
    },
    {
      "code": "If your server is still responding on those ports, you will see:",
      "language": "unknown"
    },
    {
      "code": "If your server is correctly locked down, you will see:",
      "language": "unknown"
    },
    {
      "code": "## What records are created for routing to a Named Tunnel's hostname?\n\nNamed Tunnels can be routed via DNS records, in which case we use CNAME records to point to the `<UUID>.cfargotunnel.com`; Or as Load Balancing endpoints, which also point to `<UUID>.cfargotunnel.com`.\n\n## Does Cloudflare Tunnel send visitor IPs to my origin?\n\nNo. When using Cloudflare Tunnel, all requests to the origin are made internally between `cloudflared` and the origin.\n\nTo log external visitor IPs, you will need to [configure an alternative method](https://developers.cloudflare.com/support/troubleshooting/restoring-visitor-ips/restoring-original-visitor-ips/).\n\n## Why does the name 'warp' and 'argo' appear in some legacy materials?\n\nCloudflare Tunnel was previously named Warp during the beta phase. As Warp was added to the Argo product family, we changed the name to Argo Tunnel to match. Once we no longer required users to purchase Argo to create Tunnels, we renamed Argo Tunnel to Cloudflare Tunnel.\n\n## Is it possible to restore a deleted tunnel?\n\nNo. You cannot undo a tunnel deletion. If the tunnel was locally-managed, its [`config.yaml` file](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/tunnel-useful-terms/#configuration-file) will still be present and you can create a new tunnel with the same configuration. If the tunnel was remotely-managed, both the tunnel and its configuration are permanently deleted.\n\n## How do I contact support?\n\nBefore contacting the Cloudflare support team:\n\n1. Take note of any specific error messages and/or problematic behaviors.\n\n2. Make sure that `cloudflared` is updated to the [latest version](https://github.com/cloudflare/cloudflared).\n\n3. Gather any relevant error/access logs from your server.\n\n4. If needed set [`--loglevel`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/cloudflared-parameters/run-parameters/#loglevel) to `debug`, so the Cloudflare support team can get more info from the `cloudflared.log` file.\n\n5. Include your [Cloudflare Tunnel diagnostic logs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/troubleshoot-tunnels/diag-logs/) (`cloudflared-diag-YYYY-MM-DDThh-mm-ss.zip`).\n\n</page>\n\n<page>\n---\ntitle: Devices FAQ · Cloudflare One docs\ndescription: Review frequently asked questions about devices in Cloudflare Zero Trust.\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/devices-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/devices-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## Why does my Windows device appear to switch from Wi-Fi to Ethernet when I enable WARP?\n\nAs the WARP client has replaced WinDivert with WinTun architecture, all Windows machines using WinTun will show as being connected using a virtual adapter. Windows, by default, shows virtual adapter connections with a wired Ethernet connection icon, even if the device is connected over wireless. This is by design and should have no impact on connectivity.\n\n## Why is my device not connecting to a closer Cloudflare data center?\n\nAs our [Network Map](https://www.cloudflare.com/en-gb/network/) shows, we have locations all over the globe. However, in the Advanced Connection stats of our application, you may notice that the data center (colo) you are connecting to isn't necessarily the one physically closest to your location. This can be due to a number of reasons:\n\n* Sometimes your nearest colo may be undergoing maintenance or having problems. Check the [Cloudflare Status page](https://www.cloudflarestatus.com/) for system status.\n* Your Internet provider may choose to route traffic along an alternate path for reasons such as cost savings, reliability, or other infrastructure concerns.\n\n## Why is my public IP address sometimes visible?\n\nCloudflare WARP Client in WARP mode was meant to ensure all your traffic is kept private between you and the origin (the site you are connecting to), but not from the origin itself. In a number of cases, if the origin site you are communicating with can't determine who you are and where you're from, they can't serve locale relevant content to you. Sites inside Cloudflare network are able to see this information. If a site is showing you your IP address, chances are they are in our network. Most sites outside our network (orange clouded sites) however are unable to see this information and instead see the nearest egress colo to their server. We are working to see if in the future we can't find a way to more easily share this information with a limited number of gray clouded sites where it is relevant to both parties.\n\n## Why has my throughput dropped while using WARP?\n\nCloudflare WARP is in part powered by 1.1.1.1. When visiting sites or going to a new location on the Internet, you should see blazing fast DNS lookups. However, WARP is built to trade some throughput for enhanced privacy, because it encrypts all traffic both to and from your device. While this isn't noticeable at most mobile speeds, on desktop systems in countries where high speed broadband is available, you may notice a drop. We think the tradeoff is worth it though and continue to work on improving performance all over the system.\n\n## Why is my device not connecting to a public Wi-Fi?\n\nThe Wi-Fi network may have a captive portal that is blocking WARP from establishing a secure connection. In order to access the portal, and therefore the Internet, you will need to temporarily turn off WARP. After you login to the captive portal through your browser, you can turn WARP back on to access corporate resources.\n\nFor more information, refer to [Captive portal detection](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/captive-portals/).\n\n## Why is my device not connecting to the Internet?\n\nA third-party service or ISP may be blocking WARP, or Zero Trust settings may be misconfigured. For a list of common issues and steps to resolve, refer to our [troubleshooting guide](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/common-issues/).\n\n## Why is my device not connecting to the corporate Wi-Fi?\n\nAn [OS firewall rule](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/warp-architecture/#system-firewall) on the device may be blocking the EAP/Radius server that allows users to join the Wi-Fi network. If your corporate Wi-Fi uses a Radius server for network authentication, add the Radius server to your [Split Tunnel](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) Exclude list.\n\n## Why is my device not connecting to my private network?\n\nIf your private network is [exposed via Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/):\n\n* Verify that the WARP client is [properly configured](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/#device-configuration) on the device.\n* Verify that the user is allowed through by your Access and Gateway policies.\n* Verify that the [local LAN settings](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/#router-configuration) for the device do not overlap with the CIDR range of your private network.\n\nWhen contacting Cloudflare support, ensure that you include [WARP debug logs](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/) for your device. These logs will help Cloudflare support understand the overall architecture of your machine and networks.\n\n</page>\n\n<page>\n---\ntitle: Getting started with Cloudflare Zero Trust FAQ · Cloudflare One docs\ndescription: Review FAQs about getting started with Cloudflare Zero Trust.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/getting-started-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/getting-started-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## How do I sign up for Cloudflare Zero Trust?\n\nYou can sign up today at [this link](https://one.dash.cloudflare.com). Follow the onboarding steps, choose a team name and a payment plan, and start protecting your network in just a few minutes.\n\n## What is a team domain/team name?\n\nYour team domain is a unique subdomain assigned to your Cloudflare account, for example, `<your-team-name>.cloudflareaccess.com`. [Setting up a team domain](https://developers.cloudflare.com/cloudflare-one/setup/#create-a-zero-trust-organization) is an essential step in your Zero Trust configuration. This is where your users will find the apps you have secured behind Cloudflare Zero Trust — displayed in the [App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/) — and will be able to make login requests to them. The customizable portion of your team domain is called **team name**. You can view your team name and team domain in Cloudflare One under **Custom pages** > **Team name and domain**.\n\n| team name | team domain |\n| - | - |\n| `your-team-name` | `<your-team-name>.cloudflareaccess.com` |\n\nYou can change your team name at any time, unless you have the Cloudflare dashboard SSO feature enabled on your account. If Cloudflare dashboard SSO is enabled, you must [turn off SSO](https://developers.cloudflare.com/fundamentals/manage-members/dashboard-sso/#change-your-zero-trust-team-name) before changing your team name.\n\nNote\n\nOnce a team name has been used, even if the team domain is later deleted, the team name cannot be reused by any account. Once you delete a team name, you will not be able to use it again. Consider this limitation before changing or deleting your team name.\n\nWarning\n\nIf you change your team name, you need to update your organization's identity providers (IdPs) and the WARP client to reflect the new team name in order to avoid any mismatch errors.\n\n### Why is my old team name is still showing up on the Login page and App Launcher?\n\nAfter changing your team name, you will need to check your Block page, Login page, and App Launcher settings to make sure the new team name is reflected.\n\nTo verify that your team name change is successfully rendering on the Block page, Login page and App Launcher:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Custom pages** > **Team name and domain**.\n2. Find the **Account Gateway block page** and **Access login page** sections, then select **Manage** next to the page you would like to review first.\n3. Review that the value in **Your Organization's name** matches your new team name.\n4. If the desired name is not already displayed, change the value to your desired team name and select **Save**.\n5. Check both pages (**Account Gateway block page** and **Access login page** to set **Your Organization's name** as your desired team name.\n\nThe App Launcher will display the same team name set on the Access login page, so you do not need to update the **Your Organization's name** field in the App Launcher page.\n\n## How do I change my subscription plan?\n\nTo make changes to your subscription, visit the Billing section under **Settings** in [Cloudflare One](https://one.dash.cloudflare.com/). You can change or cancel your subscription at any time. Just remember - if you downgrade your plan during a billing cycle, your downgraded pricing will apply in the next billing cycle. If you upgrade during a billing cycle, you will be billed for the upgraded plan at the moment you select it.\n\n## How are active seats measured?\n\nCloudflare Zero Trust subscriptions consist of seats that users in your account consume. When users authenticate to an application or enroll their agent into WARP, they count against one of your active seats. Seats can be added, removed, or revoked at **Settings** > **Cloudflare One plan**. If all seats are currently consumed, you must first remove users before decreasing your purchased seat count.\n\n### Removing users\n\nUser seats can be removed for Access and Gateway at **Team & Resources** > **Users** > **Your users**. Removing a user will have consequences both on Access and on Gateway:\n\n* **Access**: All active sessions for that user will be invalidated. A user will be able to log back into an application unless you create an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) to block future logins from that user.\n\n* **Gateway**: All active devices for that user will be logged out of your Zero Trust organization, which stops all filtering and routing via the WARP client. A user will be able to re-enroll their device unless you create a [device enrollment policy](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/device-enrollment/) to block them.\n\nWarning\n\nThe Remove action will remove a user's seat, but it will not permanently revoke their ability to authenticate. To permanently disable a user's ability to authenticate, you must modify the policies that allow them to reach a given application or enroll a device in WARP.\n\n### Revoking users\n\nThe Revoke action will terminate active sessions and log out active devices, but will not remove the user's consumption of an active seat.\n\n## How do I know if my network is protected behind Cloudflare Zero Trust?\n\nYou can visit the [Zero Trust help page](https://help.one.cloudflare.com/). This page will give you an overview of your network details, as well as an overview of the categories that are being blocked and/or allowed.\n\n</page>\n\n<page>\n---\ntitle: General · Cloudflare One docs\ndescription: Review frequently asked questions about Cloudflare Zero Trust.\nlastUpdated: 2024-09-26T20:43:22.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/general-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/general-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## What is the difference between Cloudflare Gateway and 1.1.1.1?\n\n1.1.1.1 does not block any DNS query. When a browser requests for example.com, 1.1.1.1 simply looks up the answer either in cache or by performing a full recursive DNS query.\n\nCloudflare Gateway's DNS resolver introduces security into this flow. Instead of allowing all DNS queries, Gateway first checks the hostname being queried against the intelligence Cloudflare has about threats on the Internet. If that query matches a known threat, or is requesting a blocked domain configured by an administrator as part of a Gateway policy, Gateway stops it before the site could load for the user - and potentially execute code or phish that team member.\n\n## Is multi-factor authentication supported?\n\nAccess is subjected to the MFA policies set in your identity provider. For example, users attempting to log in to an Access protected app might log in through Okta. Okta would enforce an MFA check before sending the valid authentication confirmation back to Cloudflare Access.\n\nAccess does not have an independent or out-of-band MFA feature.\n\n## Which browsers are supported?\n\nThese browsers are supported:\n\n* Internet Explorer 11\n* Edge (current release, last release)\n* Firefox (current release, last release)\n* Chrome (current release, last release)\n* Safari (current release, last release)\n\n## What data localization services are supported?\n\nCloudflare Zero Trust can be used with the Data Localization Suite to ensure that traffic is only inspected in the regions you choose. For more information refer to [Use Zero Trust with Data Localization Suite](https://developers.cloudflare.com/data-localization/how-to/zero-trust/).\n\n</page>\n\n<page>\n---\ntitle: Policies FAQ · Cloudflare One docs\ndescription: Review frequently asked questions about policies in Cloudflare Zero Trust.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/policies-faq/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/policies-faq/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## What is the order of policy enforcement?\n\nGateway and Access policies generally trigger from top to bottom based on their position in the policy table in the UI. Exceptions include Bypass and Service Auth policies, which Access evaluates first. Similarly, for Gateway HTTP policies, Do Not Inspect and Isolate policies take precedence over all Allow or Block policies. To learn more about order of enforcement, refer to our documentation for [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#order-of-execution) and [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/).\n\n## **How can I bypass the L7 firewall for a website?**\n\nCloudflare Gateway uses the hostname in the HTTP `CONNECT` header to identify the destination of the request. Administrators who wish to bypass a site must create a [Do Not Inspect](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) policy in order to prevent HTTP inspection from occurring on both encrypted and plaintext traffic.\n\nBypassing the L7 firewall results in no HTTP traffic inspection, and logging is disabled for that HTTP session.\n\n## Can I secure applications with a second-level subdomain URL?\n\nYes. Ensure that your SSL certificates cover the first- and second-level subdomain. Most certificates only cover the first-level subdomain and not the second. This is true for most Cloudflare certificates. To cover a second-level subdomain with a CF certificate, create an [advanced certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/).\n\nWildcard-based policies in Cloudflare Access only cover the level where they are applied. Add the wildcard policy to the left-most subdomain to be covered.\n\n## How do isolation policies work together with HTTP policies?\n\nIsolation policies, like all HTTP policies, are evaluated in stages. When a user makes a request which evaluates an Isolation policy, the request will be rerouted to an isolated browser and re-evaluated for HTTP policies. This makes it possible for an isolated browser to remotely render a block page, or have malicious content within the isolated browser blocked by HTTP policies.\n\n## Why is API or CLI traffic not isolated?\n\nIsolation policies are applied to requests that include `Accept: text/html*`. This allows Browser Isolation policies to co-exist with API and command line requests.\n\n## Can Access enforce policies on a specific nonstandard port?\n\nNo. Cloudflare Access cannot enforce a policy that would contain a port appended to the URL. However, you can use Cloudflare Tunnel to point traffic to non-standard ports. For example, if Jira is available at port `8443` on your origin, you can proxy traffic to that port via Cloudflare Tunnel.\n\n## Why can I still reach domains blocked by a Gateway policy?\n\nIf the domain is blocked by a DNS, network, or HTTP policy, it may be because:\n\n* **Your policy is still being updated.** After you edit or create a policy, Cloudflare updates the new setting across all of our data centers around the world. It takes about 60 seconds for the change to propagate.\n\nIf the domain is only blocked by a DNS policy, it may be because:\n\n* **Your device is using another DNS resolver.** If you have other DNS resolvers in your DNS settings, your device could be using IP addresses for resolvers that are not part of Gateway. As a result, the domain you are trying to block is still accessible from your device. Make sure to remove all other IP addresses from your DNS settings and only include Gateway's DNS resolver IP addresses.\n\n* **Your policy is not assigned to a DNS location.** If your policy is not assigned to a DNS location and you send a DNS query from that location, Gateway will not apply that policy. Assign a policy to a DNS location to make sure the desired policy is applied when you send a DNS query from that location.\n\n* **Your DoH endpoint is not a Gateway DNS location**. Browsers can be configured to use any DoH endpoint. If you chose to configure DoH directly in your browser, make sure that the DoH endpoint is a Gateway DNS location.\n\nIf the domain is only blocked by a network policy, it may be because:\n\n* **Your browser is reusing an existing connection**. Network policies only apply when a connection is opened. If a browser is connected to a domain to be blocked by a network policy, Gateway will not block requests until the connection is closed. To block the domain, close any related tabs or restart your browser.\n\n## When does Access return a Forbidden status page versus a login page?\n\nAccess returns a Forbidden page with status codes `401`/`403` when it determines there is no way a user can pass a [policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). If Cloudflare can make a full policy determination that a user will not be able to log in, Access will return a Forbidden page instead of a [login page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/).\n\nFor example, your application has a policy that requires a user to be in a [specific geolocation](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#allow) to log in.\n\nAs admin, you could define this geolocation policy by using [Include](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#include) rules, meaning the user could log in to the application from Country A or Country B.\n\nOr you could define this geolocation policy using a [Require](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#require) rule, meaning the user must be in Country A to log in.\n\nIf a user from country C attempts to access the application, in both the Include and Require scenarios, the user will receive the Forbidden page. This is because Country C was not defined in either scenario. Therefore, Cloudflare has determined that this user cannot meet policy requirements and will receive the Forbidden status page.\n\n</page>\n\n<page>\n---\ntitle: Troubleshooting · Cloudflare One docs\ndescription: Review common troubleshooting scenarios for Cloudflare Zero Trust.\nlastUpdated: 2025-12-30T20:00:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/\n  md: https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/index.md\n---\n\n[❮ Back to FAQ](https://developers.cloudflare.com/cloudflare-one/faq/)\n\n## I tried to register the WARP client with my Zero Trust domain but received the following error messages: `Authentication Expired` and `Registration error. Please try again later`.\n\nWhen a user logs into an organization, WARP will open a web page so the user can sign in via Cloudflare Access. Access then generates a JSON Web Token (JWT) that is passed from the web page to the WARP client to authenticate the device. This JWT has a timestamp indicating the exact time it was created, as well as a timestamp indicating it will expire 50 seconds into the future.\n\nThis error message means that when the JWT is finally passed to the WARP client, it has already expired. One of two things can be happening:\n\n1. (Most likely): Your computer system clock is not properly synced using Network Time Protocol (NTP). Visit <https://time.is> on the affected machine to validate your clock is properly synchronized within 20 seconds of the actual time.\n\n2. You are waiting more than one minute to open Cloudflare WARP from the time Cloudflare Access prompts you. Open the WARP client as soon as you get the prompt.\n\n## I see a website is blocked, and it shouldn't be.\n\nIf you believe a domain has been incorrectly blocked, you can use [this form](https://radar.cloudflare.com/categorization-feedback/) to get the URL reviewed.\n\n## I see an error saying `No Access-Control-Allow-Origin header is present on the requested resource`.\n\nCloudflare Access requires that the credentials: `same-origin parameter` be added to JavaScript when using the Fetch API (to include cookies). AJAX requests fail without this parameter present. For more information, refer to our documentation about [CORS settings](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/cors/).\n\n## I see untrusted certificate warnings for every page and I am unable to browse the Internet.\n\nAdvanced security features including HTTPS traffic inspection require users to install and trust the Cloudflare root certificate on their machine or device. If you are installing certificates manually on all of your devices, these steps will need to be performed on each new device that is to be subject to HTTP Filtering. To install the Cloudflare root certificate, follow [this guide](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/).\n\n## I see error 526 when browsing to a website.\n\nGateway presents an **HTTP Response Code: 526** error page in the following cases:\n\n* **An untrusted certificate is presented from the origin to Gateway.** Gateway will consider a certificate is untrusted if any of these conditions are true:\n\n  * The server certificate issuer is unknown or is not trusted by the service.\n  * The server certificate is revoked and fails a CRL check.\n  * There is at least one expired certificate in the certificate chain for the server certificate.\n  * The common name on the certificate does not match the URL you are trying to reach.\n  * The common name on the certificate contains invalid characters (such as underscores). Gateway uses [BoringSSL](https://csrc.nist.gov/projects/cryptographic-module-validation-program/validated-modules/search?SearchMode=Basic\\&Vendor=Google\\&CertificateStatus=Active\\&ValidationYear=0) to validate certificates. Chrome's [validation logic](https://chromium.googlesource.com/chromium/src/+/refs/heads/main/net/cert/x509_certificate.cc#429) allows non-RFC 1305 compliant certificates, which is why the website may load when you turn off WARP.\n\n* **The connection from Gateway to the origin is insecure.** Gateway does not trust origins which:\n\n  * Only offer insecure cipher suites (such as RC4, RC4-MD5, or 3DES). You can use the [SSL Server Test tool](https://www.ssllabs.com/ssltest/index.html) to check which ciphers are supported by the origin.\n  * Do not support [FIPS-compliant ciphers](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#cipher-suites) (if you have enabled [FIPS compliance mode](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#fips-compliance)). In order to load the page, you can either disable FIPS mode or create a Do Not Inspect policy for this host (which has the effect of disabling FIPS compliance for this origin).\n  * Redirect all HTTPS requests to HTTP.\n\nIf none of the above scenarios apply, contact Cloudflare support with the following information:\n\n* Operating System (Windows 10, macOS 10.x, iOS 14.x)\n* Web browser (Chrome, Firefox, Safari, Edge)\n* URL of the request\n* Screenshot or copy/paste of the content from the error page\n\nFor more troubleshooting information, refer to [Support](https://developers.cloudflare.com/support/troubleshooting/http-status-codes/cloudflare-5xx-errors/error-526/).\n\n## I see an error in the Gateway Overview page, and no analytics are displayed.\n\n![An error displayed in the Gateway Overview page instead of analytics.](https://developers.cloudflare.com/_astro/gateway-dash-overview-empty.DeSvdK_m_svMSL.webp)\n\nYou may not see analytics on the Overview page for the following reasons:\n\n* **You are not sending DNS queries to Gateway**. Verify that the destination IP addresses you are sending DNS queries to are correct. You can check the destination IP addresses for your DNS location by going to **Networks** > **Resolvers & Proxies** > **DNS locations** and then expanding the location.\n* **You are using other DNS resolvers**. If you have other DNS resolvers in your DNS settings, your device could be using IP addresses for resolvers that are not part of Gateway. Make sure to remove all other IP addresses from your DNS settings and only include Gateway's DNS resolver IP addresses.\n* **The source IPv4 address for your DNS location is incorrect**. If you are using IPv4, check the source IPv4 address that you entered for the DNS location matches with the network's source IPv4 address.\n* **Analytics is not available yet**. It takes some time to generate the analytics for Cloudflare Gateway. If you are not seeing anything even after 5 minutes, file a support ticket.\n\n## I see a \"No Browsers Available\" alert.\n\nIf you encounter this error, [file feedback](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/known-limitations/) via the WARP client and we will investigate.\n\n## I see a \"Maximum Sessions Reached\" alert.\n\nThis can occur if your device is attempting to establish a connection to more than two remote browser instances. A browser isolation session is a connection from your local browser to a remote browser. Tabs and windows within the same browser share a single remote browser session. In practice, this generally means that you can open both Chrome and Firefox to use browser isolation concurrently, but attempting to open a third browser such as Opera will cause this alert to appear. To release a browser session, close all tabs/windows in your local browser. The remote browser session will be automatically terminated within 15 minutes.\n\n## I see `SAML Verify: Invalid SAML response, SAML Verify: No certificate selected to verify` when testing a SAML identity provider.\n\nThis error occurs when the identity provider has not included the signing public key in the SAML response. While not required by the SAML 2.0 specification, Cloudflare Access always checks that the public key provided matches the **Signing certificate** uploaded to Zero Trust. For the integration to work, you will need to configure your identity provider to add the public key.\n\n## I see `Error 0: Bad Request. Please create a ca for application.` when attempting to connect to SSH with a short-lived certificate.\n\nThis error will appear if a certificate has not been generated for the Access application users are attempting to connect to. For more information on how to generate a certificate for the application on the Access Service Auth SSH page, refer to [these instructions](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/short-lived-certificates-legacy/).\n\n## Mobile applications warn of an invalid certificate, even though I installed a Cloudflare certificate on my system.\n\nThese mobile applications may use certificate pinning Cloudflare Gateway dynamically generates a certificate for all encrypted connections in order to inspect the content of HTTP traffic. This certificate will not match the expected certificate by applications that use certificate pinning. To allow these applications to function normally, administrators can configure bypass rules to exempt traffic to hosts associated with the application from being intercepted and inspected.\n\n## Firefox shows a network protocol violation when I use the WARP client.\n\nIf you see this warning, you may have to disable DNS over HTTPS setting in Firefox. If you need help doing that, see [these instructions](https://support.mozilla.org/en-US/kb/firefox-dns-over-https#w_manually-enabling-and-disabling-dns-over-https).\n\n## Chrome shows `NET::ERR_CERT_AUTHORITY_INVALID` when I use the WARP client.\n\nAdvanced security features including HTTPS traffic inspection require you to deploy a [root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) on the device. If [**Install CA to system certificate store**](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/) is enabled, the WARP client will automatically install a new root certificate whenever you install or update WARP.\n\nCertain web browsers (such as Chrome and Microsoft Edge) load and cache root certificates when they start. Therefore, if you install a root certificate while the browser is already running, the browser may not detect the new certificate. To resolve the error, restart the browser.\n\n## I see `Access api error auth_domain_cannot_be_updated_dash_sso`.\n\nThis error appears if you try to change your [team domain](https://developers.cloudflare.com/cloudflare-one/faq/getting-started-faq/#whats-a-team-domainteam-name) while the [Cloudflare dashboard SSO](https://developers.cloudflare.com/fundamentals/manage-members/dashboard-sso/) feature is enabled on your account. Cloudflare dashboard SSO does not currently support team domain changes. Contact your account team for more details.\n\n## WARP on Linux shows `DNS connectivity check failed`.\n\nThis error means that the `systemd-resolved` service on Linux is not allowing WARP to resolve DNS requests. You can identify this issue in the [`daemon.log`](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/warp-logs/#warp-diag-logs) file of the `warp diag` logs, where the error message appears as `ERROR main_loop: warp::warp::connectivity_check: DNS connectivity check failed to resolve host=\"warp-svc.\"`.\n\nTo solve the issue:\n\n1. Add the following line to `/etc/systemd/resolved.conf`:",
      "language": "unknown"
    },
    {
      "code": "1. Make sure that no other DNS servers are configured in `/etc/systemd/resolved.conf`. For example, if the file contains `DNS=X.Y.Z.Q`, comment out the line.\n\n2. Restart the service:",
      "language": "unknown"
    },
    {
      "code": "## Windows incorrectly shows `No Internet access` when WARP is enabled.\n\n[NCSI](https://learn.microsoft.com/en-us/windows-server/networking/ncsi/ncsi-overview) is a Windows feature for determining network quality and connectivity. When WARP is enabled, NCSI checks can sometimes fail and cause a cosmetic UI error where the user believes they have no Internet even though the device still has full connectivity. Some apps (Outlook, JumpCloud) may refuse to connect because Windows is reporting there is no Internet connectivity.\n\nTo resolve the issue, you will need to edit two Windows registry keys:\n\n1. Configure NCSI to detect WARP's [local DNS proxy](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/warp-architecture/#dns-traffic).",
      "language": "unknown"
    },
    {
      "code": "2. Configure NCSI to use active probing mode, as WARP may be obscuring the number of hops expected by the [passive probe](https://learn.microsoft.com/en-us/windows-server/networking/ncsi/ncsi-frequently-asked-questions#how-does-passive-probing-determine-connectivity).",
      "language": "unknown"
    },
    {
      "code": "If you continue to have issues with Microsoft 365 applications, consider enabling [**Directly route Microsoft 365 traffic**](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#directly-route-microsoft-365-traffic).\n\n## I see `WebGL Rendering Error`.\n\nCloudflare Browser Isolation leverages Network Vector Rendering (NVR) technology. This allows us to deliver a secure, performant remote computing experience without the bandwidth limitations of traditional solutions. While we expect most websites to work perfectly, some browser features and web technologies such as WebGL (Web Graphics Library) are unsupported.\n\nWebGL is a JavaScript API for rendering high-performance interactive 2D and 3D graphics within any compatible web browser without the use of plug-ins. Support for WebGL is present in all modern browsers. However, the user's device must also have access to the underlying [hardware](https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API#browser_compatibility) that supports these features.\n\nWhen running remote browser isolation in a virtualized environment, the user's device may not have access to the required system resources. To resolve the error, you can configure your browser to render vector graphics entirely through software, without using the hardware acceleration provided by a GPU.\n\nTo enable software rasterization:\n\n1. Go to `chrome://flags/#override-software-rendering-list`.\n2. Set **Override software rendering list** to *Enabled*.\n3. Select **Relaunch** to apply the change.\n\n## I cannot send emails on port `25`.\n\nBy default, the WARP client blocks outgoing SMTP traffic on port `25` to prevent users from abusing our service to send spam. Modern email service providers use port `587` or `465` to encrypt emails over a TLS/SSL connection. For more information, refer to [What SMTP port should be used?](https://www.cloudflare.com/learning/email-security/smtp-port-25-587/).\n\nIf you need to unblock port `25`, contact your account team.\n\n## I see `502 Bad Gateway` when browsing to a website.\n\nThis issue can occur when communicating with an origin that partially supports HTTP/2. In these scenarios, the connection from Gateway to the website starts using HTTP/2 but requests a downgrade to HTTP/1.1 for some requests. For example, servers such as [Microsoft Internet Information Services (IIS)](https://learn.microsoft.com/iis/get-started/whats-new-in-iis-10/http2-on-iis#when-is-http2-not-supported) do not support authentication over HTTP/2. When errors occur, the website may send back a `RST_STREAM` frame with the error code `HTTP_1_1_REQUIRED`, which indicates that the browser should retry the request over HTTP/1.1. Gateway translates any received upstream `RST_STREAM` frames to a pseudo socket close, so this appears as a `502 Bad Gateway` exception page. The browser will not indicate why it failed.\n\nGateway does not support this downgrade mechanism. When receiving the `HTTP_1_1_REQUIRED` error code, Gateway will not reissue requests over HTTP/1.1. To make the connection from Gateway to the website successfully, you will need to disable HTTP/2 at the origin.\n\n## I see `This site can't provide a secure connection.`\n\nIf you see an error with the title `This site can't provide a secure connection` and a subtitle of `<hostname> uses an unsupported protocol`, you must [order an Advanced Certificate](https://developers.cloudflare.com/ssl/edge-certificates/advanced-certificate-manager/manage-certificates/#create-a-certificate).\n\nIf you added a [multi-level subdomain](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/#2a-connect-an-application) (more than one level of subdomain), you must [order an Advanced Certificate for the hostname](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/#2a-connect-an-application) as Cloudflare's Universal certificate will not cover the public hostname by default.\n\n## As of February 2, 2025, my end-user device's browser is returning a `Your connection is not private` warning.\n\n### Why am I getting this error?\n\nThe default global Cloudflare root certificate expired on 2025-02-02 at 16:05 UTC. If you installed the default Cloudflare certificate before 2024-10-17, you must [generate a new certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/#generate-a-cloudflare-root-certificate) and activate it for your Zero Trust organization to avoid inspection errors. If you did not generate a new certificate before February 2, 2025, you will encounter browser warnings like `Your connection is not private`.\n\nStarting with WARP client version 2024.12.554.0 and later, the WARP client will automatically install Cloudflare certificates in an end-user device's certificate store as soon as the Cloudflare certificates appear as **Available** in the Cloudflare dashboard.\n\nFor WARP client versions prior to 2024.12.554.0, certificates had to be marked as **In-Use** in the Cloudflare dashboard before the WARP client could push the Cloudflare certificates to an end-user device's certificate store.\n\n### What do I need to do?\n\nFor WARP client versions before and after 2024.12.554.0, certificate propagation will only occur when the WARP client is responsible for automatically installing the certificate on the client device. To enable the WARP client to propogate certificates:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices**.\n2. Select the **Management** tab.\n3. Turn on **Install CA to system certificate store**.\n\nIf **Install CA to system certificate store** is turned off, you must [manually install the certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/), use an [MDM solution](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#mobile-device-management-mdm-software) to distribute the Cloudflare certificate to your fleet of devices, or not use the Cloudflare certificate because you do not want to have TLS decryption enabled. [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/) must be enabled to enforce Gateway HTTP policies for HTTPS traffic.\n\nAfter enabling certificate propagation, you must update your certificate:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**, then select **Certificates**.\n2. Select **Generate certificate**.\n3. Select the expiration date for this new certificate (five years is the default, but this can be adjusted) and select **Generate certificate**.\n4. The new certificate will be marked **Inactive** at first. Select the **three dots** to the right of the certificate, then select **Activate** to activate the certificate.\n\nWhen you activate a certificate, WARP will download the new certificate to end-user devices.\n\nCertificate propagation to end-user devices can take up to 10 minutes, but can be expedited by resetting the encryption keys.\n\nTo reset the encryption keys:\n\n1. Open the WARP GUI on your device.\n2. Select the gear icon on the top right > **Preferences**.\n3. Select **Connection**, then select **Reset Encryption Keys**.\n\nmacOS Big Sur and newer releases do not allow WARP to automatically trust the certificate. You must either [manually trust the certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/automated-deployment/#macos) as the user or [use a MDM to trust the certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#mobile-device-management-mdm-software).\n\nAfter confirming that the certificate is installed and trusted on the end-user device, mark the certificate as **In-Use**. To mark the certificate as **In-Use**:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**, then select **Certificates**.\n2. Select a certificate.\n3. In the detailed menu under **Basic Information**, select **Confirm and turn on certificate**.\n4. Once turned on, the new certificate will now show as **In-Use** in Cloudflare One. **In-Use** indicates that the certificate is being used for inspection.\n\nIt is recommended to have end users disconnect and reconnect WARP to expedite this change being reflected on their local machine. To verify the new certificate is being used correctly:\n\n1. Connect to WARP.\n2. Visit an HTTPS site.\n3. Verify that no certificate error is enountered.\n\nAdditionally, you can check the certificate used within your browser by viewing the certificate (steps vary by browser, but you can generally do this check by selecting the lock icon next to the URL) and verifying the Organizational Unit (OU) does not reference `ECC Certificate Authority`.\n\nThe new certificate will be valid until the configured expiration date.\n\n### I followed all the instructions but I am still having problems with my certificate.\n\nIf the new certificate is not activating on the end-user device or you are getting a `Certificate is missing` warning even though the certificate is marked **In-Use**. Refer to the following troubleshooting options:\n\n1. Rotate the keys used by WARP to force activate the new certificate by running:",
      "language": "unknown"
    },
    {
      "code": "2. [Upgrade](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/update-warp/#how-to-update-warp) to WARP version 2024.12.554.0.\n\n   Some customers who are on versions earlier than 2024.11.309.0 have experienced inconsistencies with certificate installation and may need to upgrade.\n\n3. Turn off TLS Decryption.\n\nIf no measure is working quickly and you are encountering browser warnings that are blocking work, [turning off TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#turn-on-tls-decryption) will prevent HTTP policies from being enforced and will ensure websites resolve until the certificate can be deployed to more user devices.\n\nTurning off TLS decryption should be a temporary measure. TLS decryption should be turned on if you need to enforce HTTP policies and log traffic for HTTPS traffic.\n\n## I am getting an `Error 401: deleted_client - The OAuth Client was deleted` authorization error.\n\nIf you deleted the OAuth client (or the OAuth client expired) in Google, you will receive a `Error 401: deleted_client` authorization error.\n\nTo fix this issue, complete steps 6 through 12 in the [Google](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide and steps 9 through 15 in the [Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/google/#set-up-google-as-an-identity-provider) guide.\n\n## I entered an override code for WARP that was supposed to be valid for 3 hours but the override code expired faster than I expected.\n\n[Admin override codes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#allow-admin-override-codes) are time-sensitive and adhere to fixed-hour time blocks. Override codes can be reused until the end of their timeout. An override code's timeout begins in the hour the override code was generated in. Refer to the following scenarios.\n\n### Scenario one: Admin generates an override code at 9:00 AM with a timeout of one hour.\n\nIf admin generates an override code with a timeout of one hour at **9:00 AM** and the user inputs the override code in their device at **9:59 AM**, the user will be able to toggle WARP on and off until **10:59 AM** (a one hour duration.)\n\nHowever, if the user attempts to enter the override code at **10:00 AM**, the override code will not work. The override code will not work because the override code was generated at **9:00 AM** and its one hour validity was counted as used in the 9:00 AM to 10:00 AM hour.\n\n### Scenario two: Admin generates an override code at 9:30 AM with timeout of three hours.\n\nIf admin generates an override code with a timeout of three hours at **9:30 AM** and the user inputs the override code in their device at **9:59 AM**, the user will be able to toggle WARP on and off until **12:59 PM** (a three hour duration.)\n\nHowever, if the user attempts to enter the override code at **10:00 AM**, the override code will only be valid until **12:00 PM** (a two hour duration). The override code was generated at **9:30 AM** and one hour of its total three hour validity was counted as used in the 9:00 AM to 10:00 AM hour.\n\n### Scenario three: Admin generates an override code at 12:30 PM with a timeout of 24 hours.\n\nIf admin generates an override code with a timeout of 24 hours at **12:30 PM** and the user inputs the override code in their device at **12:59 PM** the same day, the user will be able to toggle WARP on and off until **12:59 PM** the next day (a 24 hour duration.)\n\nHowever, if the user attempts to enter the override code at **1:00 PM** the same day, the override code will only be valid until **11:00 AM** the next day (a 23 hour duration). The override code was generated at **12:30 PM** and one hour of its total 24 hour validity was counted as used in the 12:00 PM to 1:00 PM hour.\n\nIf the user attempts to enter the override code at **11:59 AM** the next day, the override code will only be valid until **12:59 PM** (a one hour duration). The override code was generated at **12:00 PM** and 23 hours of its total 24 hour validity were counted as used from 12:00 PM to 11:00 AM the next day (a 23 hour duration).\n\n## I disabled WARP using an override code but WARP turned on by itself before my override code expired.\n\nIf you are using an [admin override code](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#allow-admin-override-codes) with [Auto connect](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#auto-connect) also enabled, WARP will turn on automatically according to the Timeout set for **Auto connect**. Using an override code to override the WARP lock switch will not disable Auto connect. As best practice, review your Auto connect settings before sending the override code to the user.\n\nTo prevent WARP from auto connecting while using an admin override code, disable Auto connect or set a longer **Timeout** for **Auto connect**. Note the changes you make to Auto connect while the end user is using the admin override code if you need to revert these changes later.\n\n## I am getting the error `Failed to fetch user/group information from the identity provider`.\n\nThis error is returned when proper API permissions are not set up in the identity provider. When Cloudflare attempts to fetch user/group information from the identity provider and proper API permissions have not been configured, the `Failed to fetch user/group information from the identity provider` error will appear. Review the [SSO integration](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/) guide for your identity provider to ensure your application has the appropriate API permissions.\n\nFor example, [Microsoft Entra](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#2-configure-api-permissions-in-entra-id) and [Okta](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/#:~:text=\\(Optional\\)%20Create%20an%20Okta%20API%20token%20and%20enter%20it%20in%20Zero%20Trust%20\\(the%20token%20can%20be%20read%2Donly\\).%20This%20will%20prevent%20your%20Okta%20groups%20from%20failing%20if%20you%20have%20more%20than%20100%20groups) have required permissions stated in their integration guides.\n\nYou can also examine logs in your identity provider to identify any denied requests related to API access.\n\n## WSL2 is losing connectivity when using WARP.\n\nIf your WSL2 environment is losing connectivity while using WARP, check your [split tunnel configuration](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/).\n\nThe issue may arise because the IP range that the WSL environment uses to communicate with the host device is included in the split tunnel configuration. Excluding the WSL environment's IP range should restore connectivity.\n\nYou must ensure the host device is included in the WARP tunnel while excluding the WSL environment to prevent connectivity issues between WSL and the host device.\n\nTo debug this issue:\n\n1. Review the WSL2 environment's IP address and compare it with the laptop's IP.\n2. Check if the WSL network is [included in the split tunnel configuration](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#change-split-tunnels-mode).\n3. If the WSL network is included, exclude it from the split tunnel to prevent connectivity issues.\n\n## Clientless Web Isolation is loading with a blank screen on a Windows device.\n\nThis issue can occur due to a conflict between browser settings and Windows network configuration.\n\nIn Chromium-based browsers like Chrome and Edge, the **Anonymize local IPs exposed by WebRTC** flag (`chrome://flags/#enable-webrtc-hide-local-ips-with-mdns` or `edge://flags/#enable-webrtc-hide-local-ips-with-mdns`) — when set to `Enabled` or left at `Default` — hides local IP addresses by replacing them with mDNS hostnames. Multicast DNS (mDNS) hostnames rely on multicast traffic to be resolved properly on the local network.\n\nThe [Internet Group Management Protocol (IGMP)](https://www.cloudflare.com/learning/network-layer/what-is-igmp/) allows devices to join a multicasting group. On Windows, `IGMPLevel` determines whether the system participates in multicast group membership. When `IGMPLevel` is set to `0`, multicast support is disabled.\n\nTo resolve this error, review the following options:\n\n| `IGMPLevel` | **Anonymize local IPs exposed by WebRTC** setting | Result in Clientless Web Isolation |\n| - | - | - |\n| `0` (disabled) | **Enabled / Default** | ❌ Blank screen |\n| `0` (disabled) | **Disabled** | ✅ Works - browser will use local IP address |\n| `2` (enabled) | **Enabled / Default** | ✅ Works - mDNS resolves successfully |\n\n## After putting Google Workspace behind Access, I can't log in. It keeps redirecting between Access and Google without ever completing authentication.\n\nWhen you put your Google Workspace behind Access, users will not be able to log in using Google or Google Workspace as an identity provider.\n\nThis configuration creates an authentication loop. Cloudflare Access tries to authenticate the user via Google, but Google itself treats Cloudflare as its identity provider and requires authentication from Cloudflare. Since each system depends on the other to complete login first, the user is caught in an infinite redirect cycle and can never successfully authenticate.\n\n## When installing WARP on Windows, the Setup Wizard ends prematurely.\n\nThis error can occur for several reasons, including missing dependencies, like the appropriate .NET Framework version or other Dynamic Link Libraries (DLLs) such as `netstandard2.0`, required during installation.\n\nTo investigate, run the following command to generate installation logs:",
      "language": "unknown"
    },
    {
      "code": "Check the logs to verify if there are any missing DLLs (for example, `netstandard2.0`), which may point to a missing or outdated version of the .NET Framework.\n\nOne common cause is a missing or outdated version of the [.NET Framework Runtime](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/download-warp/#windows:~:text=NET%20Framework%20version-,4.7.2%20or%20later,-HD%20space). Cloudflare WARP requires a .NET Framework version of `4.7.2` or later.\n\nSome legacy Windows systems (such as Windows 10 Enterprise 1607 LTSB, which is bundled with .NET `4.6`) do not include this runtime by default and may fail during installation with a `Setup Wizard ended prematurely` error. More recent Windows versions include .NET `4.7.2` or later by default and do not encounter this error.\n\nTo fix this:\n\n1. Download and install the [.NET Framework 4.7.2 Runtime](https://dotnet.microsoft.com/en-us/download/dotnet-framework/net472) (make sure to install the **Runtime**, not the Developer Pack).\n2. Re-run the WARP installer.\n\nIf the problem continues, try running the [.NET Repair Tool](https://www.microsoft.com/en-ca/download/details.aspx?id=30135), or check which .NET versions are installed by running the following command in PowerShell:",
      "language": "unknown"
    },
    {
      "code": "## I get an `Invalid session. Please try logging in again.` error from Access when trying to log in to the Cloudflare dashboard via SSO.\n\nCloudflare Access uses a [`CF_Session` cookie](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/#access-cookies) to validate that the same browser both initiated and completed your sign-in. The `Invalid session` error means Access was unable to validate this cookie. Ensure that there is no software or firewall on your device or network that may be interfering with requests to Access.\n\n## Long-lived SSH sessions frequently disconnect.\n\nAll connections proxied through Cloudflare Gateway, including traffic to [Access for Infrastructure](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/) SSH targets, have a maximum guaranteed duration of 10 hours. It is possible for connections to last longer than 10 hours. However, if a connection is active at the time of a Gateway release, Gateway will terminate the connection 10 hours later. Releases are not scheduled and can occur multiple times a week.\n\nTo prevent long-lived SSH connections from breaking unexpectedly, we recommend terminating sessions on a predefined schedule. For example, you could set an 8-hour idle timeout so that inactive sessions automatically disconnect during off hours. To configure an idle timeout, add the `ChannelTimeout` option to either the SSH server (`/etc/ssh/sshd_config`) or client configuration file (`~/.ssh/config`):",
      "language": "unknown"
    },
    {
      "code": "Implementing [`ChannelTimeout` on the client side](https://man.openbsd.org/ssh_config#ChannelTimeout) allows users to choose a time that works for them, whereas implementing it on the [server side](https://man.openbsd.org/sshd_config#ChannelTimeout) removes the configuration burden from the end user.\n\n</page>\n\n<page>\n---\ntitle: Deploy clientless access · Cloudflare One docs\nlastUpdated: 2025-04-10T21:16:58.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/implementation-guides/clientless-access/\n  md: https://developers.cloudflare.com/cloudflare-one/implementation-guides/clientless-access/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Holistic AI security with Cloudflare One · Cloudflare One docs\nlastUpdated: 2025-09-10T20:10:57.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/implementation-guides/holistic-ai-security/\n  md: https://developers.cloudflare.com/cloudflare-one/implementation-guides/holistic-ai-security/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Replace your VPN · Cloudflare One docs\nlastUpdated: 2025-01-31T09:20:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/implementation-guides/replace-vpn/\n  md: https://developers.cloudflare.com/cloudflare-one/implementation-guides/replace-vpn/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Secure your Internet traffic and SaaS apps · Cloudflare One docs\nlastUpdated: 2025-01-31T09:20:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/implementation-guides/secure-internet-traffic/\n  md: https://developers.cloudflare.com/cloudflare-one/implementation-guides/secure-internet-traffic/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Secure Microsoft 365 email with Email security · Cloudflare One docs\nlastUpdated: 2025-10-27T15:00:52.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/implementation-guides/secure-o365-email/\n  md: https://developers.cloudflare.com/cloudflare-one/implementation-guides/secure-o365-email/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Dashboards · Cloudflare One docs\ndescription: Cloudflare One provides a catalog of saved analytics views for\n  reporting and investigation. Analytics Dashboards provide visualizations of\n  your log data.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics/index.md\n---\n\n[Cloudflare One](https://one.dash.cloudflare.com/) provides a catalog of saved analytics views for reporting and investigation. Analytics Dashboards provide visualizations of your log data.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n* [Access event analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/access/)\n* [AI prompt logs](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#log-generative-ai-prompt-content)\n* [AI security](https://developers.cloudflare.com/cloudflare-one/insights/analytics/ai-security/)\n* [Application Access Report](https://developers.cloudflare.com/cloudflare-one/insights/analytics/application-access/)\n* [Data security analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/data-analytics/)\n* [Gateway analytics (DNS, HTTP, network sessions)](https://developers.cloudflare.com/cloudflare-one/insights/analytics/gateway/)\n* [Shadow IT SaaS analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/)\n\n</page>\n\n<page>\n---\ntitle: Analytics overview · Cloudflare One docs\ndescription: The Cloudflare One Analytics overview provides a dashboard that\n  reports on how Cloudflare One is protecting your organization and networks.\n  Use this page to monitor usage and potential security concerns within your\n  organization.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/index.md\n---\n\nThe Cloudflare One Analytics overview provides a dashboard that reports on how Cloudflare One is protecting your organization and networks. Use this page to monitor usage and potential security concerns within your organization.\n\nTo view the Analytics overview, log into [Cloudflare One](https://one.dash.cloudflare.com) and go to **Overview**.\n\nThe Analytics overview includes reports and insights across the following products and categories:\n\n* [Global status](#global-status) of your Zero Trust Organization\n\n* [Access](#access)\n\n* Gateway\n\n  * [HTTP traffic](#proxy-traffic)\n  * [Network traffic](#gateway-network-requests)\n  * [DNS traffic](#dns-traffic)\n  * [Firewall policies](#gateway-insights)\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## Global status\n\nIn **Global status**, you can view a report on your organization's Cloudflare One adoption that contains the following metrics:\n\n* Access apps configured\n* Gateway HTTP policies\n* Gateway network policies\n* Gateway DNS policies\n* SaaS integrations\n* DLP profiles\n\nYou can also view a report on your [seat usage](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/) across your Zero Trust Organization that contains the following metrics:\n\n* Total seats\n* Used seats\n* Unused seats\n\n## Access\n\nIn **Access**, you can view a report on your Access configuration that contains:\n\n**Metrics:**\n\n* Total access attempts\n* Granted access\n* Denied (policy violation)\n* Active logins overtime\n* Top applications with most logins\n\n**Filters:**\n\n* Access data by country\n\n## Gateway\n\n### Proxy traffic\n\nIn **Proxy traffic**, you can view a report on your Gateway HTTP traffic that contains:\n\n**Metrics:**\n\n* Total requests overtime\n* Allowed requests\n* Blocked requests\n* Isolated requests\n* Do not inspect requests\n* Top bandwidth consumers (GB)\n* Top denied users\n\n**Filters:**\n\n* Gateway HTTP traffic data by country\n\n### Gateway (network requests)\n\nIn **Gateway (network requests)**, you can view a report on your Gateway network traffic that contains:\n\n**Metrics:**\n\n* Total sessions\n* Authenticated sessions\n* Blocked sessions\n* Audit SSH sessions\n* Allowed sessions\n* Override sessions\n* Top bandwidth consumers in GB\n* Top denied users\n\n**Filters:**\n\n* Gateway network traffic data by country\n\n### DNS traffic\n\nIn **DNS traffic**, you can view a report on your Gateway DNS traffic that contains:\n\n**Metrics:**\n\n* Total DNS queries\n* Allowed DNS queries\n* Blocked DNS queries\n* Override DNS queries\n* Safe Search DNS queries\n* Restricted DNS queries\n* Other DNS queries\n\n**Filters:**\n\n* Gateway DNS traffic by query type\n* Gateway DNS traffic by country\n\n### Gateway insights\n\nIn **Gateway insights**, you can view a report on your Gateway firewall policies that contains the following metrics:\n\n* Top domain blocking policies\n* Most user queries\n* Top devices\n* Top countries\n\n### CASB metrics\n\nIn **CASB**, you can review instances of security issues found in your SaaS integrations.\n\n* Integrations by number of findings\n* DLP findings by profile name\n\n</page>\n\n<page>\n---\ntitle: Digital experience · Cloudflare One docs\ndescription: Digital Experience Monitoring (DEX) provides visibility into\n  device, network, and application performance across your Zero Trust\n  organization.\nlastUpdated: 2025-12-15T15:28:59.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/dex/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/dex/index.md\n---\n\nDigital Experience Monitoring (DEX) provides visibility into device, network, and application performance across your Zero Trust organization.\n\nWith DEX, you can monitor the state of your [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) deployment and resolve issues impacting end-user productivity. DEX is designed for IT and security teams who need to proactively monitor and troubleshoot device and network health across distributed environments. DEX is available on all Cloudflare Zero Trust and SASE plans.\n\nRefer to [Insights overview](https://developers.cloudflare.com/cloudflare-one/insights/) to learn how to use Analytics dashboards together with [Analytics Overview](https://developers.cloudflare.com/cloudflare-one/insights/analytics-overview/) and [Digital Experience Monitoring (DEX)](https://developers.cloudflare.com/cloudflare-one/insights/dex/) for complete visibility and troubleshooting.\n\n## When a user reports a problem\n\nIf a user notifies that “the connection is not working” or “performance is slow,” DEX allows you to:\n\n* Use [device monitoring](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/) to check device health and endpoint connectivity.\n* Test network health and application responsiveness with [synthetic tests](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/).\n* Identify whether problems originate from the device (such as [issues with the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/troubleshooting/troubleshooting-guide/)), the network, or Cloudflare.\n\n## Troubleshooting other Cloudflare One features\n\nUse DEX to troubleshoot other Cloudflare One features:\n\n* Test connectivity to a [SaaS application secured with Access](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/).\n* Verify that a website routed through [Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) is reachable from user devices.\n* Confirm that users can successfully reach internal resources after configuring a [Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/).\n\n### Get started\n\nTo start using DEX for device, network, and application monitoring:\n\n1. [Create a Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/setup/#create-a-zero-trust-organization).\n2. [Install the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/) and sign in to register your device to the organization.\n3. Create [tests](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/) to verify device connectivity to applications and networks.\n4. [Monitor](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/) device and network health across your fleet using real-time and historical metrics.\n5. Run [remote captures](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/) to collect diagnostic logs and packet captures from user devices.\n6. Set up [notifications](https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/) to get alerts when degraded connectivity or application performance is detected.\n\n### Directory\n\nReview all available documentation for DEX capabilities.\n\n* [Device monitoring](https://developers.cloudflare.com/cloudflare-one/insights/dex/monitoring/)\n* [Synthetic tests](https://developers.cloudflare.com/cloudflare-one/insights/dex/tests/)\n* [Rules](https://developers.cloudflare.com/cloudflare-one/insights/dex/rules/)\n* [Remote captures](https://developers.cloudflare.com/cloudflare-one/insights/dex/remote-captures/)\n* [Notifications](https://developers.cloudflare.com/cloudflare-one/insights/dex/notifications/)\n* [IP visibility](https://developers.cloudflare.com/cloudflare-one/insights/dex/ip-visibility/)\n* [DEX MCP server](https://developers.cloudflare.com/cloudflare-one/insights/dex/dex-mcp-server/)\n* [MCP server](https://github.com/cloudflare/mcp-server-cloudflare/tree/main/apps/dex-analysis)\n\n</page>\n\n<page>\n---\ntitle: Zero Trust logs · Cloudflare One docs\ndescription: Review detailed logs for your Zero Trust organization.\nlastUpdated: 2025-06-23T13:26:23.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/logs/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/logs/index.md\n---\n\nReview detailed logs for your Zero Trust organization.\n\n* [Access audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/)\n* [Enable Email security logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/enable-logs/)\n* [Filter different views](https://developers.cloudflare.com/cloudflare-one/insights/logs/filter-views/)\n* [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/)\n* [SCIM activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/scim-logs/)\n* [Tunnel audit logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/tunnel-audit-logs/)\n* [Posture logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/posture-logs/)\n* [Logpush integration](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/)\n* [Use Logpush with IDS](https://developers.cloudflare.com/cloudflare-one/insights/logs/use-logpush-with-ids/)\n\n## Log retention\n\nCloudflare Zero Trust logs are stored for a varying period of time based on the service used and plan type:\n\n| | Free | Standard | Access | Gateway | Enterprise |\n| - | - | - | - | - | - |\n| **Admin logs** | 18 months | 18 months | 18 months | 18 months | 18 months |\n| **Access logs** | 24 hours | 30 days | 30 days | 24 hours | 180 days |\n| **DNS logs** | 24 hours | 30 days | 24 hours | 30 days | 180 days[1](#user-content-fn-1) |\n| **Network logs** | 24 hours | 30 days | 24 hours | 30 days | 30 days |\n| **HTTP logs** | 24 hours | 30 days | 24 hours | 30 days | 30 days |\n| **DEX logs** | 7 days | 7 days | 7 days | 7 days | 7 days |\n| **Device posture logs** | 30 days | 30 days | 30 days | 30 days | 30 days |\n\n## Log Explorer Beta\n\nLog Explorer users can store Zero Trust logs directly within Cloudflare in an [R2 bucket](https://developers.cloudflare.com/r2/) and access them with the dashboard or API. Log Explorer supports the following Zero Trust datasets:\n\n* [Access requests](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/access_requests/) (`FROM access_requests`)\n* [CASB Findings](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/casb_findings/) (`FROM casb_findings`)\n* [Device posture results](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/device_posture_results/) (`FROM device_posture_results`)\n* [Gateway DNS](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_dns/) (`FROM gateway_dns`)\n* [Gateway HTTP](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_http/) (`FROM gateway_http`)\n* [Gateway Network](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/gateway_network/) (`FROM gateway_network`)\n* [Zero Trust Network Session Logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/) (`FROM zero_trust_network_sessions`)\n\nFor more information, refer to [Log Explorer](https://developers.cloudflare.com/log-explorer/).\n\n## Customer Metadata Boundary\n\nCloudflare Zero Trust can be used with the Data Localization Suite to ensure that data storage is restricted to a specific geographic region. For more information refer to [Customer Metadata Boundary](https://developers.cloudflare.com/data-localization/metadata-boundary/).\n\n## Data privacy\n\nFor more information on how we use this data, refer to our [Privacy Policy](https://www.cloudflare.com/application/privacypolicy/).\n\n## Footnotes\n\n1. Enterprise users on per query plans cannot store DNS logs via Cloudflare. You can still export logs via [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/). For more information, contact your account team. [↩](#user-content-fnref-1)\n\n</page>\n\n<page>\n---\ntitle: Network visibility · Cloudflare One docs\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/\n  md: https://developers.cloudflare.com/cloudflare-one/insights/network-visibility/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Cloud and SaaS integrations · Cloudflare One docs\ndescription: You can integrate cloud environments and SaaS applications with\n  Cloudflare CASB. Once you have added an integration, you can view and manage\n  findings.\nlastUpdated: 2025-10-24T15:44:40.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/index.md\n---\n\nYou can integrate cloud environments and SaaS applications with [Cloudflare CASB](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/). Once you have added an integration, you can [view and manage findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/).\n\nSupported integrations include:\n\n* [Anthropic](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/anthropic/)\n\n* [Atlassian Confluence](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-confluence/)\n\n* [Atlassian Jira](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/atlassian-jira/)\n\n* [Amazon Web Services (AWS) S3](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/aws-s3/)\n\n* [Bitbucket Cloud](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/bitbucket-cloud/)\n\n* [Box](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/box/)\n\n* [Dropbox](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/dropbox/)\n\n* [Google Cloud Platform (GCP) Cloud Storage](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/gcp-cloud-storage/)\n\n* [GitHub](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/github/)\n\n* [Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/)\n\n  * [Gmail](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gmail/)\n  * [Google Admin](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-admin/)\n  * [Google Calendar](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-calendar/)\n  * [Google Drive](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-drive/)\n  * [Google Admin (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-admin-fedramp/)\n  * [Google Calendar (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-calendar-fedramp/)\n  * [Google Drive (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/google-drive-fedramp/)\n  * [Gemini for Google Workspace](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gemini/)\n  * [Gmail (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/google-workspace/gmail-fedramp/)\n\n* [Microsoft 365](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/)\n\n  * [Admin Center](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/admin-center/)\n  * [OneDrive](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/onedrive/)\n  * [Outlook](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/outlook/)\n  * [SharePoint](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/sharepoint/)\n  * [Admin Center (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/admin-center-fedramp/)\n  * [OneDrive (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/onedrive-fedramp/)\n  * [Outlook (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/outlook-fedramp/)\n  * [SharePoint (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/microsoft-365/sharepoint-fedramp/)\n\n* [OpenAI](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/openai/)\n\n* [Salesforce (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce-fedramp/)\n\n* [Salesforce](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/salesforce/)\n\n* [ServiceNow (FedRAMP)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow-fedramp/)\n\n* [ServiceNow](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/servicenow/)\n\n* [Slack](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/slack/)\n\n* [Troubleshooting](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/)\n\n  * [Troubleshoot integrations](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/troubleshoot-integrations/)\n  * [Troubleshoot compute accounts](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/troubleshooting/troubleshoot-compute-accounts/)\n\n</page>\n\n<page>\n---\ntitle: Identity providers · Cloudflare One docs\ndescription: Cloudflare One integrates with your organization's identity\n  provider to apply Cloudflare One and Secure Web Gateway policies. If you work\n  with partners, contractors, or other organizations, you can integrate multiple\n  identity providers simultaneously.\nlastUpdated: 2025-10-27T17:49:51.000Z\nchatbotDeprioritize: false\ntags: SSO\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/index.md\n---\n\nCloudflare One integrates with your organization's identity provider to apply Cloudflare One and Secure Web Gateway policies. If you work with partners, contractors, or other organizations, you can integrate multiple identity providers simultaneously.\n\nAs an alternative to configuring an identity provider, Cloudflare One can send a [one-time PIN (OTP)](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/one-time-pin/) to approved email addresses. No configuration needed — simply add a user's email address to an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) and to the group that allows your team to reach the application. You can simultaneously configure an OTP and an identity provider to allow users to use their own authentication method.\n\nAdding an identity provider as a login method requires configuration both in [Cloudflare One](https://one.dash.cloudflare.com) and with the identity provider itself. Consult our IdP-specific documentation to learn more about what you need to set up.\n\nNote\n\nCloudflare One supports social identity providers that do not require administrator accounts, open source providers, and corporate providers. Cloudflare also supports using signed AuthN requests with SAML providers.\n\n## Set up IdPs in Cloudflare One\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Integrations** > **Identity providers**.\n\n  2. In the **Your identity providers** card, select **Add new identity provider**.\n\n  3. Select the identity provider you want to add.\n\n     If you do not see your identity provider listed, these providers can typically still be enabled. If they support OIDC or OAuth, select the [generic OIDC](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/) option. If they support SAML, select the [generic SAML](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/) option. Cloudflare supports all SAML and OIDC providers and can integrate with the majority of OAuth providers. If your provider supports both SAML and OIDC, we recommend OIDC for ease of configuration.\n\n  4. Fill in the necessary fields to set up your identity provider.\n\n     Each identity provider will have different required fields for you to fill in. Step-by-step instructions are shown in the dashboard side panel. Alternatively, refer to the [IdP-specific documentation](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/).\n\n  5. Once you have filled in the necessary fields, select **Save**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Access: Organizations, Identity Providers, and Groups Write`\n\n  2. Add an identity provider to Cloudflare One using the [`cloudflare_zero_trust_access_identity_provider`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_access_identity_provider) resource. For example, to add a Microsoft Entra ID integration:",
      "language": "unknown"
    },
    {
      "code": "Each identity provider integration has different required attributes. You will need to obtain these attribute values from your identity provider. For more information, refer to the [IdP-specific documentation](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/).\n\n     If you do not see your identity provider listed, these providers can typically still be enabled. If they support OIDC or OAuth, use the [generic OIDC](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-oidc/) option. If they support SAML, use the [generic SAML](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/) option. Cloudflare supports all SAML and OIDC providers and can integrate with the majority of OAuth providers. If your provider supports both SAML and OIDC, we recommend OIDC for ease of configuration.\n\nYour IdP will now be listed in the **Login methods** card.\n\n## Test IdPs in Cloudflare One\n\nTo test if an IdP is correctly configured:\n\n1. Go to **Integrations** > **Identity providers**.\n2. Select **Test** next to the IdP you would like to test. This will attempt to connect to the IdP to verify if a valid connection is established.\n\n### Your provider is connected\n\nIf your provider is connected, another window will open in your browser, with this message:\n\n![\"Your connection works!\" message displayed for a successful IdP test](https://developers.cloudflare.com/_astro/connected-idp.Dc_ZasM0_1Amy4H.webp)\n\n### Your provider is not connected\n\nIf your provider is not connected, another window will open in your browser. Along with an error message, you will receive a detailed explanation of why the test has failed.\n\n## Use The API\n\nWe recommend that you use our dashboard to configure your identity providers. However, if you would like to use the [Cloudflare API](https://api.cloudflare.com/), each of the identity provider topics covered here include an example API configuration snippet as well.\n\n</page>\n\n<page>\n---\ntitle: Service providers · Cloudflare One docs\ndescription: Service-to-service integrations allow the WARP client to get device\n  posture data from a third-party API. To use this feature, you must deploy the\n  WARP client to your devices and enable the desired posture checks.\nlastUpdated: 2025-10-23T02:03:04.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/\n  md: https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/index.md\n---\n\nService-to-service integrations allow the WARP client to get device posture data from a third-party API. To use this feature, you must [deploy the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) to your devices and enable the desired posture checks.\n\n## Supported WARP modes\n\n* Gateway with WARP\n* Secure Web Gateway without DNS filtering\n* Device Information Only\n\n## Supported operating systems\n\n| Device posture check | macOS | Windows | Linux | iOS | Android/ChromeOS |\n| - | - | - | - | - | - |\n| [Custom integration](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/custom/) | ✅ | ✅ | ✅ | ✅ | ✅ |\n| [Crowdstrike](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/crowdstrike/) | ✅ | ✅ | ✅ | ❌ | ❌ |\n| [Kolide](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/kolide/) | ✅ | ✅ | ✅ | ❌ | ❌ |\n| [Microsoft Endpoint Manager](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/microsoft/) | ✅ | ✅ | ❌ | ❌ | ❌ |\n| [SentinelOne](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/sentinelone/) | ✅ | ✅ | ❌ | ❌ | ❌ |\n| [Tanium](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/taniums2s/) | ✅ | ✅ | ✅ | ❌ | ❌ |\n| [Uptycs](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/uptycs/) | ✅ | ✅ | ✅ | ❌ | ❌ |\n| [Workspace ONE](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/workspace-one/) | ✅ | ✅ | ✅ | ❌ | ❌ |\n\n</page>\n\n<page>\n---\ntitle: Connectors · Cloudflare One docs\nlastUpdated: 2025-10-21T14:33:19.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/connectors/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/connectors/index.md\n---\n\n* [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/)\n* [WAN Connectors](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/)\n\n</page>\n\n<page>\n---\ntitle: Resolvers and proxies · Cloudflare One docs\nlastUpdated: 2025-12-23T16:56:01.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/index.md\n---\n\n* [DNS](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/)\n* [Proxy endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)\n\n</page>\n\n<page>\n---\ntitle: Add routes · Cloudflare One docs\ndescription: A route maps an IP address or hostname to a Cloudflare One\n  connector installed on your private network. When a user connects to that IP\n  or hostname through Cloudflare's network, Cloudflare will route their traffic\n  down a secure tunnel to the corresponding resource in your private network.\nlastUpdated: 2025-12-23T16:56:01.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/networks/routes/\n  md: https://developers.cloudflare.com/cloudflare-one/networks/routes/index.md\n---\n\nA route maps an IP address or hostname to a [Cloudflare One connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/#connectors) installed on your private network. When a user connects to that IP or hostname through Cloudflare's network, Cloudflare will route their traffic down a secure tunnel to the corresponding resource in your private network.\n\n## Add a CIDR route\n\nCIDR routes define the IP network segments (such as `10.0.0.0/24`) that are reachable via a Cloudflare Tunnel.\n\nPrerequisites\n\nBefore you add a CIDR route, ensure you have created a Cloudflare Tunnel using [`cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/) or [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/site-to-site/).\n\nTo add a CIDR route:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Routes** > **CIDR**.\n\n2. Select **Add CIDR route**.\n\n3. In **CIDR**, enter the IP address or CIDR range that you wish to route through the tunnel (for example, `10.0.0.1` or `10.0.0.0/24`). This can be a private or public IP.\n\n4. For **Tunnel**, select the Cloudflare Tunnel that is being used to connect your private network to Cloudflare.\n\n5. (Optional) Under **Additional settings**, select a [virtual network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) for this tunnel route. This step is only needed if the route's IP/CIDR range overlaps with another route in your account. If you do not select a virtual network, the IP route will be assigned to the `default` network.\n\n   Note\n\n   Virtual networks are only supported for `cloudflared` tunnels.\n\n6. Select **Create**.\n\nCloudflare will now route requests to your private network. However, the route does not automatically capture traffic from end users. To enable client-side connectivity, refer to the [cloudflared](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/) or [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/site-to-site/) setup guides.\n\n## Add a hostname route\n\nHostname routes steer traffic for a public or private hostname down a Cloudflare Tunnel. This allows users to access internal resources using familiar URLs (such as `wiki.internal.local`) rather than IP addresses.\n\nPrerequisites\n\nBefore you add a hostname route, ensure you have created a Cloudflare Tunnel using [`cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/).\n\nTo add a hostname route:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Routes** > **Hostname routes**.\n2. Select **Create hostname route**.\n3. In **Hostname**, enter the private or public hostname that represents your application (for example, `wiki.internal.local` or `app.bank.com`).\n4. For **Tunnel**, select the Cloudflare Tunnel that is being used to connect your private network to Cloudflare.\n5. Select **Create**.\n\nCloudflare will now route requests to your private network. However, the route does not automatically capture traffic from end users. To enable client-side connectivity, refer to the [private hostname](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-private-hostname/) or [public hostname](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/egress-cloudflared/#3-route-network-traffic-through-warp) setup guides.\n\n## Add a published application route\n\nPublished application routes expose applications to the Internet via a domain that you have connected to Cloudflare. This allows users to access your applications without needing a VPN or specialized client software.\n\nPrerequisites\n\nBefore you publish an application, ensure you have:\n\n* [Created a Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/get-started/create-remote-tunnel/) using `cloudflared`.\n* [Added a website to Cloudflare](https://developers.cloudflare.com/fundamentals/manage-domains/add-site/).\n\nTo add a published application route to an existing tunnel:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Networks** > **Tunnels**.\n\n2. Select your tunnel and select **Edit**.\n\n3. Go to the **Published application routes** tab and select **Add a published application route**.\n\n4. Enter a subdomain and select a **Domain** from the drop-down menu. Specify any subdomain or path information.\n\n   Note\n\n   If you add a multi-level subdomain (more than one level of subdomain), you must [order an Advanced Certificate for the hostname](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#i-see-this-site-cant-provide-a-secure-connection).\n\n5. Under **Service**, choose a [service type](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/routing-to-tunnel/protocols/) and specify its URL. For example:\n\n   * **Type**: *HTTP*\n   * **URL**: `localhost:8000`\n\n6. Under **Additional application settings**, specify any [parameters](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/cloudflared-parameters/origin-parameters/) you would like to add to your tunnel configuration.\n\n7. Select **Save**.\n\nAnyone on the Internet can now access the application at the specified hostname. To allow or block specific users, [create an Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/).\n\n## Add a WAN route\n\nWAN routes define the IP network segments (such as `10.0.0.0/24`) that are reachable via a GRE or IPsec tunnel. To add a WAN route, refer to the [WAN Connectors documentation](https://developers.cloudflare.com/cloudflare-one/networks/connectors/wan-tunnels/configuration/manually/how-to/configure-routes/).\n\n</page>\n\n<page>\n---\ntitle: Accessibility · Cloudflare One docs\ndescription: Browser Isolation offers features to support users who have visual\n  impairments or non-English language requirements.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/accessibility/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/accessibility/index.md\n---\n\nBrowser Isolation offers features to support users who have visual impairments or non-English language requirements.\n\n## Screen reader\n\nThe isolated browser has a built-in screen reader which speaks out loud the content of the isolated page.\n\n### Turn the screen reader on or off\n\nTo turn the built-in screen reader on or off, right-click on any isolated page and select **Accessibility** > **Enable** / **Disable screen reader**.\n\nAlternatively, to use a keyboard shortcut, press `CTRL + ALT + Z`.\n\n## Languages\n\nThe isolated browser supports keyboard inputs in all languages. Users can use their native keyboard to type in languages that use diacritics (for example, `á` or`ç`) or character-based scripts (for example, Chinese, Japanese, or Korean).\n\n</page>\n\n<page>\n---\ntitle: Extensions · Cloudflare One docs\ndescription: Browser Isolation supports running native Chromium Web Extensions\n  in the remote browser.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/extensions/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/extensions/index.md\n---\n\nBrowser Isolation supports running native Chromium Web Extensions in the remote browser.\n\nThis capability allows extending tools that require DOM access (such as password managers and ad blockers) to isolated pages.\n\n## Install an extension inside the remote browser\n\n### Prerequisite: Isolate Chrome Web Store\n\nNote\n\nThis step is not required when browsing via Clientless Web Isolation. You can access the Chrome Web Store at `https://<authdomain>.cloudflareaccess.com/browser/https://chromewebstore.google.com/`.\n\nInstalling extensions requires Chrome Web Store isolation. Create an [HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to isolate the Chrome Web Store (chromewebstore.google.com).\n\n### Install an extension\n\n1. Go to `https://chromewebstore.google.com/` while isolated.\n2. Choose your desired extension.\n3. Select **Add to Chrome**. To confirm extension installation, select **Add extension**.\n\nRemote browser extensions are automatically reinstalled across isolated sessions.\n\n## Remove an extension from the remote browser\n\n1. Go to any isolated webpage.\n2. Right-click anywhere to open the context menu and select **Show isolation toolbar**.\n3. Select the jigsaw icon in the isolation toolbar to open the extension manager.\n4. Select the hamburger icon for the desired extension to open the extension controls.\n5. Select **Remove from Chromium**. To confirm removal, select **Remove**.\n\n## Useful extensions\n\n### Modify remote browser user agent\n\n[User-Agent Switcher for Chrome](https://chromewebstore.google.com/detail/user-agent-switcher-for-c/djflhoibgkdhkhhcedjiklpkjnoahfmg) enables controlling the User Agent sent from the remote browser to an isolated website.\n\n### Control remote browser request headers\n\n[ModHeader](https://chromewebstore.google.com/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj) enables controlling arbitrary request headers sent from the remote browser to an isolated website.\n\n</page>\n\n<page>\n---\ntitle: Isolation policies · Cloudflare One docs\ndescription: With Browser Isolation, you can define policies to dynamically\n  isolate websites based on identity, security threats, or content.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/index.md\n---\n\nWith Browser Isolation, you can define policies to dynamically isolate websites based on identity, security threats, or content.\n\n## Isolate\n\nWhen an HTTP policy applies the Isolate action, the user's web browser is transparently served an HTML compatible remote browser client. Isolation policies can be applied to requests that include `Accept: text/html*`. This allows Browser Isolation policies to co-exist with API traffic.\n\nThe following example enables isolation for all web traffic:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Host | matches regex | `.*` | Isolate |\n\nIf instead you need to isolate specific pages, you can list the domains for which you would like to isolate traffic:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Domain | In | `example.com`, `example.net` | Isolate |\n\nIsolate identity providers for applications\n\nExisting cookies and sessions from non-isolated browsing are not sent to the remote browser. Websites that implement single sign-on using third-party cookies will also need to be isolated.\n\nFor example, if `example.com` authenticates using Google Workspace, you will also need to isolate the top level [Google Workspace URLs](https://support.google.com/a/answer/9012184).\n\n## Do Not Isolate\n\nYou can choose to disable isolation for certain destinations or categories. The following configuration disables isolation for traffic directed to `example.com`:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Host | In | `example.com` | Do Not Isolate |\n\n## Policy settings\n\nThe following optional settings appear in the Gateway HTTP policy builder when you select the *Isolate* action. Configure these settings to [prevent data loss](https://blog.cloudflare.com/data-protection-browser/) when users interact with untrusted websites in the remote browser.\n\n### Copy (from remote to client)",
      "language": "unknown"
    },
    {
      "code": "* *Allow*: (Default) Users can copy content from an isolated website to their local clipboard.\n* *Allow only within isolated browser*: Users can only copy content from an isolated website to the remote clipboard. Users cannot copy content out of the remote browser to the local clipboard. You can use this setting alongside [**Paste (from client to remote)**: *Allow only within isolated browser*](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#paste-from-client-to-remote) to only allow copy-pasting between isolated websites.\n* *Do not allow*: Prohibits users from copying content from an isolated website.\n\n### Paste (from client to remote)",
      "language": "unknown"
    },
    {
      "code": "* *Allow*: (Default) Users can paste content from their local clipboard to an isolated website.\n* *Allow only within isolated browser*: Users can only paste content from the remote clipboard to an isolated website. Users cannot paste content from their local clipboard to the remote browser. You can use this setting alongside [**Copy (from remote to client)**: *Allow only within isolated browser*](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#copy-from-remote-to-client) to only allow copy-pasting between isolated websites.\n* *Do not allow*: Prohibits users from pasting content into an isolated website.\n\n### File downloads\n\n* *Allow*: (Default) User can download files from an isolated website to their local machine.\n* *Do not allow*: Prohibits users from downloading files from an isolated website to their local machine.\n* *View in remote browser*: Users can open and view files in an isolated environment.\n\nNote\n\nThis option does not prevent files from being downloaded into the remote browser. To prevent files being downloaded into the remote browser, use HTTP Policies to block by [Download Mime Type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#download-and-upload-mime-type).\n\n### File uploads\n\n* *Allow*: (Default) Users can upload files from their local machine into an isolated website.\n* *Do not allow*: Prohibits users from uploading files from their local machine into an isolated website.\n\nNote\n\nThis option does not prevent files being uploaded to websites from third-party cloud file managers or files downloaded into the remote browser download bar from other isolated websites. To prevent files being uploaded from the remote browser into an isolated website, use HTTP Policies to block by [Upload Mime Type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#download-and-upload-mime-type).\n\n### Keyboard\n\n* *Allow*: (Default) Users can perform keyboard inputs into an isolated website.\n* *Do not allow*: Prohibits users from performing keyboard inputs into an isolated website.\n\nNote\n\nMouse input remains available to allow users to browse a website by following hyperlinks and scrolling. This does not prevent user input into third-party virtual keyboards within an isolated website.\n\n### Printing\n\n* *Allow*: (Default) Users can print isolated web pages to their local machine.\n* *Do not allow*: Prohibits users from printing isolated web pages to their local machine.\n\n## Custom block dialog Beta\n\nWith custom block dialogs, you can host a custom block page when users are blocked from taking specific actions, like [copying](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#copy-from-remote-to-client), [pasting](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#paste-from-client-to-remote), [downloading](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#file-downloads), [uploading](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#file-uploads), [performing keyboard inputs](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#keyboard), or [printing](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#printing), within an isolated browser session.\n\nAdministrators can configure custom block dialogs to explain the reason for the block, and guide the users on how to resolve their issue using the provided query parameters:\n\n* `action`: copy, paste, download, upload, perform keyboard inputs, and print\n* `cf_colo`: for example, `sea01`\n* `client_url`: for example, `https://example.com`\n* `policy_id`: 32-character id\n* `rbi_debug_id`: 32-character id\n* `user_id`: 32-character id\n\nCustom block dialogs are still in beta. Contact your account team to start using custom block dialogs.\n\n## Common policies\n\n### Isolate all security threats\n\nIsolate security threats such as malware and phishing.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Security Categories | in | *All security risks* | Isolate |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Isolate high risk content\n\nIsolate high risk content categories such as newly registered domains.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *Security Risks* | Isolate |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Isolate news and media\n\nIsolate news and media sites, which are targets for malvertising attacks.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | in | *News and Media* | Isolate |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Isolate uncategorized content\n\nIsolate content that has not been categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/).\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Content Categories | not in | *All content categories* | Isolate |\n\n* API",
      "language": "unknown"
    },
    {
      "code": "### Isolate ChatGPT\n\nIsolate the use of ChatGPT.\n\n* Dashboard\n\n  | Selector | Operator | Value | Action |\n  | - | - | - | - |\n  | Application | in | *ChatGPT* | Isolate |\n\n  In **Configure policy settings**, you can customize restrictions for ChatGPT. For example, to prevent your users from inputting sensitive information, you can select **Disable copy / paste** and **Disable file uploads**.\n\n* API",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Known limitations - Browser Isolation · Cloudflare One docs\ndescription: Below, you will find information regarding the current limitations\n  for Browser Isolation.\nlastUpdated: 2025-12-19T16:25:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/known-limitations/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/known-limitations/index.md\n---\n\nBelow, you will find information regarding the current limitations for Browser Isolation.\n\n## Website compatibility\n\nOur Network Vector Rendering (NVR) technology allows us to deliver a secure remote computing experience without the bandwidth limitations of video streams. While we expect most websites to work perfectly, some browser features and web technologies are unsupported and will be implemented in the future:\n\n* Webcam and microphone support is unavailable.\n* Websites that use WebGL may not function. To turn off WebGL in the browser, refer to [WebGL Rendering Error](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#i-see-webgl-rendering-error).\n* Netflix and Spotify Web Player are unavailable.\n* H.265/HEVC is not a supported video format at this time.\n\n## Browser compatibility\n\n| Browser | Compatibility |\n| - | - |\n| Google Chrome | ✅ |\n| Mozilla Firefox | ✅ |\n| Safari | ✅ |\n| Microsoft Edge (Chromium-based) | ✅ |\n| Other Chromium-based browsers (Opera, Brave) | ✅ |\n| Internet Explorer 11 and below | ❌ |\n\n### Brave\n\nBrave's WebRTC IP Handling Policy can impact how Cloudflare RBI loads and functions. If the WebRTC IP Handling Policy is configured to **Disable Non-Proxied UDP**, RBI may fail to load correctly.\n\nTo ensure RBI loads correctly, go to `brave://settings/privacy` in your Brave browser window, find **WebRTC IP Handling Policy**, and change the setting from **Disable Non-Proxied UDP** to one of the following:\n\n* **Default**\n* **Default Public and Private Interfaces**\n* **Default Public Interface Only**\n\n## Protocol support\n\nBrowser Isolation does not support HTTP.\n\n## Virtual machines\n\nBrowser Isolation is not supported in virtualized environments (VMs).\n\n## Gateway selectors\n\nCertain selectors for Gateway HTTP policies bypass Browser Isolation, including:\n\n* [Destination Continent IP Geolocation](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#destination-continent)\n* [Destination Country IP Geolocation](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#destination-country)\n* [Destination IP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#destination-ip)\n\nYou cannot use these selectors to isolate traffic and isolation matches for these selectors will not appear in your Gateway logs. Additionally, you cannot apply other policies based on these selectors while in isolation. For example, if you have a Block policy that matches traffic based on destination IP, Gateway will not block the matching traffic if it is already isolated by an Isolate policy.\n\n## File download size\n\nWhen a user downloads a file within the remote browser, the file is held in memory and destroyed at the end of the remote browser session. Therefore, the total size of files downloaded per session is shared with the amount of memory available to the remote browser. We recommend a maximum individual file size of 512 MB.\n\n## Multifactor authentication\n\n[Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) does not support Yubikey or WebAuthN. These authentication technologies require the isolated website to use the same domain name as the non-isolated website. Therefore, they will not work with prefixed Clientless Web Isolation URLs but will work normally for [in-line deployments](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/) such as [isolated Access applications](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/).\n\n## SAML applications\n\nCloudflare Remote Browser Isolation now [supports SAML applications that use HTTP-POST bindings](https://developers.cloudflare.com/cloudflare-one/changelog/browser-isolation/#2025-05-13). This resolves previous issues such as `405` errors and login loops during SSO authentication flows.\n\nYou no longer need to isolate both the Identity Provider (IdP) and Service Provider (SP), or switch to HTTP-Redirect bindings, to use Browser Isolation with POST-based SSO. Users can log in to internal or SaaS applications in the isolated browser securely and seamlessly.\n\n[Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) may still be preferred in some deployment models. Clientless Web Isolation implicitly isolates all traffic (both IdP and SP) and supports HTTP-POST SAML bindings.\n\n## Browser Isolation is not compatible with private apps on non-`443` ports\n\nBrowser Isolation is not compatible with [self-hosted private applications](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/self-hosted-private-app/) that use private IPs or hostnames on ports other than `443`. Trying to access self-hosted applications on non-`443` ports will result in a Gateway block page.\n\nTo use Browser Isolation for an application on a private IP address with a non-`443` port, configure a [private network application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/legacy-private-network-app/) instead.\n\n</page>\n\n<page>\n---\ntitle: Browser Isolation with firewall · Cloudflare One docs\ndescription: If your organization uses a firewall or other policies to restrict\n  Internet traffic, you may need to make a few changes to allow Browser\n  Isolation to connect.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/network-dependencies/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/network-dependencies/index.md\n---\n\nIf your organization uses a firewall or other policies to restrict Internet traffic, you may need to make a few changes to allow Browser Isolation to connect.\n\n## Remoting client\n\nIsolated pages are served by the remoting client. This client communicates to Cloudflare's network via HTTPS and WebRTC.\n\n### Remoting Client (Services)\n\nThe remoting client provides static assets and API endpoints. For Browser Isolation to function, you must allow:\n\n* HTTPS traffic to `*.browser.run` on port `443`\n\n#### Clientless Web Isolation\n\nUsers connecting through Clientless Web Isolation also require connectivity to Cloudflare Access. For users to connect to Access, you must allow:\n\n* HTTPS traffic to `https://<team-name>.cloudflareaccess.com` on port `443`\n\n### WebRTC channel\n\nBrowser Isolation uses WebRTC for low-latency communication between the local browser and the remote browser.\n\nIn order to pass WebRTC traffic, the remoting client must be able to connect to the following IP addresses:\n\n| IP range | Port range | Protocol |\n| - | - | - |\n| IPv4: `162.159.201.10 - 162.159.201.255` IPv6: `2606:4700:f2::/48` | 10000 - 59999 | UDP |\n\nEach remote browser instance is randomly assigned a port, and the port that a user is allocated to will change often and without notice.\n\nNote\n\nWebRTC traffic does not flow through proxies specified in local browser HTTP/HTTPS proxy settings. The connecting device needs to be able to directly connect to the WebRTC IP ranges.\n\n</page>\n\n<page>\n---\ntitle: Set up Browser Isolation · Cloudflare One docs\ndescription: Browser Isolation is enabled through Secure Web Gateway HTTP\n  policies. By default, no traffic is isolated until you have added an Isolate\n  policy to your HTTP policies.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/\n  md: https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/index.md\n---\n\nBrowser Isolation is enabled through [Secure Web Gateway HTTP policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/). By default, no traffic is isolated until you have added an Isolate policy to your HTTP policies.\n\n## 1. Connect devices to Cloudflare\n\nSetup instructions vary depending on how you want to connect your devices to Cloudflare. Refer to the links below to view the setup guide for each deployment option.\n\n| Connection | Mode | Description |\n| - | - | - |\n| [Gateway with WARP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/) | In-line | Apply identity-based HTTP policies to traffic proxied through the WARP client. |\n| [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/) | In-line | Apply identity-based HTTP policies to Access applications that are rendered in a remote browser. |\n| [Gateway proxy endpoint](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/non-identity/) | In-line | Apply non-identity HTTP policies to traffic forwarded to a proxy endpoint. |\n| [Magic WAN](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/non-identity/) | In-line | Apply non-identity HTTP policies to traffic connected through a GRE or IPsec tunnel. |\n| [Clientless remote browser](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) | Prefixed URL | Render web pages in a remote browser when users go to `https://<your-team-name>.cloudflareaccess.com/browser/<URL>`. |\n\n## 2. Build an Isolation policy\n\nTo configure Browser Isolation policies:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **HTTP**.\n2. Select **Add a policy** and enter a name for the policy.\n3. Use the HTTP policy [selectors](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#selectors) and [operators](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#comparison-operators) to specify the websites or content you want to isolate.\n4. For **Action**, choose either [*Isolate*](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#isolate) or [*Do not Isolate*](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#do-not-isolate).\n5. (Optional) Configure [settings](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#policy-settings) for an Isolate policy.\n6. Select **Create policy**.\n\nNext, [verify that your policy is working](#3-check-if-a-web-page-is-isolated).\n\n## 3. Check if a web page is isolated\n\nUsers can see if a webpage is isolated by using one of the following methods:\n\n* Select the padlock in the address bar and check for the presence of a Cloudflare Root CA.\n* Right-click the web page and view the context menu options.\n\n### Normal browsing\n\n* A non-Cloudflare root certificate indicates that Cloudflare did not proxy this web page.\n\n  ![Website does not present a Cloudflare root certificate](https://developers.cloudflare.com/_astro/non-cloudflare-root-ca.DUtGDw33_Z23xa2g.webp)\n\n* The right-click context menu will have all of the normal options.\n\n  ![Normal right-click menu in browser](https://developers.cloudflare.com/_astro/non-isolated-browser.B9h2hRe6_1BhOOR.webp)\n\n### Isolated browsing\n\n* A Cloudflare root certificate indicates traffic was proxied through Cloudflare Gateway.\n\n  ![Website presents a Cloudflare root certificate](https://developers.cloudflare.com/_astro/cloudflare-gateway-root-ca.DLxxnVYn_Z2qAJ1j.webp)\n\n* The right-click context menu will be simplified.\n\n  ![Simplified right-click menu in browser](https://developers.cloudflare.com/_astro/isolated-browser.CBtYLGGn_2qt5Dl.webp)\n\n#### Disconnect Browser Isolation\n\nWARP users can temporarily disable remote browsing by [disconnecting the WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-settings/#lock-warp-switch). Once WARP is disconnected, a refresh will return the non-isolated page.\n\n</page>\n\n<page>\n---\ntitle: Lists · Cloudflare One docs\ndescription: With Cloudflare One, you can create lists of URLs, hostnames, or\n  other entries to reference when creating Gateway policies or Access policies.\n  This allows you to quickly create rules that match and take actions against\n  several items at once.\nlastUpdated: 2025-10-28T13:40:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/index.md\n---\n\nWith Cloudflare One, you can create lists of URLs, hostnames, or other entries to reference when creating [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) or [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). This allows you to quickly create rules that match and take actions against several items at once.\n\nBefore creating a list, make note of the [limitations](#limitations).\n\n## List types\n\nLists can contain a single type of data each. Supported data types include:\n\n* URLs\n* Hostnames or domains\n* Serial numbers\n* User email addresses\n* IP addresses\n* Device ID numbers\n\n## Create a list from a CSV file\n\nTo test uploading CSV lists, you can download a [sample CSV file](https://developers.cloudflare.com/cloudflare-one/static/list-test.csv) of IP address ranges or copy the following into a file:",
      "language": "unknown"
    },
    {
      "code": "When you format a CSV file for upload:\n\n* Each line should be a single entry that includes a value and an optional description.\n* A header row must be present for Zero Trust to recognize descriptions.\n* Trailing whitespace characters are not allowed.\n* CRLF (Windows) and LF (Unix) line endings are valid.\n\nTo upload the list to Cloudflare One:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Reusable components** > **Lists**.\n  2. Select **Upload CSV**.\n  3. Next, specify a **List name**, enter an optional description, and choose a **List type**.\n  4. Drag and drop a file into the **CSV file** window, or select a file.\n  5. Select **Create**.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. Decode the contents of the CSV file and store it as a local value:",
      "language": "unknown"
    },
    {
      "code": "3. Create a list using the [`cloudflare_zero_trust_list`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_list) resource:",
      "language": "unknown"
    },
    {
      "code": "You can now use this list in the policy builder by choosing the *in list* operator.\n\n## Create a list manually\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Team & Resources** > **Lists**.\n  2. Select **Create manual list**.\n  3. Next, specify a **List name**, enter an optional description, and choose a **List type**.\n  4. Enter your list element manually into the **Add entry** field and select **Add**.\n  5. Select **Save**.\n\n* API",
      "language": "unknown"
    },
    {
      "code": "* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. Create a list using the [`cloudflare_zero_trust_list`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_list) resource.\n\n     Example list of IPs:",
      "language": "unknown"
    },
    {
      "code": "Example list of domains:",
      "language": "unknown"
    },
    {
      "code": "You can now use this list in the policy builder by choosing the *in list* operator.\n\n## Edit a list\n\n1. In the **Lists** page, locate the list you want to edit.\n\n2. Select **Edit**. This will allow you to:\n\n   * Edit list name and description by selecting on the three-dots menu to the right of your list's name.\n   * Delete the list by selecting the three-dots menu to the right of your list's name.\n   * Delete individual entries.\n   * Manually add entries to your list.\n\n3. Once you have edited your list, select **Save**.\n\n## Limitations\n\n### List size\n\nYour lists can include up to 1,000 entries for Standard plans and 5,000 for Enterprise plans. An uploaded CSV file must be smaller than 2 MB.\n\n### Wildcard entries\n\nHostname lists do not support wildcard entries (`*.example.com`). You will need to add domains as exact matches. Adding a wildcard to lists comprised of hostnames will return an error when you save.\n\n### Non-Latin characters\n\nGateway supports non-Latin characters by converting all domains and hostnames to [Punycode](https://www.rfc-editor.org/rfc/rfc3492.txt). Once you save a list with non-Latin characters, Gateway will display the entry as Punycode.\n\n### Duplicate entries\n\nLists cannot have duplicate entries. Because domains and hostnames are converted to [Punycode](#non-latin-characters), multiple list entries that convert to the same string will count as duplicates. For example, `éxàmple.com` converts to `xn—xmple-rqa5d.com`, so including both `éxàmple.com` and `xn—xmple-rqa5d.com` in a list will result in a duplicate error.\n\n### URL slashes\n\nGateway ignores trailing forward slashes (`/`) in URLs. For example, `https://example.com` and `https://example.com/` will count as the same URL and may return a duplicate error.\n\n### Extended email addresses\n\nExtended email addresses (also known as plus addresses) are variants of an existing email address with `+` or `.` modifiers. Many email providers, such as Gmail and Outlook, deliver emails intended for an extended address to its original address. For example, providers will deliver emails sent to `contact+123@example.com` or `con.tact@example.com` to `contact@example.com`.\n\nBy default, Gateway will either filter only exact matches or all extended variants depending on the type of policy and action used:\n\nDNS policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Block | Match exact address and all variants |\n| Override | Match exact address and all variants |\n| Safe Search | Match exact address and all variants |\n| YouTube Restricted | Match exact address and all variants |\n\nNetwork policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Audit SSH | Match exact address and all variants |\n| Block | Match exact address and all variants |\n| Network Override | Match exact address only |\n\nHTTP policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Block | Match exact address and all variants |\n| Do Not Inspect | Match exact address only |\n| Do Not Isolate | Match exact address only |\n| Do Not Scan | Match exact address only |\n| Isolate | Match exact address and all variants |\n\nOther policies\n\n| Policy type | Behavior |\n| - | - |\n| Egress policy | Match exact address only |\n| Resolver policy | Match exact address only |\n\nTo force Gateway to match all email address variants, go to **Traffic policies** > **Traffic settings** > **Policy settings** and turn on **Match extended email addresses**. This setting applies to all firewall, egress, and resolver policies.\n\n### API rate limit\n\nYou can send 600 requests to the [Gateway Lists](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/lists/) endpoint per minute. If you exceed the rate limit, Cloudflare will block subsequent requests for 120 seconds.\n\n</page>\n\n<page>\n---\ntitle: Custom pages · Cloudflare One docs\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/index.md\n---\n\n* [Block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/)\n* [App Launcher customization](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/app-launcher-customization/)\n* [Access login page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-login-page/)\n* [Access custom block pages](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/access-block-page/)\n\n</page>\n\n<page>\n---\ntitle: Packet filtering fields · Cloudflare One docs\ndescription: cf.colo.name String\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/packet-filtering-fields/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/packet-filtering-fields/index.md\n---\n\nNote\n\nSome Magic Firewall fields are available only to customers who purchased Magic Firewall's advanced features. Refer to [Magic Firewall plans](https://developers.cloudflare.com/magic-firewall/plans/) for more information.\n\n## `cf.colo.name`\n\n`cf.colo.name` String\n\nThe data center that is handling this traffic.\n\nExample value: `sfo06`\n\n***\n\n## `cf.colo.region`\n\n`cf.colo.region` String\n\nRegion of the data center that is handling this traffic.\n\nExample value: `WNAM`\n\n***\n\n## `icmp`\n\n`icmp` String\n\nThe raw ICMP packet as a list of bytes. It should be used in conjunction with the bit\\_slice function when other structured fields are lacking.\n\n***\n\n## `icmp.type`\n\n`icmp.type` Number\n\nThe [ICMP type](https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#header_type). Only applies to ICMP packets.\n\nExample value: `8`\n\n***\n\n## `icmp.code`\n\n`icmp.code` Number\n\nThe [ICMP code](https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#header_code). Only applies to ICMP packets.\n\nExample value: `2`\n\n***\n\n## `ip`\n\n`ip` String\n\nThe raw IP packet as a list of bytes. It should be used in conjunction with the bit\\_slice function when other structured fields are lacking.\n\n***\n\n## `ip.dst`\n\n`ip.dst` IP address\n\nThe destination address as specified in the IP packet.\n\nExample value: `192.0.2.2`\n\n***\n\n## `ip.dst.country`\n\n`ip.dst.country` String\n\nRepresents the 2-letter country code associated with the server IP address in [ISO 3166-1 Alpha 2](https://www.iso.org/obp/ui/#search/code/) format.\n\nExample value: `GB`\n\nFor more information on the ISO 3166-1 Alpha 2 format, refer to [ISO 3166-1 Alpha 2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) on Wikipedia.\n\n***\n\n## `ip.src.country`\n\n`ip.src.country` String\n\nRepresents the 2-letter country code associated with the client IP address in [ISO 3166-1 Alpha 2](https://www.iso.org/obp/ui/#search/code/) format.\n\nExample value: `GB`\n\nFor more information on the ISO 3166-1 Alpha 2 format, refer to [ISO 3166-1 Alpha 2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) on Wikipedia.\n\nFor Magic Firewall, the `ip.geoip.country` field (which is deprecated) will match on either source or destination address. The `ip.geoip.country` field is still available for new and existing rules, but you should use the `ip.src.country` and/or `ip.dst.country` fields instead.\n\n***\n\n## `ip.hdr_len`\n\n`ip.hdr_len` Number\n\nThe length of the IPv4 header in bytes.\n\nExample value: `5`\n\n***\n\n## `ip.len`\n\n`ip.len` Number\n\nThe length of the packet including the header.\n\nExample value: `60`\n\n***\n\n## `ip.opt.type`\n\n`ip.opt.type` Number\n\nThe first byte of [IP options field](https://en.wikipedia.org/wiki/IPv4#Options), if the options field is set.\n\nExample value: `25`\n\n***\n\n## `ip.proto`\n\n`ip.proto` String\n\nThe transport layer for the packet, if it can be determined.\n\nExample values: `icmp`, `tcp`\n\n***\n\n## `ip.src`\n\n`ip.src` IP address\n\nThe source address of the IP Packet.\n\n***\n\n## `ip.src.country`\n\n`ip.src.country` String\n\nRepresents the 2-letter country code associated with the client IP address in [ISO 3166-1 Alpha 2](https://www.iso.org/obp/ui/#search/code/) format.\n\nExample value: `GB`\n\nFor more information on the ISO 3166-1 Alpha 2 format, refer to [ISO 3166-1 Alpha 2](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) on Wikipedia.\n\n***\n\n## `ip.ttl`\n\n`ip.ttl` Number\n\nThe time-to-live of the IP Packet.\n\nExample values: `54`\n\n***\n\n## `sip`\n\n`sip` Boolean\n\nDetermines if packets are valid L7 protocol [SIP](https://datatracker.ietf.org/doc/html/rfc2543). Requires UDP packets to operate.\n\nUse a guard clause as shown below to ensure the packet is UDP (wirefilter):\n\n`ip.proto == \"udp\"`\n\n***\n\n## `tcp`\n\n`tcp` String\n\nThe raw TCP packet as a list of bytes. It should be used in conjunction with the bit\\_slice function when other structured fields are lacking.\n\n***\n\n## `tcp.flags`\n\n`tcp.flags` Number\n\nThe numeric value of the TCP flags byte.\n\n***\n\n## `tcp.flags.ack`\n\n`tcp.flags.ack` Boolean\n\nTCP acknowledgment flag.\n\n***\n\n## `tcp.flags.cwr`\n\n`tcp.flags.cwr` Boolean\n\nTCP congestion window reduced flag.\n\n***\n\n## `tcp.flags.ecn`\n\n`tcp.flags.ecn` Boolean\n\nTCP ECN-Echo flag.\n\n***\n\n## `tcp.flags.fin`\n\n`tcp.flags.fin` Boolean\n\nTCP flag indicating this is the last packet from sender.\n\n***\n\n## `tcp.flags.push`\n\n`tcp.flags.push` Boolean\n\nTCP push flag.\n\n***\n\n## `tcp.flags.reset`\n\n`tcp.flags.reset` Boolean\n\nTCP reset flag.\n\n***\n\n## `tcp.flags.syn`\n\n`tcp.flags.syn` Boolean\n\nTCP synchronize flag.\n\n***\n\n## `tcp.flags.urg`\n\n`tcp.flags.urg` Boolean\n\nTCP urgent flag.\n\n***\n\n## `tcp.srcport`\n\n`tcp.srcport` Number\n\nSource port number of the IP packet. Only applies to TCP packets.\n\n***\n\n## `tcp.dstport`\n\n`tcp.dstport` Number\n\nDestination port number of the IP packet. Only applies to TCP packets.\n\n***\n\n## `udp`\n\n`udp` String\n\nThe raw UDP packet as a list of bytes. It should be used in conjunction with the bit\\_slice function when other structured fields are lacking.\n\n***\n\n## `udp.dstport`\n\n`udp.dstport` Number\n\nDestination port number of the IP packet. Only applies to UDP packets.\n\n***\n\n## `udp.srcport`\n\n`udp.srcport` Number\n\nSource port number of the IP packet. Only applies to UDP packets.\n\n***\n\n*GeoIP is the registered trademark of MaxMind, Inc.*\n\n</page>\n\n<page>\n---\ntitle: Tags · Cloudflare One docs\ndescription: You can label an Access application with up to 25 custom tags. End\n  users can then filter the applications in their App Launcher by their tags.\nlastUpdated: 2025-10-23T22:25:50.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/tags/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/tags/index.md\n---\n\nYou can label an Access application with up to 25 custom tags. End users can then filter the applications in their [App Launcher](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/app-launcher/) by their tags.\n\n### Create a tag\n\nTo create a new tag:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Reusable components** > **Tags**.\n2. Select **Add a tag**.\n3. Enter up to 35 alphanumeric characters for the tag (for example, `Human Resources`) and select it in the dropdown menu.\n4. Select **Save**.\n\nYou can now [add this tag](#tag-an-access-application) to an Access application.\n\n### Tag an Access application\n\nTo add a tag to an existing Access application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n2. Select an application and select **Configure**.\n3. Go to **Experience settings**.\n4. In the **Tags** dropdown, select the tags that you would like to assign to this application. The tag must be [created](#create-a-tag) before you can select it in the dropdown.\n5. Select **Save application**.\n\nThe tag will now appear on the application's App Launcher tile.\n\n</page>\n\n<page>\n---\ntitle: Posture checks · Cloudflare One docs\ndescription: With Cloudflare Zero Trust, you can configure Zero Trust policies\n  that rely on additional signals from the WARP client or from third-party\n  endpoint security providers. When device posture checks are configured, users\n  can only connect to a protected application or network resource if they have a\n  managed or healthy device.\nlastUpdated: 2025-12-03T15:55:04.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/index.md\n---\n\nWith Cloudflare Zero Trust, you can configure Zero Trust policies that rely on additional signals from the WARP client or from third-party endpoint security providers. When device posture checks are configured, users can only connect to a protected application or network resource if they have a managed or healthy device.\n\n## 1. Enable device posture checks\n\nSetup instructions and requirements vary depending on the device posture attribute. Refer to the links below to view the setup guide for your provider.\n\n* [WARP client checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/) are performed by the Cloudflare WARP client.\n* [Service-to-service checks](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/) are performed by third-party device posture providers.\n* [Access integration checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/access-integrations/) are only configurable for Access applications. These attributes cannot be used in Gateway policies.\n\n## 2. Verify device posture checks\n\nBefore integrating a device posture check in a Gateway or Access policy, verify that the Pass/Fail results match your expectations. To view the latest test results for a specific device:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Devices**.\n2. Select the device.\n3. Select **View details**.\n4. Select the **Posture checks** tab.\n\n## 3. Build a device posture policy\n\nYou can now use your device posture check in an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) or a Gateway [network](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/common-policies/#enforce-device-posture) or [HTTP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/common-policies/#check-device-posture) policy. In Access, the enabled device posture attributes will appear in the list of available [selectors](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/#selectors). In Gateway, the attributes will appear when you choose the [Passed Device Posture Check](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/#device-posture) selector.\n\nGateway policy limitation\n\nGateway does not support device posture checks for the [Tanium Access integration](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/tanium/).\n\n## 4. Ensure traffic is going through WARP\n\n[WARP client](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/) and [service-to-service](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/) posture checks rely on traffic going through WARP to detect posture information for a device. In your [Split Tunnel configuration](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/), ensure that the following domains are included in WARP:\n\n* The IdP used to authenticate to Cloudflare Zero Trust if posture check is part of an Access policy.\n* `<your-team-name>.cloudflareaccess.com` if posture check is part of an Access policy.\n* The application protected by the Access or Gateway policy.\n\n## Policy enforcement rate\n\nAccess detects changes in device posture at the same rate as the [polling frequency](#polling-frequency) configured for the posture check.\n\nBecause Gateway evaluates network and HTTP policies on every request, it maintains a local cache of posture results that is only updated every five minutes. Therefore, Gateway policies are subject to an additional five-minute delay. For example, if you set your polling frequency to 10 minutes, it may take up to 15 minutes for Gateway to detect posture changes on a device.",
      "language": "unknown"
    },
    {
      "code": "Warning\n\nGateway does not terminate an [active session](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/#configure-warp-sessions-in-gateway) even if a subsequent posture check fails during that session. Gateway only evaluates posture checks at the beginning of a session, and ongoing sessions will remain uninterrupted.\n\nFor example, if you establish an SSH session based on a successful posture check, but a posture requirement fails after the session has started, the session will remain active.\n\n### Expiration\n\nBy default, the posture result on Cloudflare remains valid until it is overwritten by new data. You can specify an `expiration` time using our [API](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/methods/update/). Cloudflare recommends setting the expiration to be at least double the [polling frequency](#polling-frequency). For example, if the posture check polling frequency is set to one hour, its expiration time should be set to two hours or greater.\n\n### Polling frequency\n\n#### WARP client checks\n\nBy default, the WARP client polls the device for status changes every five minutes. To modify the polling frequency, use the API to update the [`schedule`](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/methods/update/) parameter.\n\n#### Service provider checks\n\nWhen setting up a [service-to-service integration](https://developers.cloudflare.com/cloudflare-one/integrations/service-providers/), you will choose a polling frequency to determine how often Cloudflare will query the third-party API. To set the polling frequency via the API, use the [`interval`](https://developers.cloudflare.com/api/resources/zero_trust/subresources/devices/subresources/posture/subresources/integrations/methods/edit/) parameter.\n\n</page>\n\n<page>\n---\ntitle: Define an IP list · Cloudflare One docs\ndescription: IP lists are a part of Cloudflare's custom lists. Custom lists\n  contain one or more items of the same type — IP addresses, hostnames or ASNs —\n  that you can reference in rule expressions.\nlastUpdated: 2025-11-12T10:36:20.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/reusable-components/use-rules-list/\n  md: https://developers.cloudflare.com/cloudflare-one/reusable-components/use-rules-list/index.md\n---\n\n[IP lists](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists) are a part of Cloudflare's custom lists. Custom lists contain one or more items of the same type — IP addresses, hostnames or ASNs — that you can reference in rule expressions.\n\nIP lists are defined at the account level and can be used to match against `ip.src` and `ip.dst` fields. Currently, Magic Firewall only supports IPv4 addresses in these lists, not IPv6.\n\nTo use this feature:\n\n## 1. Create a [new IP list](https://developers.cloudflare.com/api/resources/rules/subresources/lists/methods/create/).\n\nFor example:",
      "language": "unknown"
    },
    {
      "code": "## 2. Add IPs to the list\n\nNext, [create list items](https://developers.cloudflare.com/api/resources/rules/subresources/lists/subresources/items/methods/create/). This will add elements to the current list.",
      "language": "unknown"
    },
    {
      "code": "## 3. Use the list in a rule\n\nFinally, add a Magic Firewall rule referencing the list into an existing ruleset:",
      "language": "unknown"
    },
    {
      "code": "## Managed lists\n\nNote\n\nAvailable for customers with a Magic Firewall Advanced plan.\n\nYou can create rules with managed lists. Managed IP Lists are [lists of IP addresses](https://developers.cloudflare.com/waf/tools/lists/managed-lists/#managed-ip-lists) maintained by Cloudflare and updated frequently.\n\nYou can access these managed lists when you create rules with either *IP destination address* or *IP source address* in the **Field** dropdown, and *is in list* or *is not in list* in the **Operator** dropdown.\n\nFor example:\n\n| Field | Operator | Value |\n| - | - | - |\n| *IP destination address* | *is in list* | *Anonymizers* |\n\n## List types\n\n### Threat intelligence\n\nCloudflare handles millions of HTTP requests each second and blocks billions of cyber threats each day. Cloudflare uses that data to detect malicious actors on the Internet and turns that information into a list of known malicious IP addresses. Cloudflare also integrates with a number of third-party vendors to augment the coverage.\n\nThe threat intelligence feed categories are described in [Managed IP Lists](https://developers.cloudflare.com/waf/tools/lists/managed-lists/#managed-ip-lists). All of these lists are compatible with Magic Firewall.\n\n### IP lists\n\nUse [IP lists](https://developers.cloudflare.com/waf/tools/lists/custom-lists/#ip-lists) to group services in networks, like web servers, or for lists of known bad IP addresses to make managing good network endpoints easier. IP lists are helpful for users with very expansive firewall rules with many IP lists. By default, you can add up to 10,000 IPs across all lists. Refer to [Use an IP list](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/#use-an-ip-list) to check an example of how to use an IP list.\n\n### Geo-blocking\n\nGeo-blocking enables you to selectively allow or block traffic to any country. Refer to [Block a country](https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/add-rules/#block-a-country) to check an example of how to block a country.\n\n</page>\n\n<page>\n---\ntitle: Application Library · Cloudflare One docs\ndescription: \"The Application Library allows users to manage their SaaS\n  applications in Cloudflare One by consolidating views across all relevant\n  products: Gateway, Access, and Cloud Access Security Broker (CASB). The App\n  Library provides visibility and control for available applications, as well as\n  the ability to view categorized hostnames and manage configuration for Access\n  for SaaS and Gateway policies. For example, you can use the App Library to\n  review how Gateway uses specific hostnames to match against application\n  traffic.\"\nlastUpdated: 2025-10-28T17:49:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/index.md\n---\n\nThe Application Library allows users to manage their SaaS applications in Cloudflare One by consolidating views across all relevant products: [Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/), [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/), and [Cloud Access Security Broker (CASB)](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/). The App Library provides visibility and control for available applications, as well as the ability to view categorized hostnames and manage configuration for Access for SaaS and Gateway policies. For example, you can use the App Library to review how Gateway uses specific hostnames to match against application traffic.\n\nTo access the App Library in [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Application library**. Each application card will list the number of hostnames associated with the application, the supported Cloudflare One product usage, and the [app type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/#app-types).\n\nThe App Library groups [Do Not Inspect applications](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/#do-not-inspect-applications) within the corresponding application. For example, the App Library will group *Google Drive (Do Not Inspect)* under **Google Drive**. Traffic that does not match a known application will not be included in the App Library.\n\n## View application details\n\nSelect an application card to view details about the application.\n\n### Overview\n\nThe **Overview** tab shows details about an application, including:\n\n* Name\n* Shadow IT [review status](#review-applications)\n* Number of hostnames\n* [App type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/#app-types)\n* Supported Cloudflare One applications\n* Application ID for use with the API and Terraform\n\n### Findings\n\nThe **Findings** tab shows any connected [CASB integrations](https://developers.cloudflare.com/cloudflare-one/integrations/cloud-and-saas/#manage-casb-integrations) for the selected application, as well as instances of any detected [posture findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#posture-findings) and [content findings](https://developers.cloudflare.com/cloudflare-one/cloud-and-saas-findings/manage-findings/#content-findings) for each integration.\n\n### Policies\n\nThe **Policies** tab shows any [Gateway](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) and [Access for SaaS](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/saas-apps/) policies related to the selected application.\n\n### Usage\n\nThe **Usage** tab shows any logs for [Gateway traffic requests](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/), [Access authentication events](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/#authentication-logs), [Shadow IT Discovery user sessions](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/), and [generative AI prompt logs](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/logging-options/#view-prompt-logs) sent to the selected application. This section requires logs to be turned on for each feature.\n\nThe Shadow IT Discovery dashboard will provide more details for discovered applications. To access Shadow IT Discovery in [Cloudflare One](https://one.dash.cloudflare.com/), go to **Insights** > **Dashboards**, then select **Shadow IT: SaaS analytics** or **Shadow IT: Private Network analytics**.\n\n## Review applications\n\nThe App Library synchronizes application review statuses with approval statuses from the [Shadow IT Discovery SaaS analytics](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) dashboard.\n\nTo organize applications into their approval status for your organization, you can mark them as **Unreviewed** (default), **In review**, **Approved**, and **Unapproved**.\n\n| Status | API value | Description |\n| - | - | - |\n| Approved | `approved` | Applications that have been marked as sanctioned by your organization. |\n| Unapproved | `unapproved` | Applications that have been marked as unsanctioned by your organization. |\n| In review | `in review` | Applications in the process of being reviewed by your organization. |\n| Unreviewed | `unreviewed` | Unknown applications that are neither sanctioned nor being reviewed by your organization at this time. |\n\nTo set the status of an application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Applications**.\n2. Locate the card for the application.\n3. In the three-dot menu, select the option to mark your desired status.\n\nOnce you mark the status of an application, its badge will change. You can filter applications by their status to review each application in the list for your organization. The review status for an application in the App Library and Shadow IT Discovery will update within one hour.\n\nNote\n\nApproval status does not impact a user's ability to access an application. Users are allowed or blocked according to your [Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) and [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/). To filter traffic based on approval status, use the [*Application Status*](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#application-approval-status) selector.\n\n## Application confidence scorecards\n\nApplication confidence scorecards provide automated risk assessment for AI and SaaS applications to help organizations make informed decisions about application approval and security policies. These scores bring scale and automation to the labor- and time-intensive task of evaluating generative AI and SaaS applications.\n\nThe scoring system evaluates applications across multiple security, compliance, and operational dimensions to generate two complementary scores: the Application Posture Score and the Generative AI Posture Score. These scores help security teams identify risks in Shadow AI and Shadow IT deployments without manual auditing of every application.\n\nTo view an application's confidence scorecard:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Team & Resources** > **Application library**\n2. Find the application you would like to review or search it by name.\n3. Review the Application Posture Score and the Generative AI Posture Score which are generated on the application card.\n\n### Scoring methodology\n\n#### Application Posture Score (5 points)\n\nThe Application Posture Score evaluates SaaS providers across five major categories.\n\n| Category | Points | Assessment Criteria | Scoring Logic |\n| - | - | - | - |\n| Security and Privacy Compliance | 1.2 | Presence of SOC 2 and ISO 27001 certifications, which signal operational maturity and adherence to security frameworks. | Full credit awarded for both certifications; partial credit for one certification; no credit if neither certification is present. |\n| Data Management Practices | 1.0 | Data retention windows and whether the provider shares data with third parties. | Shorter retention periods and no third-party data sharing earn the highest marks. Applications with indefinite data retention or extensive data sharing receive lower scores. |\n| Security Controls | 1.0 | Support for Multi-Factor Authentication (MFA), Single Sign-On (SSO), TLS 1.3, role-based access controls, and session monitoring capabilities. | These represent table stakes of modern SaaS security. Full credit requires comprehensive support across all controls; partial credit awarded for subset implementation. |\n| Security Reports and Incident History | 1.0 | Availability of trust or security pages, active bug bounty programs, incident response transparency, and recent breach history. | Recent material breaches result in full point deduction. Proactive security measures like bug bounty programs and transparent incident reporting increase scores. |\n| Financial Stability | 0.8 | Company financial status, funding levels, and operational stability. | Public companies and heavily capitalized providers score highest, while startups with limited funding or companies in financial distress receive lower scores. |\n| Total Points | 5.0 | | |\n\n#### Generative AI Posture Score (5 points)\n\n| Category | Points | Assessment Criteria | Scoring Logic |\n| - | - | - | - |\n| Compliance | 1.0 | Presence of ISO 42001 certification for AI management systems. | Full credit for ISO 42001 certification; no credit without this specialized AI governance certification. |\n| Deployment Security Model | 1.0 | Whether application access requires authentication and implements rate limiting, or if services are publicly exposed without controls. | Authenticated access with proper rate limiting receives full credit; publicly exposed services without controls receive minimal scoring. |\n| System Card | 1.0 | Publication of model or system cards documenting safety evaluations, bias testing, and risk assessments. | Comprehensive system cards with detailed safety and bias documentation receive full credit; incomplete or missing documentation results in score reduction. |\n| Training Data Governance | 2.0 | Whether user data is explicitly excluded from model training and availability of opt-in/opt-out controls for training data usage. | Explicit exclusion of user data from training receives maximum points; opt-in/opt-out controls receive partial credit; no controls or guaranteed user data training receives minimal scoring. |\n| **Total Points** | **5.0** | | |\n\n### Automated scoring infrastructure\n\n#### Web crawling and data extraction\n\nThe scoring system employs automated infrastructure to crawl and analyze public information sources.\n\n* Data sources: Trust centers, privacy policies, security pages, compliance documents, and vendor documentation.\n* Extraction process: Large language models parse documents to identify relevant information, with structured extraction methods to resist hallucinations and ensure accuracy.\n* Validation requirements: Source validation and structured data extraction prevent false positives and ensure reliable scoring.\n\n#### Human oversight and quality assurance\n\nAutomated results are supplemented with manual review to maintain transparency and ensure data integrity.\n\n* Review process: Every automated score undergoes review and audit by Cloudflare analysts before publication in the Application Library.\n* Validation methodology: Combination of automated crawling and extraction with human validation ensures comprehensive and trustworthy scoring.\n* Update frequency: Scores update dynamically as vendors improve security and compliance postures, providing live assessment rather than static reports.\n\n#### Report score inaccuracies\n\nIf you believe one of the Application confidence scores is incorrect or have additional evidence that should be considered in the scoring process, contact `app-confidence-scores@cloudflare.com`. Include relevant documentation or evidence that supports your assessment to help us review and update the score accordingly.\n\n</page>\n\n<page>\n---\ntitle: Devices · Cloudflare One docs\ndescription: Configure devices to send DNS queries to Cloudflare, or proxy all\n  traffic leaving the device through Cloudflare's network.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/index.md\n---\n\nConfigure devices to send DNS queries to Cloudflare, or proxy all traffic leaving the device through Cloudflare's network.\n\n* [WARP](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/)\n* [User-side certificates](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/)\n\n</page>\n\n<page>\n---\ntitle: Users · Cloudflare One docs\ndescription: Manage users in your Zero Trust organization.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/\n  md: https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/index.md\n---\n\nManage users in your Zero Trust organization.\n\n* [Seat management](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/seat-management/)\n* [SCIM provisioning](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/)\n* [User logs](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/)\n* [Risk score](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/risk-score/)\n\n</page>\n\n<page>\n---\ntitle: Applications and app types · Cloudflare One docs\ndescription: Gateway allows you to create DNS, Network, and HTTP policies based\n  on applications and app types. You can select individual applications or\n  groups of app types to filter specific traffic on your network.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/index.md\n---\n\nGateway allows you to create DNS, Network, and HTTP policies based on applications and app types. You can select individual applications or groups of app types to filter specific traffic on your network.\n\n## Applications\n\nWhen you choose the *Application* selector in a Gateway policy builder, the **Value** field will include all supported applications and their respective app types. Alternatively, you can use the [Gateway API](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/app_types/methods/list/) to fetch a list of applications, app types, and ID numbers.\n\nTo manage a consolidated list of applications across Cloudflare One, you can use the [Application Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/).\n\n## App types\n\nGateway sorts applications into the following app type groups:\n\n| Value | Definition |\n| - | - |\n| Artificial Intelligence | AI assistance applications |\n| Business | Applications used for general business purposes |\n| Collaboration & Online Meetings | Business communication and collaboration applications |\n| Dating | Online dating applications |\n| Development | Software development and development operations applications |\n| Education | Applications used for educational purposes and e-learning |\n| Email | Email applications |\n| Entertainment & Events | Applications used for entertainment content and event information |\n| Encrypted DNS | DNS encryption applications |\n| File Sharing | File sharing applications |\n| Finance & Accounting | Financial and accounting applications |\n| Food & Drink | Applications related to food delivery and recipe services |\n| Gaming | Games and gaming applications |\n| Health & Fitness | Applications used for health monitoring and fitness tracking |\n| Human Resources | Employee management applications and workforce tools |\n| Instant Messaging | Instant messaging applications |\n| IT Management | IT deployment management applications |\n| Legal | Legal tools and applications |\n| Lifestyle | Applications related to lifestyle and personal interests |\n| Music & Audio Streaming | Applications used for streaming music and audio |\n| Navigation | Applications used for maps and navigation services |\n| News, Books, & Magazines | Applications delivering news, books, and magazine content |\n| Photography & Graphic Design | Applications used for photography and graphic design |\n| Productivity | Business and productivity applications |\n| Public Cloud | Public cloud infrastructure management applications |\n| Sales & Marketing | Sales and marketing applications |\n| Search Engines | Web search engines and applications |\n| Security | Information security applications, including shadow IT |\n| Shopping | Online shopping applications |\n| Social Networking | Social networking applications |\n| Sports | Sports streaming and news applications |\n| Travel | Video streaming applications |\n| Video Streaming & Editing | Applications used for streaming and editing video |\n| [Do Not Inspect](#do-not-inspect-applications) | Applications incompatible with the TLS certificate required by the [Gateway proxy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/) |\n\n## Application hostnames\n\nApplications categorized by Cloudflare may independently rely on a number of different internal and external resources to provide functionality. To enable effective behavior of Allow and Block Gateway policies, Cloudflare One separates application definitions into [hostnames](#hostnames) and [support hostnames](#support-hostnames).\n\n### Hostnames\n\nHostnames are domains that are core to the application and not [used by other applications](#overlapping-hostnames). These are the domains that are specifically blocked when you block an application. The App Library surfaces these hostnames in the [Hostnames table](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/#overview) for an application.\n\n### Support hostnames\n\nSupport hostnames are shared resources which applications may call in order to function. Applications can use support hostnames for content delivery, application behavior, or third-party system integrations. Blocking these hostnames may result in unexpected behavior for other policies. In addition, not taking a specific action on one of these hostnames may affect the application's behavior, even if the application hostnames are allowed. For example, assume that `file-sharing-service.com` relies on `content-delivery.com`. If you allow access to `file-sharing-service.com` and its associated subdomains but not `content-delivery.com`, some of the functionality of `file-sharing-service.com` may break when Gateway matches the traffic.\n\nTo ensure effective application behavior, Gateway only uses support hostnames in Allow policies. Cloudflare explicitly allows support hostname connections in these policies but will not block the connections in Block policies. For example, many Google applications use `accounts.google.com` for authentication. In a Cloudflare One environment with highly restrictive policies, `accounts.google.com` must be allowed for many applications to function correctly. If you use an application with `accounts.google.com` in its support hostnames in an Allow policy, Gateway will allow both `accounts.google.com` and the application's domains.\n\n## Application controls\n\nWhen you use the [*Application* selector](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#granular-controls) in an HTTP policy with the *is* operator, you can choose specific actions and operations to match application traffic. Supported applications and operations include:\n\nAI\n\n* ChatGPT\n* Google Gemini\n* Perplexity\n* Claude\n\nFile sharing\n\n* Box\n* Dropbox\n* Google Drive\n* ShareFile\n* Hightail\n* Smash\n* WeTransfer\n\nFor more information, refer to [Application Granular Controls](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/granular-controls/).\n\n## Usage\n\n### Overlapping hostnames\n\nOverlapping hostnames are most common for vendors with many applications, such as Google or Meta. When you use the Application selector in Gateway policies, actions taken by Gateway will be limited to the specific application defined. Gateway will also log other applications that use the same hostnames, but it will not take action unless the application was matched by the policy. For example, both the Facebook and Facebook Messenger apps use the `chat-e2ee.facebook.com` hostname. When evaluating traffic to the Facebook Messenger app, Gateway will only take action on Facebook Messenger traffic but may log both the Facebook and Facebook Messenger apps.\n\nTo ensure Gateway evaluates traffic with your desired precedence, order your most specific policies with the highest priority according to [order of precedence](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#priority-within-a-policy-builder).\n\n### Do Not Inspect applications\n\nGateway automatically groups applications incompatible with TLS decryption into the *Do Not Inspect* app type. As Cloudflare identifies incompatible applications, Gateway will periodically update this app type to add new applications. To ensure Gateway does not intercept any current or future incompatible traffic, you can [create a Do Not Inspect HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) with the entire *Do Not Inspect* app type selected.\n\nWhen managing applications with the [Application Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/), Do Not Inspect applications will appear under the corresponding application. For example, the App Library will group *Google Drive (Do Not Inspect)* under **Google Drive**.\n\nInstall Cloudflare certificate manually to allow TLS decryption\n\nInstead of creating a Do Not Inspect policy for an application, you may be able to configure the application to [trust a Cloudflare certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/manual-deployment/#add-the-certificate-to-applications). Doing so will allow the application to function without losing visibility into your traffic.\n\n#### TLS decryption limitations\n\nApplications can be incompatible with [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/) for various reasons:\n\n* **Certificate pinning**: Certificate pinning is a security mechanism used to prevent on-path attacks on the Internet by hardcoding information about the certificate that the application expects to receive. If the wrong certificate is received, even if it is trusted by the system, the application will refuse to connect.\n\n* **Non-web traffic**: Some applications send non-web traffic, such as Session Initiation Protocol (SIP) and Extensible Messaging and Presence Protocol (XMPP), over TLS. Gateway cannot inspect these protocols.\n\n#### Microsoft 365 integration\n\nTo optimize performance for Microsoft 365 applications and services, you can bypass TLS decryption by turning on the Microsoft 365 traffic integration. This will create a [Do Not Inspect policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#do-not-inspect) for all [Microsoft 365 domains and IP addresses](https://docs.microsoft.com/en-us/microsoft-365/enterprise/microsoft-365-ip-web-service) specified by Microsoft. This policy also uses Cloudflare intelligence to identify other Microsoft 365 traffic not explicitly defined.\n\nTo turn on the Microsoft 365 integration:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings** > **Policy settings**.\n2. In **Bypass decryption of Microsoft 365 traffic**, select **Create policy**.\n3. To verify the policy was created, select **View policy**. Alternatively, go to **Traffic policies** > **HTTP policies**. A policy named Microsoft 365 Auto Generated will be enabled in your list.\n\nAll future Microsoft 365 traffic will bypass Gateway logging and filtering. To disable this behavior, turn off or delete the policy.\n\n### Terraform\n\nTerraform users can retrieve the app types list with the `cloudflare_zero_trust_gateway_app_types_list` data source. This allows you to create Gateway policies with the application's name rather than its numeric ID. For example:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: DNS policies · Cloudflare One docs\ndescription: When a user makes a DNS request to Gateway, Gateway matches the\n  request against the DNS policies you have set up for your organization. If the\n  domain does not belong to any blocked categories, or if it matches an Override\n  policy, the user's client receives the DNS resolution and initiates an HTTP\n  connection.\nlastUpdated: 2025-12-13T02:33:41.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/index.md\n---\n\nWhen a user makes a DNS request to Gateway, Gateway matches the request against the DNS policies you have set up for your organization. If the domain does not belong to any blocked categories, or if it matches an Override policy, the user's client receives the DNS resolution and initiates an HTTP connection.\n\nA DNS policy consists of an **Action** as well as a logical expression that determines the scope of the action. To build an expression, you need to choose a **Selector** and an **Operator**, and enter a value or range of values in the **Value** field. You can use **And** and **Or** logical operators to evaluate multiple conditions.\n\n* [Actions](#actions)\n* [Selectors](#selectors)\n* [Comparison operators](#comparison-operators)\n* [Value](#value)\n* [Logical operators](#logical-operators)\n\nWhen creating a DNS policy, you can select as many security risk categories and content categories as needed to fully secure your network. Unless a more specific selector is configured in a policy (for example, *User Email* or *Source IP*), then the policy will be evaluated against all DNS queries that reach Gateway from your organization.\n\nIf a condition in an expression joins a query attribute (such as *Source IP*) and a response attribute (such as *Resolved IP*), then the condition will be evaluated when the response is received.\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Actions\n\nJust like actions in HTTP policies, actions in DNS policies allow you to choose what to do with a given set of elements. You can assign one action per policy.\n\nThese are the action types you can choose from:\n\n* [Allow](#allow)\n* [Block](#block)\n* [Override](#override)\n* [Safe Search](#safe-search)\n* [YouTube Restricted Mode](#youtube-restricted-mode)\n\n### Allow\n\nAPI value: `allow`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Authoritative Nameserver IP](#authoritative-nameserver-ip)\n* [Content Categories](#content-categories)\n* [DNS CNAME Response Value](#dns-cname-record)\n* [DNS MX Response Value](#dns-mx-record)\n* [DNS PTR Response Value](#dns-ptr-record)\n* [DNS Resolver IP](#dns-resolver-ip)\n* [DNS TXT Response Value](#dns-txt-record)\n* [DOH Subdomain](#doh-subdomain)\n* [Domain](#domain)\n* [Host](#host)\n* [Indicator Feeds](#indicator-feeds)\n* [Location](#location)\n* [Query Record Type](#query-record-type)\n* [Resolved Continent IP Geolocation](#resolved-continent)\n* [Resolved Country IP Geolocation](#resolved-country)\n* [Resolved IP](#resolved-ip)\n* [Request Context Categories](#request-context-categories)\n* [Security Categories](#security-categories)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source IP](#source-ip)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\nPolicies with Allow actions allow DNS queries to reach destinations you specify within the Selector and Value fields. For example, the following configuration allows DNS queries to reach domains we categorize as belonging to the Education content category:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Content Categories | in | *Education* | Allow |\n\n#### Disable DNSSEC validation\n\nWhen you select **Disable DNSSEC validation**, Gateway will resolve DNS queries even if the cryptographic signature for the DNS record cannot be validated. We do not recommend disabling DNSSEC validation unless you know that the validation failure is due to DNSSEC configuration issues and not malicious attacks.\n\n### Block\n\nAPI value: `block`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Authoritative Nameserver IP](#authoritative-nameserver-ip)\n* [Content Categories](#content-categories)\n* [DNS CNAME Response Value](#dns-cname-record)\n* [DNS MX Response Value](#dns-mx-record)\n* [DNS PTR Response Value](#dns-ptr-record)\n* [DNS Resolver IP](#dns-resolver-ip)\n* [DNS TXT Response Value](#dns-txt-record)\n* [DOH Subdomain](#doh-subdomain)\n* [Domain](#domain)\n* [Host](#host)\n* [Indicator Feeds](#indicator-feeds)\n* [Location](#location)\n* [Query Record Type](#query-record-type)\n* [Resolved Continent IP Geolocation](#resolved-continent)\n* [Resolved Country IP Geolocation](#resolved-country)\n* [Resolved IP](#resolved-ip)\n* [Request Context Categories](#request-context-categories)\n* [Security Categories](#security-categories)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source IP](#source-ip)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\nPolicies with Block actions block DNS queries to reach destinations you specify within the Selector and Value fields. For example, the following configuration blocks DNS queries from reaching domains we categorize as belonging to the Adult Themes content category:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Content Categories | in | *Adult Themes* | Block |\n\n#### Custom block page\n\nWhen choosing the Block action, turn on **Modify Gateway block behavior** to respond to queries with a block page to display to users who go to blocked websites. Optionally, you can override your global block page setting with a URL redirect for the specific DNS policy. For more information, refer to [Block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/).\n\nIf the block page is turned off for a policy, Gateway will respond to queries blocked at the DNS level with an `A` record of `0.0.0.0` for IPv4 destinations, or with an `AAAA` record of `::` for IPv6 destinations. The browser will display its default connection error page.\n\nTo block the resolution of queries for DNS records with types other than `A` or `AAAA`, Gateway will respond with the `REFUSED (RCODE:5)` DNS return code. Gateway will block the request but will not display a block page.\n\n#### WARP client block notifications\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/plans/zero-trust-services/) |\n| - | - |\n| * Gateway with WARP\n* Secure Web Gateway without DNS filtering | Enterprise |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows | ✅ | 2024.1.159.0 |\n| macOS | ✅ | 2024.1.160.0 |\n| Linux | ❌ | |\n| iOS | ✅ | 1.7 |\n| Android | ✅ | 1.4 |\n| ChromeOS | ✅ | 1.4 |\n\nTurn on **Display block notification for WARP Client** to display notifications for Gateway block events. Blocked users will receive an operating system notification from the WARP client with a custom message you set. If you do not set a custom message, the WARP client will display a default message. Custom messages must be 100 characters or less. WARP will only display one notification per minute.\n\nUpon selecting the notification, WARP will direct your users to the [Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) you have configured. Optionally, you can direct users to a custom URL, such as an internal support form.\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\nEnsure that your operating system allows notifications for WARP. Your device may not display notifications if focus, do not disturb, or screen sharing settings are turned on. To turn on client notifications on macOS devices running DisplayLink software, you may have to allow system notifications when mirroring your display. For more information, refer to the [macOS documentation](https://support.apple.com/guide/mac-help/change-notifications-settings-mh40583/mac).\n\n### Override\n\nAPI value: `override`\n\nAvailable selectors\n\nThe Override action cannot be used with selectors evaluated during or after DNS resolution.\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [DNS Resolver IP](#dns-resolver-ip)\n* [DOH Subdomain](#doh-subdomain)\n* [Domain](#domain)\n* [Host](#host)\n* [Location](#location)\n* [Query Record Type](#query-record-type)\n* [Resolved Continent IP Geolocation](#resolved-continent)\n* [Resolved Country IP Geolocation](#resolved-country)\n* [Security Categories](#security-categories)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source IP](#source-ip)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\nPolicies with Override actions allow you to respond to all DNS queries for a given domain to another destination. For example, you can provide a custom response IP of `1.2.3.4` for all queries to `www.example.com` with the following policy:\n\n| Selector | Operator | Value | Action | Override Hostname |\n| - | - | - | - | - |\n| Hostname | is | `www.example.com` | Override | `1.2.3.4` |\n\n### Safe Search\n\nAPI value: `safesearch`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [DNS Resolver IP](#dns-resolver-ip)\n* [DOH Subdomain](#doh-subdomain)\n* [Domain](#domain)\n* [Host](#host)\n* [Location](#location)\n* [Query Record Type](#query-record-type)\n* [Resolved Continent IP Geolocation](#resolved-continent)\n* [Resolved Country IP Geolocation](#resolved-country)\n* [Security Categories](#security-categories)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source IP](#source-ip)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\nSafeSearch is a feature of search engines that helps you filter explicit or offensive content. When you enable SafeSearch, the search engine filters explicit or offensive content and returns search results that are safe for children or at work.\n\nYou can use Cloudflare Gateway to enable SafeSearch on search engines like Google, Bing, Yandex, YouTube and DuckDuckGo. For example, to enable SafeSearch for Google, you can create the following policy:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Domain | is | `google.com` | Safe Search |\n\n### YouTube Restricted Mode\n\nAPI value: `ytrestricted`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [DNS Resolver IP](#dns-resolver-ip)\n* [DOH Subdomain](#doh-subdomain)\n* [Domain](#domain)\n* [Host](#host)\n* [Location](#location)\n* [Query Record Type](#query-record-type)\n* [Resolved Continent IP Geolocation](#resolved-continent)\n* [Resolved Country IP Geolocation](#resolved-country)\n* [Security Categories](#security-categories)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source IP](#source-ip)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\nSimilarly, you can enforce YouTube Restricted mode by choosing the *YouTube Restricted* action. YouTube Restricted Mode is an automated filter for adult and offensive content built into YouTube. To enable YouTube Restricted Mode, you could set up a policy like the following:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| DNS Domain | is | `youtube.com` | YouTube Restricted |\n\nThis setup ensures users will be blocked from accessing offensive sites using DNS.\n\n## Selectors\n\nGateway matches DNS queries against the following selectors, or criteria:\n\n### Application\n\nYou can apply DNS policies to a growing list of popular web applications. Refer to [Application and app types](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/) for more information.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Application | `any(app.ids[*] in {505})` | Before DNS resolution |\n\n### Authoritative Nameserver IP\n\nUse this selector to match against the IP address of the authoritative nameserver IP address.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Authoritative Nameserver IP | `dns.authoritative_ns_ips == 198.51.100.0` | During DNS resolution |\n\n### Content Categories\n\nUse this selector to filter domains belonging to specific [content categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories).\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Content Categories | `any(dns.content_category[*] in {1})` | Before DNS resolution |\n\nWhen using an Allow or Block action, you can optionally [block IP addresses](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#filter-traffic-by-resolved-ip-category) or [filter categories for `CNAME` records](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#ignore-cname-domain-categories).\n\n### DNS CNAME Record\n\nUse this selector to filter DNS responses by their `CNAME` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS CNAME Response Value | `any(dns.response.cname[*] in {\"www.apple.com.edgekey.net\"})` | After DNS resolution |\n\nNote\n\nIf one CNAME record points to another CNAME record, each record in the chain will be evaluated. For example, if `abc.example.com` points to `xyz.example.com`, then your DNS policy will evaluate both `abc.example.com` and `xyz.example.com`.\n\n### DNS MX Record\n\nUse this selector to filter DNS responses by their `MX` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS MX Response Value | `any(dns.response.mx[*] in {\"gmail-smtp-in.l.google.com\"})` | After DNS resolution |\n\n### DNS PTR Record\n\nUse this selector to filter DNS responses by their `PTR` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS PTR Response Value | `any(dns.response.ptr[*] in {\"255.2.0.192.in-addr.arpa\"})` | After DNS resolution |\n\n### DNS Resolver IP\n\nUse this selector to apply policies to DNS queries that arrived to your Gateway Resolver IP address aligned with a registered DNS location. For most Gateway customers, this is an IPv4 anycast address and policies created using this IPv4 address will apply to all DNS locations. However, each DNS location has a dedicated IPv6 address and some Gateway customers have been supplied with a dedicated IPv4 address — these both can be used to apply policies to specific registered DNS locations.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS Resolver IP | `any(dns.resolved_ip[*] == 198.51.100.0)` | Before DNS resolution |\n\n### DNS TXT Record\n\nUse this selector to filter DNS responses by their `TXT` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS TXT Response Value | `any(dns.response.txt[*] in {\"your_text\"})` | After DNS resolution |\n\n### DoH Subdomain\n\nUse this selector to match against DNS queries that arrive via DNS-over-HTTPS (DoH) destined for the DoH endpoint configured for each DNS location. For example, you can use a DNS location with a DoH endpoint of `abcdefg.cloudflare-gateway.com` by choosing the DoH Subdomain selector and inputting a value of `abcdefg`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DOH Subdomain | `dns.doh_subdomain == \"abcdefg\"` | Before DNS resolution |\n\n### Domain\n\nUse this selector to match against a domain and all subdomains. For example, you can match `example.com` and its subdomains, such as `www.example.com`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Domain | `any(dns.domains[*] == \"example.com\")` | Before DNS resolution |\n\nGateway policies do not support domains with non-Latin characters directly. To use a domain with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\n### Host\n\nUse this selector to match against only the hostname specified. For example, you can match `test.example.com` but not `example.com` or `www.test.example.com`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Host | `dns.fqdn == \"example.com\"` | Before DNS resolution |\n\nGateway policies do not support hostnames with non-Latin characters directly. To use a hostname with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\nNote\n\nSome hostnames (`example.com`) will invisibly redirect to the www subdomain (`www.example.com`). To match this type of website, use the [Domain](#domain) selector instead of the Host selector.\n\n### Indicator Feeds\n\nUse this selector to match against custom indicator feeds.\n\nYou can use a [publicly available indicator feed](https://developers.cloudflare.com/security-center/indicator-feeds/#publicly-available-feeds) or a custom indicator feed assigned to your account by a designated third-party vendor. For more information on indicator feeds, refer to [Custom Indicator Feeds](https://developers.cloudflare.com/security-center/indicator-feeds/).\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Indicator Feeds | `dns.indicator_feed` | Before DNS resolution |\n\nWhen using an Allow or Block action, you can optionally [block IP addresses](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#filter-traffic-by-resolved-ip-category) or [filter categories for `CNAME` records](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#ignore-cname-domain-categories).\n\n### Location\n\nUse this selector to apply policies to a specific [Gateway DNS location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) or set of locations.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Location | `dns.location in {\"location_uuid_1\" \"location_uuid_2\"}` | Before DNS resolution |\n\n### Query Record Type\n\nUse this selector to choose the DNS resource record type that you would like to apply policies against. For example, you can match `A` records for a domain but not `MX` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Query Record Type | `dns.query_rtype == \"TXT\"` | Before DNS resolution |\n\n### Resolved Continent\n\nUse this selector to filter based on the continent that the query resolves to. Geolocation is determined from the IP address in the response. To specify a continent, enter its two-letter code into the **Value** field:\n\n* AF - Africa\n* AN - Antarctica\n* AS - Asia\n* EU - Europe\n* NA - North America\n* OC - Oceania\n* SA - South America\n* T1 - Tor network\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Resolved Continent IP Geolocation | `dns.dst.geo.continent == \"EU\"` | After DNS resolution |\n\n### Resolved Country\n\nUse this selector to filter based on the country that the query resolves to. Geolocation is determined from the IP address in the response. To specify a country, enter its [ISO 3166-1 Alpha 2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Resolved Country IP Geolocation | `dns.dst.geo.country == \"RU\"` | After DNS resolution |\n\n### Resolved IP\n\nUse this selector to filter based on the IP addresses that the query resolves to.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Resolved IP | `any(dns.resolved_ips[*] == 198.51.100.0)` | After DNS resolution |\n\n### Request Context Categories\n\nUse this selector to match a dynamic list of [category IDs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#category-and-subcategory-ids) sent in the [EDNS](https://datatracker.ietf.org/doc/html/rfc6891) portion of a DNS query. Gateway includes request context with the OPT code `65050`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Request Context Categories | `dns.categories_in_request_context_matches` | Before DNS resolution |\n\n### Security Categories\n\nUse this selector to match domains (and optionally, [IP addresses](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#filter-traffic-by-resolved-ip-category)) belonging to specific [security categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories).\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Security Categories | `any(dns.security_category[*] in {1})` | Before DNS resolution |\n\nWhen using an Allow or Block action, you can optionally [block IP addresses](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#filter-traffic-by-resolved-ip-category) or [filter categories for `CNAME` records](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#ignore-cname-domain-categories).\n\n### Source Continent\n\nUse this selector to filter based on the continent where the query arrived to Gateway from.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source Continent IP Geolocation | `dns.src.geo.continent == \"North America\"` | Before DNS resolution |\n\n### Source Country\n\nUse this selector to filter based on the country where the query arrived to Gateway from.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a country, enter its [ISO 3166-1 Alpha-2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source Country IP Geolocation | `dns.src.geo.country == \"RU\"` | Before DNS resolution |\n\n### Source IP\n\nUse this selector to apply policies to the source IP address of DNS queries. For example, this could be the WAN IP address of the stub resolver used by your organization to send queries to Gateway.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source IP | `dns.src_ip == 198.51.100.0` | Before DNS resolution |\n\n### Source Internal IP\n\nUse this selector to apply policies to the source internal IP address of a DNS query. For example, this could be the private IP address of the hosts behind [Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/) or [WARP Connector](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/) used by your organization to send queries to Gateway.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source Internal IP | `dns.src_internal_ip == 10.10.0.1` | Before DNS resolution |\n\n### Users\n\nUse these selectors to match against identity attributes.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| User Email | `identity.email == \"user@example.com\"` | Before DNS resolution |\n| User Name | `identity.name == \"Test User\"` | Before DNS resolution |\n| User Group IDs | `any(identity.groups[*].id in {\"group_id\"})` | Before DNS resolution |\n| User Group Names | `any(identity.groups[*].name in {\"group_name\"})` | Before DNS resolution |\n| User Group Emails | `any(identity.groups[*].email in {\"group@example.com\"})` | Before DNS resolution |\n| SAML Attributes | `any(identity.saml_attributes[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"] in {\"Test User\"})` | Before DNS resolution |\n\n## Comparison operators\n\nComparison operators are the way Gateway matches traffic to a selector. When you choose a **Selector** in the dashboard policy builder, the **Operator** dropdown menu will display the available options for that selector.\n\n| Operator | Meaning |\n| - | - |\n| is | equals the defined value |\n| is not | does not equal the defined value |\n| in | matches at least one of the defined values |\n| not in | does not match any of the defined values |\n| in list | in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| not in list | not in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| matches regex | regex evaluates to true |\n| does not match regex | regex evaluates to false |\n| greater than | exceeds the defined number |\n| greater than or equal to | exceeds or equals the defined number |\n| less than | below the defined number |\n| less than or equal to | below or equals the defined number |\n\n## Value\n\nIn the **Value** field, you can input a single value when using an equality comparison operator (such as *is*) or multiple values when using a containment comparison operator (such as *in*). Additionally, you can use [regular expressions](#regular-expressions) (or regex) to specify a range of values for supported selectors.\n\n### Regular expressions\n\nGateway uses Rust to evaluate regular expressions. The Rust implementation is slightly different than regex libraries used elsewhere. For more information, refer to our guide for [Wildcards](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/#wildcards). To evaluate if your regex matches, you can use [Rustexp](https://rustexp.lpil.uk/).\n\nIf you want to match multiple values, you can use the pipe symbol (`|`) as an OR operator. In Gateway, you do not need to use an escape character (`\\`) before the pipe symbol. For example, the following policy blocks requests to two hostnames if either appears in a request header:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Host | matches regex | `.\\*whispersystems.org\\|.\\*signal.org` | Block |\n\nIn addition to regular expressions, you can use [logical operators](#logical-operators) to match multiple values.\n\n## Logical operators\n\nTo evaluate multiple conditions in an expression, select the **And** logical operator. These expressions can be compared further with the **Or** logical operator.\n\n| Operator | Meaning |\n| - | - |\n| And | match all of the conditions in the expression |\n| Or | match any of the conditions in the expression |\n\nThe **Or** operator will only work with conditions in the same expression group. For example, you cannot compare conditions in **Traffic** with conditions in Identity.\n\n## Limitations\n\n### Third-party filtering conflict\n\nGateway will not properly filter traffic sent through third-party VPNs or other Internet filtering software, such as [iCloud Private Relay](https://support.apple.com/102602) or [Google Chrome IP Protection](https://github.com/GoogleChrome/ip-protection#ip-protection). To ensure your DNS policies apply to your traffic, Cloudflare recommends turning off software that may interfere with Gateway.\n\nTo turn off iCloud Private Relay, refer to the Apple user guides for [macOS](https://support.apple.com/guide/mac-help/use-icloud-private-relay-mchlecadabe0/) or [iOS](https://support.apple.com/guide/iphone/protect-web-browsing-icloud-private-relay-iph499d287c2/).\n\n### Magic WAN forwarding\n\nTo apply DNS policies to queries forwarded through [Magic WAN](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/), you can either point your organization's DNS resolver to an IPv6, DoH, or DoT endpoint or request a dedicated resolver IPv4 address. For more information, refer to [DNS resolver IPs and hostnames](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/dns-resolver-ips/).\n\n### Fallback DNS\n\nSome apps, such as WhatsApp and Android Studio, use hard-coded fallback DNS servers. Fallback DNS can cause unexpected behavior with Gateway DNS policies. For example, if you have a Block DNS policy, Gateway will initially block DNS queries from those apps, but the queries can resolve correctly afterward using the fallback DNS. To mitigate this behavior, you create a [Gateway Network policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) to block outbound DNS traffic on TCP/UDP port `53` to the fallback DNS servers. For example, to block Google's fallback DNS servers:\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| Protocol | in | *TCP*, *UDP* | And | Block |\n| Destination Port | in | `53` | And | |\n| Destination IP | in | `8.8.8.8`, `8.8.4.4` | | |\n\n</page>\n\n<page>\n---\ntitle: Domain categories · Cloudflare One docs\ndescription: Cloudflare Gateway allows you to block known and potential security\n  risks on the public Internet, as well as specific categories of content.\n  Domains are categorized by Cloudforce One, Cloudflare's threat intelligence\n  solution. To review the categories for a specific domain, use Cloudflare\n  Radar.\nlastUpdated: 2025-12-26T18:33:13.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/index.md\n---\n\nCloudflare Gateway allows you to block known and potential security risks on the public Internet, as well as specific categories of content. Domains are categorized by [Cloudforce One](https://developers.cloudflare.com/security-center/cloudforce-one/), Cloudflare's threat intelligence solution. To review the categories for a specific domain, use [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\nCloudflare categorizes domains into content categories and security categories, which cover security risks and security threats:\n\n* **Content categories**: An upstream vendor supplies content categories for domains. These categories help us organize domains into broad topic areas. However, the specific criteria and methods used by our vendor may not be disclosed.\n* **Security risks**: Cloudflare determines security risks for domains using internal models. These models analyze various factors, including the age of a domain and its reputation. This allows us to identify potentially risky domains.\n* **Security threats**: To identify malicious domains that pose security threats, Cloudflare employs a mix of internal data sources, machine learning models, commercial feeds, and open-source threat intelligence.\n\nYou can block security and content categories by creating DNS or HTTP policies. Once you have configured your policies, you will be able to inspect network activity and the associated categories in your Gateway logs.\n\nTo request changes to a domain's categorization, refer to [Change categorization](https://developers.cloudflare.com/security-center/investigate/change-categorization/). For more information on investigating potentially risky domains, refer to [Investigate threats](https://developers.cloudflare.com/security-center/investigate/investigate-threats/#domain).\n\nSubdomain category\n\nSubdomains that have not been assigned a category will inherit the category of their parent domain. When Gateway categorizes a subdomain, the subdomain will carry only its own category. Categorized subdomains will not inherit their parent domain's categories.\n\n## Security categories\n\n| Category | Definition |\n| - | - |\n| Anonymizer | Sites that allow users to surf the Internet anonymously. |\n| Brand Embedding | Sites that imitate a verified brand, for example `facobook.com`. |\n| Command and Control & Botnet | Sites that are queried by compromised devices to exfiltrate information or potentially infect other devices in a network. |\n| Compromised Domain | Sites where a legitimate domain has been compromised or taken over and had malicious content planted or injected. |\n| Cryptomining | Sites that mine cryptocurrency by taking over the user's computing resources. |\n| DGA Domains | Domains detected as generated by algorithms seen in malware. |\n| DNS Tunneling | Domains with detected DNS tunneling activity, including attempts to encode or exfiltrate data in DNS queries and responses (for example, in `TXT` records) or to use DNS for command-and-control (C2) communications. |\n| Malware | Sites hosting malicious content and other compromised websites. |\n| Phishing | Domains that are known for stealing personal information. |\n| Potentially Unwanted Software | Domains that distribute software that may come bundled with other less legitimate software or functionality, like toolbars, adware, and grayware. |\n| Private IP Address | Domains that resolve to private IP Addresses. |\n| Scam | Fraudulent websites and schemes designed to trick victims into giving away money or personal information. |\n| Spam | Sites that are known for targeting users with unwanted sweepstakes, surveys, and advertisements. |\n| Spyware | Sites that are known to distribute or contain code that displays unwanted advertisements or that gathers user information without the user's knowledge. |\n\n## Content categories\n\n| Category | Definition |\n| - | - |\n| Ads | Sites that are hosting content related to advertising. |\n| Adult Themes | Sites that are hosting content related to pornography, nudity, sexuality, and other adult themes. |\n| Business & Economy | Sites that are related to business, economy, finance, education, science and technology. |\n| Child Abuse | Sites hosting child abuse content. |\n| CIPA | Sites related to aiding schools and organizations in abiding by CIPA requirements. |\n| Education | Sites hosting educational content that are not included in other categories like Science, Technology or Educational institutions. |\n| Entertainment | Sites that are hosting entertaining content that are not included in other categories like Comic books, Audio streaming, Video streaming etc. |\n| Gambling | Sites that are providing online gambling or are related to gambling. |\n| Government & Politics | Sites related to government and politics. |\n| Health | Sites containing information about health and fitness. |\n| Information Technology | Sites related to information technology. |\n| Internet Communication | Sites hosting applications that are used for communication like chat, mail etc. |\n| Job Search & Careers | Sites that facilitate searching for jobs and careers. |\n| Miscellaneous | Sites that are not included in the listed security and content categories. |\n| Questionable Content | Sites hosting content that are related to hacking, piracy, profanity and other questionable activities. |\n| Real Estate | Sites related to real estate. |\n| Religion | Sites hosting content about religion, alternative religion, religious teachings, religious groups, and spirituality. |\n| Security Risks | Sites that are [new or misconfigured](#security-risk-subcategories). We recommend that you allow or isolate this content category to avoid accidentally blocking trusted domains. |\n| Shopping & Auctions | Sites that are hosting content related to ecommerce, coupons, shopping, auctions and marketplaces. |\n| Social & Family | Sites related to society and lifestyle. |\n| Society & Lifestyle | Sites hosting information about lifestyle that are not included in other categories like fashion, food & drink etc. |\n| Sports | Sites related to sports & recreation. |\n| Technology | Sites hosting information about technology that are not included in the science category. |\n| Travel | Sites that contain information about listings, reservations, services for travel. |\n| Vehicles | Sites related vehicles, automobiles, including news, reviews, and other hobbyist information. |\n| Violence | Sites hosting and/or promoting violent content. |\n| Weather | Sites related to weather. |\n\n### Miscellaneous subcategories\n\n| Category | Definition |\n| - | - |\n| Login Screens | Sites hosting login screens that might also be included in other categories. |\n| Miscellaneous | Sites that do not belong to other content categories. |\n| No Content | Sites that have no content. |\n| Redirect | Domains that redirect to other sites. |\n| Unreachable | Domains that resolve to unreachable IP addresses. |\n\n### Security risk subcategories\n\n| Category | Definition |\n| - | - |\n| New Domains | Domains registered within the past 30 days. |\n| Newly Seen Domains | Domains that were resolved for the first time within the past 30 days. |\n| Parked & For Sale Domains | Domains that are not connected to a hosting service. |\n\n### Category and subcategory IDs\n\n| Category ID | Category Name | Subcategory ID | Subcategory Name |\n| - | - | - | - |\n| 1 | Ads | 66 | Advertisements |\n| 2 | Adult Themes | 67 | Adult Themes |\n| 2 | Adult Themes | 125 | Nudity |\n| 2 | Adult Themes | 133 | Pornography |\n| 3 | Business & Economy | 186 | Brokerage & Investing |\n| 3 | Business & Economy | 75 | Business |\n| 3 | Business & Economy | 89 | Economy & Finance |\n| 3 | Business & Economy | 183 | Cryptocurrency |\n| 3 | Business & Economy | 185 | Personal Finance |\n| 6 | Education | 90 | Education |\n| 6 | Education | 91 | Educational Institutions |\n| 6 | Education | 189 | Reference |\n| 6 | Education | 144 | Science |\n| 6 | Education | 150 | Space & Astronomy |\n| 7 | Entertainment | 70 | Arts |\n| 7 | Entertainment | 74 | Audio Streaming |\n| 7 | Entertainment | 76 | Cartoons & Anime |\n| 7 | Entertainment | 79 | Comic Books |\n| 7 | Entertainment | 92 | Entertainment |\n| 7 | Entertainment | 96 | Fine Art |\n| 7 | Entertainment | 100 | Gaming |\n| 7 | Entertainment | 106 | Home Video/DVD |\n| 7 | Entertainment | 107 | Humor |\n| 7 | Entertainment | 116 | Magazines |\n| 7 | Entertainment | 120 | Movies |\n| 7 | Entertainment | 121 | Music |\n| 7 | Entertainment | 122 | News & Media |\n| 7 | Entertainment | 127 | Paranormal |\n| 7 | Entertainment | 139 | Radio |\n| 7 | Entertainment | 156 | Television |\n| 7 | Entertainment | 164 | Video Streaming |\n| 8 | Gambling | 99 | Gambling |\n| 9 | Government & Politics | 190 | Charity and Non-profit |\n| 9 | Government & Politics | 101 | Government/Legal |\n| 9 | Government & Politics | 137 | Politics, Advocacy, and Government-Related |\n| 10 | Health | 103 | Health & Fitness |\n| 10 | Health | 146 | Sex Education |\n| 12 | Internet Communication | 77 | Chat |\n| 12 | Internet Communication | 98 | Forums |\n| 12 | Internet Communication | 108 | Information Security |\n| 12 | Internet Communication | 110 | Instant Messengers |\n| 12 | Internet Communication | 111 | Internet Phone & VOIP |\n| 12 | Internet Communication | 118 | Messaging |\n| 12 | Internet Communication | 126 | P2P |\n| 12 | Internet Communication | 129 | Personal Blogs |\n| 12 | Internet Communication | 168 | Webmail |\n| 12 | Internet Communication | 172 | Photo Sharing |\n| 13 | Job Search & Careers | 113 | Job Search & Careers |\n| 15 | Miscellaneous | 115 | Login Screens |\n| 15 | Miscellaneous | 119 | Miscellaneous |\n| 15 | Miscellaneous | 124 | No Content |\n| 15 | Miscellaneous | 141 | URL Alias/Redirect |\n| 15 | Miscellaneous | 161 | Unreachable |\n| 17 | Questionable Content | 85 | Deceptive Ads |\n| 17 | Questionable Content | 87 | Drugs |\n| 17 | Questionable Content | 102 | Hacking |\n| 17 | Questionable Content | 135 | Profanity |\n| 17 | Questionable Content | 138 | Questionable Activities |\n| 17 | Questionable Content | 157 | Militancy, Hate & Extremism |\n| 17 | Questionable Content | 162 | Unreliable Information |\n| 18 | Real Estate | 140 | Real Estate |\n| 19 | Religion | 142 | Religion & Spirituality |\n| 20 | Safe for Kids | 143 | Safe for Kids |\n| 21 | Security threats | 68 | Anonymizer |\n| 21 | Security threats | 80 | Command and Control & Botnet |\n| 21 | Security threats | 187 | Compromised Domain |\n| 21 | Security threats | 83 | Cryptomining |\n| 21 | Security threats | 117 | Malware |\n| 21 | Security threats | 131 | Phishing |\n| 21 | Security threats | 188 | Potentially unwanted software |\n| 21 | Security threats | 134 | Private IP Address |\n| 21 | Security threats | 151 | Spam |\n| 21 | Security threats | 153 | Spyware |\n| 21 | Security threats | 175 | DNS Tunneling |\n| 21 | Security threats | 176 | Domain Generation Algorithm |\n| 21 | Security threats | 178 | Brand Embedding |\n| 21 | Security threats | 191 | Scam |\n| 22 | Shopping & Auctions | 73 | Auctions & Marketplaces |\n| 22 | Shopping & Auctions | 82 | Coupons |\n| 22 | Shopping & Auctions | 88 | Ecommerce |\n| 22 | Shopping & Auctions | 148 | Shopping |\n| 24 | Society & Lifestyle | 71 | Arts & Crafts |\n| 24 | Society & Lifestyle | 72 | Astrology |\n| 24 | Society & Lifestyle | 78 | Clothing |\n| 24 | Society & Lifestyle | 84 | Dating & Relationships |\n| 24 | Society & Lifestyle | 86 | Digital Postcards |\n| 24 | Society & Lifestyle | 93 | Parenting |\n| 24 | Society & Lifestyle | 94 | Fashion |\n| 24 | Society & Lifestyle | 97 | Food & Drink |\n| 24 | Society & Lifestyle | 104 | Hobbies & Interests |\n| 24 | Society & Lifestyle | 105 | Home & Garden |\n| 24 | Society & Lifestyle | 114 | Lifestyle |\n| 24 | Society & Lifestyle | 130 | Pets |\n| 24 | Society & Lifestyle | 132 | Photography |\n| 24 | Society & Lifestyle | 136 | Professional Networking |\n| 24 | Society & Lifestyle | 147 | Sexuality |\n| 24 | Society & Lifestyle | 149 | Social Networks |\n| 24 | Society & Lifestyle | 154 | Swimsuits |\n| 24 | Society & Lifestyle | 158 | Tobacco |\n| 24 | Society & Lifestyle | 173 | Body Art |\n| 24 | Society & Lifestyle | 174 | Lingerie & Bikini |\n| 24 | Society & Lifestyle | 181 | Alcohol |\n| 25 | Sports | 152 | Sports |\n| 26 | Technology | 69 | APIs |\n| 26 | Technology | 81 | Content Servers |\n| 26 | Technology | 95 | File Sharing |\n| 26 | Technology | 109 | Information Technology |\n| 26 | Technology | 123 | News, Portal & Search |\n| 26 | Technology | 145 | Search Engines |\n| 26 | Technology | 155 | Technology |\n| 26 | Technology | 159 | Translator |\n| 26 | Technology | 184 | Artificial Intelligence |\n| 26 | Technology | 192 | Remote Access |\n| 26 | Technology | 193 | Shareware/Freeware |\n| 26 | Technology | 194 | Keep Awake Software |\n| 27 | Travel | 160 | Travel |\n| 28 | Vehicles | 163 | Vehicles |\n| 29 | Violence | 165 | Violence |\n| 29 | Violence | 166 | Weapons |\n| 30 | Weather | 167 | Weather |\n| 31 | Always blocked | 170 | Child Abuse |\n| 32 | Security Risks | 128 | Parked & For Sale Domains |\n| 32 | Security Risks | 169 | New Domains |\n| 32 | Security Risks | 177 | Newly Seen Domains |\n| 34 | CIPA | 182 | CIPA Filter |\n\n## Filtering options\n\n### Filter traffic by resolved IP category\n\nWhen creating a DNS policy for security or content categories, you can optionally turn on **Filter traffic by resolved IP category** in the policy settings. When turned on, Gateway will block queries based on their resolved IP address in addition to the domain name. This setting may increase the number of false positives because domains in the blocked category can share IP addresses with legitimate domains.\n\n### Ignore `CNAME` domain categories\n\nThe categories for a site's `CNAME` records may differ from its `A` record. For example, `blog.example.com` may be categorized under Personal Blogs, while `example.com` is categorized under Technology. To limit matches for a DNS policy to only the root domain's categories, turn on **Ignore CNAME domain categories**.\n\nRegardless of this setting, `CNAME` domain categories will still appear in your Gateway [Logpush](https://developers.cloudflare.com/cloudflare-one/insights/logs/logpush/) logs.\n\n## Categorization process\n\nCloudflare's domain categorization engine begins with multiple data sources, including:\n\n1. Cloudflare's proprietary data using our global network.\n\n2. Third-party intelligence feeds. Cloudflare uses data from over 30 open-source intelligence feeds and premium commercial feeds, such as Avira and Zvelo.\n\nThen, the initial categorization is refined via:\n\n1. Machine learning models. Our algorithms, including DGA Domains, DNS tunneling, and phishing detection models analyze patterns and behaviors to detect new and evolving threats.\n\n2. Community feedback. Through a review process, Cloudflare assesses feedback by both our internal models and threat analysts. This ensures that our categorizations reflect the most current and accurate threat intelligence.\n\n## Terraform\n\nTerraform users can retrieve the category list with the `cloudflare_zero_trust_gateway_categories_list` data source. This allows you to create Gateway policies with the category's name rather than its numeric ID. For example:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Egress policies · Cloudflare One docs\ndescription: When your users connect to the Internet through Cloudflare Gateway,\n  by default their traffic is assigned a source IP address that is shared across\n  all Cloudflare WARP users. Enterprise users can purchase dedicated egress IPs\n  to ensure that egress traffic from your organization is assigned a unique,\n  static IP. These source IPs are dedicated to your account and can be used\n  within allowlists on upstream services.\nlastUpdated: 2025-12-19T23:24:39.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/index.md\n---\n\nNote\n\nOnly available on Enterprise plans.\n\nWhen your users connect to the Internet through Cloudflare Gateway, by default their traffic is assigned a source IP address that is shared across all Cloudflare WARP users. Enterprise users can purchase [dedicated egress IPs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/) to ensure that egress traffic from your organization is assigned a unique, static IP. These source IPs are dedicated to your account and can be used within allowlists on upstream services.\n\nEgress policies allow you to control which dedicated egress IP is used and when, based on attributes such as identity, IP address, and geolocation. Traffic that does not match an egress policy will default to using the most performant dedicated egress IP.\n\nCloudflare does not publish WARP egress IP ranges. WARP egress IPs are not documented at [Cloudflare's IP Ranges](https://cloudflare.com/ips). To obtain a dedicated WARP egress IP, contact your account team.\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Load balancing\n\nWhen using either the default Cloudflare egress IPs or any dedicated egress IPs, Gateway traffic that does not match an egress policy will egress from the closest Cloudflare data center with a default Gateway egress IP. If there are two data centers of equal distance from the user, Gateway will split the traffic between the two data centers, and the load balancer will retain the same user selection and egress IP regardless of data center.\n\n## Force IP version\n\nTo control whether only IPv4 or IPv6 is used to egress, ensure you are [filtering DNS traffic](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/dns/), then create a DNS policy to [block AAAA or A records](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/common-policies/#control-ip-version).\n\n## Example policies\n\nThe following egress policy configures all traffic destined for a third-party network to use a static source IP:\n\n| Policy name | Selector | Operator | Value | Egress method |\n| - | - | - | - | - |\n| Access third-party provider | Destination IP | is | `198.51.100.158` | Dedicated Cloudflare egress IPs |\n\n| Primary IPv4 address | IPv6 address |\n| - | - |\n| `203.0.113.88` | `2001:db8::/32` |\n\n### Catch-all policy\n\nFor the best performance, we recommend creating a catch-all policy to route all other users through the default Zero Trust IP range:\n\n| Policy name | Selector | Operator | Value | Egress method |\n| - | - | - | - | - |\n| Default egress policy | Protocol | in | `All options (Protocol)` | Cloudflare default egress method |\n\nSince Gateway policies evaluate from [top to bottom](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#order-of-precedence) in the UI, be sure to place the catch-all policy at the bottom of the list. If you do not include a catch-all policy, all other traffic will attempt to use the closest dedicated egress IP location. To control which egress IP Gateway uses, create an egress policy.\n\n## Egress methods\n\nWhen you configure your egress policy, you can choose whether to egress traffic using the default Cloudflare egress method or dedicated egress IPs.\n\n### Use default Cloudflare egress method\n\n**Use default Cloudflare egress method** uses the default source IP range shared across all Zero Trust accounts. Ensures the most performant Internet experience as user traffic egresses from the nearest Cloudflare data center.\n\n### Use dedicated egress IPs\n\n**Use dedicated egress IPs (Cloudflare or BYOIP)** uses the primary IPv4 address and IPv6 range selected in the dropdown menus.\n\nWhen creating egress policies with dedicated egress IPs, you must set a secondary IPv4 address to ensure traffic resilience. You can set the secondary IPv4 address to `0.0.0.0` or a specific Cloudflare location different from your primary IPv4 address. If you set the secondary IPv4 address to `0.0.0.0`, Gateway will route traffic to the location closest to the user. If the physical location of your primary IPv4 address is not available, Gateway will route traffic to either the default Cloudflare egress range or the secondary location specified.\n\nIf the data center associated with your primary dedicated egress IPv4 goes down, Gateway will egress from the secondary data center to avoid traffic drops during reroutes. There is no need for a secondary IPv6 because IPv6 traffic can egress from any Cloudflare data center. Dedicated egress IPs can be provided by either Cloudflare or [BYOIP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/#bring-your-own-ip-address-byoip).\n\nTo learn more about IPv4 and IPv6 egress behavior, refer to [Egress locations](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/dedicated-egress-ips/#egress-location).\n\n## Selectors\n\nGateway matches egress traffic against the following selectors, or criteria:\n\n### Application Beta\n\nYou can apply egress policies to a growing list of popular web applications. Refer to [Application and app types](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/) for more information.\n\n| UI name | API example |\n| - | - |\n| Application | `any(app.ids[*] in {505})` |\n\nThis selector is only available for traffic onboarded to Gateway with WARP, PAC files, or Browser Isolation. For more information, refer to [Selector prerequisites](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#selector-prerequisites).\n\n### Content Categories Beta\n\nApplications within a specific [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories) as categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\n| UI name | API example |\n| - | - |\n| Content Categories | `any(net.fqdn.content_category[*] in {1})` |\n\nThis selector is only available for traffic onboarded to Gateway with WARP, PAC files, or Browser Isolation. For more information, refer to [Selector prerequisites](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#selector-prerequisites).\n\n### Destination Continent\n\nThe continent where the request is destined. Geolocation is determined from the target IP address. To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Destination Continent IP Geolocation | `net.dst.geo.continent == \"EU\"` |\n\n### Destination Country\n\nThe country that the request is destined for. Geolocation is determined from the target IP address. To specify a country, enter its [ISO 3166-1 Alpha 2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Destination Country IP Geolocation | `net.dst.geo.country == \"RU\"` |\n\n### Destination IP\n\nThe IP address of the request's target.\n\n| UI name | API example |\n| - | - |\n| Destination IP | `any(net.dst.ip[*] in {10.0.0.0/8})` |\n\n### Destination Port\n\nThe port number of the request's target.\n\n| UI name | API example |\n| - | - |\n| Destination Port | `net.dst.port == 2222` |\n\n### Device Posture\n\nWith the Device Posture selector, admins can use signals from end-user devices to secure access to their internal and external resources. For example, a security admin can choose to limit all access to internal applications based on whether specific software is installed on a device and/or if the device or software are configured in a particular way.\n\nFor more information on device posture checks, refer to [Device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/).\n\n| UI name | API example |\n| - | - |\n| Passed Device Posture Checks | `any(device_posture.checks.failed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})`, `any(device_posture.checks.passed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})\"` |\n\n### Domain Beta\n\nUse this selector to match against a domain and all subdomains. For example, you can match `example.com` and its subdomains, such as `www.example.com`.\n\n| UI name | API example |\n| - | - |\n| Domain | `any(net.fqdn.domains[*] == \"example.com\")` |\n\nGateway policies do not support domains with non-Latin characters directly. To use a domain with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\nThis selector is only available for traffic onboarded to Gateway with WARP, PAC files, or Browser Isolation. For more information, refer to [Selector prerequisites](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#selector-prerequisites).\n\n### Host Beta\n\nUse this selector to match against only the hostname specified. For example, you can match `test.example.com` but not `example.com` or `www.test.example.com`.\n\n| UI name | API example |\n| - | - |\n| Host | `net.fqdn.host == \"example.com\"` |\n\nGateway policies do not support hostnames with non-Latin characters directly. To use a hostname with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\nNote\n\nSome hostnames (`example.com`) will invisibly redirect to the www subdomain (`www.example.com`). To match this type of website, use the [Domain](#domain) selector instead of the Host selector.\n\nThis selector is only available for traffic onboarded to Gateway with WARP, PAC files, or Browser Isolation. For more information, refer to [Selector prerequisites](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/#selector-prerequisites).\n\n### Protocol\n\nThe protocol used to send the packet.\n\n| UI name | API example |\n| - | - |\n| Protocol | `net.protocol == \"tcp\"` |\n\n### Proxy Endpoint\n\nThe [proxy server](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) where your browser forwards HTTP traffic.\n\n| UI name | API example |\n| - | - |\n| Proxy Endpoint | `proxy.endpoint == \"3ele0ss56t.proxy.cloudflare-gateway.com\"` |\n\n### Source Continent\n\nThe continent of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Source Continent IP Geolocation | `net.src.geo.continent == \"North America\"` |\n\n### Source Country\n\nThe country of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a country, enter its [ISO 3166-1 Alpha-2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Source Country IP Geolocation | `net.src.geo.country == \"RU\"` |\n\n### Source Internal IP\n\nUse this selector to apply egress policies to a private IP address, assigned by a user's local network, that requests arrive to Gateway from. This selector will only apply to users connected through a [Magic GRE or IPSec tunnel](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/).\n\n| UI name | API example |\n| - | - |\n| Source Internal IP | `net.src.internal_src_ip == \"192.168.86.0/27\"` |\n\n### Source IP\n\nThe originating IP address or addresses of a device proxied by Gateway.\n\n| UI name | API example |\n| - | - |\n| Source IP | `net.src.ip[*] in {10.0.0.0/8}` |\n\n### Source Port\n\nThe originating port of a device proxied by Gateway.\n\n| UI name | API example |\n| - | - |\n| Source Port | `net.src.port == \"2222\"` |\n\n### Users\n\nUse these selectors to match against identity attributes.\n\n| UI name | API example |\n| - | - |\n| User Email | `identity.email == \"user@example.com\"` |\n| User Name | `identity.name == \"Test User\"` |\n| User Group IDs | `any(identity.groups[*].id in {\"group_id\"})` |\n| User Group Names | `any(identity.groups[*].name in {\"group_name\"})` |\n| User Group Emails | `any(identity.groups[*].email in {\"group@example.com\"})` |\n| SAML Attributes | `any(identity.saml_attributes[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"] in {\"Test User\"})` |\n\n### Virtual Network\n\nUse this selector to match all traffic routed through a specific [Tunnel Virtual Network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) via the WARP client.\n\n| UI name | API example |\n| - | - |\n| Virtual Network | `net.vnet_id == \"957fc748-591a-e96s-a15d-1j90204a7923\"` |\n\n## Comparison operators\n\nComparison operators are the way Gateway matches traffic to a selector. When you choose a **Selector** in the dashboard policy builder, the **Operator** dropdown menu will display the available options for that selector.\n\n| Operator | Meaning |\n| - | - |\n| is | equals the defined value |\n| is not | does not equal the defined value |\n| in | matches at least one of the defined values |\n| not in | does not match any of the defined values |\n| in list | in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| not in list | not in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| matches regex | regex evaluates to true |\n| does not match regex | regex evaluates to false |\n| greater than | exceeds the defined number |\n| greater than or equal to | exceeds or equals the defined number |\n| less than | below the defined number |\n| less than or equal to | below or equals the defined number |\n\n## Value\n\nYou can input a single value or use regular expressions to specify a range of values.\n\nGateway uses Rust to evaluate regular expressions. The Rust implementation is slightly different than regex libraries used elsewhere. To evaluate if your regex matches, you can use [Rustexp](https://rustexp.lpil.uk/).\n\n## Logical operators\n\nTo evaluate multiple conditions in an expression, select the **And** logical operator. These expressions can be compared further with the **Or** logical operator.\n\n| Operator | Meaning |\n| - | - |\n| And | match all of the conditions in the expression |\n| Or | match any of the conditions in the expression |\n\nThe **Or** operator will only work with conditions in the same expression group. For example, you cannot compare conditions in **Traffic** with conditions in **Identity** or **Device Posture**.\n\n## Limitations\n\n### Selector prerequisites\n\nThe [Application](#application), [Content Categories](#content-categories), [Domain](#domain), and [Host](#host) selectors require configuration changes in order to be operational. Before deploying policies with these selectors, refer to [Host selectors](https://developers.cloudflare.com/cloudflare-one/traffic-policies/egress-policies/host-selectors).\n\n</page>\n\n<page>\n---\ntitle: Enable Intrusion Detection System (IDS) · Cloudflare One docs\ndescription: Cloudflare's Intrusion Detection System (IDS) is an Advanced Magic\n  Firewall feature you can use to actively monitor for a wide range of known\n  threat signatures in your traffic. An IDS expands the security coverage of a\n  firewall to analyze traffic against a broader threat database, detecting a\n  variety of sophisticated attacks such as ransomware, data exfiltration, and\n  network scanning based on signatures or “fingerprints” in network traffic.\nlastUpdated: 2025-10-31T12:47:45.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/enable-ids/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/enable-ids/index.md\n---\n\nCloudflare's Intrusion Detection System (IDS) is an Advanced Magic Firewall feature you can use to actively monitor for a wide range of known threat signatures in your traffic. An IDS expands the security coverage of a firewall to analyze traffic against a broader threat database, detecting a variety of sophisticated attacks such as ransomware, data exfiltration, and network scanning based on signatures or “fingerprints” in network traffic.\n\nWith Cloudflare's global anycast network, you get:\n\n* Cloudflare's entire global network capacity is now the capacity of your IDS.\n* Built-in redundancy and failover. Every server runs Cloudflare's IDS software, and traffic is automatically attracted to the closest network location to its source.\n* Continuous deployment for improvements to Cloudflare's IDS capabilities.\n\nRefer to [Enable IDS](https://developers.cloudflare.com/cloudflare-one/traffic-policies/enable-ids/#enable-ids) for more information on enabling IDS and creating new rulesets. After IDS is enabled, your traffic will be scanned to find malicious traffic. The detections are logged to destinations that can be configured from the dashboard. Refer to [Use Logpush with IDS](https://developers.cloudflare.com/cloudflare-one/insights/logs/use-logpush-with-ids) for instructions on configuring a destination to receive the detections. Additionally, all traffic that is analyzed can be accessed via [network analytics](https://developers.cloudflare.com/analytics/network-analytics/). Refer to [GraphQL Analytics](https://developers.cloudflare.com/magic-firewall/tutorials/graphql-analytics/) to query the analytics data.\n\nCloudflare's IDS takes advantage of the threat intelligence powered by our global network and extends the capabilities of the Cloudflare Firewall to monitor and protect your network from malicious actors.\n\n## Enable IDS\n\nYou can enable IDS through the dashboard or via the API.\n\nNote\n\nThis feature is available for Advanced Magic Firewall users. For access, contact your account team.\n\n* Dashboard\n\n  1. In the [Cloudflare One](https://one.dash.cloudflare.com) dashboard, go to **Traffic policies**.\n  2. Select **Policy settings** and turn on **IDS**.\n\n* API\n\n  To start using IDS via the API, first create a new ruleset in the `magic-transit-ids-managed` phase with a rule which is enabled.\n\n  1. Follow instructions in the [Rulesets Engine Page](https://developers.cloudflare.com/ruleset-engine/basic-operations/view-rulesets/) to view all rulesets for your account. You must see a ruleset with phase `magic-transit-ids-managed` and kind `managed`. If not, please contact your account team. The managed ruleset ID will be used in the next step.\n\n  2. Create a new root ruleset with a single rule in the `magic_transit_ids_managed` phase by running:",
      "language": "unknown"
    },
    {
      "code": "With this ruleset added, IDS will start inspecting packets and report any anomalous traffic. Next, you can [configure Logpush](https://developers.cloudflare.com/magic-firewall/how-to/use-logpush-with-ids/) to start receiving details about the anomalous traffic.\n\n  1. Use the rule created in the previous step to enable or disable IDS. The Rulesets API documentation describes [how to patch a rule](https://developers.cloudflare.com/ruleset-engine/rulesets-api/update-rule/).\\\n     \\\n     For example, the following patch request to set the `enabled` field to `false` will disable IDS. The ruleset and rule ID from the ruleset created in the previous step are used below.",
      "language": "unknown"
    },
    {
      "code": "Similarly, sending a patch request with the `enabled` field set to `true` will enable IDS.\n\n## IDS rules\n\nIDS rules are run on a subset of packets. IDS also supports the current flows:\n\n* Magic WAN to Magic WAN.\n* Magic Transit ingress traffic (when egress traffic is handled through direct server return).\n* Magic Transit ingress and egress traffic when Magic Transit has the [Egress option enabled](https://developers.cloudflare.com/reference-architecture/architectures/magic-transit/#magic-transit-with-egress-option-enabled).\n\n## Next steps\n\nYou must configure Logpush to log detected risks. Refer to [Configure a Logpush destination](https://developers.cloudflare.com/magic-firewall/how-to/use-logpush-with-ids/) for more information. Additionally, all traffic that is analyzed can be accessed via [network analytics](https://developers.cloudflare.com/analytics/network-analytics/). Refer to [GraphQL Analytics](https://developers.cloudflare.com/magic-firewall/tutorials/graphql-analytics/) to query the analytics data.\n\n</page>\n\n<page>\n---\ntitle: Global policies · Cloudflare One docs\ndescription: Cloudflare Zero Trust applies a set of global policies to all accounts.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/global-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/global-policies/index.md\n---\n\nCloudflare Zero Trust applies a set of global policies to all accounts.\n\nZero Trust logs prepend an identifier to global policy names. For example, matches for the global policy **Allow Zero Trust Services** will appear in your logs with the name **Global Policy - Allow Zero Trust Services**.\n\nThe following policies are sorted by [order of precedence](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#order-of-precedence) within each policy type.\n\n## DNS resolution policies\n\nGateway enforces global DNS and resolver policies before any other policies. This ensures the traffic is not blocked by user policies and gets resolved with Cloudflare's public DNS resolver, [1.1.1.1](https://developers.cloudflare.com/1.1.1.1/). Each global DNS policy evaluates traffic based on the domain in the query.\n\n| Name | ID | Value | Action |\n| - | - | - | - |\n| Allow DNS queries for cloudflareclient.com domain | `00000001-e139-4a1b-90d5-698d8fa371e0` | `cloudflareclient.com` | allow |\n| Resolve cloudflareclient.com through 1.1.1.1 | `00000001-e738-4554-823b-0b2c75af2c66` | `cloudflareclient.com` | resolve |\n| Allow DNS queries for content.browser.run domain | `00000001-9bff-4d83-a9e4-e5ed321fe0b9` | `content.browser.run` | allow |\n| Resolve content.browser.run through 1.1.1.1 | `00000001-0df5-472b-80c0-02888e7167ee` | `content.browser.run` | resolve |\n| Allow DNS queries for edge.browser.run and cloudflarebrowser.com domains | `00000001-e2f1-4e99-bab3-91df88879587` | `edge.browser.run` and `cloudflarebrowser.com` | allow |\n| Resolve edge.browser.run and cloudflarebrowser.com through 1.1.1.1 | `00000001-b103-44c6-a114-7a784cdf3fb7` | `edge.browser.run` and `cloudflarebrowser.com` | resolve |\n| Allow DNS queries for help.teams.cloudflare.com and help.one.cloudflare.com domains | `00000001-b2fc-46db-b0f1-69ef3553bd7a` | `help.teams.cloudflare.com` and `help.one.cloudflare.com` | allow |\n| Resolve help.teams.cloudflare.com and help.one.cloudflare.com through 1.1.1.1 | `00000001-ce13-486a-b006-ba0435ccb013` | `help.teams.cloudflare.com` and `help.one.cloudflare.com` | resolve |\n| Allow DNS queries for cloudflare-gateway.com domain | `00000001-e83d-492b-995e-351970cd5e8e` | `cloudflare-gateway.com` | allow |\n| Resolve cloudflare-gateway.com through 1.1.1.1 | `00000001-d9bc-4913-a2f5-905dbb3ecf9a` | `cloudflare-gateway.com` | resolve |\n| Allow DNS queries for cloudflarestatus.com domain | `00000001-78da-4f8a-b9ee-76563f1ec46b` | `cloudflarestatus.com` | allow |\n| Resolve cloudflarestatus.com through 1.1.1.1 | `00000001-4d1d-43a3-9015-c49fc3a6da31` | `cloudflarestatus.com` | resolve |\n| Allow DNS queries for nel.cloudflare.com domain | `00000001-af28-4afa-8987-eadc21187e14` | `nel.cloudflare.com` | allow |\n| Resolve nel.cloudflare.com through 1.1.1.1 | `00000001-0034-45a0-8333-f339451fba46` | `nel.cloudflare.com` | resolve |\n| Allow DNS queries for api.cloudflare.com domain | `00000001-5eea-4932-8dd5-8e1ec9770396` | `api.cloudflare.com` | allow |\n| Resolve api.cloudflare.com through 1.1.1.1 | `00000001-4f0c-4f86-9b96-5d26123a194b` | `api.cloudflare.com` | resolve |\n| Allow DNS queries for dash.teams.cloudflare.com domain | `00000001-0f75-48a9-b3e1-925a974d2b65` | `dash.teams.cloudflare.com` | allow |\n| Resolve dash.teams.cloudflare.com through 1.1.1.1 | `00000001-3d84-41a6-bc84-3014685c0d81` | `dash.teams.cloudflare.com` | resolve |\n| Allow DNS queries for one.dash.cloudflare.com domain | `00000001-a9fd-40de-a662-51d3a3ae0ad8` | `one.dash.cloudflare.com` and `one.dash.fed.cloudflare.com` | allow |\n| Resolve one.dash.cloudflare.com through 1.1.1.1 | `00000001-70f2-4eea-b711-201bca434ed4` | `one.dash.cloudflare.com` and `one.dash.fed.cloudflare.com` | resolve |\n| Allow DNS queries for dash.cloudflare.com domain | `00000001-0c2a-4b31-8606-3e5a1d87c1bf` | `dash.cloudflare.com` and `dash.fed.cloudflare.com` | allow |\n| Resolve dash.cloudflare.com through 1.1.1.1 | `00000001-c47f-41f3-b234-d66c82b8d422` | `dash.cloudflare.com` and `dash.fed.cloudflare.com` | resolve |\n| Allow DNS queries for cloudflareportal.com, cloudflareok.com and cloudflarecp.com domains | `00000001-1c6c-4793-b48f-799eee6e0e31` | `cloudflareportal.com`, `cloudflareok.com`, and `cloudflarecp.com` | allow |\n| Resolve cloudflareportal.com, cloudflareok.com and cloudflarecp.com through 1.1.1.1 | `00000001-8c35-4d7d-9dbb-cb7350375b7b` | `cloudflareportal.com`, `cloudflareok.com`, and `cloudflarecp.com` | resolve |\n| Allow DNS queries for cloudflareaccess.com domain | `00000001-d738-4dad-bac4-1a50201d9503` | `cloudflareaccess.com` | allow |\n| Resolve cloudflareaccess.com through 1.1.1.1 | `00000001-4404-4572-80f6-f7b098909460` | `cloudflareaccess.com` | resolve |\n| Allow DNS queries for blocked.teams.cloudflare.com domain | `00000001-76f4-4438-b8ab-a9da53f4a2f1` | `blocked.teams.cloudflare.com` and `blocked.teams.fed.cloudflare.com` | allow |\n| Resolve blocked.teams.cloudflare.com through 1.1.1.1 | `00000001-af3c-458f-aeb2-b3bb5d3fe1d5` | `blocked.teams.cloudflare.com` and `blocked.teams.fed.cloudflare.com` | resolve |\n| Allow DNS queries for developers.cloudflare.com domain | `00000001-4263-4808-8457-4d4329c91f66` | `developers.cloudflare.com` | allow |\n| Resolve developers.cloudflare.com through 1.1.1.1 | `00000001-9f91-4462-9270-78beca5b4dbc` | `developers.cloudflare.com` | resolve |\n| Allow DNS queries for speed.cloudflare.com domain | `00000001-4fc0-4286-b783-6c442adda171` | `speed.cloudflare.com` | allow |\n| Resolve speed.cloudflare.com through 1.1.1.1 | `00000001-ec51-4471-9e78-bd47d46a3002` | `speed.cloudflare.com` | resolve |\n| Allow DNS requests to browser-rendered Access Apps | `00000001-1232-4a9f-a165-1e8ed59483c4` | `*.zero-trust-apps.cfdata.org`, `*.zero-trust-apps-staging.cfdata.org`, `*.zero-trust-apps.fed.cfdata.org`, or `*.zero-trust-apps-staging.fed.cfdata.org` | allow |\n| Resolve browser-rendered Access Apps domains through 1.1.1.1 | `00000001-9461-43c7-ba63-d0fdf9376bd4` | `*.zero-trust-apps.cfdata.org`, `*.zero-trust-apps-staging.cfdata.org`, `*.zero-trust-apps.fed.cfdata.org`, or `*.zero-trust-apps-staging.fed.cfdata.org` | resolve |\n\n## Network proxy policies\n\n| Name | ID | Criteria | Value | Action | Description |\n| - | - | - | - | - | - |\n| Allow CF Network Error Logging L4 | `00000001-e4af-4b82-8f8c-c79c1d5d212e` | Hostname | `*.nel.cloudflare.com` | allow | Allows SNI domains for WARP registration. |\n| Allow CF Client | `00000001-8c3d-4e27-a01b-af8418000077` | Hostname | `*.cloudflareclient.com` and `*.fed.cloudflareclient.com` | allow | Allows Zero Trust client. |\n| Allow Gateway Proxy PAC | `00000001-776e-438d-9856-987d7053762b` | Hostname | `*.cloudflare-gateway.com` and `*.fed.cloudflare-gateway.com` | allow | Allows Gateway proxy with [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/). |\n| Allow Zero Trust Services | `00000001-e1e8-421b-a0fe-895397489f28` | Hostname | `dash.teams.cloudflare.com`, `help.teams.cloudflare.com`, `blocked.teams.cloudflare.com`, `blocked.teams.fed.cloudflare.com`, `api.cloudflare.com`, `api.fed.cloudflare.com`, `cloudflarestatus.com`, `www.cloudflarestatus.com`, `one.dash.cloudflare.com`, `one.dash.fed.cloudflare.com`, `help.one.cloudflare.com`, `dash.cloudflare.com`, `dash.fed.cloudflare.com`, and `developers.cloudflare.com` | allow | Allows Cloudflare Zero Trust services. |\n| Allow Access Apps L4 | `00000001-daa2-41e2-8a88-698af4066951` | Hostname | `*.cloudflareaccess.com` and `*.fed.cloudflareaccess.com` | allow | Allows [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) applications. |\n| Allow HTTP requests to browser-rendered Access Apps | `00000001-1f93-4476-8f92-9aa4407d1c5f` | Hostname | `*.zero-trust-apps.cfdata.org`, `*.zero-trust-apps-staging.cfdata.org`, `*.zero-trust-apps.fed.cfdata.org`, or `*.zero-trust-apps-staging.fed.cfdata.org` | allow | Allows Cloudflare Access terminal applications [rendered in a browser](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/browser-rendering/#ssh-and-vnc). |\n\n## HTTP inspection policies\n\n| Name | ID | Criteria | Value | Action | Description |\n| - | - | - | - | - | - |\n| Prevent Account Change Block | `00000001-d1f2-461a-8253-501c8d882a15` | Hostname | `*.cloudflareclient.com` and `*.fed.cloudflareclient.com`; not `notifications.cloudflareclient.com` or `notifications.fed.cloudflareclient.com` | bypass | Ensures users cannot accidentally block themselves from making account changes. |\n| Bypass RBI Assets | `00000001-df61-4068-aa6c-0f684c3cd4e6` | Hostname | `*.content.browser.run` | bypass | Required for [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/). |\n| Inspect RBI Urls | `00000001-3faa-4f59-98d4-0f6d6af4b6d0` | Hostname | `*.edge.browser.run` and `*.cloudflarebrowser.com` | bypass | Required for Browser Isolation. |\n| Allow Gateway Help Page | `00000001-8e9a-4429-b3c2-d267d0ce6114` | Hostname | `help.teams.cloudflare.com` and `help.one.cloudflare.com` | allow | Used by the WARP client to check if Gateway is on by inspecting the certificate and checking if it is properly installed on the client device. |\n| Bypass Gateway DNS | `00000001-d9c0-46b0-8704-2ea5b9d7bdfc` | Hostname | `*.cloudflare-gateway.com` and `*.fed.cloudflare-gateway.com` | bypass | Ensures requests to the `cloudflare-gateway.com` DNS endpoint will not be inspected. |\n| Bypass CF Status | `00000001-5399-4b71-a9fc-d4d90ccf0758` | Hostname | `*.cloudflarestatus.com` | bypass | Bypasses `cloudflarestatus.com` so users can reach the status page in case of a Gateway outage. |\n| Bypass CF Network Error Logging | `00000001-dfe0-4737-8d1e-8191e8f637df` | Hostname | `*.nel.cloudflare.com` | bypass | Bypasses `*.nel.cloudflarestatus.com` for Cloudflare's network error logging feature. |\n| Bypass CF API | `00000001-a424-43fb-b1f1-d3eb35ed7ddd` | Hostname | `api.cloudflare.com` and `api.fed.cloudflare.com` | bypass | Bypasses Cloudflare's API endpoint. |\n| Prevent ZT Dashboard Lockout | `00000001-d38e-42db-96fe-60613b6b308f` | Hostname | `dash.teams.cloudflare.com`, `one.dash.cloudflare.com`, and `one.dash.fed.cloudflare.com` | bypass | Prevents users from being locked out of the Zero Trust dashboard. |\n| Bypass CF Dashboard | `00000001-d343-4ded-908e-b3fe43c5e61e` | Hostname | `*.dash.cloudflare.com` and `*.dash.fed.cloudflare.com` | bypass | Bypasses the Cloudflare dashboard and subdomains. |\n| Bypass Zero Trust Captive Portal Sites | `00000001-8b62-4367-919e-5c160a06ddf7` | Hostname | `cloudflareportal.com`, `cloudflareok.com`, and `cloudflarecp.com` | bypass | Bypasses the Zero Trust captive portal detection sites. |\n| Bypass OCSP | `00000001-34ce-47c7-ad0f-199f46eba194` | Application | Online Certificate Status Protocol | bypass | Enables OCSP stapling. |\n| Allow Access Apps L7 | `00000001-8d6b-4951-8a18-3bbc9010976c` | Hostname | `*.cloudflareaccess.com` and `*.fed.cloudflareaccess.com` | allow | Allows Cloudflare Access applications. |\n| Prevent Block Page Loop | `00000001-48b1-4ade-93c1-f0f3759dc19c` | Hostname | `blocked.teams.cloudflare.com` and `blocked.teams.fed.cloudflare.com` | bypass | Prevents an infinite loop on the Gateway block page. |\n| Always Blocked Categories | `00000001-bed5-462e-b0f1-2e2c3555e9f7` | Content Category | [Child Abuse category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#category-and-subcategory-ids) | block | Blocks child abuse materials (CSAM). |\n| Don't Isolate RBI Help Pages | `00000001-1a18-431f-9c9d-bce431f1002a` | Hostname | `developers.cloudflare.com` and `help.cloudflarebrowser.com` | noisolate | Prevents browser isolation of Cloudflare developer docs and help pages to help users troubleshoot configuration issues. |\n| Don't AV Scan CF Speed | `00000001-c194-408f-87dd-9a366ce76e12` | Hostname | `speed.cloudflare.com` | noscan | Allows files transferred by the Cloudflare speed test. |\n\n</page>\n\n<page>\n---\ntitle: Identity-based policies · Cloudflare One docs\ndescription: With Cloudflare One, you can create Secure Web Gateway policies\n  that filter outbound traffic down to the user identity level. To do that, you\n  can build DNS, HTTP or Network policies using a set of identity-based\n  selectors. These selectors require you to deploy the Zero Trust WARP client in\n  Gateway with WARP mode.\nlastUpdated: 2025-10-29T14:53:33.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/identity-selectors/index.md\n---\n\nWith Cloudflare One, you can create Secure Web Gateway policies that filter outbound traffic down to the user identity level. To do that, you can build DNS, HTTP or Network policies using a set of [identity-based selectors](#identity-based-selectors). These selectors require you to deploy the Zero Trust WARP client in [Gateway with WARP mode](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/).\n\nYou may also filter outbound traffic based on additional signals from [device posture checks](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/).\n\n## Gateway identity checks\n\nGateway checks identity when a user logs in or re-authenticates. To check your users' identities and require re-authentication at regular intervals, you can [enforce a WARP client session duration](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-sessions/).\n\nUnless you use an [IdP that supports SCIM provisioning](#automatic-scim-idp-updates), Gateway will not detect when you add or remove a user from a group in your IdP until the user re-authenticates to your Zero Trust instance. There are two ways a user can re-authenticate:\n\n* Log out from an Access-protected application and log back in.\n* In their WARP client settings, select **Preferences** > **Account** > **Re-Authenticate Session**. This will open a browser window and prompt the user to log in.\n\nTo view the identity that Gateway will use when evaluating policies, check the [user registry](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/users/).\n\n### Automatic SCIM IdP updates\n\nGateway will automatically detect changes in user name, title, and group membership for IdPs configured with System for Cross-domain Identity Management (SCIM) provisioning. For more information, refer to [SCIM provisioning](https://developers.cloudflare.com/cloudflare-one/team-and-resources/users/scim/).\n\n### Extended email addresses\n\nExtended email addresses (also known as plus addresses) are variants of an existing email address with `+` or `.` modifiers. Many email providers, such as Gmail and Outlook, deliver emails intended for an extended address to its original address. For example, providers will deliver emails sent to `contact+123@example.com` or `con.tact@example.com` to `contact@example.com`.\n\nBy default, Gateway will either filter only exact matches or all extended variants depending on the type of policy and action used:\n\nDNS policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Block | Match exact address and all variants |\n| Override | Match exact address and all variants |\n| Safe Search | Match exact address and all variants |\n| YouTube Restricted | Match exact address and all variants |\n\nNetwork policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Audit SSH | Match exact address and all variants |\n| Block | Match exact address and all variants |\n| Network Override | Match exact address only |\n\nHTTP policies\n\n| Action | Behavior |\n| - | - |\n| Allow | Match exact address only |\n| Block | Match exact address and all variants |\n| Do Not Inspect | Match exact address only |\n| Do Not Isolate | Match exact address only |\n| Do Not Scan | Match exact address only |\n| Isolate | Match exact address and all variants |\n\nOther policies\n\n| Policy type | Behavior |\n| - | - |\n| Egress policy | Match exact address only |\n| Resolver policy | Match exact address only |\n\nTo force Gateway to match all email address variants, go to **Traffic policies** > **Traffic settings** > **Policy settings** and turn on **Match extended email addresses**. This setting applies to all firewall, egress, and resolver policies.\n\n## Identity-based selectors\n\n### SAML Attributes\n\nSpecify a value from the SAML Attribute Assertion.\n\n| UI name | API example |\n| - | - |\n| SAML Attributes | `identity.saml_attributes == \"\\\"group=finance\\\"\"` |\n\n### User Email\n\nUse this selector to create identity-based Gateway policies based on a user's email.\n\n| UI name | API example value |\n| - | - |\n| User Email | `identity.email == \"user-name@company.com\"` |\n\n### User Group IDs\n\nUse this selector to create identity-based Gateway policies based on an IdP group ID of which the user is configured as a member in the IdP.\n\n| UI name | API example |\n| - | - |\n| User Group IDs | `identity.groups.id == \"12jf495bhjd7893ml09o\"` |\n\n### User Group Email\n\nUse this selector to create identity-based Gateway policies based on an IdP group email address of which the user is configured as a member in the IdP.\n\n| UI name | API example |\n| - | - |\n| User Group Email | `identity.groups.email == \"contractors@company.com\"` |\n\n### User Group Names\n\nUse this selector to create identity-based Gateway policies based on an IdP group name of which the user is configured as a member in the IdP.\n\n| UI name | API example |\n| - | - |\n| User Group Names | `identity.groups.name == \"\\\"finance\\\"\"` |\n\n### User Name\n\nUse this selector to create identity-based Gateway policies based on an IdP username for a particular user in the IdP.\n\n| UI name | API example |\n| - | - |\n| User Name | `identity.name == \"user-name\"` |\n\nGateway groups vs. Access rule groups\n\nIn Gateway, a **User Group** refers to a group in your IdP (for example, an Okta group). Gateway does not currently support applying DNS, HTTP, and Network policies to [Access rule groups](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/groups/). This is because Access rule groups may include criteria not available through the IdP, such as device location or IP address.\n\n## IdP groups in Gateway\n\nCloudflare Gateway can integrate with your organization's identity providers (IdPs). Before building a Gateway policy for IdP users or groups, be sure to [add the IdP as an authentication method](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/).\n\nBecause IdPs expose user groups in different formats, reference the list below to choose the appropriate identity-based selector.\n\n### Microsoft Entra ID\n\n| Selector | Value |\n| - | - |\n| User Group IDs | `61503835-b6fe-4630-af88-de551dd59a2` |\n\n**Value** is the [Object Id](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#entra-groups-in-zero-trust-policies) for an Entra group.\n\nIf you enabled user and group synchronization with [SCIM](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#synchronize-users-and-groups), the synchronized groups will appear under *User Group Names*:\n\n| Selector | Value |\n| - | - |\n| User Group Names | `SCIM group` |\n\n### GitHub\n\n| Selector | Value |\n| - | - |\n| User Group Names | `Marketing` |\n\n### Google\n\n| Selector | Value |\n| - | - |\n| User Group Names | `Marketing` |\n\n### Okta (OIDC)\n\nIf you added Okta as an [OIDC provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/), use the User Group Names selector:\n\n| Selector | Value |\n| - | - |\n| User Group Names | `Marketing` |\n\nThe Okta OIDC integration supports user and group synchronization with [SCIM](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta/#synchronize-users-and-groups).\n\n### Okta (SAML)\n\nIf you added Okta as a [SAML provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/okta-saml/), use the SAML Attributes selector:\n\n| Selector | Attribute name | Attribute value |\n| - | - | - |\n| SAML Attributes | `groups` | `Marketing` |\n\n### Generic SAML IdP\n\nFor a [generic SAML provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/generic-saml/), use the SAML Attribute selector:\n\n| Selector | Attribute name | Attribute value |\n| - | - | - |\n| SAML Attributes | `department` | `Marketing` |\n\n### Generic OIDC IdP\n\nCustom OIDC claims are not supported in Gateway policies.\n\n</page>\n\n<page>\n---\ntitle: HTTP policies · Cloudflare One docs\ndescription: HTTP policies allow you to intercept all HTTP and HTTPS requests\n  and either block, allow, or override specific elements such as websites, IP\n  addresses, and file types. HTTP policies operate on Layer 7 for all TCP (and\n  optionally UDP) traffic. By default, Gateway inspects HTTP traffic on port 80\n  and, with TLS decryption turned on, HTTPS traffic on port 443. You can also\n  configure Gateway to inspect HTTP/HTTPS traffic on all ports.\nlastUpdated: 2025-12-15T23:07:53.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/index.md\n---\n\nNote\n\nTo use HTTP policies, install a [Cloudflare root certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/) or a [custom certificate](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/custom-certificate/).\n\nHTTP policies allow you to intercept all HTTP and HTTPS requests and either block, allow, or override specific elements such as websites, IP addresses, and file types. HTTP policies operate on Layer 7 for all TCP (and [optionally UDP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/#1-connect-to-gateway)) traffic. By default, Gateway inspects HTTP traffic on port `80` and, with [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/) turned on, HTTPS traffic on port `443`. You can also configure Gateway to [inspect HTTP/HTTPS traffic on all ports](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/#inspect-on-all-ports).\n\nAn HTTP policy consists of an **Action** as well as a logical expression that determines the scope of the policy. To build an expression, you need to choose a **Selector** and an **Operator**, and enter a value or range of values in the **Value** field. You can use **And** and **Or** logical operators to evaluate multiple conditions.\n\n* [Actions](#actions)\n* [Selectors](#selectors)\n* [Comparison operators](#comparison-operators)\n* [Value](#value)\n* [Logical operators](#logical-operators)\n\nIf a condition in an expression joins a query attribute (such as *Source IP*) and a response attribute (such as *Resolved IP*), then the condition will be evaluated when the response is received.\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Actions\n\nActions in HTTP policies allow you to choose what to do with a given set of elements (domains, IP addresses, file types, and so on). You can assign one action per policy.\n\n### Allow\n\nAPI value: `allow`\n\nAvailable selectors\n\n**Traffic**\n\n* [Access Infrastructure Target](#access-infrastructure-target)\n* [Access Private App](#access-private-app)\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [DLP Profile](#dlp-profile)\n* [Domain](#domain)\n* [Download File Types](#download-and-upload-file-types)\n* [Download Mime Type](#download-and-upload-mime-type)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [HTTP Response](#http-response)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Categories](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Upload File Types](#download-and-upload-file-types)\n* [Upload Mime Type](#download-and-upload-mime-type)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Allow action allows outbound traffic to reach destinations you specify within the [Selectors](#selectors) and [Value](#value) fields. For example, the following configuration allows traffic to reach all websites we categorize as belonging to the Education content category:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Content Categories | in | *Education* | Allow |\n\n#### Untrusted certificates\n\nThe **Untrusted certificate action** determines how to handle insecure requests.\n\n| Option | Action |\n| - | - |\n| Error | Display Gateway error page. Matches the default behavior when no action is configured. |\n| Block | Display [block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) as set in Cloudflare One. |\n| Pass through | Bypass insecure connection warnings and seamlessly connect to the upstream. For more information on what statuses are bypassed, refer to the [troubleshooting FAQ](https://developers.cloudflare.com/cloudflare-one/faq/troubleshooting/#i-see-error-526-when-browsing-to-a-website). |\n\n### Block\n\nAPI value: `block`\n\nAvailable selectors\n\n**Traffic**\n\n* [Access Infrastructure Target](#access-infrastructure-target)\n* [Access Private App](#access-private-app)\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [DLP Profile](#dlp-profile)\n* [Domain](#domain)\n* [Download File Types](#download-and-upload-file-types)\n* [Download Mime Type](#download-and-upload-mime-type)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [HTTP Response](#http-response)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Categories](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Upload File Types](#download-and-upload-file-types)\n* [Upload Mime Type](#download-and-upload-mime-type)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Block action blocks outbound traffic from reaching destinations you specify within the [Selectors](#selectors) and [Value](#value) fields. For example, the following configuration blocks users from being able to upload any file type to Google Drive:\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| Application | in | `Google Drive` | And | Block |\n| Upload Mime Type | matches regex | `.*` | | |\n\n#### WARP client block notifications\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/plans/zero-trust-services/) |\n| - | - |\n| * Gateway with WARP\n* Secure Web Gateway without DNS filtering | Enterprise |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows | ✅ | 2024.1.159.0 |\n| macOS | ✅ | 2024.1.160.0 |\n| Linux | ❌ | |\n| iOS | ✅ | 1.7 |\n| Android | ✅ | 1.4 |\n| ChromeOS | ✅ | 1.4 |\n\nTurn on **Display block notification for WARP Client** to display notifications for Gateway block events. Blocked users will receive an operating system notification from the WARP client with a custom message you set. If you do not set a custom message, the WARP client will display a default message. Custom messages must be 100 characters or less. WARP will only display one notification per minute.\n\nUpon selecting the notification, WARP will direct your users to the [Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) you have configured. Optionally, you can direct users to a custom URL, such as an internal support form.\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\nEnsure that your operating system allows notifications for WARP. Your device may not display notifications if focus, do not disturb, or screen sharing settings are turned on. To turn on client notifications on macOS devices running DisplayLink software, you may have to allow system notifications when mirroring your display. For more information, refer to the [macOS documentation](https://support.apple.com/guide/mac-help/change-notifications-settings-mh40583/mac).\n\n### Redirect\n\nAPI value: `redirect`\n\nAvailable selectors\n\n**Traffic**\n\n* [Access Infrastructure Target](#access-infrastructure-target)\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Domain](#domain)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Redirect action allows you to redirect matched HTTP requests to a different URL you specify. For example, if your users browse to the public web page of a SaaS app, you can redirect them to your own self-hosted instance, a single sign-on page, or an internal policy page.\n\nTo redirect URLs with a Block action and the block page, refer to [Redirect to a block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#redirect-to-a-block-page).\n\n#### Policy settings\n\nIn **Policy URL redirect**, you can define what URL to redirect matched requests to. The redirect URL can contain paths and queries. For example, you can redirect `example.com` to `cloudflare.com/path/to/page?querystring=x`.\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\nWhen you turn on **Preserve original path and query string**, Gateway will append the original path and query string to the redirected URL. Paths and queries in the redirect URL take precedence over the original URL. For example, if the original URL is `example.com/path/to/page?querystring=X` and the redirect URL is `cloudflare.com/redirect-path?querystring=Y`, Gateway will redirect requests to:",
      "language": "unknown"
    },
    {
      "code": "When you turn on both options, Gateway will preserve the original path and query string, then append policy context to the end of the redirect URL. For example, if the original URL is `example.com/path/to/page?querystring=X&k=1` and the redirect URL is `cloudflare.com/redirect-path?querystring=Y`, Gateway will redirect requests to:",
      "language": "unknown"
    },
    {
      "code": "### Isolate\n\nAPI value: `isolate`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Domain](#domain)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Isolate action serves matched traffic to users via [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/). For more information on this action, refer to [Isolation policies](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#isolate).\n\n### Do Not Inspect\n\nAPI value: `off`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Domain](#domain)\n* [Host](#host)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nVisibility limitation\n\nWhen you create a Do Not Inspect policy for a given hostname, application, or app type, you will lose the ability to log or block HTTP requests, apply DLP policies, and perform AV scanning.\n\nInformation contained within HTTPS encryption, such as the full requested URL, will not be visible if it bypasses Gateway inspection. However, you can still apply [network policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) to this traffic. For more information, refer to [TLS decryption](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/).\n\nDo Not Inspect lets you bypass certain elements from inspection. To prevent Gateway from decrypting and inspecting HTTPS traffic, your policy must match against the Server Name Indicator (SNI) in the TLS header. When accessing a Do Not Inspect site in the browser, your browser may display a **Your connection is not private** warning, which you can proceed through to connect. For more information about applications which may require a Do Not Inspect policy, refer to [TLS decryption limitations](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/tls-decryption/#inspection-limitations).\n\nAll Do Not Inspect rules are evaluated first, before any Allow or Block rules, to determine if inspection should occur. For more information, refer to [Order of enforcement](https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/#http-policies).\n\n### Do Not Isolate\n\nAPI value: `noisolate`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Domain](#domain)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Do Not Isolate action turns off browser isolation for matched traffic. For more information on this action, refer to [Isolation policies](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#do-not-isolate).\n\n### Do Not Scan\n\nAPI value: `noscan`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Domain](#domain)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nWhen an admin enables AV scanning for uploads and/or downloads, Gateway will scan every supported file. Admins can selectively choose to disable scanning by leveraging the HTTP rules. For example, to prevent AV scanning of files uploaded to or downloaded from `example.com`, an admin would configure the following rule:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Hostname | matches regex | `.*example.com` | Do Not Scan |\n\nWhen a Do Not Scan rule matches, nothing is scanned, regardless of file size or whether the file type is supported or not.\n\n### Quarantine\n\nAPI value: `quarantine`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Domain](#domain)\n* [Host](#host)\n* [HTTP Method](#http-method)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [URL](#url)\n* [URL Path](#url-path)\n* [URL Path & Query](#url-path-and-query)\n* [URL Query](#url-query)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nThe Quarantine action sends files in matching requests to a file sandbox to scan for malware. Gateway will only quarantine files not previously seen in the file sandbox. For more information on this action, refer to [File sandboxing](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/file-sandboxing/).\n\n#### Sandbox file types\n\nIn **Sandbox file types**, you can select which file types to quarantine with your policy. You must select at least one file type.\n\nFile sandboxing supports scanning the following file types:\n\nSupported sandboxing file types\n\n* `.exe`\n* `.pdf`\n* `.doc`\n* `.docm`\n* `.docx`\n* `.rtf`\n* `.ppt`\n* `.pptx`\n* `.xls`\n* `.xlsm`\n* `.xlsx`\n* `.zip`\n* `.rar`\n\n## Selectors\n\nNote\n\nPolicies created using the URL selector are case-sensitive.\n\nGateway matches HTTP traffic against the following selectors, or criteria:\n\n### Access Infrastructure Target\n\nAll [targets](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/#1-add-a-target) secured by an [Access infrastructure application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/).\n\n| UI name | API example |\n| - | - |\n| Access Infrastructure Target | `access.target` |\n\n### Access Private App\n\nAll destination IPs and hostnames secured by an [Access self-hosted private application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/self-hosted-private-app/).\n\n| UI name | API example |\n| - | - |\n| Self-hosted Access App with Private Address | `access.private_app` |\n\n### Application Approval Status\n\nThe review approval status of an application from [Shadow IT Discovery](https://developers.cloudflare.com/cloudflare-one/insights/analytics/shadow-it-discovery/) or the [Application Library](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/). For more information, refer to [Review applications](https://developers.cloudflare.com/cloudflare-one/team-and-resources/app-library/#review-applications).\n\n| UI name | API example |\n| - | - |\n| Application Status | `any(app.statuses[*] == \"approved\")` |\n\n### Application\n\nYou can apply HTTP policies to a growing list of popular web applications. Refer to [Application and app types](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/) for more information.\n\n| UI name | API example |\n| - | - |\n| Application | `any(app.ids[*] in {505})` |\n\nMultiple API selectors required for Terraform\n\nWhen using Terraform to create a policy with the [Do Not Inspect](#do-not-inspect) action, you must use the `app.hosts_ids` and `app.supports_ids` selectors. For example, to create a Do Not Inspect policy for Google Cloud Platform traffic, create a policy with both `any(app.hosts_ids[*] in {1245})` and `any(app.supports_ids[*] in {1245})`.\n\n#### Granular controls\n\nWhen using the *is* operator with the *Application* selector, you can use Application Granular Controls to choose specific actions and operations to match application traffic. For example, you can block file uploads to ChatGPT without blocking all ChatGPT traffic:\n\n| Selector | Operator | Value | Controls | Action |\n| - | - | - | - | - |\n| Application | is | *ChatGPT* | *Upload* | Block |\n\nYou can match traffic based on **Application Controls**, which group multiple user actions together, or **Operations**, which allow for granular control of supported API-level actions for an application.\n\nFor more information, refer to [Application Granular Controls](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/granular-controls/).\n\n### Body Phase\n\nThe phase of an HTTP request. You can use this selector to specify whether to scan either the data sent in an HTTP request to your user's device or from your user's device to a destination. Policies without this selector will scan both the HTTP request and response bodies.\n\n| UI name | API example |\n| - | - |\n| Body Phase | `http.body_phase == \\\"download\\\"` |\n\nBody phase mismatch\n\nWhen combining this selector with the [Download and Upload File Types selectors](#download-and-upload-file-types), ensure you use the matching phase togethers. If body phase and file type selector logic do not match, the policy may not filter traffic as intended.\n\n### Content Categories\n\nApplications within a specific [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories) as categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\n| UI name | API example |\n| - | - |\n| Content Categories | `any(http.request.uri.content_category[*] in {1})` |\n\n### Destination Continent\n\nNote\n\nOnly applies to traffic sent through the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/#gateway-with-warp-default).\n\nThe continent where the request is destined. Geolocation is determined from the target IP address. To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Destination Continent IP Geolocation | `http.dst_ip.geo.continent == \"EU\"` |\n\n### Destination Country\n\nNote\n\nOnly applies to traffic sent through the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/#gateway-with-warp-default).\n\nThe country that the request is destined for. Geolocation is determined from the target IP address. To specify a country, enter its [ISO 3166-1 Alpha 2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Destination Country IP Geolocation | `http.dst_ip.geo.country == \"RU\"` |\n\n### Destination IP\n\nNote\n\nOnly applies to traffic sent through the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/set-up-warp/#gateway-with-warp-default).\n\nThe IP address of the request's target.\n\n| UI name | API example |\n| - | - |\n| Destination IP | `any(http.conn.dst_ip[*] in {10.0.0.0/8})` |\n\n### Device Posture\n\nWith the Device Posture selector, admins can use signals from end-user devices to secure access to their internal and external resources. For example, a security admin can choose to limit all access to internal applications based on whether specific software is installed on a device and/or if the device or software are configured in a particular way.\n\nFor more information on device posture checks, refer to [Device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/).\n\n| UI name | API example |\n| - | - |\n| Passed Device Posture Checks | `any(device_posture.checks.failed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})`, `any(device_posture.checks.passed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})\"` |\n\n### Domain\n\nUse this selector to match against a domain and all subdomains. For example, you can match `example.com` and its subdomains, such as `www.example.com`.\n\n| UI name | API example |\n| - | - |\n| Domain | `any(http.request.domains[*] == \"example.com\")` |\n\nGateway policies do not support domains with non-Latin characters directly. To use a domain with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\n### Download and Upload File Size\n\nUse these selectors to limit the file size of upload or download transactions. File sizes are measured in mebibytes (MiB).\n\n| UI name | API example |\n| - | - |\n| Download File Size (MiB) | `http.download.file.size >= 10` |\n\n| UI name | API example |\n| - | - |\n| Upload File Size (MiB) | `http.upload.file.size < 10` |\n\n### Download and Upload File Types\n\nDeprecated selectors\n\nThe *Download File Types* and *Upload File Types* selectors supersede the *Download File Type* and *Upload File Type* selectors. Gateway will still evaluate policies with the previous selectors. However, Cloudflare recommends migrating any policies with deprecated selectors to the new corresponding selectors.\n\nThese selectors will scan file signatures in the HTTP body. You can select from file categories or [specific file types](#supported-file-types), such as executables, archives and compressed files, unscannable files, Microsoft 365/Office documents, and Adobe files.\n\n| UI name | API example |\n| - | - |\n| Download File Types | `any(http.download.file.types[*] in {\"docx\" \"7z\"})` |\n\n| UI name | API example |\n| - | - |\n| Upload File Types | `any(http.upload.file.types[*] in {\"compressed\"})` |\n\n#### Supported file types\n\nGateway supports the following file types for use with the *Download File Types* and *Upload File Types* selectors:\n\nCompressed\n\n* 7-Zip archive (`.7z`)\n* `bzip2` archive (`.bz2`)\n* GNU Gzip archive (`.gz`)\n* Microsoft Cabinet file (`.cab`)\n* Microsoft Compiled HTML Help file (`.chm`)\n* RAR archive (`.rar`)\n* `xz` archive (`.xz`)\n* ZIP archive (`.zip`)\n\nDocuments\n\n* Microsoft Office/365 files\n\n  * Word document (`.doc`, `.docx`, `.docm`)\n  * Excel spreadsheet (`.xls`, `.xlsx`, `.xlsm`)\n  * PowerPoint presentation (`.ppt`, `.pptx`, `.pptm`)\n\n* PDF document (`.pdf`)\n\nExecutable\n\n* Apple Software Package (`.pkg`)\n* Dynamic-link library (DLL) file (`.dll`)\n* Executable and Linkable Format (ELF) file (`.elf`)\n* Java archive (JAR) package (`.jar`)\n* Java class file (`.class`)\n* Mach object (Mach-O) file (`.macho`)\n* Microsoft Windows installer (`.msi`)\n* Microsoft Software Installer (`.msix`, `.appx`)\n* Microsoft Windows executable (`.exe`)\n\nImage\n\n* Adobe Photoshop document (`.psd`)\n* Bitmap image (`.bmp`)\n* GIF image (`.gif`)\n* Icon file (`.ico`)\n* JPEG image (`.jpg`, `.jpeg`)\n* PNG image (`.png`)\n* WebP image (`.webp`)\n\nOther\n\n* BitTorrent file (`.torrent`)\n\nSystem\n\n* Apple Disk Image (`.dmg`)\n\nUnscannable\n\n* Password-protected Microsoft Office document\n* Password-protected PDF\n* Password-protected ZIP archive\n* Unscannable ZIP archive\n\n### Download and Upload Mime Type\n\nThese selectors depend on the `Content-Type` header being present in the request (for uploads) or response (for downloads).\n\n| UI name | API example |\n| - | - |\n| Download Mime Type | `http.download.mime == \"image/png\\\"` |\n\n| UI name | API example |\n| - | - |\n| Upload Mime Type | `http.upload.mime == \"image/png\\\"` |\n\n### DLP Profile\n\nUse [Cloudflare Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) to scan HTTP traffic for the presence of sensitive data such as personally identifiable information (PII) or source code. You must configure a [DLP profile](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) before you can use this selector in a policy.\n\n| UI name | API example |\n| - | - |\n| DLP Profile | `any(dlp.profiles[*] in {\\\"a0cabf16-7491-4c9a-ac02-f64cabc66394\\\"})` |\n\n### Host\n\nUse this selector to match against only the hostname specified. For example, you can match `test.example.com` but not `example.com` or `www.test.example.com`.\n\n| UI name | API example |\n| - | - |\n| Host | `http.request.host == \"example.com\"` |\n\nGateway policies do not support hostnames with non-Latin characters directly. To use a hostname with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\nNote\n\nSome hostnames (`example.com`) will invisibly redirect to the www subdomain (`www.example.com`). To match this type of website, use the [Domain](#domain) selector instead of the Host selector.\n\n### HTTP Method\n\nThe HTTP request method used in the traffic.\n\n| UI name | API example |\n| - | - |\n| HTTP Method | `http.request.method == \"GET\"` |\n\n### HTTP Response\n\nThe HTTP response status code received by the traffic.\n\n| UI name | API example |\n| - | - |\n| URL | `http.response.status_code == \"200\"` |\n\n### Proxy Endpoint\n\nThe [proxy server](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) where your browser forwards HTTP traffic.\n\n| UI name | API example |\n| - | - |\n| Proxy Endpoint | `proxy.endpoint == \"3ele0ss56t.proxy.cloudflare-gateway.com\"` |\n\n### Security Risks\n\nApplications within a specific [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) as categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\n| UI name | API example |\n| - | - |\n| Security Categories | `any(http.request.uri.security_category[*] in {1})` |\n\n### Source Continent\n\nThe continent of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Source Continent IP Geolocation | `http.src_ip.geo.continent == \"North America\"` |\n\n### Source Country\n\nThe country of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a country, enter its [ISO 3166-1 Alpha-2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Source Country IP Geolocation | `http.src_ip.geo.country == \"RU\"` |\n\n### Source Internal IP\n\nUse this selector to apply HTTP policies to a private IP address, assigned by a user's local network, that requests arrive to Gateway from. This selector will only apply to users connected through a [Magic GRE or IPSec tunnel](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/).\n\n| UI name | API example |\n| - | - |\n| Source Internal IP | `http.conn.internal_src_ip == \"192.168.86.0/27\"` |\n\n### Source IP\n\nThe originating IP address or addresses of a device proxied by Gateway.\n\n| UI name | API example |\n| - | - |\n| Source IP | `http.conn.src_ip[*] in {10.0.0.0/8}` |\n\n### URL\n\nGateway ignores trailing forward slashes (`/`) in URLs. For example, `https://example.com` and `https://example.com/` will count as the same URL and may return a duplicate error.\n\n| UI name | API example |\n| - | - |\n| URL | `http.request.uri matches \"/r/gaming\"` |\n\n### URL Path\n\nThe pathname of a webpage's URL.\n\n| UI name | API example |\n| - | - |\n| URL Path | `http.request.uri.path == \\\"/foo/bar\\\"` |\n\n### URL Path and Query\n\nThe pathname and query of a webpage's URL.\n\n| UI name | API example |\n| - | - |\n| URL Path and Query | `http.request.uri.path_and_query == \\\"/foo/bar?ab%242=%2A342\\\"` |\n\n### URL Query\n\nThe query of a webpage's URL.\n\n| UI name | API example |\n| - | - |\n| URL Query | `http.request.uri.query == \"ab%242=%2A342\"` |\n\n### Users\n\nUse these selectors to match against identity attributes.\n\n| UI name | API example |\n| - | - |\n| User Email | `identity.email == \"user@example.com\"` |\n| User Name | `identity.name == \"Test User\"` |\n| User Group IDs | `any(identity.groups[*].id in {\"group_id\"})` |\n| User Group Names | `any(identity.groups[*].name in {\"group_name\"})` |\n| User Group Emails | `any(identity.groups[*].email in {\"group@example.com\"})` |\n| SAML Attributes | `any(identity.saml_attributes[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"] in {\"Test User\"})` |\n\n### Virtual Network\n\nUse this selector to match all traffic routed through a specific [Tunnel Virtual Network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) via the WARP client.\n\n| UI name | API example |\n| - | - |\n| Virtual Network | `http.conn.vnet_id == \"957fc748-591a-e96s-a15d-1j90204a7923\"` |\n\n## Comparison operators\n\nComparison operators are the way Gateway matches traffic to a selector. When you choose a **Selector** in the dashboard policy builder, the **Operator** dropdown menu will display the available options for that selector.\n\n| Operator | Meaning |\n| - | - |\n| is | equals the defined value |\n| is not | does not equal the defined value |\n| in | matches at least one of the defined values |\n| not in | does not match any of the defined values |\n| in list | in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| not in list | not in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| matches regex | regex evaluates to true |\n| does not match regex | regex evaluates to false |\n| greater than | exceeds the defined number |\n| greater than or equal to | exceeds or equals the defined number |\n| less than | below the defined number |\n| less than or equal to | below or equals the defined number |\n\n## Value\n\nIn the **Value** field, you can input a single value when using an equality comparison operator (such as *is*) or multiple values when using a containment comparison operator (such as *in*). Additionally, you can use [regular expressions](#regular-expressions) (or regex) to specify a range of values for supported selectors.\n\n### Regular expressions\n\nGateway uses Rust to evaluate regular expressions. The Rust implementation is slightly different than regex libraries used elsewhere. For more information, refer to our guide for [Wildcards](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/#wildcards). To evaluate if your regex matches, you can use [Rustexp](https://rustexp.lpil.uk/).\n\nIf you want to match multiple values, you can use the pipe symbol (`|`) as an OR operator. In Gateway, you do not need to use an escape character (`\\`) before the pipe symbol. For example, the following policy blocks requests to two hostnames if either appears in a request header:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Host | matches regex | `.\\*whispersystems.org\\|.\\*signal.org` | Block |\n\nIn addition to regular expressions, you can use [logical operators](#logical-operators) to match multiple values.\n\n## Logical operators\n\nTo evaluate multiple conditions in an expression, select the **And** logical operator. These expressions can be compared further with the **Or** logical operator.\n\n| Operator | Meaning |\n| - | - |\n| And | match all of the conditions in the expression |\n| Or | match any of the conditions in the expression |\n\nThe **Or** operator will only work with conditions in the same expression group. For example, you cannot compare conditions in **Traffic** with conditions in **Identity** or **Device Posture**.\n\nIf a condition in an expression joins a request attribute (such as *Source IP*) and a response attribute (such as *a DLP Profile*), then the condition will be evaluated when the response is received.\n\n</page>\n\n<page>\n---\ntitle: Get started · Cloudflare One docs\ndescription: \"This section covers best practices for setting up the following\n  Gateway policy types:\"\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/index.md\n---\n\nThis section covers best practices for setting up the following Gateway policy types:\n\n* [DNS filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/dns/)\n* [Network filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/network/)\n* [HTTP filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/)\n\nFor each type of policy, we recommend the following workflow:\n\n1. Connect the devices and/or networks that you want to apply policies to.\n2. Verify that Gateway is successfully proxying traffic from your devices.\n3. Set up basic security and compatibility policies (recommended for most use cases).\n4. Customize your configuration to the unique needs of your organization.\n\n</page>\n\n<page>\n---\ntitle: Managed service providers (MSPs) · Cloudflare One docs\ndescription: Gateway supports the Cloudflare Tenant API, which allows\n  Cloudflare-partnered managed service providers (MSPs) to set up and manage\n  Cloudflare accounts and services for their customers. With the Tenant API,\n  MSPs can create Zero Trust deployments with global Gateway policy control.\n  Policies can be customized or overridden at a group or individual account\n  level.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/managed-service-providers/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/managed-service-providers/index.md\n---\n\nNote\n\nOnly available on Enterprise plans. For more information, contact your account team.\n\nGateway supports the [Cloudflare Tenant API](https://developers.cloudflare.com/tenant/), which allows Cloudflare-partnered managed service providers (MSPs) to set up and manage Cloudflare accounts and services for their customers. With the Tenant API, MSPs can create Zero Trust deployments with global Gateway policy control. Policies can be customized or overridden at a group or individual account level.\n\nThe Tenant platform only supports [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/). For more information, refer to the [Cloudflare Zero Trust for managed service providers](https://blog.cloudflare.com/gateway-managed-service-provider/) blog post.\n\n## Get started\n\nTo set up the Tenant API, refer to [Get started](https://developers.cloudflare.com/tenant/get-started/). Once you have provisioned and configured your customer's Cloudflare accounts, you can create [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/).\n\n## Account types\n\nThe Gateway Tenant platform supports tiered and siloed account configurations.\n\n### Tiered accounts\n\nIn a tiered account configuration, a top-level parent account enforces global security policies that apply to all of its child accounts. Child accounts can override or add policies as needed while still being managed by the parent account. MSPs can also configure child accounts independently from the parent account, including:\n\n* Configuring a [custom block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/)\n* Generating or uploading [root certificates](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/user-side-certificates/)\n* Mapping [DNS locations](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/)\n* Creating [lists](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/)\n\nEach child account is subject to the default Zero Trust [account limits](https://developers.cloudflare.com/cloudflare-one/account-limits/).\n\nGateway evaluates parent account policies before any child account policies. To allow a child account to override a specific parent account policy, you can use the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint to set the policy's `allow_child_bypass` rule setting to `true`.",
      "language": "unknown"
    },
    {
      "code": "### Siloed accounts\n\nIn a siloed account configuration, each account operates independently within the same tenant. MSPs manage each account's own security policies, resources, and configurations separately.",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Network policies · Cloudflare One docs\ndescription: With Cloudflare One, you can configure policies to control\n  network-level traffic leaving your endpoints. Using network selectors like IP\n  addresses and ports, your policies will control access to any network origin.\n  Because Cloudflare One integrates with your identity provider, it also gives\n  you the ability to create identity-based network policies. This means you can\n  now control access to non-HTTP resources on a per-user basis regardless of\n  where they are or what device they access that resource from.\nlastUpdated: 2025-11-14T21:41:55.000Z\nchatbotDeprioritize: false\ntags: Geolocation\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/index.md\n---\n\nNote\n\nTo enable this feature, download and deploy the [WARP client](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/deployment/) on your devices.\n\nWith Cloudflare One, you can configure policies to control network-level traffic leaving your endpoints. Using network selectors like IP addresses and ports, your policies will control access to any network origin. Because Cloudflare One [integrates with your identity provider](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/), it also gives you the ability to create identity-based network policies. This means you can now control access to non-HTTP resources on a per-user basis regardless of where they are or what device they access that resource from.\n\nA network policy consists of an **Action** as well as a logical expression that determines the scope of the action. To build an expression, you need to choose a **Selector** and an **Operator**, and enter a value or range of values in the **Value** field. You can use **And** and **Or** logical operators to evaluate multiple conditions.\n\n* [Actions](#actions)\n* [Selectors](#selectors)\n* [Comparison operators](#comparison-operators)\n* [Value](#value)\n* [Logical operators](#logical-operators)\n\nIf a condition in an expression joins a query attribute (such as *Source IP*) and a response attribute (such as *Resolved IP*), then the condition will be evaluated when the response is received.\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Actions\n\nLike actions in DNS and HTTP policies, actions in network policies define which decision you want to apply to a given set of elements. You can assign one action per policy.\n\n### Allow\n\nAPI value: `allow`\n\nAvailable selectors\n\n**Traffic**\n\n* [Access Infrastructure Target](#access-infrastructure-target)\n* [Access Private App](#access-private-app)\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Destination Port](#destination-port)\n* [Detected Protocol](#detected-protocol)\n* [Protocol](#protocol)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [SNI](#sni)\n* [SNI Domain](#sni-domain)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Source Port](#source-port)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nPolicies with Allow actions allow network traffic to reach certain IPs or ports. For example, the following configuration allows specific users to reach a given IP address:\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| Destination IP | in | `92.100.02.102` | And | Allow |\n| Email | in | `*@example.com` | | |\n\n### Audit SSH Deprecated\n\nAPI value: `audit_ssh`\n\nAvailable selectors\n\n**Traffic**\n\n* [Application](#application)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Source Port](#source-port)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nWarning\n\nGateway no longer supports the Audit SSH action for new policies. To log your SSH traffic, Cloudflare recommends deploying [Access for Infrastructure](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/) for your SSH server and configuring [SSH command logs](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/use-cases/ssh/ssh-infrastructure-access/#ssh-command-logs).\n\nPolicies with Audit SSH actions allow administrators to log SSH traffic. Gateway will detect SSH traffic over port `22`. For example, the following configuration logs SSH commands sent to a given IP address:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Destination IP | in | `203.0.113.83` | Audit SSH |\n\nGateway only audits SSH traffic over port `22`. Non-standard ports, including those specified with the [Destination Port selector](#destination-port), are not supported.\n\nFor more information on SSH logging, refer to [Configure SSH proxy and command logs](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/ssh-logging/).\n\n### Block\n\nAPI value: `block`\n\nAvailable selectors\n\n**Traffic**\n\n* [Access Infrastructure Target](#access-infrastructure-target)\n* [Access Private App](#access-private-app)\n* [Application](#application)\n* [Content Categories](#content-categories)\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Destination Port](#destination-port)\n* [Detected Protocol](#detected-protocol)\n* [Protocol](#protocol)\n* [Proxy Endpoint](#proxy-endpoint)\n* [Security Risks](#security-risks)\n* [SNI](#sni)\n* [SNI Domain](#sni-domain)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Source Port](#source-port)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nPolicies with Block actions block network traffic from reaching certain IPs or ports. For example, the following configuration blocks all traffic directed to port 443:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Destination Port | in | `443` | Block |\n\n#### WARP client block notifications\n\nFeature availability\n\n| [WARP modes](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/plans/zero-trust-services/) |\n| - | - |\n| * Gateway with WARP\n* Secure Web Gateway without DNS filtering | Enterprise |\n\n| System | Availability | Minimum WARP version |\n| - | - | - |\n| Windows | ✅ | 2024.1.159.0 |\n| macOS | ✅ | 2024.1.160.0 |\n| Linux | ❌ | |\n| iOS | ✅ | 1.7 |\n| Android | ✅ | 1.4 |\n| ChromeOS | ✅ | 1.4 |\n\nTurn on **Display block notification for WARP Client** to display notifications for Gateway block events. Blocked users will receive an operating system notification from the WARP client with a custom message you set. If you do not set a custom message, the WARP client will display a default message. Custom messages must be 100 characters or less. WARP will only display one notification per minute.\n\nUpon selecting the notification, WARP will direct your users to the [Gateway block page](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/) you have configured. Optionally, you can direct users to a custom URL, such as an internal support form.\n\nWhen you turn on **Send policy context**, Gateway will append details of the matching request to the redirected URL as a query string. Not every context field will be included. Potential policy context fields include:\n\nPolicy context fields\n\n| Field | Definition | Example |\n| - | - | - |\n| User email | Email of the user that made the query. | `&cf_user_email=user@example.com` |\n| Site URL | Full URL of the original HTTP request or domain name in DNS query. | `&cf_site_uri=https%3A%2F%2Fmalware.testcategory.com%2F` |\n| URL category | [Domain categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/) of the URL to be redirected. | `&cf_request_categories=New%20Domains,Newly%20Seen%20Domains` |\n| Original HTTP referer | For HTTP traffic, the original HTTP referer header of the HTTP request. | `&cf_referer=https%3A%2F%2Fexample.com%2F` |\n| Rule ID | ID of the Gateway policy that matched the request. | `&cf_rule_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Source IP | Source IP address of the device that matched the policy. | `&cf_source_ip=203.0.113.5` |\n| Device ID | UUID of the device that matched the policy. | `&cf_device_id=6d48997c-a1ec-4b16-b42e-d43ab4d071d1` |\n| Application names | Name of the application the redirected domain corresponds to, if any. | `&cf_application_name=Salesforce` |\n| Filter | The traffic type filter that triggered the block. | `&cf_filter=http`, `&cf_filter=dns`, `&cf_filter=av`, or `&cf_filter=l4` |\n| Account ID | [Cloudflare account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/) of the associated Zero Trust account. | `&cf_account_id=d57c3de47a013c03ca7e237dd3e61d7d` |\n| Query ID | ID of the DNS query for which the redirect took effect. | `&cf_query_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Connection ID | ID of the proxy connection for which the redirect took effect. | `&cf_connection_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n| Request ID | ID of the HTTP request for which the redirect took effect. | `&cf_request_id=f8dc6fd3-a7a5-44dd-8b77-08430bb4fac3` |\n\nEnsure that your operating system allows notifications for WARP. Your device may not display notifications if focus, do not disturb, or screen sharing settings are turned on. To turn on client notifications on macOS devices running DisplayLink software, you may have to allow system notifications when mirroring your display. For more information, refer to the [macOS documentation](https://support.apple.com/guide/mac-help/change-notifications-settings-mh40583/mac).\n\n### Network Override\n\nAPI value: `l4_override`\n\nAvailable selectors\n\n**Traffic**\n\n* [Destination Continent IP Geolocation](#destination-continent)\n* [Destination Country IP Geolocation](#destination-country)\n* [Destination IP](#destination-ip)\n* [Destination Port](#destination-port)\n* [Protocol](#protocol)\n* [SNI](#sni)\n* [SNI Domain](#sni-domain)\n* [Source Continent IP Geolocation](#source-continent)\n* [Source Country IP Geolocation](#source-country)\n* [Source Internal IP](#source-internal-ip)\n* [Source IP](#source-ip)\n* [Source Port](#source-port)\n* [Virtual Network](#virtual-network)\n\n**Identity**\n\n* [SAML Attributes](#users)\n* [User Email](#users)\n* [User Group Emails](#users)\n* [User Group IDs](#users)\n* [User Group Names](#users)\n* [User Name](#users)\n\n**Device Posture**\n\n* [Passed Device Posture Checks](#device-posture)\n\nPolicies with Network Override actions override traffic directed to or coming from certain IPv4/IPv6 addresses or ports. Destination IPs can be public IPs or private IPs connected to your Zero Trust network. For example, the following configuration overrides traffic sent to a public IP with a private IP based on a user's identity:\n\n| Selector | Operator | Value | Logic | Action |\n| - | - | - | - | - |\n| Destination IP | in | `95.92.143.151` | And | Network Override |\n| User Email | in | `*@example.com` | And | |\n| Override IP | | `10.0.0.1` | | |\n\nGateway will only log successful override connections in your [network logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/#network-logs). If the override destination IP does not exist, Gateway will override the destination IP but will not log the override action.\n\n## Selectors\n\nGateway matches network traffic against the following selectors, or criteria.\n\n### Access Infrastructure Target\n\nAll [targets](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/#1-add-a-target) secured by an [Access infrastructure application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/infrastructure-apps/).\n\n| UI name | API example |\n| - | - |\n| Access Infrastructure Target | `access.target` |\n\n### Access Private App\n\nAll destination IPs and hostnames secured by an [Access self-hosted private application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/non-http/self-hosted-private-app/).\n\n| UI name | API example |\n| - | - |\n| Self-hosted Access App with Private Address | `access.private_app` |\n\n### Application\n\nYou can apply network policies to a growing list of popular web applications. Refer to [Application and app types](https://developers.cloudflare.com/cloudflare-one/traffic-policies/application-app-types/) for more information.\n\n| UI name | API example |\n| - | - |\n| Application | `any(app.ids[*] in {505})` |\n\n### Content Categories\n\nApplications within a specific [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories) as categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\n| UI name | API example |\n| - | - |\n| Content Categories | `any(net.fqdn.content_category[*] in {1})` |\n\n### Destination Continent\n\nThe continent where the request is destined. Geolocation is determined from the target IP address. To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Destination Continent IP Geolocation | `net.dst.geo.continent == \"EU\"` |\n\n### Destination Country\n\nThe country that the request is destined for. Geolocation is determined from the target IP address. To specify a country, enter its [ISO 3166-1 Alpha 2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Destination Country IP Geolocation | `net.dst.geo.country == \"RU\"` |\n\n### Destination IP\n\nThe IP address of the request's target.\n\n| UI name | API example |\n| - | - |\n| Destination IP | `any(net.dst.ip[*] in {10.0.0.0/8})` |\n\n### Destination Port\n\nThe port number of the request's target.\n\n| UI name | API example |\n| - | - |\n| Destination Port | `net.dst.port == 2222` |\n\n### Detected Protocol\n\nThe inferred network protocol based on Cloudflare's [protocol detection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/).\n\n| UI name | API example |\n| - | - |\n| Detected Protocol | `net.protocol.detection == \"ssh\"` |\n\n### Device Posture\n\nWith the Device Posture selector, admins can use signals from end-user devices to secure access to their internal and external resources. For example, a security admin can choose to limit all access to internal applications based on whether specific software is installed on a device and/or if the device or software are configured in a particular way.\n\nFor more information on device posture checks, refer to [Device posture](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/).\n\n| UI name | API example |\n| - | - |\n| Passed Device Posture Checks | `any(device_posture.checks.failed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})`, `any(device_posture.checks.passed[*] in {\"1308749e-fcfb-4ebc-b051-fe022b632644\"})\"` |\n\n### Protocol\n\nThe protocol used to send the packet.\n\n| UI name | API example |\n| - | - |\n| Protocol | `net.protocol == \"tcp\"` |\n\nNote\n\nTo enable Gateway filtering on TCP and UDP, go to **Traffic policies** > **Traffic settings** > **Allow Secure Web Gateway to proxy traffic**. Network policies apply to all enabled protocols unless you use the **Protocol** selector within a policy.\n\n### Proxy Endpoint\n\nThe [proxy server](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) where your browser forwards HTTP traffic.\n\n| UI name | API example |\n| - | - |\n| Proxy Endpoint | `proxy.endpoint == \"3ele0ss56t.proxy.cloudflare-gateway.com\"` |\n\n### Security Categories\n\nApplications within a specific [security category](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories) as categorized by [Cloudflare Radar](https://developers.cloudflare.com/radar/glossary/#content-categories).\n\n| UI name | API example |\n| - | - |\n| Security Categories | `any(net.fqdn.security_category[*] in {1})` |\n\n### SNI\n\nThe host whose Server Name Indication (SNI) header Gateway will filter traffic against. This will allow for an exact match.\n\nBy default, SNI selectors only apply to HTTPS traffic on port `443`. To inspect traffic on every port, turn on [protocol detection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/) and choose to [inspect on all ports](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/#inspect-on-all-ports).\n\n| UI name | API example |\n| - | - |\n| SNI | `net.sni.host == \"www.example.com\"` |\n\n### SNI Domain\n\nThe domain whose Server Name Indication (SNI) header Gateway will filter traffic against. For example, a rule for `example.com` will match `example.com`, `www.example.com`, and `my.test.example.com`.\n\nBy default, SNI selectors only apply to HTTPS traffic on port `443`. To inspect traffic on every port, turn on [protocol detection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/) and choose to [inspect on all ports](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/protocol-detection/#inspect-on-all-ports).\n\n| UI name | API example |\n| - | - |\n| SNI Domain | `net.sni.domains == \"example.com\"` |\n\n### Source Continent\n\nThe continent of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example |\n| - | - |\n| Source Continent IP Geolocation | `net.src.geo.continent == \"North America\"` |\n\n### Source Country\n\nThe country of the user making the request.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a country, enter its [ISO 3166-1 Alpha-2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example |\n| - | - |\n| Source Country IP Geolocation | `net.src.geo.country == \"RU\"` |\n\n### Source Internal IP\n\nUse this selector to apply network policies to a private IP address, assigned by a user's local network, that requests arrive to Gateway from. This selector will only apply to users connected through a [Magic GRE or IPSec tunnel](https://developers.cloudflare.com/magic-wan/zero-trust/cloudflare-gateway/).\n\n| UI name | API example |\n| - | - |\n| Source Internal IP | `net.src.internal_src_ip == \"192.168.86.0/27\"` |\n\n### Source IP\n\nThe originating IP address or addresses of a device proxied by Gateway.\n\n| UI name | API example |\n| - | - |\n| Source IP | `net.src.ip[*] in {10.0.0.0/8}` |\n\n### Source Port\n\nThe originating port of a device proxied by Gateway.\n\n| UI name | API example |\n| - | - |\n| Source Port | `net.src.port == \"2222\"` |\n\n### Users\n\nUse these selectors to match against identity attributes.\n\n| UI name | API example |\n| - | - |\n| User Email | `identity.email == \"user@example.com\"` |\n| User Name | `identity.name == \"Test User\"` |\n| User Group IDs | `any(identity.groups[*].id in {\"group_id\"})` |\n| User Group Names | `any(identity.groups[*].name in {\"group_name\"})` |\n| User Group Emails | `any(identity.groups[*].email in {\"group@example.com\"})` |\n| SAML Attributes | `any(identity.saml_attributes[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"] in {\"Test User\"})` |\n\n### Virtual Network\n\nUse this selector to match all traffic routed through a specific [Tunnel Virtual Network](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) via the WARP client.\n\n| UI name | API example |\n| - | - |\n| Virtual Network | `net.vnet_id == \"957fc748-591a-e96s-a15d-1j90204a7923\"` |\n\n## Comparison operators\n\nComparison operators are the way Gateway matches traffic to a selector. When you choose a **Selector** in the dashboard policy builder, the **Operator** dropdown menu will display the available options for that selector.\n\n| Operator | Meaning |\n| - | - |\n| is | equals the defined value |\n| is not | does not equal the defined value |\n| in | matches at least one of the defined values |\n| not in | does not match any of the defined values |\n| in list | in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| not in list | not in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| matches regex | regex evaluates to true |\n| does not match regex | regex evaluates to false |\n| greater than | exceeds the defined number |\n| greater than or equal to | exceeds or equals the defined number |\n| less than | below the defined number |\n| less than or equal to | below or equals the defined number |\n\nNote\n\nThe *in* operator allows you to specify IP addresses or networks using CIDR notation.\n\n## Value\n\nIn the **Value** field, you can input a single value when using an equality comparison operator (such as *is*) or multiple values when using a containment comparison operator (such as *in*). Additionally, you can use [regular expressions](#regular-expressions) (or regex) to specify a range of values for supported selectors.\n\n### Regular expressions\n\nGateway uses Rust to evaluate regular expressions. The Rust implementation is slightly different than regex libraries used elsewhere. For more information, refer to our guide for [Wildcards](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/#wildcards). To evaluate if your regex matches, you can use [Rustexp](https://rustexp.lpil.uk/).\n\nIf you want to match multiple values, you can use the pipe symbol (`|`) as an OR operator. In Gateway, you do not need to use an escape character (`\\`) before the pipe symbol. For example, the following policy blocks requests to two SNI hosts if either appears in a request header:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| SNI | matches regex | `.\\*whispersystems.org\\|.\\*signal.org` | Block |\n\nIn addition to regular expressions, you can use [logical operators](#logical-operators) to match multiple values.\n\n## Logical operators\n\nTo evaluate multiple conditions in an expression, select the **And** logical operator. These expressions can be compared further with the **Or** logical operator.\n\n| Operator | Meaning |\n| - | - |\n| And | match all of the conditions in the expression |\n| Or | match any of the conditions in the expression |\n\nThe **Or** operator will only work with conditions in the same expression group. For example, you cannot compare conditions in **Traffic** with conditions in **Identity** or **Device Posture**.\n\n</page>\n\n<page>\n---\ntitle: Order of enforcement · Cloudflare One docs\ndescription: With Cloudflare Gateway, you can enable and configure any\n  combination of DNS, network, and HTTP policies.\nlastUpdated: 2025-10-22T21:11:06.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/order-of-enforcement/index.md\n---\n\nWith Cloudflare Gateway, you can [enable and configure](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/) any combination of DNS, network, and HTTP policies.",
      "language": "unknown"
    },
    {
      "code": "Order of enforcement change on 2025-07-14\n\nOn 2025-07-14, Gateway began evaluating network-level policies before application-level policies and verify the network path to an origin server before accepting a connection. This only affects your policies if you are applying HTTP policies in your account. For example:\n\nComparison of old and new order of enforcement\n\n| | Old order of enforcement | New order of enforcement |\n| - | - | - |\n| **Network Block policy and HTTP Block policy** | Gateway blocks traffic and displays the block page and/or follows the client notification settings on the HTTP policy. | Gateway blocks traffic. Gateway does not display the block page but will follow the client notification settings on the Network policy. |\n| **Network Allow policy and HTTP Block policy** | Gateway blocks traffic and displays the block page and follows the client notification settings on the HTTP policy. | No change. |\n| **Network Block policy and HTTP Allow policy** | Gateway blocks traffic and follows the client notification settings on the Network policy. | No change. |\n\n## Connection establishment\n\nWhen a user connects to a server with Gateway, Gateway first establishes a TCP connection with the destination server on the port the user requested. Because TCP traffic is proxied by Cloudflare, the connection Gateway establishes with the origin is independent from the connection users establish with Gateway. This means Gateway assigns a new source IP and port to the user's connection and no details from the user's TCP handshake are included in the TCP handshake with the origin server.\n\nIf the TCP connection to the destination server is successful, Gateway will apply policies. If Gateway policies allow the connection, Gateway will connect the user to the destination server. If Gateway policies block the connection, Gateway will end the connection and will not send any data between the user and the destination server. If the TCP connection to the destination server is unsuccessful, Gateway will not run any policies and retry TCP connections from the user to the server.",
      "language": "unknown"
    },
    {
      "code": "Connections to Zero Trust will always appear in your [Zero Trust network session logs](https://developers.cloudflare.com/logs/logpush/logpush-job/datasets/account/zero_trust_network_sessions/) regardless of connection success. Because Gateway does not inspect failed connections, they will not appear in your [Gateway activity logs](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/).\n\n## Priority between policy builders\n\nGateway applies your policies in the following order:\n\n1. DNS policies with selectors evaluated before resolution\n2. Resolver policies (if applicable)\n3. DNS policies with selectors evaluated after resolution\n4. Egress policies (if applicable)\n5. Network policies\n6. HTTP policies\n\nDNS and resolver policies are standalone. For example, if you block a site with a DNS policy but do not create a corresponding HTTP policy, users can still access the site if they know its IP address.\n\n### HTTP/3 traffic\n\nFor proxied [HTTP/3 traffic](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/), Gateway applies your policies in the following order:\n\n1. DNS policies\n2. Network policies\n3. HTTP policies\n\n## Priority within a policy builder\n\n### DNS policies\n\nGateway evaluates DNS policies first in order of DNS resolution, then in [order of precedence](#order-of-precedence).\n\nWhen DNS queries are received, Gateway evaluates policies with pre-resolution selectors, resolves the DNS query, then evaluates policies with post-resolution selectors. This means policies with selectors evaluated before DNS resolution take precedence. For example, the following set of policies will block `example.com`:\n\n| Precedence | Selector | Operator | Value | Action |\n| - | - | - | - | - |\n| 1 | Resolved Country IP Geolocation | is | United States | Allow |\n| 2 | Domain | is | `example.com` | Block |\n\nDespite an explicit Allow policy ordered first, policy 2 takes precedence because the *Domain* selector is evaluated before DNS resolution.\n\nIf a policy contains both pre-resolution and post-resolution selectors, Gateway will evaluate the entire policy after DNS resolution. For information on when each selector is evaluated, refer to the [list of DNS selectors](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/#selectors).\n\n### Network policies\n\nGateway evaluates network policies in [order of precedence](#order-of-precedence).\n\n### HTTP policies\n\nGateway applies HTTP policies based on a combination of [action type](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#actions) and [order of precedence](#order-of-precedence):\n\n1. All Do Not Inspect policies are evaluated first, in order of precedence.\n2. If no policies match, all Isolate policies are evaluated in order of precedence.\n3. All Allow, Block and Do Not Scan policies are evaluated in order of precedence.\n4. The body of the HTTP request, including Data Loss Prevention (DLP), AV scanning, and file sandboxing, is evaluated.\n\nThis order of enforcement allows Gateway to first determine whether decryption should occur. If a site matches a Do Not Inspect policy, it is automatically allowed through Gateway and bypasses all other HTTP policies.\n\nNote\n\nThe only exception is if you are using [Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) — all sites within the clientless remote browser are implicitly isolated even if they match a Do Not Inspect policy.\n\nNext, Gateway checks decrypted traffic against your Isolate policies. When a user makes a request which triggers an Isolate policy, the request will be rerouted to a [remote browser](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/).\n\nNext, Gateway evaluates all Allow, Block, and Do Not Scan policies. These policies apply to both isolated and non-isolated traffic. For example, if `example.com` is isolated and `example.com/subpage` is blocked, Gateway will block the subpage (`example.com/subpage`) inside of the remote browser.\n\nLastly, Gateway inspects the body of the HTTP request by evaluating it against DLP policies, and running anti-virus scanning and file sandboxing. If DLP Block policies are present, the action Gateway ultimately takes may not match the action it initially logs. For more information, refer to [DLP policy precedence](#dlp-policy-precedence).\n\n### Resolver policies\n\nWhen [resolver policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/) are present, Gateway first evaluates any DNS policies with pre-resolution selectors, then routes any DNS queries according to the [order of precedence](#order-of-precedence) of your resolver policies, and lastly evaluates any DNS policies with post-resolution selectors.\n\n### Order of precedence\n\nOrder of precedence refers to the priority of individual policies within the DNS, network, or HTTP policy builder. Gateway evaluates policies in ascending order beginning with the lowest value.\n\nThe order of precedence follows the first match principle. Once traffic matches an Allow or Block policy, evaluation stops and no subsequent policies can override the decision. Therefore, Cloudflare recommends assigning the most specific policies and exceptions with the highest precedence and the most general policies with the lowest precedence.\n\n#### Cloudflare One\n\nIn Cloudflare One, policies are in order of precedence from top to bottom of the list. Policies begin with precedence `1` and count upward. You can modify the order of precedence by dragging and dropping individual policies in the dashboard.\n\n#### Cloudflare API\n\nTo update the precedence of a policy with the Cloudflare API, use the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint to update the `precedence` field.\n\n#### DLP policy precedence\n\nFor Gateway configurations with DLP policies, Gateway will filter and log traffic based on first match, then scan the body of the HTTP request for matching content. Because of the first match principle, Gateway may perform and log a decision for traffic, then perform a contradicting decision. For example, if traffic is first allowed with an Allow HTTP policy, then blocked with a DLP Block policy, Gateway will log the initial Allow action despite ultimately blocking the request.\n\n#### Access applications\n\nIf Gateway traffic is headed to a private IP address protected as an Access application, that traffic will still be evaluated by the destination application's Access policies, even if a Gateway Allow policy matched first. Gateway Block policies that match traffic will terminate any other policy evaluation. This is expected behavior. A Gateway Allow policy does not override or bypass Access policies.\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Example\n\nSuppose you have a list of policies arranged in the following order of precedence:\n\n* DNS policies:\n\n  | Precedence | Selector | Operator | Value | Action |\n  | - | - | - | - | - |\n  | 1 | Host | is | `example.com` | Block |\n  | 2 | Host | is | `test.example.com` | Allow |\n  | 3 | Domain | matches regex | `.\\` | Block |\n\n* HTTP policies:\n\n  | Precedence | Selector | Operator | Value | Action |\n  | - | - | - | - | - |\n  | 1 | Host | is | `example.com` | Block |\n  | 2 | Host | is | `test2.example.com` | Do Not Inspect |\n\n* Network policies:\n\n  | Precedence | Selector | Operator | Value | Action |\n  | - | - | - | - | - |\n  | 1 | Destination Port | is | `80` | Block |\n  | 2 | Destination port | is | `443` | Allow |\n  | 3 | SNI Domain | is | `test.example.com` | Block |\n\nWhen a user goes to `https://test.example.com`, Gateway performs the following operations:\n\n1. Evaluate DNS request against DNS policies:\n\n   1. Policy #1 does not match `test.example.com` — move on to check Policy #2.\n   2. Policy #2 matches, so DNS resolution is allowed.\n   3. Policy #3 is not evaluated because there has already been an explicit match.\n\n2. Evaluate HTTPS request against network policies:\n\n   1. Policy #1 does not match because port 80 is used for standard HTTP, not HTTPS.\n   2. Policy #2 matches, so the request is allowed and proxied to the upstream server.\n   3. Policy #3 is not evaluated because there has already been an explicit match.\n\n3. Evaluate HTTPS request against HTTP policies:\n\n   1. Policy #2 is evaluated first because Do Not Inspect [always takes precedence](#http-policies) over Allow and Block. Since there is no match, move on to check Policy #1.\n   2. Policy #1 does not match `test.example.com`. Since there are no matching Block policies, the request passes the HTTP filter.\n\nTherefore, the user is able to connect to `https://test.example.com`.\n\n## Precedence calculations\n\nWhen arranging policies in [Cloudflare One](https://one.dash.cloudflare.com/), Gateway automatically calculates the precedence for rearranged policies.\n\nWhen using the API to create a policy, unless the precedence is explicitly defined in the policy, Gateway will assign precedence to policies starting at `1000`. Every time a new policy is added to the bottom of the order, Gateway will calculate the current highest precedence in the account and add a random integer between 1 and 100 to `1000` so that it now claims the maximum precedence in the account. To manually update a policy's precedence, use the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint. You can set a policy's precedence to any value that is not already in use.\n\nChanging the order within Cloudflare One or API may result in configuration issues when using [Terraform](#manage-precedence-with-terraform).\n\n## Manage precedence with Terraform\n\nYou can manage the order of execution of your Gateway policies using Terraform. With version 5 of the Terraform Cloudflare provider, Gateway users can list their policies in a Terraform file with any desired integer precedence value. Cloudflare recommends starting with a precedence of `1000` and adding extra space between each policy's precedence for any future policies. For example:",
      "language": "unknown"
    },
    {
      "code": "To avoid precedence calculation errors when reordering policies with Terraform, you should move one policy at a time before running `terraform plan` and `terraform apply`. If you use both Terraform and Cloudflare One or API, sync your polices with `terraform refresh` before reordering policies in Terraform. Alternatively, you can set your account to [read-only in Cloudflare One](https://developers.cloudflare.com/cloudflare-one/api-terraform/#set-dashboard-to-read-only), only allowing changes using the API or Terraform.\n\n</page>\n\n<page>\n---\ntitle: Packet filtering · Cloudflare One docs\nlastUpdated: 2025-10-30T17:13:08.000Z\nchatbotDeprioritize: true\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/packet-filtering/index.md\n---\n\n\n</page>\n\n<page>\n---\ntitle: Proxy · Cloudflare One docs\ndescription: You can forward HTTP and network traffic to Gateway for logging and\n  filtering. Gateway can proxy both outbound traffic and traffic directed to\n  resources connected via a Cloudflare Tunnel, GRE tunnel, or IPsec tunnel. When\n  a user connects to the Gateway proxy, Gateway will accept the connection and\n  establish a new, separate connection to the origin server.\nlastUpdated: 2025-12-15T21:39:07.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/proxy/index.md\n---\n\nYou can forward [HTTP](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/) and [network](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/network/) traffic to Gateway for logging and filtering. Gateway can proxy both outbound traffic and traffic directed to resources connected via a Cloudflare Tunnel, GRE tunnel, or IPsec tunnel. When a user connects to the Gateway proxy, Gateway will accept the connection and establish a new, separate connection to the origin server.\n\nThe Gateway proxy is required for filtering HTTP and network traffic via the WARP client in Gateway with WARP mode. To proxy HTTP traffic without deploying the WARP client, you can configure [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) on your devices.\n\n## Proxy algorithm\n\nGateway uses the [Happy Eyeballs algorithm](https://datatracker.ietf.org/doc/html/rfc6555) to proxy traffic in the following order:\n\n1. The user's browser initiates the TCP handshake by sending Gateway a TCP SYN segment.\n2. Gateway sends a SYN segment to the origin server.\n3. If the origin server sends a SYN-ACK segment back, Gateway establishes separate TCP connections between the user and Gateway and between Gateway and the origin server.\n4. Gateway inspects and filters traffic received from the user.\n5. If the traffic passes inspection, Gateway proxies traffic bidirectionally between the user and the origin server.",
      "language": "unknown"
    },
    {
      "code": "## Supported protocols\n\nGateway supports proxying TCP, UDP, and ICMP traffic.\n\n### TCP\n\nWhen the proxy is enabled, Gateway will always forward TCP traffic.\n\nBy default, TCP connection attempts will timeout after 30 seconds and idle connections will disconnect after 8 hours.\n\n### UDP\n\nThe UDP proxy forwards UDP traffic such as VoIP, [internal DNS requests](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/private-dns/), and thick client applications.\n\nFor HTTP/3 traffic to be logged and filtered, you need to turn on both TLS decryption and the Gateway proxy for UDP so that Gateway will force all HTTP/3 traffic to HTTP/2 to allow inspection. Otherwise, HTTP/3 traffic will bypass inspection. For more information, refer to [HTTP/3 inspection](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/http3/).\n\n### ICMP Beta\n\nThe ICMP proxy forwards traffic for diagnostic tools such as `ping` and `traceroute`.\n\nLimitation\n\nGateway cannot log or filter ICMP traffic.\n\n#### Allow ICMP traffic through `cloudflared`\n\nTo use the ICMP proxy with Cloudflare Tunnel, you may need to configure the `cloudflared` host to allow ICMP traffic through `cloudflared`.\n\n* Linux\n\n  1. Ensure that `ping_group_range` includes the Group ID (GID) of the user running `cloudflared`:\n\n     a. Find the user that owns the `cloudflared` process:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "b. Get the Group ID of the `cloudflared` user:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "c. Determine the Group IDs that are allowed to use ICMP:",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "d. Either add the user to a group within that range, or update the range to encompass a group the user is already in. To update `ping_group_range`:",
      "language": "unknown"
    },
    {
      "code": "e. If you need to make the change apply to an already running process, you need to restart `cloudflared`. To make the change persist on reboot, update your `systcl` parameters:",
      "language": "unknown"
    },
    {
      "code": "2. If you are running multiple network interfaces (for example, `eth0` and `eth1`), configure `cloudflared` to use the external Internet-facing interface:",
      "language": "unknown"
    },
    {
      "code": "* Docker\n\n  In your environment, modify the `ping_group_range` parameter to include the Group ID (GID) of the user running `cloudflared`.\n\n  By default the [`cloudflared` Docker container](https://github.com/cloudflare/cloudflared/blob/master/Dockerfile#L29C6-L29C13) executes as a user called `nonroot` inside of the container. `nonroot` is a specific user that exists in the [base image](https://github.com/GoogleContainerTools/distroless/blob/859eeea1f9b3b7d59bdcd7e24a977f721e4a406c/base/base.bzl#L8) we use, and its Group ID is hardcoded to 65532.\n\n## Turn on the Gateway proxy\n\nThe Gateway proxy toggle only applies to traffic from WARP devices. Gateway will always proxy traffic sent with [PAC files](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/) or [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) regardless of this setting.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Traffic settings**.\n2. In **Proxy and inspection settings**, turn on **Allow Secure Web Gateway to proxy traffic**.\n3. Select **TCP**.\n4. (Optional) Depending on your use case, you can select **UDP** and/or **ICMP**.\n\n</page>\n\n<page>\n---\ntitle: Resolver policies · Cloudflare One docs\ndescription: By default, Gateway sends DNS requests to 1.1.1.1, Cloudflare's\n  public DNS resolver, for resolution. Enterprise users can instead create\n  Gateway policies to route DNS queries to custom resolvers.\nlastUpdated: 2025-11-21T18:29:21.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/\n  md: https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/index.md\n---\n\nNote\n\nOnly available on Enterprise plans.\n\nBy default, Gateway sends DNS requests to [1.1.1.1](https://developers.cloudflare.com/1.1.1.1/), Cloudflare's public DNS resolver, for resolution. Enterprise users can instead create Gateway policies to route DNS queries to custom resolvers.",
      "language": "unknown"
    },
    {
      "code": "Gateway will route user traffic to your configured DNS resolver based on the matching policy, even if your resolvers' IP addresses overlap.\n\n## Use cases\n\nYou may use resolver policies if you require access to non-publicly routed domains, such as private network services or internal resources. You may also use resolver policies if you need to access a protected DNS service or want to simplify DNS management for multiple locations.\n\n### Internal DNS Beta\n\n[Cloudflare Internal DNS](https://developers.cloudflare.com/dns/internal-dns/) allows you to manage DNS records for internal resources on a private network. DNS zones configured in Internal DNS can only be queried by the Gateway resolver. With resolver policies, you can determine how Gateway resolves your organization's DNS queries to resolve to internal resources based on the context of the query, such as known source IPs for a geographic location.\n\nTo get started with resolving internal DNS queries with resolver policies, refer to [Get started](https://developers.cloudflare.com/dns/internal-dns/get-started/).\n\n### Local Domain Fallback\n\nIf your resolver is only reachable by a client device and not by Gateway via a Cloudflare tunnel, Magic WAN tunnel, or other public Internet connections, you should configure [Local Domain Fallback](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/) for your device. If both Local Domain Fallback and resolver policies are configured for the same device, Cloudflare will apply your client-side Local Domain Fallback rules first. If you onboard DNS queries to Gateway with the WARP client and route them with resolver policies, the source IP of the queries will be the IP address assigned by the WARP client.\n\nLocal Domain Fallback or Gateway Resolver policies?\n\nIf your DNS server can be configured to connect to a Cloudflare on-ramp, Cloudflare recommends using Gateway Resolver policies rather than Local Domain Fallback. Gateway Resolver policies provide more visibility by allowing you to log and review DNS traffic.\n\n## Resolver connections\n\nResolver policies support TCP and UDP connections. Custom resolvers can point to the Internet via IPv4 or IPv6, or to a private network service, such as a [Magic tunnel](https://developers.cloudflare.com/magic-transit/how-to/configure-tunnel-endpoints/). Policies default to port `53`. You can change which port your resolver uses by customizing it in your policy.\n\nYou can protect your authoritative nameservers from DDoS attacks by enabling [DNS Firewall](https://developers.cloudflare.com/dns/dns-firewall/).\n\n### Cloudflare Tunnel\n\nYou can configure connections to a private resolver connected to Cloudflare with [Cloudflare Tunnel](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/). To ensure `cloudflared` can route UDP traffic to your resolver, connect your tunnel via [QUIC](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/configure-tunnels/cloudflared-parameters/run-parameters/#protocol).\n\nFor more information on connecting a private DNS resolver to Cloudflare with Cloudflare Tunnel, refer to [Private DNS](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/private-dns/).\n\n### Magic WAN\n\nTo enable connections to a private resolver connected to Cloudflare via [Magic WAN](https://developers.cloudflare.com/magic-wan/), contact your account team.\n\n### Available DNS endpoints\n\nResolver policies can route queries for resolution from the following DNS endpoints:\n\n* IPv4\n* IPv6\n* [DNS over HTTPS (DoH)](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-https/)\n* [DNS over TLS (DoT)](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/dns-over-tls/)\n* DNS queries generated by Cloudflare [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) and [Clientless Web Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/)\n* DNS queries generated by [proxy endpoints](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/proxy-endpoints/)\n\nGateway will filter, resolve, and log your queries regardless of endpoint.\n\n## Create a resolver policy\n\nVirtual network limitation\n\nResolver policies do not automatically update when you change the virtual networks associated with a route. If you move a route from one virtual network to another, the resolver policy will still reference the old virtual network. You will need to manually remove and recreate the resolver policy to update the route.\n\nTo create a resolver policy:\n\n* Dashboard\n\n  1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Resolver policies**.\n\n  2. Select **Add a policy**.\n\n  3. Create an expression for your desired traffic. For example, you can resolve a hostname for an internal service:\n\n     | Selector | Operator | Value |\n     | - | - | - |\n     | Host | in | `internal.example.com` |\n\n     Make sure your destination is not subject to [Local Domain Fallback](https://developers.cloudflare.com/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/local-domains/#manage-local-domains).\n\n  4. In **Select DNS resolver**, choose *Configure custom DNS resolvers*.\n\n  5. Enter the IP addresses of your custom DNS resolver. As you enter an IP address, Gateway will search through your [virtual networks](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/tunnel-virtual-networks/) configured in Zero Trust.\n\n  6. In **Network**, choose whether to route queries publicly (to the Internet) or privately (to a private network service).\n\n  7. (Optional) Enter a custom port for each IP address.\n\n  8. Select **Create policy**.\n\n  Custom resolvers are saved to your account for future use. You can add up to 10 IPv4 and 10 IPv6 addresses to a policy.\n\n* Terraform (v5)\n\n  1. Add the following permission to your [`cloudflare_api_token`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/api_token):\n\n     * `Zero Trust Write`\n\n  2. Create a resolver policy using the [`cloudflare_zero_trust_gateway_policy`](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/zero_trust_gateway_policy) resource:",
      "language": "unknown"
    },
    {
      "code": "When a user's query matches a resolver policy, Gateway will send the query to your listed resolvers in the following order:\n\n1. Public resolvers\n2. Private resolvers behind the default virtual network for your account\n3. Private resolvers behind a custom virtual network\n\nGateway will cache the fastest resolver for use in subsequent queries. Resolver priority is cached on a per user basis for each data center.\n\nFor more information on creating a DNS policy, refer to [DNS policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/dns-policies/).\n\nTerraform provider v4 precedence limitation\n\nTo avoid conflicts, version 4 of the Terraform Cloudflare provider applies a hash calculation to policy precedence. For example, a precedence of `1000` may become `1000901`. This can cause errors when reordering policies. To avoid this issue, manually set the precedence of policies created with Terraform using the [Update a Zero Trust Gateway rule](https://developers.cloudflare.com/api/resources/zero_trust/subresources/gateway/subresources/rules/methods/update/) endpoint.\n\nTo ensure your precedence is set correctly, Cloudflare recommends [upgrading your Terraform provider to version 5](https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/guides/version-5-upgrade).\n\n## Selectors\n\n### Content Categories\n\nUse this selector to filter domains belonging to specific [content categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#content-categories).\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Content Categories | `any(dns.content_category[*] in {1})` | Before DNS resolution |\n\n### DNS Resolver IP\n\nUse this selector to apply policies to DNS queries that arrived to your Gateway Resolver IP address aligned with a registered DNS location. For most Gateway customers, this is an IPv4 anycast address and policies created using this IPv4 address will apply to all DNS locations. However, each DNS location has a dedicated IPv6 address and some Gateway customers have been supplied with a dedicated IPv4 address — these both can be used to apply policies to specific registered DNS locations.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DNS Resolver IP | `any(dns.resolved_ip[*] == 198.51.100.0)` | Before DNS resolution |\n\n### DoH Subdomain\n\nUse this selector to match against DNS queries that arrive via DNS-over-HTTPS (DoH) destined for the DoH endpoint configured for each DNS location. For example, you can use a DNS location with a DoH endpoint of `abcdefg.cloudflare-gateway.com` by choosing the DoH Subdomain selector and inputting a value of `abcdefg`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| DOH Subdomain | `dns.doh_subdomain == \"abcdefg\"` | Before DNS resolution |\n\n### Domain\n\nUse this selector to match against a domain and all subdomains. For example, you can match `example.com` and its subdomains, such as `www.example.com`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Domain | `any(dns.domains[*] == \"example.com\")` | Before DNS resolution |\n\nGateway policies do not support domains with non-Latin characters directly. To use a domain with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\n### Host\n\nUse this selector to match against only the hostname specified. For example, you can match `test.example.com` but not `example.com` or `www.test.example.com`.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Host | `dns.fqdn == \"example.com\"` | Before DNS resolution |\n\nGateway policies do not support hostnames with non-Latin characters directly. To use a hostname with non-Latin characters, add it to a [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/).\n\nNote\n\nSome hostnames (`example.com`) will invisibly redirect to the www subdomain (`www.example.com`). To match this type of website, use the [Domain](#domain) selector instead of the Host selector.\n\n### Location\n\nUse this selector to apply policies to a specific [Gateway DNS location](https://developers.cloudflare.com/cloudflare-one/networks/resolvers-and-proxies/dns/locations/) or set of locations.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Location | `dns.location in {\"location_uuid_1\" \"location_uuid_2\"}` | Before DNS resolution |\n\n### Query Record Type\n\nUse this selector to choose the DNS resource record type that you would like to apply policies against. For example, you can match `A` records for a domain but not `MX` records.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Query Record Type | `dns.query_rtype == \"TXT\"` | Before DNS resolution |\n\n### Security Categories\n\nUse this selector to match domains (and optionally, [IP addresses](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#filter-traffic-by-resolved-ip-category)) belonging to specific [security categories](https://developers.cloudflare.com/cloudflare-one/traffic-policies/domain-categories/#security-categories).\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Security Categories | `any(dns.security_category[*] in {1})` | Before DNS resolution |\n\n### Source Continent\n\nUse this selector to filter based on the continent where the query arrived to Gateway from.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a continent, enter its two-letter code into the **Value** field:\n\n| Continent | Code |\n| - | - |\n| Africa | `AF` |\n| Antarctica | `AN` |\n| Asia | `AS` |\n| Europe | `EU` |\n| North America | `NA` |\n| Oceania | `OC` |\n| South America | `SA` |\n| Tor network | `T1` |\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source Continent IP Geolocation | `dns.src.geo.continent == \"North America\"` | Before DNS resolution |\n\n### Source Country\n\nUse this selector to filter based on the country where the query arrived to Gateway from.\n\nGeolocation is determined from the device's public IP address (typically assigned by the user's ISP). To specify a country, enter its [ISO 3166-1 Alpha-2 code](https://www.iso.org/obp/ui/#search/code/) in the **Value** field.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source Country IP Geolocation | `dns.src.geo.country == \"RU\"` | Before DNS resolution |\n\n### Source IP\n\nUse this selector to apply policies to the source IP address of DNS queries. For example, this could be the WAN IP address of the stub resolver used by your organization to send queries to Gateway.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| Source IP | `dns.src_ip == 198.51.100.0` | Before DNS resolution |\n\n### Users\n\nUse these selectors to match against identity attributes.\n\n| UI name | API example | Evaluation phase |\n| - | - | - |\n| User Email | `identity.email == \"user@example.com\"` | Before DNS resolution |\n| User Name | `identity.name == \"Test User\"` | Before DNS resolution |\n| User Group IDs | `any(identity.groups[*].id in {\"group_id\"})` | Before DNS resolution |\n| User Group Names | `any(identity.groups[*].name in {\"group_name\"})` | Before DNS resolution |\n| User Group Emails | `any(identity.groups[*].email in {\"group@example.com\"})` | Before DNS resolution |\n| SAML Attributes | `any(identity.saml_attributes[\"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\"] in {\"Test User\"})` | Before DNS resolution |\n\n## Comparison operators\n\nComparison operators are the way Gateway matches traffic to a selector. When you choose a **Selector** in the dashboard policy builder, the **Operator** dropdown menu will display the available options for that selector.\n\n| Operator | Meaning |\n| - | - |\n| is | equals the defined value |\n| is not | does not equal the defined value |\n| in | matches at least one of the defined values |\n| not in | does not match any of the defined values |\n| in list | in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| not in list | not in a pre-defined [list](https://developers.cloudflare.com/cloudflare-one/reusable-components/lists/) of values |\n| matches regex | regex evaluates to true |\n| does not match regex | regex evaluates to false |\n| greater than | exceeds the defined number |\n| greater than or equal to | exceeds or equals the defined number |\n| less than | below the defined number |\n| less than or equal to | below or equals the defined number |\n\n## Value\n\nIn the **Value** field, you can input a single value when using an equality comparison operator (such as *is*) or multiple values when using a containment comparison operator (such as *in*). Additionally, you can use [regular expressions](#regular-expressions) (or regex) to specify a range of values for supported selectors.\n\n### Regular expressions\n\nGateway uses Rust to evaluate regular expressions. The Rust implementation is slightly different than regex libraries used elsewhere. For more information, refer to our guide for [Wildcards](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/app-paths/#wildcards). To evaluate if your regex matches, you can use [Rustexp](https://rustexp.lpil.uk/).\n\nIf you want to match multiple values, you can use the pipe symbol (`|`) as an OR operator. In Gateway, you do not need to use an escape character (`\\`) before the pipe symbol. For example, the following policy blocks requests to two hostnames if either appears in a request header:\n\n| Selector | Operator | Value | Action |\n| - | - | - | - |\n| Host | matches regex | `.\\*whispersystems.org\\|.\\*signal.org` | Block |\n\nIn addition to regular expressions, you can use [logical operators](#logical-operators) to match multiple values.\n\n## Logical operators\n\nTo evaluate multiple conditions in an expression, select the **And** logical operator. These expressions can be compared further with the **Or** logical operator.\n\n| Operator | Meaning |\n| - | - |\n| And | match all of the conditions in the expression |\n| Or | match any of the conditions in the expression |\n\nThe **Or** operator will only work with conditions in the same expression group. For example, you cannot compare conditions in **Traffic** with conditions in Identity.\n\n</page>\n\n<page>\n---\ntitle: Create custom headers for Cloudflare Access-protected origins with\n  Workers · Cloudflare One docs\ndescription: This tutorial covers how to use a Cloudflare Worker to add custom\n  headers to traffic. The headers will be sent to origin services protected by\n  Cloudflare Access.\nlastUpdated: 2025-10-24T20:47:24.000Z\nchatbotDeprioritize: false\ntags: JavaScript\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/access-workers/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/access-workers/index.md\n---\n\nThis tutorial covers how to use a [Cloudflare Worker](https://developers.cloudflare.com/workers/) to add custom HTTP headers to traffic, and how to send those custom headers to your origin services protected by [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/).\n\nSome applications and networking implementations require specific custom headers to be passed to the origin, which can be difficult to implement for traffic moving through a Zero Trust proxy. You can configure a Worker to send the [user authorization headers](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/) required by Access.\n\n***\n\n## Before you begin\n\n* Secure your origin server with Cloudflare Access\n\n## Before you begin\n\n1. In the [Cloudflare dashboard](https://dash.cloudflare.com/), go to the **Workers & Pages** page.\n\n   [Go to **Workers & Pages**](https://dash.cloudflare.com/?to=/:account/workers-and-pages)\n\n2. If this is your first Worker, select **Create Worker**. Otherwise, select **Create application**, then select **Create Worker**.\n\n3. Enter an identifiable name for the Worker, then select **Deploy**.\n\n4. Select **Edit code**.\n\n5. Input the following Worker:\n\n* JavaScript",
      "language": "unknown"
    },
    {
      "code": "* TypeScript",
      "language": "unknown"
    },
    {
      "code": "1. Select **Save and deploy**.\n\nYour Worker is now ready to send custom headers to your Access-protected origin services.\n\n## Apply the Worker to your hostname\n\n1. Select the Worker you created, then go to **Triggers**.\n2. In **Routes**, select **Add route**.\n3. Enter the hostname and zone for your origin, then select **Add route**.\n\nThe Worker will now insert a custom header into requests that match the defined route. For example:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Create and secure an AI agent wrapper using AI Gateway and Zero Trust ·\n  Cloudflare One docs\ndescription: This tutorial explains how to use Cloudflare AI Gateway and Zero\n  Trust to create a functional and secure website wrapper for an AI agent.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\ntags: AI\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/ai-wrapper-tenant-control/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/ai-wrapper-tenant-control/index.md\n---\n\nThis tutorial explains how to use [Cloudflare AI Gateway](https://developers.cloudflare.com/ai-gateway/) and Zero Trust to create a functional and secure website wrapper for an AI agent. Cloudflare Zero Trust administrators can protect access to the wrapper with [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/). Additionally, you can enforce [Gateway policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/) to control how your users interact with AI agents, including executing AI agents in an isolated browser with [Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/), enforcing [Data Loss Prevention](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) profiles to prevent your users from sharing sensitive data, and scanning content to avoid answers from AI agents that violate internal corporate guidelines. Creating an AI agent wrapper is also an effective way to enforce tenant control if you have an enterprise plan for a specific AI provider, such as ChatGPT Enterprise.\n\nThis tutorial uses ChatGPT as an example AI agent.\n\n## Before you begin\n\nMake sure you have:\n\n* A [Cloudflare Zero Trust organization](https://developers.cloudflare.com/cloudflare-one/setup/).\n* An API key for your desired AI provider, such as an [OpenAI API key](https://platform.openai.com/api-keys) for ChatGPT.\n\n## 1. Create an AI gateway\n\nFirst, create an AI gateway to control your AI app.\n\n1. In the [Cloudflare dashboard](https://dash.cloudflare.com/), go to the **AI Gateway** page.\n\n   [Go to **AI Gateway**](https://dash.cloudflare.com/?to=/:account/ai/ai-gateway)\n\n2. Select **Create Gateway**.\n\n3. Name your gateway.\n\n4. Select **Create**.\n\n5. Configure your desired options for the gateway.\n\n6. [Connect your AI provider](https://developers.cloudflare.com/ai-gateway/get-started/#connect-application) to proxy queries to your AI agent of choice using your AI gateway.\n\n7. (Optional) Turn on [Authenticated Gateway](https://developers.cloudflare.com/ai-gateway/configuration/authentication/). The Authenticated Gateway feature ensures your AI gateway can only be called securely by enforcing a token in the form of a request header `cf-aig-authorization`.\n\n   1. Go to **AI** > **AI Gateway**.\n   2. Select your AI gateway, then go to **Settings**.\n   3. Turn on **Authenticated Gateway**, then choose **Confirm**.\n   4. Select **Create authentication token**, then select **Create an AI Gateway authentication token**.\n   5. Configure your token and copy the token value. When creating your Worker, you will need to pass this token when calling your AI gateway.\n\nFor more information, refer to [Getting started with AI Gateway](https://developers.cloudflare.com/ai-gateway/get-started/).\n\n## 2. (Optional) Use Guardrails to block unsafe or inappropriate content\n\n[Guardrails](https://developers.cloudflare.com/ai-gateway/features/guardrails/) is an built-in AI Gateway security feature that allows Cloudflare to identify unsafe or inappropriate content in prompts and responses based on selected categories.\n\n1. In the Cloudflare dashboard, go to the **AI Gateway** page.\n\n   [Go to **AI Gateway**](https://dash.cloudflare.com/?to=/:account/ai/ai-gateway)\n\n2. Select your AI gateway.\n\n3. Go to **Guardrails**.\n\n4. Turn on Guardrails.\n\n5. Select **Change** to configure the categories you would like to filter for both prompts and responses.\n\n## 3. Build a Worker to serve the wrapper\n\n### 1. Create the Worker\n\nIn order to build the Worker, you will need to choose if you want to build it locally using [Wrangler](https://developers.cloudflare.com/workers/wrangler/install-and-update/) or remotely using the [dashboard](https://dash.cloudflare.com/).\n\n* Wrangler\n\n  1. In a terminal, log in to your Cloudflare account:",
      "language": "unknown"
    },
    {
      "code": "2. Initiate the project locally:",
      "language": "unknown"
    },
    {
      "code": "3. Create a `wrangler.toml` configuration file:",
      "language": "unknown"
    },
    {
      "code": "4. Add your AI provider's API key as a [secret](https://developers.cloudflare.com/workers/configuration/secrets/):",
      "language": "unknown"
    },
    {
      "code": "You can now build the Worker using the `index.js` file created by Wrangler.\n\n* Dashboard\n\n  1. In the Cloudflare dashboard, go to the **Workers & Pages** page.\n\n     [Go to **Workers & Pages**](https://dash.cloudflare.com/?to=/:account/workers-and-pages)\n\n  2. Select **Create**.\n\n  3. In **Workers**, choose the **Hello world** template.\n\n  4. Name your worker, then select **Deploy**.\n\n  5. Select your Worker, then go to the **Settings** tab.\n\n  6. Go to **Variables and Secrets**, then select **Add**.\n\n  7. Choose *Secret* as the type, name your secret (for example, `OPENAI_API_KEY`), and enter the value of your AI provider's API key in **Value**.\n\n  You can now build the Worker using the online code editor by selecting **Edit code** on your Worker page.\n\n### 2. Build the Worker\n\nThe following is an example starter Worker that serves a simple front-end to allow a user to interact with an AI provider behind AI Gateway. This example uses OpenAI as its AI provider:",
      "language": "unknown"
    },
    {
      "code": "Note that the account ID and gateway ID need to be replaced in the AI Gateway endpoint. You can add these as [environment variables](https://developers.cloudflare.com/workers/configuration/environment-variables/) or [secrets](https://developers.cloudflare.com/workers/configuration/secrets/) in Workers. If you chose to use Authenticated Gateway when creating your AI gateway, make sure to also add your token as a secret and pass its value to the AI gateway in the `cf-aig-authorization` header.\n\n### 3. Publish the Worker\n\nOnce the Worker code is complete, you need to make the Worker addressable using a hostname controllable by Cloudflare Access.\n\n* Wrangler\n\n  Edit the `wrangler.toml` configuration file and add the following information to ensure that the Worker is only accessible using the custom hostname:",
      "language": "unknown"
    },
    {
      "code": "To publish the worker, run `wrangler publish`.\n\n* Dashboard\n\n  If you built your Worker remotely using the [code editor](https://developers.cloudflare.com/workers/get-started/dashboard/) available in the Cloudflare dashboard, you can deploy it by selecting **Deploy**.\n\n  To ensure that the Worker is only accessible from the custom hostname:\n\n  1. In the Cloudflare dashboard, go to the **Workers & Pages** page.\n\n     [Go to **Workers & Pages**](https://dash.cloudflare.com/?to=/:account/workers-and-pages)\n\n  2. Select your Worker.\n\n  3. Go to **Settings**.\n\n  4. Within **Domains & Routes**, select **Add**.\n\n  5. Choose **Custom domain**.\n\n  6. Enter your desired custom domain name.\n\n  7. Select **Add domain**.\n\n  The Worker is now behind an addressable public hostname. Make sure to turn off both **workers.dev** and **Preview URLs** so that the Worker can only be accessed with its custom domain.\n\n## 4. Secure the wrapper with Access\n\nTo secure the AI agent wrapper to ensure that only trusted users can access it:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Access controls** > **Applications**.\n2. Select **Add an application**.\n3. Choose **Self-hosted**.\n4. Enter a name for your AI agent wrapper application.\n5. In **Session Duration**, choose when the user's application token should expire.\n6. Select **Add public hostname** and enter the custom domain you set for your Worker.\n7. [Configure your Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) for your Worker.\n8. Add [Access policies](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/policy-management/) to control who can connect to your application.\n\nNow your AI wrapper can only be accessed by your users that successfully match your Access policies.\n\n## 5. Block access to public AI agents with Gateway\n\nYou can now block access to all unauthorized public AI agents with a Gateway [HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/).\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Firewall policies** > **HTTP**.\n\n2. Select **Add a policy**.\n\n3. Add the following policy:\n\n   | Selector | Operator | Value | Action |\n   | - | - | - | - |\n   | Content Categories | in | *Artificial Intelligence* | Block |\n\n4. Select **Create policy**.\n\nThis ensures that public AI agents are not accessible using a managed endpoint.\n\nAlternatively, you can prevent users from using public AI agents by displaying a [custom block message](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#customize-the-block-page), [redirect](https://developers.cloudflare.com/cloudflare-one/reusable-components/custom-pages/gateway-block-page/#redirect-to-a-block-page), or a [user notification](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/#warp-client-block-notifications) directing users to the AI agent wrapper.\n\n## 6. Enforce Data Loss Prevention and Clientless Browser Isolation\n\nNow that you have full control over access to your AI agent wrapper, you can enforce extra security methods such as Data Loss Prevention (DLP) and Clientless Web Isolation to protect and control data shared with the AI agent.\n\n### Apply Data Loss Prevention profiles\n\nYou can use [Data Loss Prevention (DLP)](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/) to prevent your users from sending sensitive data to the AI agent.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Data loss prevention** > **Profiles**.\n\n2. Ensure that the [DLP profiles](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-profiles/) you want to enforce are properly configured.\n\n3. Add an HTTP policy to enforce the DLP profile for the hostname for your wrapper. For example:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | Host | is | `ai-wrapper.example.com` | And | Block |\n   | DLP Profile | in | *AI DLP profile* | | |\n\n4. Select **Create policy**.\n\nFor more information on creating DLP policies, refer to [Scan HTTP traffic](https://developers.cloudflare.com/cloudflare-one/data-loss-prevention/dlp-policies/).\n\n### Execute in a clientless isolated browser\n\nBecause you published your wrapper as a self-hosted Access application, you can execute it in an [isolated session](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/setup/clientless-browser-isolation/) for your users by creating an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) and configuring it for your application.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Browser isolation** > **Browser isolation settings**.\n2. Under **Manage remote browser permissions**, select **Manage**.\n3. Enable **Clientless Web Isolation**.\n\n1) Go to **Access controls** > **Policies**.\n2) Select **Add a policy**.\n3) Set the **Action** to *Allow*.\n4) In **Add rules**, add identity rules to define who the application should be isolated for.\n5) In **Additional settings (optional)**, turn on **Isolate application**.\n\nOnce the Access policy has been created, you can attach it to your wrapper.\n\n1. Go to **Access controls** > **Applications**.\n2. Choose your wrapper application, then select **Configure**.\n3. In **Policies**, select **Select existing policies**.\n4. Choose the Access policy you previously created.\n5. Select **Confirm**, then select **Save application**.\n\nBecause Clientless Web Isolation traffic applies your Gateway HTTP policies, your configured DLP profiles will apply to isolated sessions.\n\nFor more information on isolating an Access application, refer to [Isolate self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/isolate-application/).\n\n## Additional benefits\n\nOrganizations that adopt Cloudflare to secure access to AI agents will benefit from improved visibility and configurability.\n\n### Visibility\n\nZero Trust will log all [Access events](https://developers.cloudflare.com/cloudflare-one/insights/logs/audit-logs/) and [DLP detections](https://developers.cloudflare.com/cloudflare-one/insights/logs/gateway-logs/#http-logs). In addition, AI Gateway provides [visibility](https://developers.cloudflare.com/ai-gateway/observability/logging/) into user prompts, model response, token usage, and costs.\n\nLogs can be exported to external providers with [Logpush](https://developers.cloudflare.com/logs/logpush/).\n\n### Configurability\n\nYou can configure your wrapper to use a [different AI provider](https://developers.cloudflare.com/ai-gateway/usage/providers/) or give your users the option to choose between multiple AI providers, including AI models running directly on Cloudflare's global network with [Workers AI](https://developers.cloudflare.com/workers-ai/). With this, you can control costs related to AI usage or adopt newer models without impacting your users or the access controls already put in place.\n\n</page>\n\n<page>\n---\ntitle: Connect through Cloudflare Access using a CLI · Cloudflare One docs\ndescription: Cloudflare's cloudflared command-line tool allows you to interact\n  with endpoints protected by Cloudflare Access.\nlastUpdated: 2025-11-19T16:09:15.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/cli/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/cli/index.md\n---\n\nCloudflare's `cloudflared` command-line tool allows you to interact with endpoints protected by Cloudflare Access. You can use `cloudflared` to interact with a protected application's API.\n\nThese instructions are not meant for configuring a service to run against an API. The token in this example is tailored to user identity and intended only for an end user interacting with an API via a command-line tool.\n\n**This walkthrough covers how to:**\n\n* Connect to resources secured by Cloudflare Access from a CLI\n\n**Time to complete:**\n\n30 minutes\n\n***\n\n## Authenticate a session from the command line\n\nOnce you have [installed `cloudflared`](https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/downloads/), you can use it to retrieve a Cloudflare Access [application token](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/). This walkthrough uses the domain `example.com` as a stand-in for a protected API.\n\n1. To generate a token, run the following command:",
      "language": "unknown"
    },
    {
      "code": "With this command, `cloudflared` launches a browser window containing the same Access login page found when attempting to access a web application.\n\n2. Select your identity provider and log in.\n\nIf the browser window does not launch, you can use the unique URL that is automatically printed to the command line.\n\n1. Once you have successfully authenticated, the browser returns the token to `cloudflared` in a cryptographic transfer and stores it.\n\nThe token is valid for the [session duration](https://developers.cloudflare.com/cloudflare-one/access-controls/access-settings/session-management/) configured by the Access administrator.\n\n## Access your API\n\nOnce you have retrieved a token, you can access the protected API. The `cloudflared` command-line tool includes a wrapper for transferring data via `curl`, which uses URL syntax (for more, see the [curl](https://github.com/curl/curl) GitHub project). The wrapper injects the token into the `curl` request as a query argument named *token*. You can invoke the wrapper as follows:",
      "language": "unknown"
    },
    {
      "code": "It is possible also to use the `put` command with `cloudflared` for any Unix tool to include the token in the request.\n\nRead on for other available commands.\n\n## Available commands\n\n### login\n\nThe `login` command initiates the login flow for an application behind Access.",
      "language": "unknown"
    },
    {
      "code": "### curl\n\nThe `curl` command invokes the client wrapper and includes the token in the request automatically.",
      "language": "unknown"
    },
    {
      "code": "### token\n\nThe `token` command retrieves the token scoped to that specific application for use in other command-line tools.",
      "language": "unknown"
    },
    {
      "code": "## Using the token as an environment variable\n\nIt is possible to save the token as an environment variable for convenience and concision in scripts that access a protected application.\n\nSet up a token as an environment variable as follows:\n\n1. Run the following command to export the token to the shell environment:",
      "language": "unknown"
    },
    {
      "code": "2. Confirm the token was saved with the following:",
      "language": "unknown"
    },
    {
      "code": "Once you have exported the token to your environment, use the variable with the Cloudflare Access request header in the script to access a protected endpoint, as in the following example:",
      "language": "unknown"
    },
    {
      "code": "</page>\n\n<page>\n---\ntitle: Access a web application via its private hostname without WARP ·\n  Cloudflare One docs\ndescription: With Cloudflare Browser Isolation and resolver policies, users can\n  connect to private web-based applications via their private hostnames.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/clientless-access-private-dns/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/clientless-access-private-dns/index.md\n---\n\nWith Cloudflare Browser Isolation and resolver policies, users can connect to private web-based applications via their private hostnames without needing to install the WARP client. By the end of this tutorial, users who pass your Gateway DNS and network policies will be able to access your private application at `https://<your-team-name>.cloudflareaccess.com/browser/https://internalrecord.com`.\n\n## Before you begin\n\nMake sure you have:\n\n* [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) enabled on your account\n* [Resolver policies](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/) enabled on your account\n* An HTTP or HTTPS application that users access through a browser\n\n## Create a Cloudflare Tunnel\n\nFirst, install `cloudflared` on a server in your private network:\n\n1. Log in to [Cloudflare One](https://one.dash.cloudflare.com) and go to **Networks** > **Connectors** > **Cloudflare Tunnels**.\n\n2. Select **Create a tunnel**.\n\n3. Choose **Cloudflared** for the connector type and select **Next**.\n\n4. Enter a name for your tunnel. We suggest choosing a name that reflects the type of resources you want to connect through this tunnel (for example, `enterprise-VPC-01`).\n\n5. Select **Save tunnel**.\n\n6. Next, you will need to install `cloudflared` and run it. To do so, check that the environment under **Choose an environment** reflects the operating system on your machine, then copy the command in the box below and paste it into a terminal window. Run the command.\n\n7. Once the command has finished running, your connector will appear in Cloudflare One.\n\n   ![Connector appearing in the UI after cloudflared has run](https://developers.cloudflare.com/_astro/connector.BnVS4T_M_ZUMQ9r.webp)\n\n8. Select **Next**.\n\n## Add private network routes\n\n1. In the **CIDR** tab, add the following IP addresses:\n\n   * Private IP/CIDR of your application server (for example, `10.128.0.175/32`)\n   * Private IP/CIDR of your DNS server\n\n2. Select **Save tunnel**.\n\nThe application and DNS server are now connected to Cloudflare.\n\n## Enable Clientless Web Isolation\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Browser isolation** > **Browser isolation settings**.\n2. Under **Manage remote browser permissions**, select **Manage**.\n3. Enable **Clientless Web Isolation**.\n\n1) For **Permissions**, select **Manage**.\n\n2) Select **Add a rule**.\n\n3) Create an expression that defines who can open the Clientless Web Isolation browser. For example,\n\n   | Rule action | Rule type | Selector | Value | Action |\n   | - | - | - | - | - |\n   | Allow | Include | Emails ending in | `@example.com` | Select **Save**. |\n\nTo test, open a browser and go to `https://<team-name>.cloudflareaccess.com/browser/https://<private-IP-of-application>`.\n\n## Create a Gateway resolver policy\n\n1. Go to **Traffic policies** > **Resolver policies**.\n\n2. Select **Add a policy**.\n\n3. Create an expression to match against the private [domain](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/#domain) or [hostname](https://developers.cloudflare.com/cloudflare-one/traffic-policies/resolver-policies/#host) of the application:\n\n   | Selector | Operator | Value |\n   | - | - | - |\n   | Domain | in | `internalrecord.com` |\n\n4. In **Select DNS resolver**, select *Configure custom DNS resolvers*.\n\n5. Enter the private IP address of your DNS server.\n\n6. In the dropdown menu, select *`<IP-address> - Private`*.\n\n7. (Optional) Enter a custom port.\n\n8. Select **Create policy**.\n\nTo test, open a browser and go to `https://<team-name>.cloudflareaccess.com/browser/https://internalrecord.com`.\n\n## Create a Gateway network policy (recommended)\n\n1. Go to **Traffic policies** > **Firewall policies** > **Network**.\n\n2. Add a [network policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/network-policies/) that targets the private IP address of your application. You can optionally include any ports or protocols relevant for application access. For example,\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | Destination IP | in | `10.128.0.175` | And | Allow |\n   | Destination Port | in | `80` | Or | |\n   | User Email | matches regex | `.*example.com` | | |\n\nNote\n\nDevice posture checks are not supported because they require the WARP client.\n\nFor best practices on securing private applications, refer to [Build secure access policies](https://developers.cloudflare.com/learning-paths/replace-vpn/build-policies/).\n\n## Connect as a user\n\nUsers can now access the application at the following URL:\n\n`https://<team-name>.cloudflareaccess.com/browser/https://internalrecord.com`\n\nThe application will load in an isolated browser. You can optionally [configure remote browser controls](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/#policy-settings) such as disabling copy/paste, printing, or keyboard input.\n\n</page>\n\n<page>\n---\ntitle: Use Microsoft Entra ID Conditional Access policies in Cloudflare Access ·\n  Cloudflare One docs\ndescription: With Conditional Access in Microsoft Entra ID, administrators can\n  enforce policies on applications and users directly in EntraID.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-conditional-access/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-conditional-access/index.md\n---\n\nWith [Conditional Access](https://learn.microsoft.com/entra/identity/conditional-access/overview) in Microsoft Entra ID (formerly Azure Active Directory), administrators can enforce policies on applications and users directly in Entra ID. Conditional Access has a set of checks that are specialized to Windows and are often preferred by organizations with Windows power users.\n\n## Before you begin\n\nMake sure you have:\n\n* Global admin rights to Microsoft Entra ID account\n* Configured users in the Microsoft Entra ID account\n\n## Set up an identity provider for your application\n\nRefer to [our IdP setup instructions](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#set-up-entra-id-as-an-identity-provider) for Entra ID.\n\n## Add API permission in Entra ID\n\nOnce the base IdP integration is tested and working, grant permission for Cloudflare to read Conditional Access policies from Entra ID.\n\n1. In Microsoft Entra ID, go to **App registrations**.\n\n2. Select the application you created for the IdP integration.\n\n3. Go to **API permissions** and select **Add a permission**.\n\n4. Select **Microsoft Graph**.\n\n5. Select **Application permissions** and add `Policy.Read.ConditionalAccess`.\n\n   Note\n\n   You must select **Application permissions**; delegated permissions will not work for this feature.\n\n6. Select **Grant admin consent**.\n\n## Configure Conditional Access in Entra ID\n\n1. In Microsoft Entra ID, go to **Enterprise applications** > **Conditional Access**.\n\n2. Go to **Authentication Contexts**.\n\n3. [Create an authentication context](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-cloud-apps#authentication-context) to reference in your Cloudflare Access policies. Give the authentication context a descriptive name (for example, `Require compliant devices`).\n\n4. Next, go to **Policies**.\n\n5. [Create a new Conditional Access policy](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-policies) or select an existing policy.\n\n6. Assign the conditional access policy to an authentication context:\n\n   1. In the policy builder, select **Target resources**.\n   2. In the **Select what this policy applies to** dropdown, select *Authentication context*.\n   3. Select the authentication context that will use this policy.\n   4. Save the policy.\n\n## Sync Conditional Access with Zero Trust\n\nTo import your Conditional Access policies into Cloudflare Access:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Access settings**.\n2. In **Manage your App Launcher**, select **Manage**.\n3. Choose **Login methods**.\n4. Find your Microsoft Entra ID integration and select **Edit**.\n5. Enable **Azure AD Policy Sync**.\n6. Select **Save**.\n\n## Create an Access application\n\nTo enforce your Conditional Access policies on a Cloudflare Access application:\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Access controls** > **Applications**.\n\n2. Select **Add an application**.\n\n3. Select **Self-hosted**.\n\n4. Enter any name for the application.\n\n5. Select **Add public hostname** and enter the target URL of the protected application.\n\n6. Select **Create new policy** and build an [Access policy](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) using the *Azure AD - Auth context* selector. For example:\n\n   | Action | Rule type | Selector | Value |\n   | - | - | - | - |\n   | Allow | Include | Emails ending in | `@example.com` |\n   | | Require | Azure AD - Auth context | `Require compliant devices` |\n\n7. Add this policy to your application configuration.\n\n8. For **Identity providers**, select your Microsoft Entra ID integration.\n\n9. Follow the remaining [self-hosted application creation steps](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) to publish the application.\n\nUsers will only be allowed access if they pass the Microsoft Entra ID Conditional Access policies associated with this authentication context.\n\n</page>\n\n<page>\n---\ntitle: Isolate risky Entra ID users · Cloudflare One docs\ndescription: Microsoft Entra ID (formerly Azure Active Directory) calculates a\n  user's risk level based on the probability that their account has been\n  compromised. With Cloudflare Zero Trust, you can synchronize the Entra ID\n  risky users list with Cloudflare Access and apply more stringent Zero Trust\n  policies to users at higher risk.\nlastUpdated: 2025-11-20T23:13:05.000Z\nchatbotDeprioritize: false\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-risky-users/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/entra-id-risky-users/index.md\n---\n\nMicrosoft Entra ID (formerly Azure Active Directory) calculates a user's [risk level](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-investigate-risk) based on the probability that their account has been compromised. With Cloudflare Zero Trust, you can synchronize the Entra ID risky users list with Cloudflare Access and apply more stringent Zero Trust policies to users at higher risk.\n\nThis tutorial demonstrates how to automatically redirect users to a remote browser when they are deemed risky by Entra ID.\n\n**Time to complete:**\n\n1 hour\n\n## Prerequisites\n\n* Microsoft Entra ID Premium P2 license\n* [Cloudflare Browser Isolation](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/) add-on\n* [Gateway HTTP filtering](https://developers.cloudflare.com/cloudflare-one/traffic-policies/initial-setup/http/) enabled on your devices\n* [npm](https://docs.npmjs.com/getting-started) installation\n* [Node.js](https://nodejs.org/en/) installation\n\n## 1. Set up Entra ID as an identity provider\n\nRefer to [our IdP setup instructions](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#set-up-entra-id-as-an-identity-provider) for Entra ID.\n\nNote\n\n* When you configure the IdP in Cloudflare One, be sure to select **Enable group membership change reauthentication**.\n* Save the **Application (client) ID**, **Directory (tenant) ID**, and **Client secret** as you will need them again in a later step.\n\n## 2. Add Entra ID API permissions\n\nOnce the base IdP integration is tested and working, enable additional permissions that will allow a script to create and update risky user groups in Entra ID:\n\n1. In Microsoft Entra ID, go to **App registrations**.\n\n2. Select the application you created for the IdP integration.\n\n3. Go to **API permissions** and select **Add a permission**.\n\n4. Select **Microsoft Graph**.\n\n5. Select **Application permissions** and add the following [permissions](https://learn.microsoft.com/en-us/graph/permissions-reference):\n\n   * `IdentityRiskyUser.ReadAll`\n   * `Directory.ReadWriteAll`\n   * `Group.Create`\n   * `Group.ReadAll`\n   * `GroupMember.ReadAll`\n   * `GroupMember.ReadWriteAll`\n\n6. Select **Grant admin consent**.\n\nYou will see the list of enabled permissions.\n\n![API permissions in Entra ID](https://developers.cloudflare.com/_astro/risky-users-permissions.BXnsnrQO_Z2ljTdH.webp)\n\n## 3. Add risky users to Entra ID group\n\nNext, configure an automated script that will populate an Entra ID security group with risky users.\n\nTo get started quickly, deploy our example Cloudflare Workers script by following the step-by-step instructions below. Alternatively, you can implement the script using [Azure Functions](https://learn.microsoft.com/azure/azure-functions/functions-overview) or any other tool.\n\n1. Open a terminal and clone our example project.",
      "language": "unknown"
    },
    {
      "code": "2. Go to the project directory.",
      "language": "unknown"
    },
    {
      "code": "3. Modify the [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/) to include the following values:\n\n   * `<ACCOUNT_ID>`: your Cloudflare [account ID](https://developers.cloudflare.com/fundamentals/account/find-account-and-zone-ids/).\n   * `<TENANT_ID>`: your Entra ID **Directory (tenant) ID**, obtained when [setting up Entra ID as an identity provider](#1-set-up-entra-id-as-an-identity-provider).\n   * `<CLIENT_ID>`: your Entra ID **Application (client) ID**, obtained when [setting up Entra ID as an identity provider](#1-set-up-entra-id-as-an-identity-provider).\n\n   - wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "- wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "Note\n\nThe [Cron Trigger](https://developers.cloudflare.com/workers/configuration/cron-triggers/) in this example schedules the script to run every minute. Learn more about [supported cron expressions](https://developers.cloudflare.com/workers/configuration/cron-triggers/#supported-cron-expressions).\n\n1. Deploy the Worker to Cloudflare's global network.",
      "language": "unknown"
    },
    {
      "code": "2. Create a secret variable named `AZURE_AD_CLIENT_SECRET`.",
      "language": "unknown"
    },
    {
      "code": "You will be prompted to input the secret's value. Enter the **Client secret** obtained when [setting up Microsoft Entra ID as an identity provider](#1-set-up-azure-ad-as-an-identity-provider).\n\nThe Worker script will begin executing once per minute. To view realtime logs, run the following command and wait for the script to execute:",
      "language": "unknown"
    },
    {
      "code": "After the initial run, the auto-generated groups will appear in the Entra ID dashboard.\n\n![Risky user groups in the Entra ID dashboard](https://developers.cloudflare.com/_astro/risky-users-groups.DdF4Xs9Y_o7tTE.webp)\n\n## 4. Synchronize risky user groups\n\nNext, synchronize Entra ID risky user groups with Cloudflare Access:\n\n1. [Enable SCIM synchronization](https://developers.cloudflare.com/cloudflare-one/integrations/identity-providers/entra-id/#synchronize-users-and-groups).\n\n2. In Entra ID, assign the following groups to your SCIM enterprise application:\n\n   * `IdentityProtection-RiskyUser-RiskLevel-high`\n   * `IdentityProtection-RiskyUser-RiskLevel-medium`\n   * `IdentityProtection-RiskyUser-RiskLevel-low`\n\nCloudflare Access will now synchronize changes in group membership with Entra ID. You can verify the synchronization status on the SCIM application's **Provisioning** page.\n\n## 5. Create a browser isolation policy\n\nFinally, create a [Gateway HTTP policy](https://developers.cloudflare.com/cloudflare-one/traffic-policies/http-policies/) to isolate traffic for risky user groups.\n\n1. In [Cloudflare One](https://one.dash.cloudflare.com), go to **Traffic policies** > **Firewall policies** > **HTTP**.\n\n2. Select **Add a policy**.\n\n3. Build an [Isolate policy](https://developers.cloudflare.com/cloudflare-one/remote-browser-isolation/isolation-policies/) that contains a *User Group Names* rule. For example, the following policy serves `app1.example.com` and `app2.example.com` in a remote browser for all members flagged as high risk:\n\n   | Selector | Operator | Value | Logic | Action |\n   | - | - | - | - | - |\n   | Domain | in | `app1.example.com`, `app2.example.com` | And | Isolate |\n   | User Group Names | in | `IdentityProtection-RiskyUser-RiskLevel-high` | | |\n\nTo test the policy, refer to the Microsoft documentation for [simulating risky detections](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-simulate-risk).\n\n</page>\n\n<page>\n---\ntitle: Send SSO attributes to Access-protected origins with Workers · Cloudflare\n  One docs\ndescription: This tutorial will walk you through extending the single-sign-on\n  (SSO) capabilities of Cloudflare Access with our serverless computing\n  platform, Cloudflare Workers.\nlastUpdated: 2025-10-24T20:47:24.000Z\nchatbotDeprioritize: false\ntags: SSO\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/extend-sso-with-workers/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/extend-sso-with-workers/index.md\n---\n\nThis tutorial will walk you through extending the single-sign-on (SSO) capabilities of [Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) with our serverless computing platform, [Cloudflare Workers](https://developers.cloudflare.com/workers/). Specifically, this guide will demonstrate how to modify requests sent to your secured origin to include additional information from the Cloudflare Access authentication event.\n\n**Time to complete:** 45 minutes\n\n## Authentication flow\n\n[Cloudflare Access](https://developers.cloudflare.com/cloudflare-one/access-controls/policies/) is an authentication proxy in charge of validating a user's identity before they connect to your application. As shown in the diagram below, Access inserts a [JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/) into the request, which can then be [verified](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/#validate-jwts) by the origin server.\n\n![Standard authentication flow for a request to an Access application](https://developers.cloudflare.com/_astro/access-standard-flow.CLZ6SIBs_Z1DXHBY.webp)\n\nYou can extend this functionality by using a Cloudflare Worker to insert additional HTTP headers into the request. In this example, we will add the [device posture attributes](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/#enforce-device-posture) `firewall_activated` and `disk_encrypted`, but you can include any attributes that Cloudflare Access collects from the authentication event.\n\n![Extended authentication flow uses a Worker to pass additional request headers to the origin](https://developers.cloudflare.com/_astro/access-extended-flow-serverless.DKpY2r43_Z1G09wT.webp)\n\n## Benefits\n\nThis approach allows you to:\n\n* **Enhance security:** By incorporating additional information from the authentication event, you can implement more robust security measures. For example, you can use device posture data to enforce access based on device compliance.\n* **Improve user experience:** You can personalize the user experience by tailoring content or functionality based on user attributes. For example, you can display different content based on the user's role or location.\n* **Simplify development:** By using Cloudflare Workers, you can easily extend your Cloudflare Access configuration without modifying your origin application code.\n\n## Before you begin\n\n* Add a [self-hosted application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) to Cloudflare Access.\n* Enable the [Disk encryption](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/disk-encryption/) and [Firewall](https://developers.cloudflare.com/cloudflare-one/reusable-components/posture-checks/warp-client-checks/firewall/) device posture checks.\n* Install [Wrangler](https://developers.cloudflare.com/workers/wrangler/install-and-update/) on your local machine.\n\n## 1. Create the Worker\n\n1. Create a new Workers project:\n\n   * npm",
      "language": "unknown"
    },
    {
      "code": "* yarn",
      "language": "unknown"
    },
    {
      "code": "* pnpm",
      "language": "unknown"
    },
    {
      "code": "For setup, select the following options:\n\n   * For *What would you like to start with?*, choose `Hello World example`.\n   * For *Which template would you like to use?*, choose `Worker only`.\n   * For *Which language do you want to use?*, choose `JavaScript`.\n   * For *Do you want to use git for version control?*, choose `Yes`.\n   * For *Do you want to deploy your application?*, choose `No` (we will be making some changes before deploying).\n\n2. Change to the project directory:",
      "language": "unknown"
    },
    {
      "code": "3. Copy-paste the following code into `src/index.js`. Be sure to replace `<your-team-name>` with your Zero Trust team name.",
      "language": "unknown"
    },
    {
      "code": "## 2. View the user's identity\n\nThe script in `index.js` uses the [`get-identity`](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/application-token/#user-identity) endpoint to fetch a user's complete identity from a Cloudflare Access authentication event. To view a list of available data fields, log in to your Access application and append `/cdn-cgi/access/get-identity` to the URL. For example, if `www.example.com` is behind Access, go to `https://www.example.com/cdn-cgi/access/get-identity`.\n\nBelow is an example of a user identity that includes the `disk_encryption` and `firewall` posture checks. The Worker inserts the posture check results into the request headers **Cf-Access-Firewall-Activated** and **Cf-Access-Disk-Encrypted**.",
      "language": "unknown"
    },
    {
      "code": "## 3. Route the Worker to your application\n\nIn the [Wrangler configuration file](https://developers.cloudflare.com/workers/wrangler/configuration/), [set up a route](https://developers.cloudflare.com/workers/configuration/routing/routes/) that maps the Worker to your Access application domain:\n\n* wrangler.jsonc",
      "language": "unknown"
    },
    {
      "code": "* wrangler.toml",
      "language": "unknown"
    },
    {
      "code": "## 4. Deploy the Worker",
      "language": "unknown"
    },
    {
      "code": "The Worker will now insert the **Cf-Access-Firewall-Activated** and **Cf-Access-Disk-Encrypted** headers into requests that pass your application's Access policies.",
      "language": "unknown"
    },
    {
      "code": "You can verify that these headers are received by the origin server.\n\n</page>\n\n<page>\n---\ntitle: Validate the Access token with FastAPI · Cloudflare One docs\ndescription: This tutorial covers how to validate that the Access JWT is on\n  requests made to FastAPI apps. The code is written in Python.\nlastUpdated: 2025-11-19T16:09:15.000Z\nchatbotDeprioritize: false\ntags: Python\nsource_url:\n  html: https://developers.cloudflare.com/cloudflare-one/tutorials/fastapi/\n  md: https://developers.cloudflare.com/cloudflare-one/tutorials/fastapi/index.md\n---\n\nThis tutorial covers how to validate that the [Access JWT](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/) is on requests made to FastAPI apps.\n\n**Time to complete:** 15 minutes\n\n## Prerequisites\n\n* A [self-hosted Access application](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/self-hosted-public-app/) for your FastAPI app\n* The [AUD tag](https://developers.cloudflare.com/cloudflare-one/access-controls/applications/http-apps/authorization-cookie/validating-json/#get-your-aud-tag) for your Access application\n\n## 1. Create a validation function\n\n1. In your FastAPI project, create a new file called `cloudflare.py` that contains the following code:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "2025-07-15",
      "id": "2025-07-15"
    },
    {
      "level": "h2",
      "text": "2024-12-19",
      "id": "2024-12-19"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "2024-10-17",
      "id": "2024-10-17"
    },
    {
      "level": "h2",
      "text": "2024-10-10",
      "id": "2024-10-10"
    },
    {
      "level": "h2",
      "text": "2024-08-06",
      "id": "2024-08-06"
    },
    {
      "level": "h2",
      "text": "2025-12-09",
      "id": "2025-12-09"
    },
    {
      "level": "h2",
      "text": "2025-12-09",
      "id": "2025-12-09"
    },
    {
      "level": "h2",
      "text": "2025-11-11",
      "id": "2025-11-11"
    },
    {
      "level": "h2",
      "text": "2025-11-11",
      "id": "2025-11-11"
    },
    {
      "level": "h2",
      "text": "2025-11-11",
      "id": "2025-11-11"
    },
    {
      "level": "h2",
      "text": "2025-10-16",
      "id": "2025-10-16"
    },
    {
      "level": "h2",
      "text": "2025-10-16",
      "id": "2025-10-16"
    },
    {
      "level": "h2",
      "text": "2025-10-07",
      "id": "2025-10-07"
    },
    {
      "level": "h2",
      "text": "2025-10-07",
      "id": "2025-10-07"
    },
    {
      "level": "h2",
      "text": "2025-10-07",
      "id": "2025-10-07"
    },
    {
      "level": "h2",
      "text": "2025-09-30",
      "id": "2025-09-30"
    },
    {
      "level": "h2",
      "text": "2025-09-30",
      "id": "2025-09-30"
    },
    {
      "level": "h2",
      "text": "2025-09-30",
      "id": "2025-09-30"
    },
    {
      "level": "h2",
      "text": "2025-09-10",
      "id": "2025-09-10"
    },
    {
      "level": "h2",
      "text": "2025-09-10",
      "id": "2025-09-10"
    },
    {
      "level": "h2",
      "text": "2025-08-29",
      "id": "2025-08-29"
    },
    {
      "level": "h2",
      "text": "2025-08-21",
      "id": "2025-08-21"
    },
    {
      "level": "h2",
      "text": "2025-08-19",
      "id": "2025-08-19"
    },
    {
      "level": "h2",
      "text": "2025-08-19",
      "id": "2025-08-19"
    },
    {
      "level": "h2",
      "text": "2025-08-19",
      "id": "2025-08-19"
    },
    {
      "level": "h2",
      "text": "2025-07-24",
      "id": "2025-07-24"
    },
    {
      "level": "h2",
      "text": "2025-07-24",
      "id": "2025-07-24"
    },
    {
      "level": "h2",
      "text": "2025-07-23",
      "id": "2025-07-23"
    },
    {
      "level": "h2",
      "text": "2025-07-23",
      "id": "2025-07-23"
    },
    {
      "level": "h2",
      "text": "2025-07-23",
      "id": "2025-07-23"
    },
    {
      "level": "h2",
      "text": "2025-06-30",
      "id": "2025-06-30"
    },
    {
      "level": "h2",
      "text": "2025-06-30",
      "id": "2025-06-30"
    },
    {
      "level": "h2",
      "text": "2025-06-30",
      "id": "2025-06-30"
    },
    {
      "level": "h2",
      "text": "2025-06-30",
      "id": "2025-06-30"
    },
    {
      "level": "h2",
      "text": "2025-06-30",
      "id": "2025-06-30"
    },
    {
      "level": "h2",
      "text": "2025-06-17",
      "id": "2025-06-17"
    },
    {
      "level": "h2",
      "text": "2025-06-17",
      "id": "2025-06-17"
    },
    {
      "level": "h2",
      "text": "2025-06-05",
      "id": "2025-06-05"
    },
    {
      "level": "h2",
      "text": "2025-06-05",
      "id": "2025-06-05"
    },
    {
      "level": "h2",
      "text": "2025-05-22",
      "id": "2025-05-22"
    },
    {
      "level": "h2",
      "text": "2025-05-22",
      "id": "2025-05-22"
    },
    {
      "level": "h2",
      "text": "2025-05-22",
      "id": "2025-05-22"
    },
    {
      "level": "h2",
      "text": "2025-05-14",
      "id": "2025-05-14"
    },
    {
      "level": "h2",
      "text": "2025-05-12",
      "id": "2025-05-12"
    },
    {
      "level": "h2",
      "text": "2025-05-12",
      "id": "2025-05-12"
    },
    {
      "level": "h2",
      "text": "2025-04-22",
      "id": "2025-04-22"
    },
    {
      "level": "h2",
      "text": "2025-04-22",
      "id": "2025-04-22"
    },
    {
      "level": "h2",
      "text": "2025-04-08",
      "id": "2025-04-08"
    },
    {
      "level": "h2",
      "text": "2025-04-08",
      "id": "2025-04-08"
    },
    {
      "level": "h2",
      "text": "2025-03-31",
      "id": "2025-03-31"
    },
    {
      "level": "h2",
      "text": "2025-03-31",
      "id": "2025-03-31"
    },
    {
      "level": "h2",
      "text": "2025-03-31",
      "id": "2025-03-31"
    },
    {
      "level": "h2",
      "text": "2025-03-17",
      "id": "2025-03-17"
    },
    {
      "level": "h2",
      "text": "2025-03-17",
      "id": "2025-03-17"
    },
    {
      "level": "h2",
      "text": "2025-03-13",
      "id": "2025-03-13"
    },
    {
      "level": "h2",
      "text": "2025-03-13",
      "id": "2025-03-13"
    },
    {
      "level": "h2",
      "text": "2025-02-19",
      "id": "2025-02-19"
    },
    {
      "level": "h2",
      "text": "2025-02-19",
      "id": "2025-02-19"
    },
    {
      "level": "h2",
      "text": "2025-02-19",
      "id": "2025-02-19"
    },
    {
      "level": "h2",
      "text": "2025-02-07",
      "id": "2025-02-07"
    },
    {
      "level": "h2",
      "text": "2025-01-28",
      "id": "2025-01-28"
    },
    {
      "level": "h2",
      "text": "2025-01-28",
      "id": "2025-01-28"
    },
    {
      "level": "h2",
      "text": "2025-01-09",
      "id": "2025-01-09"
    },
    {
      "level": "h2",
      "text": "2024-06-16",
      "id": "2024-06-16"
    },
    {
      "level": "h2",
      "text": "Datasets",
      "id": "datasets"
    },
    {
      "level": "h3",
      "text": "Dataset types",
      "id": "dataset-types"
    },
    {
      "level": "h3",
      "text": "Prepare DLP datasets",
      "id": "prepare-dlp-datasets"
    },
    {
      "level": "h3",
      "text": "Upload a new dataset",
      "id": "upload-a-new-dataset"
    },
    {
      "level": "h3",
      "text": "Manage existing datasets",
      "id": "manage-existing-datasets"
    },
    {
      "level": "h2",
      "text": "Documents",
      "id": "documents"
    },
    {
      "level": "h3",
      "text": "Prepare document entries",
      "id": "prepare-document-entries"
    },
    {
      "level": "h3",
      "text": "Upload a new document entry",
      "id": "upload-a-new-document-entry"
    },
    {
      "level": "h3",
      "text": "Manage existing document entries",
      "id": "manage-existing-document-entries"
    },
    {
      "level": "h2",
      "text": "AI prompt topics",
      "id": "ai-prompt-topics"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Configure a DLP profile",
      "id": "1.-configure-a-dlp-profile"
    },
    {
      "level": "h2",
      "text": "2. Create a DLP policy",
      "id": "2.-create-a-dlp-policy"
    },
    {
      "level": "h2",
      "text": "3. Test DLP policy",
      "id": "3.-test-dlp-policy"
    },
    {
      "level": "h2",
      "text": "4. View DLP logs",
      "id": "4.-view-dlp-logs"
    },
    {
      "level": "h3",
      "text": "Report false positives",
      "id": "report-false-positives"
    },
    {
      "level": "h2",
      "text": "Configure a predefined profile",
      "id": "configure-a-predefined-profile"
    },
    {
      "level": "h2",
      "text": "Build a custom profile",
      "id": "build-a-custom-profile"
    },
    {
      "level": "h2",
      "text": "Email activity",
      "id": "email-activity"
    },
    {
      "level": "h2",
      "text": "Disposition evaluation",
      "id": "disposition-evaluation"
    },
    {
      "level": "h2",
      "text": "Detection details",
      "id": "detection-details"
    },
    {
      "level": "h2",
      "text": "Impersonations",
      "id": "impersonations"
    },
    {
      "level": "h2",
      "text": "Phish submissions",
      "id": "phish-submissions"
    },
    {
      "level": "h2",
      "text": "Auto-move events",
      "id": "auto-move-events"
    },
    {
      "level": "h2",
      "text": "Detection settings metrics",
      "id": "detection-settings-metrics"
    },
    {
      "level": "h2",
      "text": "1. Create an outbound policy",
      "id": "1.-create-an-outbound-policy"
    },
    {
      "level": "h3",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h2",
      "text": "2. DLP Assist add-in",
      "id": "2.-dlp-assist-add-in"
    },
    {
      "level": "h3",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "ROI Calculator",
      "id": "roi-calculator"
    },
    {
      "level": "h2",
      "text": "Insider threat defense",
      "id": "insider-threat-defense"
    },
    {
      "level": "h2",
      "text": "Email threat hunting",
      "id": "email-threat-hunting"
    },
    {
      "level": "h2",
      "text": "Actions",
      "id": "actions"
    },
    {
      "level": "h2",
      "text": "API Status",
      "id": "api-status"
    },
    {
      "level": "h2",
      "text": "Managed email security operations",
      "id": "managed-email-security-operations"
    },
    {
      "level": "h2",
      "text": "Reports",
      "id": "reports"
    },
    {
      "level": "h3",
      "text": "Overview",
      "id": "overview"
    },
    {
      "level": "h3",
      "text": "Details",
      "id": "details"
    },
    {
      "level": "h2",
      "text": "1. Choose a deployment",
      "id": "1.-choose-a-deployment"
    },
    {
      "level": "h3",
      "text": "Post-delivery deployment",
      "id": "post-delivery-deployment"
    },
    {
      "level": "h3",
      "text": "Pre-delivery deployment",
      "id": "pre-delivery-deployment"
    },
    {
      "level": "h2",
      "text": "2. Understand dispositions",
      "id": "2.-understand-dispositions"
    },
    {
      "level": "h2",
      "text": "3. Set up the impersonation registry",
      "id": "3.-set-up-the-impersonation-registry"
    },
    {
      "level": "h2",
      "text": "4. Submit messages",
      "id": "4.-submit-messages"
    },
    {
      "level": "h3",
      "text": "Who can reclassify messages",
      "id": "who-can-reclassify-messages"
    },
    {
      "level": "h3",
      "text": "Why you should submit messages",
      "id": "why-you-should-submit-messages"
    },
    {
      "level": "h2",
      "text": "5. Configuration checklist",
      "id": "5.-configuration-checklist"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Can Access work with multiple identity providers at the same time?",
      "id": "can-access-work-with-multiple-identity-providers-at-the-same-time?"
    },
    {
      "level": "h2",
      "text": "What if the identity provider my team uses is not listed?",
      "id": "what-if-the-identity-provider-my-team-uses-is-not-listed?"
    },
    {
      "level": "h2",
      "text": "How do end users log out of an application protected by Access?",
      "id": "how-do-end-users-log-out-of-an-application-protected-by-access?"
    },
    {
      "level": "h2",
      "text": "Submit messages for review",
      "id": "submit-messages-for-review"
    },
    {
      "level": "h2",
      "text": "Upload EML files",
      "id": "upload-eml-files"
    },
    {
      "level": "h2",
      "text": "View submissions",
      "id": "view-submissions"
    },
    {
      "level": "h2",
      "text": "​Can I create a Tunnel for an apex domain?",
      "id": "​can-i-create-a-tunnel-for-an-apex-domain?"
    },
    {
      "level": "h2",
      "text": "​Does Cloudflare Tunnel support Websockets?",
      "id": "​does-cloudflare-tunnel-support-websockets?"
    },
    {
      "level": "h2",
      "text": "​Does Cloudflare Tunnel support gRPC?",
      "id": "​does-cloudflare-tunnel-support-grpc?"
    },
    {
      "level": "h2",
      "text": "How can Tunnel be used with Partial DNS (CNAME Setup)?",
      "id": "how-can-tunnel-be-used-with-partial-dns-(cname-setup)?"
    },
    {
      "level": "h2",
      "text": "How can origin servers be secured when using Tunnel?",
      "id": "how-can-origin-servers-be-secured-when-using-tunnel?"
    },
    {
      "level": "h2",
      "text": "What records are created for routing to a Named Tunnel's hostname?",
      "id": "what-records-are-created-for-routing-to-a-named-tunnel's-hostname?"
    },
    {
      "level": "h2",
      "text": "Does Cloudflare Tunnel send visitor IPs to my origin?",
      "id": "does-cloudflare-tunnel-send-visitor-ips-to-my-origin?"
    },
    {
      "level": "h2",
      "text": "Why does the name 'warp' and 'argo' appear in some legacy materials?",
      "id": "why-does-the-name-'warp'-and-'argo'-appear-in-some-legacy-materials?"
    },
    {
      "level": "h2",
      "text": "Is it possible to restore a deleted tunnel?",
      "id": "is-it-possible-to-restore-a-deleted-tunnel?"
    },
    {
      "level": "h2",
      "text": "How do I contact support?",
      "id": "how-do-i-contact-support?"
    },
    {
      "level": "h2",
      "text": "Why does my Windows device appear to switch from Wi-Fi to Ethernet when I enable WARP?",
      "id": "why-does-my-windows-device-appear-to-switch-from-wi-fi-to-ethernet-when-i-enable-warp?"
    },
    {
      "level": "h2",
      "text": "Why is my device not connecting to a closer Cloudflare data center?",
      "id": "why-is-my-device-not-connecting-to-a-closer-cloudflare-data-center?"
    },
    {
      "level": "h2",
      "text": "Why is my public IP address sometimes visible?",
      "id": "why-is-my-public-ip-address-sometimes-visible?"
    },
    {
      "level": "h2",
      "text": "Why has my throughput dropped while using WARP?",
      "id": "why-has-my-throughput-dropped-while-using-warp?"
    },
    {
      "level": "h2",
      "text": "Why is my device not connecting to a public Wi-Fi?",
      "id": "why-is-my-device-not-connecting-to-a-public-wi-fi?"
    },
    {
      "level": "h2",
      "text": "Why is my device not connecting to the Internet?",
      "id": "why-is-my-device-not-connecting-to-the-internet?"
    },
    {
      "level": "h2",
      "text": "Why is my device not connecting to the corporate Wi-Fi?",
      "id": "why-is-my-device-not-connecting-to-the-corporate-wi-fi?"
    },
    {
      "level": "h2",
      "text": "Why is my device not connecting to my private network?",
      "id": "why-is-my-device-not-connecting-to-my-private-network?"
    },
    {
      "level": "h2",
      "text": "How do I sign up for Cloudflare Zero Trust?",
      "id": "how-do-i-sign-up-for-cloudflare-zero-trust?"
    },
    {
      "level": "h2",
      "text": "What is a team domain/team name?",
      "id": "what-is-a-team-domain/team-name?"
    },
    {
      "level": "h3",
      "text": "Why is my old team name is still showing up on the Login page and App Launcher?",
      "id": "why-is-my-old-team-name-is-still-showing-up-on-the-login-page-and-app-launcher?"
    },
    {
      "level": "h2",
      "text": "How do I change my subscription plan?",
      "id": "how-do-i-change-my-subscription-plan?"
    },
    {
      "level": "h2",
      "text": "How are active seats measured?",
      "id": "how-are-active-seats-measured?"
    },
    {
      "level": "h3",
      "text": "Removing users",
      "id": "removing-users"
    },
    {
      "level": "h3",
      "text": "Revoking users",
      "id": "revoking-users"
    },
    {
      "level": "h2",
      "text": "How do I know if my network is protected behind Cloudflare Zero Trust?",
      "id": "how-do-i-know-if-my-network-is-protected-behind-cloudflare-zero-trust?"
    },
    {
      "level": "h2",
      "text": "What is the difference between Cloudflare Gateway and 1.1.1.1?",
      "id": "what-is-the-difference-between-cloudflare-gateway-and-1.1.1.1?"
    },
    {
      "level": "h2",
      "text": "Is multi-factor authentication supported?",
      "id": "is-multi-factor-authentication-supported?"
    },
    {
      "level": "h2",
      "text": "Which browsers are supported?",
      "id": "which-browsers-are-supported?"
    },
    {
      "level": "h2",
      "text": "What data localization services are supported?",
      "id": "what-data-localization-services-are-supported?"
    },
    {
      "level": "h2",
      "text": "What is the order of policy enforcement?",
      "id": "what-is-the-order-of-policy-enforcement?"
    },
    {
      "level": "h2",
      "text": "**How can I bypass the L7 firewall for a website?**",
      "id": "**how-can-i-bypass-the-l7-firewall-for-a-website?**"
    },
    {
      "level": "h2",
      "text": "Can I secure applications with a second-level subdomain URL?",
      "id": "can-i-secure-applications-with-a-second-level-subdomain-url?"
    },
    {
      "level": "h2",
      "text": "How do isolation policies work together with HTTP policies?",
      "id": "how-do-isolation-policies-work-together-with-http-policies?"
    },
    {
      "level": "h2",
      "text": "Why is API or CLI traffic not isolated?",
      "id": "why-is-api-or-cli-traffic-not-isolated?"
    },
    {
      "level": "h2",
      "text": "Can Access enforce policies on a specific nonstandard port?",
      "id": "can-access-enforce-policies-on-a-specific-nonstandard-port?"
    },
    {
      "level": "h2",
      "text": "Why can I still reach domains blocked by a Gateway policy?",
      "id": "why-can-i-still-reach-domains-blocked-by-a-gateway-policy?"
    },
    {
      "level": "h2",
      "text": "When does Access return a Forbidden status page versus a login page?",
      "id": "when-does-access-return-a-forbidden-status-page-versus-a-login-page?"
    },
    {
      "level": "h2",
      "text": "I tried to register the WARP client with my Zero Trust domain but received the following error messages: `Authentication Expired` and `Registration error. Please try again later`.",
      "id": "i-tried-to-register-the-warp-client-with-my-zero-trust-domain-but-received-the-following-error-messages:-`authentication-expired`-and-`registration-error.-please-try-again-later`."
    },
    {
      "level": "h2",
      "text": "I see a website is blocked, and it shouldn't be.",
      "id": "i-see-a-website-is-blocked,-and-it-shouldn't-be."
    },
    {
      "level": "h2",
      "text": "I see an error saying `No Access-Control-Allow-Origin header is present on the requested resource`.",
      "id": "i-see-an-error-saying-`no-access-control-allow-origin-header-is-present-on-the-requested-resource`."
    },
    {
      "level": "h2",
      "text": "I see untrusted certificate warnings for every page and I am unable to browse the Internet.",
      "id": "i-see-untrusted-certificate-warnings-for-every-page-and-i-am-unable-to-browse-the-internet."
    },
    {
      "level": "h2",
      "text": "I see error 526 when browsing to a website.",
      "id": "i-see-error-526-when-browsing-to-a-website."
    },
    {
      "level": "h2",
      "text": "I see an error in the Gateway Overview page, and no analytics are displayed.",
      "id": "i-see-an-error-in-the-gateway-overview-page,-and-no-analytics-are-displayed."
    },
    {
      "level": "h2",
      "text": "I see a \"No Browsers Available\" alert.",
      "id": "i-see-a-\"no-browsers-available\"-alert."
    },
    {
      "level": "h2",
      "text": "I see a \"Maximum Sessions Reached\" alert.",
      "id": "i-see-a-\"maximum-sessions-reached\"-alert."
    },
    {
      "level": "h2",
      "text": "I see `SAML Verify: Invalid SAML response, SAML Verify: No certificate selected to verify` when testing a SAML identity provider.",
      "id": "i-see-`saml-verify:-invalid-saml-response,-saml-verify:-no-certificate-selected-to-verify`-when-testing-a-saml-identity-provider."
    },
    {
      "level": "h2",
      "text": "I see `Error 0: Bad Request. Please create a ca for application.` when attempting to connect to SSH with a short-lived certificate.",
      "id": "i-see-`error-0:-bad-request.-please-create-a-ca-for-application.`-when-attempting-to-connect-to-ssh-with-a-short-lived-certificate."
    },
    {
      "level": "h2",
      "text": "Mobile applications warn of an invalid certificate, even though I installed a Cloudflare certificate on my system.",
      "id": "mobile-applications-warn-of-an-invalid-certificate,-even-though-i-installed-a-cloudflare-certificate-on-my-system."
    },
    {
      "level": "h2",
      "text": "Firefox shows a network protocol violation when I use the WARP client.",
      "id": "firefox-shows-a-network-protocol-violation-when-i-use-the-warp-client."
    },
    {
      "level": "h2",
      "text": "Chrome shows `NET::ERR_CERT_AUTHORITY_INVALID` when I use the WARP client.",
      "id": "chrome-shows-`net::err_cert_authority_invalid`-when-i-use-the-warp-client."
    },
    {
      "level": "h2",
      "text": "I see `Access api error auth_domain_cannot_be_updated_dash_sso`.",
      "id": "i-see-`access-api-error-auth_domain_cannot_be_updated_dash_sso`."
    },
    {
      "level": "h2",
      "text": "WARP on Linux shows `DNS connectivity check failed`.",
      "id": "warp-on-linux-shows-`dns-connectivity-check-failed`."
    },
    {
      "level": "h2",
      "text": "Windows incorrectly shows `No Internet access` when WARP is enabled.",
      "id": "windows-incorrectly-shows-`no-internet-access`-when-warp-is-enabled."
    },
    {
      "level": "h2",
      "text": "I see `WebGL Rendering Error`.",
      "id": "i-see-`webgl-rendering-error`."
    },
    {
      "level": "h2",
      "text": "I cannot send emails on port `25`.",
      "id": "i-cannot-send-emails-on-port-`25`."
    },
    {
      "level": "h2",
      "text": "I see `502 Bad Gateway` when browsing to a website.",
      "id": "i-see-`502-bad-gateway`-when-browsing-to-a-website."
    },
    {
      "level": "h2",
      "text": "I see `This site can't provide a secure connection.`",
      "id": "i-see-`this-site-can't-provide-a-secure-connection.`"
    },
    {
      "level": "h2",
      "text": "As of February 2, 2025, my end-user device's browser is returning a `Your connection is not private` warning.",
      "id": "as-of-february-2,-2025,-my-end-user-device's-browser-is-returning-a-`your-connection-is-not-private`-warning."
    },
    {
      "level": "h3",
      "text": "Why am I getting this error?",
      "id": "why-am-i-getting-this-error?"
    },
    {
      "level": "h3",
      "text": "What do I need to do?",
      "id": "what-do-i-need-to-do?"
    },
    {
      "level": "h3",
      "text": "I followed all the instructions but I am still having problems with my certificate.",
      "id": "i-followed-all-the-instructions-but-i-am-still-having-problems-with-my-certificate."
    },
    {
      "level": "h2",
      "text": "I am getting an `Error 401: deleted_client - The OAuth Client was deleted` authorization error.",
      "id": "i-am-getting-an-`error-401:-deleted_client---the-oauth-client-was-deleted`-authorization-error."
    },
    {
      "level": "h2",
      "text": "I entered an override code for WARP that was supposed to be valid for 3 hours but the override code expired faster than I expected.",
      "id": "i-entered-an-override-code-for-warp-that-was-supposed-to-be-valid-for-3-hours-but-the-override-code-expired-faster-than-i-expected."
    },
    {
      "level": "h3",
      "text": "Scenario one: Admin generates an override code at 9:00 AM with a timeout of one hour.",
      "id": "scenario-one:-admin-generates-an-override-code-at-9:00-am-with-a-timeout-of-one-hour."
    },
    {
      "level": "h3",
      "text": "Scenario two: Admin generates an override code at 9:30 AM with timeout of three hours.",
      "id": "scenario-two:-admin-generates-an-override-code-at-9:30-am-with-timeout-of-three-hours."
    },
    {
      "level": "h3",
      "text": "Scenario three: Admin generates an override code at 12:30 PM with a timeout of 24 hours.",
      "id": "scenario-three:-admin-generates-an-override-code-at-12:30-pm-with-a-timeout-of-24-hours."
    },
    {
      "level": "h2",
      "text": "I disabled WARP using an override code but WARP turned on by itself before my override code expired.",
      "id": "i-disabled-warp-using-an-override-code-but-warp-turned-on-by-itself-before-my-override-code-expired."
    },
    {
      "level": "h2",
      "text": "I am getting the error `Failed to fetch user/group information from the identity provider`.",
      "id": "i-am-getting-the-error-`failed-to-fetch-user/group-information-from-the-identity-provider`."
    },
    {
      "level": "h2",
      "text": "WSL2 is losing connectivity when using WARP.",
      "id": "wsl2-is-losing-connectivity-when-using-warp."
    },
    {
      "level": "h2",
      "text": "Clientless Web Isolation is loading with a blank screen on a Windows device.",
      "id": "clientless-web-isolation-is-loading-with-a-blank-screen-on-a-windows-device."
    },
    {
      "level": "h2",
      "text": "After putting Google Workspace behind Access, I can't log in. It keeps redirecting between Access and Google without ever completing authentication.",
      "id": "after-putting-google-workspace-behind-access,-i-can't-log-in.-it-keeps-redirecting-between-access-and-google-without-ever-completing-authentication."
    },
    {
      "level": "h2",
      "text": "When installing WARP on Windows, the Setup Wizard ends prematurely.",
      "id": "when-installing-warp-on-windows,-the-setup-wizard-ends-prematurely."
    },
    {
      "level": "h2",
      "text": "I get an `Invalid session. Please try logging in again.` error from Access when trying to log in to the Cloudflare dashboard via SSO.",
      "id": "i-get-an-`invalid-session.-please-try-logging-in-again.`-error-from-access-when-trying-to-log-in-to-the-cloudflare-dashboard-via-sso."
    },
    {
      "level": "h2",
      "text": "Long-lived SSH sessions frequently disconnect.",
      "id": "long-lived-ssh-sessions-frequently-disconnect."
    },
    {
      "level": "h2",
      "text": "Global status",
      "id": "global-status"
    },
    {
      "level": "h2",
      "text": "Access",
      "id": "access"
    },
    {
      "level": "h2",
      "text": "Gateway",
      "id": "gateway"
    },
    {
      "level": "h3",
      "text": "Proxy traffic",
      "id": "proxy-traffic"
    },
    {
      "level": "h3",
      "text": "Gateway (network requests)",
      "id": "gateway-(network-requests)"
    },
    {
      "level": "h3",
      "text": "DNS traffic",
      "id": "dns-traffic"
    },
    {
      "level": "h3",
      "text": "Gateway insights",
      "id": "gateway-insights"
    },
    {
      "level": "h3",
      "text": "CASB metrics",
      "id": "casb-metrics"
    },
    {
      "level": "h2",
      "text": "When a user reports a problem",
      "id": "when-a-user-reports-a-problem"
    },
    {
      "level": "h2",
      "text": "Troubleshooting other Cloudflare One features",
      "id": "troubleshooting-other-cloudflare-one-features"
    },
    {
      "level": "h3",
      "text": "Get started",
      "id": "get-started"
    },
    {
      "level": "h3",
      "text": "Directory",
      "id": "directory"
    },
    {
      "level": "h2",
      "text": "Log retention",
      "id": "log-retention"
    },
    {
      "level": "h2",
      "text": "Log Explorer Beta",
      "id": "log-explorer-beta"
    },
    {
      "level": "h2",
      "text": "Customer Metadata Boundary",
      "id": "customer-metadata-boundary"
    },
    {
      "level": "h2",
      "text": "Data privacy",
      "id": "data-privacy"
    },
    {
      "level": "h2",
      "text": "Footnotes",
      "id": "footnotes"
    },
    {
      "level": "h2",
      "text": "Set up IdPs in Cloudflare One",
      "id": "set-up-idps-in-cloudflare-one"
    },
    {
      "level": "h2",
      "text": "Test IdPs in Cloudflare One",
      "id": "test-idps-in-cloudflare-one"
    },
    {
      "level": "h3",
      "text": "Your provider is connected",
      "id": "your-provider-is-connected"
    },
    {
      "level": "h3",
      "text": "Your provider is not connected",
      "id": "your-provider-is-not-connected"
    },
    {
      "level": "h2",
      "text": "Use The API",
      "id": "use-the-api"
    },
    {
      "level": "h2",
      "text": "Supported WARP modes",
      "id": "supported-warp-modes"
    },
    {
      "level": "h2",
      "text": "Supported operating systems",
      "id": "supported-operating-systems"
    },
    {
      "level": "h2",
      "text": "Add a CIDR route",
      "id": "add-a-cidr-route"
    },
    {
      "level": "h2",
      "text": "Add a hostname route",
      "id": "add-a-hostname-route"
    },
    {
      "level": "h2",
      "text": "Add a published application route",
      "id": "add-a-published-application-route"
    },
    {
      "level": "h2",
      "text": "Add a WAN route",
      "id": "add-a-wan-route"
    },
    {
      "level": "h2",
      "text": "Screen reader",
      "id": "screen-reader"
    },
    {
      "level": "h3",
      "text": "Turn the screen reader on or off",
      "id": "turn-the-screen-reader-on-or-off"
    },
    {
      "level": "h2",
      "text": "Languages",
      "id": "languages"
    },
    {
      "level": "h2",
      "text": "Install an extension inside the remote browser",
      "id": "install-an-extension-inside-the-remote-browser"
    },
    {
      "level": "h3",
      "text": "Prerequisite: Isolate Chrome Web Store",
      "id": "prerequisite:-isolate-chrome-web-store"
    },
    {
      "level": "h3",
      "text": "Install an extension",
      "id": "install-an-extension"
    },
    {
      "level": "h2",
      "text": "Remove an extension from the remote browser",
      "id": "remove-an-extension-from-the-remote-browser"
    },
    {
      "level": "h2",
      "text": "Useful extensions",
      "id": "useful-extensions"
    },
    {
      "level": "h3",
      "text": "Modify remote browser user agent",
      "id": "modify-remote-browser-user-agent"
    },
    {
      "level": "h3",
      "text": "Control remote browser request headers",
      "id": "control-remote-browser-request-headers"
    },
    {
      "level": "h2",
      "text": "Isolate",
      "id": "isolate"
    },
    {
      "level": "h2",
      "text": "Do Not Isolate",
      "id": "do-not-isolate"
    },
    {
      "level": "h2",
      "text": "Policy settings",
      "id": "policy-settings"
    },
    {
      "level": "h3",
      "text": "Copy (from remote to client)",
      "id": "copy-(from-remote-to-client)"
    },
    {
      "level": "h3",
      "text": "Paste (from client to remote)",
      "id": "paste-(from-client-to-remote)"
    },
    {
      "level": "h3",
      "text": "File downloads",
      "id": "file-downloads"
    },
    {
      "level": "h3",
      "text": "File uploads",
      "id": "file-uploads"
    },
    {
      "level": "h3",
      "text": "Keyboard",
      "id": "keyboard"
    },
    {
      "level": "h3",
      "text": "Printing",
      "id": "printing"
    },
    {
      "level": "h2",
      "text": "Custom block dialog Beta",
      "id": "custom-block-dialog-beta"
    },
    {
      "level": "h2",
      "text": "Common policies",
      "id": "common-policies"
    },
    {
      "level": "h3",
      "text": "Isolate all security threats",
      "id": "isolate-all-security-threats"
    },
    {
      "level": "h3",
      "text": "Isolate high risk content",
      "id": "isolate-high-risk-content"
    },
    {
      "level": "h3",
      "text": "Isolate news and media",
      "id": "isolate-news-and-media"
    },
    {
      "level": "h3",
      "text": "Isolate uncategorized content",
      "id": "isolate-uncategorized-content"
    },
    {
      "level": "h3",
      "text": "Isolate ChatGPT",
      "id": "isolate-chatgpt"
    },
    {
      "level": "h2",
      "text": "Website compatibility",
      "id": "website-compatibility"
    },
    {
      "level": "h2",
      "text": "Browser compatibility",
      "id": "browser-compatibility"
    },
    {
      "level": "h3",
      "text": "Brave",
      "id": "brave"
    },
    {
      "level": "h2",
      "text": "Protocol support",
      "id": "protocol-support"
    },
    {
      "level": "h2",
      "text": "Virtual machines",
      "id": "virtual-machines"
    },
    {
      "level": "h2",
      "text": "Gateway selectors",
      "id": "gateway-selectors"
    },
    {
      "level": "h2",
      "text": "File download size",
      "id": "file-download-size"
    },
    {
      "level": "h2",
      "text": "Multifactor authentication",
      "id": "multifactor-authentication"
    },
    {
      "level": "h2",
      "text": "SAML applications",
      "id": "saml-applications"
    },
    {
      "level": "h2",
      "text": "Browser Isolation is not compatible with private apps on non-`443` ports",
      "id": "browser-isolation-is-not-compatible-with-private-apps-on-non-`443`-ports"
    },
    {
      "level": "h2",
      "text": "Remoting client",
      "id": "remoting-client"
    },
    {
      "level": "h3",
      "text": "Remoting Client (Services)",
      "id": "remoting-client-(services)"
    },
    {
      "level": "h3",
      "text": "WebRTC channel",
      "id": "webrtc-channel"
    },
    {
      "level": "h2",
      "text": "1. Connect devices to Cloudflare",
      "id": "1.-connect-devices-to-cloudflare"
    },
    {
      "level": "h2",
      "text": "2. Build an Isolation policy",
      "id": "2.-build-an-isolation-policy"
    },
    {
      "level": "h2",
      "text": "3. Check if a web page is isolated",
      "id": "3.-check-if-a-web-page-is-isolated"
    },
    {
      "level": "h3",
      "text": "Normal browsing",
      "id": "normal-browsing"
    },
    {
      "level": "h3",
      "text": "Isolated browsing",
      "id": "isolated-browsing"
    },
    {
      "level": "h2",
      "text": "List types",
      "id": "list-types"
    },
    {
      "level": "h2",
      "text": "Create a list from a CSV file",
      "id": "create-a-list-from-a-csv-file"
    },
    {
      "level": "h2",
      "text": "Create a list manually",
      "id": "create-a-list-manually"
    },
    {
      "level": "h2",
      "text": "Edit a list",
      "id": "edit-a-list"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "List size",
      "id": "list-size"
    },
    {
      "level": "h3",
      "text": "Wildcard entries",
      "id": "wildcard-entries"
    },
    {
      "level": "h3",
      "text": "Non-Latin characters",
      "id": "non-latin-characters"
    },
    {
      "level": "h3",
      "text": "Duplicate entries",
      "id": "duplicate-entries"
    },
    {
      "level": "h3",
      "text": "URL slashes",
      "id": "url-slashes"
    },
    {
      "level": "h3",
      "text": "Extended email addresses",
      "id": "extended-email-addresses"
    },
    {
      "level": "h3",
      "text": "API rate limit",
      "id": "api-rate-limit"
    },
    {
      "level": "h2",
      "text": "`cf.colo.name`",
      "id": "`cf.colo.name`"
    },
    {
      "level": "h2",
      "text": "`cf.colo.region`",
      "id": "`cf.colo.region`"
    },
    {
      "level": "h2",
      "text": "`icmp`",
      "id": "`icmp`"
    },
    {
      "level": "h2",
      "text": "`icmp.type`",
      "id": "`icmp.type`"
    },
    {
      "level": "h2",
      "text": "`icmp.code`",
      "id": "`icmp.code`"
    },
    {
      "level": "h2",
      "text": "`ip`",
      "id": "`ip`"
    },
    {
      "level": "h2",
      "text": "`ip.dst`",
      "id": "`ip.dst`"
    },
    {
      "level": "h2",
      "text": "`ip.dst.country`",
      "id": "`ip.dst.country`"
    },
    {
      "level": "h2",
      "text": "`ip.src.country`",
      "id": "`ip.src.country`"
    },
    {
      "level": "h2",
      "text": "`ip.hdr_len`",
      "id": "`ip.hdr_len`"
    },
    {
      "level": "h2",
      "text": "`ip.len`",
      "id": "`ip.len`"
    },
    {
      "level": "h2",
      "text": "`ip.opt.type`",
      "id": "`ip.opt.type`"
    },
    {
      "level": "h2",
      "text": "`ip.proto`",
      "id": "`ip.proto`"
    },
    {
      "level": "h2",
      "text": "`ip.src`",
      "id": "`ip.src`"
    },
    {
      "level": "h2",
      "text": "`ip.src.country`",
      "id": "`ip.src.country`"
    },
    {
      "level": "h2",
      "text": "`ip.ttl`",
      "id": "`ip.ttl`"
    },
    {
      "level": "h2",
      "text": "`sip`",
      "id": "`sip`"
    },
    {
      "level": "h2",
      "text": "`tcp`",
      "id": "`tcp`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags`",
      "id": "`tcp.flags`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.ack`",
      "id": "`tcp.flags.ack`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.cwr`",
      "id": "`tcp.flags.cwr`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.ecn`",
      "id": "`tcp.flags.ecn`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.fin`",
      "id": "`tcp.flags.fin`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.push`",
      "id": "`tcp.flags.push`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.reset`",
      "id": "`tcp.flags.reset`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.syn`",
      "id": "`tcp.flags.syn`"
    },
    {
      "level": "h2",
      "text": "`tcp.flags.urg`",
      "id": "`tcp.flags.urg`"
    },
    {
      "level": "h2",
      "text": "`tcp.srcport`",
      "id": "`tcp.srcport`"
    },
    {
      "level": "h2",
      "text": "`tcp.dstport`",
      "id": "`tcp.dstport`"
    },
    {
      "level": "h2",
      "text": "`udp`",
      "id": "`udp`"
    },
    {
      "level": "h2",
      "text": "`udp.dstport`",
      "id": "`udp.dstport`"
    },
    {
      "level": "h2",
      "text": "`udp.srcport`",
      "id": "`udp.srcport`"
    },
    {
      "level": "h3",
      "text": "Create a tag",
      "id": "create-a-tag"
    },
    {
      "level": "h3",
      "text": "Tag an Access application",
      "id": "tag-an-access-application"
    },
    {
      "level": "h2",
      "text": "1. Enable device posture checks",
      "id": "1.-enable-device-posture-checks"
    },
    {
      "level": "h2",
      "text": "2. Verify device posture checks",
      "id": "2.-verify-device-posture-checks"
    },
    {
      "level": "h2",
      "text": "3. Build a device posture policy",
      "id": "3.-build-a-device-posture-policy"
    },
    {
      "level": "h2",
      "text": "4. Ensure traffic is going through WARP",
      "id": "4.-ensure-traffic-is-going-through-warp"
    },
    {
      "level": "h2",
      "text": "Policy enforcement rate",
      "id": "policy-enforcement-rate"
    },
    {
      "level": "h3",
      "text": "Expiration",
      "id": "expiration"
    },
    {
      "level": "h3",
      "text": "Polling frequency",
      "id": "polling-frequency"
    },
    {
      "level": "h2",
      "text": "1. Create a [new IP list](https://developers.cloudflare.com/api/resources/rules/subresources/lists/methods/create/).",
      "id": "1.-create-a-[new-ip-list](https://developers.cloudflare.com/api/resources/rules/subresources/lists/methods/create/)."
    },
    {
      "level": "h2",
      "text": "2. Add IPs to the list",
      "id": "2.-add-ips-to-the-list"
    },
    {
      "level": "h2",
      "text": "3. Use the list in a rule",
      "id": "3.-use-the-list-in-a-rule"
    },
    {
      "level": "h2",
      "text": "Managed lists",
      "id": "managed-lists"
    },
    {
      "level": "h2",
      "text": "List types",
      "id": "list-types"
    },
    {
      "level": "h3",
      "text": "Threat intelligence",
      "id": "threat-intelligence"
    },
    {
      "level": "h3",
      "text": "IP lists",
      "id": "ip-lists"
    },
    {
      "level": "h3",
      "text": "Geo-blocking",
      "id": "geo-blocking"
    },
    {
      "level": "h2",
      "text": "View application details",
      "id": "view-application-details"
    },
    {
      "level": "h3",
      "text": "Overview",
      "id": "overview"
    },
    {
      "level": "h3",
      "text": "Findings",
      "id": "findings"
    },
    {
      "level": "h3",
      "text": "Policies",
      "id": "policies"
    },
    {
      "level": "h3",
      "text": "Usage",
      "id": "usage"
    },
    {
      "level": "h2",
      "text": "Review applications",
      "id": "review-applications"
    },
    {
      "level": "h2",
      "text": "Application confidence scorecards",
      "id": "application-confidence-scorecards"
    },
    {
      "level": "h3",
      "text": "Scoring methodology",
      "id": "scoring-methodology"
    },
    {
      "level": "h3",
      "text": "Automated scoring infrastructure",
      "id": "automated-scoring-infrastructure"
    },
    {
      "level": "h2",
      "text": "Applications",
      "id": "applications"
    },
    {
      "level": "h2",
      "text": "App types",
      "id": "app-types"
    },
    {
      "level": "h2",
      "text": "Application hostnames",
      "id": "application-hostnames"
    },
    {
      "level": "h3",
      "text": "Hostnames",
      "id": "hostnames"
    },
    {
      "level": "h3",
      "text": "Support hostnames",
      "id": "support-hostnames"
    },
    {
      "level": "h2",
      "text": "Application controls",
      "id": "application-controls"
    },
    {
      "level": "h2",
      "text": "Usage",
      "id": "usage"
    },
    {
      "level": "h3",
      "text": "Overlapping hostnames",
      "id": "overlapping-hostnames"
    },
    {
      "level": "h3",
      "text": "Do Not Inspect applications",
      "id": "do-not-inspect-applications"
    },
    {
      "level": "h3",
      "text": "Terraform",
      "id": "terraform"
    },
    {
      "level": "h2",
      "text": "Actions",
      "id": "actions"
    },
    {
      "level": "h3",
      "text": "Allow",
      "id": "allow"
    },
    {
      "level": "h3",
      "text": "Block",
      "id": "block"
    },
    {
      "level": "h3",
      "text": "Override",
      "id": "override"
    },
    {
      "level": "h3",
      "text": "Safe Search",
      "id": "safe-search"
    },
    {
      "level": "h3",
      "text": "YouTube Restricted Mode",
      "id": "youtube-restricted-mode"
    },
    {
      "level": "h2",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h3",
      "text": "Application",
      "id": "application"
    },
    {
      "level": "h3",
      "text": "Authoritative Nameserver IP",
      "id": "authoritative-nameserver-ip"
    },
    {
      "level": "h3",
      "text": "Content Categories",
      "id": "content-categories"
    },
    {
      "level": "h3",
      "text": "DNS CNAME Record",
      "id": "dns-cname-record"
    },
    {
      "level": "h3",
      "text": "DNS MX Record",
      "id": "dns-mx-record"
    },
    {
      "level": "h3",
      "text": "DNS PTR Record",
      "id": "dns-ptr-record"
    },
    {
      "level": "h3",
      "text": "DNS Resolver IP",
      "id": "dns-resolver-ip"
    },
    {
      "level": "h3",
      "text": "DNS TXT Record",
      "id": "dns-txt-record"
    },
    {
      "level": "h3",
      "text": "DoH Subdomain",
      "id": "doh-subdomain"
    },
    {
      "level": "h3",
      "text": "Domain",
      "id": "domain"
    },
    {
      "level": "h3",
      "text": "Host",
      "id": "host"
    },
    {
      "level": "h3",
      "text": "Indicator Feeds",
      "id": "indicator-feeds"
    },
    {
      "level": "h3",
      "text": "Location",
      "id": "location"
    },
    {
      "level": "h3",
      "text": "Query Record Type",
      "id": "query-record-type"
    },
    {
      "level": "h3",
      "text": "Resolved Continent",
      "id": "resolved-continent"
    },
    {
      "level": "h3",
      "text": "Resolved Country",
      "id": "resolved-country"
    },
    {
      "level": "h3",
      "text": "Resolved IP",
      "id": "resolved-ip"
    },
    {
      "level": "h3",
      "text": "Request Context Categories",
      "id": "request-context-categories"
    },
    {
      "level": "h3",
      "text": "Security Categories",
      "id": "security-categories"
    },
    {
      "level": "h3",
      "text": "Source Continent",
      "id": "source-continent"
    },
    {
      "level": "h3",
      "text": "Source Country",
      "id": "source-country"
    },
    {
      "level": "h3",
      "text": "Source IP",
      "id": "source-ip"
    },
    {
      "level": "h3",
      "text": "Source Internal IP",
      "id": "source-internal-ip"
    },
    {
      "level": "h3",
      "text": "Users",
      "id": "users"
    },
    {
      "level": "h2",
      "text": "Comparison operators",
      "id": "comparison-operators"
    },
    {
      "level": "h2",
      "text": "Value",
      "id": "value"
    },
    {
      "level": "h3",
      "text": "Regular expressions",
      "id": "regular-expressions"
    },
    {
      "level": "h2",
      "text": "Logical operators",
      "id": "logical-operators"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Third-party filtering conflict",
      "id": "third-party-filtering-conflict"
    },
    {
      "level": "h3",
      "text": "Magic WAN forwarding",
      "id": "magic-wan-forwarding"
    },
    {
      "level": "h3",
      "text": "Fallback DNS",
      "id": "fallback-dns"
    },
    {
      "level": "h2",
      "text": "Security categories",
      "id": "security-categories"
    },
    {
      "level": "h2",
      "text": "Content categories",
      "id": "content-categories"
    },
    {
      "level": "h3",
      "text": "Miscellaneous subcategories",
      "id": "miscellaneous-subcategories"
    },
    {
      "level": "h3",
      "text": "Security risk subcategories",
      "id": "security-risk-subcategories"
    },
    {
      "level": "h3",
      "text": "Category and subcategory IDs",
      "id": "category-and-subcategory-ids"
    },
    {
      "level": "h2",
      "text": "Filtering options",
      "id": "filtering-options"
    },
    {
      "level": "h3",
      "text": "Filter traffic by resolved IP category",
      "id": "filter-traffic-by-resolved-ip-category"
    },
    {
      "level": "h3",
      "text": "Ignore `CNAME` domain categories",
      "id": "ignore-`cname`-domain-categories"
    },
    {
      "level": "h2",
      "text": "Categorization process",
      "id": "categorization-process"
    },
    {
      "level": "h2",
      "text": "Terraform",
      "id": "terraform"
    },
    {
      "level": "h2",
      "text": "Load balancing",
      "id": "load-balancing"
    },
    {
      "level": "h2",
      "text": "Force IP version",
      "id": "force-ip-version"
    },
    {
      "level": "h2",
      "text": "Example policies",
      "id": "example-policies"
    },
    {
      "level": "h3",
      "text": "Catch-all policy",
      "id": "catch-all-policy"
    },
    {
      "level": "h2",
      "text": "Egress methods",
      "id": "egress-methods"
    },
    {
      "level": "h3",
      "text": "Use default Cloudflare egress method",
      "id": "use-default-cloudflare-egress-method"
    },
    {
      "level": "h3",
      "text": "Use dedicated egress IPs",
      "id": "use-dedicated-egress-ips"
    },
    {
      "level": "h2",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h3",
      "text": "Application Beta",
      "id": "application-beta"
    },
    {
      "level": "h3",
      "text": "Content Categories Beta",
      "id": "content-categories-beta"
    },
    {
      "level": "h3",
      "text": "Destination Continent",
      "id": "destination-continent"
    },
    {
      "level": "h3",
      "text": "Destination Country",
      "id": "destination-country"
    },
    {
      "level": "h3",
      "text": "Destination IP",
      "id": "destination-ip"
    },
    {
      "level": "h3",
      "text": "Destination Port",
      "id": "destination-port"
    },
    {
      "level": "h3",
      "text": "Device Posture",
      "id": "device-posture"
    },
    {
      "level": "h3",
      "text": "Domain Beta",
      "id": "domain-beta"
    },
    {
      "level": "h3",
      "text": "Host Beta",
      "id": "host-beta"
    },
    {
      "level": "h3",
      "text": "Protocol",
      "id": "protocol"
    },
    {
      "level": "h3",
      "text": "Proxy Endpoint",
      "id": "proxy-endpoint"
    },
    {
      "level": "h3",
      "text": "Source Continent",
      "id": "source-continent"
    },
    {
      "level": "h3",
      "text": "Source Country",
      "id": "source-country"
    },
    {
      "level": "h3",
      "text": "Source Internal IP",
      "id": "source-internal-ip"
    },
    {
      "level": "h3",
      "text": "Source IP",
      "id": "source-ip"
    },
    {
      "level": "h3",
      "text": "Source Port",
      "id": "source-port"
    },
    {
      "level": "h3",
      "text": "Users",
      "id": "users"
    },
    {
      "level": "h3",
      "text": "Virtual Network",
      "id": "virtual-network"
    },
    {
      "level": "h2",
      "text": "Comparison operators",
      "id": "comparison-operators"
    },
    {
      "level": "h2",
      "text": "Value",
      "id": "value"
    },
    {
      "level": "h2",
      "text": "Logical operators",
      "id": "logical-operators"
    },
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h3",
      "text": "Selector prerequisites",
      "id": "selector-prerequisites"
    },
    {
      "level": "h2",
      "text": "Enable IDS",
      "id": "enable-ids"
    },
    {
      "level": "h2",
      "text": "IDS rules",
      "id": "ids-rules"
    },
    {
      "level": "h2",
      "text": "Next steps",
      "id": "next-steps"
    },
    {
      "level": "h2",
      "text": "DNS resolution policies",
      "id": "dns-resolution-policies"
    },
    {
      "level": "h2",
      "text": "Network proxy policies",
      "id": "network-proxy-policies"
    },
    {
      "level": "h2",
      "text": "HTTP inspection policies",
      "id": "http-inspection-policies"
    },
    {
      "level": "h2",
      "text": "Gateway identity checks",
      "id": "gateway-identity-checks"
    },
    {
      "level": "h3",
      "text": "Automatic SCIM IdP updates",
      "id": "automatic-scim-idp-updates"
    },
    {
      "level": "h3",
      "text": "Extended email addresses",
      "id": "extended-email-addresses"
    },
    {
      "level": "h2",
      "text": "Identity-based selectors",
      "id": "identity-based-selectors"
    },
    {
      "level": "h3",
      "text": "SAML Attributes",
      "id": "saml-attributes"
    },
    {
      "level": "h3",
      "text": "User Email",
      "id": "user-email"
    },
    {
      "level": "h3",
      "text": "User Group IDs",
      "id": "user-group-ids"
    },
    {
      "level": "h3",
      "text": "User Group Email",
      "id": "user-group-email"
    },
    {
      "level": "h3",
      "text": "User Group Names",
      "id": "user-group-names"
    },
    {
      "level": "h3",
      "text": "User Name",
      "id": "user-name"
    },
    {
      "level": "h2",
      "text": "IdP groups in Gateway",
      "id": "idp-groups-in-gateway"
    },
    {
      "level": "h3",
      "text": "Microsoft Entra ID",
      "id": "microsoft-entra-id"
    },
    {
      "level": "h3",
      "text": "GitHub",
      "id": "github"
    },
    {
      "level": "h3",
      "text": "Google",
      "id": "google"
    },
    {
      "level": "h3",
      "text": "Okta (OIDC)",
      "id": "okta-(oidc)"
    },
    {
      "level": "h3",
      "text": "Okta (SAML)",
      "id": "okta-(saml)"
    },
    {
      "level": "h3",
      "text": "Generic SAML IdP",
      "id": "generic-saml-idp"
    },
    {
      "level": "h3",
      "text": "Generic OIDC IdP",
      "id": "generic-oidc-idp"
    },
    {
      "level": "h2",
      "text": "Actions",
      "id": "actions"
    },
    {
      "level": "h3",
      "text": "Allow",
      "id": "allow"
    },
    {
      "level": "h3",
      "text": "Block",
      "id": "block"
    },
    {
      "level": "h3",
      "text": "Redirect",
      "id": "redirect"
    },
    {
      "level": "h3",
      "text": "Isolate",
      "id": "isolate"
    },
    {
      "level": "h3",
      "text": "Do Not Inspect",
      "id": "do-not-inspect"
    },
    {
      "level": "h3",
      "text": "Do Not Isolate",
      "id": "do-not-isolate"
    },
    {
      "level": "h3",
      "text": "Do Not Scan",
      "id": "do-not-scan"
    },
    {
      "level": "h3",
      "text": "Quarantine",
      "id": "quarantine"
    },
    {
      "level": "h2",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h3",
      "text": "Access Infrastructure Target",
      "id": "access-infrastructure-target"
    },
    {
      "level": "h3",
      "text": "Access Private App",
      "id": "access-private-app"
    },
    {
      "level": "h3",
      "text": "Application Approval Status",
      "id": "application-approval-status"
    },
    {
      "level": "h3",
      "text": "Application",
      "id": "application"
    },
    {
      "level": "h3",
      "text": "Body Phase",
      "id": "body-phase"
    },
    {
      "level": "h3",
      "text": "Content Categories",
      "id": "content-categories"
    },
    {
      "level": "h3",
      "text": "Destination Continent",
      "id": "destination-continent"
    },
    {
      "level": "h3",
      "text": "Destination Country",
      "id": "destination-country"
    },
    {
      "level": "h3",
      "text": "Destination IP",
      "id": "destination-ip"
    },
    {
      "level": "h3",
      "text": "Device Posture",
      "id": "device-posture"
    },
    {
      "level": "h3",
      "text": "Domain",
      "id": "domain"
    },
    {
      "level": "h3",
      "text": "Download and Upload File Size",
      "id": "download-and-upload-file-size"
    },
    {
      "level": "h3",
      "text": "Download and Upload File Types",
      "id": "download-and-upload-file-types"
    },
    {
      "level": "h3",
      "text": "Download and Upload Mime Type",
      "id": "download-and-upload-mime-type"
    },
    {
      "level": "h3",
      "text": "DLP Profile",
      "id": "dlp-profile"
    },
    {
      "level": "h3",
      "text": "Host",
      "id": "host"
    },
    {
      "level": "h3",
      "text": "HTTP Method",
      "id": "http-method"
    },
    {
      "level": "h3",
      "text": "HTTP Response",
      "id": "http-response"
    },
    {
      "level": "h3",
      "text": "Proxy Endpoint",
      "id": "proxy-endpoint"
    },
    {
      "level": "h3",
      "text": "Security Risks",
      "id": "security-risks"
    },
    {
      "level": "h3",
      "text": "Source Continent",
      "id": "source-continent"
    },
    {
      "level": "h3",
      "text": "Source Country",
      "id": "source-country"
    },
    {
      "level": "h3",
      "text": "Source Internal IP",
      "id": "source-internal-ip"
    },
    {
      "level": "h3",
      "text": "Source IP",
      "id": "source-ip"
    },
    {
      "level": "h3",
      "text": "URL",
      "id": "url"
    },
    {
      "level": "h3",
      "text": "URL Path",
      "id": "url-path"
    },
    {
      "level": "h3",
      "text": "URL Path and Query",
      "id": "url-path-and-query"
    },
    {
      "level": "h3",
      "text": "URL Query",
      "id": "url-query"
    },
    {
      "level": "h3",
      "text": "Users",
      "id": "users"
    },
    {
      "level": "h3",
      "text": "Virtual Network",
      "id": "virtual-network"
    },
    {
      "level": "h2",
      "text": "Comparison operators",
      "id": "comparison-operators"
    },
    {
      "level": "h2",
      "text": "Value",
      "id": "value"
    },
    {
      "level": "h3",
      "text": "Regular expressions",
      "id": "regular-expressions"
    },
    {
      "level": "h2",
      "text": "Logical operators",
      "id": "logical-operators"
    },
    {
      "level": "h2",
      "text": "Get started",
      "id": "get-started"
    },
    {
      "level": "h2",
      "text": "Account types",
      "id": "account-types"
    },
    {
      "level": "h3",
      "text": "Tiered accounts",
      "id": "tiered-accounts"
    },
    {
      "level": "h3",
      "text": "Siloed accounts",
      "id": "siloed-accounts"
    },
    {
      "level": "h2",
      "text": "Actions",
      "id": "actions"
    },
    {
      "level": "h3",
      "text": "Allow",
      "id": "allow"
    },
    {
      "level": "h3",
      "text": "Audit SSH Deprecated",
      "id": "audit-ssh-deprecated"
    },
    {
      "level": "h3",
      "text": "Block",
      "id": "block"
    },
    {
      "level": "h3",
      "text": "Network Override",
      "id": "network-override"
    },
    {
      "level": "h2",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h3",
      "text": "Access Infrastructure Target",
      "id": "access-infrastructure-target"
    },
    {
      "level": "h3",
      "text": "Access Private App",
      "id": "access-private-app"
    },
    {
      "level": "h3",
      "text": "Application",
      "id": "application"
    },
    {
      "level": "h3",
      "text": "Content Categories",
      "id": "content-categories"
    },
    {
      "level": "h3",
      "text": "Destination Continent",
      "id": "destination-continent"
    },
    {
      "level": "h3",
      "text": "Destination Country",
      "id": "destination-country"
    },
    {
      "level": "h3",
      "text": "Destination IP",
      "id": "destination-ip"
    },
    {
      "level": "h3",
      "text": "Destination Port",
      "id": "destination-port"
    },
    {
      "level": "h3",
      "text": "Detected Protocol",
      "id": "detected-protocol"
    },
    {
      "level": "h3",
      "text": "Device Posture",
      "id": "device-posture"
    },
    {
      "level": "h3",
      "text": "Protocol",
      "id": "protocol"
    },
    {
      "level": "h3",
      "text": "Proxy Endpoint",
      "id": "proxy-endpoint"
    },
    {
      "level": "h3",
      "text": "Security Categories",
      "id": "security-categories"
    },
    {
      "level": "h3",
      "text": "SNI",
      "id": "sni"
    },
    {
      "level": "h3",
      "text": "SNI Domain",
      "id": "sni-domain"
    },
    {
      "level": "h3",
      "text": "Source Continent",
      "id": "source-continent"
    },
    {
      "level": "h3",
      "text": "Source Country",
      "id": "source-country"
    },
    {
      "level": "h3",
      "text": "Source Internal IP",
      "id": "source-internal-ip"
    },
    {
      "level": "h3",
      "text": "Source IP",
      "id": "source-ip"
    },
    {
      "level": "h3",
      "text": "Source Port",
      "id": "source-port"
    },
    {
      "level": "h3",
      "text": "Users",
      "id": "users"
    },
    {
      "level": "h3",
      "text": "Virtual Network",
      "id": "virtual-network"
    },
    {
      "level": "h2",
      "text": "Comparison operators",
      "id": "comparison-operators"
    },
    {
      "level": "h2",
      "text": "Value",
      "id": "value"
    },
    {
      "level": "h3",
      "text": "Regular expressions",
      "id": "regular-expressions"
    },
    {
      "level": "h2",
      "text": "Logical operators",
      "id": "logical-operators"
    },
    {
      "level": "h2",
      "text": "Connection establishment",
      "id": "connection-establishment"
    },
    {
      "level": "h2",
      "text": "Priority between policy builders",
      "id": "priority-between-policy-builders"
    },
    {
      "level": "h3",
      "text": "HTTP/3 traffic",
      "id": "http/3-traffic"
    },
    {
      "level": "h2",
      "text": "Priority within a policy builder",
      "id": "priority-within-a-policy-builder"
    },
    {
      "level": "h3",
      "text": "DNS policies",
      "id": "dns-policies"
    },
    {
      "level": "h3",
      "text": "Network policies",
      "id": "network-policies"
    },
    {
      "level": "h3",
      "text": "HTTP policies",
      "id": "http-policies"
    },
    {
      "level": "h3",
      "text": "Resolver policies",
      "id": "resolver-policies"
    },
    {
      "level": "h3",
      "text": "Order of precedence",
      "id": "order-of-precedence"
    },
    {
      "level": "h2",
      "text": "Example",
      "id": "example"
    },
    {
      "level": "h2",
      "text": "Precedence calculations",
      "id": "precedence-calculations"
    },
    {
      "level": "h2",
      "text": "Manage precedence with Terraform",
      "id": "manage-precedence-with-terraform"
    },
    {
      "level": "h2",
      "text": "Proxy algorithm",
      "id": "proxy-algorithm"
    },
    {
      "level": "h2",
      "text": "Supported protocols",
      "id": "supported-protocols"
    },
    {
      "level": "h3",
      "text": "TCP",
      "id": "tcp"
    },
    {
      "level": "h3",
      "text": "UDP",
      "id": "udp"
    },
    {
      "level": "h3",
      "text": "ICMP Beta",
      "id": "icmp-beta"
    },
    {
      "level": "h2",
      "text": "Turn on the Gateway proxy",
      "id": "turn-on-the-gateway-proxy"
    },
    {
      "level": "h2",
      "text": "Use cases",
      "id": "use-cases"
    },
    {
      "level": "h3",
      "text": "Internal DNS Beta",
      "id": "internal-dns-beta"
    },
    {
      "level": "h3",
      "text": "Local Domain Fallback",
      "id": "local-domain-fallback"
    },
    {
      "level": "h2",
      "text": "Resolver connections",
      "id": "resolver-connections"
    },
    {
      "level": "h3",
      "text": "Cloudflare Tunnel",
      "id": "cloudflare-tunnel"
    },
    {
      "level": "h3",
      "text": "Magic WAN",
      "id": "magic-wan"
    },
    {
      "level": "h3",
      "text": "Available DNS endpoints",
      "id": "available-dns-endpoints"
    },
    {
      "level": "h2",
      "text": "Create a resolver policy",
      "id": "create-a-resolver-policy"
    },
    {
      "level": "h2",
      "text": "Selectors",
      "id": "selectors"
    },
    {
      "level": "h3",
      "text": "Content Categories",
      "id": "content-categories"
    },
    {
      "level": "h3",
      "text": "DNS Resolver IP",
      "id": "dns-resolver-ip"
    },
    {
      "level": "h3",
      "text": "DoH Subdomain",
      "id": "doh-subdomain"
    },
    {
      "level": "h3",
      "text": "Domain",
      "id": "domain"
    },
    {
      "level": "h3",
      "text": "Host",
      "id": "host"
    },
    {
      "level": "h3",
      "text": "Location",
      "id": "location"
    },
    {
      "level": "h3",
      "text": "Query Record Type",
      "id": "query-record-type"
    },
    {
      "level": "h3",
      "text": "Security Categories",
      "id": "security-categories"
    },
    {
      "level": "h3",
      "text": "Source Continent",
      "id": "source-continent"
    },
    {
      "level": "h3",
      "text": "Source Country",
      "id": "source-country"
    },
    {
      "level": "h3",
      "text": "Source IP",
      "id": "source-ip"
    },
    {
      "level": "h3",
      "text": "Users",
      "id": "users"
    },
    {
      "level": "h2",
      "text": "Comparison operators",
      "id": "comparison-operators"
    },
    {
      "level": "h2",
      "text": "Value",
      "id": "value"
    },
    {
      "level": "h3",
      "text": "Regular expressions",
      "id": "regular-expressions"
    },
    {
      "level": "h2",
      "text": "Logical operators",
      "id": "logical-operators"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Apply the Worker to your hostname",
      "id": "apply-the-worker-to-your-hostname"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Create an AI gateway",
      "id": "1.-create-an-ai-gateway"
    },
    {
      "level": "h2",
      "text": "2. (Optional) Use Guardrails to block unsafe or inappropriate content",
      "id": "2.-(optional)-use-guardrails-to-block-unsafe-or-inappropriate-content"
    },
    {
      "level": "h2",
      "text": "3. Build a Worker to serve the wrapper",
      "id": "3.-build-a-worker-to-serve-the-wrapper"
    },
    {
      "level": "h3",
      "text": "1. Create the Worker",
      "id": "1.-create-the-worker"
    },
    {
      "level": "h3",
      "text": "2. Build the Worker",
      "id": "2.-build-the-worker"
    },
    {
      "level": "h3",
      "text": "3. Publish the Worker",
      "id": "3.-publish-the-worker"
    },
    {
      "level": "h2",
      "text": "4. Secure the wrapper with Access",
      "id": "4.-secure-the-wrapper-with-access"
    },
    {
      "level": "h2",
      "text": "5. Block access to public AI agents with Gateway",
      "id": "5.-block-access-to-public-ai-agents-with-gateway"
    },
    {
      "level": "h2",
      "text": "6. Enforce Data Loss Prevention and Clientless Browser Isolation",
      "id": "6.-enforce-data-loss-prevention-and-clientless-browser-isolation"
    },
    {
      "level": "h3",
      "text": "Apply Data Loss Prevention profiles",
      "id": "apply-data-loss-prevention-profiles"
    },
    {
      "level": "h3",
      "text": "Execute in a clientless isolated browser",
      "id": "execute-in-a-clientless-isolated-browser"
    },
    {
      "level": "h2",
      "text": "Additional benefits",
      "id": "additional-benefits"
    },
    {
      "level": "h3",
      "text": "Visibility",
      "id": "visibility"
    },
    {
      "level": "h3",
      "text": "Configurability",
      "id": "configurability"
    },
    {
      "level": "h2",
      "text": "Authenticate a session from the command line",
      "id": "authenticate-a-session-from-the-command-line"
    },
    {
      "level": "h2",
      "text": "Access your API",
      "id": "access-your-api"
    },
    {
      "level": "h2",
      "text": "Available commands",
      "id": "available-commands"
    },
    {
      "level": "h3",
      "text": "login",
      "id": "login"
    },
    {
      "level": "h3",
      "text": "curl",
      "id": "curl"
    },
    {
      "level": "h3",
      "text": "token",
      "id": "token"
    },
    {
      "level": "h2",
      "text": "Using the token as an environment variable",
      "id": "using-the-token-as-an-environment-variable"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Create a Cloudflare Tunnel",
      "id": "create-a-cloudflare-tunnel"
    },
    {
      "level": "h2",
      "text": "Add private network routes",
      "id": "add-private-network-routes"
    },
    {
      "level": "h2",
      "text": "Enable Clientless Web Isolation",
      "id": "enable-clientless-web-isolation"
    },
    {
      "level": "h2",
      "text": "Create a Gateway resolver policy",
      "id": "create-a-gateway-resolver-policy"
    },
    {
      "level": "h2",
      "text": "Create a Gateway network policy (recommended)",
      "id": "create-a-gateway-network-policy-(recommended)"
    },
    {
      "level": "h2",
      "text": "Connect as a user",
      "id": "connect-as-a-user"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "Set up an identity provider for your application",
      "id": "set-up-an-identity-provider-for-your-application"
    },
    {
      "level": "h2",
      "text": "Add API permission in Entra ID",
      "id": "add-api-permission-in-entra-id"
    },
    {
      "level": "h2",
      "text": "Configure Conditional Access in Entra ID",
      "id": "configure-conditional-access-in-entra-id"
    },
    {
      "level": "h2",
      "text": "Sync Conditional Access with Zero Trust",
      "id": "sync-conditional-access-with-zero-trust"
    },
    {
      "level": "h2",
      "text": "Create an Access application",
      "id": "create-an-access-application"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Set up Entra ID as an identity provider",
      "id": "1.-set-up-entra-id-as-an-identity-provider"
    },
    {
      "level": "h2",
      "text": "2. Add Entra ID API permissions",
      "id": "2.-add-entra-id-api-permissions"
    },
    {
      "level": "h2",
      "text": "3. Add risky users to Entra ID group",
      "id": "3.-add-risky-users-to-entra-id-group"
    },
    {
      "level": "h2",
      "text": "4. Synchronize risky user groups",
      "id": "4.-synchronize-risky-user-groups"
    },
    {
      "level": "h2",
      "text": "5. Create a browser isolation policy",
      "id": "5.-create-a-browser-isolation-policy"
    },
    {
      "level": "h2",
      "text": "Authentication flow",
      "id": "authentication-flow"
    },
    {
      "level": "h2",
      "text": "Benefits",
      "id": "benefits"
    },
    {
      "level": "h2",
      "text": "Before you begin",
      "id": "before-you-begin"
    },
    {
      "level": "h2",
      "text": "1. Create the Worker",
      "id": "1.-create-the-worker"
    },
    {
      "level": "h2",
      "text": "2. View the user's identity",
      "id": "2.-view-the-user's-identity"
    },
    {
      "level": "h2",
      "text": "3. Route the Worker to your application",
      "id": "3.-route-the-worker-to-your-application"
    },
    {
      "level": "h2",
      "text": "4. Deploy the Worker",
      "id": "4.-deploy-the-worker"
    },
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "1. Create a validation function",
      "id": "1.-create-a-validation-function"
    }
  ],
  "url": "llms-txt#example:-get-only-deleted-virtual-networks",
  "links": []
}